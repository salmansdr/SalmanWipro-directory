/*! For license information please see main.b1a19187.js.LICENSE.txt */
(()=>{var e={155:e=>{"use strict";var t=TypeError;e.exports=function(e,n){if(e<n)throw new t("Not enough arguments");return e}},166:(e,t,n)=>{"use strict";var r,i,o=n(4823),a=n(498),s=o.process,l=o.Deno,c=s&&s.versions||l&&l.version,u=c&&c.v8;u&&(i=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},253:(e,t,n)=>{"use strict";var r=n(9519),i=n(8084);e.exports=r&&i(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},327:(e,t,n)=>{"use strict";var r=n(3192),i=TypeError;e.exports=function(e){if(r(e))throw new i("Can't call method on "+e);return e}},466:(e,t,n)=>{"use strict";var r=n(9344);e.exports=function(e){var t=+e;return t!==t||0===t?0:r(t)}},498:(e,t,n)=>{"use strict";var r=n(4823).navigator,i=r&&r.userAgent;e.exports=i?String(i):""},579:(e,t,n)=>{"use strict";e.exports=n(2799)},816:(e,t,n)=>{"use strict";var r=n(5704);e.exports=function(e,t){return r[e]||(r[e]=t||{})}},836:(e,t,n)=>{"use strict";var r=n(4850),i=n(1239),o=n(1608),a=n(5464),s=n(1584),l=TypeError;e.exports=function(e,t){var n=arguments.length<2?s(e):t;if(i(n))return o(r(n,e));throw new l(a(e)+" is not iterable")}},904:(e,t,n)=>{"use strict";var r=n(3542);e.exports=r("document","documentElement")},972:(e,t,n)=>{"use strict";var r=n(6774),i=n(2201),o=n(1591),a=function(e){return function(t,n,a){var s=r(t),l=o(s);if(0===l)return!e&&-1;var c,u=i(a,l);if(e&&n!==n){for(;l>u;)if((c=s[u++])!==c)return!0}else for(;l>u;u++)if((e||u in s)&&s[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},1001:(e,t,n)=>{"use strict";n(3348)("flat")},1147:e=>{"use strict";var t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n={"{":"\\{","}":"\\}","\\":"\\textbackslash{}","#":"\\#",$:"\\$","%":"\\%","&":"\\&","^":"\\textasciicircum{}",_:"\\_","~":"\\textasciitilde{}"},r={"\u2013":"\\--","\u2014":"\\---"," ":"~","\t":"\\qquad{}","\r\n":"\\newline{}","\n":"\\newline{}"},i=function(e,n){return t({},e,n)};e.exports=function(e){for(var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=o.preserveFormatting,s=void 0!==a&&a,l=o.escapeMapFn,c=void 0===l?i:l,u=String(e),d="",h=c(t({},n),s?t({},r):{}),f=Object.keys(h),m=function(){var e=!1;f.forEach(function(t,n){e||u.length>=t.length&&u.slice(0,t.length)===t&&(d+=h[f[n]],u=u.slice(t.length,u.length),e=!0)}),e||(d+=u.slice(0,1),u=u.slice(1,u.length))};u;)m();return d}},1178:(e,t,n)=>{"use strict";var r=n(7707),i=n(8084),o=n(5687),a=Object,s=r("".split);e.exports=i(function(){return!a("z").propertyIsEnumerable(0)})?function(e){return"String"===o(e)?s(e,""):a(e)}:a},1183:(e,t,n)=>{"use strict";var r=n(9055),i=n(4850),o=n(1608),a=n(5464),s=n(3356),l=n(1591),c=n(6864),u=n(836),d=n(1584),h=n(3858),f=TypeError,m=function(e,t){this.stopped=e,this.result=t},p=m.prototype;e.exports=function(e,t,n){var g,v,y,b,w,x,S,C=n&&n.that,E=!(!n||!n.AS_ENTRIES),N=!(!n||!n.IS_RECORD),T=!(!n||!n.IS_ITERATOR),A=!(!n||!n.INTERRUPTED),R=r(t,C),k=function(e){return g&&h(g,"normal"),new m(!0,e)},M=function(e){return E?(o(e),A?R(e[0],e[1],k):R(e[0],e[1])):A?R(e,k):R(e)};if(N)g=e.iterator;else if(T)g=e;else{if(!(v=d(e)))throw new f(a(e)+" is not iterable");if(s(v)){for(y=0,b=l(e);b>y;y++)if((w=M(e[y]))&&c(p,w))return w;return new m(!1)}g=u(e,v)}for(x=N?e.next:g.next;!(S=i(x,g)).done;){try{w=M(S.value)}catch(D){h(g,"throw",D)}if("object"==typeof w&&w&&c(p,w))return w}return new m(!1)}},1234:()=>{},1239:(e,t,n)=>{"use strict";var r=n(4706),i=n(5464),o=TypeError;e.exports=function(e){if(r(e))return e;throw new o(i(e)+" is not a function")}},1415:(e,t,n)=>{"use strict";var r={};r[n(4352)("toStringTag")]="z",e.exports="[object z]"===String(r)},1523:(e,t,n)=>{"use strict";var r=n(4061),i=n(4291);e.exports=Object.keys||function(e){return r(e,i)}},1584:(e,t,n)=>{"use strict";var r=n(7972),i=n(7151),o=n(3192),a=n(4614),s=n(4352)("iterator");e.exports=function(e){if(!o(e))return i(e,s)||i(e,"@@iterator")||a[r(e)]}},1591:(e,t,n)=>{"use strict";var r=n(8249);e.exports=function(e){return r(e.length)}},1608:(e,t,n)=>{"use strict";var r=n(6821),i=String,o=TypeError;e.exports=function(e){if(r(e))return e;throw new o(i(e)+" is not an object")}},1659:(e,t,n)=>{"use strict";var r=n(7707);e.exports=r([].slice)},1709:(e,t,n)=>{"use strict";var r=n(4823),i=n(6464),o=n(4706),a=n(7192),s=n(498),l=n(1659),c=n(155),u=r.Function,d=/MSIE .\./.test(s)||"BUN"===a&&function(){var e=r.Bun.version.split(".");return e.length<3||"0"===e[0]&&(e[1]<3||"3"===e[1]&&"0"===e[2])}();e.exports=function(e,t){var n=t?2:1;return d?function(r,a){var s=c(arguments.length,1)>n,d=o(r)?r:u(r),h=s?l(arguments,n):[],f=s?function(){i(d,this,h)}:d;return t?e(f,a):e(f)}:e}},2201:(e,t,n)=>{"use strict";var r=n(466),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},2345:(e,t,n)=>{"use strict";var r=n(9519),i=n(6164),o=Function.prototype,a=r&&Object.getOwnPropertyDescriptor,s=i(o,"name"),l=s&&"something"===function(){}.name,c=s&&(!r||r&&a(o,"name").configurable);e.exports={EXISTS:s,PROPER:l,CONFIGURABLE:c}},2428:(e,t,n)=>{"use strict";var r,i,o,a=n(9279),s=n(4823),l=n(6821),c=n(9266),u=n(6164),d=n(5704),h=n(4658),f=n(3114),m="Object already initialized",p=s.TypeError,g=s.WeakMap;if(a||d.state){var v=d.state||(d.state=new g);v.get=v.get,v.has=v.has,v.set=v.set,r=function(e,t){if(v.has(e))throw new p(m);return t.facade=e,v.set(e,t),t},i=function(e){return v.get(e)||{}},o=function(e){return v.has(e)}}else{var y=h("state");f[y]=!0,r=function(e,t){if(u(e,y))throw new p(m);return t.facade=e,c(e,y,t),t},i=function(e){return u(e,y)?e[y]:{}},o=function(e){return u(e,y)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!l(t)||(n=i(t)).type!==e)throw new p("Incompatible receiver, "+e+" required");return n}}}},2430:function(e,t,n){var r;!function(i,o,a){var s,l=256,c=a.pow(l,6),u=a.pow(2,52),d=2*u,h=255;function f(e,t,n){var r=[],h=v(g((t=1==t?{entropy:!0}:t||{}).entropy?[e,y(o)]:null==e?function(){try{var e;return s&&(e=s.randomBytes)?e=e(l):(e=new Uint8Array(l),(i.crypto||i.msCrypto).getRandomValues(e)),y(e)}catch(r){var t=i.navigator,n=t&&t.plugins;return[+new Date,i,n,i.screen,y(o)]}}():e,3),r),f=new m(r),b=function(){for(var e=f.g(6),t=c,n=0;e<u;)e=(e+n)*l,t*=l,n=f.g(1);for(;e>=d;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|f.g(4)},b.quick=function(){return f.g(4)/4294967296},b.double=b,v(y(f.S),o),(t.pass||n||function(e,t,n,r){return r&&(r.S&&p(r,f),e.state=function(){return p(f,{})}),n?(a.random=e,t):e})(b,h,"global"in t?t.global:this==a,t.state)}function m(e){var t,n=e.length,r=this,i=0,o=r.i=r.j=0,a=r.S=[];for(n||(e=[n++]);i<l;)a[i]=i++;for(i=0;i<l;i++)a[i]=a[o=h&o+e[i%n]+(t=a[i])],a[o]=t;(r.g=function(e){for(var t,n=0,i=r.i,o=r.j,a=r.S;e--;)t=a[i=h&i+1],n=n*l+a[h&(a[i]=a[o=h&o+t])+(a[o]=t)];return r.i=i,r.j=o,n})(l)}function p(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function g(e,t){var n,r=[],i=typeof e;if(t&&"object"==i)for(n in e)try{r.push(g(e[n],t-1))}catch(o){}return r.length?r:"string"==i?e:e+"\0"}function v(e,t){for(var n,r=e+"",i=0;i<r.length;)t[h&i]=h&(n^=19*t[h&i])+r.charCodeAt(i++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(v(a.random(),o),e.exports){e.exports=f;try{s=n(1234)}catch(b){}}else void 0===(r=function(){return f}.call(t,n,t,e))||(e.exports=r)}("undefined"!==typeof self?self:this,[],Math)},2509:(e,t,n)=>{"use strict";var r=n(4850),i=n(4706),o=n(6821),a=TypeError;e.exports=function(e,t){var n,s;if("string"===t&&i(n=e.toString)&&!o(s=r(n,e)))return s;if(i(n=e.valueOf)&&!o(s=r(n,e)))return s;if("string"!==t&&i(n=e.toString)&&!o(s=r(n,e)))return s;throw new a("Can't convert object to primitive value")}},2522:(e,t,n)=>{"use strict";var r=n(327),i=Object;e.exports=function(e){return i(r(e))}},2682:(e,t,n)=>{"use strict";var r=n(3542),i=n(7707),o=n(7251),a=n(6842),s=n(1608),l=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(s(e)),n=a.f;return n?l(t,n(e)):t}},2740:e=>{"use strict";e.exports=function(e,t,n,r,i,o,a,s){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,i,o,a,s],u=0;(l=new Error(t.replace(/%s/g,function(){return c[u++]}))).name="Invariant Violation"}throw l.framesToPop=1,l}}},2760:(e,t,n)=>{"use strict";var r=n(4823),i=n(6821),o=r.document,a=i(o)&&i(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},2799:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function i(e,t,r){var i=null;if(void 0!==r&&(i=""+r),void 0!==t.key&&(i=""+t.key),"key"in t)for(var o in r={},t)"key"!==o&&(r[o]=t[o]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:i,ref:void 0!==t?t:null,props:r}}t.Fragment=r,t.jsx=i,t.jsxs=i},3036:(e,t,n)=>{"use strict";var r=n(4823),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},3114:e=>{"use strict";e.exports={}},3192:e=>{"use strict";e.exports=function(e){return null===e||void 0===e}},3326:(e,t,n)=>{"use strict";var r=n(9140),i=n(7970);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},3348:(e,t,n)=>{"use strict";var r=n(4352),i=n(6115),o=n(3572).f,a=r("unscopables"),s=Array.prototype;void 0===s[a]&&o(s,a,{configurable:!0,value:i(null)}),e.exports=function(e){s[a][e]=!0}},3356:(e,t,n)=>{"use strict";var r=n(4352),i=n(4614),o=r("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||a[o]===e)}},3542:(e,t,n)=>{"use strict";var r=n(4823),i=n(4706);e.exports=function(e,t){return arguments.length<2?(n=r[e],i(n)?n:void 0):r[e]&&r[e][t];var n}},3572:(e,t,n)=>{"use strict";var r=n(9519),i=n(9704),o=n(253),a=n(1608),s=n(3326),l=TypeError,c=Object.defineProperty,u=Object.getOwnPropertyDescriptor,d="enumerable",h="configurable",f="writable";t.f=r?o?function(e,t,n){if(a(e),t=s(t),a(n),"function"===typeof e&&"prototype"===t&&"value"in n&&f in n&&!n[f]){var r=u(e,t);r&&r[f]&&(e[t]=n.value,n={configurable:h in n?n[h]:r[h],enumerable:d in n?n[d]:r[d],writable:!1})}return c(e,t,n)}:c:function(e,t,n){if(a(e),t=s(t),a(n),i)try{return c(e,t,n)}catch(r){}if("get"in n||"set"in n)throw new l("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},3858:(e,t,n)=>{"use strict";var r=n(4850),i=n(1608),o=n(7151);e.exports=function(e,t,n){var a,s;i(e);try{if(!(a=o(e,"return"))){if("throw"===t)throw n;return n}a=r(a,e)}catch(l){s=!0,a=l}if("throw"===t)throw n;if(s)throw a;return i(a),n}},4022:(e,t)=>{"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},4030:(e,t,n)=>{"use strict";var r=n(166),i=n(8084),o=n(4823).String;e.exports=!!Object.getOwnPropertySymbols&&!i(function(){var e=Symbol("symbol detection");return!o(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41})},4061:(e,t,n)=>{"use strict";var r=n(7707),i=n(6164),o=n(6774),a=n(972).indexOf,s=n(3114),l=r([].push);e.exports=function(e,t){var n,r=o(e),c=0,u=[];for(n in r)!i(s,n)&&i(r,n)&&l(u,n);for(;t.length>c;)i(r,n=t[c++])&&(~a(u,n)||l(u,n));return u}},4111:(e,t,n)=>{"use strict";var r=n(4030);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},4234:(e,t,n)=>{"use strict";var r=n(7192);e.exports="NODE"===r},4288:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.for("react.activity"),m=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,v={};function y(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||p}function b(){}function w(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=y.prototype;var x=w.prototype=new b;x.constructor=w,g(x,y.prototype),x.isPureReactComponent=!0;var S=Array.isArray;function C(){}var E={H:null,A:null,T:null,S:null},N=Object.prototype.hasOwnProperty;function T(e,t,r){var i=r.ref;return{$$typeof:n,type:e,key:t,ref:void 0!==i?i:null,props:r}}function A(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var R=/\/+/g;function k(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function M(e,t,i,o,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(s){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0;break;case h:return M((u=e._init)(e._payload),t,i,o,a)}}if(u)return a=a(e),u=""===o?"."+k(e,0):o,S(a)?(i="",null!=u&&(i=u.replace(R,"$&/")+"/"),M(a,t,i,"",function(e){return e})):null!=a&&(A(a)&&(l=a,c=i+(null==a.key||e&&e.key===a.key?"":(""+a.key).replace(R,"$&/")+"/")+u,a=T(l.type,c,l.props)),t.push(a)),1;u=0;var d,f=""===o?".":o+":";if(S(e))for(var p=0;p<e.length;p++)u+=M(o=e[p],t,i,s=f+k(o,p),a);else if("function"===typeof(p=null===(d=e)||"object"!==typeof d?null:"function"===typeof(d=m&&d[m]||d["@@iterator"])?d:null))for(e=p.call(e),p=0;!(o=e.next()).done;)u+=M(o=o.value,t,i,s=f+k(o,p++),a);else if("object"===s){if("function"===typeof e.then)return M(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(C,C):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,i,o,a);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function D(e,t,n){if(null==e)return e;var r=[],i=0;return M(e,r,"","",function(e){return t.call(n,e,i++)}),r}function _(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},I={map:D,forEach:function(e,t,n){D(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return D(e,function(){t++}),t},toArray:function(e){return D(e,function(e){return e})||[]},only:function(e){if(!A(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=f,t.Children=I,t.Component=y,t.Fragment=i,t.Profiler=a,t.PureComponent=w,t.StrictMode=o,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=E,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return E.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=g({},e.props),i=e.key;if(null!=t)for(o in void 0!==t.key&&(i=""+t.key),t)!N.call(t,o)||"key"===o||"__self"===o||"__source"===o||"ref"===o&&void 0===t.ref||(r[o]=t[o]);var o=arguments.length-2;if(1===o)r.children=n;else if(1<o){for(var a=Array(o),s=0;s<o;s++)a[s]=arguments[s+2];r.children=a}return T(e.type,i,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:s,_context:e},e},t.createElement=function(e,t,n){var r,i={},o=null;if(null!=t)for(r in void 0!==t.key&&(o=""+t.key),t)N.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(i[r]=t[r]);var a=arguments.length-2;if(1===a)i.children=n;else if(1<a){for(var s=Array(a),l=0;l<a;l++)s[l]=arguments[l+2];i.children=s}if(e&&e.defaultProps)for(r in a=e.defaultProps)void 0===i[r]&&(i[r]=a[r]);return T(e,o,i)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=A,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:_}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=E.T,n={};E.T=n;try{var r=e(),i=E.S;null!==i&&i(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(C,O)}catch(o){O(o)}finally{null!==t&&null!==n.types&&(t.types=n.types),E.T=t}},t.unstable_useCacheRefresh=function(){return E.H.useCacheRefresh()},t.use=function(e){return E.H.use(e)},t.useActionState=function(e,t,n){return E.H.useActionState(e,t,n)},t.useCallback=function(e,t){return E.H.useCallback(e,t)},t.useContext=function(e){return E.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return E.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return E.H.useEffect(e,t)},t.useEffectEvent=function(e){return E.H.useEffectEvent(e)},t.useId=function(){return E.H.useId()},t.useImperativeHandle=function(e,t,n){return E.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return E.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return E.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return E.H.useMemo(e,t)},t.useOptimistic=function(e,t){return E.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return E.H.useReducer(e,t,n)},t.useRef=function(e){return E.H.useRef(e)},t.useState=function(e){return E.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return E.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return E.H.useTransition()},t.version="19.2.0"},4291:e=>{"use strict";e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},4334:(e,t,n)=>{var r=n(7359),i=n(7066),o=n(9016),a=n(9538),s=n(6288),l=n(5262),c=n(2430);c.alea=r,c.xor128=i,c.xorwow=o,c.xorshift7=a,c.xor4096=s,c.tychei=l,e.exports=c},4352:(e,t,n)=>{"use strict";var r=n(4823),i=n(816),o=n(6164),a=n(7899),s=n(4030),l=n(4111),c=r.Symbol,u=i("wks"),d=l?c.for||c:c&&c.withoutSetter||a;e.exports=function(e){return o(u,e)||(u[e]=s&&o(c,e)?c[e]:d("Symbol."+e)),u[e]}},4382:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,p(w,v.prototype),w.isPureReactComponent=!0;var x=Array.isArray,S={H:null,A:null,T:null,S:null,V:null},C=Object.prototype.hasOwnProperty;function E(e,t,r,i,o,a){return r=a.ref,{$$typeof:n,type:e,key:t,ref:void 0!==r?r:null,props:a}}function N(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var T=/\/+/g;function A(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function R(){}function k(e,t,i,o,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(s){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0;break;case h:return k((u=e._init)(e._payload),t,i,o,a)}}if(u)return a=a(e),u=""===o?"."+A(e,0):o,x(a)?(i="",null!=u&&(i=u.replace(T,"$&/")+"/"),k(a,t,i,"",function(e){return e})):null!=a&&(N(a)&&(l=a,c=i+(null==a.key||e&&e.key===a.key?"":(""+a.key).replace(T,"$&/")+"/")+u,a=E(l.type,c,void 0,0,0,l.props)),t.push(a)),1;u=0;var d,m=""===o?".":o+":";if(x(e))for(var p=0;p<e.length;p++)u+=k(o=e[p],t,i,s=m+A(o,p),a);else if("function"===typeof(p=null===(d=e)||"object"!==typeof d?null:"function"===typeof(d=f&&d[f]||d["@@iterator"])?d:null))for(e=p.call(e),p=0;!(o=e.next()).done;)u+=k(o=o.value,t,i,s=m+A(o,p++),a);else if("object"===s){if("function"===typeof e.then)return k(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(R,R):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,i,o,a);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function M(e,t,n){if(null==e)return e;var r=[],i=0;return k(e,r,"","",function(e){return t.call(n,e,i++)}),r}function D(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var _="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function O(){}t.Children={map:M,forEach:function(e,t,n){M(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return M(e,function(){t++}),t},toArray:function(e){return M(e,function(e){return e})||[]},only:function(e){if(!N(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=a,t.PureComponent=b,t.StrictMode=o,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return S.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=p({},e.props),i=e.key;if(null!=t)for(o in void 0!==t.ref&&void 0,void 0!==t.key&&(i=""+t.key),t)!C.call(t,o)||"key"===o||"__self"===o||"__source"===o||"ref"===o&&void 0===t.ref||(r[o]=t[o]);var o=arguments.length-2;if(1===o)r.children=n;else if(1<o){for(var a=Array(o),s=0;s<o;s++)a[s]=arguments[s+2];r.children=a}return E(e.type,i,void 0,0,0,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:s,_context:e},e},t.createElement=function(e,t,n){var r,i={},o=null;if(null!=t)for(r in void 0!==t.key&&(o=""+t.key),t)C.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(i[r]=t[r]);var a=arguments.length-2;if(1===a)i.children=n;else if(1<a){for(var s=Array(a),l=0;l<a;l++)s[l]=arguments[l+2];i.children=s}if(e&&e.defaultProps)for(r in a=e.defaultProps)void 0===i[r]&&(i[r]=a[r]);return E(e,o,void 0,0,0,i)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=N,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:D}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=S.T,n={};S.T=n;try{var r=e(),i=S.S;null!==i&&i(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(O,_)}catch(o){_(o)}finally{S.T=t}},t.unstable_useCacheRefresh=function(){return S.H.useCacheRefresh()},t.use=function(e){return S.H.use(e)},t.useActionState=function(e,t,n){return S.H.useActionState(e,t,n)},t.useCallback=function(e,t){return S.H.useCallback(e,t)},t.useContext=function(e){return S.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return S.H.useDeferredValue(e,t)},t.useEffect=function(e,t,n){var r=S.H;if("function"===typeof n)throw Error("useEffect CRUD overload is not enabled in this build of React.");return r.useEffect(e,t)},t.useId=function(){return S.H.useId()},t.useImperativeHandle=function(e,t,n){return S.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return S.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return S.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return S.H.useMemo(e,t)},t.useOptimistic=function(e,t){return S.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return S.H.useReducer(e,t,n)},t.useRef=function(e){return S.H.useRef(e)},t.useState=function(e){return S.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return S.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return S.H.useTransition()},t.version="19.1.1"},4391:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(7004)},4416:(e,t,n)=>{"use strict";var r=n(7707),i=n(8084),o=n(4706),a=n(6164),s=n(9519),l=n(2345).CONFIGURABLE,c=n(5167),u=n(2428),d=u.enforce,h=u.get,f=String,m=Object.defineProperty,p=r("".slice),g=r("".replace),v=r([].join),y=s&&!i(function(){return 8!==m(function(){},"length",{value:8}).length}),b=String(String).split("String"),w=e.exports=function(e,t,n){"Symbol("===p(f(t),0,7)&&(t="["+g(f(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!a(e,"name")||l&&e.name!==t)&&(s?m(e,"name",{value:t,configurable:!0}):e.name=t),y&&n&&a(n,"arity")&&e.length!==n.arity&&m(e,"length",{value:n.arity});try{n&&a(n,"constructor")&&n.constructor?s&&m(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(i){}var r=d(e);return a(r,"source")||(r.source=v(b,"string"==typeof t?t:"")),e};Function.prototype.toString=w(function(){return o(this)&&h(this).source||c(this)},"toString")},4614:e=>{"use strict";e.exports={}},4639:(e,t,n)=>{"use strict";var r=n(9519),i=n(3572),o=n(6369);e.exports=function(e,t,n){r?i.f(e,t,o(0,n)):e[t]=n}},4647:(e,t,n)=>{"use strict";n(6023),n(9286)},4658:(e,t,n)=>{"use strict";var r=n(816),i=n(7899),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},4706:e=>{"use strict";var t="object"==typeof document&&document.all;e.exports="undefined"==typeof t&&void 0!==t?function(e){return"function"==typeof e||e===t}:function(e){return"function"==typeof e}},4823:function(e,t,n){"use strict";var r=function(e){return e&&e.Math===Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},4850:(e,t,n)=>{"use strict";var r=n(5897),i=Function.prototype.call;e.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},5043:(e,t,n)=>{"use strict";e.exports=n(4288)},5167:(e,t,n)=>{"use strict";var r=n(7707),i=n(4706),o=n(5704),a=r(Function.toString);i(o.inspectSource)||(o.inspectSource=function(e){return a(e)}),e.exports=o.inspectSource},5214:(e,t,n)=>{"use strict";var r=n(9519),i=n(4850),o=n(4022),a=n(6369),s=n(6774),l=n(3326),c=n(6164),u=n(9704),d=Object.getOwnPropertyDescriptor;t.f=r?d:function(e,t){if(e=s(e),t=l(t),u)try{return d(e,t)}catch(n){}if(c(e,t))return a(!i(o.f,e,t),e[t])}},5262:function(e,t,n){var r;!function(e,i){function o(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,i=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^i,t.a=i-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function a(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function s(e,t){var n=new o(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,i))||(i.exports=r):this.tychei=s}(0,e=n.nmd(e),n.amdD)},5422:function(e){e.exports=function(){"use strict";function e(){return!0}function t(){return!1}function n(){}const r="Argument is not a typed-function.";function i(){function o(e){return"object"===typeof e&&null!==e&&e.constructor===Object}const a=[{name:"number",test:function(e){return"number"===typeof e}},{name:"string",test:function(e){return"string"===typeof e}},{name:"boolean",test:function(e){return"boolean"===typeof e}},{name:"Function",test:function(e){return"function"===typeof e}},{name:"Array",test:Array.isArray},{name:"Date",test:function(e){return e instanceof Date}},{name:"RegExp",test:function(e){return e instanceof RegExp}},{name:"Object",test:o},{name:"null",test:function(e){return null===e}},{name:"undefined",test:function(e){return void 0===e}}],s={name:"any",test:e,isAny:!0};let l,c,u=0,d={createCount:0};function h(e){const t=l.get(e);if(t)return t;let n='Unknown type "'+e+'"';const r=e.toLowerCase();let i;for(i of c)if(i.toLowerCase()===r){n+='. Did you mean "'+i+'" ?';break}throw new TypeError(n)}function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"any";const n=t?h(t).index:c.length,r=[];for(let o=0;o<e.length;++o){if(!e[o]||"string"!==typeof e[o].name||"function"!==typeof e[o].test)throw new TypeError("Object with properties {name: string, test: function} expected");const t=e[o].name;if(l.has(t))throw new TypeError('Duplicate type name "'+t+'"');r.push(t),l.set(t,{name:t,test:e[o].test,isAny:e[o].isAny,index:n+o,conversionsTo:[]})}const i=c.slice(n);c=c.slice(0,n).concat(r).concat(i);for(let o=n+r.length;o<c.length;++o)l.get(c[o]).index=o}function m(){l=new Map,c=[],u=0,f([s],!1)}function p(){let e;for(e of c)l.get(e).conversionsTo=[];u=0}function g(e){const t=c.filter(t=>{const n=l.get(t);return!n.isAny&&n.test(e)});return t.length?t:["any"]}function v(e){return e&&"function"===typeof e&&"_typedFunctionData"in e}function y(e,t,n){if(!v(e))throw new TypeError(r);const i=n&&n.exact,o=N(Array.isArray(t)?t.join(","):t),a=x(o);if(!i||a in e.signatures){const t=e._typedFunctionData.signatureMap.get(a);if(t)return t}const s=o.length;let l,c;if(i){let t;for(t in l=[],e.signatures)l.push(e._typedFunctionData.signatureMap.get(t))}else l=e._typedFunctionData.signatures;for(let r=0;r<s;++r){const e=o[r],t=[];let n;for(n of l){const i=k(n.params,r);if(i&&(!e.restParam||i.restParam)){if(!i.hasAny){const t=E(i);if(e.types.some(e=>!t.has(e.name)))continue}t.push(n)}}if(l=t,0===l.length)break}for(c of l)if(c.params.length<=s)return c;throw new TypeError("Signature not found (signature: "+(e.name||"unnamed")+"("+x(o,", ")+"))")}function b(e,t,n){return y(e,t,n).implementation}function w(e,t){const n=h(t);if(n.test(e))return e;const r=n.conversionsTo;if(0===r.length)throw new Error("There are no conversions to "+t+" defined.");for(let i=0;i<r.length;i++)if(h(r[i].from).test(e))return r[i].convert(e);throw new Error("Cannot convert "+e+" to "+t)}function x(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return e.map(e=>e.name).join(t)}function S(e){const t=0===e.indexOf("..."),n=(t?e.length>3?e.slice(3):"any":e).split("|").map(e=>h(e.trim()));let r=!1,i=t?"...":"";return{types:n.map(function(e){return r=e.isAny||r,i+=e.name+"|",{name:e.name,typeIndex:e.index,test:e.test,isAny:e.isAny,conversion:null,conversionIndex:-1}}),name:i.slice(0,-1),hasAny:r,hasConversion:!1,restParam:t}}function C(e){const t=H(e.types.map(e=>e.name));let n=e.hasAny,r=e.name;const i=t.map(function(e){const t=h(e.from);return n=t.isAny||n,r+="|"+e.from,{name:e.from,typeIndex:t.index,test:t.test,isAny:t.isAny,conversion:e,conversionIndex:e.index}});return{types:e.types.concat(i),name:r,hasAny:n,hasConversion:i.length>0,restParam:e.restParam}}function E(e){return e.typeSet||(e.typeSet=new Set,e.types.forEach(t=>e.typeSet.add(t.name))),e.typeSet}function N(e){const t=[];if("string"!==typeof e)throw new TypeError("Signatures must be strings");const n=e.trim();if(""===n)return t;const r=n.split(",");for(let i=0;i<r.length;++i){const e=S(r[i].trim());if(e.restParam&&i!==r.length-1)throw new SyntaxError('Unexpected rest parameter "'+r[i]+'": only allowed for the last parameter');if(0===e.types.length)return null;t.push(e)}return t}function T(e){const t=X(e);return!!t&&t.restParam}function A(t){if(t&&0!==t.types.length){if(1===t.types.length)return h(t.types[0].name).test;if(2===t.types.length){const e=h(t.types[0].name).test,n=h(t.types[1].name).test;return function(t){return e(t)||n(t)}}{const e=t.types.map(function(e){return h(e.name).test});return function(t){for(let n=0;n<e.length;n++)if(e[n](t))return!0;return!1}}}return e}function R(e){let t,n,r;if(T(e)){t=$(e).map(A);const n=t.length,r=A(X(e)),i=function(e){for(let t=n;t<e.length;t++)if(!r(e[t]))return!1;return!0};return function(e){for(let n=0;n<t.length;n++)if(!t[n](e[n]))return!1;return i(e)&&e.length>=n+1}}return 0===e.length?function(e){return 0===e.length}:1===e.length?(n=A(e[0]),function(e){return n(e[0])&&1===e.length}):2===e.length?(n=A(e[0]),r=A(e[1]),function(e){return n(e[0])&&r(e[1])&&2===e.length}):(t=e.map(A),function(e){for(let n=0;n<t.length;n++)if(!t[n](e[n]))return!1;return e.length===t.length})}function k(e,t){return t<e.length?e[t]:T(e)?X(e):null}function M(e,t){const n=k(e,t);return n?E(n):new Set}function D(e){return null===e.conversion||void 0===e.conversion}function _(e,t){const n=new Set;return e.forEach(e=>{const r=M(e.params,t);let i;for(i of r)n.add(i)}),n.has("any")?["any"]:Array.from(n)}function O(e,t,n){let r,i;const o=e||"unnamed";let a,s=n;for(a=0;a<t.length;a++){const e=[];if(s.forEach(n=>{const r=A(k(n.params,a));(a<n.params.length||T(n.params))&&r(t[a])&&e.push(n)}),0===e.length){if(i=_(s,a),i.length>0){const e=g(t[a]);return r=new TypeError("Unexpected type of argument in function "+o+" (expected: "+i.join(" or ")+", actual: "+e.join(" | ")+", index: "+a+")"),r.data={category:"wrongType",fn:o,index:a,actual:e,expected:i},r}}else s=e}const l=s.map(function(e){return T(e.params)?1/0:e.params.length});if(t.length<Math.min.apply(null,l))return i=_(s,a),r=new TypeError("Too few arguments in function "+o+" (expected: "+i.join(" or ")+", index: "+t.length+")"),r.data={category:"tooFewArgs",fn:o,index:t.length,expected:i},r;const c=Math.max.apply(null,l);if(t.length>c)return r=new TypeError("Too many arguments in function "+o+" (expected: "+c+", actual: "+t.length+")"),r.data={category:"tooManyArgs",fn:o,index:t.length,expectedLength:c},r;const u=[];for(let d=0;d<t.length;++d)u.push(g(t[d]).join("|"));return r=new TypeError('Arguments of type "'+u.join(", ")+'" do not match any of the defined signatures of function '+o+"."),r.data={category:"mismatch",actual:u},r}function I(e){let t=c.length+1;for(let n=0;n<e.types.length;n++)D(e.types[n])&&(t=Math.min(t,e.types[n].typeIndex));return t}function P(e){let t=u+1;for(let n=0;n<e.types.length;n++)D(e.types[n])||(t=Math.min(t,e.types[n].conversionIndex));return t}function j(e,t){if(e.hasAny){if(!t.hasAny)return 1}else if(t.hasAny)return-1;if(e.restParam){if(!t.restParam)return 1}else if(t.restParam)return-1;if(e.hasConversion){if(!t.hasConversion)return 1}else if(t.hasConversion)return-1;const n=I(e)-I(t);if(n<0)return-1;if(n>0)return 1;const r=P(e)-P(t);return r<0?-1:r>0?1:0}function F(e,t){const n=e.params,r=t.params,i=X(n),o=X(r),a=T(n),s=T(r);if(a&&i.hasAny){if(!s||!o.hasAny)return 1}else if(s&&o.hasAny)return-1;let l,c=0,u=0;for(l of n)l.hasAny&&++c,l.hasConversion&&++u;let d=0,h=0;for(l of r)l.hasAny&&++d,l.hasConversion&&++h;if(c!==d)return c-d;if(a&&i.hasConversion){if(!s||!o.hasConversion)return 1}else if(s&&o.hasConversion)return-1;if(u!==h)return u-h;if(a){if(!s)return 1}else if(s)return-1;const f=(n.length-r.length)*(a?-1:1);if(0!==f)return f;const m=[];let p,g=0;for(let v=0;v<n.length;++v){const e=j(n[v],r[v]);m.push(e),g+=e}if(0!==g)return g;for(p of m)if(0!==p)return p;return 0}function H(e){if(0===e.length)return[];const t=e.map(h);e.length>1&&t.sort((e,t)=>e.index-t.index);let n=t[0].conversionsTo;if(1===e.length)return n;n=n.concat([]);const r=new Set(e);for(let i=1;i<t.length;++i){let e;for(e of t[i].conversionsTo)r.has(e.from)||(n.push(e),r.add(e.from))}return n}function L(e,t){let n=t;if(e.some(e=>e.hasConversion)){const r=T(e),i=e.map(B);n=function(){const e=[],n=r?arguments.length-1:arguments.length;for(let t=0;t<n;t++)e[t]=i[t](arguments[t]);return r&&(e[n]=arguments[n].map(i[n])),t.apply(this,e)}}let r=n;if(T(e)){const t=e.length-1;r=function(){return n.apply(this,Q(arguments,0,t).concat([Q(arguments,t)]))}}return r}function B(e){let t,n,r,i;const o=[],a=[];switch(e.types.forEach(function(e){e.conversion&&(o.push(h(e.conversion.from).test),a.push(e.conversion.convert))}),a.length){case 0:return function(e){return e};case 1:return t=o[0],r=a[0],function(e){return t(e)?r(e):e};case 2:return t=o[0],n=o[1],r=a[0],i=a[1],function(e){return t(e)?r(e):n(e)?i(e):e};default:return function(e){for(let t=0;t<a.length;t++)if(o[t](e))return a[t](e);return e}}}function z(e){function t(e,n,r){if(n<e.length){const i=e[n];let o=[];if(i.restParam){const e=i.types.filter(D);e.length<i.types.length&&o.push({types:e,name:"..."+e.map(e=>e.name).join("|"),hasAny:e.some(e=>e.isAny),hasConversion:!1,restParam:!0}),o.push(i)}else o=i.types.map(function(e){return{types:[e],name:e.name,hasAny:e.isAny,hasConversion:e.conversion,restParam:!1}});return Z(o,function(i){return t(e,n+1,r.concat([i]))})}return[r]}return t(e,0,[])}function W(e,t){const n=Math.max(e.length,t.length);for(let s=0;s<n;s++){const n=M(e,s),r=M(t,s);let i,o=!1;for(i of r)if(n.has(i)){o=!0;break}if(!o)return!1}const r=e.length,i=t.length,o=T(e),a=T(t);return o?a?r===i:i>=r:a?r>=i:r===i}function V(e){return e.map(e=>ie(e)?ne(e.referToSelf.callback):re(e)?te(e.referTo.references,e.referTo.callback):e)}function U(e,t,n){const r=[];let i;for(i of e){let e=n[i];if("number"!==typeof e)throw new TypeError('No definition for referenced signature "'+i+'"');if(e=t[e],"function"!==typeof e)return!1;r.push(e)}return r}function q(e,t,n){const r=V(e),i=new Array(r.length).fill(!1);let o=!0;for(;o;){o=!1;let e=!0;for(let a=0;a<r.length;++a){if(i[a])continue;const s=r[a];if(ie(s))r[a]=s.referToSelf.callback(n),r[a].referToSelf=s.referToSelf,i[a]=!0,e=!1;else if(re(s)){const n=U(s.referTo.references,r,t);n?(r[a]=s.referTo.callback.apply(this,n),r[a].referTo=s.referTo,i[a]=!0,e=!1):o=!0}}if(e&&o)throw new SyntaxError("Circular reference detected in resolving typed.referTo")}return r}function G(e){const t=/\bthis(\(|\.signatures\b)/;Object.keys(e).forEach(n=>{const r=e[n];if(t.test(r.toString()))throw new SyntaxError("Using `this` to self-reference a function is deprecated since typed-function@3. Use typed.referTo and typed.referToSelf instead.")})}function Y(e,r){if(d.createCount++,0===Object.keys(r).length)throw new SyntaxError("No signatures provided");d.warnAgainstDeprecatedThis&&G(r);const i=[],o=[],a={},s=[];let l;for(l in r){if(!Object.prototype.hasOwnProperty.call(r,l))continue;const e=N(l);if(!e)continue;i.forEach(function(t){if(W(t,e))throw new TypeError('Conflicting signatures "'+x(t)+'" and "'+x(e)+'".')}),i.push(e);const t=o.length;o.push(r[l]);const n=e.map(C);let c;for(c of z(n)){const e=x(c);s.push({params:c,name:e,fn:t}),c.every(e=>!e.hasConversion)&&(a[e]=t)}}s.sort(F);const c=q(o,a,le);let u;for(u in a)Object.prototype.hasOwnProperty.call(a,u)&&(a[u]=c[a[u]]);const h=[],f=new Map;for(u of s)f.has(u.name)||(u.fn=c[u.fn],h.push(u),f.set(u.name,u));const m=h[0]&&h[0].params.length<=2&&!T(h[0].params),p=h[1]&&h[1].params.length<=2&&!T(h[1].params),g=h[2]&&h[2].params.length<=2&&!T(h[2].params),v=h[3]&&h[3].params.length<=2&&!T(h[3].params),y=h[4]&&h[4].params.length<=2&&!T(h[4].params),b=h[5]&&h[5].params.length<=2&&!T(h[5].params),w=m&&p&&g&&v&&y&&b;for(let t=0;t<h.length;++t)h[t].test=R(h[t].params);const S=m?A(h[0].params[0]):t,E=p?A(h[1].params[0]):t,k=g?A(h[2].params[0]):t,M=v?A(h[3].params[0]):t,D=y?A(h[4].params[0]):t,_=b?A(h[5].params[0]):t,O=m?A(h[0].params[1]):t,I=p?A(h[1].params[1]):t,P=g?A(h[2].params[1]):t,j=v?A(h[3].params[1]):t,H=y?A(h[4].params[1]):t,B=b?A(h[5].params[1]):t;for(let t=0;t<h.length;++t)h[t].implementation=L(h[t].params,h[t].fn);const V=m?h[0].implementation:n,U=p?h[1].implementation:n,Y=g?h[2].implementation:n,K=v?h[3].implementation:n,$=y?h[4].implementation:n,X=b?h[5].implementation:n,Q=m?h[0].params.length:-1,J=p?h[1].params.length:-1,Z=g?h[2].params.length:-1,ee=v?h[3].params.length:-1,te=y?h[4].params.length:-1,ne=b?h[5].params.length:-1,re=w?6:0,ie=h.length,oe=h.map(e=>e.test),ae=h.map(e=>e.implementation),se=function(){for(let e=re;e<ie;e++)if(oe[e](arguments))return ae[e].apply(this,arguments);return d.onMismatch(e,arguments,h)};function le(e,t){return arguments.length===Q&&S(e)&&O(t)?V.apply(this,arguments):arguments.length===J&&E(e)&&I(t)?U.apply(this,arguments):arguments.length===Z&&k(e)&&P(t)?Y.apply(this,arguments):arguments.length===ee&&M(e)&&j(t)?K.apply(this,arguments):arguments.length===te&&D(e)&&H(t)?$.apply(this,arguments):arguments.length===ne&&_(e)&&B(t)?X.apply(this,arguments):se.apply(this,arguments)}try{Object.defineProperty(le,"name",{value:e})}catch(ce){}return le.signatures=a,le._typedFunctionData={signatures:h,signatureMap:f},le}function K(e,t,n){throw O(e,t,n)}function $(e){return Q(e,0,e.length-1)}function X(e){return e[e.length-1]}function Q(e,t,n){return Array.prototype.slice.call(e,t,n)}function J(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return e[n]}function Z(e,t){return Array.prototype.concat.apply([],e.map(t))}function ee(){const e=$(arguments).map(e=>x(N(e))),t=X(arguments);if("function"!==typeof t)throw new TypeError("Callback function expected as last argument");return te(e,t)}function te(e,t){return{referTo:{references:e,callback:t}}}function ne(e){if("function"!==typeof e)throw new TypeError("Callback function expected as first argument");return{referToSelf:{callback:e}}}function re(e){return e&&"object"===typeof e.referTo&&Array.isArray(e.referTo.references)&&"function"===typeof e.referTo.callback}function ie(e){return e&&"object"===typeof e.referToSelf&&"function"===typeof e.referToSelf.callback}function oe(e,t){if(!e)return t;if(t&&t!==e){const n=new Error("Function names do not match (expected: "+e+", actual: "+t+")");throw n.data={actual:t,expected:e},n}return e}function ae(e){let t;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(v(e[n])||"string"===typeof e[n].signature)&&(t=oe(t,e[n].name));return t}function se(e,t){let n;for(n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(n in e&&t[n]!==e[n]){const r=new Error('Signature "'+n+'" is defined twice');throw r.data={signature:n,sourceFunction:t[n],destFunction:e[n]},r}e[n]=t[n]}}m(),f(a);const le=d;function ce(e){if(!e||"string"!==typeof e.from||"string"!==typeof e.to||"function"!==typeof e.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");if(e.to===e.from)throw new SyntaxError('Illegal to define conversion from "'+e.from+'" to itself.')}return d=function(e){const t="string"===typeof e;let n=t?e:"";const r={};for(let i=t?1:0;i<arguments.length;++i){const e=arguments[i];let a,s={};if("function"===typeof e?(a=e.name,"string"===typeof e.signature?s[e.signature]=e:v(e)&&(s=e.signatures)):o(e)&&(s=e,t||(a=ae(e))),0===Object.keys(s).length){const t=new TypeError("Argument to 'typed' at index "+i+" is not a (typed) function, nor an object with signatures as keys and functions as values.");throw t.data={index:i,argument:e},t}t||(n=oe(n,a)),se(r,s)}return Y(n||"",r)},d.create=i,d.createCount=le.createCount,d.onMismatch=K,d.throwMismatchError=K,d.createError=O,d.clear=m,d.clearConversions=p,d.addTypes=f,d._findType=h,d.referTo=ee,d.referToSelf=ne,d.convert=w,d.findSignature=y,d.find=b,d.isTypedFunction=v,d.warnAgainstDeprecatedThis=!0,d.addType=function(e,t){let n="any";!1!==t&&l.has("Object")&&(n="Object"),d.addTypes([e],n)},d.addConversion=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{override:!1};ce(e);const n=h(e.to),r=n.conversionsTo.find(t=>t.from===e.from);if(r){if(!t||!t.override)throw new Error('There is already a conversion from "'+e.from+'" to "'+n.name+'"');d.removeConversion({from:r.from,to:e.to,convert:r.convert})}n.conversionsTo.push({from:e.from,convert:e.convert,index:u++})},d.addConversions=function(e,t){e.forEach(e=>d.addConversion(e,t))},d.removeConversion=function(e){ce(e);const t=h(e.to),n=J(t.conversionsTo,t=>t.from===e.from);if(!n)throw new Error("Attempt to remove nonexistent conversion from "+e.from+" to "+e.to);if(n.convert!==e.convert)throw new Error("Conversion to remove does not match existing conversion");const r=t.conversionsTo.indexOf(n);t.conversionsTo.splice(r,1)},d.resolve=function(e,t){if(!v(e))throw new TypeError(r);const n=e._typedFunctionData.signatures;for(let r=0;r<n.length;++r)if(n[r].test(t))return n[r];return null},d}return i()}()},5464:e=>{"use strict";var t=String;e.exports=function(e){try{return t(e)}catch(n){return"Object"}}},5551:(e,t,n)=>{"use strict";var r=n(4706),i=n(3572),o=n(4416),a=n(3036);e.exports=function(e,t,n,s){s||(s={});var l=s.enumerable,c=void 0!==s.name?s.name:t;if(r(n)&&o(n,c,s),s.global)l?e[t]=n:a(t,n);else{try{s.unsafe?e[t]&&(l=!0):delete e[t]}catch(u){}l?e[t]=n:i.f(e,t,{value:n,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return e}},5555:(e,t,n)=>{"use strict";var r=n(6164),i=n(2682),o=n(5214),a=n(3572);e.exports=function(e,t,n){for(var s=i(t),l=a.f,c=o.f,u=0;u<s.length;u++){var d=s[u];r(e,d)||n&&r(n,d)||l(e,d,c(t,d))}}},5687:(e,t,n)=>{"use strict";var r=n(7707),i=r({}.toString),o=r("".slice);e.exports=function(e){return o(i(e),8,-1)}},5704:(e,t,n)=>{"use strict";var r=n(7592),i=n(4823),o=n(3036),a="__core-js_shared__",s=e.exports=i[a]||o(a,{});(s.versions||(s.versions=[])).push({version:"3.46.0",mode:r?"pure":"global",copyright:"\xa9 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.46.0/LICENSE",source:"https://github.com/zloirock/core-js"})},5896:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,a=i>>>1;r<a;){var s=2*(r+1)-1,l=e[s],c=s+1,u=e[c];if(0>o(l,n))c<i&&0>o(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[s]=n,r=s);else{if(!(c<i&&0>o(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],u=[],d=1,h=null,f=3,m=!1,p=!1,g=!1,v=!1,y="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function S(e){if(g=!1,x(e),!p)if(null!==r(c))p=!0,E||(E=!0,C());else{var t=r(u);null!==t&&_(S,t.startTime-e)}}var C,E=!1,N=-1,T=5,A=-1;function R(){return!!v||!(t.unstable_now()-A<T)}function k(){if(v=!1,E){var e=t.unstable_now();A=e;var n=!0;try{e:{p=!1,g&&(g=!1,b(N),N=-1),m=!0;var o=f;try{t:{for(x(e),h=r(c);null!==h&&!(h.expirationTime>e&&R());){var a=h.callback;if("function"===typeof a){h.callback=null,f=h.priorityLevel;var s=a(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof s){h.callback=s,x(e),n=!0;break t}h===r(c)&&i(c),x(e)}else i(c);h=r(c)}if(null!==h)n=!0;else{var l=r(u);null!==l&&_(S,l.startTime-e),n=!1}}break e}finally{h=null,f=o,m=!1}n=void 0}}finally{n?C():E=!1}}}if("function"===typeof w)C=function(){w(k)};else if("undefined"!==typeof MessageChannel){var M=new MessageChannel,D=M.port2;M.port1.onmessage=k,C=function(){D.postMessage(null)}}else C=function(){y(k,0)};function _(e,n){N=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,o){var a=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?a+o:a:o=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(e.sortIndex=o,n(u,e),null===r(c)&&e===r(u)&&(g?(b(N),N=-1):g=!0,_(S,o-a))):(e.sortIndex=s,n(c,e),p||m||(p=!0,E||(E=!0,C()))),e},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},5897:(e,t,n)=>{"use strict";var r=n(8084);e.exports=!r(function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})},5939:e=>{e.exports=function e(t,n){"use strict";var r,i,o=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,a=/(^[ ]*|[ ]*$)/g,s=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,l=/^0x[0-9a-f]+$/i,c=/^0/,u=function(t){return e.insensitive&&(""+t).toLowerCase()||""+t},d=u(t).replace(a,"")||"",h=u(n).replace(a,"")||"",f=d.replace(o,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),m=h.replace(o,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),p=parseInt(d.match(l),16)||1!==f.length&&d.match(s)&&Date.parse(d),g=parseInt(h.match(l),16)||p&&h.match(s)&&Date.parse(h)||null;if(g){if(p<g)return-1;if(p>g)return 1}for(var v=0,y=Math.max(f.length,m.length);v<y;v++){if(r=!(f[v]||"").match(c)&&parseFloat(f[v])||f[v]||0,i=!(m[v]||"").match(c)&&parseFloat(m[v])||m[v]||0,isNaN(r)!==isNaN(i))return isNaN(r)?1:-1;if(typeof r!==typeof i&&(r+="",i+=""),r<i)return-1;if(r>i)return 1}return 0}},6023:(e,t,n)=>{"use strict";var r=n(6715),i=n(4823),o=n(9464).clear;r({global:!0,bind:!0,enumerable:!0,forced:i.clearImmediate!==o},{clearImmediate:o})},6079:(e,t,n)=>{"use strict";var r=n(8084),i=n(4706),o=/#|\.prototype\./,a=function(e,t){var n=l[s(e)];return n===u||n!==c&&(i(t)?r(t):!!t)},s=a.normalize=function(e){return String(e).replace(o,".").toLowerCase()},l=a.data={},c=a.NATIVE="N",u=a.POLYFILL="P";e.exports=a},6115:(e,t,n)=>{"use strict";var r,i=n(1608),o=n(8612),a=n(4291),s=n(3114),l=n(904),c=n(2760),u=n(4658),d="prototype",h="script",f=u("IE_PROTO"),m=function(){},p=function(e){return"<"+h+">"+e+"</"+h+">"},g=function(e){e.write(p("")),e.close();var t=e.parentWindow.Object;return e=null,t},v=function(){try{r=new ActiveXObject("htmlfile")}catch(t){}v="undefined"!=typeof document?document.domain&&r?g(r):function(){var e,t=c("iframe"),n="java"+h+":";return t.style.display="none",l.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(p("document.F=Object")),e.close(),e.F}():g(r);for(var e=a.length;e--;)delete v[d][a[e]];return v()};s[f]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(m[d]=i(e),n=new m,m[d]=null,n[f]=e):n=v(),void 0===t?n:o.f(n,t)}},6164:(e,t,n)=>{"use strict";var r=n(7707),i=n(2522),o=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(i(e),t)}},6178:function(e,t,n){(e=n.nmd(e)).exports=function(){"use strict";var t,n;function r(){return t.apply(null,arguments)}function i(e){t=e}function o(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function a(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function s(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function l(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(s(e,t))return!1;return!0}function c(e){return void 0===e}function u(e){return"number"===typeof e||"[object Number]"===Object.prototype.toString.call(e)}function d(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function h(e,t){var n,r=[],i=e.length;for(n=0;n<i;++n)r.push(t(e[n],n));return r}function f(e,t){for(var n in t)s(t,n)&&(e[n]=t[n]);return s(t,"toString")&&(e.toString=t.toString),s(t,"valueOf")&&(e.valueOf=t.valueOf),e}function m(e,t,n,r){return Kn(e,t,n,r,!0).utc()}function p(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function g(e){return null==e._pf&&(e._pf=p()),e._pf}function v(e){var t=null,r=!1,i=e._d&&!isNaN(e._d.getTime());return i&&(t=g(e),r=n.call(t.parsedDateParts,function(e){return null!=e}),i=t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r),e._strict&&(i=i&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour)),null!=Object.isFrozen&&Object.isFrozen(e)?i:(e._isValid=i,e._isValid)}function y(e){var t=m(NaN);return null!=e?f(g(t),e):g(t).userInvalidated=!0,t}n=Array.prototype.some?Array.prototype.some:function(e){var t,n=Object(this),r=n.length>>>0;for(t=0;t<r;t++)if(t in n&&e.call(this,n[t],t,n))return!0;return!1};var b=r.momentProperties=[],w=!1;function x(e,t){var n,r,i,o=b.length;if(c(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),c(t._i)||(e._i=t._i),c(t._f)||(e._f=t._f),c(t._l)||(e._l=t._l),c(t._strict)||(e._strict=t._strict),c(t._tzm)||(e._tzm=t._tzm),c(t._isUTC)||(e._isUTC=t._isUTC),c(t._offset)||(e._offset=t._offset),c(t._pf)||(e._pf=g(t)),c(t._locale)||(e._locale=t._locale),o>0)for(n=0;n<o;n++)c(i=t[r=b[n]])||(e[r]=i);return e}function S(e){x(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===w&&(w=!0,r.updateOffset(this),w=!1)}function C(e){return e instanceof S||null!=e&&null!=e._isAMomentObject}function E(e){!1===r.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function N(e,t){var n=!0;return f(function(){if(null!=r.deprecationHandler&&r.deprecationHandler(null,e),n){var i,o,a,l=[],c=arguments.length;for(o=0;o<c;o++){if(i="","object"===typeof arguments[o]){for(a in i+="\n["+o+"] ",arguments[0])s(arguments[0],a)&&(i+=a+": "+arguments[0][a]+", ");i=i.slice(0,-2)}else i=arguments[o];l.push(i)}E(e+"\nArguments: "+Array.prototype.slice.call(l).join("")+"\n"+(new Error).stack),n=!1}return t.apply(this,arguments)},t)}var T,A={};function R(e,t){null!=r.deprecationHandler&&r.deprecationHandler(e,t),A[e]||(E(t),A[e]=!0)}function k(e){return"undefined"!==typeof Function&&e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function M(e){var t,n;for(n in e)s(e,n)&&(k(t=e[n])?this[n]=t:this["_"+n]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function D(e,t){var n,r=f({},e);for(n in t)s(t,n)&&(a(e[n])&&a(t[n])?(r[n]={},f(r[n],e[n]),f(r[n],t[n])):null!=t[n]?r[n]=t[n]:delete r[n]);for(n in e)s(e,n)&&!s(t,n)&&a(e[n])&&(r[n]=f({},r[n]));return r}function _(e){null!=e&&this.set(e)}r.suppressDeprecationWarnings=!1,r.deprecationHandler=null,T=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)s(e,t)&&n.push(t);return n};var O={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function I(e,t,n){var r=this._calendar[e]||this._calendar.sameElse;return k(r)?r.call(t,n):r}function P(e,t,n){var r=""+Math.abs(e),i=t-r.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var j=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,F=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,H={},L={};function B(e,t,n,r){var i=r;"string"===typeof r&&(i=function(){return this[r]()}),e&&(L[e]=i),t&&(L[t[0]]=function(){return P(i.apply(this,arguments),t[1],t[2])}),n&&(L[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function z(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function W(e){var t,n,r=e.match(j);for(t=0,n=r.length;t<n;t++)L[r[t]]?r[t]=L[r[t]]:r[t]=z(r[t]);return function(t){var i,o="";for(i=0;i<n;i++)o+=k(r[i])?r[i].call(t,e):r[i];return o}}function V(e,t){return e.isValid()?(t=U(t,e.localeData()),H[t]=H[t]||W(t),H[t](e)):e.localeData().invalidDate()}function U(e,t){var n=5;function r(e){return t.longDateFormat(e)||e}for(F.lastIndex=0;n>=0&&F.test(e);)e=e.replace(F,r),F.lastIndex=0,n-=1;return e}var q={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function G(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.match(j).map(function(e){return"MMMM"===e||"MM"===e||"DD"===e||"dddd"===e?e.slice(1):e}).join(""),this._longDateFormat[e])}var Y="Invalid date";function K(){return this._invalidDate}var $="%d",X=/\d{1,2}/;function Q(e){return this._ordinal.replace("%d",e)}var J={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Z(e,t,n,r){var i=this._relativeTime[n];return k(i)?i(e,t,n,r):i.replace(/%d/i,e)}function ee(e,t){var n=this._relativeTime[e>0?"future":"past"];return k(n)?n(t):n.replace(/%s/i,t)}var te={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function ne(e){return"string"===typeof e?te[e]||te[e.toLowerCase()]:void 0}function re(e){var t,n,r={};for(n in e)s(e,n)&&(t=ne(n))&&(r[t]=e[n]);return r}var ie={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function oe(e){var t,n=[];for(t in e)s(e,t)&&n.push({unit:t,priority:ie[t]});return n.sort(function(e,t){return e.priority-t.priority}),n}var ae,se=/\d/,le=/\d\d/,ce=/\d{3}/,ue=/\d{4}/,de=/[+-]?\d{6}/,he=/\d\d?/,fe=/\d\d\d\d?/,me=/\d\d\d\d\d\d?/,pe=/\d{1,3}/,ge=/\d{1,4}/,ve=/[+-]?\d{1,6}/,ye=/\d+/,be=/[+-]?\d+/,we=/Z|[+-]\d\d:?\d\d/gi,xe=/Z|[+-]\d\d(?::?\d\d)?/gi,Se=/[+-]?\d+(\.\d{1,3})?/,Ce=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Ee=/^[1-9]\d?/,Ne=/^([1-9]\d|\d)/;function Te(e,t,n){ae[e]=k(t)?t:function(e,r){return e&&n?n:t}}function Ae(e,t){return s(ae,e)?ae[e](t._strict,t._locale):new RegExp(Re(e))}function Re(e){return ke(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,i){return t||n||r||i}))}function ke(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Me(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function De(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=Me(t)),n}ae={};var _e={};function Oe(e,t){var n,r,i=t;for("string"===typeof e&&(e=[e]),u(t)&&(i=function(e,n){n[t]=De(e)}),r=e.length,n=0;n<r;n++)_e[e[n]]=i}function Ie(e,t){Oe(e,function(e,n,r,i){r._w=r._w||{},t(e,r._w,r,i)})}function Pe(e,t,n){null!=t&&s(_e,e)&&_e[e](t,n._a,n,e)}function je(e){return e%4===0&&e%100!==0||e%400===0}var Fe=0,He=1,Le=2,Be=3,ze=4,We=5,Ve=6,Ue=7,qe=8;function Ge(e){return je(e)?366:365}B("Y",0,0,function(){var e=this.year();return e<=9999?P(e,4):"+"+e}),B(0,["YY",2],0,function(){return this.year()%100}),B(0,["YYYY",4],0,"year"),B(0,["YYYYY",5],0,"year"),B(0,["YYYYYY",6,!0],0,"year"),Te("Y",be),Te("YY",he,le),Te("YYYY",ge,ue),Te("YYYYY",ve,de),Te("YYYYYY",ve,de),Oe(["YYYYY","YYYYYY"],Fe),Oe("YYYY",function(e,t){t[Fe]=2===e.length?r.parseTwoDigitYear(e):De(e)}),Oe("YY",function(e,t){t[Fe]=r.parseTwoDigitYear(e)}),Oe("Y",function(e,t){t[Fe]=parseInt(e,10)}),r.parseTwoDigitYear=function(e){return De(e)+(De(e)>68?1900:2e3)};var Ye,Ke=Xe("FullYear",!0);function $e(){return je(this.year())}function Xe(e,t){return function(n){return null!=n?(Je(this,e,n),r.updateOffset(this,t),this):Qe(this,e)}}function Qe(e,t){if(!e.isValid())return NaN;var n=e._d,r=e._isUTC;switch(t){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function Je(e,t,n){var r,i,o,a,s;if(e.isValid()&&!isNaN(n)){switch(r=e._d,i=e._isUTC,t){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,a=e.month(),s=29!==(s=e.date())||1!==a||je(o)?s:28,i?r.setUTCFullYear(o,a,s):r.setFullYear(o,a,s)}}function Ze(e){return k(this[e=ne(e)])?this[e]():this}function et(e,t){if("object"===typeof e){var n,r=oe(e=re(e)),i=r.length;for(n=0;n<i;n++)this[r[n].unit](e[r[n].unit])}else if(k(this[e=ne(e)]))return this[e](t);return this}function tt(e,t){return(e%t+t)%t}function nt(e,t){if(isNaN(e)||isNaN(t))return NaN;var n=tt(t,12);return e+=(t-n)/12,1===n?je(e)?29:28:31-n%7%2}Ye=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},B("M",["MM",2],"Mo",function(){return this.month()+1}),B("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),B("MMMM",0,0,function(e){return this.localeData().months(this,e)}),Te("M",he,Ee),Te("MM",he,le),Te("MMM",function(e,t){return t.monthsShortRegex(e)}),Te("MMMM",function(e,t){return t.monthsRegex(e)}),Oe(["M","MM"],function(e,t){t[He]=De(e)-1}),Oe(["MMM","MMMM"],function(e,t,n,r){var i=n._locale.monthsParse(e,r,n._strict);null!=i?t[He]=i:g(n).invalidMonth=e});var rt="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),it="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),ot=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,at=Ce,st=Ce;function lt(e,t){return e?o(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||ot).test(t)?"format":"standalone"][e.month()]:o(this._months)?this._months:this._months.standalone}function ct(e,t){return e?o(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[ot.test(t)?"format":"standalone"][e.month()]:o(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ut(e,t,n){var r,i,o,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=m([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(i=Ye.call(this._shortMonthsParse,a))?i:null:-1!==(i=Ye.call(this._longMonthsParse,a))?i:null:"MMM"===t?-1!==(i=Ye.call(this._shortMonthsParse,a))||-1!==(i=Ye.call(this._longMonthsParse,a))?i:null:-1!==(i=Ye.call(this._longMonthsParse,a))||-1!==(i=Ye.call(this._shortMonthsParse,a))?i:null}function dt(e,t,n){var r,i,o;if(this._monthsParseExact)return ut.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=m([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(n&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!n&&this._monthsParse[r].test(e))return r}}function ht(e,t){if(!e.isValid())return e;if("string"===typeof t)if(/^\d+$/.test(t))t=De(t);else if(!u(t=e.localeData().monthsParse(t)))return e;var n=t,r=e.date();return r=r<29?r:Math.min(r,nt(e.year(),n)),e._isUTC?e._d.setUTCMonth(n,r):e._d.setMonth(n,r),e}function ft(e){return null!=e?(ht(this,e),r.updateOffset(this,!0),this):Qe(this,"Month")}function mt(){return nt(this.year(),this.month())}function pt(e){return this._monthsParseExact?(s(this,"_monthsRegex")||vt.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(s(this,"_monthsShortRegex")||(this._monthsShortRegex=at),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function gt(e){return this._monthsParseExact?(s(this,"_monthsRegex")||vt.call(this),e?this._monthsStrictRegex:this._monthsRegex):(s(this,"_monthsRegex")||(this._monthsRegex=st),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function vt(){function e(e,t){return t.length-e.length}var t,n,r,i,o=[],a=[],s=[];for(t=0;t<12;t++)n=m([2e3,t]),r=ke(this.monthsShort(n,"")),i=ke(this.months(n,"")),o.push(r),a.push(i),s.push(i),s.push(r);o.sort(e),a.sort(e),s.sort(e),this._monthsRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+o.join("|")+")","i")}function yt(e,t,n,r,i,o,a){var s;return e<100&&e>=0?(s=new Date(e+400,t,n,r,i,o,a),isFinite(s.getFullYear())&&s.setFullYear(e)):s=new Date(e,t,n,r,i,o,a),s}function bt(e){var t,n;return e<100&&e>=0?((n=Array.prototype.slice.call(arguments))[0]=e+400,t=new Date(Date.UTC.apply(null,n)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function wt(e,t,n){var r=7+t-n;return-(7+bt(e,0,r).getUTCDay()-t)%7+r-1}function xt(e,t,n,r,i){var o,a,s=1+7*(t-1)+(7+n-r)%7+wt(e,r,i);return s<=0?a=Ge(o=e-1)+s:s>Ge(e)?(o=e+1,a=s-Ge(e)):(o=e,a=s),{year:o,dayOfYear:a}}function St(e,t,n){var r,i,o=wt(e.year(),t,n),a=Math.floor((e.dayOfYear()-o-1)/7)+1;return a<1?r=a+Ct(i=e.year()-1,t,n):a>Ct(e.year(),t,n)?(r=a-Ct(e.year(),t,n),i=e.year()+1):(i=e.year(),r=a),{week:r,year:i}}function Ct(e,t,n){var r=wt(e,t,n),i=wt(e+1,t,n);return(Ge(e)-r+i)/7}function Et(e){return St(e,this._week.dow,this._week.doy).week}B("w",["ww",2],"wo","week"),B("W",["WW",2],"Wo","isoWeek"),Te("w",he,Ee),Te("ww",he,le),Te("W",he,Ee),Te("WW",he,le),Ie(["w","ww","W","WW"],function(e,t,n,r){t[r.substr(0,1)]=De(e)});var Nt={dow:0,doy:6};function Tt(){return this._week.dow}function At(){return this._week.doy}function Rt(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function kt(e){var t=St(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function Mt(e,t){return"string"!==typeof e?e:isNaN(e)?"number"===typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}function Dt(e,t){return"string"===typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function _t(e,t){return e.slice(t,7).concat(e.slice(0,t))}B("d",0,"do","day"),B("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),B("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),B("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),B("e",0,0,"weekday"),B("E",0,0,"isoWeekday"),Te("d",he),Te("e",he),Te("E",he),Te("dd",function(e,t){return t.weekdaysMinRegex(e)}),Te("ddd",function(e,t){return t.weekdaysShortRegex(e)}),Te("dddd",function(e,t){return t.weekdaysRegex(e)}),Ie(["dd","ddd","dddd"],function(e,t,n,r){var i=n._locale.weekdaysParse(e,r,n._strict);null!=i?t.d=i:g(n).invalidWeekday=e}),Ie(["d","e","E"],function(e,t,n,r){t[r]=De(e)});var Ot="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),It="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Pt="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),jt=Ce,Ft=Ce,Ht=Ce;function Lt(e,t){var n=o(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?_t(n,this._week.dow):e?n[e.day()]:n}function Bt(e){return!0===e?_t(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function zt(e){return!0===e?_t(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Wt(e,t,n){var r,i,o,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=m([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(i=Ye.call(this._weekdaysParse,a))?i:null:"ddd"===t?-1!==(i=Ye.call(this._shortWeekdaysParse,a))?i:null:-1!==(i=Ye.call(this._minWeekdaysParse,a))?i:null:"dddd"===t?-1!==(i=Ye.call(this._weekdaysParse,a))||-1!==(i=Ye.call(this._shortWeekdaysParse,a))||-1!==(i=Ye.call(this._minWeekdaysParse,a))?i:null:"ddd"===t?-1!==(i=Ye.call(this._shortWeekdaysParse,a))||-1!==(i=Ye.call(this._weekdaysParse,a))||-1!==(i=Ye.call(this._minWeekdaysParse,a))?i:null:-1!==(i=Ye.call(this._minWeekdaysParse,a))||-1!==(i=Ye.call(this._weekdaysParse,a))||-1!==(i=Ye.call(this._shortWeekdaysParse,a))?i:null}function Vt(e,t,n){var r,i,o;if(this._weekdaysParseExact)return Wt.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=m([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[r].test(e))return r;if(n&&"ddd"===t&&this._shortWeekdaysParse[r].test(e))return r;if(n&&"dd"===t&&this._minWeekdaysParse[r].test(e))return r;if(!n&&this._weekdaysParse[r].test(e))return r}}function Ut(e){if(!this.isValid())return null!=e?this:NaN;var t=Qe(this,"Day");return null!=e?(e=Mt(e,this.localeData()),this.add(e-t,"d")):t}function qt(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function Gt(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=Dt(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function Yt(e){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||Xt.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(s(this,"_weekdaysRegex")||(this._weekdaysRegex=jt),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Kt(e){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||Xt.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(s(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Ft),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function $t(e){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||Xt.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(s(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ht),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Xt(){function e(e,t){return t.length-e.length}var t,n,r,i,o,a=[],s=[],l=[],c=[];for(t=0;t<7;t++)n=m([2e3,1]).day(t),r=ke(this.weekdaysMin(n,"")),i=ke(this.weekdaysShort(n,"")),o=ke(this.weekdays(n,"")),a.push(r),s.push(i),l.push(o),c.push(r),c.push(i),c.push(o);a.sort(e),s.sort(e),l.sort(e),c.sort(e),this._weekdaysRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function Qt(){return this.hours()%12||12}function Jt(){return this.hours()||24}function Zt(e,t){B(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function en(e,t){return t._meridiemParse}function tn(e){return"p"===(e+"").toLowerCase().charAt(0)}B("H",["HH",2],0,"hour"),B("h",["hh",2],0,Qt),B("k",["kk",2],0,Jt),B("hmm",0,0,function(){return""+Qt.apply(this)+P(this.minutes(),2)}),B("hmmss",0,0,function(){return""+Qt.apply(this)+P(this.minutes(),2)+P(this.seconds(),2)}),B("Hmm",0,0,function(){return""+this.hours()+P(this.minutes(),2)}),B("Hmmss",0,0,function(){return""+this.hours()+P(this.minutes(),2)+P(this.seconds(),2)}),Zt("a",!0),Zt("A",!1),Te("a",en),Te("A",en),Te("H",he,Ne),Te("h",he,Ee),Te("k",he,Ee),Te("HH",he,le),Te("hh",he,le),Te("kk",he,le),Te("hmm",fe),Te("hmmss",me),Te("Hmm",fe),Te("Hmmss",me),Oe(["H","HH"],Be),Oe(["k","kk"],function(e,t,n){var r=De(e);t[Be]=24===r?0:r}),Oe(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),Oe(["h","hh"],function(e,t,n){t[Be]=De(e),g(n).bigHour=!0}),Oe("hmm",function(e,t,n){var r=e.length-2;t[Be]=De(e.substr(0,r)),t[ze]=De(e.substr(r)),g(n).bigHour=!0}),Oe("hmmss",function(e,t,n){var r=e.length-4,i=e.length-2;t[Be]=De(e.substr(0,r)),t[ze]=De(e.substr(r,2)),t[We]=De(e.substr(i)),g(n).bigHour=!0}),Oe("Hmm",function(e,t,n){var r=e.length-2;t[Be]=De(e.substr(0,r)),t[ze]=De(e.substr(r))}),Oe("Hmmss",function(e,t,n){var r=e.length-4,i=e.length-2;t[Be]=De(e.substr(0,r)),t[ze]=De(e.substr(r,2)),t[We]=De(e.substr(i))});var nn=/[ap]\.?m?\.?/i,rn=Xe("Hours",!0);function on(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}var an,sn={calendar:O,longDateFormat:q,invalidDate:Y,ordinal:$,dayOfMonthOrdinalParse:X,relativeTime:J,months:rt,monthsShort:it,week:Nt,weekdays:Ot,weekdaysMin:Pt,weekdaysShort:It,meridiemParse:nn},ln={},cn={};function un(e,t){var n,r=Math.min(e.length,t.length);for(n=0;n<r;n+=1)if(e[n]!==t[n])return n;return r}function dn(e){return e?e.toLowerCase().replace("_","-"):e}function hn(e){for(var t,n,r,i,o=0;o<e.length;){for(t=(i=dn(e[o]).split("-")).length,n=(n=dn(e[o+1]))?n.split("-"):null;t>0;){if(r=mn(i.slice(0,t).join("-")))return r;if(n&&n.length>=t&&un(i,n)>=t-1)break;t--}o++}return an}function fn(e){return!(!e||!e.match("^[^/\\\\]*$"))}function mn(t){var n=null;if(void 0===ln[t]&&e&&e.exports&&fn(t))try{n=an._abbr,Object(function(){var e=new Error("Cannot find module 'undefined'");throw e.code="MODULE_NOT_FOUND",e}()),pn(n)}catch(r){ln[t]=null}return ln[t]}function pn(e,t){var n;return e&&((n=c(t)?yn(e):gn(e,t))?an=n:"undefined"!==typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),an._abbr}function gn(e,t){if(null!==t){var n,r=sn;if(t.abbr=e,null!=ln[e])R("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=ln[e]._config;else if(null!=t.parentLocale)if(null!=ln[t.parentLocale])r=ln[t.parentLocale]._config;else{if(null==(n=mn(t.parentLocale)))return cn[t.parentLocale]||(cn[t.parentLocale]=[]),cn[t.parentLocale].push({name:e,config:t}),null;r=n._config}return ln[e]=new _(D(r,t)),cn[e]&&cn[e].forEach(function(e){gn(e.name,e.config)}),pn(e),ln[e]}return delete ln[e],null}function vn(e,t){if(null!=t){var n,r,i=sn;null!=ln[e]&&null!=ln[e].parentLocale?ln[e].set(D(ln[e]._config,t)):(null!=(r=mn(e))&&(i=r._config),t=D(i,t),null==r&&(t.abbr=e),(n=new _(t)).parentLocale=ln[e],ln[e]=n),pn(e)}else null!=ln[e]&&(null!=ln[e].parentLocale?(ln[e]=ln[e].parentLocale,e===pn()&&pn(e)):null!=ln[e]&&delete ln[e]);return ln[e]}function yn(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return an;if(!o(e)){if(t=mn(e))return t;e=[e]}return hn(e)}function bn(){return T(ln)}function wn(e){var t,n=e._a;return n&&-2===g(e).overflow&&(t=n[He]<0||n[He]>11?He:n[Le]<1||n[Le]>nt(n[Fe],n[He])?Le:n[Be]<0||n[Be]>24||24===n[Be]&&(0!==n[ze]||0!==n[We]||0!==n[Ve])?Be:n[ze]<0||n[ze]>59?ze:n[We]<0||n[We]>59?We:n[Ve]<0||n[Ve]>999?Ve:-1,g(e)._overflowDayOfYear&&(t<Fe||t>Le)&&(t=Le),g(e)._overflowWeeks&&-1===t&&(t=Ue),g(e)._overflowWeekday&&-1===t&&(t=qe),g(e).overflow=t),e}var xn=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Sn=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Cn=/Z|[+-]\d\d(?::?\d\d)?/,En=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Nn=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Tn=/^\/?Date\((-?\d+)/i,An=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Rn={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function kn(e){var t,n,r,i,o,a,s=e._i,l=xn.exec(s)||Sn.exec(s),c=En.length,u=Nn.length;if(l){for(g(e).iso=!0,t=0,n=c;t<n;t++)if(En[t][1].exec(l[1])){i=En[t][0],r=!1!==En[t][2];break}if(null==i)return void(e._isValid=!1);if(l[3]){for(t=0,n=u;t<n;t++)if(Nn[t][1].exec(l[3])){o=(l[2]||" ")+Nn[t][0];break}if(null==o)return void(e._isValid=!1)}if(!r&&null!=o)return void(e._isValid=!1);if(l[4]){if(!Cn.exec(l[4]))return void(e._isValid=!1);a="Z"}e._f=i+(o||"")+(a||""),zn(e)}else e._isValid=!1}function Mn(e,t,n,r,i,o){var a=[Dn(e),it.indexOf(t),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&a.push(parseInt(o,10)),a}function Dn(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function _n(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function On(e,t,n){return!e||It.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(g(n).weekdayMismatch=!0,n._isValid=!1,!1)}function In(e,t,n){if(e)return Rn[e];if(t)return 0;var r=parseInt(n,10),i=r%100;return(r-i)/100*60+i}function Pn(e){var t,n=An.exec(_n(e._i));if(n){if(t=Mn(n[4],n[3],n[2],n[5],n[6],n[7]),!On(n[1],t,e))return;e._a=t,e._tzm=In(n[8],n[9],n[10]),e._d=bt.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),g(e).rfc2822=!0}else e._isValid=!1}function jn(e){var t=Tn.exec(e._i);null===t?(kn(e),!1===e._isValid&&(delete e._isValid,Pn(e),!1===e._isValid&&(delete e._isValid,e._strict?e._isValid=!1:r.createFromInputFallback(e)))):e._d=new Date(+t[1])}function Fn(e,t,n){return null!=e?e:null!=t?t:n}function Hn(e){var t=new Date(r.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function Ln(e){var t,n,r,i,o,a=[];if(!e._d){for(r=Hn(e),e._w&&null==e._a[Le]&&null==e._a[He]&&Bn(e),null!=e._dayOfYear&&(o=Fn(e._a[Fe],r[Fe]),(e._dayOfYear>Ge(o)||0===e._dayOfYear)&&(g(e)._overflowDayOfYear=!0),n=bt(o,0,e._dayOfYear),e._a[He]=n.getUTCMonth(),e._a[Le]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=a[t]=r[t];for(;t<7;t++)e._a[t]=a[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[Be]&&0===e._a[ze]&&0===e._a[We]&&0===e._a[Ve]&&(e._nextDay=!0,e._a[Be]=0),e._d=(e._useUTC?bt:yt).apply(null,a),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Be]=24),e._w&&"undefined"!==typeof e._w.d&&e._w.d!==i&&(g(e).weekdayMismatch=!0)}}function Bn(e){var t,n,r,i,o,a,s,l,c;null!=(t=e._w).GG||null!=t.W||null!=t.E?(o=1,a=4,n=Fn(t.GG,e._a[Fe],St($n(),1,4).year),r=Fn(t.W,1),((i=Fn(t.E,1))<1||i>7)&&(l=!0)):(o=e._locale._week.dow,a=e._locale._week.doy,c=St($n(),o,a),n=Fn(t.gg,e._a[Fe],c.year),r=Fn(t.w,c.week),null!=t.d?((i=t.d)<0||i>6)&&(l=!0):null!=t.e?(i=t.e+o,(t.e<0||t.e>6)&&(l=!0)):i=o),r<1||r>Ct(n,o,a)?g(e)._overflowWeeks=!0:null!=l?g(e)._overflowWeekday=!0:(s=xt(n,r,i,o,a),e._a[Fe]=s.year,e._dayOfYear=s.dayOfYear)}function zn(e){if(e._f!==r.ISO_8601)if(e._f!==r.RFC_2822){e._a=[],g(e).empty=!0;var t,n,i,o,a,s,l,c=""+e._i,u=c.length,d=0;for(l=(i=U(e._f,e._locale).match(j)||[]).length,t=0;t<l;t++)o=i[t],(n=(c.match(Ae(o,e))||[])[0])&&((a=c.substr(0,c.indexOf(n))).length>0&&g(e).unusedInput.push(a),c=c.slice(c.indexOf(n)+n.length),d+=n.length),L[o]?(n?g(e).empty=!1:g(e).unusedTokens.push(o),Pe(o,n,e)):e._strict&&!n&&g(e).unusedTokens.push(o);g(e).charsLeftOver=u-d,c.length>0&&g(e).unusedInput.push(c),e._a[Be]<=12&&!0===g(e).bigHour&&e._a[Be]>0&&(g(e).bigHour=void 0),g(e).parsedDateParts=e._a.slice(0),g(e).meridiem=e._meridiem,e._a[Be]=Wn(e._locale,e._a[Be],e._meridiem),null!==(s=g(e).era)&&(e._a[Fe]=e._locale.erasConvertYear(s,e._a[Fe])),Ln(e),wn(e)}else Pn(e);else kn(e)}function Wn(e,t,n){var r;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?((r=e.isPM(n))&&t<12&&(t+=12),r||12!==t||(t=0),t):t}function Vn(e){var t,n,r,i,o,a,s=!1,l=e._f.length;if(0===l)return g(e).invalidFormat=!0,void(e._d=new Date(NaN));for(i=0;i<l;i++)o=0,a=!1,t=x({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],zn(t),v(t)&&(a=!0),o+=g(t).charsLeftOver,o+=10*g(t).unusedTokens.length,g(t).score=o,s?o<r&&(r=o,n=t):(null==r||o<r||a)&&(r=o,n=t,a&&(s=!0));f(e,n||t)}function Un(e){if(!e._d){var t=re(e._i),n=void 0===t.day?t.date:t.day;e._a=h([t.year,t.month,n,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),Ln(e)}}function qn(e){var t=new S(wn(Gn(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function Gn(e){var t=e._i,n=e._f;return e._locale=e._locale||yn(e._l),null===t||void 0===n&&""===t?y({nullInput:!0}):("string"===typeof t&&(e._i=t=e._locale.preparse(t)),C(t)?new S(wn(t)):(d(t)?e._d=t:o(n)?Vn(e):n?zn(e):Yn(e),v(e)||(e._d=null),e))}function Yn(e){var t=e._i;c(t)?e._d=new Date(r.now()):d(t)?e._d=new Date(t.valueOf()):"string"===typeof t?jn(e):o(t)?(e._a=h(t.slice(0),function(e){return parseInt(e,10)}),Ln(e)):a(t)?Un(e):u(t)?e._d=new Date(t):r.createFromInputFallback(e)}function Kn(e,t,n,r,i){var s={};return!0!==t&&!1!==t||(r=t,t=void 0),!0!==n&&!1!==n||(r=n,n=void 0),(a(e)&&l(e)||o(e)&&0===e.length)&&(e=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=n,s._i=e,s._f=t,s._strict=r,qn(s)}function $n(e,t,n,r){return Kn(e,t,n,r,!1)}r.createFromInputFallback=N("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),r.ISO_8601=function(){},r.RFC_2822=function(){};var Xn=N("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=$n.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:y()}),Qn=N("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=$n.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:y()});function Jn(e,t){var n,r;if(1===t.length&&o(t[0])&&(t=t[0]),!t.length)return $n();for(n=t[0],r=1;r<t.length;++r)t[r].isValid()&&!t[r][e](n)||(n=t[r]);return n}function Zn(){return Jn("isBefore",[].slice.call(arguments,0))}function er(){return Jn("isAfter",[].slice.call(arguments,0))}var tr=function(){return Date.now?Date.now():+new Date},nr=["year","quarter","month","week","day","hour","minute","second","millisecond"];function rr(e){var t,n,r=!1,i=nr.length;for(t in e)if(s(e,t)&&(-1===Ye.call(nr,t)||null!=e[t]&&isNaN(e[t])))return!1;for(n=0;n<i;++n)if(e[nr[n]]){if(r)return!1;parseFloat(e[nr[n]])!==De(e[nr[n]])&&(r=!0)}return!0}function ir(){return this._isValid}function or(){return Rr(NaN)}function ar(e){var t=re(e),n=t.year||0,r=t.quarter||0,i=t.month||0,o=t.week||t.isoWeek||0,a=t.day||0,s=t.hour||0,l=t.minute||0,c=t.second||0,u=t.millisecond||0;this._isValid=rr(t),this._milliseconds=+u+1e3*c+6e4*l+1e3*s*60*60,this._days=+a+7*o,this._months=+i+3*r+12*n,this._data={},this._locale=yn(),this._bubble()}function sr(e){return e instanceof ar}function lr(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function cr(e,t,n){var r,i=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),a=0;for(r=0;r<i;r++)(n&&e[r]!==t[r]||!n&&De(e[r])!==De(t[r]))&&a++;return a+o}function ur(e,t){B(e,0,0,function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+P(~~(e/60),2)+t+P(~~e%60,2)})}ur("Z",":"),ur("ZZ",""),Te("Z",xe),Te("ZZ",xe),Oe(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=hr(xe,e)});var dr=/([\+\-]|\d\d)/gi;function hr(e,t){var n,r,i=(t||"").match(e);return null===i?null:0===(r=60*(n=((i[i.length-1]||[])+"").match(dr)||["-",0,0])[1]+De(n[2]))?0:"+"===n[0]?r:-r}function fr(e,t){var n,i;return t._isUTC?(n=t.clone(),i=(C(e)||d(e)?e.valueOf():$n(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),r.updateOffset(n,!1),n):$n(e).local()}function mr(e){return-Math.round(e._d.getTimezoneOffset())}function pr(e,t,n){var i,o=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"===typeof e){if(null===(e=hr(xe,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(i=mr(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),o!==e&&(!t||this._changeInProgress?Or(this,Rr(e-o,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,r.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?o:mr(this)}function gr(e,t){return null!=e?("string"!==typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function vr(e){return this.utcOffset(0,e)}function yr(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(mr(this),"m")),this}function br(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"===typeof this._i){var e=hr(we,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function wr(e){return!!this.isValid()&&(e=e?$n(e).utcOffset():0,(this.utcOffset()-e)%60===0)}function xr(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Sr(){if(!c(this._isDSTShifted))return this._isDSTShifted;var e,t={};return x(t,this),(t=Gn(t))._a?(e=t._isUTC?m(t._a):$n(t._a),this._isDSTShifted=this.isValid()&&cr(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Cr(){return!!this.isValid()&&!this._isUTC}function Er(){return!!this.isValid()&&this._isUTC}function Nr(){return!!this.isValid()&&this._isUTC&&0===this._offset}r.updateOffset=function(){};var Tr=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Ar=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Rr(e,t){var n,r,i,o=e,a=null;return sr(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:u(e)||!isNaN(+e)?(o={},t?o[t]=+e:o.milliseconds=+e):(a=Tr.exec(e))?(n="-"===a[1]?-1:1,o={y:0,d:De(a[Le])*n,h:De(a[Be])*n,m:De(a[ze])*n,s:De(a[We])*n,ms:De(lr(1e3*a[Ve]))*n}):(a=Ar.exec(e))?(n="-"===a[1]?-1:1,o={y:kr(a[2],n),M:kr(a[3],n),w:kr(a[4],n),d:kr(a[5],n),h:kr(a[6],n),m:kr(a[7],n),s:kr(a[8],n)}):null==o?o={}:"object"===typeof o&&("from"in o||"to"in o)&&(i=Dr($n(o.from),$n(o.to)),(o={}).ms=i.milliseconds,o.M=i.months),r=new ar(o),sr(e)&&s(e,"_locale")&&(r._locale=e._locale),sr(e)&&s(e,"_isValid")&&(r._isValid=e._isValid),r}function kr(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Mr(e,t){var n={};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Dr(e,t){var n;return e.isValid()&&t.isValid()?(t=fr(t,e),e.isBefore(t)?n=Mr(e,t):((n=Mr(t,e)).milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function _r(e,t){return function(n,r){var i;return null===r||isNaN(+r)||(R(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=n,n=r,r=i),Or(this,Rr(n,r),e),this}}function Or(e,t,n,i){var o=t._milliseconds,a=lr(t._days),s=lr(t._months);e.isValid()&&(i=null==i||i,s&&ht(e,Qe(e,"Month")+s*n),a&&Je(e,"Date",Qe(e,"Date")+a*n),o&&e._d.setTime(e._d.valueOf()+o*n),i&&r.updateOffset(e,a||s))}Rr.fn=ar.prototype,Rr.invalid=or;var Ir=_r(1,"add"),Pr=_r(-1,"subtract");function jr(e){return"string"===typeof e||e instanceof String}function Fr(e){return C(e)||d(e)||jr(e)||u(e)||Lr(e)||Hr(e)||null===e||void 0===e}function Hr(e){var t,n,r=a(e)&&!l(e),i=!1,o=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],c=o.length;for(t=0;t<c;t+=1)n=o[t],i=i||s(e,n);return r&&i}function Lr(e){var t=o(e),n=!1;return t&&(n=0===e.filter(function(t){return!u(t)&&jr(e)}).length),t&&n}function Br(e){var t,n,r=a(e)&&!l(e),i=!1,o=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(t=0;t<o.length;t+=1)n=o[t],i=i||s(e,n);return r&&i}function zr(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function Wr(e,t){1===arguments.length&&(arguments[0]?Fr(arguments[0])?(e=arguments[0],t=void 0):Br(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var n=e||$n(),i=fr(n,this).startOf("day"),o=r.calendarFormat(this,i)||"sameElse",a=t&&(k(t[o])?t[o].call(this,n):t[o]);return this.format(a||this.localeData().calendar(o,this,$n(n)))}function Vr(){return new S(this)}function Ur(e,t){var n=C(e)?e:$n(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=ne(t)||"millisecond")?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())}function qr(e,t){var n=C(e)?e:$n(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=ne(t)||"millisecond")?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())}function Gr(e,t,n,r){var i=C(e)?e:$n(e),o=C(t)?t:$n(t);return!!(this.isValid()&&i.isValid()&&o.isValid())&&("("===(r=r||"()")[0]?this.isAfter(i,n):!this.isBefore(i,n))&&(")"===r[1]?this.isBefore(o,n):!this.isAfter(o,n))}function Yr(e,t){var n,r=C(e)?e:$n(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=ne(t)||"millisecond")?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))}function Kr(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function $r(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function Xr(e,t,n){var r,i,o;if(!this.isValid())return NaN;if(!(r=fr(e,this)).isValid())return NaN;switch(i=6e4*(r.utcOffset()-this.utcOffset()),t=ne(t)){case"year":o=Qr(this,r)/12;break;case"month":o=Qr(this,r);break;case"quarter":o=Qr(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:Me(o)}function Qr(e,t){if(e.date()<t.date())return-Qr(t,e);var n=12*(t.year()-e.year())+(t.month()-e.month()),r=e.clone().add(n,"months");return-(n+(t-r<0?(t-r)/(r-e.clone().add(n-1,"months")):(t-r)/(e.clone().add(n+1,"months")-r)))||0}function Jr(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Zr(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||n.year()>9999?V(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):k(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",V(n,"Z")):V(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function ei(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e,t,n,r,i="moment",o="";return this.isLocal()||(i=0===this.utcOffset()?"moment.utc":"moment.parseZone",o="Z"),e="["+i+'("]',t=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",n="-MM-DD[T]HH:mm:ss.SSS",r=o+'[")]',this.format(e+t+n+r)}function ti(e){e||(e=this.isUtc()?r.defaultFormatUtc:r.defaultFormat);var t=V(this,e);return this.localeData().postformat(t)}function ni(e,t){return this.isValid()&&(C(e)&&e.isValid()||$n(e).isValid())?Rr({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function ri(e){return this.from($n(),e)}function ii(e,t){return this.isValid()&&(C(e)&&e.isValid()||$n(e).isValid())?Rr({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function oi(e){return this.to($n(),e)}function ai(e){var t;return void 0===e?this._locale._abbr:(null!=(t=yn(e))&&(this._locale=t),this)}r.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",r.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var si=N("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});function li(){return this._locale}var ci=1e3,ui=60*ci,di=60*ui,hi=3506328*di;function fi(e,t){return(e%t+t)%t}function mi(e,t,n){return e<100&&e>=0?new Date(e+400,t,n)-hi:new Date(e,t,n).valueOf()}function pi(e,t,n){return e<100&&e>=0?Date.UTC(e+400,t,n)-hi:Date.UTC(e,t,n)}function gi(e){var t,n;if(void 0===(e=ne(e))||"millisecond"===e||!this.isValid())return this;switch(n=this._isUTC?pi:mi,e){case"year":t=n(this.year(),0,1);break;case"quarter":t=n(this.year(),this.month()-this.month()%3,1);break;case"month":t=n(this.year(),this.month(),1);break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=n(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=fi(t+(this._isUTC?0:this.utcOffset()*ui),di);break;case"minute":t=this._d.valueOf(),t-=fi(t,ui);break;case"second":t=this._d.valueOf(),t-=fi(t,ci)}return this._d.setTime(t),r.updateOffset(this,!0),this}function vi(e){var t,n;if(void 0===(e=ne(e))||"millisecond"===e||!this.isValid())return this;switch(n=this._isUTC?pi:mi,e){case"year":t=n(this.year()+1,0,1)-1;break;case"quarter":t=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=n(this.year(),this.month()+1,1)-1;break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=di-fi(t+(this._isUTC?0:this.utcOffset()*ui),di)-1;break;case"minute":t=this._d.valueOf(),t+=ui-fi(t,ui)-1;break;case"second":t=this._d.valueOf(),t+=ci-fi(t,ci)-1}return this._d.setTime(t),r.updateOffset(this,!0),this}function yi(){return this._d.valueOf()-6e4*(this._offset||0)}function bi(){return Math.floor(this.valueOf()/1e3)}function wi(){return new Date(this.valueOf())}function xi(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Si(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Ci(){return this.isValid()?this.toISOString():null}function Ei(){return v(this)}function Ni(){return f({},g(this))}function Ti(){return g(this).overflow}function Ai(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Ri(e,t){var n,i,o,a=this._eras||yn("en")._eras;for(n=0,i=a.length;n<i;++n)switch("string"===typeof a[n].since&&(o=r(a[n].since).startOf("day"),a[n].since=o.valueOf()),typeof a[n].until){case"undefined":a[n].until=1/0;break;case"string":o=r(a[n].until).startOf("day").valueOf(),a[n].until=o.valueOf()}return a}function ki(e,t,n){var r,i,o,a,s,l=this.eras();for(e=e.toUpperCase(),r=0,i=l.length;r<i;++r)if(o=l[r].name.toUpperCase(),a=l[r].abbr.toUpperCase(),s=l[r].narrow.toUpperCase(),n)switch(t){case"N":case"NN":case"NNN":if(a===e)return l[r];break;case"NNNN":if(o===e)return l[r];break;case"NNNNN":if(s===e)return l[r]}else if([o,a,s].indexOf(e)>=0)return l[r]}function Mi(e,t){var n=e.since<=e.until?1:-1;return void 0===t?r(e.since).year():r(e.since).year()+(t-e.offset)*n}function Di(){var e,t,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),r[e].since<=n&&n<=r[e].until)return r[e].name;if(r[e].until<=n&&n<=r[e].since)return r[e].name}return""}function _i(){var e,t,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),r[e].since<=n&&n<=r[e].until)return r[e].narrow;if(r[e].until<=n&&n<=r[e].since)return r[e].narrow}return""}function Oi(){var e,t,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),r[e].since<=n&&n<=r[e].until)return r[e].abbr;if(r[e].until<=n&&n<=r[e].since)return r[e].abbr}return""}function Ii(){var e,t,n,i,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e)if(n=o[e].since<=o[e].until?1:-1,i=this.clone().startOf("day").valueOf(),o[e].since<=i&&i<=o[e].until||o[e].until<=i&&i<=o[e].since)return(this.year()-r(o[e].since).year())*n+o[e].offset;return this.year()}function Pi(e){return s(this,"_erasNameRegex")||Wi.call(this),e?this._erasNameRegex:this._erasRegex}function ji(e){return s(this,"_erasAbbrRegex")||Wi.call(this),e?this._erasAbbrRegex:this._erasRegex}function Fi(e){return s(this,"_erasNarrowRegex")||Wi.call(this),e?this._erasNarrowRegex:this._erasRegex}function Hi(e,t){return t.erasAbbrRegex(e)}function Li(e,t){return t.erasNameRegex(e)}function Bi(e,t){return t.erasNarrowRegex(e)}function zi(e,t){return t._eraYearOrdinalRegex||ye}function Wi(){var e,t,n,r,i,o=[],a=[],s=[],l=[],c=this.eras();for(e=0,t=c.length;e<t;++e)n=ke(c[e].name),r=ke(c[e].abbr),i=ke(c[e].narrow),a.push(n),o.push(r),s.push(i),l.push(n),l.push(r),l.push(i);this._erasRegex=new RegExp("^("+l.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+a.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+o.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+s.join("|")+")","i")}function Vi(e,t){B(0,[e,e.length],0,t)}function Ui(e){return Xi.call(this,e,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function qi(e){return Xi.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Gi(){return Ct(this.year(),1,4)}function Yi(){return Ct(this.isoWeekYear(),1,4)}function Ki(){var e=this.localeData()._week;return Ct(this.year(),e.dow,e.doy)}function $i(){var e=this.localeData()._week;return Ct(this.weekYear(),e.dow,e.doy)}function Xi(e,t,n,r,i){var o;return null==e?St(this,r,i).year:(t>(o=Ct(e,r,i))&&(t=o),Qi.call(this,e,t,n,r,i))}function Qi(e,t,n,r,i){var o=xt(e,t,n,r,i),a=bt(o.year,0,o.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}function Ji(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}B("N",0,0,"eraAbbr"),B("NN",0,0,"eraAbbr"),B("NNN",0,0,"eraAbbr"),B("NNNN",0,0,"eraName"),B("NNNNN",0,0,"eraNarrow"),B("y",["y",1],"yo","eraYear"),B("y",["yy",2],0,"eraYear"),B("y",["yyy",3],0,"eraYear"),B("y",["yyyy",4],0,"eraYear"),Te("N",Hi),Te("NN",Hi),Te("NNN",Hi),Te("NNNN",Li),Te("NNNNN",Bi),Oe(["N","NN","NNN","NNNN","NNNNN"],function(e,t,n,r){var i=n._locale.erasParse(e,r,n._strict);i?g(n).era=i:g(n).invalidEra=e}),Te("y",ye),Te("yy",ye),Te("yyy",ye),Te("yyyy",ye),Te("yo",zi),Oe(["y","yy","yyy","yyyy"],Fe),Oe(["yo"],function(e,t,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=e.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?t[Fe]=n._locale.eraYearOrdinalParse(e,i):t[Fe]=parseInt(e,10)}),B(0,["gg",2],0,function(){return this.weekYear()%100}),B(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Vi("gggg","weekYear"),Vi("ggggg","weekYear"),Vi("GGGG","isoWeekYear"),Vi("GGGGG","isoWeekYear"),Te("G",be),Te("g",be),Te("GG",he,le),Te("gg",he,le),Te("GGGG",ge,ue),Te("gggg",ge,ue),Te("GGGGG",ve,de),Te("ggggg",ve,de),Ie(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,r){t[r.substr(0,2)]=De(e)}),Ie(["gg","GG"],function(e,t,n,i){t[i]=r.parseTwoDigitYear(e)}),B("Q",0,"Qo","quarter"),Te("Q",se),Oe("Q",function(e,t){t[He]=3*(De(e)-1)}),B("D",["DD",2],"Do","date"),Te("D",he,Ee),Te("DD",he,le),Te("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),Oe(["D","DD"],Le),Oe("Do",function(e,t){t[Le]=De(e.match(he)[0])});var Zi=Xe("Date",!0);function eo(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}B("DDD",["DDDD",3],"DDDo","dayOfYear"),Te("DDD",pe),Te("DDDD",ce),Oe(["DDD","DDDD"],function(e,t,n){n._dayOfYear=De(e)}),B("m",["mm",2],0,"minute"),Te("m",he,Ne),Te("mm",he,le),Oe(["m","mm"],ze);var to=Xe("Minutes",!1);B("s",["ss",2],0,"second"),Te("s",he,Ne),Te("ss",he,le),Oe(["s","ss"],We);var no,ro,io=Xe("Seconds",!1);for(B("S",0,0,function(){return~~(this.millisecond()/100)}),B(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),B(0,["SSS",3],0,"millisecond"),B(0,["SSSS",4],0,function(){return 10*this.millisecond()}),B(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),B(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),B(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),B(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),B(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),Te("S",pe,se),Te("SS",pe,le),Te("SSS",pe,ce),no="SSSS";no.length<=9;no+="S")Te(no,ye);function oo(e,t){t[Ve]=De(1e3*("0."+e))}for(no="S";no.length<=9;no+="S")Oe(no,oo);function ao(){return this._isUTC?"UTC":""}function so(){return this._isUTC?"Coordinated Universal Time":""}ro=Xe("Milliseconds",!1),B("z",0,0,"zoneAbbr"),B("zz",0,0,"zoneName");var lo=S.prototype;function co(e){return $n(1e3*e)}function uo(){return $n.apply(null,arguments).parseZone()}function ho(e){return e}lo.add=Ir,lo.calendar=Wr,lo.clone=Vr,lo.diff=Xr,lo.endOf=vi,lo.format=ti,lo.from=ni,lo.fromNow=ri,lo.to=ii,lo.toNow=oi,lo.get=Ze,lo.invalidAt=Ti,lo.isAfter=Ur,lo.isBefore=qr,lo.isBetween=Gr,lo.isSame=Yr,lo.isSameOrAfter=Kr,lo.isSameOrBefore=$r,lo.isValid=Ei,lo.lang=si,lo.locale=ai,lo.localeData=li,lo.max=Qn,lo.min=Xn,lo.parsingFlags=Ni,lo.set=et,lo.startOf=gi,lo.subtract=Pr,lo.toArray=xi,lo.toObject=Si,lo.toDate=wi,lo.toISOString=Zr,lo.inspect=ei,"undefined"!==typeof Symbol&&null!=Symbol.for&&(lo[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),lo.toJSON=Ci,lo.toString=Jr,lo.unix=bi,lo.valueOf=yi,lo.creationData=Ai,lo.eraName=Di,lo.eraNarrow=_i,lo.eraAbbr=Oi,lo.eraYear=Ii,lo.year=Ke,lo.isLeapYear=$e,lo.weekYear=Ui,lo.isoWeekYear=qi,lo.quarter=lo.quarters=Ji,lo.month=ft,lo.daysInMonth=mt,lo.week=lo.weeks=Rt,lo.isoWeek=lo.isoWeeks=kt,lo.weeksInYear=Ki,lo.weeksInWeekYear=$i,lo.isoWeeksInYear=Gi,lo.isoWeeksInISOWeekYear=Yi,lo.date=Zi,lo.day=lo.days=Ut,lo.weekday=qt,lo.isoWeekday=Gt,lo.dayOfYear=eo,lo.hour=lo.hours=rn,lo.minute=lo.minutes=to,lo.second=lo.seconds=io,lo.millisecond=lo.milliseconds=ro,lo.utcOffset=pr,lo.utc=vr,lo.local=yr,lo.parseZone=br,lo.hasAlignedHourOffset=wr,lo.isDST=xr,lo.isLocal=Cr,lo.isUtcOffset=Er,lo.isUtc=Nr,lo.isUTC=Nr,lo.zoneAbbr=ao,lo.zoneName=so,lo.dates=N("dates accessor is deprecated. Use date instead.",Zi),lo.months=N("months accessor is deprecated. Use month instead",ft),lo.years=N("years accessor is deprecated. Use year instead",Ke),lo.zone=N("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",gr),lo.isDSTShifted=N("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Sr);var fo=_.prototype;function mo(e,t,n,r){var i=yn(),o=m().set(r,t);return i[n](o,e)}function po(e,t,n){if(u(e)&&(t=e,e=void 0),e=e||"",null!=t)return mo(e,t,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=mo(e,r,n,"month");return i}function go(e,t,n,r){"boolean"===typeof e?(u(t)&&(n=t,t=void 0),t=t||""):(n=t=e,e=!1,u(t)&&(n=t,t=void 0),t=t||"");var i,o=yn(),a=e?o._week.dow:0,s=[];if(null!=n)return mo(t,(n+a)%7,r,"day");for(i=0;i<7;i++)s[i]=mo(t,(i+a)%7,r,"day");return s}function vo(e,t){return po(e,t,"months")}function yo(e,t){return po(e,t,"monthsShort")}function bo(e,t,n){return go(e,t,n,"weekdays")}function wo(e,t,n){return go(e,t,n,"weekdaysShort")}function xo(e,t,n){return go(e,t,n,"weekdaysMin")}fo.calendar=I,fo.longDateFormat=G,fo.invalidDate=K,fo.ordinal=Q,fo.preparse=ho,fo.postformat=ho,fo.relativeTime=Z,fo.pastFuture=ee,fo.set=M,fo.eras=Ri,fo.erasParse=ki,fo.erasConvertYear=Mi,fo.erasAbbrRegex=ji,fo.erasNameRegex=Pi,fo.erasNarrowRegex=Fi,fo.months=lt,fo.monthsShort=ct,fo.monthsParse=dt,fo.monthsRegex=gt,fo.monthsShortRegex=pt,fo.week=Et,fo.firstDayOfYear=At,fo.firstDayOfWeek=Tt,fo.weekdays=Lt,fo.weekdaysMin=zt,fo.weekdaysShort=Bt,fo.weekdaysParse=Vt,fo.weekdaysRegex=Yt,fo.weekdaysShortRegex=Kt,fo.weekdaysMinRegex=$t,fo.isPM=tn,fo.meridiem=on,pn("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===De(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),r.lang=N("moment.lang is deprecated. Use moment.locale instead.",pn),r.langData=N("moment.langData is deprecated. Use moment.localeData instead.",yn);var So=Math.abs;function Co(){var e=this._data;return this._milliseconds=So(this._milliseconds),this._days=So(this._days),this._months=So(this._months),e.milliseconds=So(e.milliseconds),e.seconds=So(e.seconds),e.minutes=So(e.minutes),e.hours=So(e.hours),e.months=So(e.months),e.years=So(e.years),this}function Eo(e,t,n,r){var i=Rr(t,n);return e._milliseconds+=r*i._milliseconds,e._days+=r*i._days,e._months+=r*i._months,e._bubble()}function No(e,t){return Eo(this,e,t,1)}function To(e,t){return Eo(this,e,t,-1)}function Ao(e){return e<0?Math.floor(e):Math.ceil(e)}function Ro(){var e,t,n,r,i,o=this._milliseconds,a=this._days,s=this._months,l=this._data;return o>=0&&a>=0&&s>=0||o<=0&&a<=0&&s<=0||(o+=864e5*Ao(Mo(s)+a),a=0,s=0),l.milliseconds=o%1e3,e=Me(o/1e3),l.seconds=e%60,t=Me(e/60),l.minutes=t%60,n=Me(t/60),l.hours=n%24,a+=Me(n/24),s+=i=Me(ko(a)),a-=Ao(Mo(i)),r=Me(s/12),s%=12,l.days=a,l.months=s,l.years=r,this}function ko(e){return 4800*e/146097}function Mo(e){return 146097*e/4800}function Do(e){if(!this.isValid())return NaN;var t,n,r=this._milliseconds;if("month"===(e=ne(e))||"quarter"===e||"year"===e)switch(t=this._days+r/864e5,n=this._months+ko(t),e){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(t=this._days+Math.round(Mo(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}}function _o(e){return function(){return this.as(e)}}var Oo=_o("ms"),Io=_o("s"),Po=_o("m"),jo=_o("h"),Fo=_o("d"),Ho=_o("w"),Lo=_o("M"),Bo=_o("Q"),zo=_o("y"),Wo=Oo;function Vo(){return Rr(this)}function Uo(e){return e=ne(e),this.isValid()?this[e+"s"]():NaN}function qo(e){return function(){return this.isValid()?this._data[e]:NaN}}var Go=qo("milliseconds"),Yo=qo("seconds"),Ko=qo("minutes"),$o=qo("hours"),Xo=qo("days"),Qo=qo("months"),Jo=qo("years");function Zo(){return Me(this.days()/7)}var ea=Math.round,ta={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function na(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function ra(e,t,n,r){var i=Rr(e).abs(),o=ea(i.as("s")),a=ea(i.as("m")),s=ea(i.as("h")),l=ea(i.as("d")),c=ea(i.as("M")),u=ea(i.as("w")),d=ea(i.as("y")),h=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||a<=1&&["m"]||a<n.m&&["mm",a]||s<=1&&["h"]||s<n.h&&["hh",s]||l<=1&&["d"]||l<n.d&&["dd",l];return null!=n.w&&(h=h||u<=1&&["w"]||u<n.w&&["ww",u]),(h=h||c<=1&&["M"]||c<n.M&&["MM",c]||d<=1&&["y"]||["yy",d])[2]=t,h[3]=+e>0,h[4]=r,na.apply(null,h)}function ia(e){return void 0===e?ea:"function"===typeof e&&(ea=e,!0)}function oa(e,t){return void 0!==ta[e]&&(void 0===t?ta[e]:(ta[e]=t,"s"===e&&(ta.ss=t-1),!0))}function aa(e,t){if(!this.isValid())return this.localeData().invalidDate();var n,r,i=!1,o=ta;return"object"===typeof e&&(t=e,e=!1),"boolean"===typeof e&&(i=e),"object"===typeof t&&(o=Object.assign({},ta,t),null!=t.s&&null==t.ss&&(o.ss=t.s-1)),r=ra(this,!i,o,n=this.localeData()),i&&(r=n.pastFuture(+this,r)),n.postformat(r)}var sa=Math.abs;function la(e){return(e>0)-(e<0)||+e}function ca(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n,r,i,o,a,s,l=sa(this._milliseconds)/1e3,c=sa(this._days),u=sa(this._months),d=this.asSeconds();return d?(e=Me(l/60),t=Me(e/60),l%=60,e%=60,n=Me(u/12),u%=12,r=l?l.toFixed(3).replace(/\.?0+$/,""):"",i=d<0?"-":"",o=la(this._months)!==la(d)?"-":"",a=la(this._days)!==la(d)?"-":"",s=la(this._milliseconds)!==la(d)?"-":"",i+"P"+(n?o+n+"Y":"")+(u?o+u+"M":"")+(c?a+c+"D":"")+(t||e||l?"T":"")+(t?s+t+"H":"")+(e?s+e+"M":"")+(l?s+r+"S":"")):"P0D"}var ua=ar.prototype;return ua.isValid=ir,ua.abs=Co,ua.add=No,ua.subtract=To,ua.as=Do,ua.asMilliseconds=Oo,ua.asSeconds=Io,ua.asMinutes=Po,ua.asHours=jo,ua.asDays=Fo,ua.asWeeks=Ho,ua.asMonths=Lo,ua.asQuarters=Bo,ua.asYears=zo,ua.valueOf=Wo,ua._bubble=Ro,ua.clone=Vo,ua.get=Uo,ua.milliseconds=Go,ua.seconds=Yo,ua.minutes=Ko,ua.hours=$o,ua.days=Xo,ua.weeks=Zo,ua.months=Qo,ua.years=Jo,ua.humanize=aa,ua.toISOString=ca,ua.toString=ca,ua.toJSON=ca,ua.locale=ai,ua.localeData=li,ua.toIsoString=N("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",ca),ua.lang=si,B("X",0,0,"unix"),B("x",0,0,"valueOf"),Te("x",be),Te("X",Se),Oe("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e))}),Oe("x",function(e,t,n){n._d=new Date(De(e))}),r.version="2.30.1",i($n),r.fn=lo,r.min=Zn,r.max=er,r.now=tr,r.utc=m,r.unix=co,r.months=vo,r.isDate=d,r.locale=pn,r.invalid=y,r.duration=Rr,r.isMoment=C,r.weekdays=bo,r.parseZone=uo,r.localeData=yn,r.isDuration=sr,r.monthsShort=yo,r.weekdaysMin=xo,r.defineLocale=gn,r.updateLocale=vn,r.locales=bn,r.weekdaysShort=wo,r.normalizeUnits=ne,r.relativeTimeRounding=ia,r.relativeTimeThreshold=oa,r.calendarFormat=zr,r.prototype=lo,r.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},r}()},6288:function(e,t,n){var r;!function(e,i){function o(e){var t=this;t.next=function(){var e,n,r=t.w,i=t.X,o=t.i;return t.w=r=r+1640531527|0,n=i[o+34&127],e=i[o=o+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=i[o]=n^e,t.i=o,n+(r^r>>>16)|0},function(e,t){var n,r,i,o,a,s=[],l=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,l=Math.max(l,t.length)),i=0,o=-32;o<l;++o)t&&(r^=t.charCodeAt((o+32)%t.length)),0===o&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(a=a+1640531527|0,i=0==(n=s[127&o]^=r+a)?i+1:0);for(i>=128&&(s[127&(t&&t.length||0)]=-1),i=127,o=512;o>0;--o)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;e.w=a,e.X=s,e.i=i}(t,e)}function a(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function s(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&(r.X&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,i))||(i.exports=r):this.xor4096=s}(0,e=n.nmd(e),n.amdD)},6369:e=>{"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},6440:e=>{"use strict";var t=function(){};e.exports=t},6464:(e,t,n)=>{"use strict";var r=n(5897),i=Function.prototype,o=i.apply,a=i.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?a.bind(o):function(){return a.apply(o,arguments)})},6672:(e,t,n)=>{"use strict";var r=n(5043);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(){}var a={d:{f:o,r:function(){throw Error(i(522))},D:o,C:o,L:o,m:o,X:o,S:o,M:o},p:0,findDOMNode:null},s=Symbol.for("react.portal");var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(i(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:s,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=a.p;try{if(l.T=null,a.p=2,e)return e()}finally{l.T=t,a.p=n,a.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,a.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&a.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin),i="string"===typeof t.integrity?t.integrity:void 0,o="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?a.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:i,fetchPriority:o}):"script"===n&&a.d.X(e,{crossOrigin:r,integrity:i,fetchPriority:o,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);a.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&a.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin);a.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);a.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else a.d.m(e)},t.requestFormReset=function(e){a.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.2.0"},6715:(e,t,n)=>{"use strict";var r=n(4823),i=n(5214).f,o=n(9266),a=n(5551),s=n(3036),l=n(5555),c=n(6079);e.exports=function(e,t){var n,u,d,h,f,m=e.target,p=e.global,g=e.stat;if(n=p?r:g?r[m]||s(m,{}):r[m]&&r[m].prototype)for(u in t){if(h=t[u],d=e.dontCallGetSet?(f=i(n,u))&&f.value:n[u],!c(p?u:m+(g?".":"#")+u,e.forced)&&void 0!==d){if(typeof h==typeof d)continue;l(h,d)}(e.sham||d&&d.sham)&&o(h,"sham",!0),a(n,u,h,e)}}},6774:(e,t,n)=>{"use strict";var r=n(1178),i=n(327);e.exports=function(e){return r(i(e))}},6821:(e,t,n)=>{"use strict";var r=n(4706);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},6842:(e,t)=>{"use strict";t.f=Object.getOwnPropertySymbols},6864:(e,t,n)=>{"use strict";var r=n(7707);e.exports=r({}.isPrototypeOf)},7004:(e,t,n)=>{"use strict";var r=n(8853),i=n(5043),o=n(7950);function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function d(e){if(l(e)!==e)throw Error(a(188))}function h(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=h(e)))return t;e=e.sibling}return null}var f=Object.assign,m=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),w=Symbol.for("react.consumer"),x=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),T=Symbol.for("react.lazy");Symbol.for("react.scope");var A=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var R=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var k=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=k&&e[k]||e["@@iterator"])?e:null}var D=Symbol.for("react.client.reference");function _(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===D?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case v:return"Fragment";case b:return"Profiler";case y:return"StrictMode";case C:return"Suspense";case E:return"SuspenseList";case A:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case g:return"Portal";case x:return e.displayName||"Context";case w:return(e._context.displayName||"Context")+".Consumer";case S:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case N:return null!==(t=e.displayName||null)?t:_(e.type)||"Memo";case T:t=e._payload,e=e._init;try{return _(e(t))}catch(n){}}return null}var O=Array.isArray,I=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,P=o.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j={pending:!1,data:null,method:null,action:null},F=[],H=-1;function L(e){return{current:e}}function B(e){0>H||(e.current=F[H],F[H]=null,H--)}function z(e,t){H++,F[H]=e.current,e.current=t}var W,V,U=L(null),q=L(null),G=L(null),Y=L(null);function K(e,t){switch(z(G,t),z(q,e),z(U,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?vd(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=yd(t=vd(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}B(U),z(U,e)}function $(){B(U),B(q),B(G)}function X(e){null!==e.memoizedState&&z(Y,e);var t=U.current,n=yd(t,e.type);t!==n&&(z(q,e),z(U,n))}function Q(e){q.current===e&&(B(U),B(q)),Y.current===e&&(B(Y),uh._currentValue=j)}function J(e){if(void 0===W)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);W=t&&t[1]||"",V=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+W+e+V}var Z=!1;function ee(e,t){if(!e||Z)return"";Z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(i){var r=i}Reflect.construct(e,[],n)}else{try{n.call()}catch(o){r=o}e.call(n.prototype)}}else{try{throw Error()}catch(a){r=a}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(s){if(s&&r&&"string"===typeof s.stack)return[s.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var o=r.DetermineComponentFrameRoot(),a=o[0],s=o[1];if(a&&s){var l=a.split("\n"),c=s.split("\n");for(i=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;if(r===l.length||i===c.length)for(r=l.length-1,i=c.length-1;1<=r&&0<=i&&l[r]!==c[i];)i--;for(;1<=r&&0<=i;r--,i--)if(l[r]!==c[i]){if(1!==r||1!==i)do{if(r--,0>--i||l[r]!==c[i]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=i);break}}}finally{Z=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?J(n):""}function te(e,t){switch(e.tag){case 26:case 27:case 5:return J(e.type);case 16:return J("Lazy");case 13:return e.child!==t&&null!==t?J("Suspense Fallback"):J("Suspense");case 19:return J("SuspenseList");case 0:case 15:return ee(e.type,!1);case 11:return ee(e.type.render,!1);case 1:return ee(e.type,!0);case 31:return J("Activity");default:return""}}function ne(e){try{var t="",n=null;do{t+=te(e,n),n=e,e=e.return}while(e);return t}catch(r){return"\nError generating stack: "+r.message+"\n"+r.stack}}var re=Object.prototype.hasOwnProperty,ie=r.unstable_scheduleCallback,oe=r.unstable_cancelCallback,ae=r.unstable_shouldYield,se=r.unstable_requestPaint,le=r.unstable_now,ce=r.unstable_getCurrentPriorityLevel,ue=r.unstable_ImmediatePriority,de=r.unstable_UserBlockingPriority,he=r.unstable_NormalPriority,fe=r.unstable_LowPriority,me=r.unstable_IdlePriority,pe=r.log,ge=r.unstable_setDisableYieldValue,ve=null,ye=null;function be(e){if("function"===typeof pe&&ge(e),ye&&"function"===typeof ye.setStrictMode)try{ye.setStrictMode(ve,e)}catch(t){}}var we=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(xe(e)/Se|0)|0},xe=Math.log,Se=Math.LN2;var Ce=256,Ee=262144,Ne=4194304;function Te(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ae(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var i=0,o=e.suspendedLanes,a=e.pingedLanes;e=e.warmLanes;var s=134217727&r;return 0!==s?0!==(r=s&~o)?i=Te(r):0!==(a&=s)?i=Te(a):n||0!==(n=s&~e)&&(i=Te(n)):0!==(s=r&~o)?i=Te(s):0!==a?i=Te(a):n||0!==(n=r&~e)&&(i=Te(n)),0===i?0:0!==t&&t!==i&&0===(t&o)&&((o=i&-i)>=(n=t&-t)||32===o&&0!==(4194048&n))?t:i}function Re(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function ke(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Me(){var e=Ne;return 0===(62914560&(Ne<<=1))&&(Ne=4194304),e}function De(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function _e(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Oe(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-we(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|261930&n}function Ie(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-we(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}function Pe(e,t){var n=t&-t;return 0!==((n=0!==(42&n)?1:je(n))&(e.suspendedLanes|t))?0:n}function je(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Fe(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function He(){var e=P.p;return 0!==e?e:void 0===(e=window.event)?32:Th(e.type)}function Le(e,t){var n=P.p;try{return P.p=e,t()}finally{P.p=n}}var Be=Math.random().toString(36).slice(2),ze="__reactFiber$"+Be,We="__reactProps$"+Be,Ve="__reactContainer$"+Be,Ue="__reactEvents$"+Be,qe="__reactListeners$"+Be,Ge="__reactHandles$"+Be,Ye="__reactResources$"+Be,Ke="__reactMarker$"+Be;function $e(e){delete e[ze],delete e[We],delete e[Ue],delete e[qe],delete e[Ge]}function Xe(e){var t=e[ze];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ve]||n[ze]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=jd(e);null!==e;){if(n=e[ze])return n;e=jd(e)}return t}n=(e=n).parentNode}return null}function Qe(e){if(e=e[ze]||e[Ve]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function Je(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(a(33))}function Ze(e){var t=e[Ye];return t||(t=e[Ye]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function et(e){e[Ke]=!0}var tt=new Set,nt={};function rt(e,t){it(e,t),it(e+"Capture",t)}function it(e,t){for(nt[e]=t,e=0;e<t.length;e++)tt.add(t[e])}var ot=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),at={},st={};function lt(e,t,n){if(i=t,re.call(st,i)||!re.call(at,i)&&(ot.test(i)?st[i]=!0:(at[i]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var i}function ct(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function ut(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function dt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ht(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ft(e){if(!e._valueTracker){var t=ht(e)?"checked":"value";e._valueTracker=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var i=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function mt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ht(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function pt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var gt=/[\n"\\]/g;function vt(e){return e.replace(gt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function yt(e,t,n,r,i,o,a,s){e.name="",null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a?e.type=a:e.removeAttribute("type"),null!=t?"number"===a?(0===t&&""===e.value||e.value!=t)&&(e.value=""+dt(t)):e.value!==""+dt(t)&&(e.value=""+dt(t)):"submit"!==a&&"reset"!==a||e.removeAttribute("value"),null!=t?wt(e,a,dt(t)):null!=n?wt(e,a,dt(n)):null!=r&&e.removeAttribute("value"),null==i&&null!=o&&(e.defaultChecked=!!o),null!=i&&(e.checked=i&&"function"!==typeof i&&"symbol"!==typeof i),null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s?e.name=""+dt(s):e.removeAttribute("name")}function bt(e,t,n,r,i,o,a,s){if(null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o&&(e.type=o),null!=t||null!=n){if(!("submit"!==o&&"reset"!==o||void 0!==t&&null!==t))return void ft(e);n=null!=n?""+dt(n):"",t=null!=t?""+dt(t):n,s||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:i)&&"symbol"!==typeof r&&!!r,e.checked=s?e.checked:!!r,e.defaultChecked=!!r,null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a&&(e.name=a),ft(e)}function wt(e,t,n){"number"===t&&pt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function xt(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+dt(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function St(e,t,n){null==t||((t=""+dt(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+dt(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function Ct(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(a(92));if(O(r)){if(1<r.length)throw Error(a(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=dt(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r),ft(e)}function Et(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var Nt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Tt(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||Nt.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function At(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(a(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var i in t)r=t[i],t.hasOwnProperty(i)&&n[i]!==r&&Tt(e,i,r)}else for(var o in t)t.hasOwnProperty(o)&&Tt(e,o,t[o])}function Rt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Mt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Dt(e){return Mt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function _t(){}var Ot=null;function It(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Pt=null,jt=null;function Ft(e){var t=Qe(e);if(t&&(e=t.stateNode)){var n=e[We]||null;e:switch(e=t.stateNode,t.type){case"input":if(yt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+vt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=r[We]||null;if(!i)throw Error(a(90));yt(r,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&mt(r)}break e;case"textarea":St(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&xt(e,!!n.multiple,t,!1)}}}var Ht=!1;function Lt(e,t,n){if(Ht)return e(t,n);Ht=!0;try{return e(t)}finally{if(Ht=!1,(null!==Pt||null!==jt)&&(Zc(),Pt&&(t=Pt,e=jt,jt=Pt=null,Ft(t),e)))for(t=0;t<e.length;t++)Ft(e[t])}}function Bt(e,t){var n=e.stateNode;if(null===n)return null;var r=n[We]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var zt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Wt=!1;if(zt)try{var Vt={};Object.defineProperty(Vt,"passive",{get:function(){Wt=!0}}),window.addEventListener("test",Vt,Vt),window.removeEventListener("test",Vt,Vt)}catch(Qh){Wt=!1}var Ut=null,qt=null,Gt=null;function Yt(){if(Gt)return Gt;var e,t,n=qt,r=n.length,i="value"in Ut?Ut.value:Ut.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[o-t];t++);return Gt=i.slice(e,1<t?1-t:void 0)}function Kt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function $t(){return!0}function Xt(){return!1}function Qt(e){function t(t,n,r,i,o){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?$t:Xt,this.isPropagationStopped=Xt,this}return f(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=$t)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=$t)},persist:function(){},isPersistent:$t}),t}var Jt,Zt,en,tn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nn=Qt(tn),rn=f({},tn,{view:0,detail:0}),on=Qt(rn),an=f({},rn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==en&&(en&&"mousemove"===e.type?(Jt=e.screenX-en.screenX,Zt=e.screenY-en.screenY):Zt=Jt=0,en=e),Jt)},movementY:function(e){return"movementY"in e?e.movementY:Zt}}),sn=Qt(an),ln=Qt(f({},an,{dataTransfer:0})),cn=Qt(f({},rn,{relatedTarget:0})),un=Qt(f({},tn,{animationName:0,elapsedTime:0,pseudoElement:0})),dn=Qt(f({},tn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),hn=Qt(f({},tn,{data:0})),fn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=pn[e])&&!!t[e]}function vn(){return gn}var yn=Qt(f({},rn,{key:function(e){if(e.key){var t=fn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Kt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?mn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vn,charCode:function(e){return"keypress"===e.type?Kt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Kt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),bn=Qt(f({},an,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),wn=Qt(f({},rn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vn})),xn=Qt(f({},tn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Sn=Qt(f({},an,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Cn=Qt(f({},tn,{newState:0,oldState:0})),En=[9,13,27,32],Nn=zt&&"CompositionEvent"in window,Tn=null;zt&&"documentMode"in document&&(Tn=document.documentMode);var An=zt&&"TextEvent"in window&&!Tn,Rn=zt&&(!Nn||Tn&&8<Tn&&11>=Tn),kn=String.fromCharCode(32),Mn=!1;function Dn(e,t){switch(e){case"keyup":return-1!==En.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _n(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var On=!1;var In={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!In[e.type]:"textarea"===t}function jn(e,t,n,r){Pt?jt?jt.push(r):jt=[r]:Pt=r,0<(t=rd(t,"onChange")).length&&(n=new nn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Fn=null,Hn=null;function Ln(e){$u(e,0)}function Bn(e){if(mt(Je(e)))return e}function zn(e,t){if("change"===e)return t}var Wn=!1;if(zt){var Vn;if(zt){var Un="oninput"in document;if(!Un){var qn=document.createElement("div");qn.setAttribute("oninput","return;"),Un="function"===typeof qn.oninput}Vn=Un}else Vn=!1;Wn=Vn&&(!document.documentMode||9<document.documentMode)}function Gn(){Fn&&(Fn.detachEvent("onpropertychange",Yn),Hn=Fn=null)}function Yn(e){if("value"===e.propertyName&&Bn(Hn)){var t=[];jn(t,Hn,e,It(e)),Lt(Ln,t)}}function Kn(e,t,n){"focusin"===e?(Gn(),Hn=n,(Fn=t).attachEvent("onpropertychange",Yn)):"focusout"===e&&Gn()}function $n(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Bn(Hn)}function Xn(e,t){if("click"===e)return Bn(t)}function Qn(e,t){if("input"===e||"change"===e)return Bn(t)}var Jn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Zn(e,t){if(Jn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!re.call(t,i)||!Jn(e[i],t[i]))return!1}return!0}function er(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function tr(e,t){var n,r=er(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=er(r)}}function nr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?nr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function rr(e){for(var t=pt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=pt((e=t.contentWindow).document)}return t}function ir(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var or=zt&&"documentMode"in document&&11>=document.documentMode,ar=null,sr=null,lr=null,cr=!1;function ur(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;cr||null==ar||ar!==pt(r)||("selectionStart"in(r=ar)&&ir(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},lr&&Zn(lr,r)||(lr=r,0<(r=rd(sr,"onSelect")).length&&(t=new nn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=ar)))}function dr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var hr={animationend:dr("Animation","AnimationEnd"),animationiteration:dr("Animation","AnimationIteration"),animationstart:dr("Animation","AnimationStart"),transitionrun:dr("Transition","TransitionRun"),transitionstart:dr("Transition","TransitionStart"),transitioncancel:dr("Transition","TransitionCancel"),transitionend:dr("Transition","TransitionEnd")},fr={},mr={};function pr(e){if(fr[e])return fr[e];if(!hr[e])return e;var t,n=hr[e];for(t in n)if(n.hasOwnProperty(t)&&t in mr)return fr[e]=n[t];return e}zt&&(mr=document.createElement("div").style,"AnimationEvent"in window||(delete hr.animationend.animation,delete hr.animationiteration.animation,delete hr.animationstart.animation),"TransitionEvent"in window||delete hr.transitionend.transition);var gr=pr("animationend"),vr=pr("animationiteration"),yr=pr("animationstart"),br=pr("transitionrun"),wr=pr("transitionstart"),xr=pr("transitioncancel"),Sr=pr("transitionend"),Cr=new Map,Er="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nr(e,t){Cr.set(e,t),rt(t,[e])}Er.push("scrollEnd");var Tr="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},Ar=[],Rr=0,kr=0;function Mr(){for(var e=Rr,t=kr=Rr=0;t<e;){var n=Ar[t];Ar[t++]=null;var r=Ar[t];Ar[t++]=null;var i=Ar[t];Ar[t++]=null;var o=Ar[t];if(Ar[t++]=null,null!==r&&null!==i){var a=r.pending;null===a?i.next=i:(i.next=a.next,a.next=i),r.pending=i}0!==o&&Ir(n,i,o)}}function Dr(e,t,n,r){Ar[Rr++]=e,Ar[Rr++]=t,Ar[Rr++]=n,Ar[Rr++]=r,kr|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function _r(e,t,n,r){return Dr(e,t,n,r),Pr(e)}function Or(e,t){return Dr(e,null,null,t),Pr(e)}function Ir(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var i=!1,o=e.return;null!==o;)o.childLanes|=n,null!==(r=o.alternate)&&(r.childLanes|=n),22===o.tag&&(null===(e=o.stateNode)||1&e._visibility||(i=!0)),e=o,o=o.return;return 3===e.tag?(o=e.stateNode,i&&null!==t&&(i=31-we(n),null===(r=(e=o.hiddenUpdates)[i])?e[i]=[t]:r.push(t),t.lane=536870912|n),o):null}function Pr(e){if(50<Uc)throw Uc=0,qc=null,Error(a(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var jr={};function Fr(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Hr(e,t,n,r){return new Fr(e,t,n,r)}function Lr(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Br(e,t){var n=e.alternate;return null===n?((n=Hr(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function zr(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Wr(e,t,n,r,i,o){var s=0;if(r=e,"function"===typeof e)Lr(e)&&(s=1);else if("string"===typeof e)s=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,U.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case A:return(e=Hr(31,n,t,i)).elementType=A,e.lanes=o,e;case v:return Vr(n.children,i,o,t);case y:s=8,i|=24;break;case b:return(e=Hr(12,n,t,2|i)).elementType=b,e.lanes=o,e;case C:return(e=Hr(13,n,t,i)).elementType=C,e.lanes=o,e;case E:return(e=Hr(19,n,t,i)).elementType=E,e.lanes=o,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case x:s=10;break e;case w:s=9;break e;case S:s=11;break e;case N:s=14;break e;case T:s=16,r=null;break e}s=29,n=Error(a(130,null===e?"null":typeof e,"")),r=null}return(t=Hr(s,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Vr(e,t,n,r){return(e=Hr(7,e,r,t)).lanes=n,e}function Ur(e,t,n){return(e=Hr(6,e,null,t)).lanes=n,e}function qr(e){var t=Hr(18,null,null,0);return t.stateNode=e,t}function Gr(e,t,n){return(t=Hr(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Yr=new WeakMap;function Kr(e,t){if("object"===typeof e&&null!==e){var n=Yr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:ne(t)},Yr.set(e,t),t)}return{value:e,source:t,stack:ne(t)}}var $r=[],Xr=0,Qr=null,Jr=0,Zr=[],ei=0,ti=null,ni=1,ri="";function ii(e,t){$r[Xr++]=Jr,$r[Xr++]=Qr,Qr=e,Jr=t}function oi(e,t,n){Zr[ei++]=ni,Zr[ei++]=ri,Zr[ei++]=ti,ti=e;var r=ni;e=ri;var i=32-we(r)-1;r&=~(1<<i),n+=1;var o=32-we(t)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,ni=1<<32-we(t)+i|n<<i|r,ri=o+e}else ni=1<<o|n<<i|r,ri=e}function ai(e){null!==e.return&&(ii(e,1),oi(e,1,0))}function si(e){for(;e===Qr;)Qr=$r[--Xr],$r[Xr]=null,Jr=$r[--Xr],$r[Xr]=null;for(;e===ti;)ti=Zr[--ei],Zr[ei]=null,ri=Zr[--ei],Zr[ei]=null,ni=Zr[--ei],Zr[ei]=null}function li(e,t){Zr[ei++]=ni,Zr[ei++]=ri,Zr[ei++]=ti,ni=t.id,ri=t.overflow,ti=e}var ci=null,ui=null,di=!1,hi=null,fi=!1,mi=Error(a(519));function pi(e){throw xi(Kr(Error(a(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),mi}function gi(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[ze]=e,t[We]=r,n){case"dialog":Xu("cancel",t),Xu("close",t);break;case"iframe":case"object":case"embed":Xu("load",t);break;case"video":case"audio":for(n=0;n<Yu.length;n++)Xu(Yu[n],t);break;case"source":Xu("error",t);break;case"img":case"image":case"link":Xu("error",t),Xu("load",t);break;case"details":Xu("toggle",t);break;case"input":Xu("invalid",t),bt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":Xu("invalid",t);break;case"textarea":Xu("invalid",t),Ct(t,r.value,r.defaultValue,r.children)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||cd(t.textContent,n)?(null!=r.popover&&(Xu("beforetoggle",t),Xu("toggle",t)),null!=r.onScroll&&Xu("scroll",t),null!=r.onScrollEnd&&Xu("scrollend",t),null!=r.onClick&&(t.onclick=_t),t=!0):t=!1,t||pi(e,!0)}function vi(e){for(ci=e.return;ci;)switch(ci.tag){case 5:case 31:case 13:return void(fi=!1);case 27:case 3:return void(fi=!0);default:ci=ci.return}}function yi(e){if(e!==ci)return!1;if(!di)return vi(e),di=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||bd(e.type,e.memoizedProps)),t=!t),t&&ui&&pi(e),vi(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));ui=Pd(e)}else if(31===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));ui=Pd(e)}else 27===n?(n=ui,Td(e.type)?(e=Id,Id=null,ui=e):ui=n):ui=ci?Od(e.stateNode.nextSibling):null;return!0}function bi(){ui=ci=null,di=!1}function wi(){var e=hi;return null!==e&&(null===Mc?Mc=e:Mc.push.apply(Mc,e),hi=null),e}function xi(e){null===hi?hi=[e]:hi.push(e)}var Si=L(null),Ci=null,Ei=null;function Ni(e,t,n){z(Si,t._currentValue),t._currentValue=n}function Ti(e){e._currentValue=Si.current,B(Si)}function Ai(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ri(e,t,n,r){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var o=i.dependencies;if(null!==o){var s=i.child;o=o.firstContext;e:for(;null!==o;){var l=o;o=i;for(var c=0;c<t.length;c++)if(l.context===t[c]){o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Ai(o.return,n,e),r||(s=null);break e}o=l.next}}else if(18===i.tag){if(null===(s=i.return))throw Error(a(341));s.lanes|=n,null!==(o=s.alternate)&&(o.lanes|=n),Ai(s,n,e),s=null}else s=i.child;if(null!==s)s.return=i;else for(s=i;null!==s;){if(s===e){s=null;break}if(null!==(i=s.sibling)){i.return=s.return,s=i;break}s=s.return}i=s}}function ki(e,t,n,r){e=null;for(var i=t,o=!1;null!==i;){if(!o)if(0!==(524288&i.flags))o=!0;else if(0!==(262144&i.flags))break;if(10===i.tag){var s=i.alternate;if(null===s)throw Error(a(387));if(null!==(s=s.memoizedProps)){var l=i.type;Jn(i.pendingProps.value,s.value)||(null!==e?e.push(l):e=[l])}}else if(i===Y.current){if(null===(s=i.alternate))throw Error(a(387));s.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(uh):e=[uh])}i=i.return}null!==e&&Ri(t,e,n,r),t.flags|=262144}function Mi(e){for(e=e.firstContext;null!==e;){if(!Jn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Di(e){Ci=e,Ei=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function _i(e){return Ii(Ci,e)}function Oi(e,t){return null===Ci&&Di(e),Ii(e,t)}function Ii(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===Ei){if(null===e)throw Error(a(308));Ei=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Ei=Ei.next=t;return n}var Pi="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},ji=r.unstable_scheduleCallback,Fi=r.unstable_NormalPriority,Hi={$$typeof:x,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Li(){return{controller:new Pi,data:new Map,refCount:0}}function Bi(e){e.refCount--,0===e.refCount&&ji(Fi,function(){e.controller.abort()})}var zi=null,Wi=0,Vi=0,Ui=null;function qi(){if(0===--Wi&&null!==zi){null!==Ui&&(Ui.status="fulfilled");var e=zi;zi=null,Vi=0,Ui=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Gi=I.S;I.S=function(e,t){Oc=le(),"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===zi){var n=zi=[];Wi=0,Vi=Wu(),Ui={status:"pending",value:void 0,then:function(e){n.push(e)}}}Wi++,t.then(qi,qi)}(0,t),null!==Gi&&Gi(e,t)};var Yi=L(null);function Ki(){var e=Yi.current;return null!==e?e:mc.pooledCache}function $i(e,t){z(Yi,null===t?Yi.current:t.pool)}function Xi(){var e=Ki();return null===e?null:{parent:Hi._currentValue,pool:e}}var Qi=Error(a(460)),Ji=Error(a(474)),Zi=Error(a(542)),eo={then:function(){}};function to(e){return"fulfilled"===(e=e.status)||"rejected"===e}function no(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(_t,_t),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw ao(e=t.reason),e;default:if("string"===typeof t.status)t.then(_t,_t);else{if(null!==(e=mc)&&100<e.shellSuspendCounter)throw Error(a(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw ao(e=t.reason),e}throw io=t,Qi}}function ro(e){try{return(0,e._init)(e._payload)}catch(t){if(null!==t&&"object"===typeof t&&"function"===typeof t.then)throw io=t,Qi;throw t}}var io=null;function oo(){if(null===io)throw Error(a(459));var e=io;return io=null,e}function ao(e){if(e===Qi||e===Zi)throw Error(a(483))}var so=null,lo=0;function co(e){var t=lo;return lo+=1,null===so&&(so=[]),no(so,e,t)}function uo(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function ho(e,t){if(t.$$typeof===m)throw Error(a(525));throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function fo(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=Br(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Ur(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var o=n.type;return o===v?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===T&&ro(o)===t.type)?(uo(t=i(t,n.props),n),t.return=e,t):(uo(t=Wr(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Gr(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=Vr(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Ur(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case p:return uo(n=Wr(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case g:return(t=Gr(t,e.mode,n)).return=e,t;case T:return h(e,t=ro(t),n)}if(O(t)||M(t))return(t=Vr(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return h(e,co(t),n);if(t.$$typeof===x)return h(e,Oi(e,t),n);ho(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case p:return n.key===i?c(e,t,n,r):null;case g:return n.key===i?u(e,t,n,r):null;case T:return f(e,t,n=ro(n),r)}if(O(n)||M(n))return null!==i?null:d(e,t,n,r,null);if("function"===typeof n.then)return f(e,t,co(n),r);if(n.$$typeof===x)return f(e,t,Oi(e,n),r);ho(e,n)}return null}function m(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case p:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case g:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case T:return m(e,t,n,r=ro(r),i)}if(O(r)||M(r))return d(t,e=e.get(n)||null,r,i,null);if("function"===typeof r.then)return m(e,t,n,co(r),i);if(r.$$typeof===x)return m(e,t,n,Oi(t,r),i);ho(t,r)}return null}function y(l,c,u,d){if("object"===typeof u&&null!==u&&u.type===v&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case p:e:{for(var b=u.key;null!==c;){if(c.key===b){if((b=u.type)===v){if(7===c.tag){n(l,c.sibling),(d=i(c,u.props.children)).return=l,l=d;break e}}else if(c.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===T&&ro(b)===c.type){n(l,c.sibling),uo(d=i(c,u.props),u),d.return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}u.type===v?((d=Vr(u.props.children,l.mode,d,u.key)).return=l,l=d):(uo(d=Wr(u.type,u.key,u.props,null,l.mode,d),u),d.return=l,l=d)}return s(l);case g:e:{for(b=u.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(d=i(c,u.children||[])).return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}(d=Gr(u,l.mode,d)).return=l,l=d}return s(l);case T:return y(l,c,u=ro(u),d)}if(O(u))return function(i,a,s,l){for(var c=null,u=null,d=a,p=a=0,g=null;null!==d&&p<s.length;p++){d.index>p?(g=d,d=null):g=d.sibling;var v=f(i,d,s[p],l);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(i,d),a=o(v,a,p),null===u?c=v:u.sibling=v,u=v,d=g}if(p===s.length)return n(i,d),di&&ii(i,p),c;if(null===d){for(;p<s.length;p++)null!==(d=h(i,s[p],l))&&(a=o(d,a,p),null===u?c=d:u.sibling=d,u=d);return di&&ii(i,p),c}for(d=r(d);p<s.length;p++)null!==(g=m(d,i,p,s[p],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?p:g.key),a=o(g,a,p),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(i,e)}),di&&ii(i,p),c}(l,c,u,d);if(M(u)){if("function"!==typeof(b=M(u)))throw Error(a(150));return function(i,s,l,c){if(null==l)throw Error(a(151));for(var u=null,d=null,p=s,g=s=0,v=null,y=l.next();null!==p&&!y.done;g++,y=l.next()){p.index>g?(v=p,p=null):v=p.sibling;var b=f(i,p,y.value,c);if(null===b){null===p&&(p=v);break}e&&p&&null===b.alternate&&t(i,p),s=o(b,s,g),null===d?u=b:d.sibling=b,d=b,p=v}if(y.done)return n(i,p),di&&ii(i,g),u;if(null===p){for(;!y.done;g++,y=l.next())null!==(y=h(i,y.value,c))&&(s=o(y,s,g),null===d?u=y:d.sibling=y,d=y);return di&&ii(i,g),u}for(p=r(p);!y.done;g++,y=l.next())null!==(y=m(p,i,g,y.value,c))&&(e&&null!==y.alternate&&p.delete(null===y.key?g:y.key),s=o(y,s,g),null===d?u=y:d.sibling=y,d=y);return e&&p.forEach(function(e){return t(i,e)}),di&&ii(i,g),u}(l,c,u=b.call(u),d)}if("function"===typeof u.then)return y(l,c,co(u),d);if(u.$$typeof===x)return y(l,c,Oi(l,u),d);ho(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(d=i(c,u)).return=l,l=d):(n(l,c),(d=Ur(u,l.mode,d)).return=l,l=d),s(l)):n(l,c)}return function(e,t,n,r){try{lo=0;var i=y(e,t,n,r);return so=null,i}catch(a){if(a===Qi||a===Zi)throw a;var o=Hr(29,a,null,e.mode);return o.lanes=r,o.return=e,o}}}var mo=fo(!0),po=fo(!1),go=!1;function vo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function yo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function bo(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function wo(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&fc)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,t=Pr(e),Ir(e,null,n),t}return Dr(e,r,t,n),Pr(e)}function xo(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ie(e,n)}}function So(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===o?i=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Co=!1;function Eo(){if(Co){if(null!==Ui)throw Ui}}function No(e,t,n,r){Co=!1;var i=e.updateQueue;go=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var l=s,c=l.next;l.next=null,null===a?o=c:a.next=c,a=l;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l))}if(null!==o){var d=i.baseState;for(a=0,u=c=l=null,s=o;;){var h=-536870913&s.lane,m=h!==s.lane;if(m?(gc&h)===h:(r&h)===h){0!==h&&h===Vi&&(Co=!0),null!==u&&(u=u.next={lane:0,tag:s.tag,payload:s.payload,callback:null,next:null});e:{var p=e,g=s;h=t;var v=n;switch(g.tag){case 1:if("function"===typeof(p=g.payload)){d=p.call(v,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=g.payload)?p.call(v,d,h):p)||void 0===h)break e;d=f({},d,h);break e;case 2:go=!0}}null!==(h=s.callback)&&(e.flags|=64,m&&(e.flags|=8192),null===(m=i.callbacks)?i.callbacks=[h]:m.push(h))}else m={lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=m,l=d):u=u.next=m,a|=h;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(m=s).next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}null===u&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null===o&&(i.shared.lanes=0),Ec|=a,e.lanes=a,e.memoizedState=d}}function To(e,t){if("function"!==typeof e)throw Error(a(191,e));e.call(t)}function Ao(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)To(n[e],t)}var Ro=L(null),ko=L(0);function Mo(e,t){z(ko,e=Sc),z(Ro,t),Sc=e|t.baseLanes}function Do(){z(ko,Sc),z(Ro,Ro.current)}function _o(){Sc=ko.current,B(Ro),B(ko)}var Oo=L(null),Io=null;function Po(e){var t=e.alternate;z(Bo,1&Bo.current),z(Oo,e),null===Io&&(null===t||null!==Ro.current||null!==t.memoizedState)&&(Io=e)}function jo(e){z(Bo,Bo.current),z(Oo,e),null===Io&&(Io=e)}function Fo(e){22===e.tag?(z(Bo,Bo.current),z(Oo,e),null===Io&&(Io=e)):Ho()}function Ho(){z(Bo,Bo.current),z(Oo,Oo.current)}function Lo(e){B(Oo),Io===e&&(Io=null),B(Bo)}var Bo=L(0);function zo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Dd(n)||_d(n)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(0!==(128&t.flags))return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Wo=0,Vo=null,Uo=null,qo=null,Go=!1,Yo=!1,Ko=!1,$o=0,Xo=0,Qo=null,Jo=0;function Zo(){throw Error(a(321))}function ea(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Jn(e[n],t[n]))return!1;return!0}function ta(e,t,n,r,i,o){return Wo=o,Vo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,I.H=null===e||null===e.memoizedState?gs:vs,Ko=!1,o=n(r,i),Ko=!1,Yo&&(o=ra(t,n,r,i)),na(e),o}function na(e){I.H=ps;var t=null!==Uo&&null!==Uo.next;if(Wo=0,qo=Uo=Vo=null,Go=!1,Xo=0,Qo=null,t)throw Error(a(300));null===e||Os||null!==(e=e.dependencies)&&Mi(e)&&(Os=!0)}function ra(e,t,n,r){Vo=e;var i=0;do{if(Yo&&(Qo=null),Xo=0,Yo=!1,25<=i)throw Error(a(301));if(i+=1,qo=Uo=null,null!=e.updateQueue){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,null!=o.memoCache&&(o.memoCache.index=0)}I.H=ys,o=t(n,r)}while(Yo);return o}function ia(){var e=I.H,t=e.useState()[0];return t="function"===typeof t.then?ua(t):t,e=e.useState()[0],(null!==Uo?Uo.memoizedState:null)!==e&&(Vo.flags|=1024),t}function oa(){var e=0!==$o;return $o=0,e}function aa(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function sa(e){if(Go){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Go=!1}Wo=0,qo=Uo=Vo=null,Yo=!1,Xo=$o=0,Qo=null}function la(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===qo?Vo.memoizedState=qo=e:qo=qo.next=e,qo}function ca(){if(null===Uo){var e=Vo.alternate;e=null!==e?e.memoizedState:null}else e=Uo.next;var t=null===qo?Vo.memoizedState:qo.next;if(null!==t)qo=t,Uo=e;else{if(null===e){if(null===Vo.alternate)throw Error(a(467));throw Error(a(310))}e={memoizedState:(Uo=e).memoizedState,baseState:Uo.baseState,baseQueue:Uo.baseQueue,queue:Uo.queue,next:null},null===qo?Vo.memoizedState=qo=e:qo=qo.next=e}return qo}function ua(e){var t=Xo;return Xo+=1,null===Qo&&(Qo=[]),e=no(Qo,e,t),t=Vo,null===(null===qo?t.memoizedState:qo.next)&&(t=t.alternate,I.H=null===t||null===t.memoizedState?gs:vs),e}function da(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return ua(e);if(e.$$typeof===x)return _i(e)}throw Error(a(438,String(e)))}function ha(e){var t=null,n=Vo.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=Vo.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},Vo.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=R;return t.index++,n}function fa(e,t){return"function"===typeof t?t(e):t}function ma(e){return pa(ca(),Uo,e)}function pa(e,t,n){var r=e.queue;if(null===r)throw Error(a(311));r.lastRenderedReducer=n;var i=e.baseQueue,o=r.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}t.baseQueue=i=o,r.pending=null}if(o=e.baseState,null===i)e.memoizedState=o;else{var l=s=null,c=null,u=t=i.next,d=!1;do{var h=-536870913&u.lane;if(h!==u.lane?(gc&h)===h:(Wo&h)===h){var f=u.revertLane;if(0===f)null!==c&&(c=c.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),h===Vi&&(d=!0);else{if((Wo&f)===f){u=u.next,f===Vi&&(d=!0);continue}h={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=h,s=o):c=c.next=h,Vo.lanes|=f,Ec|=f}h=u.action,Ko&&n(o,h),o=u.hasEagerState?u.eagerState:n(o,h)}else f={lane:h,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=f,s=o):c=c.next=f,Vo.lanes|=h,Ec|=h;u=u.next}while(null!==u&&u!==t);if(null===c?s=o:c.next=l,!Jn(o,e.memoizedState)&&(Os=!0,d&&null!==(n=Ui)))throw n;e.memoizedState=o,e.baseState=s,e.baseQueue=c,r.lastRenderedState=o}return null===i&&(r.lanes=0),[e.memoizedState,r.dispatch]}function ga(e){var t=ca(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=e(o,s.action),s=s.next}while(s!==i);Jn(o,t.memoizedState)||(Os=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function va(e,t,n){var r=Vo,i=ca(),o=di;if(o){if(void 0===n)throw Error(a(407));n=n()}else n=t();var s=!Jn((Uo||i).memoizedState,n);if(s&&(i.memoizedState=n,Os=!0),i=i.queue,Wa(wa.bind(null,r,i,e),[e]),i.getSnapshot!==t||s||null!==qo&&1&qo.memoizedState.tag){if(r.flags|=2048,Fa(9,{destroy:void 0},ba.bind(null,r,i,n,t),null),null===mc)throw Error(a(349));o||0!==(127&Wo)||ya(r,t,n)}return n}function ya(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Vo.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Vo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function ba(e,t,n,r){t.value=n,t.getSnapshot=r,xa(t)&&Sa(e)}function wa(e,t,n){return n(function(){xa(t)&&Sa(e)})}function xa(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Jn(e,n)}catch(r){return!0}}function Sa(e){var t=Or(e,2);null!==t&&Kc(t,e,2)}function Ca(e){var t=la();if("function"===typeof e){var n=e;if(e=n(),Ko){be(!0);try{n()}finally{be(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fa,lastRenderedState:e},t}function Ea(e,t,n,r){return e.baseState=n,pa(e,Uo,"function"===typeof r?r:fa)}function Na(e,t,n,r,i){if(hs(e))throw Error(a(485));if(null!==(e=t.action)){var o={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){o.listeners.push(e)}};null!==I.T?n(!0):o.isTransition=!1,r(o),null===(n=t.pending)?(o.next=t.pending=o,Ta(t,o)):(o.next=n.next,t.pending=n.next=o)}}function Ta(e,t){var n=t.action,r=t.payload,i=e.state;if(t.isTransition){var o=I.T,a={};I.T=a;try{var s=n(i,r),l=I.S;null!==l&&l(a,s),Aa(e,t,s)}catch(c){ka(e,t,c)}finally{null!==o&&null!==a.types&&(o.types=a.types),I.T=o}}else try{Aa(e,t,o=n(i,r))}catch(u){ka(e,t,u)}}function Aa(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){Ra(e,t,n)},function(n){return ka(e,t,n)}):Ra(e,t,n)}function Ra(e,t,n){t.status="fulfilled",t.value=n,Ma(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,Ta(e,n)))}function ka(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,Ma(t),t=t.next}while(t!==r)}e.action=null}function Ma(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Da(e,t){return t}function _a(e,t){if(di){var n=mc.formState;if(null!==n){e:{var r=Vo;if(di){if(ui){t:{for(var i=ui,o=fi;8!==i.nodeType;){if(!o){i=null;break t}if(null===(i=Od(i.nextSibling))){i=null;break t}}i="F!"===(o=i.data)||"F"===o?i:null}if(i){ui=Od(i.nextSibling),r="F!"===i.data;break e}}pi(r)}r=!1}r&&(t=n[0])}}return(n=la()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Da,lastRenderedState:t},n.queue=r,n=cs.bind(null,Vo,r),r.dispatch=n,r=Ca(!1),o=ds.bind(null,Vo,!1,r.queue),i={state:t,dispatch:null,action:e,pending:null},(r=la()).queue=i,n=Na.bind(null,Vo,i,o,n),i.dispatch=n,r.memoizedState=e,[t,n,!1]}function Oa(e){return Ia(ca(),Uo,e)}function Ia(e,t,n){if(t=pa(e,t,Da)[0],e=ma(fa)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var r=ua(t)}catch(a){if(a===Qi)throw Zi;throw a}else r=t;var i=(t=ca()).queue,o=i.dispatch;return n!==t.memoizedState&&(Vo.flags|=2048,Fa(9,{destroy:void 0},Pa.bind(null,i,n),null)),[r,o,e]}function Pa(e,t){e.action=t}function ja(e){var t=ca(),n=Uo;if(null!==n)return Ia(t,n,e);ca(),t=t.memoizedState;var r=(n=ca()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function Fa(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=Vo.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Vo.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ha(){return ca().memoizedState}function La(e,t,n,r){var i=la();Vo.flags|=e,i.memoizedState=Fa(1|t,{destroy:void 0},n,void 0===r?null:r)}function Ba(e,t,n,r){var i=ca();r=void 0===r?null:r;var o=i.memoizedState.inst;null!==Uo&&null!==r&&ea(r,Uo.memoizedState.deps)?i.memoizedState=Fa(t,o,n,r):(Vo.flags|=e,i.memoizedState=Fa(1|t,o,n,r))}function za(e,t){La(8390656,8,e,t)}function Wa(e,t){Ba(2048,8,e,t)}function Va(e){var t=ca().memoizedState;return function(e){Vo.flags|=4;var t=Vo.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},Vo.updateQueue=t,t.events=[e];else{var n=t.events;null===n?t.events=[e]:n.push(e)}}({ref:t,nextImpl:e}),function(){if(0!==(2&fc))throw Error(a(440));return t.impl.apply(void 0,arguments)}}function Ua(e,t){return Ba(4,2,e,t)}function qa(e,t){return Ba(4,4,e,t)}function Ga(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Ya(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,Ba(4,4,Ga.bind(null,t,e),n)}function Ka(){}function $a(e,t){var n=ca();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&ea(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Xa(e,t){var n=ca();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&ea(t,r[1]))return r[0];if(r=e(),Ko){be(!0);try{e()}finally{be(!1)}}return n.memoizedState=[r,t],r}function Qa(e,t,n){return void 0===n||0!==(1073741824&Wo)&&0===(261930&gc)?e.memoizedState=t:(e.memoizedState=n,e=Yc(),Vo.lanes|=e,Ec|=e,n)}function Ja(e,t,n,r){return Jn(n,t)?n:null!==Ro.current?(e=Qa(e,n,r),Jn(e,t)||(Os=!0),e):0===(42&Wo)||0!==(1073741824&Wo)&&0===(261930&gc)?(Os=!0,e.memoizedState=n):(e=Yc(),Vo.lanes|=e,Ec|=e,t)}function Za(e,t,n,r,i){var o=P.p;P.p=0!==o&&8>o?o:8;var a=I.T,s={};I.T=s,ds(e,!1,t,n);try{var l=i(),c=I.S;if(null!==c&&c(s,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)us(e,t,function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),r}(l,r),Gc());else us(e,t,r,Gc())}catch(u){us(e,t,{then:function(){},status:"rejected",reason:u},Gc())}finally{P.p=o,null!==a&&null!==s.types&&(a.types=s.types),I.T=a}}function es(){}function ts(e,t,n,r){if(5!==e.tag)throw Error(a(476));var i=ns(e).queue;Za(e,i,t,j,null===n?es:function(){return rs(e),n(r)})}function ns(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:j,baseState:j,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fa,lastRenderedState:j},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fa,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function rs(e){var t=ns(e);null===t.next&&(t=e.alternate.memoizedState),us(e,t.next.queue,{},Gc())}function is(){return _i(uh)}function os(){return ca().memoizedState}function as(){return ca().memoizedState}function ss(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Gc(),r=wo(t,e=bo(n),n);return null!==r&&(Kc(r,t,n),xo(r,t,n)),t={cache:Li()},void(e.payload=t)}t=t.return}}function ls(e,t,n){var r=Gc();n={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},hs(e)?fs(t,n):null!==(n=_r(e,t,n,r))&&(Kc(n,e,r),ms(n,t,r))}function cs(e,t,n){us(e,t,n,Gc())}function us(e,t,n,r){var i={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(hs(e))fs(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=o(a,n);if(i.hasEagerState=!0,i.eagerState=s,Jn(s,a))return Dr(e,t,i,0),null===mc&&Mr(),!1}catch(l){}if(null!==(n=_r(e,t,i,r)))return Kc(n,e,r),ms(n,t,r),!0}return!1}function ds(e,t,n,r){if(r={lane:2,revertLane:Wu(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},hs(e)){if(t)throw Error(a(479))}else null!==(t=_r(e,n,r,2))&&Kc(t,e,2)}function hs(e){var t=e.alternate;return e===Vo||null!==t&&t===Vo}function fs(e,t){Yo=Go=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ms(e,t,n){if(0!==(4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ie(e,n)}}var ps={readContext:_i,use:da,useCallback:Zo,useContext:Zo,useEffect:Zo,useImperativeHandle:Zo,useLayoutEffect:Zo,useInsertionEffect:Zo,useMemo:Zo,useReducer:Zo,useRef:Zo,useState:Zo,useDebugValue:Zo,useDeferredValue:Zo,useTransition:Zo,useSyncExternalStore:Zo,useId:Zo,useHostTransitionStatus:Zo,useFormState:Zo,useActionState:Zo,useOptimistic:Zo,useMemoCache:Zo,useCacheRefresh:Zo};ps.useEffectEvent=Zo;var gs={readContext:_i,use:da,useCallback:function(e,t){return la().memoizedState=[e,void 0===t?null:t],e},useContext:_i,useEffect:za,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,La(4194308,4,Ga.bind(null,t,e),n)},useLayoutEffect:function(e,t){return La(4194308,4,e,t)},useInsertionEffect:function(e,t){La(4,2,e,t)},useMemo:function(e,t){var n=la();t=void 0===t?null:t;var r=e();if(Ko){be(!0);try{e()}finally{be(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=la();if(void 0!==n){var i=n(t);if(Ko){be(!0);try{n(t)}finally{be(!1)}}}else i=t;return r.memoizedState=r.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},r.queue=e,e=e.dispatch=ls.bind(null,Vo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},la().memoizedState=e},useState:function(e){var t=(e=Ca(e)).queue,n=cs.bind(null,Vo,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Ka,useDeferredValue:function(e,t){return Qa(la(),e,t)},useTransition:function(){var e=Ca(!1);return e=Za.bind(null,Vo,e.queue,!0,!1),la().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=Vo,i=la();if(di){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===mc)throw Error(a(349));0!==(127&gc)||ya(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,za(wa.bind(null,r,o,e),[e]),r.flags|=2048,Fa(9,{destroy:void 0},ba.bind(null,r,o,n,t),null),n},useId:function(){var e=la(),t=mc.identifierPrefix;if(di){var n=ri;t="_"+t+"R_"+(n=(ni&~(1<<32-we(ni)-1)).toString(32)+n),0<(n=$o++)&&(t+="H"+n.toString(32)),t+="_"}else t="_"+t+"r_"+(n=Jo++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:is,useFormState:_a,useActionState:_a,useOptimistic:function(e){var t=la();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=ds.bind(null,Vo,!0,n),n.dispatch=t,[e,t]},useMemoCache:ha,useCacheRefresh:function(){return la().memoizedState=ss.bind(null,Vo)},useEffectEvent:function(e){var t=la(),n={impl:e};return t.memoizedState=n,function(){if(0!==(2&fc))throw Error(a(440));return n.impl.apply(void 0,arguments)}}},vs={readContext:_i,use:da,useCallback:$a,useContext:_i,useEffect:Wa,useImperativeHandle:Ya,useInsertionEffect:Ua,useLayoutEffect:qa,useMemo:Xa,useReducer:ma,useRef:Ha,useState:function(){return ma(fa)},useDebugValue:Ka,useDeferredValue:function(e,t){return Ja(ca(),Uo.memoizedState,e,t)},useTransition:function(){var e=ma(fa)[0],t=ca().memoizedState;return["boolean"===typeof e?e:ua(e),t]},useSyncExternalStore:va,useId:os,useHostTransitionStatus:is,useFormState:Oa,useActionState:Oa,useOptimistic:function(e,t){return Ea(ca(),0,e,t)},useMemoCache:ha,useCacheRefresh:as};vs.useEffectEvent=Va;var ys={readContext:_i,use:da,useCallback:$a,useContext:_i,useEffect:Wa,useImperativeHandle:Ya,useInsertionEffect:Ua,useLayoutEffect:qa,useMemo:Xa,useReducer:ga,useRef:Ha,useState:function(){return ga(fa)},useDebugValue:Ka,useDeferredValue:function(e,t){var n=ca();return null===Uo?Qa(n,e,t):Ja(n,Uo.memoizedState,e,t)},useTransition:function(){var e=ga(fa)[0],t=ca().memoizedState;return["boolean"===typeof e?e:ua(e),t]},useSyncExternalStore:va,useId:os,useHostTransitionStatus:is,useFormState:ja,useActionState:ja,useOptimistic:function(e,t){var n=ca();return null!==Uo?Ea(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:ha,useCacheRefresh:as};function bs(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:f({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}ys.useEffectEvent=Va;var ws={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Gc(),i=bo(r);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=wo(e,i,r))&&(Kc(t,e,r),xo(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Gc(),i=bo(r);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=wo(e,i,r))&&(Kc(t,e,r),xo(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Gc(),r=bo(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=wo(e,r,n))&&(Kc(t,e,n),xo(t,e,n))}};function xs(e,t,n,r,i,o,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!Zn(n,r)||!Zn(i,o))}function Ss(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ws.enqueueReplaceState(t,t.state,null)}function Cs(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var i in n===t&&(n=f({},n)),e)void 0===n[i]&&(n[i]=e[i]);return n}function Es(e){Tr(e)}function Ns(e){console.error(e)}function Ts(e){Tr(e)}function As(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Rs(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function ks(e,t,n){return(n=bo(n)).tag=3,n.payload={element:null},n.callback=function(){As(e,t)},n}function Ms(e){return(e=bo(e)).tag=3,e}function Ds(e,t,n,r){var i=n.type.getDerivedStateFromError;if("function"===typeof i){var o=r.value;e.payload=function(){return i(o)},e.callback=function(){Rs(t,n,r)}}var a=n.stateNode;null!==a&&"function"===typeof a.componentDidCatch&&(e.callback=function(){Rs(t,n,r),"function"!==typeof i&&(null===jc?jc=new Set([this]):jc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var _s=Error(a(461)),Os=!1;function Is(e,t,n,r){t.child=null===e?po(t,null,n,r):mo(t,e.child,n,r)}function Ps(e,t,n,r,i){n=n.render;var o=t.ref;if("ref"in r){var a={};for(var s in r)"ref"!==s&&(a[s]=r[s])}else a=r;return Di(t),r=ta(e,t,n,a,o,i),s=oa(),null===e||Os?(di&&s&&ai(t),t.flags|=1,Is(e,t,r,i),t.child):(aa(e,t,i),il(e,t,i))}function js(e,t,n,r,i){if(null===e){var o=n.type;return"function"!==typeof o||Lr(o)||void 0!==o.defaultProps||null!==n.compare?((e=Wr(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Fs(e,t,o,r,i))}if(o=e.child,!ol(e,i)){var a=o.memoizedProps;if((n=null!==(n=n.compare)?n:Zn)(a,r)&&e.ref===t.ref)return il(e,t,i)}return t.flags|=1,(e=Br(o,r)).ref=t.ref,e.return=t,t.child=e}function Fs(e,t,n,r,i){if(null!==e){var o=e.memoizedProps;if(Zn(o,r)&&e.ref===t.ref){if(Os=!1,t.pendingProps=r=o,!ol(e,i))return t.lanes=e.lanes,il(e,t,i);0!==(131072&e.flags)&&(Os=!0)}}return Us(e,t,n,r,i)}function Hs(e,t,n,r){var i=r.children,o=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===r.mode){if(0!==(128&t.flags)){if(o=null!==o?o.baseLanes|n:n,null!==e){for(r=t.child=e.child,i=0;null!==r;)i=i|r.lanes|r.childLanes,r=r.sibling;r=i&~o}else r=0,t.child=null;return Bs(e,t,o,n,r)}if(0===(536870912&n))return r=t.lanes=536870912,Bs(e,t,null!==o?o.baseLanes|n:n,n,r);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&$i(0,null!==o?o.cachePool:null),null!==o?Mo(t,o):Do(),Fo(t)}else null!==o?($i(0,o.cachePool),Mo(t,o),Ho(),t.memoizedState=null):(null!==e&&$i(0,null),Do(),Ho());return Is(e,t,i,n),t.child}function Ls(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Bs(e,t,n,r,i){var o=Ki();return o=null===o?null:{parent:Hi._currentValue,pool:o},t.memoizedState={baseLanes:n,cachePool:o},null!==e&&$i(0,null),Do(),Fo(t),null!==e&&ki(e,t,r,!0),t.childLanes=i,null}function zs(e,t){return(t=Zs({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function Ws(e,t,n){return mo(t,e.child,null,n),(e=zs(t,t.pendingProps)).flags|=2,Lo(t),t.memoizedState=null,e}function Vs(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(a(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Us(e,t,n,r,i){return Di(t),n=ta(e,t,n,r,void 0,i),r=oa(),null===e||Os?(di&&r&&ai(t),t.flags|=1,Is(e,t,n,i),t.child):(aa(e,t,i),il(e,t,i))}function qs(e,t,n,r,i,o){return Di(t),t.updateQueue=null,n=ra(t,r,n,i),na(e),r=oa(),null===e||Os?(di&&r&&ai(t),t.flags|=1,Is(e,t,n,o),t.child):(aa(e,t,o),il(e,t,o))}function Gs(e,t,n,r,i){if(Di(t),null===t.stateNode){var o=jr,a=n.contextType;"object"===typeof a&&null!==a&&(o=_i(a)),o=new n(r,o),t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,o.updater=ws,t.stateNode=o,o._reactInternals=t,(o=t.stateNode).props=r,o.state=t.memoizedState,o.refs={},vo(t),a=n.contextType,o.context="object"===typeof a&&null!==a?_i(a):jr,o.state=t.memoizedState,"function"===typeof(a=n.getDerivedStateFromProps)&&(bs(t,n,a,r),o.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(a=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),a!==o.state&&ws.enqueueReplaceState(o,o.state,null),No(t,r,o,i),Eo(),o.state=t.memoizedState),"function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){o=t.stateNode;var s=t.memoizedProps,l=Cs(n,s);o.props=l;var c=o.context,u=n.contextType;a=jr,"object"===typeof u&&null!==u&&(a=_i(u));var d=n.getDerivedStateFromProps;u="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate,s=t.pendingProps!==s,u||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s||c!==a)&&Ss(t,o,r,a),go=!1;var h=t.memoizedState;o.state=h,No(t,r,o,i),Eo(),c=t.memoizedState,s||h!==c||go?("function"===typeof d&&(bs(t,n,d,r),c=t.memoizedState),(l=go||xs(t,n,l,r,h,c,a))?(u||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=a,r=l):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,yo(e,t),u=Cs(n,a=t.memoizedProps),o.props=u,d=t.pendingProps,h=o.context,c=n.contextType,l=jr,"object"===typeof c&&null!==c&&(l=_i(c)),(c="function"===typeof(s=n.getDerivedStateFromProps)||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==d||h!==l)&&Ss(t,o,r,l),go=!1,h=t.memoizedState,o.state=h,No(t,r,o,i),Eo();var f=t.memoizedState;a!==d||h!==f||go||null!==e&&null!==e.dependencies&&Mi(e.dependencies)?("function"===typeof s&&(bs(t,n,s,r),f=t.memoizedState),(u=go||xs(t,n,u,r,h,f,l)||null!==e&&null!==e.dependencies&&Mi(e.dependencies))?(c||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,f,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),o.props=r,o.state=f,o.context=l,r=u):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return o=r,Vs(e,t),r=0!==(128&t.flags),o||r?(o=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:o.render(),t.flags|=1,null!==e&&r?(t.child=mo(t,e.child,null,i),t.child=mo(t,null,n,i)):Is(e,t,n,i),t.memoizedState=o.state,e=t.child):e=il(e,t,i),e}function Ys(e,t,n,r){return bi(),t.flags|=256,Is(e,t,n,r),t.child}var Ks={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function $s(e){return{baseLanes:e,cachePool:Xi()}}function Xs(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=Ac),e}function Qs(e,t,n){var r,i=t.pendingProps,o=!1,s=0!==(128&t.flags);if((r=s)||(r=(null===e||null!==e.memoizedState)&&0!==(2&Bo.current)),r&&(o=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(di){if(o?Po(t):Ho(),(e=ui)?null!==(e=null!==(e=Md(e,fi))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ti?{id:ni,overflow:ri}:null,retryLane:536870912,hydrationErrors:null},(n=qr(e)).return=t,t.child=n,ci=t,ui=null):e=null,null===e)throw pi(t);return _d(e)?t.lanes=32:t.lanes=536870912,null}var l=i.children;return i=i.fallback,o?(Ho(),l=Zs({mode:"hidden",children:l},o=t.mode),i=Vr(i,o,n,null),l.return=t,i.return=t,l.sibling=i,t.child=l,(i=t.child).memoizedState=$s(n),i.childLanes=Xs(e,r,n),t.memoizedState=Ks,Ls(null,i)):(Po(t),Js(t,l))}var c=e.memoizedState;if(null!==c&&null!==(l=c.dehydrated)){if(s)256&t.flags?(Po(t),t.flags&=-257,t=el(e,t,n)):null!==t.memoizedState?(Ho(),t.child=e.child,t.flags|=128,t=null):(Ho(),l=i.fallback,o=t.mode,i=Zs({mode:"visible",children:i.children},o),(l=Vr(l,o,n,null)).flags|=2,i.return=t,l.return=t,i.sibling=l,t.child=i,mo(t,e.child,null,n),(i=t.child).memoizedState=$s(n),i.childLanes=Xs(e,r,n),t.memoizedState=Ks,t=Ls(null,i));else if(Po(t),_d(l)){if(r=l.nextSibling&&l.nextSibling.dataset)var u=r.dgst;r=u,(i=Error(a(419))).stack="",i.digest=r,xi({value:i,source:null,stack:null}),t=el(e,t,n)}else if(Os||ki(e,t,n,!1),r=0!==(n&e.childLanes),Os||r){if(null!==(r=mc)&&(0!==(i=Pe(r,n))&&i!==c.retryLane))throw c.retryLane=i,Or(e,i),Kc(r,e,i),_s;Dd(l)||au(),t=el(e,t,n)}else Dd(l)?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,ui=Od(l.nextSibling),ci=t,di=!0,hi=null,fi=!1,null!==e&&li(t,e),(t=Js(t,i.children)).flags|=4096);return t}return o?(Ho(),l=i.fallback,o=t.mode,u=(c=e.child).sibling,(i=Br(c,{mode:"hidden",children:i.children})).subtreeFlags=65011712&c.subtreeFlags,null!==u?l=Br(u,l):(l=Vr(l,o,n,null)).flags|=2,l.return=t,i.return=t,i.sibling=l,t.child=i,Ls(null,i),i=t.child,null===(l=e.child.memoizedState)?l=$s(n):(null!==(o=l.cachePool)?(c=Hi._currentValue,o=o.parent!==c?{parent:c,pool:c}:o):o=Xi(),l={baseLanes:l.baseLanes|n,cachePool:o}),i.memoizedState=l,i.childLanes=Xs(e,r,n),t.memoizedState=Ks,Ls(e.child,i)):(Po(t),e=(n=e.child).sibling,(n=Br(n,{mode:"visible",children:i.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function Js(e,t){return(t=Zs({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Zs(e,t){return(e=Hr(22,e,null,t)).lanes=0,e}function el(e,t,n){return mo(t,e.child,null,n),(e=Js(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function tl(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ai(e.return,t,n)}function nl(e,t,n,r,i,o){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i,treeForkCount:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i,a.treeForkCount=o)}function rl(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;r=r.children;var a=Bo.current,s=0!==(2&a);if(s?(a=1&a|2,t.flags|=128):a&=1,z(Bo,a),Is(e,t,r,n),r=di?Jr:0,!s&&null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&tl(e,n,t);else if(19===e.tag)tl(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===zo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),nl(t,!1,i,n,o,r);break;case"backwards":case"unstable_legacy-backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===zo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}nl(t,!0,n,null,o,r);break;case"together":nl(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function il(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ec|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(ki(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Br(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Br(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function ol(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Mi(e))}function al(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Os=!0;else{if(!ol(e,n)&&0===(128&t.flags))return Os=!1,function(e,t,n){switch(t.tag){case 3:K(t,t.stateNode.containerInfo),Ni(0,Hi,e.memoizedState.cache),bi();break;case 27:case 5:X(t);break;case 4:K(t,t.stateNode.containerInfo);break;case 10:Ni(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,jo(t),null;break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(Po(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Qs(e,t,n):(Po(t),null!==(e=il(e,t,n))?e.sibling:null);Po(t);break;case 19:var i=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(ki(e,t,n,!1),r=0!==(n&t.childLanes)),i){if(r)return rl(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),z(Bo,Bo.current),r)break;return null;case 22:return t.lanes=0,Hs(e,t,n,t.pendingProps);case 24:Ni(0,Hi,e.memoizedState.cache)}return il(e,t,n)}(e,t,n);Os=0!==(131072&e.flags)}else Os=!1,di&&0!==(1048576&t.flags)&&oi(t,Jr,t.index);switch(t.lanes=0,t.tag){case 16:e:{var r=t.pendingProps;if(e=ro(t.elementType),t.type=e,"function"!==typeof e){if(void 0!==e&&null!==e){var i=e.$$typeof;if(i===S){t.tag=11,t=Ps(null,t,e,r,n);break e}if(i===N){t.tag=14,t=js(null,t,e,r,n);break e}}throw t=_(e)||e,Error(a(306,t,""))}Lr(e)?(r=Cs(e,r),t.tag=1,t=Gs(null,t,e,r,n)):(t.tag=0,t=Us(null,t,e,r,n))}return t;case 0:return Us(e,t,t.type,t.pendingProps,n);case 1:return Gs(e,t,r=t.type,i=Cs(r,t.pendingProps),n);case 3:e:{if(K(t,t.stateNode.containerInfo),null===e)throw Error(a(387));r=t.pendingProps;var o=t.memoizedState;i=o.element,yo(e,t),No(t,r,null,n);var s=t.memoizedState;if(r=s.cache,Ni(0,Hi,r),r!==o.cache&&Ri(t,[Hi],n,!0),Eo(),r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ys(e,t,r,n);break e}if(r!==i){xi(i=Kr(Error(a(424)),t)),t=Ys(e,t,r,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(ui=Od(e.firstChild),ci=t,di=!0,hi=null,fi=!0,n=po(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(bi(),r===i){t=il(e,t,n);break e}Is(e,t,r,n)}t=t.child}return t;case 26:return Vs(e,t),null===e?(n=qd(t.type,null,t.pendingProps,null))?t.memoizedState=n:di||(n=t.type,e=t.pendingProps,(r=gd(G.current).createElement(n))[ze]=t,r[We]=e,hd(r,n,e),et(r),t.stateNode=r):t.memoizedState=qd(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return X(t),null===e&&di&&(r=t.stateNode=Fd(t.type,t.pendingProps,G.current),ci=t,fi=!0,i=ui,Td(t.type)?(Id=i,ui=Od(r.firstChild)):ui=i),Is(e,t,t.pendingProps.children,n),Vs(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&di&&((i=r=ui)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var i=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[Ke])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(o=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(o!==i.rel||e.getAttribute("href")!==(null==i.href||""===i.href?null:i.href)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin)||e.getAttribute("title")!==(null==i.title?null:i.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((o=e.getAttribute("src"))!==(null==i.src?null:i.src)||e.getAttribute("type")!==(null==i.type?null:i.type)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin))&&o&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var o=null==i.name?null:""+i.name;if("hidden"===i.type&&e.getAttribute("name")===o)return e}if(null===(e=Od(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,fi))?(t.stateNode=r,ci=t,ui=Od(r.firstChild),fi=!1,i=!0):i=!1),i||pi(t)),X(t),i=t.type,o=t.pendingProps,s=null!==e?e.memoizedProps:null,r=o.children,bd(i,o)?r=null:null!==s&&bd(i,s)&&(t.flags|=32),null!==t.memoizedState&&(i=ta(e,t,ia,null,null,n),uh._currentValue=i),Vs(e,t),Is(e,t,r,n),t.child;case 6:return null===e&&di&&((e=n=ui)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=Od(e.nextSibling)))return null}return e}(n,t.pendingProps,fi))?(t.stateNode=n,ci=t,ui=null,e=!0):e=!1),e||pi(t)),null;case 13:return Qs(e,t,n);case 4:return K(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=mo(t,null,r,n):Is(e,t,r,n),t.child;case 11:return Ps(e,t,t.type,t.pendingProps,n);case 7:return Is(e,t,t.pendingProps,n),t.child;case 8:case 12:return Is(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,Ni(0,t.type,r.value),Is(e,t,r.children,n),t.child;case 9:return i=t.type._context,r=t.pendingProps.children,Di(t),r=r(i=_i(i)),t.flags|=1,Is(e,t,r,n),t.child;case 14:return js(e,t,t.type,t.pendingProps,n);case 15:return Fs(e,t,t.type,t.pendingProps,n);case 19:return rl(e,t,n);case 31:return function(e,t,n){var r=t.pendingProps,i=0!==(128&t.flags);if(t.flags&=-129,null===e){if(di){if("hidden"===r.mode)return e=zs(t,r),t.lanes=536870912,Ls(null,e);if(jo(t),(e=ui)?null!==(e=null!==(e=Md(e,fi))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ti?{id:ni,overflow:ri}:null,retryLane:536870912,hydrationErrors:null},(n=qr(e)).return=t,t.child=n,ci=t,ui=null):e=null,null===e)throw pi(t);return t.lanes=536870912,null}return zs(t,r)}var o=e.memoizedState;if(null!==o){var s=o.dehydrated;if(jo(t),i)if(256&t.flags)t.flags&=-257,t=Ws(e,t,n);else{if(null===t.memoizedState)throw Error(a(558));t.child=e.child,t.flags|=128,t=null}else if(Os||ki(e,t,n,!1),i=0!==(n&e.childLanes),Os||i){if(null!==(r=mc)&&0!==(s=Pe(r,n))&&s!==o.retryLane)throw o.retryLane=s,Or(e,s),Kc(r,e,s),_s;au(),t=Ws(e,t,n)}else e=o.treeContext,ui=Od(s.nextSibling),ci=t,di=!0,hi=null,fi=!1,null!==e&&li(t,e),(t=zs(t,r)).flags|=4096;return t}return(e=Br(e.child,{mode:r.mode,children:r.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,n);case 22:return Hs(e,t,n,t.pendingProps);case 24:return Di(t),r=_i(Hi),null===e?(null===(i=Ki())&&(i=mc,o=Li(),i.pooledCache=o,o.refCount++,null!==o&&(i.pooledCacheLanes|=n),i=o),t.memoizedState={parent:r,cache:i},vo(t),Ni(0,Hi,i)):(0!==(e.lanes&n)&&(yo(e,t),No(t,null,null,n),Eo()),i=e.memoizedState,o=t.memoizedState,i.parent!==r?(i={parent:r,cache:r},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),Ni(0,Hi,r)):(r=o.cache,Ni(0,Hi,r),r!==i.cache&&Ri(t,[Hi],n,!0))),Is(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(a(156,t.tag))}function sl(e){e.flags|=4}function ll(e,t,n,r,i){if((t=0!==(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&i)===i)if(e.stateNode.complete)e.flags|=8192;else{if(!ru())throw io=eo,Ji;e.flags|=8192}}else e.flags&=-16777217}function cl(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!ih(t)){if(!ru())throw io=eo,Ji;e.flags|=8192}}function ul(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Me():536870912,e.lanes|=t,Rc|=t)}function dl(e,t){if(!di)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function hl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=65011712&i.subtreeFlags,r|=65011712&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function fl(e,t,n){var r=t.pendingProps;switch(si(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return hl(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Ti(Hi),$(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(yi(t)?sl(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,wi())),hl(t),null;case 26:var i=t.type,o=t.memoizedState;return null===e?(sl(t),null!==o?(hl(t),cl(t,o)):(hl(t),ll(t,i,0,0,n))):o?o!==e.memoizedState?(sl(t),hl(t),cl(t,o)):(hl(t),t.flags&=-16777217):((e=e.memoizedProps)!==r&&sl(t),hl(t),ll(t,i,0,0,n)),null;case 27:if(Q(t),n=G.current,i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&sl(t);else{if(!r){if(null===t.stateNode)throw Error(a(166));return hl(t),null}e=U.current,yi(t)?gi(t):(e=Fd(i,r,n),t.stateNode=e,sl(t))}return hl(t),null;case 5:if(Q(t),i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&sl(t);else{if(!r){if(null===t.stateNode)throw Error(a(166));return hl(t),null}if(o=U.current,yi(t))gi(t);else{var s=gd(G.current);switch(o){case 1:o=s.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:o=s.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":o=s.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":o=s.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":(o=s.createElement("div")).innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o="string"===typeof r.is?s.createElement("select",{is:r.is}):s.createElement("select"),r.multiple?o.multiple=!0:r.size&&(o.size=r.size);break;default:o="string"===typeof r.is?s.createElement(i,{is:r.is}):s.createElement(i)}}o[ze]=t,o[We]=r;e:for(s=t.child;null!==s;){if(5===s.tag||6===s.tag)o.appendChild(s.stateNode);else if(4!==s.tag&&27!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;null===s.sibling;){if(null===s.return||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}t.stateNode=o;e:switch(hd(o,i,r),i){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&sl(t)}}return hl(t),ll(t,t.type,null===e||e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&sl(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(e=G.current,yi(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(i=ci))switch(i.tag){case 27:case 5:r=i.memoizedProps}e[ze]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||cd(e.nodeValue,n)))||pi(t,!0)}else(e=gd(e).createTextNode(r))[ze]=t,t.stateNode=e}return hl(t),null;case 31:if(n=t.memoizedState,null===e||null!==e.memoizedState){if(r=yi(t),null!==n){if(null===e){if(!r)throw Error(a(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(a(557));e[ze]=t}else bi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hl(t),e=!1}else n=wi(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return 256&t.flags?(Lo(t),t):(Lo(t),null);if(0!==(128&t.flags))throw Error(a(558))}return hl(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=yi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(a(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(a(317));i[ze]=t}else bi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hl(t),i=!1}else i=wi(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return 256&t.flags?(Lo(t),t):(Lo(t),null)}return Lo(t),0!==(128&t.flags)?(t.lanes=n,t):(n=null!==r,e=null!==e&&null!==e.memoizedState,n&&(i=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(i=r.alternate.memoizedState.cachePool.pool),o=null,null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(o=r.memoizedState.cachePool.pool),o!==i&&(r.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),ul(t,t.updateQueue),hl(t),null);case 4:return $(),null===e&&Zu(t.stateNode.containerInfo),hl(t),null;case 10:return Ti(t.type),hl(t),null;case 19:if(B(Bo),null===(r=t.memoizedState))return hl(t),null;if(i=0!==(128&t.flags),null===(o=r.rendering))if(i)dl(r,!1);else{if(0!==Cc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=zo(e))){for(t.flags|=128,dl(r,!1),e=o.updateQueue,t.updateQueue=e,ul(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)zr(n,e),n=n.sibling;return z(Bo,1&Bo.current|2),di&&ii(t,r.treeForkCount),t.child}e=e.sibling}null!==r.tail&&le()>Ic&&(t.flags|=128,i=!0,dl(r,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=zo(o))){if(t.flags|=128,i=!0,e=e.updateQueue,t.updateQueue=e,ul(t,e),dl(r,!0),null===r.tail&&"hidden"===r.tailMode&&!o.alternate&&!di)return hl(t),null}else 2*le()-r.renderingStartTime>Ic&&536870912!==n&&(t.flags|=128,i=!0,dl(r,!1),t.lanes=4194304);r.isBackwards?(o.sibling=t.child,t.child=o):(null!==(e=r.last)?e.sibling=o:t.child=o,r.last=o)}return null!==r.tail?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=le(),e.sibling=null,n=Bo.current,z(Bo,i?1&n|2:1&n),di&&ii(t,r.treeForkCount),e):(hl(t),null);case 22:case 23:return Lo(t),_o(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(hl(t),6&t.subtreeFlags&&(t.flags|=8192)):hl(t),null!==(n=t.updateQueue)&&ul(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&B(Yi),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Ti(Hi),hl(t),null;case 25:case 30:return null}throw Error(a(156,t.tag))}function ml(e,t){switch(si(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ti(Hi),$(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Q(t),null;case 31:if(null!==t.memoizedState){if(Lo(t),null===t.alternate)throw Error(a(340));bi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(Lo(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));bi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return B(Bo),null;case 4:return $(),null;case 10:return Ti(t.type),null;case 22:case 23:return Lo(t),_o(),null!==e&&B(Yi),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Ti(Hi),null;default:return null}}function pl(e,t){switch(si(t),t.tag){case 3:Ti(Hi),$();break;case 26:case 27:case 5:Q(t);break;case 4:$();break;case 31:null!==t.memoizedState&&Lo(t);break;case 13:Lo(t);break;case 19:B(Bo);break;case 10:Ti(t.type);break;case 22:case 23:Lo(t),_o(),null!==e&&B(Yi);break;case 24:Ti(Hi)}}function gl(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var i=r.next;n=i;do{if((n.tag&e)===e){r=void 0;var o=n.create,a=n.inst;r=o(),a.destroy=r}n=n.next}while(n!==i)}}catch(s){Cu(t,t.return,s)}}function vl(e,t,n){try{var r=t.updateQueue,i=null!==r?r.lastEffect:null;if(null!==i){var o=i.next;r=o;do{if((r.tag&e)===e){var a=r.inst,s=a.destroy;if(void 0!==s){a.destroy=void 0,i=t;var l=n,c=s;try{c()}catch(u){Cu(i,l,u)}}}r=r.next}while(r!==o)}}catch(u){Cu(t,t.return,u)}}function yl(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{Ao(t,n)}catch(r){Cu(e,e.return,r)}}}function bl(e,t,n){n.props=Cs(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){Cu(e,t,r)}}function wl(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"===typeof n?e.refCleanup=n(r):n.current=r}}catch(i){Cu(e,t,i)}}function xl(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(i){Cu(e,t,i)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(o){Cu(e,t,o)}else n.current=null}function Sl(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(i){Cu(e,e.return,i)}}function Cl(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,o=null,s=null,l=null,c=null,u=null,d=null;for(m in n){var h=n[m];if(n.hasOwnProperty(m)&&null!=h)switch(m){case"checked":case"value":break;case"defaultValue":c=h;default:r.hasOwnProperty(m)||ud(e,t,m,null,r,h)}}for(var f in r){var m=r[f];if(h=n[f],r.hasOwnProperty(f)&&(null!=m||null!=h))switch(f){case"type":o=m;break;case"name":i=m;break;case"checked":u=m;break;case"defaultChecked":d=m;break;case"value":s=m;break;case"defaultValue":l=m;break;case"children":case"dangerouslySetInnerHTML":if(null!=m)throw Error(a(137,t));break;default:m!==h&&ud(e,t,f,m,r,h)}}return void yt(e,s,l,c,u,d,o,i);case"select":for(o in m=s=l=f=null,n)if(c=n[o],n.hasOwnProperty(o)&&null!=c)switch(o){case"value":break;case"multiple":m=c;default:r.hasOwnProperty(o)||ud(e,t,o,null,r,c)}for(i in r)if(o=r[i],c=n[i],r.hasOwnProperty(i)&&(null!=o||null!=c))switch(i){case"value":f=o;break;case"defaultValue":l=o;break;case"multiple":s=o;default:o!==c&&ud(e,t,i,o,r,c)}return t=l,n=s,r=m,void(null!=f?xt(e,!!n,f,!1):!!r!==!!n&&(null!=t?xt(e,!!n,t,!0):xt(e,!!n,n?[]:"",!1)));case"textarea":for(l in m=f=null,n)if(i=n[l],n.hasOwnProperty(l)&&null!=i&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:ud(e,t,l,null,r,i)}for(s in r)if(i=r[s],o=n[s],r.hasOwnProperty(s)&&(null!=i||null!=o))switch(s){case"value":f=i;break;case"defaultValue":m=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(a(91));break;default:i!==o&&ud(e,t,s,i,r,o)}return void St(e,f,m);case"option":for(var p in n)if(f=n[p],n.hasOwnProperty(p)&&null!=f&&!r.hasOwnProperty(p))if("selected"===p)e.selected=!1;else ud(e,t,p,null,r,f);for(c in r)if(f=r[c],m=n[c],r.hasOwnProperty(c)&&f!==m&&(null!=f||null!=m))if("selected"===c)e.selected=f&&"function"!==typeof f&&"symbol"!==typeof f;else ud(e,t,c,f,r,m);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)f=n[g],n.hasOwnProperty(g)&&null!=f&&!r.hasOwnProperty(g)&&ud(e,t,g,null,r,f);for(u in r)if(f=r[u],m=n[u],r.hasOwnProperty(u)&&f!==m&&(null!=f||null!=m))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(a(137,t));break;default:ud(e,t,u,f,r,m)}return;default:if(Rt(t)){for(var v in n)f=n[v],n.hasOwnProperty(v)&&void 0!==f&&!r.hasOwnProperty(v)&&dd(e,t,v,void 0,r,f);for(d in r)f=r[d],m=n[d],!r.hasOwnProperty(d)||f===m||void 0===f&&void 0===m||dd(e,t,d,f,r,m);return}}for(var y in n)f=n[y],n.hasOwnProperty(y)&&null!=f&&!r.hasOwnProperty(y)&&ud(e,t,y,null,r,f);for(h in r)f=r[h],m=n[h],!r.hasOwnProperty(h)||f===m||null==f&&null==m||ud(e,t,h,f,r,m)}(r,e.type,n,t),r[We]=t}catch(i){Cu(e,e.return,i)}}function El(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Td(e.type)||4===e.tag}function Nl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||El(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Td(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Tl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=_t));else if(4!==r&&(27===r&&Td(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(Tl(e,t,n),e=e.sibling;null!==e;)Tl(e,t,n),e=e.sibling}function Al(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&Td(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(Al(e,t,n),e=e.sibling;null!==e;)Al(e,t,n),e=e.sibling}function Rl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,i=t.attributes;i.length;)t.removeAttributeNode(i[0]);hd(t,r,n),t[ze]=e,t[We]=n}catch(o){Cu(e,e.return,o)}}var kl=!1,Ml=!1,Dl=!1,_l="function"===typeof WeakSet?WeakSet:Set,Ol=null;function Il(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:Kl(e,n),4&r&&gl(5,n);break;case 1:if(Kl(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(a){Cu(n,n.return,a)}else{var i=Cs(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.__reactInternalSnapshotBeforeUpdate)}catch(s){Cu(n,n.return,s)}}64&r&&yl(n),512&r&&wl(n,n.return);break;case 3:if(Kl(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{Ao(e,t)}catch(a){Cu(n,n.return,a)}}break;case 27:null===t&&4&r&&Rl(n);case 26:case 5:Kl(e,n),null===t&&4&r&&Sl(n),512&r&&wl(n,n.return);break;case 12:Kl(e,n);break;case 31:Kl(e,n),4&r&&Bl(e,n);break;case 13:Kl(e,n),4&r&&zl(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=Au.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||kl)){t=null!==t&&null!==t.memoizedState||Ml,i=kl;var o=Ml;kl=r,(Ml=t)&&!o?Xl(e,n,0!==(8772&n.subtreeFlags)):Kl(e,n),kl=i,Ml=o}break;case 30:break;default:Kl(e,n)}}function Pl(e){var t=e.alternate;null!==t&&(e.alternate=null,Pl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&$e(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var jl=null,Fl=!1;function Hl(e,t,n){for(n=n.child;null!==n;)Ll(e,t,n),n=n.sibling}function Ll(e,t,n){if(ye&&"function"===typeof ye.onCommitFiberUnmount)try{ye.onCommitFiberUnmount(ve,n)}catch(o){}switch(n.tag){case 26:Ml||xl(n,t),Hl(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Ml||xl(n,t);var r=jl,i=Fl;Td(n.type)&&(jl=n.stateNode,Fl=!1),Hl(e,t,n),Hd(n.stateNode),jl=r,Fl=i;break;case 5:Ml||xl(n,t);case 6:if(r=jl,i=Fl,jl=null,Hl(e,t,n),Fl=i,null!==(jl=r))if(Fl)try{(9===jl.nodeType?jl.body:"HTML"===jl.nodeName?jl.ownerDocument.body:jl).removeChild(n.stateNode)}catch(a){Cu(n,t,a)}else try{jl.removeChild(n.stateNode)}catch(a){Cu(n,t,a)}break;case 18:null!==jl&&(Fl?(Ad(9===(e=jl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Uh(e)):Ad(jl,n.stateNode));break;case 4:r=jl,i=Fl,jl=n.stateNode.containerInfo,Fl=!0,Hl(e,t,n),jl=r,Fl=i;break;case 0:case 11:case 14:case 15:vl(2,n,t),Ml||vl(4,n,t),Hl(e,t,n);break;case 1:Ml||(xl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&bl(n,t,r)),Hl(e,t,n);break;case 21:Hl(e,t,n);break;case 22:Ml=(r=Ml)||null!==n.memoizedState,Hl(e,t,n),Ml=r;break;default:Hl(e,t,n)}}function Bl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Uh(e)}catch(n){Cu(t,t.return,n)}}}function zl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Uh(e)}catch(n){Cu(t,t.return,n)}}function Wl(e,t){var n=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new _l),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new _l),t;default:throw Error(a(435,e.tag))}}(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var r=Ru.bind(null,e,t);t.then(r,r)}})}function Vl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r],o=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 27:if(Td(l.type)){jl=l.stateNode,Fl=!1;break e}break;case 5:jl=l.stateNode,Fl=!1;break e;case 3:case 4:jl=l.stateNode.containerInfo,Fl=!0;break e}l=l.return}if(null===jl)throw Error(a(160));Ll(o,s,i),jl=null,Fl=!1,null!==(o=i.alternate)&&(o.return=null),i.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)ql(t,e),t=t.sibling}var Ul=null;function ql(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Vl(t,e),Gl(e),4&r&&(vl(3,e,e.return),gl(3,e),vl(5,e,e.return));break;case 1:Vl(t,e),Gl(e),512&r&&(Ml||null===n||xl(n,n.return)),64&r&&kl&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var i=Ul;if(Vl(t,e),Gl(e),512&r&&(Ml||null===n||xl(n,n.return)),4&r){var o=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,i=i.ownerDocument||i;t:switch(r){case"title":(!(o=i.getElementsByTagName("title")[0])||o[Ke]||o[ze]||"http://www.w3.org/2000/svg"===o.namespaceURI||o.hasAttribute("itemprop"))&&(o=i.createElement(r),i.head.insertBefore(o,i.querySelector("head > title"))),hd(o,r,n),o[ze]=e,et(o),r=o;break e;case"link":var s=nh("link","href",i).get(r+(n.href||""));if(s)for(var l=0;l<s.length;l++)if((o=s[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&o.getAttribute("rel")===(null==n.rel?null:n.rel)&&o.getAttribute("title")===(null==n.title?null:n.title)&&o.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){s.splice(l,1);break t}hd(o=i.createElement(r),r,n),i.head.appendChild(o);break;case"meta":if(s=nh("meta","content",i).get(r+(n.content||"")))for(l=0;l<s.length;l++)if((o=s[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&o.getAttribute("name")===(null==n.name?null:n.name)&&o.getAttribute("property")===(null==n.property?null:n.property)&&o.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&o.getAttribute("charset")===(null==n.charSet?null:n.charSet)){s.splice(l,1);break t}hd(o=i.createElement(r),r,n),i.head.appendChild(o);break;default:throw Error(a(468,r))}o[ze]=e,et(o),r=o}e.stateNode=r}else rh(i,e.type,e.stateNode);else e.stateNode=Qd(i,r,e.memoizedProps);else o!==r?(null===o?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):o.count--,null===r?rh(i,e.type,e.stateNode):Qd(i,r,e.memoizedProps)):null===r&&null!==e.stateNode&&Cl(e,e.memoizedProps,n.memoizedProps)}break;case 27:Vl(t,e),Gl(e),512&r&&(Ml||null===n||xl(n,n.return)),null!==n&&4&r&&Cl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Vl(t,e),Gl(e),512&r&&(Ml||null===n||xl(n,n.return)),32&e.flags){i=e.stateNode;try{Et(i,"")}catch(p){Cu(e,e.return,p)}}4&r&&null!=e.stateNode&&Cl(e,i=e.memoizedProps,null!==n?n.memoizedProps:i),1024&r&&(Dl=!0);break;case 6:if(Vl(t,e),Gl(e),4&r){if(null===e.stateNode)throw Error(a(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(p){Cu(e,e.return,p)}}break;case 3:if(th=null,i=Ul,Ul=zd(t.containerInfo),Vl(t,e),Ul=i,Gl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Uh(t.containerInfo)}catch(p){Cu(e,e.return,p)}Dl&&(Dl=!1,Yl(e));break;case 4:r=Ul,Ul=zd(e.stateNode.containerInfo),Vl(t,e),Gl(e),Ul=r;break;case 12:default:Vl(t,e),Gl(e);break;case 31:case 19:Vl(t,e),Gl(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Wl(e,r)));break;case 13:Vl(t,e),Gl(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(_c=le()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Wl(e,r)));break;case 22:i=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,u=kl,d=Ml;if(kl=u||i,Ml=d||c,Vl(t,e),Ml=d,kl=u,Gl(e),8192&r)e:for(t=e.stateNode,t._visibility=i?-2&t._visibility:1|t._visibility,i&&(null===n||c||kl||Ml||$l(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(o=c.stateNode,i)"function"===typeof(s=o.style).setProperty?s.setProperty("display","none","important"):s.display="none";else{l=c.stateNode;var h=c.memoizedProps.style,f=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;l.style.display=null==f||"boolean"===typeof f?"":(""+f).trim()}}catch(p){Cu(c,c.return,p)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=i?"":c.memoizedProps}catch(p){Cu(c,c.return,p)}}}else if(18===t.tag){if(null===n){c=t;try{var m=c.stateNode;i?Rd(m,!0):Rd(c.stateNode,!1)}catch(p){Cu(c,c.return,p)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,Wl(e,n))));case 30:case 21:}}function Gl(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(El(r)){n=r;break}r=r.return}if(null==n)throw Error(a(160));switch(n.tag){case 27:var i=n.stateNode;Al(e,Nl(e),i);break;case 5:var o=n.stateNode;32&n.flags&&(Et(o,""),n.flags&=-33),Al(e,Nl(e),o);break;case 3:case 4:var s=n.stateNode.containerInfo;Tl(e,Nl(e),s);break;default:throw Error(a(161))}}catch(l){Cu(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Yl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Yl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Kl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Il(e,t.alternate,t),t=t.sibling}function $l(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:vl(4,t,t.return),$l(t);break;case 1:xl(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&bl(t,t.return,n),$l(t);break;case 27:Hd(t.stateNode);case 26:case 5:xl(t,t.return),$l(t);break;case 22:null===t.memoizedState&&$l(t);break;default:$l(t)}e=e.sibling}}function Xl(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,i=e,o=t,a=o.flags;switch(o.tag){case 0:case 11:case 15:Xl(i,o,n),gl(4,o);break;case 1:if(Xl(i,o,n),"function"===typeof(i=(r=o).stateNode).componentDidMount)try{i.componentDidMount()}catch(c){Cu(r,r.return,c)}if(null!==(i=(r=o).updateQueue)){var s=r.stateNode;try{var l=i.shared.hiddenCallbacks;if(null!==l)for(i.shared.hiddenCallbacks=null,i=0;i<l.length;i++)To(l[i],s)}catch(c){Cu(r,r.return,c)}}n&&64&a&&yl(o),wl(o,o.return);break;case 27:Rl(o);case 26:case 5:Xl(i,o,n),n&&null===r&&4&a&&Sl(o),wl(o,o.return);break;case 12:Xl(i,o,n);break;case 31:Xl(i,o,n),n&&4&a&&Bl(i,o);break;case 13:Xl(i,o,n),n&&4&a&&zl(i,o);break;case 22:null===o.memoizedState&&Xl(i,o,n),wl(o,o.return);break;case 30:break;default:Xl(i,o,n)}t=t.sibling}}function Ql(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Bi(n))}function Jl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Bi(e))}function Zl(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)ec(e,t,n,r),t=t.sibling}function ec(e,t,n,r){var i=t.flags;switch(t.tag){case 0:case 11:case 15:Zl(e,t,n,r),2048&i&&gl(9,t);break;case 1:case 31:case 13:default:Zl(e,t,n,r);break;case 3:Zl(e,t,n,r),2048&i&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Bi(e)));break;case 12:if(2048&i){Zl(e,t,n,r),e=t.stateNode;try{var o=t.memoizedProps,a=o.id,s=o.onPostCommit;"function"===typeof s&&s(a,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){Cu(t,t.return,l)}}else Zl(e,t,n,r);break;case 23:break;case 22:o=t.stateNode,a=t.alternate,null!==t.memoizedState?2&o._visibility?Zl(e,t,n,r):nc(e,t):2&o._visibility?Zl(e,t,n,r):(o._visibility|=2,tc(e,t,n,r,0!==(10256&t.subtreeFlags)||!1)),2048&i&&Ql(a,t);break;case 24:Zl(e,t,n,r),2048&i&&Jl(t.alternate,t)}}function tc(e,t,n,r,i){for(i=i&&(0!==(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var o=e,a=t,s=n,l=r,c=a.flags;switch(a.tag){case 0:case 11:case 15:tc(o,a,s,l,i),gl(8,a);break;case 23:break;case 22:var u=a.stateNode;null!==a.memoizedState?2&u._visibility?tc(o,a,s,l,i):nc(o,a):(u._visibility|=2,tc(o,a,s,l,i)),i&&2048&c&&Ql(a.alternate,a);break;case 24:tc(o,a,s,l,i),i&&2048&c&&Jl(a.alternate,a);break;default:tc(o,a,s,l,i)}t=t.sibling}}function nc(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,i=r.flags;switch(r.tag){case 22:nc(n,r),2048&i&&Ql(r.alternate,r);break;case 24:nc(n,r),2048&i&&Jl(r.alternate,r);break;default:nc(n,r)}t=t.sibling}}var rc=8192;function ic(e,t,n){if(e.subtreeFlags&rc)for(e=e.child;null!==e;)oc(e,t,n),e=e.sibling}function oc(e,t,n){switch(e.tag){case 26:ic(e,t,n),e.flags&rc&&null!==e.memoizedState&&function(e,t,n,r){if("stylesheet"===n.type&&("string"!==typeof r.media||!1!==matchMedia(r.media).matches)&&0===(4&n.state.loading)){if(null===n.instance){var i=Gd(r.href),o=t.querySelector(Yd(i));if(o)return null!==(t=o._p)&&"object"===typeof t&&"function"===typeof t.then&&(e.count++,e=ah.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=o,void et(o);o=t.ownerDocument||t,r=Kd(r),(i=Ld.get(i))&&Zd(r,i),et(o=o.createElement("link"));var a=o;a._p=new Promise(function(e,t){a.onload=e,a.onerror=t}),hd(o,"link",r),n.instance=o}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&0===(3&n.state.loading)&&(e.count++,n=ah.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}(n,Ul,e.memoizedState,e.memoizedProps);break;case 5:default:ic(e,t,n);break;case 3:case 4:var r=Ul;Ul=zd(e.stateNode.containerInfo),ic(e,t,n),Ul=r;break;case 22:null===e.memoizedState&&(null!==(r=e.alternate)&&null!==r.memoizedState?(r=rc,rc=16777216,ic(e,t,n),rc=r):ic(e,t,n))}}function ac(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function sc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Ol=r,uc(r,e)}ac(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)lc(e),e=e.sibling}function lc(e){switch(e.tag){case 0:case 11:case 15:sc(e),2048&e.flags&&vl(9,e,e.return);break;case 3:case 12:default:sc(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,cc(e)):sc(e)}}function cc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Ol=r,uc(r,e)}ac(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:vl(8,t,t.return),cc(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,cc(t));break;default:cc(t)}e=e.sibling}}function uc(e,t){for(;null!==Ol;){var n=Ol;switch(n.tag){case 0:case 11:case 15:vl(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Bi(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,Ol=r;else e:for(n=e;null!==Ol;){var i=(r=Ol).sibling,o=r.return;if(Pl(r),r===n){Ol=null;break e}if(null!==i){i.return=o,Ol=i;break e}Ol=o}}}var dc={getCacheForType:function(e){var t=_i(Hi),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return _i(Hi).controller.signal}},hc="function"===typeof WeakMap?WeakMap:Map,fc=0,mc=null,pc=null,gc=0,vc=0,yc=null,bc=!1,wc=!1,xc=!1,Sc=0,Cc=0,Ec=0,Nc=0,Tc=0,Ac=0,Rc=0,kc=null,Mc=null,Dc=!1,_c=0,Oc=0,Ic=1/0,Pc=null,jc=null,Fc=0,Hc=null,Lc=null,Bc=0,zc=0,Wc=null,Vc=null,Uc=0,qc=null;function Gc(){return 0!==(2&fc)&&0!==gc?gc&-gc:null!==I.T?Wu():He()}function Yc(){if(0===Ac)if(0===(536870912&gc)||di){var e=Ee;0===(3932160&(Ee<<=1))&&(Ee=262144),Ac=e}else Ac=536870912;return null!==(e=Oo.current)&&(e.flags|=32),Ac}function Kc(e,t,n){(e!==mc||2!==vc&&9!==vc)&&null===e.cancelPendingCommit||(tu(e,0),Jc(e,gc,Ac,!1)),_e(e,n),0!==(2&fc)&&e===mc||(e===mc&&(0===(2&fc)&&(Nc|=n),4===Cc&&Jc(e,gc,Ac,!1)),Pu(e))}function $c(e,t,n){if(0!==(6&fc))throw Error(a(327));for(var r=!n&&0===(127&t)&&0===(t&e.expiredLanes)||Re(e,t),i=r?function(e,t){var n=fc;fc|=2;var r=iu(),i=ou();mc!==e||gc!==t?(Pc=null,Ic=le()+500,tu(e,t)):wc=Re(e,t);e:for(;;)try{if(0!==vc&&null!==pc){t=pc;var o=yc;t:switch(vc){case 1:vc=0,yc=null,hu(e,t,o,1);break;case 2:case 9:if(to(o)){vc=0,yc=null,du(t);break}t=function(){2!==vc&&9!==vc||mc!==e||(vc=7),Pu(e)},o.then(t,t);break e;case 3:vc=7;break e;case 4:vc=5;break e;case 7:to(o)?(vc=0,yc=null,du(t)):(vc=0,yc=null,hu(e,t,o,7));break;case 5:var s=null;switch(pc.tag){case 26:s=pc.memoizedState;case 5:case 27:var l=pc;if(s?ih(s):l.stateNode.complete){vc=0,yc=null;var c=l.sibling;if(null!==c)pc=c;else{var u=l.return;null!==u?(pc=u,fu(u)):pc=null}break t}}vc=0,yc=null,hu(e,t,o,5);break;case 6:vc=0,yc=null,hu(e,t,o,6);break;case 8:eu(),Cc=6;break e;default:throw Error(a(462))}}cu();break}catch(d){nu(e,d)}return Ei=Ci=null,I.H=r,I.A=i,fc=n,null!==pc?0:(mc=null,gc=0,Mr(),Cc)}(e,t):su(e,t,!0),o=r;;){if(0===i){wc&&!r&&Jc(e,t,0,!1);break}if(n=e.current.alternate,!o||Qc(n)){if(2===i){if(o=t,e.errorRecoveryDisabledLanes&o)var s=0;else s=0!==(s=-536870913&e.pendingLanes)?s:536870912&s?536870912:0;if(0!==s){t=s;e:{var l=e;i=kc;var c=l.current.memoizedState.isDehydrated;if(c&&(tu(l,s).flags|=256),2!==(s=su(l,s,!1))){if(xc&&!c){l.errorRecoveryDisabledLanes|=o,Nc|=o,i=4;break e}o=Mc,Mc=i,null!==o&&(null===Mc?Mc=o:Mc.push.apply(Mc,o))}i=s}if(o=!1,2!==i)continue}}if(1===i){tu(e,0),Jc(e,t,0,!0);break}e:{switch(r=e,o=i){case 0:case 1:throw Error(a(345));case 4:if((4194048&t)!==t)break;case 6:Jc(r,t,Ac,!bc);break e;case 2:Mc=null;break;case 3:case 5:break;default:throw Error(a(329))}if((62914560&t)===t&&10<(i=_c+300-le())){if(Jc(r,t,Ac,!bc),0!==Ae(r,0,!0))break e;Bc=t,r.timeoutHandle=xd(Xc.bind(null,r,n,Mc,Pc,Dc,t,Ac,Nc,Rc,bc,o,"Throttled",-0,0),i)}else Xc(r,n,Mc,Pc,Dc,t,Ac,Nc,Rc,bc,o,null,-0,0)}break}i=su(e,t,!1),o=!1}Pu(e)}function Xc(e,t,n,r,i,o,a,s,l,c,u,d,h,f){if(e.timeoutHandle=-1,8192&(d=t.subtreeFlags)||16785408===(16785408&d)){oc(t,o,d={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:_t});var m=(62914560&o)===o?_c-le():(4194048&o)===o?Oc-le():0;if(null!==(m=function(e,t){return e.stylesheets&&0===e.count&&lh(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var r=setTimeout(function(){if(e.stylesheets&&lh(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===oh&&(oh=62500*function(){if("function"===typeof performance.getEntriesByType){for(var e=0,t=0,n=performance.getEntriesByType("resource"),r=0;r<n.length;r++){var i=n[r],o=i.transferSize,a=i.initiatorType,s=i.duration;if(o&&s&&fd(a)){for(a=0,s=i.responseEnd,r+=1;r<n.length;r++){var l=n[r],c=l.startTime;if(c>s)break;var u=l.transferSize,d=l.initiatorType;u&&fd(d)&&(a+=u*((l=l.responseEnd)<s?1:(s-c)/(l-c)))}if(--r,t+=8*(o+a)/(i.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"===typeof(e=navigator.connection.downlink)?e:5}());var i=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&lh(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>oh?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(i)}}:null}(d,m)))return Bc=o,e.cancelPendingCommit=m(pu.bind(null,e,t,o,n,r,i,a,s,l,u,d,null,h,f)),void Jc(e,o,a,!c)}pu(e,t,o,n,r,i,a,s,l)}function Qc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Jn(o(),i))return!1}catch(a){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Jc(e,t,n,r){t&=~Tc,t&=~Nc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var i=t;0<i;){var o=31-we(i),a=1<<o;r[o]=-1,i&=~a}0!==n&&Oe(e,n,t)}function Zc(){return 0!==(6&fc)||(ju(0,!1),!1)}function eu(){if(null!==pc){if(0===vc)var e=pc.return;else Ei=Ci=null,sa(e=pc),so=null,lo=0,e=pc;for(;null!==e;)pl(e.alternate,e),e=e.return;pc=null}}function tu(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,Sd(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Bc=0,eu(),mc=e,pc=n=Br(e.current,null),gc=t,vc=0,yc=null,bc=!1,wc=Re(e,t),xc=!1,Rc=Ac=Tc=Nc=Ec=Cc=0,Mc=kc=null,Dc=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var i=31-we(r),o=1<<i;t|=e[i],r&=~o}return Sc=t,Mr(),n}function nu(e,t){Vo=null,I.H=ps,t===Qi||t===Zi?(t=oo(),vc=3):t===Ji?(t=oo(),vc=4):vc=t===_s?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,yc=t,null===pc&&(Cc=1,As(e,Kr(t,e.current)))}function ru(){var e=Oo.current;return null===e||((4194048&gc)===gc?null===Io:((62914560&gc)===gc||0!==(536870912&gc))&&e===Io)}function iu(){var e=I.H;return I.H=ps,null===e?ps:e}function ou(){var e=I.A;return I.A=dc,e}function au(){Cc=4,bc||(4194048&gc)!==gc&&null!==Oo.current||(wc=!0),0===(134217727&Ec)&&0===(134217727&Nc)||null===mc||Jc(mc,gc,Ac,!1)}function su(e,t,n){var r=fc;fc|=2;var i=iu(),o=ou();mc===e&&gc===t||(Pc=null,tu(e,t)),t=!1;var a=Cc;e:for(;;)try{if(0!==vc&&null!==pc){var s=pc,l=yc;switch(vc){case 8:eu(),a=6;break e;case 3:case 2:case 9:case 6:null===Oo.current&&(t=!0);var c=vc;if(vc=0,yc=null,hu(e,s,l,c),n&&wc){a=0;break e}break;default:c=vc,vc=0,yc=null,hu(e,s,l,c)}}lu(),a=Cc;break}catch(u){nu(e,u)}return t&&e.shellSuspendCounter++,Ei=Ci=null,fc=r,I.H=i,I.A=o,null===pc&&(mc=null,gc=0,Mr()),a}function lu(){for(;null!==pc;)uu(pc)}function cu(){for(;null!==pc&&!ae();)uu(pc)}function uu(e){var t=al(e.alternate,e,Sc);e.memoizedProps=e.pendingProps,null===t?fu(e):pc=t}function du(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=qs(n,t,t.pendingProps,t.type,void 0,gc);break;case 11:t=qs(n,t,t.pendingProps,t.type.render,t.ref,gc);break;case 5:sa(t);default:pl(n,t),t=al(n,t=pc=zr(t,Sc),Sc)}e.memoizedProps=e.pendingProps,null===t?fu(e):pc=t}function hu(e,t,n,r){Ei=Ci=null,sa(t),so=null,lo=0;var i=t.return;try{if(function(e,t,n,r,i){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&ki(t,n,i,!0),null!==(n=Oo.current)){switch(n.tag){case 31:case 13:return null===Io?au():null===n.alternate&&0===Cc&&(Cc=3),n.flags&=-257,n.flags|=65536,n.lanes=i,r===eo?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),Eu(e,r,i)),!1;case 22:return n.flags|=65536,r===eo?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),Eu(e,r,i)),!1}throw Error(a(435,n.tag))}return Eu(e,r,i),au(),!1}if(di)return null!==(t=Oo.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,r!==mi&&xi(Kr(e=Error(a(422),{cause:r}),n))):(r!==mi&&xi(Kr(t=Error(a(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,r=Kr(r,n),So(e,i=ks(e.stateNode,r,i)),4!==Cc&&(Cc=2)),!1;var o=Error(a(520),{cause:r});if(o=Kr(o,n),null===kc?kc=[o]:kc.push(o),4!==Cc&&(Cc=2),null===t)return!0;r=Kr(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=i&-i,n.lanes|=e,So(n,e=ks(n.stateNode,r,e)),!1;case 1:if(t=n.type,o=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==o&&"function"===typeof o.componentDidCatch&&(null===jc||!jc.has(o))))return n.flags|=65536,i&=-i,n.lanes|=i,Ds(i=Ms(i),e,n,r),So(n,i),!1}n=n.return}while(null!==n);return!1}(e,i,t,n,gc))return Cc=1,As(e,Kr(n,e.current)),void(pc=null)}catch(o){if(null!==i)throw pc=i,o;return Cc=1,As(e,Kr(n,e.current)),void(pc=null)}32768&t.flags?(di||1===r?e=!0:wc||0!==(536870912&gc)?e=!1:(bc=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=Oo.current)&&13===r.tag&&(r.flags|=16384))),mu(t,e)):fu(t)}function fu(e){var t=e;do{if(0!==(32768&t.flags))return void mu(t,bc);e=t.return;var n=fl(t.alternate,t,Sc);if(null!==n)return void(pc=n);if(null!==(t=t.sibling))return void(pc=t);pc=t=e}while(null!==t);0===Cc&&(Cc=5)}function mu(e,t){do{var n=ml(e.alternate,e);if(null!==n)return n.flags&=32767,void(pc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(pc=e);pc=e=n}while(null!==e);Cc=6,pc=null}function pu(e,t,n,r,i,o,s,l,c){e.cancelPendingCommit=null;do{wu()}while(0!==Fc);if(0!==(6&fc))throw Error(a(327));if(null!==t){if(t===e.current)throw Error(a(177));if(o=t.lanes|t.childLanes,function(e,t,n,r,i,o){var a=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var s=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=a&~n;0<n;){var u=31-we(n),d=1<<u;s[u]=0,l[u]=-1;var h=c[u];if(null!==h)for(c[u]=null,u=0;u<h.length;u++){var f=h[u];null!==f&&(f.lane&=-536870913)}n&=~d}0!==r&&Oe(e,r,0),0!==o&&0===i&&0!==e.tag&&(e.suspendedLanes|=o&~(a&~t))}(e,n,o|=kr,s,l,c),e===mc&&(pc=mc=null,gc=0),Lc=t,Hc=e,Bc=n,zc=o,Wc=i,Vc=r,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,ie(he,function(){return xu(),null})):(e.callbackNode=null,e.callbackPriority=0),r=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||r){r=I.T,I.T=null,i=P.p,P.p=2,s=fc,fc|=4;try{!function(e,t){if(e=e.containerInfo,md=bh,ir(e=rr(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(g){n=null;break e}var s=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var m;h!==n||0!==i&&3!==h.nodeType||(l=s+i),h!==o||0!==r&&3!==h.nodeType||(c=s+r),3===h.nodeType&&(s+=h.nodeValue.length),null!==(m=h.firstChild);)f=h,h=m;for(;;){if(h===e)break t;if(f===n&&++u===i&&(l=s),f===o&&++d===r&&(c=s),null!==(m=h.nextSibling))break;f=(h=f).parentNode}h=m}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(pd={focusedElem:e,selectionRange:n},bh=!1,Ol=t;null!==Ol;)if(e=(t=Ol).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ol=e;else for(;null!==Ol;){switch(o=(t=Ol).alternate,e=t.flags,t.tag){case 0:if(0!==(4&e)&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(n=0;n<e.length;n++)(i=e[n]).ref.impl=i.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==o){e=void 0,n=t,i=o.memoizedProps,o=o.memoizedState,r=n.stateNode;try{var p=Cs(n.type,i);e=r.getSnapshotBeforeUpdate(p,o),r.__reactInternalSnapshotBeforeUpdate=e}catch(v){Cu(n,n.return,v)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))kd(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":kd(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(a(163))}if(null!==(e=t.sibling)){e.return=t.return,Ol=e;break}Ol=t.return}}(e,t)}finally{fc=s,P.p=i,I.T=r}}Fc=1,gu(),vu(),yu()}}function gu(){if(1===Fc){Fc=0;var e=Hc,t=Lc,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=I.T,I.T=null;var r=P.p;P.p=2;var i=fc;fc|=4;try{ql(t,e);var o=pd,a=rr(e.containerInfo),s=o.focusedElem,l=o.selectionRange;if(a!==s&&s&&s.ownerDocument&&nr(s.ownerDocument.documentElement,s)){if(null!==l&&ir(s)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in s)s.selectionStart=c,s.selectionEnd=Math.min(u,s.value.length);else{var d=s.ownerDocument||document,h=d&&d.defaultView||window;if(h.getSelection){var f=h.getSelection(),m=s.textContent.length,p=Math.min(l.start,m),g=void 0===l.end?p:Math.min(l.end,m);!f.extend&&p>g&&(a=g,g=p,p=a);var v=tr(s,p),y=tr(s,g);if(v&&y&&(1!==f.rangeCount||f.anchorNode!==v.node||f.anchorOffset!==v.offset||f.focusNode!==y.node||f.focusOffset!==y.offset)){var b=d.createRange();b.setStart(v.node,v.offset),f.removeAllRanges(),p>g?(f.addRange(b),f.extend(y.node,y.offset)):(b.setEnd(y.node,y.offset),f.addRange(b))}}}}for(d=[],f=s;f=f.parentNode;)1===f.nodeType&&d.push({element:f,left:f.scrollLeft,top:f.scrollTop});for("function"===typeof s.focus&&s.focus(),s=0;s<d.length;s++){var w=d[s];w.element.scrollLeft=w.left,w.element.scrollTop=w.top}}bh=!!md,pd=md=null}finally{fc=i,P.p=r,I.T=n}}e.current=t,Fc=2}}function vu(){if(2===Fc){Fc=0;var e=Hc,t=Lc,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=I.T,I.T=null;var r=P.p;P.p=2;var i=fc;fc|=4;try{Il(e,t.alternate,t)}finally{fc=i,P.p=r,I.T=n}}Fc=3}}function yu(){if(4===Fc||3===Fc){Fc=0,se();var e=Hc,t=Lc,n=Bc,r=Vc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Fc=5:(Fc=0,Lc=Hc=null,bu(e,e.pendingLanes));var i=e.pendingLanes;if(0===i&&(jc=null),Fe(n),t=t.stateNode,ye&&"function"===typeof ye.onCommitFiberRoot)try{ye.onCommitFiberRoot(ve,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==r){t=I.T,i=P.p,P.p=2,I.T=null;try{for(var o=e.onRecoverableError,a=0;a<r.length;a++){var s=r[a];o(s.value,{componentStack:s.stack})}}finally{I.T=t,P.p=i}}0!==(3&Bc)&&wu(),Pu(e),i=e.pendingLanes,0!==(261930&n)&&0!==(42&i)?e===qc?Uc++:(Uc=0,qc=e):Uc=0,ju(0,!1)}}function bu(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Bi(t)))}function wu(){return gu(),vu(),yu(),xu()}function xu(){if(5!==Fc)return!1;var e=Hc,t=zc;zc=0;var n=Fe(Bc),r=I.T,i=P.p;try{P.p=32>n?32:n,I.T=null,n=Wc,Wc=null;var o=Hc,s=Bc;if(Fc=0,Lc=Hc=null,Bc=0,0!==(6&fc))throw Error(a(331));var l=fc;if(fc|=4,lc(o.current),ec(o,o.current,s,n),fc=l,ju(0,!1),ye&&"function"===typeof ye.onPostCommitFiberRoot)try{ye.onPostCommitFiberRoot(ve,o)}catch(c){}return!0}finally{P.p=i,I.T=r,bu(e,t)}}function Su(e,t,n){t=Kr(n,t),null!==(e=wo(e,t=ks(e.stateNode,t,2),2))&&(_e(e,2),Pu(e))}function Cu(e,t,n){if(3===e.tag)Su(e,e,n);else for(;null!==t;){if(3===t.tag){Su(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===jc||!jc.has(r))){e=Kr(n,e),null!==(r=wo(t,n=Ms(2),2))&&(Ds(n,r,t,e),_e(r,2),Pu(r));break}}t=t.return}}function Eu(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hc;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(xc=!0,i.add(n),e=Nu.bind(null,e,t,n),t.then(e,e))}function Nu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,mc===e&&(gc&n)===n&&(4===Cc||3===Cc&&(62914560&gc)===gc&&300>le()-_c?0===(2&fc)&&tu(e,0):Tc|=n,Rc===gc&&(Rc=0)),Pu(e)}function Tu(e,t){0===t&&(t=Me()),null!==(e=Or(e,t))&&(_e(e,t),Pu(e))}function Au(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Tu(e,n)}function Ru(e,t){var n=0;switch(e.tag){case 31:case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(a(314))}null!==r&&r.delete(t),Tu(e,n)}var ku=null,Mu=null,Du=!1,_u=!1,Ou=!1,Iu=0;function Pu(e){e!==Mu&&null===e.next&&(null===Mu?ku=Mu=e:Mu=Mu.next=e),_u=!0,Du||(Du=!0,Ed(function(){0!==(6&fc)?ie(ue,Fu):Hu()}))}function ju(e,t){if(!Ou&&_u){Ou=!0;do{for(var n=!1,r=ku;null!==r;){if(!t)if(0!==e){var i=r.pendingLanes;if(0===i)var o=0;else{var a=r.suspendedLanes,s=r.pingedLanes;o=(1<<31-we(42|e)+1)-1,o=201326741&(o&=i&~(a&~s))?201326741&o|1:o?2|o:0}0!==o&&(n=!0,zu(r,o))}else o=gc,0===(3&(o=Ae(r,r===mc?o:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||Re(r,o)||(n=!0,zu(r,o));r=r.next}}while(n);Ou=!1}}function Fu(){Hu()}function Hu(){_u=Du=!1;var e=0;0!==Iu&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==wd&&(wd=e,!0);return wd=null,!1}()&&(e=Iu);for(var t=le(),n=null,r=ku;null!==r;){var i=r.next,o=Lu(r,t);0===o?(r.next=null,null===n?ku=i:n.next=i,null===i&&(Mu=n)):(n=r,(0!==e||0!==(3&o))&&(_u=!0)),r=i}0!==Fc&&5!==Fc||ju(e,!1),0!==Iu&&(Iu=0)}function Lu(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=-62914561&e.pendingLanes;0<o;){var a=31-we(o),s=1<<a,l=i[a];-1===l?0!==(s&n)&&0===(s&r)||(i[a]=ke(s,t)):l<=t&&(e.expiredLanes|=s),o&=~s}if(n=gc,n=Ae(e,e===(t=mc)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===vc||9===vc)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&oe(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||Re(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&oe(r),Fe(n)){case 2:case 8:n=de;break;case 32:default:n=he;break;case 268435456:n=me}return r=Bu.bind(null,e),n=ie(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&oe(r),e.callbackPriority=2,e.callbackNode=null,2}function Bu(e,t){if(0!==Fc&&5!==Fc)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(wu()&&e.callbackNode!==n)return null;var r=gc;return 0===(r=Ae(e,e===mc?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:($c(e,r,t),Lu(e,le()),null!=e.callbackNode&&e.callbackNode===n?Bu.bind(null,e):null)}function zu(e,t){if(wu())return null;$c(e,t,!0)}function Wu(){if(0===Iu){var e=Vi;0===e&&(e=Ce,0===(261888&(Ce<<=1))&&(Ce=256)),Iu=e}return Iu}function Vu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Dt(""+e)}function Uu(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var qu=0;qu<Er.length;qu++){var Gu=Er[qu];Nr(Gu.toLowerCase(),"on"+(Gu[0].toUpperCase()+Gu.slice(1)))}Nr(gr,"onAnimationEnd"),Nr(vr,"onAnimationIteration"),Nr(yr,"onAnimationStart"),Nr("dblclick","onDoubleClick"),Nr("focusin","onFocus"),Nr("focusout","onBlur"),Nr(br,"onTransitionRun"),Nr(wr,"onTransitionStart"),Nr(xr,"onTransitionCancel"),Nr(Sr,"onTransitionEnd"),it("onMouseEnter",["mouseout","mouseover"]),it("onMouseLeave",["mouseout","mouseover"]),it("onPointerEnter",["pointerout","pointerover"]),it("onPointerLeave",["pointerout","pointerover"]),rt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),rt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),rt("onBeforeInput",["compositionend","keypress","textInput","paste"]),rt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ku=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Yu));function $u(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==o&&i.isPropagationStopped())break e;o=s,i.currentTarget=c;try{o(i)}catch(u){Tr(u)}i.currentTarget=null,o=l}else for(a=0;a<r.length;a++){if(l=(s=r[a]).instance,c=s.currentTarget,s=s.listener,l!==o&&i.isPropagationStopped())break e;o=s,i.currentTarget=c;try{o(i)}catch(u){Tr(u)}i.currentTarget=null,o=l}}}}function Xu(e,t){var n=t[Ue];void 0===n&&(n=t[Ue]=new Set);var r=e+"__bubble";n.has(r)||(ed(t,e,2,!1),n.add(r))}function Qu(e,t,n){var r=0;t&&(r|=4),ed(n,e,r,t)}var Ju="_reactListening"+Math.random().toString(36).slice(2);function Zu(e){if(!e[Ju]){e[Ju]=!0,tt.forEach(function(t){"selectionchange"!==t&&(Ku.has(t)||Qu(t,!1,e),Qu(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ju]||(t[Ju]=!0,Qu("selectionchange",!1,t))}}function ed(e,t,n,r){switch(Th(t)){case 2:var i=wh;break;case 8:i=xh;break;default:i=Sh}n=i.bind(null,t,n,e),i=void 0,!Wt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function td(e,t,n,r,i){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===i)break;if(4===a)for(a=r.return;null!==a;){var c=a.tag;if((3===c||4===c)&&a.stateNode.containerInfo===i)return;a=a.return}for(;null!==s;){if(null===(a=Xe(s)))return;if(5===(c=a.tag)||6===c||26===c||27===c){r=o=a;continue e}s=s.parentNode}}r=r.return}Lt(function(){var r=o,i=It(n),a=[];e:{var s=Cr.get(e);if(void 0!==s){var c=nn,u=e;switch(e){case"keypress":if(0===Kt(n))break e;case"keydown":case"keyup":c=yn;break;case"focusin":u="focus",c=cn;break;case"focusout":u="blur",c=cn;break;case"beforeblur":case"afterblur":c=cn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=sn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=ln;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=wn;break;case gr:case vr:case yr:c=un;break;case Sr:c=xn;break;case"scroll":case"scrollend":c=on;break;case"wheel":c=Sn;break;case"copy":case"cut":case"paste":c=dn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=bn;break;case"toggle":case"beforetoggle":c=Cn}var d=0!==(4&t),h=!d&&("scroll"===e||"scrollend"===e),f=d?null!==s?s+"Capture":null:s;d=[];for(var m,p=r;null!==p;){var g=p;if(m=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===m||null===f||null!=(g=Bt(p,f))&&d.push(nd(p,g,m)),h)break;p=p.return}0<d.length&&(s=new c(s,u,null,n,i),a.push({event:s,listeners:d}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===Ot||!(u=n.relatedTarget||n.fromElement)||!Xe(u)&&!u[Ve])&&(c||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?Xe(u):null)&&(h=l(u),d=u.tag,u!==h||5!==d&&27!==d&&6!==d)&&(u=null)):(c=null,u=r),c!==u)){if(d=sn,g="onMouseLeave",f="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(d=bn,g="onPointerLeave",f="onPointerEnter",p="pointer"),h=null==c?s:Je(c),m=null==u?s:Je(u),(s=new d(g,p+"leave",c,n,i)).target=h,s.relatedTarget=m,g=null,Xe(i)===r&&((d=new d(f,p+"enter",u,n,i)).target=m,d.relatedTarget=h,g=d),h=g,c&&u)e:{for(d=id,p=u,m=0,g=f=c;g;g=d(g))m++;g=0;for(var v=p;v;v=d(v))g++;for(;0<m-g;)f=d(f),m--;for(;0<g-m;)p=d(p),g--;for(;m--;){if(f===p||null!==p&&f===p.alternate){d=f;break e}f=d(f),p=d(p)}d=null}else d=null;null!==c&&od(a,s,c,d,!1),null!==u&&null!==h&&od(a,h,u,d,!0)}if("select"===(c=(s=r?Je(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===c&&"file"===s.type)var y=zn;else if(Pn(s))if(Wn)y=Qn;else{y=$n;var b=Kn}else!(c=s.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==s.type&&"radio"!==s.type?r&&Rt(r.elementType)&&(y=zn):y=Xn;switch(y&&(y=y(e,r))?jn(a,y,n,i):(b&&b(e,s,r),"focusout"===e&&r&&"number"===s.type&&null!=r.memoizedProps.value&&wt(s,"number",s.value)),b=r?Je(r):window,e){case"focusin":(Pn(b)||"true"===b.contentEditable)&&(ar=b,sr=r,lr=null);break;case"focusout":lr=sr=ar=null;break;case"mousedown":cr=!0;break;case"contextmenu":case"mouseup":case"dragend":cr=!1,ur(a,n,i);break;case"selectionchange":if(or)break;case"keydown":case"keyup":ur(a,n,i)}var w;if(Nn)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else On?Dn(e,n)&&(x="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(x="onCompositionStart");x&&(Rn&&"ko"!==n.locale&&(On||"onCompositionStart"!==x?"onCompositionEnd"===x&&On&&(w=Yt()):(qt="value"in(Ut=i)?Ut.value:Ut.textContent,On=!0)),0<(b=rd(r,x)).length&&(x=new hn(x,e,null,n,i),a.push({event:x,listeners:b}),w?x.data=w:null!==(w=_n(n))&&(x.data=w))),(w=An?function(e,t){switch(e){case"compositionend":return _n(t);case"keypress":return 32!==t.which?null:(Mn=!0,kn);case"textInput":return(e=t.data)===kn&&Mn?null:e;default:return null}}(e,n):function(e,t){if(On)return"compositionend"===e||!Nn&&Dn(e,t)?(e=Yt(),Gt=qt=Ut=null,On=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Rn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(x=rd(r,"onBeforeInput")).length&&(b=new hn("onBeforeInput","beforeinput",null,n,i),a.push({event:b,listeners:x}),b.data=w)),function(e,t,n,r,i){if("submit"===t&&n&&n.stateNode===i){var o=Vu((i[We]||null).action),a=r.submitter;a&&null!==(t=(t=a[We]||null)?Vu(t.formAction):a.getAttribute("formAction"))&&(o=t,a=null);var s=new nn("action","action",null,r,i);e.push({event:s,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==Iu){var e=a?Uu(i,a):new FormData(i);ts(n,{pending:!0,data:e,method:i.method,action:o},null,e)}}else"function"===typeof o&&(s.preventDefault(),e=a?Uu(i,a):new FormData(i),ts(n,{pending:!0,data:e,method:i.method,action:o},o,e))},currentTarget:i}]})}}(a,e,r,n,i)}$u(a,t)})}function nd(e,t,n){return{instance:e,listener:t,currentTarget:n}}function rd(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;if(5!==(i=i.tag)&&26!==i&&27!==i||null===o||(null!=(i=Bt(e,n))&&r.unshift(nd(e,i,o)),null!=(i=Bt(e,t))&&r.push(nd(e,i,o))),3===e.tag)return r;e=e.return}return[]}function id(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function od(e,t,n,r,i){for(var o=t._reactName,a=[];null!==n&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(s=s.tag,null!==l&&l===r)break;5!==s&&26!==s&&27!==s||null===c||(l=c,i?null!=(c=Bt(n,o))&&a.unshift(nd(n,c,l)):i||null!=(c=Bt(n,o))&&a.push(nd(n,c,l))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var ad=/\r\n?/g,sd=/\u0000|\uFFFD/g;function ld(e){return("string"===typeof e?e:""+e).replace(ad,"\n").replace(sd,"")}function cd(e,t){return t=ld(t),ld(e)===t}function ud(e,t,n,r,i,o){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||Et(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&Et(e,""+r);break;case"className":ct(e,"class",r);break;case"tabIndex":ct(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":ct(e,n,r);break;case"style":At(e,r,o);break;case"data":if("object"!==t){ct(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Dt(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof o&&("formAction"===n?("input"!==t&&ud(e,t,"name",i.name,i,null),ud(e,t,"formEncType",i.formEncType,i,null),ud(e,t,"formMethod",i.formMethod,i,null),ud(e,t,"formTarget",i.formTarget,i,null)):(ud(e,t,"encType",i.encType,i,null),ud(e,t,"method",i.method,i,null),ud(e,t,"target",i.target,i,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Dt(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=_t);break;case"onScroll":null!=r&&Xu("scroll",e);break;case"onScrollEnd":null!=r&&Xu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(a(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(a(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=Dt(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Xu("beforetoggle",e),Xu("toggle",e),lt(e,"popover",r);break;case"xlinkActuate":ut(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":ut(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":ut(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":ut(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":ut(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":ut(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":ut(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":ut(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":ut(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":lt(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&lt(e,n=kt.get(n)||n,r)}}function dd(e,t,n,r,i,o){switch(n){case"style":At(e,r,o);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(a(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(a(60));e.innerHTML=n}}break;case"children":"string"===typeof r?Et(e,r):("number"===typeof r||"bigint"===typeof r)&&Et(e,""+r);break;case"onScroll":null!=r&&Xu("scroll",e);break;case"onScrollEnd":null!=r&&Xu("scrollend",e);break;case"onClick":null!=r&&(e.onclick=_t);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:nt.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(i=n.endsWith("Capture"),t=n.slice(2,i?n.length-7:void 0),"function"===typeof(o=null!=(o=e[We]||null)?o[n]:null)&&e.removeEventListener(t,o,i),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):lt(e,n,r):("function"!==typeof o&&null!==o&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,i)))}}function hd(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Xu("error",e),Xu("load",e);var r,i=!1,o=!1;for(r in n)if(n.hasOwnProperty(r)){var s=n[r];if(null!=s)switch(r){case"src":i=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:ud(e,t,r,s,n,null)}}return o&&ud(e,t,"srcSet",n.srcSet,n,null),void(i&&ud(e,t,"src",n.src,n,null));case"input":Xu("invalid",e);var l=r=s=o=null,c=null,u=null;for(i in n)if(n.hasOwnProperty(i)){var d=n[i];if(null!=d)switch(i){case"name":o=d;break;case"type":s=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":r=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(a(137,t));break;default:ud(e,t,i,d,n,null)}}return void bt(e,r,l,c,u,s,o,!1);case"select":for(o in Xu("invalid",e),i=s=r=null,n)if(n.hasOwnProperty(o)&&null!=(l=n[o]))switch(o){case"value":r=l;break;case"defaultValue":s=l;break;case"multiple":i=l;default:ud(e,t,o,l,n,null)}return t=r,n=s,e.multiple=!!i,void(null!=t?xt(e,!!i,t,!1):null!=n&&xt(e,!!i,n,!0));case"textarea":for(s in Xu("invalid",e),r=o=i=null,n)if(n.hasOwnProperty(s)&&null!=(l=n[s]))switch(s){case"value":i=l;break;case"defaultValue":o=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(a(91));break;default:ud(e,t,s,l,n,null)}return void Ct(e,i,o,r);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(i=n[c]))if("selected"===c)e.selected=i&&"function"!==typeof i&&"symbol"!==typeof i;else ud(e,t,c,i,n,null);return;case"dialog":Xu("beforetoggle",e),Xu("toggle",e),Xu("cancel",e),Xu("close",e);break;case"iframe":case"object":Xu("load",e);break;case"video":case"audio":for(i=0;i<Yu.length;i++)Xu(Yu[i],e);break;case"image":Xu("error",e),Xu("load",e);break;case"details":Xu("toggle",e);break;case"embed":case"source":case"link":Xu("error",e),Xu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(i=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:ud(e,t,u,i,n,null)}return;default:if(Rt(t)){for(d in n)n.hasOwnProperty(d)&&(void 0!==(i=n[d])&&dd(e,t,d,i,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(i=n[l])&&ud(e,t,l,i,n,null))}function fd(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var md=null,pd=null;function gd(e){return 9===e.nodeType?e:e.ownerDocument}function vd(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function yd(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function bd(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var wd=null;var xd="function"===typeof setTimeout?setTimeout:void 0,Sd="function"===typeof clearTimeout?clearTimeout:void 0,Cd="function"===typeof Promise?Promise:void 0,Ed="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof Cd?function(e){return Cd.resolve(null).then(e).catch(Nd)}:xd;function Nd(e){setTimeout(function(){throw e})}function Td(e){return"head"===e}function Ad(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)||"/&"===n){if(0===r)return e.removeChild(i),void Uh(t);r--}else if("$"===n||"$?"===n||"$~"===n||"$!"===n||"&"===n)r++;else if("html"===n)Hd(e.ownerDocument.documentElement);else if("head"===n){Hd(n=e.ownerDocument.head);for(var o=n.firstChild;o;){var a=o.nextSibling,s=o.nodeName;o[Ke]||"SCRIPT"===s||"STYLE"===s||"LINK"===s&&"stylesheet"===o.rel.toLowerCase()||n.removeChild(o),o=a}}else"body"===n&&Hd(e.ownerDocument.body);n=i}while(n);Uh(t)}function Rd(e,t){var n=e;e=0;do{var r=n.nextSibling;if(1===n.nodeType?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",""===n.getAttribute("style")&&n.removeAttribute("style")):3===n.nodeType&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===e)break;e--}else"$"!==n&&"$?"!==n&&"$~"!==n&&"$!"!==n||e++;n=r}while(n)}function kd(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":kd(n),$e(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function Md(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Od(e.nextSibling)))return null}return e}function Dd(e){return"$?"===e.data||"$~"===e.data}function _d(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Od(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Id=null;function Pd(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n||"/&"===n){if(0===t)return Od(e.nextSibling);t--}else"$"!==n&&"$!"!==n&&"$?"!==n&&"$~"!==n&&"&"!==n||t++}e=e.nextSibling}return null}function jd(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n||"$~"===n||"&"===n){if(0===t)return e;t--}else"/$"!==n&&"/&"!==n||t++}e=e.previousSibling}return null}function Fd(e,t,n){switch(t=gd(n),e){case"html":if(!(e=t.documentElement))throw Error(a(452));return e;case"head":if(!(e=t.head))throw Error(a(453));return e;case"body":if(!(e=t.body))throw Error(a(454));return e;default:throw Error(a(451))}}function Hd(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);$e(e)}var Ld=new Map,Bd=new Set;function zd(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Wd=P.d;P.d={f:function(){var e=Wd.f(),t=Zc();return e||t},r:function(e){var t=Qe(e);null!==t&&5===t.tag&&"form"===t.type?rs(t):Wd.r(e)},D:function(e){Wd.D(e),Ud("dns-prefetch",e,null)},C:function(e,t){Wd.C(e,t),Ud("preconnect",e,t)},L:function(e,t,n){Wd.L(e,t,n);var r=Vd;if(r&&e&&t){var i='link[rel="preload"][as="'+vt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(i+='[imagesrcset="'+vt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(i+='[imagesizes="'+vt(n.imageSizes)+'"]')):i+='[href="'+vt(e)+'"]';var o=i;switch(t){case"style":o=Gd(e);break;case"script":o=$d(e)}Ld.has(o)||(e=f({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Ld.set(o,e),null!==r.querySelector(i)||"style"===t&&r.querySelector(Yd(o))||"script"===t&&r.querySelector(Xd(o))||(hd(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)))}},m:function(e,t){Wd.m(e,t);var n=Vd;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",i='link[rel="modulepreload"][as="'+vt(r)+'"][href="'+vt(e)+'"]',o=i;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":o=$d(e)}if(!Ld.has(o)&&(e=f({rel:"modulepreload",href:e},t),Ld.set(o,e),null===n.querySelector(i))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Xd(o)))return}hd(r=n.createElement("link"),"link",e),et(r),n.head.appendChild(r)}}},X:function(e,t){Wd.X(e,t);var n=Vd;if(n&&e){var r=Ze(n).hoistableScripts,i=$d(e),o=r.get(i);o||((o=n.querySelector(Xd(i)))||(e=f({src:e,async:!0},t),(t=Ld.get(i))&&eh(e,t),et(o=n.createElement("script")),hd(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},r.set(i,o))}},S:function(e,t,n){Wd.S(e,t,n);var r=Vd;if(r&&e){var i=Ze(r).hoistableStyles,o=Gd(e);t=t||"default";var a=i.get(o);if(!a){var s={loading:0,preload:null};if(a=r.querySelector(Yd(o)))s.loading=5;else{e=f({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Ld.get(o))&&Zd(e,n);var l=a=r.createElement("link");et(l),hd(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){s.loading|=1}),l.addEventListener("error",function(){s.loading|=2}),s.loading|=4,Jd(a,t,r)}a={type:"stylesheet",instance:a,count:1,state:s},i.set(o,a)}}},M:function(e,t){Wd.M(e,t);var n=Vd;if(n&&e){var r=Ze(n).hoistableScripts,i=$d(e),o=r.get(i);o||((o=n.querySelector(Xd(i)))||(e=f({src:e,async:!0,type:"module"},t),(t=Ld.get(i))&&eh(e,t),et(o=n.createElement("script")),hd(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},r.set(i,o))}}};var Vd="undefined"===typeof document?null:document;function Ud(e,t,n){var r=Vd;if(r&&"string"===typeof t&&t){var i=vt(t);i='link[rel="'+e+'"][href="'+i+'"]',"string"===typeof n&&(i+='[crossorigin="'+n+'"]'),Bd.has(i)||(Bd.add(i),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(i)&&(hd(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)))}}function qd(e,t,n,r){var i,o,s,l,c=(c=G.current)?zd(c):null;if(!c)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=Gd(n.href),(r=(n=Ze(c).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=Gd(n.href);var u=Ze(c).hoistableStyles,d=u.get(e);if(d||(c=c.ownerDocument||c,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,d),(u=c.querySelector(Yd(e)))&&!u._p&&(d.instance=u,d.state.loading=5),Ld.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Ld.set(e,n),u||(i=c,o=e,s=n,l=d.state,i.querySelector('link[rel="preload"][as="style"]['+o+"]")?l.loading=1:(o=i.createElement("link"),l.preload=o,o.addEventListener("load",function(){return l.loading|=1}),o.addEventListener("error",function(){return l.loading|=2}),hd(o,"link",s),et(o),i.head.appendChild(o))))),t&&null===r)throw Error(a(528,""));return d}if(t&&null!==r)throw Error(a(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=$d(n),(r=(n=Ze(c).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function Gd(e){return'href="'+vt(e)+'"'}function Yd(e){return'link[rel="stylesheet"]['+e+"]"}function Kd(e){return f({},e,{"data-precedence":e.precedence,precedence:null})}function $d(e){return'[src="'+vt(e)+'"]'}function Xd(e){return"script[async]"+e}function Qd(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+vt(n.href)+'"]');if(r)return t.instance=r,et(r),r;var i=f({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return et(r=(e.ownerDocument||e).createElement("style")),hd(r,"style",i),Jd(r,n.precedence,e),t.instance=r;case"stylesheet":i=Gd(n.href);var o=e.querySelector(Yd(i));if(o)return t.state.loading|=4,t.instance=o,et(o),o;r=Kd(n),(i=Ld.get(i))&&Zd(r,i),et(o=(e.ownerDocument||e).createElement("link"));var s=o;return s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),hd(o,"link",r),t.state.loading|=4,Jd(o,n.precedence,e),t.instance=o;case"script":return o=$d(n.src),(i=e.querySelector(Xd(o)))?(t.instance=i,et(i),i):(r=n,(i=Ld.get(o))&&eh(r=f({},n),i),et(i=(e=e.ownerDocument||e).createElement("script")),hd(i,"link",r),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(a(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Jd(r,n.precedence,e));return t.instance}function Jd(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=r.length?r[r.length-1]:null,o=i,a=0;a<r.length;a++){var s=r[a];if(s.dataset.precedence===t)o=s;else if(o!==i)break}o?o.parentNode.insertBefore(e,o.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Zd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function eh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var th=null;function nh(e,t,n){if(null===th){var r=new Map,i=th=new Map;i.set(n,r)}else(r=(i=th).get(n))||(r=new Map,i.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),i=0;i<n.length;i++){var o=n[i];if(!(o[Ke]||o[ze]||"link"===e&&"stylesheet"===o.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==o.namespaceURI){var a=o.getAttribute(t)||"";a=e+a;var s=r.get(a);s?s.push(o):r.set(a,[o])}}return r}function rh(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function ih(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var oh=0;function ah(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)lh(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var sh=null;function lh(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,sh=new Map,t.forEach(ch,e),sh=null,ah.call(e))}function ch(e,t){if(!(4&t.state.loading)){var n=sh.get(e);if(n)var r=n.get(null);else{n=new Map,sh.set(e,n);for(var i=e.querySelectorAll("link[data-precedence],style[data-precedence]"),o=0;o<i.length;o++){var a=i[o];"LINK"!==a.nodeName&&"not all"===a.getAttribute("media")||(n.set(a.dataset.precedence,a),r=a)}r&&n.set(null,r)}a=(i=t.instance).getAttribute("data-precedence"),(o=n.get(a)||r)===r&&n.set(null,i),n.set(a,i),this.count++,r=ah.bind(this),i.addEventListener("load",r),i.addEventListener("error",r),o?o.parentNode.insertBefore(i,o.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(i,e.firstChild),t.state.loading|=4}}var uh={$$typeof:x,Provider:null,Consumer:null,_currentValue:j,_currentValue2:j,_threadCount:0};function dh(e,t,n,r,i,o,a,s,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=De(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=De(0),this.hiddenUpdates=De(null),this.identifierPrefix=r,this.onUncaughtError=i,this.onCaughtError=o,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function hh(e,t,n,r,i,o,a,s,l,c,u,d){return e=new dh(e,t,n,a,l,c,u,d,s),t=1,!0===o&&(t|=24),o=Hr(3,null,null,t),e.current=o,o.stateNode=e,(t=Li()).refCount++,e.pooledCache=t,t.refCount++,o.memoizedState={element:r,isDehydrated:n,cache:t},vo(o),e}function fh(e){return e?e=jr:jr}function mh(e,t,n,r,i,o){i=fh(i),null===r.context?r.context=i:r.pendingContext=i,(r=bo(t)).payload={element:n},null!==(o=void 0===o?null:o)&&(r.callback=o),null!==(n=wo(e,r,t))&&(Kc(n,0,t),xo(n,e,t))}function ph(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function gh(e,t){ph(e,t),(e=e.alternate)&&ph(e,t)}function vh(e){if(13===e.tag||31===e.tag){var t=Or(e,67108864);null!==t&&Kc(t,0,67108864),gh(e,67108864)}}function yh(e){if(13===e.tag||31===e.tag){var t=Gc(),n=Or(e,t=je(t));null!==n&&Kc(n,0,t),gh(e,t)}}var bh=!0;function wh(e,t,n,r){var i=I.T;I.T=null;var o=P.p;try{P.p=2,Sh(e,t,n,r)}finally{P.p=o,I.T=i}}function xh(e,t,n,r){var i=I.T;I.T=null;var o=P.p;try{P.p=8,Sh(e,t,n,r)}finally{P.p=o,I.T=i}}function Sh(e,t,n,r){if(bh){var i=Ch(r);if(null===i)td(e,t,r,Eh,n),Ph(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Rh=jh(Rh,e,t,n,r,i),!0;case"dragenter":return kh=jh(kh,e,t,n,r,i),!0;case"mouseover":return Mh=jh(Mh,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Dh.set(o,jh(Dh.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,_h.set(o,jh(_h.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Ph(e,r),4&t&&-1<Ih.indexOf(e)){for(;null!==i;){var o=Qe(i);if(null!==o)switch(o.tag){case 3:if((o=o.stateNode).current.memoizedState.isDehydrated){var a=Te(o.pendingLanes);if(0!==a){var s=o;for(s.pendingLanes|=2,s.entangledLanes|=2;a;){var l=1<<31-we(a);s.entanglements[1]|=l,a&=~l}Pu(o),0===(6&fc)&&(Ic=le()+500,ju(0,!1))}}break;case 31:case 13:null!==(s=Or(o,2))&&Kc(s,0,2),Zc(),gh(o,2)}if(null===(o=Ch(r))&&td(e,t,r,Eh,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else td(e,t,r,null,n)}}function Ch(e){return Nh(e=It(e))}var Eh=null;function Nh(e){if(Eh=null,null!==(e=Xe(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(31===n){if(null!==(e=u(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Eh=e,null}function Th(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case ue:return 2;case de:return 8;case he:case fe:return 32;case me:return 268435456;default:return 32}default:return 32}}var Ah=!1,Rh=null,kh=null,Mh=null,Dh=new Map,_h=new Map,Oh=[],Ih="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ph(e,t){switch(e){case"focusin":case"focusout":Rh=null;break;case"dragenter":case"dragleave":kh=null;break;case"mouseover":case"mouseout":Mh=null;break;case"pointerover":case"pointerout":Dh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":_h.delete(t.pointerId)}}function jh(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=Qe(t))&&vh(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Fh(e){var t=Xe(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void Le(e.priority,function(){yh(n)})}else if(31===t){if(null!==(t=u(n)))return e.blockedOn=t,void Le(e.priority,function(){yh(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Hh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Ch(e.nativeEvent);if(null!==n)return null!==(t=Qe(n))&&vh(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Ot=r,n.target.dispatchEvent(r),Ot=null,t.shift()}return!0}function Lh(e,t,n){Hh(e)&&n.delete(t)}function Bh(){Ah=!1,null!==Rh&&Hh(Rh)&&(Rh=null),null!==kh&&Hh(kh)&&(kh=null),null!==Mh&&Hh(Mh)&&(Mh=null),Dh.forEach(Lh),_h.forEach(Lh)}function zh(e,t){e.blockedOn===t&&(e.blockedOn=null,Ah||(Ah=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Bh)))}var Wh=null;function Vh(e){Wh!==e&&(Wh=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Wh===e&&(Wh=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],i=e[t+2];if("function"!==typeof r){if(null===Nh(r||n))continue;break}var o=Qe(n);null!==o&&(e.splice(t,3),t-=3,ts(o,{pending:!0,data:i,method:n.method,action:r},r,i))}}))}function Uh(e){function t(t){return zh(t,e)}null!==Rh&&zh(Rh,e),null!==kh&&zh(kh,e),null!==Mh&&zh(Mh,e),Dh.forEach(t),_h.forEach(t);for(var n=0;n<Oh.length;n++){var r=Oh[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<Oh.length&&null===(n=Oh[0]).blockedOn;)Fh(n),null===n.blockedOn&&Oh.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var i=n[r],o=n[r+1],a=i[We]||null;if("function"===typeof o)a||Vh(n);else if(a){var s=null;if(o&&o.hasAttribute("formAction")){if(i=o,a=o[We]||null)s=a.formAction;else if(null!==Nh(i))continue}else s=a.action;"function"===typeof s?n[r+1]=s:(n.splice(r,3),r-=3),Vh(n)}}}function qh(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return i=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==i&&(i(),i=null),r||setTimeout(n,20)}function n(){if(!r&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"===typeof navigation){var r=!1,i=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){r=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==i&&(i(),i=null)}}}function Gh(e){this._internalRoot=e}function Yh(e){this._internalRoot=e}Yh.prototype.render=Gh.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));mh(t.current,Gc(),e,t,null,null)},Yh.prototype.unmount=Gh.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;mh(e.current,2,null,e,null,null),Zc(),t[Ve]=null}},Yh.prototype.unstable_scheduleHydration=function(e){if(e){var t=He();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Oh.length&&0!==t&&t<Oh[n].priority;n++);Oh.splice(n,0,e),0===n&&Fh(e)}};var Kh=i.version;if("19.2.0"!==Kh)throw Error(a(527,Kh,"19.2.0"));P.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return d(i),e;if(o===r)return d(i),t;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,c=i.child;c;){if(c===n){s=!0,n=i,r=o;break}if(c===r){s=!0,r=i,n=o;break}c=c.sibling}if(!s){for(c=o.child;c;){if(c===n){s=!0,n=o,r=i;break}if(c===r){s=!0,r=o,n=i;break}c=c.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?h(e):null)?null:e.stateNode};var $h={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:I,reconcilerVersion:"19.2.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Xh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xh.isDisabled&&Xh.supportsFiber)try{ve=Xh.inject($h),ye=Xh}catch(Jh){}}t.createRoot=function(e,t){if(!s(e))throw Error(a(299));var n=!1,r="",i=Es,o=Ns,l=Ts;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(i=t.onUncaughtError),void 0!==t.onCaughtError&&(o=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError)),t=hh(e,1,!1,null,0,n,r,null,i,o,l,qh),e[Ve]=t.current,Zu(e),new Gh(t)},t.hydrateRoot=function(e,t,n){if(!s(e))throw Error(a(299));var r=!1,i="",o=Es,l=Ns,c=Ts,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onUncaughtError&&(o=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.formState&&(u=n.formState)),(t=hh(e,1,!0,t,0,r,i,u,o,l,c,qh)).context=fh(null),n=t.current,(i=bo(r=je(r=Gc()))).callback=null,wo(n,i,r),n=r,t.current.lanes=n,_e(t,n),Pu(t),e[Ve]=t.current,Zu(e),new Yh(t)},t.version="19.2.0"},7066:function(e,t,n){var r;!function(e,i){function o(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function a(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function s(e,t){var n=new o(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,i))||(i.exports=r):this.xor128=s}(0,e=n.nmd(e),n.amdD)},7151:(e,t,n)=>{"use strict";var r=n(1239),i=n(3192);e.exports=function(e,t){var n=e[t];return i(n)?void 0:r(n)}},7192:(e,t,n)=>{"use strict";var r=n(4823),i=n(498),o=n(5687),a=function(e){return i.slice(0,e.length)===e};e.exports=a("Bun/")?"BUN":a("Cloudflare-Workers")?"CLOUDFLARE":a("Deno/")?"DENO":a("Node.js/")?"NODE":r.Bun&&"string"==typeof Bun.version?"BUN":r.Deno&&"object"==typeof Deno.version?"DENO":"process"===o(r.process)?"NODE":r.window&&r.document?"BROWSER":"REST"},7251:(e,t,n)=>{"use strict";var r=n(4061),i=n(4291).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},7359:function(e,t,n){var r;!function(e,i){function o(e){var t=this,n=function(){var e=4022871197,t=function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)};return t}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function a(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function s(e,t){var n=new o(e),r=t&&t.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,r&&("object"==typeof r&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,i))||(i.exports=r):this.alea=s}(0,e=n.nmd(e),n.amdD)},7592:e=>{"use strict";e.exports=!1},7707:(e,t,n)=>{"use strict";var r=n(5897),i=Function.prototype,o=i.call,a=r&&i.bind.bind(o,o);e.exports=r?a:function(e){return function(){return o.apply(e,arguments)}}},7899:(e,t,n)=>{"use strict";var r=n(7707),i=0,o=Math.random(),a=r(1.1.toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++i+o,36)}},7950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(6672)},7970:(e,t,n)=>{"use strict";var r=n(3542),i=n(4706),o=n(6864),a=n(4111),s=Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return i(t)&&o(t.prototype,s(e))}},7972:(e,t,n)=>{"use strict";var r=n(1415),i=n(4706),o=n(5687),a=n(4352)("toStringTag"),s=Object,l="Arguments"===o(function(){return arguments}());e.exports=r?o:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(n){}}(t=s(e),a))?n:l?o(t):"Object"===(r=o(t))&&i(t.callee)?"Arguments":r}},8084:e=>{"use strict";e.exports=function(e){try{return!!e()}catch(t){return!0}}},8097:(e,t,n)=>{"use strict";var r=n(5687),i=n(7707);e.exports=function(e){if("Function"===r(e))return i(e)}},8233:(e,t,n)=>{"use strict";e.exports=n(4382)},8249:(e,t,n)=>{"use strict";var r=n(466),i=Math.min;e.exports=function(e){var t=r(e);return t>0?i(t,9007199254740991):0}},8612:(e,t,n)=>{"use strict";var r=n(9519),i=n(253),o=n(3572),a=n(1608),s=n(6774),l=n(1523);t.f=r&&!i?Object.defineProperties:function(e,t){a(e);for(var n,r=s(t),i=l(t),c=i.length,u=0;c>u;)o.f(e,n=i[u++],r[n]);return e}},8776:(e,t,n)=>{"use strict";var r=n(6715),i=n(1183),o=n(4639);r({target:"Object",stat:!0},{fromEntries:function(e){var t={};return i(e,function(e,n){o(t,e,n)},{AS_ENTRIES:!0}),t}})},8853:(e,t,n)=>{"use strict";e.exports=n(5896)},8973:(e,t,n)=>{"use strict";var r=n(498);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},9016:function(e,t,n){var r;!function(e,i){function o(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function a(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function s(e,t){var n=new o(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,i))||(i.exports=r):this.xorwow=s}(0,e=n.nmd(e),n.amdD)},9055:(e,t,n)=>{"use strict";var r=n(8097),i=n(1239),o=n(5897),a=r(r.bind);e.exports=function(e,t){return i(e),void 0===t?e:o?a(e,t):function(){return e.apply(t,arguments)}}},9140:(e,t,n)=>{"use strict";var r=n(4850),i=n(6821),o=n(7970),a=n(7151),s=n(2509),l=n(4352),c=TypeError,u=l("toPrimitive");e.exports=function(e,t){if(!i(e)||o(e))return e;var n,l=a(e,u);if(l){if(void 0===t&&(t="default"),n=r(l,e,t),!i(n)||o(n))return n;throw new c("Can't convert object to primitive value")}return void 0===t&&(t="number"),s(e,t)}},9266:(e,t,n)=>{"use strict";var r=n(9519),i=n(3572),o=n(6369);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},9279:(e,t,n)=>{"use strict";var r=n(4823),i=n(4706),o=r.WeakMap;e.exports=i(o)&&/native code/.test(String(o))},9286:(e,t,n)=>{"use strict";var r=n(6715),i=n(4823),o=n(9464).set,a=n(1709),s=i.setImmediate?a(o,!1):o;r({global:!0,bind:!0,enumerable:!0,forced:i.setImmediate!==s},{setImmediate:s})},9344:e=>{"use strict";var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?n:t)(r)}},9464:(e,t,n)=>{"use strict";var r,i,o,a,s=n(4823),l=n(6464),c=n(9055),u=n(4706),d=n(6164),h=n(8084),f=n(904),m=n(1659),p=n(2760),g=n(155),v=n(8973),y=n(4234),b=s.setImmediate,w=s.clearImmediate,x=s.process,S=s.Dispatch,C=s.Function,E=s.MessageChannel,N=s.String,T=0,A={},R="onreadystatechange";h(function(){r=s.location});var k=function(e){if(d(A,e)){var t=A[e];delete A[e],t()}},M=function(e){return function(){k(e)}},D=function(e){k(e.data)},_=function(e){s.postMessage(N(e),r.protocol+"//"+r.host)};b&&w||(b=function(e){g(arguments.length,1);var t=u(e)?e:C(e),n=m(arguments,1);return A[++T]=function(){l(t,void 0,n)},i(T),T},w=function(e){delete A[e]},y?i=function(e){x.nextTick(M(e))}:S&&S.now?i=function(e){S.now(M(e))}:E&&!v?(a=(o=new E).port2,o.port1.onmessage=D,i=c(a.postMessage,a)):s.addEventListener&&u(s.postMessage)&&!s.importScripts&&r&&"file:"!==r.protocol&&!h(_)?(i=_,s.addEventListener("message",D,!1)):i=R in p("script")?function(e){f.appendChild(p("script"))[R]=function(){f.removeChild(this),k(e)}}:function(e){setTimeout(M(e),0)}),e.exports={set:b,clear:w}},9494:(e,t,n)=>{"use strict";n(3348)("flatMap")},9519:(e,t,n)=>{"use strict";var r=n(8084);e.exports=!r(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},9538:function(e,t,n){var r;!function(e,i){function o(e){var t=this;t.next=function(){var e,n,r=t.x,i=t.i;return e=r[i],n=(e^=e>>>7)^e<<24,n^=(e=r[i+1&7])^e>>>10,n^=(e=r[i+3&7])^e>>>3,n^=(e=r[i+4&7])^e<<7,e=r[i+7&7],n^=(e^=e<<13)^e<<9,r[i]=n,t.i=i+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function a(e,t){return t.x=e.x.slice(),t.i=e.i,t}function s(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&(r.x&&a(r,n),i.state=function(){return a(n,{})}),i}i&&i.exports?i.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,i))||(i.exports=r):this.xorshift7=s}(0,e=n.nmd(e),n.amdD)},9704:(e,t,n)=>{"use strict";var r=n(9519),i=n(8084),o=n(2760);e.exports=!r&&!i(function(){return 7!==Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a})}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,r)=>(n.f[r](e,t),t),[])),n.u=e=>"static/js/"+e+".730dc28c.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="react-app:";n.l=(r,i,o,a)=>{if(e[r])e[r].push(i);else{var s,l;if(void 0!==o)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+o){s=d;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+o),s.src=r),e[r]=[i];var h=(t,n)=>{s.onerror=s.onload=null,clearTimeout(f);var i=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach(e=>e(n)),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),l&&document.head.appendChild(s)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="/SalmanWipro-directory/",(()=>{var e={792:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var o=new Promise((n,r)=>i=e[t]=[n,r]);r.push(i[2]=o);var a=n.p+n.u(t),s=new Error;n.l(a,r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var o=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,i[1](s)}},"chunk-"+t,t)}};var t=(t,r)=>{var i,o,[a,s,l]=r,c=0;if(a.some(t=>0!==e[t])){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(l)l(n)}for(t&&t(r);c<a.length;c++)o=a[c],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0},r=self.webpackChunkreact_app=self.webpackChunkreact_app||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";var e={};n.r(e),n.d(e,{arrayAvg:()=>GH,arrayEach:()=>WH,arrayFilter:()=>BH,arrayFlatten:()=>YH,arrayMap:()=>zH,arrayMax:()=>UH,arrayMin:()=>qH,arrayReduce:()=>LH,arraySum:()=>VH,arrayUnique:()=>KH,extendArray:()=>FH,getDifferenceOfArrays:()=>$H,getIntersectionOfArrays:()=>XH,getUnionOfArrays:()=>QH,pivot:()=>HH,stringToArray:()=>JH,to2dArray:()=>jH});var t={};n.r(t),n.d(t,{_injectProductInfo:()=>vL,isDefined:()=>nL,isEmpty:()=>iL,isRegExp:()=>oL,isUndefined:()=>rL,stringify:()=>tL});var r={};n.r(r),n.d(r,{equalsIgnoreCase:()=>bL,isJSON:()=>xL,isPercentValue:()=>SL,randomString:()=>wL,sanitize:()=>NL,stripTags:()=>EL,substitute:()=>CL,toUpperCaseFirst:()=>yL});var i={};n.r(i),n.d(i,{assignObjectDefaults:()=>cB,clone:()=>JL,createObjectPropListener:()=>sB,deepClone:()=>QL,deepExtend:()=>XL,deepObjectSize:()=>aB,defineGetter:()=>nB,duckSchema:()=>YL,extend:()=>$L,getProperty:()=>iB,hasOwnProperty:()=>lB,inherit:()=>KL,isObject:()=>tB,isObjectEqual:()=>eB,mixin:()=>ZL,objectEach:()=>rB,setProperty:()=>oB});var o={};n.r(o),n.d(o,{cancelAnimationFrame:()=>dB,getComparisonFunction:()=>pB,isCSR:()=>fB,isTouchSupported:()=>hB,requestAnimationFrame:()=>uB});var a={};n.r(a),n.d(a,{isChrome:()=>xB,isChromeWebKit:()=>SB,isEdge:()=>TB,isEdgeWebKit:()=>AB,isFirefox:()=>CB,isFirefoxWebKit:()=>EB,isIOS:()=>kB,isIpadOS:()=>MB,isLinuxOS:()=>OB,isMacOS:()=>_B,isMobileBrowser:()=>RB,isSafari:()=>NB,isWindowsOS:()=>DB,setBrowserMeta:()=>bB,setPlatformMeta:()=>wB});var s={};n.r(s),n.d(s,{HTML_CHARACTERS:()=>ez,addClass:()=>KB,addEvent:()=>wz,clearTextSelection:()=>Nz,closest:()=>LB,closestDown:()=>BB,empty:()=>ZB,fastInnerHTML:()=>tz,fastInnerText:()=>nz,findFirstParentWithClass:()=>zB,getCaretPosition:()=>Sz,getCssTransform:()=>Oz,getFractionalScalingCompensation:()=>Rz,getFrameElement:()=>jB,getMaximumScrollLeft:()=>hz,getMaximumScrollTop:()=>dz,getParent:()=>IB,getParentWindow:()=>FB,getScrollLeft:()=>cz,getScrollTop:()=>lz,getScrollableElement:()=>uz,getScrollbarWidth:()=>kz,getSelectionEndPosition:()=>Cz,getSelectionText:()=>Ez,getStyle:()=>mz,getTrimmingContainer:()=>fz,getWindowScrollLeft:()=>sz,getWindowScrollTop:()=>az,hasAccessToParentWindow:()=>HB,hasClass:()=>YB,hasHorizontalScrollbar:()=>Dz,hasVerticalScrollbar:()=>Mz,hasZeroHeight:()=>iz,index:()=>VB,innerHeight:()=>yz,innerWidth:()=>bz,isChildOf:()=>WB,isDetached:()=>Hz,isHTMLElement:()=>Vz,isInput:()=>Pz,isInternalElement:()=>PB,isOutsideInput:()=>jz,isVisible:()=>rz,makeElementContentEditableAndSelectItsContent:()=>Bz,matchesCSSRules:()=>pz,observeVisibilityChangeOnce:()=>Lz,offset:()=>oz,outerHeight:()=>vz,outerWidth:()=>gz,overlayContainsElement:()=>UB,removeAttribute:()=>QB,removeClass:()=>$B,removeContentEditableFromElementAndDeselect:()=>zz,removeEvent:()=>xz,removeTextNodes:()=>JB,resetCssTransform:()=>Iz,runWithSelectedContendEditableElement:()=>Wz,selectElementIfAllowed:()=>Fz,setAttribute:()=>XB,setCaretPosition:()=>Tz,setOverlayPosition:()=>_z});var l={};n.r(l),n.d(l,{curry:()=>Xz,curryRight:()=>Qz,debounce:()=>Yz,fastCall:()=>Jz,isFunction:()=>Uz,partial:()=>$z,pipe:()=>Kz,throttle:()=>qz,throttleAfterHits:()=>Gz});var c={};n.r(c),n.d(c,{KEY_CODES:()=>Zz,isCtrlKey:()=>rW,isCtrlMetaKey:()=>iW,isFunctionKey:()=>nW,isKey:()=>oW,isPrintableChar:()=>tW});var u={};n.r(u),n.d(u,{isImmediatePropagationStopped:()=>sW,isLeftClick:()=>cW,isRightClick:()=>lW,isTouchEvent:()=>uW,offsetRelativeTo:()=>dW,stopImmediatePropagation:()=>aW});var d={};n.r(d),n.d(d,{_dataToHTML:()=>lV,htmlToGridSettings:()=>cV,instanceToHTML:()=>sV});var h={};n.r(h),n.d(h,{clamp:()=>pV,getParsedNumber:()=>gV,isNumeric:()=>uV,isNumericLike:()=>dV,isUnsignedNumber:()=>vV,rangeEach:()=>hV,rangeEachReverse:()=>fV,valueAccordingPercent:()=>mV});var f={};n.r(f),n.d(f,{countFirstRowKeys:()=>ZY,createEmptySpreadsheetData:()=>QY,createSpreadsheetData:()=>$Y,createSpreadsheetObjectData:()=>XY,dataRowToChangesArray:()=>JY,isArrayOfArrays:()=>eK,isArrayOfObjects:()=>tK,spreadsheetColumnIndex:()=>KY,spreadsheetColumnLabel:()=>YY});var m={};n.r(m),n.d(m,{CANCEL:()=>QK,CHECKBOX_CHECKED:()=>jX,CHECKBOX_RENDERER_NAMESPACE:()=>PX,CHECKBOX_UNCHECKED:()=>FX,COMMON_NAMESPACE:()=>$K,CONTEXTMENU_ITEMS_ADD_COMMENT:()=>w$,CONTEXTMENU_ITEMS_ALIGNMENT:()=>E$,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:()=>D$,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:()=>T$,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:()=>R$,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:()=>N$,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:()=>M$,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:()=>A$,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:()=>k$,CONTEXTMENU_ITEMS_BORDERS:()=>_$,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:()=>P$,CONTEXTMENU_ITEMS_BORDERS_LEFT:()=>j$,CONTEXTMENU_ITEMS_BORDERS_RIGHT:()=>I$,CONTEXTMENU_ITEMS_BORDERS_TOP:()=>O$,CONTEXTMENU_ITEMS_CLEAR_COLUMN:()=>u$,CONTEXTMENU_ITEMS_COPY:()=>d$,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:()=>m$,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:()=>f$,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:()=>h$,CONTEXTMENU_ITEMS_CUT:()=>p$,CONTEXTMENU_ITEMS_EDIT_COMMENT:()=>x$,CONTEXTMENU_ITEMS_FREEZE_COLUMN:()=>g$,CONTEXTMENU_ITEMS_HIDE_COLUMN:()=>B$,CONTEXTMENU_ITEMS_HIDE_ROW:()=>W$,CONTEXTMENU_ITEMS_INSERT_LEFT:()=>r$,CONTEXTMENU_ITEMS_INSERT_RIGHT:()=>i$,CONTEXTMENU_ITEMS_MERGE_CELLS:()=>y$,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:()=>L$,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:()=>H$,CONTEXTMENU_ITEMS_NO_ITEMS:()=>e$,CONTEXTMENU_ITEMS_READ_ONLY:()=>c$,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:()=>C$,CONTEXTMENU_ITEMS_REDO:()=>l$,CONTEXTMENU_ITEMS_REMOVE_BORDERS:()=>F$,CONTEXTMENU_ITEMS_REMOVE_COLUMN:()=>a$,CONTEXTMENU_ITEMS_REMOVE_COMMENT:()=>S$,CONTEXTMENU_ITEMS_REMOVE_ROW:()=>o$,CONTEXTMENU_ITEMS_ROW_ABOVE:()=>t$,CONTEXTMENU_ITEMS_ROW_BELOW:()=>n$,CONTEXTMENU_ITEMS_SHOW_COLUMN:()=>z$,CONTEXTMENU_ITEMS_SHOW_ROW:()=>V$,CONTEXTMENU_ITEMS_UNDO:()=>s$,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:()=>v$,CONTEXTMENU_ITEMS_UNMERGE_CELLS:()=>b$,CONTEXT_MENU_ITEMS_NAMESPACE:()=>JK,EMPTY_DATA_STATE_BUTTONS_FILTERS_RESET:()=>qX,EMPTY_DATA_STATE_DESCRIPTION:()=>WX,EMPTY_DATA_STATE_DESCRIPTION_FILTERS:()=>UX,EMPTY_DATA_STATE_NAMESPACE:()=>BX,EMPTY_DATA_STATE_TITLE:()=>zX,EMPTY_DATA_STATE_TITLE_FILTERS:()=>VX,FILTERS_BUTTONS_CANCEL:()=>xX,FILTERS_BUTTONS_CLEAR:()=>bX,FILTERS_BUTTONS_OK:()=>wX,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:()=>SX,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:()=>EX,FILTERS_BUTTONS_PLACEHOLDER_VALUE:()=>CX,FILTERS_BUTTONS_SELECT_ALL:()=>yX,FILTERS_CONDITIONS_AFTER:()=>lX,FILTERS_CONDITIONS_BEFORE:()=>cX,FILTERS_CONDITIONS_BEGINS_WITH:()=>Q$,FILTERS_CONDITIONS_BETWEEN:()=>aX,FILTERS_CONDITIONS_BY_VALUE:()=>tX,FILTERS_CONDITIONS_CONTAINS:()=>Z$,FILTERS_CONDITIONS_EMPTY:()=>Y$,FILTERS_CONDITIONS_ENDS_WITH:()=>J$,FILTERS_CONDITIONS_EQUAL:()=>$$,FILTERS_CONDITIONS_GREATER_THAN:()=>nX,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:()=>rX,FILTERS_CONDITIONS_LESS_THAN:()=>iX,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:()=>oX,FILTERS_CONDITIONS_NAMESPACE:()=>q$,FILTERS_CONDITIONS_NONE:()=>G$,FILTERS_CONDITIONS_NOT_BETWEEN:()=>sX,FILTERS_CONDITIONS_NOT_CONTAIN:()=>eX,FILTERS_CONDITIONS_NOT_EMPTY:()=>K$,FILTERS_CONDITIONS_NOT_EQUAL:()=>X$,FILTERS_CONDITIONS_TODAY:()=>uX,FILTERS_CONDITIONS_TOMORROW:()=>dX,FILTERS_CONDITIONS_YESTERDAY:()=>hX,FILTERS_DIVS_FILTER_BY_CONDITION:()=>fX,FILTERS_DIVS_FILTER_BY_VALUE:()=>mX,FILTERS_LABELS_CONJUNCTION:()=>pX,FILTERS_LABELS_DISJUNCTION:()=>gX,FILTERS_NAMESPACE:()=>U$,FILTERS_VALUES_BLANK_CELLS:()=>vX,LOADING_NAMESPACE:()=>HX,LOADING_TITLE:()=>LX,OK:()=>XK,PAGINATION_COUNTER_SECTION:()=>kX,PAGINATION_FIRST_PAGE:()=>DX,PAGINATION_LAST_PAGE:()=>IX,PAGINATION_NAMESPACE:()=>NX,PAGINATION_NAV_SECTION:()=>MX,PAGINATION_NEXT_PAGE:()=>OX,PAGINATION_PAGE_SIZE_AUTO:()=>AX,PAGINATION_PAGE_SIZE_SECTION:()=>RX,PAGINATION_PREV_PAGE:()=>_X,PAGINATION_SECTION:()=>TX});var p={};n.r(p),n.d(p,{getNormalizedDate:()=>$4});var g=n(5043),v=n(4391);function y(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}function b(e,t){if(null==e)return{};var n,r,i=y(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function x(e){var t=function(e,t){if("object"!=w(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==w(t)?t:t+""}function S(e,t,n){return(t=x(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach(function(t){S(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const N=["sri"],T=["page"],A=["page","matches"],R=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],k=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],M=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var D="popstate";function _(){return L(function(e,t){let{pathname:n,search:r,hash:i}=e.location;return j("",{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:F(t)},null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function O(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function I(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(qb){}}}function P(e,t){return{usr:e.state,key:e.key,idx:t}}function j(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return E(E({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?H(t):t),{},{state:n,key:t&&t.key||r||Math.random().toString(36).substring(2,10)})}function F(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function H(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function L(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:i=document.defaultView,v5Compat:o=!1}=r,a=i.history,s="POP",l=null,c=u();function u(){return(a.state||{idx:null}).idx}function d(){s="POP";let e=u(),t=null==e?null:e-c;c=e,l&&l({action:s,location:f.location,delta:t})}function h(e){return B(e)}null==c&&(c=0,a.replaceState(E(E({},a.state),{},{idx:c}),""));let f={get action(){return s},get location(){return e(i,a)},listen(e){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(D,d),l=e,()=>{i.removeEventListener(D,d),l=null}},createHref:e=>t(i,e),createURL:h,encodeLocation(e){let t=h(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){s="PUSH";let r=j(f.location,e,t);n&&n(r,e),c=u()+1;let d=P(r,c),h=f.createHref(r);try{a.pushState(d,"",h)}catch(mW){if(mW instanceof DOMException&&"DataCloneError"===mW.name)throw mW;i.location.assign(h)}o&&l&&l({action:s,location:f.location,delta:1})},replace:function(e,t){s="REPLACE";let r=j(f.location,e,t);n&&n(r,e),c=u();let i=P(r,c),d=f.createHref(r);a.replaceState(i,"",d),o&&l&&l({action:s,location:f.location,delta:0})},go:e=>a.go(e)};return f}function B(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="http://localhost";"undefined"!==typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),O(n,"No window.location.(origin|href) available to create URL");let r="string"===typeof e?e:F(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}new WeakMap;function z(e,t){return W(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function W(e,t,n,r){let i=ie(("string"===typeof t?H(t):t).pathname||"/",n);if(null==i)return null;let o=V(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(o);let a=null;for(let s=0;null==a&&s<o.length;++s){let e=re(i);a=ee(o[s],e,r)}return a}function V(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=function(e,o){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i,s=arguments.length>3?arguments[3]:void 0,l={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:o,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(r)&&a)return;O(l.relativePath.startsWith(r),'Absolute route path "'.concat(l.relativePath,'" nested under path "').concat(r,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),l.relativePath=l.relativePath.slice(r.length)}let c=ce([r,l.relativePath]),u=n.concat(l);e.children&&e.children.length>0&&(O(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(c,'".')),V(e.children,t,u,c,a)),(null!=e.path||e.index)&&t.push({path:c,score:Z(c,e.index),routesMeta:u})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!==(n=e.path)&&void 0!==n&&n.includes("?"))for(let r of U(e.path))o(e,t,!0,r);else o(e,t)}),t}function U(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(0===r.length)return i?[o,""]:[o];let a=U(r.join("/")),s=[];return s.push(...a.map(e=>""===e?o:[o,e].join("/"))),i&&s.push(...a),s.map(t=>e.startsWith("/")&&""===t?"/":t)}var q=/^:[\w-]+$/,G=3,Y=2,K=1,X=10,Q=-2,J=e=>"*"===e;function Z(e,t){let n=e.split("/"),r=n.length;return n.some(J)&&(r+=Q),t&&(r+=Y),n.filter(e=>!J(e)).reduce((e,t)=>e+(q.test(t)?G:""===t?K:X),r)}function ee(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:r}=e,i={},o="/",a=[];for(let s=0;s<r.length;++s){let e=r[s],l=s===r.length-1,c="/"===o?t:t.slice(o.length)||"/",u=te({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=te({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(i,u.params),a.push({params:i,pathname:ce([o,u.pathname]),pathnameBase:ue(ce([o,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(o=ce([o,u.pathnameBase]))}return a}function te(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=ne(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let o=i[0],a=o.replace(/(.)\/+$/,"$1"),s=i.slice(1),l=r.reduce((e,t,n)=>{let{paramName:r,isOptional:i}=t;if("*"===r){let e=s[n]||"";a=o.slice(0,o.length-e.length).replace(/(.)\/+$/,"$1")}const l=s[n];return e[r]=i&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{});return{params:l,pathname:o,pathnameBase:a,pattern:e}}function ne(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];I("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(r.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),r]}function re(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(mW){return I(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(mW,").")),e}}function ie(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function oe(e,t,n,r){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(r),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function ae(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function se(e){let t=ae(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function le(e,t,n){let r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?r=H(e):(r=E({},e),O(!r.pathname||!r.pathname.includes("?"),oe("?","pathname","search",r)),O(!r.pathname||!r.pathname.includes("#"),oe("#","pathname","hash",r)),O(!r.search||!r.search.includes("#"),oe("#","search","hash",r)));let o,a=""===e||""===r.pathname,s=a?"/":r.pathname;if(null==s)o=n;else{let e=t.length-1;if(!i&&s.startsWith("..")){let t=s.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}o=e>=0?t[e]:"/"}let l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:n,search:r="",hash:i=""}="string"===typeof e?H(e):e,o=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:o,search:de(r),hash:he(i)}}(r,o),c=s&&"/"!==s&&s.endsWith("/"),u=(a||"."===s)&&n.endsWith("/");return l.pathname.endsWith("/")||!c&&!u||(l.pathname+="/"),l}var ce=e=>e.join("/").replace(/\/\/+/g,"/"),ue=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),de=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",he=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function fe(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var me=["POST","PUT","PATCH","DELETE"],pe=(new Set(me),["GET",...me]);new Set(pe),Symbol("ResetLoaderData");var ge=g.createContext(null);ge.displayName="DataRouter";var ve=g.createContext(null);ve.displayName="DataRouterState";var ye=g.createContext(!1);var be=g.createContext({isTransitioning:!1});be.displayName="ViewTransition";var we=g.createContext(new Map);we.displayName="Fetchers";var xe=g.createContext(null);xe.displayName="Await";var Se=g.createContext(null);Se.displayName="Navigation";var Ce=g.createContext(null);Ce.displayName="Location";var Ee=g.createContext({outlet:null,matches:[],isDataRoute:!1});Ee.displayName="Route";var Ne=g.createContext(null);Ne.displayName="RouteError";function Te(){return null!=g.useContext(Ce)}function Ae(){return O(Te(),"useLocation() may be used only in the context of a <Router> component."),g.useContext(Ce).location}var Re="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ke(e){g.useContext(Se).static||g.useLayoutEffect(e)}function Me(){let{isDataRoute:e}=g.useContext(Ee);return e?function(){let{router:e}=Le("useNavigate"),t=ze("useNavigate"),n=g.useRef(!1);ke(()=>{n.current=!0});let r=g.useCallback(async function(r){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};I(n.current,Re),n.current&&("number"===typeof r?e.navigate(r):await e.navigate(r,E({fromRouteId:t},i)))},[e,t]);return r}():function(){O(Te(),"useNavigate() may be used only in the context of a <Router> component.");let e=g.useContext(ge),{basename:t,navigator:n}=g.useContext(Se),{matches:r}=g.useContext(Ee),{pathname:i}=Ae(),o=JSON.stringify(se(r)),a=g.useRef(!1);ke(()=>{a.current=!0});let s=g.useCallback(function(r){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(I(a.current,Re),!a.current)return;if("number"===typeof r)return void n.go(r);let l=le(r,JSON.parse(o),i,"path"===s.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:ce([t,l.pathname])),(s.replace?n.replace:n.push)(l,s.state,s)},[t,n,o,i,e]);return s}()}g.createContext(null);function De(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:n}=g.useContext(Ee),{pathname:r}=Ae(),i=JSON.stringify(se(n));return g.useMemo(()=>le(e,JSON.parse(i),r,"path"===t),[e,i,r,t])}function _e(e,t,n,r,i){O(Te(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=g.useContext(Se),{matches:a}=g.useContext(Ee),s=a[a.length-1],l=s?s.params:{},c=s?s.pathname:"/",u=s?s.pathnameBase:"/",d=s&&s.route;{let e=d&&d.path||"";Ue(c,!d||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(c,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let h,f=Ae();if(t){var m;let e="string"===typeof t?H(t):t;O("/"===u||(null===(m=e.pathname)||void 0===m?void 0:m.startsWith(u)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(u,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),h=e}else h=f;let p=h.pathname||"/",v=p;if("/"!==u){let e=u.replace(/^\//,"").split("/");v="/"+p.replace(/^\//,"").split("/").slice(e.length).join("/")}let y=z(e,{pathname:v});I(d||null!=y,'No routes matched location "'.concat(h.pathname).concat(h.search).concat(h.hash,'" ')),I(null==y||void 0!==y[y.length-1].route.element||void 0!==y[y.length-1].route.Component||void 0!==y[y.length-1].route.lazy,'Matched leaf route at location "'.concat(h.pathname).concat(h.search).concat(h.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let b=Fe(y&&y.map(e=>Object.assign({},e,{params:Object.assign({},l,e.params),pathname:ce([u,o.encodeLocation?o.encodeLocation(e.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?u:ce([u,o.encodeLocation?o.encodeLocation(e.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathnameBase])})),a,n,r,i);return t&&b?g.createElement(Ce.Provider,{value:{location:E({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:"POP"}},b):b}function Oe(){let e=We(),t=fe(e)?"".concat(e.status," ").concat(e.statusText):e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},a=null;return console.error("Error handled by React Router default ErrorBoundary:",e),a=g.createElement(g.Fragment,null,g.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),g.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",g.createElement("code",{style:o},"ErrorBoundary")," or"," ",g.createElement("code",{style:o},"errorElement")," prop on your route.")),g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},t),n?g.createElement("pre",{style:i},n):null,a)}var Ie=g.createElement(Oe,null),Pe=class extends g.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?g.createElement(Ee.Provider,{value:this.props.routeContext},g.createElement(Ne.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function je(e){let{routeContext:t,match:n,children:r}=e,i=g.useContext(ge);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),g.createElement(Ee.Provider,{value:t},r)}function Fe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==e){if(!n)return null;if(n.errors)e=n.matches;else{if(0!==t.length||n.initialized||!(n.matches.length>0))return null;e=n.matches}}let i=e,o=null===n||void 0===n?void 0:n.errors;if(null!=o){let e=i.findIndex(e=>e.route.id&&void 0!==(null===o||void 0===o?void 0:o[e.route.id]));O(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(o).join(","))),i=i.slice(0,Math.min(i.length,e+1))}let a=!1,s=-1;if(n)for(let l=0;l<i.length;l++){let e=i[l];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(s=l),e.route.id){let{loaderData:t,errors:r}=n,o=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!r||void 0===r[e.route.id]);if(e.route.lazy||o){a=!0,i=s>=0?i.slice(0,s+1):[i[0]];break}}}return i.reduceRight((e,l,c)=>{let u,d=!1,h=null,f=null;n&&(u=o&&l.route.id?o[l.route.id]:void 0,h=l.route.errorElement||Ie,a&&(s<0&&0===c?(Ue("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,f=null):s===c&&(d=!0,f=l.route.hydrateFallbackElement||null)));let m=t.concat(i.slice(0,c+1)),p=()=>{let t;return t=u?h:d?f:l.route.Component?g.createElement(l.route.Component,null):l.route.element?l.route.element:e,g.createElement(je,{match:l,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(l.route.ErrorBoundary||l.route.errorElement||0===c)?g.createElement(Pe,{location:n.location,revalidation:n.revalidation,component:h,error:u,children:p(),routeContext:{outlet:null,matches:m,isDataRoute:!0},unstable_onError:r}):p()},null)}function He(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function Le(e){let t=g.useContext(ge);return O(t,He(e)),t}function Be(e){let t=g.useContext(ve);return O(t,He(e)),t}function ze(e){let t=function(e){let t=g.useContext(Ee);return O(t,He(e)),t}(e),n=t.matches[t.matches.length-1];return O(n.route.id,"".concat(e,' can only be used on routes that contain a unique "id"')),n.route.id}function We(){var e;let t=g.useContext(Ne),n=Be("useRouteError"),r=ze("useRouteError");return void 0!==t?t:null===(e=n.errors)||void 0===e?void 0:e[r]}var Ve={};function Ue(e,t,n){t||Ve[e]||(Ve[e]=!0,I(!1,n))}var qe={};function Ge(e,t){e||qe[t]||(qe[t]=!0,console.warn(t))}g.memo(function(e){let{routes:t,future:n,state:r,unstable_onError:i}=e;return _e(t,void 0,r,i,n)});function Ye(e){O(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Ke(e){let{basename:t="/",children:n=null,location:r,navigationType:i="POP",navigator:o,static:a=!1}=e;O(!Te(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let s=t.replace(/^\/*/,"/"),l=g.useMemo(()=>({basename:s,navigator:o,static:a,future:{}}),[s,o,a]);"string"===typeof r&&(r=H(r));let{pathname:c="/",search:u="",hash:d="",state:h=null,key:f="default"}=r,m=g.useMemo(()=>{let e=ie(c,s);return null==e?null:{location:{pathname:e,search:u,hash:d,state:h,key:f},navigationType:i}},[s,c,u,d,h,f,i]);return I(null!=m,'<Router basename="'.concat(s,'"> is not able to match the URL "').concat(c).concat(u).concat(d,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==m?null:g.createElement(Se.Provider,{value:l},g.createElement(Ce.Provider,{children:n,value:m}))}function $e(e){let{children:t,location:n}=e;return _e(Xe(t),n)}g.Component;function Xe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return g.Children.forEach(e,(e,r)=>{if(!g.isValidElement(e))return;let i=[...t,r];if(e.type===g.Fragment)return void n.push.apply(n,Xe(e.props.children,i));O(e.type===Ye,"[".concat("string"===typeof e.type?e.type:e.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),O(!e.props.index||!e.props.children,"An index route cannot have child routes.");let o={id:e.props.id||i.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,middleware:e.props.middleware,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=Xe(e.props.children,i)),n.push(o)}),n}var Qe="get",Je="application/x-www-form-urlencoded";function Ze(e){return null!=e&&"string"===typeof e.tagName}var et=null;var tt=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function nt(e){return null==e||tt.has(e)?e:(I(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(Je,'"')),null)}function rt(e,t){let n,r,i,o,a;if(Ze(s=e)&&"form"===s.tagName.toLowerCase()){let a=e.getAttribute("action");r=a?ie(a,t):null,n=e.getAttribute("method")||Qe,i=nt(e.getAttribute("enctype"))||Je,o=new FormData(e)}else if(function(e){return Ze(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Ze(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let a=e.form;if(null==a)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let s=e.getAttribute("formaction")||a.getAttribute("action");if(r=s?ie(s,t):null,n=e.getAttribute("formmethod")||a.getAttribute("method")||Qe,i=nt(e.getAttribute("formenctype"))||nt(a.getAttribute("enctype"))||Je,o=new FormData(a,e),!function(){if(null===et)try{new FormData(document.createElement("form"),0),et=!1}catch(qb){et=!0}return et}()){let{name:t,type:n,value:r}=e;if("image"===n){let e=t?"".concat(t,"."):"";o.append("".concat(e,"x"),"0"),o.append("".concat(e,"y"),"0")}else t&&o.append(t,r)}}else{if(Ze(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Qe,r=null,i=Je,a=e}var s;return o&&"text/plain"===i&&(a=o,o=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:o,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function it(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function ot(e,t,n){let r="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===r.pathname?r.pathname="_root.".concat(n):t&&"/"===ie(r.pathname,t)?r.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(n):r.pathname="".concat(r.pathname.replace(/\/$/,""),".").concat(n),r}async function at(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(mW){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(mW),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function st(e){return null!=e&&"string"===typeof e.page}function lt(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function ct(e,t,n,r,i,o){let a=(e,t)=>!n[t]||e.route.id!==n[t].route.id,s=(e,t)=>{var r;return n[t].pathname!==e.pathname||(null===(r=n[t].route.path)||void 0===r?void 0:r.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===o?t.filter((e,t)=>a(e,t)||s(e,t)):"data"===o?t.filter((t,o)=>{let l=r.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(a(t,o)||s(t,o))return!0;if(t.route.shouldRevalidate){var c;let r=t.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:(null===(c=n[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof r)return r}return!0}):[]}function ut(e,t){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=e.map(e=>{let r=t.routes[e.route.id];if(!r)return[];let i=[r.module];return r.clientActionModule&&(i=i.concat(r.clientActionModule)),r.clientLoaderModule&&(i=i.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(i=i.concat(r.hydrateFallbackModule)),r.imports&&(i=i.concat(r.imports)),i}).flat(1),[...new Set(r)];var r}function dt(e,t){let n=new Set,r=new Set(t);return e.reduce((e,i)=>{if(t&&!st(i)&&"script"===i.as&&i.href&&r.has(i.href))return e;let o=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}(i));return n.has(o)||(n.add(o),e.push({key:o,link:i})),e},[])}function ht(e,t){return"lazy"===e.mode&&!0===t}function ft(){let e=g.useContext(ge);return it(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function mt(){let e=g.useContext(ve);return it(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var pt=g.createContext(void 0);function gt(){let e=g.useContext(pt);return it(e,"You must render this element inside a <HydratedRouter> element"),e}function vt(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function yt(e,t,n){if(n&&!St)return[e[0]];if(t){let n=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,n+1)}return e}pt.displayName="FrameworkContext";function bt(e){let{page:t}=e,n=b(e,T),{router:r}=ft(),i=g.useMemo(()=>z(r.routes,t,r.basename),[r.routes,t,r.basename]);return i?g.createElement(xt,E({page:t,matches:i},n)):null}function wt(e){let{manifest:t,routeModules:n}=gt(),[r,i]=g.useState([]);return g.useEffect(()=>{let r=!1;return async function(e,t,n){let r=await Promise.all(e.map(async e=>{let r=t.routes[e.route.id];if(r){let e=await at(r,n);return e.links?e.links():[]}return[]}));return dt(r.flat(1).filter(lt).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?E(E({},e),{},{rel:"prefetch",as:"style"}):E(E({},e),{},{rel:"prefetch"})))}(e,t,n).then(e=>{r||i(e)}),()=>{r=!0}},[e,t,n]),r}function xt(e){let{page:t,matches:n}=e,r=b(e,A),i=Ae(),{manifest:o,routeModules:a}=gt(),{basename:s}=ft(),{loaderData:l,matches:c}=mt(),u=g.useMemo(()=>ct(t,n,c,o,i,"data"),[t,n,c,o,i]),d=g.useMemo(()=>ct(t,n,c,o,i,"assets"),[t,n,c,o,i]),h=g.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let e=new Set,r=!1;if(n.forEach(t=>{var n;let i=o.routes[t.route.id];i&&i.hasLoader&&(!u.some(e=>e.route.id===t.route.id)&&t.route.id in l&&null!==(n=a[t.route.id])&&void 0!==n&&n.shouldRevalidate||i.hasClientLoader?r=!0:e.add(t.route.id))}),0===e.size)return[];let c=ot(t,s,"data");return r&&e.size>0&&c.searchParams.set("_routes",n.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[c.pathname+c.search]},[s,l,i,o,u,n,t,a]),f=g.useMemo(()=>ut(d,o),[d,o]),m=wt(d);return g.createElement(g.Fragment,null,h.map(e=>g.createElement("link",E({key:e,rel:"prefetch",as:"fetch",href:e},r))),f.map(e=>g.createElement("link",E({key:e,rel:"modulepreload",href:e},r))),m.map(e=>{let{key:t,link:n}=e;return g.createElement("link",E({key:t,nonce:r.nonce},n))}))}var St=!1;function Ct(e){let{manifest:t,serverHandoffString:n,isSpaMode:r,renderMeta:i,routeDiscovery:o,ssr:a}=gt(),{router:s,static:l,staticContext:c}=ft(),{matches:u}=mt(),d=g.useContext(ye),h=ht(o,a);i&&(i.didRenderScripts=!0);let f=yt(u,null,r);g.useEffect(()=>{0},[]);let m=g.useMemo(()=>{var r;if(d)return null;let i=c?"window.__reactRouterContext = ".concat(n,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",o=l?"".concat(null!==t.hmr&&void 0!==r&&r.runtime?"import ".concat(JSON.stringify(t.hmr.runtime),";"):"").concat(h?"":"import ".concat(JSON.stringify(t.url)),";\n").concat(f.map((e,n)=>{let r="route".concat(n),i=t.routes[e.route.id];it(i,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:o,clientLoaderModule:a,clientMiddlewareModule:s,hydrateFallbackModule:l,module:c}=i,u=[...o?[{module:o,varName:"".concat(r,"_clientAction")}]:[],...a?[{module:a,varName:"".concat(r,"_clientLoader")}]:[],...s?[{module:s,varName:"".concat(r,"_clientMiddleware")}]:[],...l?[{module:l,varName:"".concat(r,"_HydrateFallback")}]:[],{module:c,varName:"".concat(r,"_main")}];return 1===u.length?"import * as ".concat(r," from ").concat(JSON.stringify(c),";"):[u.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(r," = {").concat(u.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(h?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:n}=e,r=b(e,N),i=new Set(t.state.matches.map(e=>e.route.id)),o=t.state.location.pathname.split("/").filter(Boolean),a=["/"];for(o.pop();o.length>0;)a.push("/".concat(o.join("/"))),o.pop();a.forEach(e=>{let n=z(t.routes,e,t.basename);n&&n.forEach(e=>i.add(e.route.id))});let s=[...i].reduce((e,t)=>Object.assign(e,{[t]:r.routes[t]}),{});return E(E({},r),{},{routes:s,sri:!!n||void 0})}(t,s),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(f.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(t.entry.module),");"):" ";return g.createElement(g.Fragment,null,g.createElement("script",E(E({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:i},type:void 0})),g.createElement("script",E(E({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:o},type:"module",async:!0})))},[]),p=St||d?[]:(t.entry.imports.concat(ut(f,t,{includeHydrateFallback:!0})),[...new Set(v)]);var v;let y="object"===typeof t.sri?t.sri:{};return Ge(!d,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),St||d?null:g.createElement(g.Fragment,null,"object"===typeof t.sri?g.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:y})}}):null,h?null:g.createElement("link",{rel:"modulepreload",href:t.url,crossOrigin:e.crossOrigin,integrity:y[t.url],suppressHydrationWarning:!0}),g.createElement("link",{rel:"modulepreload",href:t.entry.module,crossOrigin:e.crossOrigin,integrity:y[t.entry.module],suppressHydrationWarning:!0}),p.map(t=>g.createElement("link",{key:t,rel:"modulepreload",href:t,crossOrigin:e.crossOrigin,integrity:y[t],suppressHydrationWarning:!0})),m)}function Et(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}g.Component;function Nt(e){let{error:t,isOutsideRemixApp:n}=e;console.error(t);let r,i=g.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(fe(t))return g.createElement(Tt,{title:"Unhandled Thrown Response!"},g.createElement("h1",{style:{fontSize:"24px"}},t.status," ",t.statusText),i);if(t instanceof Error)0;else{let e=null==t?"Unknown Error":"object"===typeof t&&"toString"in t?t.toString():JSON.stringify(t);new Error(e)}return g.createElement(Tt,{title:"Application Error!",isOutsideRemixApp:n},g.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),g.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},r.stack),i)}function Tt(e){var t;let{title:n,renderScripts:r,isOutsideRemixApp:i,children:o}=e,{routeModules:a}=gt();return null!==a.root&&void 0!==t&&t.Layout&&!i?o:g.createElement("html",{lang:"en"},g.createElement("head",null,g.createElement("meta",{charSet:"utf-8"}),g.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),g.createElement("title",null,n)),g.createElement("body",null,g.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},o,r?g.createElement(Ct,null):null)))}var At="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{At&&(window.__reactRouterVersion="7.9.4")}catch(qb){}function Rt(e){let{basename:t,children:n,window:r}=e,i=g.useRef();null==i.current&&(i.current=_({window:r,v5Compat:!0}));let o=i.current,[a,s]=g.useState({action:o.action,location:o.location}),l=g.useCallback(e=>{g.startTransition(()=>s(e))},[s]);return g.useLayoutEffect(()=>o.listen(l),[o,l]),g.createElement(Ke,{basename:t,children:n,location:a.location,navigationType:a.action,navigator:o})}var kt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Mt=g.forwardRef(function(e,t){let n,{onClick:r,discover:i="render",prefetch:o="none",relative:a,reloadDocument:s,replace:l,state:c,target:u,to:d,preventScrollReset:h,viewTransition:f}=e,m=b(e,R),{basename:p}=g.useContext(Se),v="string"===typeof d&&kt.test(d),y=!1;if("string"===typeof d&&v&&(n=d,At))try{let e=new URL(window.location.href),t=d.startsWith("//")?new URL(e.protocol+d):new URL(d),n=ie(t.pathname,p);t.origin===e.origin&&null!=n?d=n+t.search+t.hash:y=!0}catch(qb){I(!1,'<Link to="'.concat(d,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let w=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};O(Te(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=g.useContext(Se),{hash:i,pathname:o,search:a}=De(e,{relative:t}),s=o;return"/"!==n&&(s="/"===o?n:ce([n,o])),r.createHref({pathname:s,search:a,hash:i})}(d,{relative:a}),[x,S,C]=function(e,t){let n=g.useContext(pt),[r,i]=g.useState(!1),[o,a]=g.useState(!1),{onFocus:s,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:d}=t,h=g.useRef(null);g.useEffect(()=>{if("render"===e&&a(!0),"viewport"===e){let e=e=>{e.forEach(e=>{a(e.isIntersecting)})},t=new IntersectionObserver(e,{threshold:.5});return h.current&&t.observe(h.current),()=>{t.disconnect()}}},[e]),g.useEffect(()=>{if(r){let e=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(e)}}},[r]);let f=()=>{i(!0)},m=()=>{i(!1),a(!1)};return n?"intent"!==e?[o,h,{}]:[o,h,{onFocus:vt(s,f),onBlur:vt(l,m),onMouseEnter:vt(c,f),onMouseLeave:vt(u,m),onTouchStart:vt(d,f)}]:[!1,h,{}]}(o,m),N=function(e){let{target:t,replace:n,state:r,preventScrollReset:i,relative:o,viewTransition:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=Me(),l=Ae(),c=De(e,{relative:o});return g.useCallback(u=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(u,t)){u.preventDefault();let t=void 0!==n?n:F(l)===F(c);s(e,{replace:t,state:r,preventScrollReset:i,relative:o,viewTransition:a})}},[l,s,c,n,r,t,e,i,o,a])}(d,{replace:l,state:c,target:u,preventScrollReset:h,relative:a,viewTransition:f});let T=g.createElement("a",E(E(E({},m),C),{},{href:n||w,onClick:y||s?r:function(e){r&&r(e),e.defaultPrevented||N(e)},ref:Et(t,S),target:u,"data-discover":v||"render"!==i?void 0:"true"}));return x&&!v?g.createElement(g.Fragment,null,T,g.createElement(bt,{page:w})):T});Mt.displayName="Link";var Dt=g.forwardRef(function(e,t){let{"aria-current":n="page",caseSensitive:r=!1,className:i="",end:o=!1,style:a,to:s,viewTransition:l,children:c}=e,u=b(e,k),d=De(s,{relative:u.relative}),h=Ae(),f=g.useContext(ve),{navigator:m,basename:p}=g.useContext(Se),v=null!=f&&function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=g.useContext(be);O(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=It("useViewTransitionState"),i=De(e,{relative:t});if(!n.isTransitioning)return!1;let o=ie(n.currentLocation.pathname,r)||n.currentLocation.pathname,a=ie(n.nextLocation.pathname,r)||n.nextLocation.pathname;return null!=te(i.pathname,a)||null!=te(i.pathname,o)}(d)&&!0===l,y=m.encodeLocation?m.encodeLocation(d).pathname:d.pathname,w=h.pathname,x=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;r||(w=w.toLowerCase(),x=x?x.toLowerCase():null,y=y.toLowerCase()),x&&p&&(x=ie(x,p)||x);const S="/"!==y&&y.endsWith("/")?y.length-1:y.length;let C,N=w===y||!o&&w.startsWith(y)&&"/"===w.charAt(S),T=null!=x&&(x===y||!o&&x.startsWith(y)&&"/"===x.charAt(y.length)),A={isActive:N,isPending:T,isTransitioning:v},R=N?n:void 0;C="function"===typeof i?i(A):[i,N?"active":null,T?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let M="function"===typeof a?a(A):a;return g.createElement(Mt,E(E({},u),{},{"aria-current":R,className:C,ref:t,style:M,to:s,viewTransition:l}),"function"===typeof c?c(A):c)});Dt.displayName="NavLink";var _t=g.forwardRef((e,t)=>{let{discover:n="render",fetcherKey:r,navigate:i,reloadDocument:o,replace:a,state:s,method:l=Qe,action:c,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:f}=e,m=b(e,M),p=Ft(),v=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:n}=g.useContext(Se),r=g.useContext(Ee);O(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),o=E({},De(e||".",{relative:t})),a=Ae();if(null==e){o.search=a.search;let e=new URLSearchParams(o.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();o.search=n?"?".concat(n):""}}e&&"."!==e||!i.route.index||(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(o.pathname="/"===o.pathname?n:ce([n,o.pathname]));return F(o)}(c,{relative:d}),y="get"===l.toLowerCase()?"get":"post",w="string"===typeof c&&kt.test(c);return g.createElement("form",E(E({ref:t,method:y,action:v,onSubmit:o?u:e=>{if(u&&u(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||l;p(t||e.currentTarget,{fetcherKey:r,method:n,navigate:i,replace:a,state:s,relative:d,preventScrollReset:h,viewTransition:f})}},m),{},{"data-discover":w||"render"!==n?void 0:"true"}))});function Ot(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function It(e){let t=g.useContext(ge);return O(t,Ot(e)),t}_t.displayName="Form";var Pt=0,jt=()=>"__".concat(String(++Pt),"__");function Ft(){let{router:e}=It("useSubmit"),{basename:t}=g.useContext(Se),n=ze("useRouteId");return g.useCallback(async function(r){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:o,method:a,encType:s,formData:l,body:c}=rt(r,t);if(!1===i.navigate){let t=i.fetcherKey||jt();await e.fetch(t,n,i.action||o,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||a,formEncType:i.encType||s,flushSync:i.flushSync})}else await e.navigate(i.action||o,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||a,formEncType:i.encType||s,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[e,t,n])}function Ht(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=Ht(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}const Lt=function(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=Ht(e))&&(r&&(r+=" "),r+=t);return r};var Bt=n(579);const zt=["xxl","xl","lg","md","sm","xs"],Wt="xs",Vt=g.createContext({prefixes:{},breakpoints:zt,minBreakpoint:Wt}),{Consumer:Ut,Provider:qt}=Vt;function Gt(e,t){const{prefixes:n}=(0,g.useContext)(Vt);return e||n[t]||t}function Yt(){const{breakpoints:e}=(0,g.useContext)(Vt);return e}function Kt(){const{minBreakpoint:e}=(0,g.useContext)(Vt);return e}function $t(){const{dir:e}=(0,g.useContext)(Vt);return"rtl"===e}const Xt=["bsPrefix","fluid","as","className"],Qt=g.forwardRef((e,t)=>{let{bsPrefix:n,fluid:r=!1,as:i="div",className:o}=e,a=b(e,Xt);const s=Gt(n,"container"),l="string"===typeof r?"-".concat(r):"-fluid";return(0,Bt.jsx)(i,E(E({ref:t},a),{},{className:Lt(o,r?"".concat(s).concat(l):s)}))});Qt.displayName="Container";const Jt=Qt,Zt=["bsPrefix","variant","animation","size","as","className"],en=g.forwardRef((e,t)=>{let{bsPrefix:n,variant:r,animation:i="border",size:o,as:a="div",className:s}=e,l=b(e,Zt);n=Gt(n,"spinner");const c="".concat(n,"-").concat(i);return(0,Bt.jsx)(a,E(E({ref:t},l),{},{className:Lt(s,c,o&&"".concat(c,"-").concat(o),r&&"text-".concat(r))}))});en.displayName="Spinner";const tn=en;function nn(e,t,n){const r=(0,g.useRef)(void 0!==e),[i,o]=(0,g.useState)(t),a=void 0!==e,s=r.current;return r.current=a,!a&&s&&i!==t&&o(t),[a?e:i,(0,g.useCallback)(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[i,...a]=t;let s=null===n||void 0===n?void 0:n(i,...a);return o(i),s},[n])]}function rn(e,t){return Object.keys(t).reduce((n,r)=>{const i="default"+(l=r).charAt(0).toUpperCase()+l.substr(1),{[i]:o,[r]:a}=n,s=b(n,[i,r].map(x));var l;const c=t[r],[u,d]=nn(a,o,e[c]);return E(E({},s),{},{[r]:u,[c]:d})},e)}const on=function(e){const t=(0,g.useRef)(e);return(0,g.useEffect)(()=>{t.current=e},[e]),t};function an(e){const t=on(e);return(0,g.useCallback)(function(){return t.current&&t.current(...arguments)},[t])}const sn=e=>g.forwardRef((t,n)=>(0,Bt.jsx)("div",E(E({},t),{},{ref:n,className:Lt(t.className,e)}))),ln=["className","bsPrefix","as"],cn=sn("h4");cn.displayName="DivStyledAsH4";const un=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i=cn}=e,o=b(e,ln);return r=Gt(r,"alert-heading"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r)},o))});un.displayName="AlertHeading";const dn=un,hn=["as","disabled"];function fn(e){let{tagName:t,disabled:n,href:r,target:i,rel:o,role:a,onClick:s,tabIndex:l=0,type:c}=e;t||(t=null!=r||null!=i||null!=o?"a":"button");const u={tagName:t};if("button"===t)return[{type:c||"button",disabled:n},u];const d=e=>{(n||"a"===t&&function(e){return!e||"#"===e.trim()}(r))&&e.preventDefault(),n?e.stopPropagation():null==s||s(e)};return"a"===t&&(r||(r="#"),n&&(r=void 0)),[{role:null!=a?a:"button",disabled:void 0,tabIndex:n?void 0:l,href:r,target:"a"===t?i:void 0,"aria-disabled":n||void 0,rel:"a"===t?o:void 0,onClick:d,onKeyDown:e=>{" "===e.key&&(e.preventDefault(),d(e))}},u]}const mn=g.forwardRef((e,t)=>{let{as:n,disabled:r}=e,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,hn);const[o,{tagName:a}]=fn(Object.assign({tagName:n,disabled:r},i));return(0,Bt.jsx)(a,Object.assign({},i,o,{ref:t}))});mn.displayName="Button";const pn=mn,gn=["onKeyDown"];const vn=g.forwardRef((e,t)=>{let{onKeyDown:n}=e,r=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,gn);const[i]=fn(Object.assign({tagName:"a"},r)),o=an(e=>{i.onKeyDown(e),null==n||n(e)});return(a=r.href)&&"#"!==a.trim()&&"button"!==r.role?(0,Bt.jsx)("a",Object.assign({ref:t},r,{onKeyDown:n})):(0,Bt.jsx)("a",Object.assign({ref:t},r,i,{onKeyDown:o}));var a});vn.displayName="Anchor";const yn=vn,bn=["className","bsPrefix","as"],wn=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i=yn}=e,o=b(e,bn);return r=Gt(r,"alert-link"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r)},o))});wn.displayName="AlertLink";const xn=wn;function Sn(e){if(!e||"function"===typeof e)return null;const{major:t}=function(){const e=g.version.split(".");return{major:+e[0],minor:+e[1],patch:+e[2]}}();return t>=19?e.props.ref:e.ref}function Cn(e){return e&&e.ownerDocument||document}function En(e,t){return function(e){const t=Cn(e);return t&&t.defaultView||window}(e).getComputedStyle(e,t)}const Nn=/([A-Z])/g;const Tn=/^ms-/;function An(e){return function(e){return e.replace(Nn,"-$1").toLowerCase()}(e).replace(Tn,"-ms-")}const Rn=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;const kn=function(e,t){let n="",r="";if("string"===typeof t)return e.style.getPropertyValue(An(t))||En(e).getPropertyValue(An(t));Object.keys(t).forEach(i=>{const o=t[i];o||0===o?!function(e){return!(!e||!Rn.test(e))}(i)?n+="".concat(An(i),": ").concat(o,";"):r+="".concat(i,"(").concat(o,") "):e.style.removeProperty(An(i))}),r&&(n+="transform: ".concat(r,";")),e.style.cssText+=";".concat(n)},Mn=!("undefined"===typeof window||!window.document||!window.document.createElement);let Dn=!1,_n=!1;try{const e={get passive(){return Dn=!0},get once(){return _n=Dn=!0}};Mn&&(window.addEventListener("test",e,e),window.removeEventListener("test",e,!0))}catch(qb){}const On=function(e,t,n,r){if(r&&"boolean"!==typeof r&&!_n){const{once:i,capture:o}=r;let a=n;!_n&&i&&(a=n.__once||function e(r){this.removeEventListener(t,e,o),n.call(this,r)},n.__once=a),e.addEventListener(t,a,Dn?r:o)}e.addEventListener(t,n,r)};const In=function(e,t,n,r){const i=r&&"boolean"!==typeof r?r.capture:r;e.removeEventListener(t,n,i),n.__once&&e.removeEventListener(t,n.__once,i)};const Pn=function(e,t,n,r){return On(e,t,n,r),()=>{In(e,t,n,r)}};function jn(e,t){let n=!1;const r=setTimeout(()=>{n||function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(e){const i=document.createEvent("HTMLEvents");i.initEvent(t,n,r),e.dispatchEvent(i)}}(e,"transitionend",!0)},t+(arguments.length>2&&void 0!==arguments[2]?arguments[2]:5)),i=Pn(e,"transitionend",()=>{n=!0},{once:!0});return()=>{clearTimeout(r),i()}}function Fn(e,t,n,r){null==n&&(n=function(e){const t=kn(e,"transitionDuration")||"",n=-1===t.indexOf("ms")?1e3:1;return parseFloat(t)*n}(e)||0);const i=jn(e,n,r),o=Pn(e,"transitionend",t);return()=>{i(),o()}}function Hn(e,t){const n=getComputedStyle(e).getPropertyValue(t),r=-1===n.indexOf("ms")?1e3:1;return parseFloat(n)*r}function Ln(e,t){const n=Hn(e,"transition-duration"),r=Hn(e,"transition-delay"),i=Fn(e,n=>{n.target===e&&(i(),t(n))},n+r)}function Bn(e){e.offsetHeight}function zn(e,t){return zn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},zn(e,t)}var Wn=n(7950);const Vn=!1,Un=g.createContext(null);var qn="unmounted",Gn="exited",Yn="entering",Kn="entered",$n="exiting",Xn=function(e){var t,n;function r(t,n){var r;r=e.call(this,t,n)||this;var i,o=n&&!n.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?o?(i=Gn,r.appearStatus=Yn):i=Kn:i=t.unmountOnExit||t.mountOnEnter?qn:Gn,r.state={status:i},r.nextCallback=null,r}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,zn(t,n),r.getDerivedStateFromProps=function(e,t){return e.in&&t.status===qn?{status:Gn}:null};var i=r.prototype;return i.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},i.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==Yn&&n!==Kn&&(t=Yn):n!==Yn&&n!==Kn||(t=$n)}this.updateStatus(!1,t)},i.componentWillUnmount=function(){this.cancelNextCallback()},i.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!==typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},i.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===Yn){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:Wn.findDOMNode(this);n&&function(e){e.scrollTop}(n)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Gn&&this.setState({status:qn})},i.performEnter=function(e){var t=this,n=this.props.enter,r=this.context?this.context.isMounting:e,i=this.props.nodeRef?[r]:[Wn.findDOMNode(this),r],o=i[0],a=i[1],s=this.getTimeouts(),l=r?s.appear:s.enter;!e&&!n||Vn?this.safeSetState({status:Kn},function(){t.props.onEntered(o)}):(this.props.onEnter(o,a),this.safeSetState({status:Yn},function(){t.props.onEntering(o,a),t.onTransitionEnd(l,function(){t.safeSetState({status:Kn},function(){t.props.onEntered(o,a)})})}))},i.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),r=this.props.nodeRef?void 0:Wn.findDOMNode(this);t&&!Vn?(this.props.onExit(r),this.safeSetState({status:$n},function(){e.props.onExiting(r),e.onTransitionEnd(n.exit,function(){e.safeSetState({status:Gn},function(){e.props.onExited(r)})})})):this.safeSetState({status:Gn},function(){e.props.onExited(r)})},i.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},i.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},i.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},i.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:Wn.findDOMNode(this),r=null==e&&!this.props.addEndListener;if(n&&!r){if(this.props.addEndListener){var i=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],o=i[0],a=i[1];this.props.addEndListener(o,a)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},i.render=function(){var e=this.state.status;if(e===qn)return null;var t=this.props,n=t.children,r=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,y(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return g.createElement(Un.Provider,{value:null},"function"===typeof n?n(e,r):g.cloneElement(g.Children.only(n),r))},r}(g.Component);function Qn(){}Xn.contextType=Un,Xn.propTypes={},Xn.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Qn,onEntering:Qn,onEntered:Qn,onExit:Qn,onExiting:Qn,onExited:Qn},Xn.UNMOUNTED=qn,Xn.EXITED=Gn,Xn.ENTERING=Yn,Xn.ENTERED=Kn,Xn.EXITING=$n;const Jn=Xn;function Zn(e){return e&&"function"!==typeof e?t=>{e.current=t}:e}const er=function(e,t){return(0,g.useMemo)(()=>function(e,t){const n=Zn(e),r=Zn(t);return e=>{n&&n(e),r&&r(e)}}(e,t),[e,t])},tr=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children","childRef"],nr=g.forwardRef((e,t)=>{let{onEnter:n,onEntering:r,onEntered:i,onExit:o,onExiting:a,onExited:s,addEndListener:l,children:c,childRef:u}=e,d=b(e,tr);const h=(0,g.useRef)(null),f=er(h,u),m=e=>t=>{e&&h.current&&e(h.current,t)},p=(0,g.useCallback)(m(n),[n]),v=(0,g.useCallback)(m(r),[r]),y=(0,g.useCallback)(m(i),[i]),w=(0,g.useCallback)(m(o),[o]),x=(0,g.useCallback)(m(a),[a]),S=(0,g.useCallback)(m(s),[s]),C=(0,g.useCallback)(m(l),[l]);return(0,Bt.jsx)(Jn,E(E({ref:t},d),{},{onEnter:p,onEntered:y,onEntering:v,onExit:w,onExited:S,onExiting:x,addEndListener:C,nodeRef:h,children:"function"===typeof c?(e,t)=>c(e,E(E({},t),{},{ref:f})):g.cloneElement(c,{ref:f})}))});nr.displayName="TransitionWrapper";const rr=nr,ir=["className","children","transitionClasses","onEnter"],or={entering:"show",entered:"show"},ar=g.forwardRef((e,t)=>{let{className:n,children:r,transitionClasses:i={},onEnter:o}=e;const a=E({in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1},b(e,ir)),s=(0,g.useCallback)((e,t)=>{Bn(e),null==o||o(e,t)},[o]);return(0,Bt.jsx)(rr,E(E({ref:t,addEndListener:Ln},a),{},{onEnter:s,childRef:Sn(r),children:(e,t)=>g.cloneElement(r,E(E({},t),{},{className:Lt("fade",n,r.props.className,or[e],i[e])}))}))});ar.displayName="Fade";const sr=ar,lr=["className","variant","aria-label"],cr=g.forwardRef((e,t)=>{let{className:n,variant:r,"aria-label":i="Close"}=e,o=b(e,lr);return(0,Bt.jsx)("button",E({ref:t,type:"button",className:Lt("btn-close",r&&"btn-close-".concat(r),n),"aria-label":i},o))});cr.displayName="CloseButton";const ur=cr,dr=["bsPrefix","show","closeLabel","closeVariant","className","children","variant","onClose","dismissible","transition"],hr=g.forwardRef((e,t)=>{const n=rn(e,{show:"onClose"}),{bsPrefix:r,show:i=!0,closeLabel:o="Close alert",closeVariant:a,className:s,children:l,variant:c="primary",onClose:u,dismissible:d,transition:h=sr}=n,f=b(n,dr),m=Gt(r,"alert"),p=an(e=>{u&&u(!1,e)}),g=!0===h?sr:h,v=(0,Bt.jsxs)("div",E(E({role:"alert"},g?void 0:f),{},{ref:t,className:Lt(s,m,c&&"".concat(m,"-").concat(c),d&&"".concat(m,"-dismissible")),children:[d&&(0,Bt.jsx)(ur,{onClick:p,"aria-label":o,variant:a}),l]}));return g?(0,Bt.jsx)(g,E(E({unmountOnExit:!0},f),{},{ref:void 0,in:i,children:v})):i?v:null});hr.displayName="Alert";const fr=Object.assign(hr,{Link:xn,Heading:dn}),mr=["as","bsPrefix","variant","size","active","disabled","className"],pr=g.forwardRef((e,t)=>{let{as:n,bsPrefix:r,variant:i="primary",size:o,active:a=!1,disabled:s=!1,className:l}=e,c=b(e,mr);const u=Gt(r,"btn"),[d,{tagName:h}]=fn(E({tagName:n,disabled:s},c)),f=h;return(0,Bt.jsx)(f,E(E(E({},d),c),{},{ref:t,disabled:s,className:Lt(l,u,a&&"active",i&&"".concat(u,"-").concat(i),o&&"".concat(u,"-").concat(o),c.href&&s&&"disabled")}))});pr.displayName="Button";const gr=pr,vr=["className","bsPrefix","as"],yr=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i="div"}=e,o=b(e,vr);return r=Gt(r,"card-body"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r)},o))});yr.displayName="CardBody";const br=yr,wr=["className","bsPrefix","as"],xr=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i="div"}=e,o=b(e,wr);return r=Gt(r,"card-footer"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r)},o))});xr.displayName="CardFooter";const Sr=xr,Cr=g.createContext(null);Cr.displayName="CardHeaderContext";const Er=Cr,Nr=["bsPrefix","className","as"],Tr=g.forwardRef((e,t)=>{let{bsPrefix:n,className:r,as:i="div"}=e,o=b(e,Nr);const a=Gt(n,"card-header"),s=(0,g.useMemo)(()=>({cardHeaderBsPrefix:a}),[a]);return(0,Bt.jsx)(Er.Provider,{value:s,children:(0,Bt.jsx)(i,E(E({ref:t},o),{},{className:Lt(r,a)}))})});Tr.displayName="CardHeader";const Ar=Tr,Rr=["bsPrefix","className","variant","as"],kr=g.forwardRef((e,t)=>{let{bsPrefix:n,className:r,variant:i,as:o="img"}=e,a=b(e,Rr);const s=Gt(n,"card-img");return(0,Bt.jsx)(o,E({ref:t,className:Lt(i?"".concat(s,"-").concat(i):s,r)},a))});kr.displayName="CardImg";const Mr=kr,Dr=["className","bsPrefix","as"],_r=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i="div"}=e,o=b(e,Dr);return r=Gt(r,"card-img-overlay"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r)},o))});_r.displayName="CardImgOverlay";const Or=_r,Ir=["className","bsPrefix","as"],Pr=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i="a"}=e,o=b(e,Ir);return r=Gt(r,"card-link"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r)},o))});Pr.displayName="CardLink";const jr=Pr,Fr=["className","bsPrefix","as"],Hr=sn("h6"),Lr=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i=Hr}=e,o=b(e,Fr);return r=Gt(r,"card-subtitle"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r)},o))});Lr.displayName="CardSubtitle";const Br=Lr,zr=["className","bsPrefix","as"],Wr=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i="p"}=e,o=b(e,zr);return r=Gt(r,"card-text"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r)},o))});Wr.displayName="CardText";const Vr=Wr,Ur=["className","bsPrefix","as"],qr=sn("h5"),Gr=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i=qr}=e,o=b(e,Ur);return r=Gt(r,"card-title"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r)},o))});Gr.displayName="CardTitle";const Yr=Gr,Kr=["bsPrefix","className","bg","text","border","body","children","as"],$r=g.forwardRef((e,t)=>{let{bsPrefix:n,className:r,bg:i,text:o,border:a,body:s=!1,children:l,as:c="div"}=e,u=b(e,Kr);const d=Gt(n,"card");return(0,Bt.jsx)(c,E(E({ref:t},u),{},{className:Lt(r,d,i&&"bg-".concat(i),o&&"text-".concat(o),a&&"border-".concat(a)),children:s?(0,Bt.jsx)(br,{children:l}):l}))});$r.displayName="Card";const Xr=Object.assign($r,{Img:Mr,Title:Yr,Subtitle:Br,Body:br,Link:jr,Text:Vr,Header:Ar,Footer:Sr,ImgOverlay:Or}),Qr=["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"],Jr=g.forwardRef((e,t)=>{let{bsPrefix:n,className:r,striped:i,bordered:o,borderless:a,hover:s,size:l,variant:c,responsive:u}=e,d=b(e,Qr);const h=Gt(n,"table"),f=Lt(r,h,c&&"".concat(h,"-").concat(c),l&&"".concat(h,"-").concat(l),i&&"".concat(h,"-").concat("string"===typeof i?"striped-".concat(i):"striped"),o&&"".concat(h,"-bordered"),a&&"".concat(h,"-borderless"),s&&"".concat(h,"-hover")),m=(0,Bt.jsx)("table",E(E({},d),{},{className:f,ref:t}));if(u){let e="".concat(h,"-responsive");return"string"===typeof u&&(e="".concat(e,"-").concat(u)),(0,Bt.jsx)("div",{className:e,children:m})}return m});Jr.displayName="Table";const Zr=Jr;const ei=function(){const[e,t]=(0,g.useState)([]),[n,r]=(0,g.useState)(!0),[i,o]=(0,g.useState)(null),a=Me();return(0,g.useEffect)(()=>{(async()=>{try{r(!0);const e="".concat("https://buildproapi.onrender.com","/api/ProjectEstimation"),n=await fetch(e);if(!n.ok)throw new Error("Failed to load project estimation data");const i=await n.json(),a=Array.isArray(i)?i:[i],s=e=>{if(!e)return"N/A";const t=new Date(e);return isNaN(t.getTime())?"N/A":t.toLocaleDateString("en-IN")},l=a.map(e=>{var t;return{_id:e._id,ref:e.estimationRef||"N/A",description:e.description||"No description available",location:(null===(t=e.projectDetails)||void 0===t?void 0:t.city)||"Not specified",creationDate:s(e.createdDate),modificationDate:s(e.modifiedDate),createdBy:e.createdBy||"Unknown",modifiedBy:e.modifiedBy||"Unknown",action:"Edit",projectDetails:e.projectDetails,floorConfiguration:e.floorConfiguration,costEstimation:e.costEstimation,metadata:e.metadata}});t(l),o(null)}catch(e){console.error("Error loading project data:",e),o(e.message),t([])}finally{r(!1)}})()},[]),n?(0,Bt.jsxs)(Jt,{className:"py-4 text-center",children:[(0,Bt.jsx)(tn,{animation:"border",role:"status",variant:"primary",children:(0,Bt.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,Bt.jsx)("div",{className:"mt-2",children:"Loading project estimation data..."})]}):i?(0,Bt.jsx)(Jt,{className:"py-4",children:(0,Bt.jsxs)(fr,{variant:"danger",children:[(0,Bt.jsx)(fr.Heading,{children:"Error Loading Data"}),(0,Bt.jsxs)("p",{children:["Unable to load project estimation data: ",i]}),(0,Bt.jsx)("hr",{}),(0,Bt.jsx)("div",{className:"d-flex justify-content-end",children:(0,Bt.jsx)(gr,{onClick:()=>window.location.reload(),variant:"outline-danger",children:"Retry"})})]})}):(0,Bt.jsxs)(Jt,{className:"py-4",children:[(0,Bt.jsx)("div",{className:"d-flex justify-content-end mb-2",children:(0,Bt.jsxs)(gr,{style:{backgroundColor:"#199e60",borderColor:"#199e60",color:"white",display:"flex",alignItems:"center",gap:"8px",fontWeight:500,fontSize:"1.1rem",padding:"0.5rem 1.5rem"},onClick:async()=>{try{const e="".concat("https://buildproapi.onrender.com","/api/ProjectEstimation"),t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!t.ok)throw new Error("Failed to create new estimation");const n=await t.json();a("/pricing-calculator",{state:{mode:"new",id:n._id}})}catch(i){console.error("Error creating new estimation:",i),alert("Error creating new estimation: "+i.message)}},children:[(0,Bt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"white",viewBox:"0 0 16 16",style:{marginRight:"4px"},children:(0,Bt.jsx)("path",{d:"M8 1a.5.5 0 0 1 .5.5v6h6a.5.5 0 0 1 0 1h-6v6a.5.5 0 0 1-1 0v-6h-6a.5.5 0 0 1 0-1h6v-6A.5.5 0 0 1 8 1z"})}),"New Entry"]})}),(0,Bt.jsxs)(Xr,{className:"mb-4 shadow-sm",children:[(0,Bt.jsx)(Xr.Header,{as:"h3",className:"bg-primary text-white",children:"Project Estimation"}),(0,Bt.jsx)(Xr.Body,{children:(0,Bt.jsxs)(Xr,{className:"mb-4",children:[(0,Bt.jsx)(Xr.Header,{as:"h5",className:"bg-info text-white",children:"Estimation List"}),(0,Bt.jsx)(Xr.Body,{children:(0,Bt.jsxs)(Zr,{bordered:!0,hover:!0,responsive:!0,size:"sm",children:[(0,Bt.jsx)("thead",{className:"table-light",children:(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("th",{children:"Estimation Ref#"}),(0,Bt.jsx)("th",{children:"Description"}),(0,Bt.jsx)("th",{children:"Location"}),(0,Bt.jsx)("th",{children:"Creation Date"}),(0,Bt.jsx)("th",{children:"Modification Date"}),(0,Bt.jsx)("th",{children:"Created By"}),(0,Bt.jsx)("th",{children:"Modified By"}),(0,Bt.jsx)("th",{children:"Action"})]})}),(0,Bt.jsx)("tbody",{children:e.map((n,r)=>(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("td",{children:(0,Bt.jsx)(gr,{variant:"link",onClick:()=>{return e=n._id,void a("/pricing-calculator",{state:{mode:"view",id:e}});var e},style:{padding:0},children:n.ref})}),(0,Bt.jsx)("td",{children:n.description}),(0,Bt.jsx)("td",{children:n.location}),(0,Bt.jsx)("td",{children:n.creationDate}),(0,Bt.jsx)("td",{children:n.modificationDate}),(0,Bt.jsx)("td",{children:n.createdBy}),(0,Bt.jsx)("td",{children:n.modifiedBy}),(0,Bt.jsxs)("td",{className:"d-flex gap-2",children:[(0,Bt.jsx)(gr,{variant:"outline-primary",size:"sm",onClick:()=>{return e=n._id,void a("/pricing-calculator",{state:{mode:"edit",id:e}});var e},children:"Edit"}),(0,Bt.jsx)(gr,{variant:"outline-danger",size:"sm",onClick:()=>(async(n,r)=>{if(window.confirm("Are you sure you want to delete estimation ".concat(r,"?")))try{const r="".concat("https://buildproapi.onrender.com","/api/ProjectEstimation/").concat(n);if(!(await fetch(r,{method:"DELETE"})).ok)throw new Error("Failed to delete estimation");t(e.filter(e=>e._id!==n)),alert("Estimation deleted successfully!")}catch(i){console.error("Error deleting estimation:",i),alert("Error deleting estimation: "+i.message)}})(n._id,n.ref),children:"Delete"})]})]},n._id))})]})})]})})]})]})},ti=["as","className","type","tooltip"],ni=g.forwardRef((e,t)=>{let{as:n="div",className:r,type:i="valid",tooltip:o=!1}=e,a=b(e,ti);return(0,Bt.jsx)(n,E(E({},a),{},{ref:t,className:Lt(r,"".concat(i,"-").concat(o?"tooltip":"feedback"))}))});ni.displayName="Feedback";const ri=ni,ii=g.createContext({}),oi=["id","bsPrefix","className","type","isValid","isInvalid","as"],ai=g.forwardRef((e,t)=>{let{id:n,bsPrefix:r,className:i,type:o="checkbox",isValid:a=!1,isInvalid:s=!1,as:l="input"}=e,c=b(e,oi);const{controlId:u}=(0,g.useContext)(ii);return r=Gt(r,"form-check-input"),(0,Bt.jsx)(l,E(E({},c),{},{ref:t,type:o,id:n||u,className:Lt(i,r,a&&"is-valid",s&&"is-invalid")}))});ai.displayName="FormCheckInput";const si=ai,li=["bsPrefix","className","htmlFor"],ci=g.forwardRef((e,t)=>{let{bsPrefix:n,className:r,htmlFor:i}=e,o=b(e,li);const{controlId:a}=(0,g.useContext)(ii);return n=Gt(n,"form-check-label"),(0,Bt.jsx)("label",E(E({},o),{},{ref:t,htmlFor:i||a,className:Lt(r,n)}))});ci.displayName="FormCheckLabel";const ui=ci;function di(e,t){let n=0;return g.Children.map(e,e=>g.isValidElement(e)?t(e,n++):e)}const hi=["id","bsPrefix","bsSwitchPrefix","inline","reverse","disabled","isValid","isInvalid","feedbackTooltip","feedback","feedbackType","className","style","title","type","label","children","as"],fi=g.forwardRef((e,t)=>{let{id:n,bsPrefix:r,bsSwitchPrefix:i,inline:o=!1,reverse:a=!1,disabled:s=!1,isValid:l=!1,isInvalid:c=!1,feedbackTooltip:u=!1,feedback:d,feedbackType:h,className:f,style:m,title:p="",type:v="checkbox",label:y,children:w,as:x="input"}=e,S=b(e,hi);r=Gt(r,"form-check"),i=Gt(i,"form-switch");const{controlId:C}=(0,g.useContext)(ii),N=(0,g.useMemo)(()=>({controlId:n||C}),[C,n]),T=!w&&null!=y&&!1!==y||function(e,t){return g.Children.toArray(e).some(e=>g.isValidElement(e)&&e.type===t)}(w,ui),A=(0,Bt.jsx)(si,E(E({},S),{},{type:"switch"===v?"checkbox":v,ref:t,isValid:l,isInvalid:c,disabled:s,as:x}));return(0,Bt.jsx)(ii.Provider,{value:N,children:(0,Bt.jsx)("div",{style:m,className:Lt(f,T&&r,o&&"".concat(r,"-inline"),a&&"".concat(r,"-reverse"),"switch"===v&&i),children:w||(0,Bt.jsxs)(Bt.Fragment,{children:[A,T&&(0,Bt.jsx)(ui,{title:p,children:y}),d&&(0,Bt.jsx)(ri,{type:h,tooltip:u,children:d})]})})})});fi.displayName="FormCheck";const mi=Object.assign(fi,{Input:si,Label:ui});var pi=n(6440);const gi=["bsPrefix","type","size","htmlSize","id","className","isValid","isInvalid","plaintext","readOnly","as"],vi=g.forwardRef((e,t)=>{let{bsPrefix:n,type:r,size:i,htmlSize:o,id:a,className:s,isValid:l=!1,isInvalid:c=!1,plaintext:u,readOnly:d,as:h="input"}=e,f=b(e,gi);const{controlId:m}=(0,g.useContext)(ii);return n=Gt(n,"form-control"),(0,Bt.jsx)(h,E(E({},f),{},{type:r,size:o,ref:t,readOnly:d,id:a||m,className:Lt(s,u?"".concat(n,"-plaintext"):n,i&&"".concat(n,"-").concat(i),"color"===r&&"".concat(n,"-color"),l&&"is-valid",c&&"is-invalid")}))});vi.displayName="FormControl";const yi=Object.assign(vi,{Feedback:ri}),bi=["className","bsPrefix","as"],wi=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i="div"}=e,o=b(e,bi);return r=Gt(r,"form-floating"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r)},o))});wi.displayName="FormFloating";const xi=wi,Si=["controlId","as"],Ci=g.forwardRef((e,t)=>{let{controlId:n,as:r="div"}=e,i=b(e,Si);const o=(0,g.useMemo)(()=>({controlId:n}),[n]);return(0,Bt.jsx)(ii.Provider,{value:o,children:(0,Bt.jsx)(r,E(E({},i),{},{ref:t}))})});Ci.displayName="FormGroup";const Ei=Ci,Ni=["as","bsPrefix","className"];const Ti=["className"],Ai=g.forwardRef((e,t)=>{const[n,{as:r="div",bsPrefix:i,spans:o}]=function(e){let{as:t,bsPrefix:n,className:r}=e,i=b(e,Ni);n=Gt(n,"col");const o=Yt(),a=Kt(),s=[],l=[];return o.forEach(e=>{const t=i[e];let r,o,c;delete i[e],"object"===typeof t&&null!=t?({span:r,offset:o,order:c}=t):r=t;const u=e!==a?"-".concat(e):"";r&&s.push(!0===r?"".concat(n).concat(u):"".concat(n).concat(u,"-").concat(r)),null!=c&&l.push("order".concat(u,"-").concat(c)),null!=o&&l.push("offset".concat(u,"-").concat(o))}),[E(E({},i),{},{className:Lt(r,...s,...l)}),{as:t,bsPrefix:n,spans:s}]}(e),{className:a}=n,s=b(n,Ti);return(0,Bt.jsx)(r,E(E({},s),{},{ref:t,className:Lt(a,!o.length&&i)}))});Ai.displayName="Col";const Ri=Ai,ki=["as","bsPrefix","column","visuallyHidden","className","htmlFor"],Mi=g.forwardRef((e,t)=>{let{as:n="label",bsPrefix:r,column:i=!1,visuallyHidden:o=!1,className:a,htmlFor:s}=e,l=b(e,ki);const{controlId:c}=(0,g.useContext)(ii);r=Gt(r,"form-label");let u="col-form-label";"string"===typeof i&&(u="".concat(u," ").concat(u,"-").concat(i));const d=Lt(a,r,o&&"visually-hidden",i&&u);return s=s||c,i?(0,Bt.jsx)(Ri,E({ref:t,as:"label",className:d,htmlFor:s},l)):(0,Bt.jsx)(n,E({ref:t,className:d,htmlFor:s},l))});Mi.displayName="FormLabel";const Di=Mi,_i=["bsPrefix","className","id"],Oi=g.forwardRef((e,t)=>{let{bsPrefix:n,className:r,id:i}=e,o=b(e,_i);const{controlId:a}=(0,g.useContext)(ii);return n=Gt(n,"form-range"),(0,Bt.jsx)("input",E(E({},o),{},{type:"range",ref:t,className:Lt(r,n),id:i||a}))});Oi.displayName="FormRange";const Ii=Oi,Pi=["bsPrefix","size","htmlSize","className","isValid","isInvalid","id"],ji=g.forwardRef((e,t)=>{let{bsPrefix:n,size:r,htmlSize:i,className:o,isValid:a=!1,isInvalid:s=!1,id:l}=e,c=b(e,Pi);const{controlId:u}=(0,g.useContext)(ii);return n=Gt(n,"form-select"),(0,Bt.jsx)("select",E(E({},c),{},{size:i,ref:t,className:Lt(o,n,r&&"".concat(n,"-").concat(r),a&&"is-valid",s&&"is-invalid"),id:l||u}))});ji.displayName="FormSelect";const Fi=ji,Hi=["bsPrefix","className","as","muted"],Li=g.forwardRef((e,t)=>{let{bsPrefix:n,className:r,as:i="small",muted:o}=e,a=b(e,Hi);return n=Gt(n,"form-text"),(0,Bt.jsx)(i,E(E({},a),{},{ref:t,className:Lt(r,n,o&&"text-muted")}))});Li.displayName="FormText";const Bi=Li,zi=g.forwardRef((e,t)=>(0,Bt.jsx)(mi,E(E({},e),{},{ref:t,type:"switch"})));zi.displayName="Switch";const Wi=Object.assign(zi,{Input:mi.Input,Label:mi.Label}),Vi=["bsPrefix","className","children","controlId","label"],Ui=g.forwardRef((e,t)=>{let{bsPrefix:n,className:r,children:i,controlId:o,label:a}=e,s=b(e,Vi);return n=Gt(n,"form-floating"),(0,Bt.jsxs)(Ei,E(E({ref:t,className:Lt(r,n),controlId:o},s),{},{children:[i,(0,Bt.jsx)("label",{htmlFor:o,children:a})]}))});Ui.displayName="FloatingLabel";const qi=Ui,Gi=["className","validated","as"],Yi=g.forwardRef((e,t)=>{let{className:n,validated:r,as:i="form"}=e,o=b(e,Gi);return(0,Bt.jsx)(i,E(E({},o),{},{ref:t,className:Lt(n,r&&"was-validated")}))});Yi.displayName="Form";const Ki=Object.assign(Yi,{Group:Ei,Control:yi,Floating:xi,Check:mi,Switch:Wi,Label:Di,Text:Bi,Range:Ii,Select:Fi,FloatingLabel:qi}),$i=["min","now","max","label","visuallyHidden","striped","animated","className","style","variant","bsPrefix"],Xi=["isChild"],Qi=["min","now","max","label","visuallyHidden","striped","animated","bsPrefix","variant","className","children"];function Ji(e,t,n){const r=(e-t)/(n-t)*100;return Math.round(1e3*r)/1e3}function Zi(e,t){let{min:n,now:r,max:i,label:o,visuallyHidden:a,striped:s,animated:l,className:c,style:u,variant:d,bsPrefix:h}=e,f=b(e,$i);return(0,Bt.jsx)("div",E(E({ref:t},f),{},{role:"progressbar",className:Lt(c,"".concat(h,"-bar"),{["bg-".concat(d)]:d,["".concat(h,"-bar-animated")]:l,["".concat(h,"-bar-striped")]:l||s}),style:E({width:"".concat(Ji(r,n,i),"%")},u),"aria-valuenow":r,"aria-valuemin":n,"aria-valuemax":i,children:a?(0,Bt.jsx)("span",{className:"visually-hidden",children:o}):o}))}const eo=g.forwardRef((e,t)=>{let{isChild:n=!1}=e;const r=E({min:0,max:100,animated:!1,visuallyHidden:!1,striped:!1},b(e,Xi));if(r.bsPrefix=Gt(r.bsPrefix,"progress"),n)return Zi(r,t);const{min:i,now:o,max:a,label:s,visuallyHidden:l,striped:c,animated:u,bsPrefix:d,variant:h,className:f,children:m}=r,p=b(r,Qi);return(0,Bt.jsx)("div",E(E({ref:t},p),{},{className:Lt(f,d),children:m?di(m,e=>(0,g.cloneElement)(e,{isChild:!0})):Zi({min:i,now:o,max:a,label:s,visuallyHidden:l,striped:c,animated:u,bsPrefix:d,variant:h},t)}))});eo.displayName="ProgressBar";const to=eo;let no;function ro(e){if((!no&&0!==no||e)&&Mn){const e=document.createElement("div");e.style.position="absolute",e.style.top="-9999px",e.style.width="50px",e.style.height="50px",e.style.overflow="scroll",document.body.appendChild(e),no=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return no}function io(){return(0,g.useState)(null)}function oo(e){const t=function(e){const t=(0,g.useRef)(e);return t.current=e,t}(e);(0,g.useEffect)(()=>()=>t.current(),[])}function ao(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cn();try{const t=e.activeElement;return t&&t.nodeName?t:null}catch(qb){return e.body}}function so(e,t){return e.contains?e.contains(t):e.compareDocumentPosition?e===t||!!(16&e.compareDocumentPosition(t)):void 0}function lo(e){const t=(0,g.useRef)(null);return(0,g.useEffect)(()=>{t.current=e}),t.current}function co(e){return"".concat("data-rr-ui-").concat(e)}const uo=co("modal-open");const ho=class{constructor(){let{ownerDocument:e,handleContainerOverflow:t=!0,isRTL:n=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.handleContainerOverflow=t,this.isRTL=n,this.modals=[],this.ownerDocument=e}getScrollbarWidth(){return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const t=e.defaultView;return Math.abs(t.innerWidth-e.documentElement.clientWidth)}(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(e){}removeModalAttributes(e){}setContainerStyle(e){const t={overflow:"hidden"},n=this.isRTL?"paddingLeft":"paddingRight",r=this.getElement();e.style={overflow:r.style.overflow,[n]:r.style[n]},e.scrollBarWidth&&(t[n]="".concat(parseInt(kn(r,n)||"0",10)+e.scrollBarWidth,"px")),r.setAttribute(uo,""),kn(r,t)}reset(){[...this.modals].forEach(e=>this.remove(e))}removeContainerStyle(e){const t=this.getElement();t.removeAttribute(uo),Object.assign(t.style,e.style)}add(e){let t=this.modals.indexOf(e);return-1!==t?t:(t=this.modals.length,this.modals.push(e),this.setModalAttributes(e),0!==t||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),t)}remove(e){const t=this.modals.indexOf(e);-1!==t&&(this.modals.splice(t,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(e))}isTopModal(e){return!!this.modals.length&&this.modals[this.modals.length-1]===e}},fo=(0,g.createContext)(Mn?window:void 0);fo.Provider;function mo(){return(0,g.useContext)(fo)}const po=(e,t)=>Mn?null==e?(t||Cn()).body:("function"===typeof e&&(e=e()),e&&"current"in e&&(e=e.current),e&&("nodeType"in e||"getBoundingClientRect"in e)?e:null):null;function go(){const e=(0,g.useRef)(!0),t=(0,g.useRef)(()=>e.current);return(0,g.useEffect)(()=>(e.current=!0,()=>{e.current=!1}),[]),t.current}function vo(e){return"INPUT"===(null==e?void 0:e.tagName)}function yo(e){return!e.disabled&&!((t=e)&&t.matches("fieldset[disabled] *"))&&!(vo(e)&&"hidden"===e.type);var t}function bo(e){return!(vo(e)&&"radio"===e.type&&!function(e){if(!e.name)return!0;const t=e.form||e.ownerDocument,n=Array.from(t.querySelectorAll('input[type="radio"][name="'.concat(escape(e.name),'"]'))),{form:r}=e,i=n.find(e=>e.checked&&e.form===r);return!i||i===e}(e))&&(!(e.tabIndex<0)&&yo(e))}const wo=["input","textarea","select","button","a[href]","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function xo(e){const t=function(e,t){let n=Array.from(e.querySelectorAll(wo));if(t){const e=n.indexOf(t);-1!==e&&(n=n.slice(e))}return n.filter(bo)}(e);return t.length?t:(n=e).matches(wo)&&yo(n)?[e]:[];var n}const So="undefined"!==typeof global&&global.navigator&&"ReactNative"===global.navigator.product,Co="undefined"!==typeof document||So?g.useLayoutEffect:g.useEffect;const Eo=function(e){let{children:t,in:n,onExited:r,mountOnEnter:i,unmountOnExit:o}=e;const a=(0,g.useRef)(null),s=(0,g.useRef)(n),l=an(r);(0,g.useEffect)(()=>{n?s.current=!0:l(a.current)},[n,l]);const c=er(a,Sn(t)),u=(0,g.cloneElement)(t,{ref:c});return n?u:o||!s.current&&i?null:u},No=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];const To=["component"];const Ao=g.forwardRef((e,t)=>{let{component:n}=e,r=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,To);const i=function(e){let{onEnter:t,onEntering:n,onEntered:r,onExit:i,onExiting:o,onExited:a,addEndListener:s,children:l}=e,c=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,No);const u=(0,g.useRef)(null),d=er(u,Sn(l)),h=e=>t=>{e&&u.current&&e(u.current,t)},f=(0,g.useCallback)(h(t),[t]),m=(0,g.useCallback)(h(n),[n]),p=(0,g.useCallback)(h(r),[r]),v=(0,g.useCallback)(h(i),[i]),y=(0,g.useCallback)(h(o),[o]),b=(0,g.useCallback)(h(a),[a]),w=(0,g.useCallback)(h(s),[s]);return Object.assign({},c,{nodeRef:u},t&&{onEnter:f},n&&{onEntering:m},r&&{onEntered:p},i&&{onExit:v},o&&{onExiting:y},a&&{onExited:b},s&&{addEndListener:w},{children:"function"===typeof l?(e,t)=>l(e,Object.assign({},t,{ref:d})):(0,g.cloneElement)(l,{ref:d})})}(r);return(0,Bt.jsx)(n,Object.assign({ref:t},i))});Ao.displayName="RTGTransition";const Ro=Ao;function ko(e){let{children:t,in:n,onExited:r,onEntered:i,transition:o}=e;const[a,s]=(0,g.useState)(!n);n&&a&&s(!1);const l=function(e){let{in:t,onTransition:n}=e;const r=(0,g.useRef)(null),i=(0,g.useRef)(!0),o=an(n);return Co(()=>{if(!r.current)return;let e=!1;return o({in:t,element:r.current,initial:i.current,isStale:()=>e}),()=>{e=!0}},[t,o]),Co(()=>(i.current=!1,()=>{i.current=!0}),[]),r}({in:!!n,onTransition:e=>{Promise.resolve(o(e)).then(()=>{e.isStale()||(e.in?null==i||i(e.element,e.initial):(s(!0),null==r||r(e.element)))},t=>{throw e.in||s(!0),t})}}),c=er(l,Sn(t));return a&&!n?null:(0,g.cloneElement)(t,{ref:c})}function Mo(e,t,n){return e?(0,Bt.jsx)(Ro,Object.assign({},n,{component:e})):t?(0,Bt.jsx)(ko,Object.assign({},n,{transition:t})):(0,Bt.jsx)(Eo,Object.assign({},n))}const Do=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","mountDialogOnEnter","unmountDialogOnExit","portal","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];let _o;function Oo(e){const t=mo(),n=e||function(e){return _o||(_o=new ho({ownerDocument:null==e?void 0:e.document})),_o}(t),r=(0,g.useRef)({dialog:null,backdrop:null});return Object.assign(r.current,{add:()=>n.add(r.current),remove:()=>n.remove(r.current),isTopModal:()=>n.isTopModal(r.current),setDialogRef:(0,g.useCallback)(e=>{r.current.dialog=e},[]),setBackdropRef:(0,g.useCallback)(e=>{r.current.backdrop=e},[])})}const Io=(0,g.forwardRef)((e,t)=>{let{show:n=!1,role:r="dialog",className:i,style:o,children:a,backdrop:s=!0,keyboard:l=!0,onBackdropClick:c,onEscapeKeyDown:u,transition:d,runTransition:h,backdropTransition:f,runBackdropTransition:m,autoFocus:p=!0,enforceFocus:v=!0,restoreFocus:y=!0,restoreFocusOptions:b,mountDialogOnEnter:w=!0,unmountDialogOnExit:x=!0,portal:S=!0,renderDialog:C,renderBackdrop:E=e=>(0,Bt.jsx)("div",Object.assign({},e)),manager:N,container:T,onShow:A,onHide:R=()=>{},onExit:k,onExited:M,onExiting:D,onEnter:_,onEntering:O,onEntered:I}=e,P=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,Do);const j=mo(),F=function(e,t){const n=mo(),[r,i]=(0,g.useState)(()=>po(e,null==n?void 0:n.document));if(!r){const t=po(e);t&&i(t)}return(0,g.useEffect)(()=>{t&&r&&t(r)},[t,r]),(0,g.useEffect)(()=>{const t=po(e);t!==r&&i(t)},[e,r]),r}(T),H=Oo(N),L=lo(n),[B,z]=(0,g.useState)(!n),W=(0,g.useRef)(null),V=(0,g.useRef)(null),U=function(e){let{getContainer:t,disabled:n}=e;const r=mo(),i=go(),o=(0,g.useRef)(new Set),a=an(e=>{const r=t();if("Tab"!==e.key||!r||null!=n&&n())return;const i=xo(r),o=i[0],a=i[i.length-1];if(e.shiftKey&&e.target===i[0])return null==a||a.focus(),void e.preventDefault();(e.shiftKey||e.target!==a)&&r.contains(e.target)||(null==o||o.focus(),e.preventDefault())}),s=an(e=>{if(null!=n&&n())return;const i=t(),o=ao(null==r?void 0:r.document);var a;i&&o&&!i.contains(o)&&(null==(a=xo(i)[0])||a.focus())}),l=(0,g.useCallback)(()=>{const e=null==r?void 0:r.document;function t(e){setTimeout(()=>s(e))}r&&e&&i()&&(r.addEventListener("focus",t,{capture:!0}),e.addEventListener("keydown",a),o.current.add(()=>{r.removeEventListener("focus",t,{capture:!0}),e.removeEventListener("keydown",a)}))},[s]),c=(0,g.useCallback)(()=>{o.current.forEach(e=>e()),o.current.clear()},[]);return(0,g.useMemo)(()=>({start:l,stop:c}),[l,c])}({getContainer:()=>H.dialog,disabled:()=>!v||!H.isTopModal()});(0,g.useImperativeHandle)(t,()=>H,[H]),Mn&&!L&&n&&(V.current=ao(null==j?void 0:j.document)),n&&B&&z(!1);const q=an(()=>{if(H.add(),W.current=Pn(document,"keydown",K),U.start(),A&&A(),p){var e,t;const r=ao(null!=(e=null==(t=H.dialog)?void 0:t.ownerDocument)?e:null==j?void 0:j.document);if(H.dialog&&r&&!so(H.dialog,r)){var n;V.current=r;null==(n=xo(H.dialog)[0])||n.focus()}}}),G=an(()=>{var e;(H.remove(),null==W.current||W.current(),U.stop(),y)&&(null==(e=V.current)||null==e.focus||e.focus(b),V.current=null)});(0,g.useEffect)(()=>{!n||!F&&S||q()},[n,F,S,q]),(0,g.useEffect)(()=>{B&&G()},[B,G]),oo(()=>{G()});const Y=an(e=>{e.target===e.currentTarget&&(null==c||c(e),!0===s&&R())}),K=an(e=>{l&&function(e){return"Escape"===e.code||27===e.keyCode}(e)&&H.isTopModal()&&(null==u||u(e),e.defaultPrevented||R())});if(!F&&S)return null;const $=Object.assign({role:n?r:void 0,ref:H.setDialogRef,"aria-modal":!(!n||"dialog"!==r)||void 0},P,{style:o,className:i,tabIndex:-1});let X=C?C($):(0,Bt.jsx)("div",Object.assign({},$,{children:g.cloneElement(a,{role:"document"})}));X=Mo(d,h,{unmountOnExit:x,mountOnEnter:w,appear:!0,in:!!n,onExit:k,onExiting:D,onExited:function(){z(!0),null==M||M(...arguments)},onEnter:_,onEntering:O,onEntered:I,children:X});let Q=null;return s&&(Q=E({ref:H.setBackdropRef,onClick:Y}),Q=Mo(f,m,{in:!!n,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:Q})),S&&F?Wn.createPortal((0,Bt.jsxs)(Bt.Fragment,{children:[Q,X]}),F):(0,Bt.jsxs)(Bt.Fragment,{children:[Q,X]})});Io.displayName="Modal";const Po=Object.assign(Io,{Manager:ho}),jo=Function.prototype.bind.call(Function.prototype.call,[].slice);function Fo(e,t){return jo(e.querySelectorAll(t))}const Ho=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Lo=".sticky-top",Bo=".navbar-toggler";class zo extends ho{adjustAndStore(e,t,n){const r=t.style[e];t.dataset[e]=r,kn(t,{[e]:"".concat(parseFloat(kn(t,e))+n,"px")})}restore(e,t){const n=t.dataset[e];void 0!==n&&(delete t.dataset[e],kn(t,{[e]:n}))}setContainerStyle(e){super.setContainerStyle(e);const t=this.getElement();if(t.classList.add("modal-open"),!e.scrollBarWidth)return;const n=this.isRTL?"paddingLeft":"paddingRight",r=this.isRTL?"marginLeft":"marginRight";Fo(t,Ho).forEach(t=>this.adjustAndStore(n,t,e.scrollBarWidth)),Fo(t,Lo).forEach(t=>this.adjustAndStore(r,t,-e.scrollBarWidth)),Fo(t,Bo).forEach(t=>this.adjustAndStore(r,t,e.scrollBarWidth))}removeContainerStyle(e){super.removeContainerStyle(e);const t=this.getElement();t.classList.remove("modal-open");const n=this.isRTL?"paddingLeft":"paddingRight",r=this.isRTL?"marginLeft":"marginRight";Fo(t,Ho).forEach(e=>this.restore(n,e)),Fo(t,Lo).forEach(e=>this.restore(r,e)),Fo(t,Bo).forEach(e=>this.restore(r,e))}}let Wo;function Vo(e){return Wo||(Wo=new zo(e)),Wo}const Uo=zo,qo=["className","bsPrefix","as"],Go=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i="div"}=e,o=b(e,qo);return r=Gt(r,"modal-body"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r)},o))});Go.displayName="ModalBody";const Yo=Go,Ko=g.createContext({onHide(){}});Ko.displayName="ModalContext";const $o=Ko,Xo=["bsPrefix","className","contentClassName","centered","size","fullscreen","children","scrollable"],Qo=g.forwardRef((e,t)=>{let{bsPrefix:n,className:r,contentClassName:i,centered:o,size:a,fullscreen:s,children:l,scrollable:c}=e,u=b(e,Xo);n=Gt(n,"modal");const d="".concat(n,"-dialog"),h="string"===typeof s?"".concat(n,"-fullscreen-").concat(s):"".concat(n,"-fullscreen");return(0,Bt.jsx)("div",E(E({},u),{},{ref:t,className:Lt(d,r,a&&"".concat(n,"-").concat(a),o&&"".concat(d,"-centered"),c&&"".concat(d,"-scrollable"),s&&h),children:(0,Bt.jsx)("div",{className:Lt("".concat(n,"-content"),i),children:l})}))});Qo.displayName="ModalDialog";const Jo=Qo,Zo=["className","bsPrefix","as"],ea=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i="div"}=e,o=b(e,Zo);return r=Gt(r,"modal-footer"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r)},o))});ea.displayName="ModalFooter";const ta=ea,na=["closeLabel","closeVariant","closeButton","onHide","children"],ra=g.forwardRef((e,t)=>{let{closeLabel:n="Close",closeVariant:r,closeButton:i=!1,onHide:o,children:a}=e,s=b(e,na);const l=(0,g.useContext)($o),c=an(()=>{null==l||l.onHide(),null==o||o()});return(0,Bt.jsxs)("div",E(E({ref:t},s),{},{children:[a,i&&(0,Bt.jsx)(ur,{"aria-label":n,variant:r,onClick:c})]}))});ra.displayName="AbstractModalHeader";const ia=ra,oa=["bsPrefix","className","closeLabel","closeButton"],aa=g.forwardRef((e,t)=>{let{bsPrefix:n,className:r,closeLabel:i="Close",closeButton:o=!1}=e,a=b(e,oa);return n=Gt(n,"modal-header"),(0,Bt.jsx)(ia,E(E({ref:t},a),{},{className:Lt(r,n),closeLabel:i,closeButton:o}))});aa.displayName="ModalHeader";const sa=aa,la=["className","bsPrefix","as"],ca=sn("h4"),ua=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i=ca}=e,o=b(e,la);return r=Gt(r,"modal-title"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r)},o))});ua.displayName="ModalTitle";const da=ua,ha=["bsPrefix","className","style","dialogClassName","contentClassName","children","dialogAs","data-bs-theme","aria-labelledby","aria-describedby","aria-label","show","animation","backdrop","keyboard","onEscapeKeyDown","onShow","onHide","container","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","onEntered","onExit","onExiting","onEnter","onEntering","onExited","backdropClassName","manager"];function fa(e){return(0,Bt.jsx)(sr,E(E({},e),{},{timeout:null}))}function ma(e){return(0,Bt.jsx)(sr,E(E({},e),{},{timeout:null}))}const pa=g.forwardRef((e,t)=>{let{bsPrefix:n,className:r,style:i,dialogClassName:o,contentClassName:a,children:s,dialogAs:l=Jo,"data-bs-theme":c,"aria-labelledby":u,"aria-describedby":d,"aria-label":h,show:f=!1,animation:m=!0,backdrop:p=!0,keyboard:v=!0,onEscapeKeyDown:y,onShow:w,onHide:x,container:S,autoFocus:C=!0,enforceFocus:N=!0,restoreFocus:T=!0,restoreFocusOptions:A,onEntered:R,onExit:k,onExiting:M,onEnter:D,onEntering:_,onExited:O,backdropClassName:I,manager:P}=e,j=b(e,ha);const[F,H]=(0,g.useState)({}),[L,B]=(0,g.useState)(!1),z=(0,g.useRef)(!1),W=(0,g.useRef)(!1),V=(0,g.useRef)(null),[U,q]=io(),G=er(t,q),Y=an(x),K=$t();n=Gt(n,"modal");const $=(0,g.useMemo)(()=>({onHide:Y}),[Y]);function X(){return P||Vo({isRTL:K})}function Q(e){if(!Mn)return;const t=X().getScrollbarWidth()>0,n=e.scrollHeight>Cn(e).documentElement.clientHeight;H({paddingRight:t&&!n?ro():void 0,paddingLeft:!t&&n?ro():void 0})}const J=an(()=>{U&&Q(U.dialog)});oo(()=>{window.removeEventListener("resize",J),null==V.current||V.current()});const Z=()=>{z.current=!0},ee=e=>{z.current&&U&&e.target===U.dialog&&(W.current=!0),z.current=!1},te=()=>{B(!0),V.current=Fn(U.dialog,()=>{B(!1)})},ne=e=>{"static"!==p?W.current||e.target!==e.currentTarget?W.current=!1:null==x||x():(e=>{e.target===e.currentTarget&&te()})(e)},re=(0,g.useCallback)(e=>(0,Bt.jsx)("div",E(E({},e),{},{className:Lt("".concat(n,"-backdrop"),I,!m&&"show")})),[m,I,n]),ie=E(E({},i),F);ie.display="block";return(0,Bt.jsx)($o.Provider,{value:$,children:(0,Bt.jsx)(Po,{show:f,ref:G,backdrop:p,container:S,keyboard:!0,autoFocus:C,enforceFocus:N,restoreFocus:T,restoreFocusOptions:A,onEscapeKeyDown:e=>{v?null==y||y(e):(e.preventDefault(),"static"===p&&te())},onShow:w,onHide:x,onEnter:(e,t)=>{e&&Q(e),null==D||D(e,t)},onEntering:(e,t)=>{null==_||_(e,t),window.addEventListener("resize",J)},onEntered:R,onExit:e=>{null==V.current||V.current(),null==k||k(e)},onExiting:M,onExited:e=>{e&&(e.style.display=""),null==O||O(e),window.removeEventListener("resize",J)},manager:X(),transition:m?fa:void 0,backdropTransition:m?ma:void 0,renderBackdrop:re,renderDialog:e=>(0,Bt.jsx)("div",E(E({role:"dialog"},e),{},{style:ie,className:Lt(r,n,L&&"".concat(n,"-static"),!m&&"show"),onClick:p?ne:void 0,onMouseUp:ee,"data-bs-theme":c,"aria-label":h,"aria-labelledby":u,"aria-describedby":d,children:(0,Bt.jsx)(l,E(E({},j),{},{onMouseDown:Z,className:o,contentClassName:a,children:s}))}))})})});pa.displayName="Modal";const ga=Object.assign(pa,{Body:Yo,Header:sa,Title:da,Footer:ta,Dialog:Jo,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150}),va=()=>{const[e,t]=(0,g.useState)(""),[n,r]=(0,g.useState)(""),[i,o]=(0,g.useState)(!1),[a,s]=(0,g.useState)(null),[l,c]=(0,g.useState)(!1),[u,d]=(0,g.useState)(""),[h,f]=(0,g.useState)(""),[m,p]=(0,g.useState)(""),[v,y]=(0,g.useState)(""),[b,w]=(0,g.useState)(!1),[x,S]=(0,g.useState)(!1),[C,E]=(0,g.useState)([]),[N,T]=(0,g.useState)(""),[A,R]=(0,g.useState)(0),[k,M]=(0,g.useState)(!1),D=(0,g.useRef)(!1),_=(0,g.useRef)(null),O=(0,g.useRef)(null);(0,g.useEffect)(()=>{const e=()=>{S(window.innerWidth<=768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const I=()=>{c(!0)},P=(0,g.useCallback)(async()=>{if(n)try{o(!0);const e=await fetch(n,{method:"GET",mode:"cors"});if(!e.ok)throw new Error("Failed to fetch image: ".concat(e.status," ").concat(e.statusText));const t=await e.blob(),r=e.headers.get("content-type")||"image/png";let i="png";r.includes("jpeg")||r.includes("jpg")?i="jpg":r.includes("webp")?i="webp":r.includes("gif")&&(i="gif");const l=window.URL.createObjectURL(t),c=document.createElement("a");c.href=l;const u=(new Date).toISOString().slice(0,19).replace(/[:.]/g,"-"),d=v?"_".concat(h.replace(" ",""),"_").concat(m,"sqft"):"";c.download="room-plan".concat(d,"_").concat(u,".").concat(i),document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(l);const f=a;s("\u2705 Image downloaded successfully as ".concat(c.download)),setTimeout(()=>s(f),3e3)}catch(e){console.error("Download error:",e),s("Error downloading image: "+(e.message||"Unknown error"))}finally{o(!1)}},[n,v,h,m,a]),j=(0,g.useCallback)(()=>{_.current&&(_.current.abort(),_.current=null),O.current&&(clearInterval(O.current),O.current=null),o(!1),w(!1),R(0),T(""),s("Image generation cancelled by user"),console.log("Image generation cancelled by user")},[]);(0,g.useEffect)(()=>{const e=e=>{(e.ctrlKey||e.metaKey)&&"s"===e.key&&l&&n&&(e.preventDefault(),P())};if(l)return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[l,n,P]),(0,g.useEffect)(()=>()=>{_.current&&_.current.abort(),O.current&&clearInterval(O.current)},[]);const F=(0,g.useCallback)(async()=>{if(D.current)console.log("BHK processing already in progress, skipping...");else{D.current=!0,o(!0),s(null),y("");try{if(!h||!m)throw new Error("Please select BHK type and area value");const t=parseFloat(m);if(isNaN(t)||t<=0)throw new Error("Please select a valid area value");const n=await fetch("".concat("/SalmanWipro-directory","/BHKPrompt/bhk_info.json"));if(!n.ok)throw new Error("Failed to load BHK data: ".concat(n.status," ").concat(n.statusText));let r;try{r=await n.json()}catch(e){throw new Error("Invalid BHK data format. Please check the JSON file.")}if(!r.real_estate_configurations||!Array.isArray(r.real_estate_configurations))throw new Error("Invalid BHK data structure. Missing configurations.");const i=r.real_estate_configurations.find(e=>e.type===h&&e.total_carpet_area_sqft===t);if(!i)throw new Error("No exact configuration found for ".concat(h," with ").concat(t," sq ft area"));const o=h.charAt(0),a="BHK".concat(o,".").concat("1"===o?"text":"txt"),s=await fetch("".concat("/SalmanWipro-directory","/BHKPrompt/").concat(a));if(!s.ok)throw new Error("Failed to load template file ".concat(a,": ").concat(s.status," ").concat(s.statusText));let l=await s.text();if(!l||""===l.trim())throw new Error("Template file ".concat(a," is empty or corrupted"));let c=l;c=c.replace(/{total_carpet_area_sqft}/g,t.toString()),console.log("Available rooms in configuration:",i.rooms.map(e=>e.name));const u={"living room":i.rooms.find(e=>e.name.toLowerCase().includes("living")),kitchen:i.rooms.find(e=>e.name.toLowerCase().includes("kitchen")),bathroom:i.rooms.find(e=>e.name.toLowerCase().includes("bathroom")),balcony:i.rooms.find(e=>e.name.toLowerCase().includes("balcony")),store:i.rooms.find(e=>e.name.toLowerCase().includes("store")),utility:i.rooms.find(e=>e.name.toLowerCase().includes("store")||e.name.toLowerCase().includes("utility"))};console.log("Room mappings found:",Object.entries(u).map(e=>{let[t,n]=e;return{key:t,found:!!n,roomName:null===n||void 0===n?void 0:n.name,dimensions:null===n||void 0===n?void 0:n.dimensions_ft}})),Object.entries(u).forEach(e=>{let[t,n]=e;if(n&&n.dimensions_ft){const e="".concat(n.dimensions_ft.length," x ").concat(n.dimensions_ft.width);[t,t.charAt(0).toUpperCase()+t.slice(1),t.toUpperCase(),t.replace(/\s+/g,""),t.replace(/\s+/g,"").charAt(0).toUpperCase()+t.replace(/\s+/g,"").slice(1)].forEach(t=>{const n=new RegExp("{".concat(t,"}"),"gi"),r=c;c=c.replace(n,e),r!==c&&console.log("Successfully replaced {".concat(t,"} with ").concat(e))})}else console.warn("No room found for mapping: ".concat(t))}),i.rooms.forEach(e=>{const t=e.name,n=e.dimensions_ft;if(!n||"number"!==typeof n.length||"number"!==typeof n.width)return void console.warn("Invalid dimensions for room: ".concat(t));const r="".concat(n.length," x ").concat(n.width);[new RegExp("{".concat(t,"}"),"gi"),new RegExp("{".concat(t.toLowerCase(),"}"),"gi"),new RegExp("{".concat(t.toLowerCase().replace(/\s+/g," "),"}"),"gi"),new RegExp("{".concat(t.toLowerCase().replace(/\s+/g,""),"}"),"gi")].forEach(e=>{const n=c;c=c.replace(e,r),n!==c&&console.log("Successfully replaced ".concat(e.source," with ").concat(r," for room: ").concat(t))})}),c===l&&console.warn("No variable replacements were made. Check if template variables match room names."),y(c)}catch(t){s("Error processing BHK data: "+(t.message||"Unknown error")),console.error("BHK Processing Error:",t)}finally{o(!1),D.current=!1}}},[h,m]);(0,g.useEffect)(()=>{(async e=>{try{const t=await fetch("".concat("/SalmanWipro-directory","/BHKPrompt/bhk_info.json"));if(!t.ok)return void console.error("Failed to load BHK data for areas");const n=await t.json();if(!n.real_estate_configurations||!Array.isArray(n.real_estate_configurations))return void console.error("Invalid BHK data structure");const r=n.real_estate_configurations.filter(t=>t.type===e).map(e=>e.total_carpet_area_sqft).sort((e,t)=>e-t);E(r),r.length>0?p(r[0].toString()):p("")}catch(t){console.error("Error loading available areas:",t),E([]),p("")}})(h)},[h]),(0,g.useEffect)(()=>{h&&m&&y("");const e=setTimeout(async()=>{if(h&&m&&!D.current&&C.length>0)try{console.log("Auto-processing BHK:",h,m),await F()}catch(a){console.error("Auto BHK processing failed:",a)}},500);return()=>clearTimeout(e)},[h,m,C,F]);const H=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{console.log("Attempting to download image as blob:",e);const r=[{mode:"cors",headers:{Accept:"image/*"},signal:t},{mode:"no-cors",signal:t},{signal:t}];for(let t=0;t<r.length;t++)try{console.log("Trying fetch config ".concat(t+1,":"),r[t]);const n=await fetch(e,r[t]);if(console.log("Response status: ".concat(n.status,", type: ").concat(n.type)),404===n.status)throw new Error("404 - Service endpoint not found");if(!n.ok&&"opaque"!==n.type)throw new Error("HTTP ".concat(n.status,": ").concat(n.statusText));{const e=await n.blob();if(e.size>0){const t=URL.createObjectURL(e);return console.log("Successfully created blob URL:",t,"Size:",e.size),t}console.warn("Blob size is 0, trying next config...")}}catch(n){console.warn("Fetch config ".concat(t+1," failed:"),n)}throw new Error("All fetch configurations failed")}catch(a){throw console.error("Failed to download image as blob:",a),a}},L=e=>{{const t=["https://api.allorigins.win/raw?url=".concat(encodeURIComponent(e)),"https://corsproxy.io/?".concat(encodeURIComponent(e)),"https://cors-anywhere.herokuapp.com/".concat(e),e];return console.log("Production mode: Using CORS proxy with Access-Control-Allow-Origin"),console.log("Available proxies:",t),t[0]}};return(0,Bt.jsxs)("div",{style:{maxWidth:600,margin:"2rem auto",padding:x?16:24,background:"#fafafa",borderRadius:12,boxShadow:"0 2px 8px rgba(33,150,243,0.07)",width:x?"calc(100% - 20px)":"auto"},children:[(0,Bt.jsx)("h3",{style:{textAlign:"center",color:"#1976d2",fontWeight:700},children:"Plan Generation"}),(0,Bt.jsxs)("div",{style:{marginBottom:"2rem",padding:"1rem",background:"#e8f4fd",borderRadius:8,border:"1px solid #2196f3"},children:[(0,Bt.jsxs)("h5",{style:{color:"#1976d2",marginBottom:"1rem"},children:["BHK Configuration",h&&m&&(0,Bt.jsx)("small",{style:{color:"#4caf50",fontWeight:"normal",fontSize:"0.8em",marginLeft:"8px"},children:"\u2713 Auto-processing enabled"})]}),(0,Bt.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"end",flexWrap:"wrap"},children:[(0,Bt.jsxs)(Ki.Group,{style:{minWidth:"120px"},children:[(0,Bt.jsx)(Ki.Label,{children:"BHK Type"}),(0,Bt.jsxs)(Ki.Select,{value:h,onChange:e=>f(e.target.value),style:{background:"white"},children:[(0,Bt.jsx)("option",{value:"",children:"Select BHK Type"}),(0,Bt.jsx)("option",{value:"1 BHK",children:"1 BHK"}),(0,Bt.jsx)("option",{value:"2 BHK",children:"2 BHK"}),(0,Bt.jsx)("option",{value:"3 BHK",children:"3 BHK"}),(0,Bt.jsx)("option",{value:"4 BHK",children:"4 BHK"})]})]}),(0,Bt.jsxs)(Ki.Group,{style:{minWidth:"120px"},children:[(0,Bt.jsx)(Ki.Label,{children:"Area (sq ft)"}),(0,Bt.jsxs)(Ki.Select,{value:m,onChange:e=>p(e.target.value),style:{background:"white"},disabled:0===C.length,children:[(0,Bt.jsx)("option",{value:"",children:0===C.length?"Loading areas...":"Select Area (sq ft)"}),C.length>0&&C.map(e=>(0,Bt.jsxs)("option",{value:e,children:[e," sq ft"]},e))]})]})]})]}),(0,Bt.jsxs)(Ki.Group,{className:"mb-3",children:[(0,Bt.jsxs)(Ki.Label,{children:["Prompt (multiline)",h&&m&&v&&(0,Bt.jsxs)("small",{style:{color:"#4caf50",fontWeight:"normal",fontSize:"0.8em",marginLeft:"8px"},children:["\u2713 Auto-generated from ",h," - ",m," sq ft"]})]}),(0,Bt.jsx)(Ki.Control,{as:"textarea",rows:6,value:v||e,onChange:e=>{v?y(e.target.value):t(e.target.value)},style:{fontFamily:"monospace",fontSize:"1rem",background:"#f4f4f4",borderRadius:8,border:"1px solid #ccc",padding:8}})]}),b&&(0,Bt.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,Bt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[(0,Bt.jsx)(Ki.Label,{style:{margin:0,fontWeight:600,color:"#1976d2"},children:N||"Generating Room Plan..."}),(0,Bt.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,Bt.jsxs)("small",{style:{color:"#666",fontWeight:600},children:[Math.round(A),"%"]}),(0,Bt.jsx)(gr,{variant:"outline-danger",size:"sm",onClick:j,style:{fontSize:"0.75rem",padding:"2px 8px"},children:"Cancel"})]})]}),(0,Bt.jsx)(to,{now:Math.round(A),variant:100===A?"success":"primary",style:{height:"12px",borderRadius:"6px"},animated:A<100,striped:A<100}),(0,Bt.jsx)("small",{style:{color:"#666",fontSize:"0.85em",marginTop:"0.5rem",display:"block"},children:A<20?"Preparing your request...":A<40?"Processing your prompt...":A<60?"Connecting to AI service...":A<80?"AI is generating your room plan...":A<95?"Rendering your image...":100===A?"Complete! Your room plan is ready.":"Almost done, finalizing your room plan..."})]}),(0,Bt.jsx)("div",{style:{textAlign:"center",marginBottom:"1rem"},children:b?(0,Bt.jsxs)("div",{style:{display:"flex",justifyContent:"center",gap:"10px",alignItems:"center"},children:[(0,Bt.jsx)(gr,{variant:"primary",disabled:!0,style:{minWidth:120,fontWeight:600},children:"Generating..."}),(0,Bt.jsx)(gr,{variant:"outline-danger",onClick:j,style:{fontWeight:600},children:"Cancel Generation"})]}):(0,Bt.jsx)(gr,{variant:"primary",onClick:async function(){_.current&&_.current.abort(),_.current=new AbortController,o(!0),w(!0),s(null),r(""),R(0),M(!1),O.current=setInterval(()=>{R(e=>e>=95?95:e+3*Math.random()+1)},200);try{var t,n;if(null!==(t=_.current)&&void 0!==t&&t.signal.aborted)throw new Error("Generation cancelled");const o=v||e;if(!o.trim())throw O.current&&clearInterval(O.current),new Error("Please enter a prompt or process BHK configuration first");const s=o.replace(/[^\w\s-.]/g," ").replace(/\s+/g," ").trim().substring(0,200),h=encodeURIComponent(s);T("Generating image...");const f="https://image.pollinations.ai/prompt/".concat(h,"?model=nanobanana");if(console.log("Direct Image URL:",f),null!==(n=_.current)&&void 0!==n&&n.signal.aborted)throw new Error("Generation cancelled");try{var i;const e=await H(f,null===(i=_.current)||void 0===i?void 0:i.signal);r(e),T("Image generated successfully!")}catch(u){var a;if("AbortError"===u.name||null!==(a=_.current)&&void 0!==a&&a.signal.aborted)throw new Error("Generation cancelled");console.warn("Direct URL failed, trying CORS proxy:",u.message),T("Trying CORS proxy...");const e=L(f);console.log("Proxy URL:",e);try{var l;const t=await H(e,null===(l=_.current)||void 0===l?void 0:l.signal);r(t),T("Image loaded via proxy!")}catch(d){var c;if("AbortError"===d.name||null!==(c=_.current)&&void 0!==c&&c.signal.aborted)throw new Error("Generation cancelled");throw new Error("Both direct and proxy methods failed: ".concat(d.message))}}}catch(h){O.current&&clearInterval(O.current),console.error("Image generation error:",h),s("Error generating image: "+(h.message||"Unknown error")),r("")}},disabled:i,style:{minWidth:120,fontWeight:600},children:"Get Room Plan"})}),a&&(0,Bt.jsx)("div",{style:{color:"red",marginTop:"1rem"},children:a}),n&&(0,Bt.jsxs)("div",{style:{marginTop:"2rem",textAlign:"center"},children:[(0,Bt.jsx)("img",{src:n,alt:"Generated",onLoad:()=>{M(!0),R(100),T("Complete! Your room plan is ready."),setTimeout(()=>{w(!1),T(""),R(0),o(!1)},1500)},onError:e=>{console.error("Image load error:",e),console.error("Failed image URL:",n),M(!1),R(0),w(!1),o(!1),s("Failed to load image. Please try again.")},style:{width:"100%",height:"400px",objectFit:"contain",borderRadius:8,boxShadow:"0 2px 8px rgba(33,150,243,0.10)",cursor:"pointer",touchAction:"manipulation"},onDoubleClick:I,onClick:e=>{x&&I()}}),(0,Bt.jsx)("p",{style:{fontSize:"0.9rem",color:"#666",marginTop:"0.5rem"},children:x?"Tap to view in full screen":"Double-click to view in full screen"}),(0,Bt.jsx)("div",{style:{marginTop:"1rem",display:"flex",justifyContent:"center",gap:"10px"},children:(0,Bt.jsx)(gr,{variant:"outline-primary",size:"sm",onClick:P,disabled:i,style:{minWidth:"120px"},children:i?"Downloading...":"\ud83d\udce5 Download HD"})}),(0,Bt.jsxs)(ga,{show:l,onHide:()=>c(!1),fullscreen:!0,backdrop:"static",keyboard:!0,children:[(0,Bt.jsxs)(ga.Header,{closeButton:!0,style:{background:"#e3f2fd",borderBottom:"1px solid #1976d2",position:"relative",zIndex:1050,display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 1rem",minHeight:"50px"},children:[(0,Bt.jsx)(ga.Title,{style:{fontWeight:700,color:"#1976d2"},children:"Generated Image"}),(0,Bt.jsx)(gr,{variant:"primary",size:"sm",onClick:P,disabled:i,style:{marginRight:"40px"},children:i?"Downloading...":"\ud83d\udce5 Download HD"})]}),(0,Bt.jsxs)(ga.Body,{style:{background:"#000",display:"flex",justifyContent:"center",alignItems:"center",padding:"2vh 2vw",minHeight:"calc(100vh - 50px)",overflow:"hidden",position:"relative"},children:[(0,Bt.jsx)("img",{src:n,alt:"Large Generated",style:{maxWidth:"96vw",maxHeight:"calc(96vh - 50px)",width:"auto",height:"auto",objectFit:"contain",borderRadius:0,boxShadow:"none",cursor:"pointer"},onClick:()=>c(!1)}),(0,Bt.jsxs)("div",{style:{position:"absolute",bottom:"20px",left:"50%",transform:"translateX(-50%)",color:"white",fontSize:"0.9rem",textAlign:"center",background:"rgba(0,0,0,0.7)",padding:"8px 16px",borderRadius:"20px",pointerEvents:"none"},children:[(0,Bt.jsx)("div",{children:x?"Tap image to close":"Click image to close"}),!x&&(0,Bt.jsx)("div",{style:{fontSize:"0.8rem",marginTop:"4px",opacity:.8},children:"Press Ctrl+S to download"})]})]})]})]}),u&&(0,Bt.jsxs)("div",{style:{marginTop:"2rem"},children:[(0,Bt.jsx)(Ki.Label,{children:"Generated Text"}),(0,Bt.jsx)(Ki.Control,{as:"textarea",value:u,readOnly:!0,rows:6,style:{width:"100%",fontFamily:"monospace",fontSize:"1rem",background:"#f4f4f4",borderRadius:8,border:"1px solid #ccc",padding:8}})]})]})};function ya(){const[,e]=(0,g.useReducer)(e=>e+1,0);return e}function ba(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=an(n);(0,g.useEffect)(()=>{const n="function"===typeof e?e():e;return n.addEventListener(t,i,r),()=>n.removeEventListener(t,i,r)},[e])}const wa=g.createContext(null);var xa=Object.prototype.hasOwnProperty;function Sa(e,t,n){for(n of e.keys())if(Ca(n,t))return n}function Ca(e,t){var n,r,i;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((r=e.length)===t.length)for(;r--&&Ca(e[r],t[r]););return-1===r}if(n===Set){if(e.size!==t.size)return!1;for(r of e){if((i=r)&&"object"===typeof i&&!(i=Sa(t,i)))return!1;if(!t.has(i))return!1}return!0}if(n===Map){if(e.size!==t.size)return!1;for(r of e){if((i=r[0])&&"object"===typeof i&&!(i=Sa(t,i)))return!1;if(!Ca(r[1],t.get(i)))return!1}return!0}if(n===ArrayBuffer)e=new Uint8Array(e),t=new Uint8Array(t);else if(n===DataView){if((r=e.byteLength)===t.byteLength)for(;r--&&e.getInt8(r)===t.getInt8(r););return-1===r}if(ArrayBuffer.isView(e)){if((r=e.byteLength)===t.byteLength)for(;r--&&e[r]===t[r];);return-1===r}if(!n||"object"===typeof e){for(n in r=0,e){if(xa.call(e,n)&&++r&&!xa.call(t,n))return!1;if(!(n in t)||!Ca(e[n],t[n]))return!1}return Object.keys(t).length===r}}return e!==e&&t!==t}const Ea=function(e){const t=go();return[e[0],(0,g.useCallback)(n=>{if(t())return e[1](n)},[t,e[1]])]};var Na="top",Ta="bottom",Aa="right",Ra="left",ka="auto",Ma=[Na,Ta,Aa,Ra],Da="start",_a="end",Oa="viewport",Ia="popper",Pa=Ma.reduce(function(e,t){return e.concat([t+"-"+Da,t+"-"+_a])},[]),ja=[].concat(Ma,[ka]).reduce(function(e,t){return e.concat([t,t+"-"+Da,t+"-"+_a])},[]),Fa=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function Ha(e){return e.split("-")[0]}function La(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Ba(e){return e instanceof La(e).Element||e instanceof Element}function za(e){return e instanceof La(e).HTMLElement||e instanceof HTMLElement}function Wa(e){return"undefined"!==typeof ShadowRoot&&(e instanceof La(e).ShadowRoot||e instanceof ShadowRoot)}var Va=Math.max,Ua=Math.min,qa=Math.round;function Ga(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Ya(){return!/^((?!chrome|android).)*safari/i.test(Ga())}function Ka(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r=e.getBoundingClientRect(),i=1,o=1;t&&za(e)&&(i=e.offsetWidth>0&&qa(r.width)/e.offsetWidth||1,o=e.offsetHeight>0&&qa(r.height)/e.offsetHeight||1);var a=(Ba(e)?La(e):window).visualViewport,s=!Ya()&&n,l=(r.left+(s&&a?a.offsetLeft:0))/i,c=(r.top+(s&&a?a.offsetTop:0))/o,u=r.width/i,d=r.height/o;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l,x:l,y:c}}function $a(e){var t=Ka(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function Xa(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&Wa(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Qa(e){return e?(e.nodeName||"").toLowerCase():null}function Ja(e){return La(e).getComputedStyle(e)}function Za(e){return["table","td","th"].indexOf(Qa(e))>=0}function es(e){return((Ba(e)?e.ownerDocument:e.document)||window.document).documentElement}function ts(e){return"html"===Qa(e)?e:e.assignedSlot||e.parentNode||(Wa(e)?e.host:null)||es(e)}function ns(e){return za(e)&&"fixed"!==Ja(e).position?e.offsetParent:null}function rs(e){for(var t=La(e),n=ns(e);n&&Za(n)&&"static"===Ja(n).position;)n=ns(n);return n&&("html"===Qa(n)||"body"===Qa(n)&&"static"===Ja(n).position)?t:n||function(e){var t=/firefox/i.test(Ga());if(/Trident/i.test(Ga())&&za(e)&&"fixed"===Ja(e).position)return null;var n=ts(e);for(Wa(n)&&(n=n.host);za(n)&&["html","body"].indexOf(Qa(n))<0;){var r=Ja(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||t&&"filter"===r.willChange||t&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(e)||t}function is(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function os(e,t,n){return Va(e,Ua(t,n))}function as(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function ss(e,t){return t.reduce(function(t,n){return t[n]=e,t},{})}var ls={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,r=e.name,i=e.options,o=n.elements.arrow,a=n.modifiersData.popperOffsets,s=Ha(n.placement),l=is(s),c=[Ra,Aa].indexOf(s)>=0?"height":"width";if(o&&a){var u=function(e,t){return as("number"!==typeof(e="function"===typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:ss(e,Ma))}(i.padding,n),d=$a(o),h="y"===l?Na:Ra,f="y"===l?Ta:Aa,m=n.rects.reference[c]+n.rects.reference[l]-a[l]-n.rects.popper[c],p=a[l]-n.rects.reference[l],g=rs(o),v=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,y=m/2-p/2,b=u[h],w=v-d[c]-u[f],x=v/2-d[c]/2+y,S=os(b,x,w),C=l;n.modifiersData[r]=((t={})[C]=S,t.centerOffset=S-x,t)}},effect:function(e){var t=e.state,n=e.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"!==typeof r||(r=t.elements.popper.querySelector(r)))&&Xa(t.elements.popper,r)&&(t.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function cs(e){return e.split("-")[1]}var us={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ds(e){var t,n=e.popper,r=e.popperRect,i=e.placement,o=e.variation,a=e.offsets,s=e.position,l=e.gpuAcceleration,c=e.adaptive,u=e.roundOffsets,d=e.isFixed,h=a.x,f=void 0===h?0:h,m=a.y,p=void 0===m?0:m,g="function"===typeof u?u({x:f,y:p}):{x:f,y:p};f=g.x,p=g.y;var v=a.hasOwnProperty("x"),y=a.hasOwnProperty("y"),b=Ra,w=Na,x=window;if(c){var S=rs(n),C="clientHeight",E="clientWidth";if(S===La(n)&&"static"!==Ja(S=es(n)).position&&"absolute"===s&&(C="scrollHeight",E="scrollWidth"),i===Na||(i===Ra||i===Aa)&&o===_a)w=Ta,p-=(d&&S===x&&x.visualViewport?x.visualViewport.height:S[C])-r.height,p*=l?1:-1;if(i===Ra||(i===Na||i===Ta)&&o===_a)b=Aa,f-=(d&&S===x&&x.visualViewport?x.visualViewport.width:S[E])-r.width,f*=l?1:-1}var N,T=Object.assign({position:s},c&&us),A=!0===u?function(e,t){var n=e.x,r=e.y,i=t.devicePixelRatio||1;return{x:qa(n*i)/i||0,y:qa(r*i)/i||0}}({x:f,y:p},La(n)):{x:f,y:p};return f=A.x,p=A.y,l?Object.assign({},T,((N={})[w]=y?"0":"",N[b]=v?"0":"",N.transform=(x.devicePixelRatio||1)<=1?"translate("+f+"px, "+p+"px)":"translate3d("+f+"px, "+p+"px, 0)",N)):Object.assign({},T,((t={})[w]=y?p+"px":"",t[b]=v?f+"px":"",t.transform="",t))}var hs={passive:!0};var fs={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,r=e.options,i=r.scroll,o=void 0===i||i,a=r.resize,s=void 0===a||a,l=La(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return o&&c.forEach(function(e){e.addEventListener("scroll",n.update,hs)}),s&&l.addEventListener("resize",n.update,hs),function(){o&&c.forEach(function(e){e.removeEventListener("scroll",n.update,hs)}),s&&l.removeEventListener("resize",n.update,hs)}},data:{}},ms={left:"right",right:"left",bottom:"top",top:"bottom"};function ps(e){return e.replace(/left|right|bottom|top/g,function(e){return ms[e]})}var gs={start:"end",end:"start"};function vs(e){return e.replace(/start|end/g,function(e){return gs[e]})}function ys(e){var t=La(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function bs(e){return Ka(es(e)).left+ys(e).scrollLeft}function ws(e){var t=Ja(e),n=t.overflow,r=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function xs(e){return["html","body","#document"].indexOf(Qa(e))>=0?e.ownerDocument.body:za(e)&&ws(e)?e:xs(ts(e))}function Ss(e,t){var n;void 0===t&&(t=[]);var r=xs(e),i=r===(null==(n=e.ownerDocument)?void 0:n.body),o=La(r),a=i?[o].concat(o.visualViewport||[],ws(r)?r:[]):r,s=t.concat(a);return i?s:s.concat(Ss(ts(a)))}function Cs(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Es(e,t,n){return t===Oa?Cs(function(e,t){var n=La(e),r=es(e),i=n.visualViewport,o=r.clientWidth,a=r.clientHeight,s=0,l=0;if(i){o=i.width,a=i.height;var c=Ya();(c||!c&&"fixed"===t)&&(s=i.offsetLeft,l=i.offsetTop)}return{width:o,height:a,x:s+bs(e),y:l}}(e,n)):Ba(t)?function(e,t){var n=Ka(e,!1,"fixed"===t);return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}(t,n):Cs(function(e){var t,n=es(e),r=ys(e),i=null==(t=e.ownerDocument)?void 0:t.body,o=Va(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),a=Va(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),s=-r.scrollLeft+bs(e),l=-r.scrollTop;return"rtl"===Ja(i||n).direction&&(s+=Va(n.clientWidth,i?i.clientWidth:0)-o),{width:o,height:a,x:s,y:l}}(es(e)))}function Ns(e,t,n,r){var i="clippingParents"===t?function(e){var t=Ss(ts(e)),n=["absolute","fixed"].indexOf(Ja(e).position)>=0&&za(e)?rs(e):e;return Ba(n)?t.filter(function(e){return Ba(e)&&Xa(e,n)&&"body"!==Qa(e)}):[]}(e):[].concat(t),o=[].concat(i,[n]),a=o[0],s=o.reduce(function(t,n){var i=Es(e,n,r);return t.top=Va(i.top,t.top),t.right=Ua(i.right,t.right),t.bottom=Ua(i.bottom,t.bottom),t.left=Va(i.left,t.left),t},Es(e,a,r));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function Ts(e){var t,n=e.reference,r=e.element,i=e.placement,o=i?Ha(i):null,a=i?cs(i):null,s=n.x+n.width/2-r.width/2,l=n.y+n.height/2-r.height/2;switch(o){case Na:t={x:s,y:n.y-r.height};break;case Ta:t={x:s,y:n.y+n.height};break;case Aa:t={x:n.x+n.width,y:l};break;case Ra:t={x:n.x-r.width,y:l};break;default:t={x:n.x,y:n.y}}var c=o?is(o):null;if(null!=c){var u="y"===c?"height":"width";switch(a){case Da:t[c]=t[c]-(n[u]/2-r[u]/2);break;case _a:t[c]=t[c]+(n[u]/2-r[u]/2)}}return t}function As(e,t){void 0===t&&(t={});var n=t,r=n.placement,i=void 0===r?e.placement:r,o=n.strategy,a=void 0===o?e.strategy:o,s=n.boundary,l=void 0===s?"clippingParents":s,c=n.rootBoundary,u=void 0===c?Oa:c,d=n.elementContext,h=void 0===d?Ia:d,f=n.altBoundary,m=void 0!==f&&f,p=n.padding,g=void 0===p?0:p,v=as("number"!==typeof g?g:ss(g,Ma)),y=h===Ia?"reference":Ia,b=e.rects.popper,w=e.elements[m?y:h],x=Ns(Ba(w)?w:w.contextElement||es(e.elements.popper),l,u,a),S=Ka(e.elements.reference),C=Ts({reference:S,element:b,placement:i}),E=Cs(Object.assign({},b,C)),N=h===Ia?E:S,T={top:x.top-N.top+v.top,bottom:N.bottom-x.bottom+v.bottom,left:x.left-N.left+v.left,right:N.right-x.right+v.right},A=e.modifiersData.offset;if(h===Ia&&A){var R=A[i];Object.keys(T).forEach(function(e){var t=[Aa,Ta].indexOf(e)>=0?1:-1,n=[Na,Ta].indexOf(e)>=0?"y":"x";T[e]+=R[n]*t})}return T}function Rs(e,t){void 0===t&&(t={});var n=t,r=n.placement,i=n.boundary,o=n.rootBoundary,a=n.padding,s=n.flipVariations,l=n.allowedAutoPlacements,c=void 0===l?ja:l,u=cs(r),d=u?s?Pa:Pa.filter(function(e){return cs(e)===u}):Ma,h=d.filter(function(e){return c.indexOf(e)>=0});0===h.length&&(h=d);var f=h.reduce(function(t,n){return t[n]=As(e,{placement:n,boundary:i,rootBoundary:o,padding:a})[Ha(n)],t},{});return Object.keys(f).sort(function(e,t){return f[e]-f[t]})}var ks={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var i=n.mainAxis,o=void 0===i||i,a=n.altAxis,s=void 0===a||a,l=n.fallbackPlacements,c=n.padding,u=n.boundary,d=n.rootBoundary,h=n.altBoundary,f=n.flipVariations,m=void 0===f||f,p=n.allowedAutoPlacements,g=t.options.placement,v=Ha(g),y=l||(v===g||!m?[ps(g)]:function(e){if(Ha(e)===ka)return[];var t=ps(e);return[vs(e),t,vs(t)]}(g)),b=[g].concat(y).reduce(function(e,n){return e.concat(Ha(n)===ka?Rs(t,{placement:n,boundary:u,rootBoundary:d,padding:c,flipVariations:m,allowedAutoPlacements:p}):n)},[]),w=t.rects.reference,x=t.rects.popper,S=new Map,C=!0,E=b[0],N=0;N<b.length;N++){var T=b[N],A=Ha(T),R=cs(T)===Da,k=[Na,Ta].indexOf(A)>=0,M=k?"width":"height",D=As(t,{placement:T,boundary:u,rootBoundary:d,altBoundary:h,padding:c}),_=k?R?Aa:Ra:R?Ta:Na;w[M]>x[M]&&(_=ps(_));var O=ps(_),I=[];if(o&&I.push(D[A]<=0),s&&I.push(D[_]<=0,D[O]<=0),I.every(function(e){return e})){E=T,C=!1;break}S.set(T,I)}if(C)for(var P=function(e){var t=b.find(function(t){var n=S.get(t);if(n)return n.slice(0,e).every(function(e){return e})});if(t)return E=t,"break"},j=m?3:1;j>0;j--){if("break"===P(j))break}t.placement!==E&&(t.modifiersData[r]._skip=!0,t.placement=E,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Ms(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function Ds(e){return[Na,Aa,Ta,Ra].some(function(t){return e[t]>=0})}var _s={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,r=e.name,i=n.offset,o=void 0===i?[0,0]:i,a=ja.reduce(function(e,n){return e[n]=function(e,t,n){var r=Ha(e),i=[Ra,Na].indexOf(r)>=0?-1:1,o="function"===typeof n?n(Object.assign({},t,{placement:e})):n,a=o[0],s=o[1];return a=a||0,s=(s||0)*i,[Ra,Aa].indexOf(r)>=0?{x:s,y:a}:{x:a,y:s}}(n,t.rects,o),e},{}),s=a[t.placement],l=s.x,c=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=c),t.modifiersData[r]=a}};var Os={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name,i=n.mainAxis,o=void 0===i||i,a=n.altAxis,s=void 0!==a&&a,l=n.boundary,c=n.rootBoundary,u=n.altBoundary,d=n.padding,h=n.tether,f=void 0===h||h,m=n.tetherOffset,p=void 0===m?0:m,g=As(t,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),v=Ha(t.placement),y=cs(t.placement),b=!y,w=is(v),x="x"===w?"y":"x",S=t.modifiersData.popperOffsets,C=t.rects.reference,E=t.rects.popper,N="function"===typeof p?p(Object.assign({},t.rects,{placement:t.placement})):p,T="number"===typeof N?{mainAxis:N,altAxis:N}:Object.assign({mainAxis:0,altAxis:0},N),A=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,R={x:0,y:0};if(S){if(o){var k,M="y"===w?Na:Ra,D="y"===w?Ta:Aa,_="y"===w?"height":"width",O=S[w],I=O+g[M],P=O-g[D],j=f?-E[_]/2:0,F=y===Da?C[_]:E[_],H=y===Da?-E[_]:-C[_],L=t.elements.arrow,B=f&&L?$a(L):{width:0,height:0},z=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},W=z[M],V=z[D],U=os(0,C[_],B[_]),q=b?C[_]/2-j-U-W-T.mainAxis:F-U-W-T.mainAxis,G=b?-C[_]/2+j+U+V+T.mainAxis:H+U+V+T.mainAxis,Y=t.elements.arrow&&rs(t.elements.arrow),K=Y?"y"===w?Y.clientTop||0:Y.clientLeft||0:0,$=null!=(k=null==A?void 0:A[w])?k:0,X=O+G-$,Q=os(f?Ua(I,O+q-$-K):I,O,f?Va(P,X):P);S[w]=Q,R[w]=Q-O}if(s){var J,Z="x"===w?Na:Ra,ee="x"===w?Ta:Aa,te=S[x],ne="y"===x?"height":"width",re=te+g[Z],ie=te-g[ee],oe=-1!==[Na,Ra].indexOf(v),ae=null!=(J=null==A?void 0:A[x])?J:0,se=oe?re:te-C[ne]-E[ne]-ae+T.altAxis,le=oe?te+C[ne]+E[ne]-ae-T.altAxis:ie,ce=f&&oe?function(e,t,n){var r=os(e,t,n);return r>n?n:r}(se,te,le):os(f?se:re,te,f?le:ie);S[x]=ce,R[x]=ce-te}t.modifiersData[r]=R}},requiresIfExists:["offset"]};function Is(e,t,n){void 0===n&&(n=!1);var r=za(t),i=za(t)&&function(e){var t=e.getBoundingClientRect(),n=qa(t.width)/e.offsetWidth||1,r=qa(t.height)/e.offsetHeight||1;return 1!==n||1!==r}(t),o=es(t),a=Ka(e,i,n),s={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!n)&&(("body"!==Qa(t)||ws(o))&&(s=function(e){return e!==La(e)&&za(e)?{scrollLeft:(t=e).scrollLeft,scrollTop:t.scrollTop}:ys(e);var t}(t)),za(t)?((l=Ka(t,!0)).x+=t.clientLeft,l.y+=t.clientTop):o&&(l.x=bs(o))),{x:a.left+s.scrollLeft-l.x,y:a.top+s.scrollTop-l.y,width:a.width,height:a.height}}function Ps(e){var t=new Map,n=new Set,r=[];function i(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach(function(e){if(!n.has(e)){var r=t.get(e);r&&i(r)}}),r.push(e)}return e.forEach(function(e){t.set(e.name,e)}),e.forEach(function(e){n.has(e.name)||i(e)}),r}function js(e){var t;return function(){return t||(t=new Promise(function(n){Promise.resolve().then(function(){t=void 0,n(e())})})),t}}var Fs={placement:"bottom",modifiers:[],strategy:"absolute"};function Hs(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(e){return!(e&&"function"===typeof e.getBoundingClientRect)})}const Ls=function(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,r=void 0===n?[]:n,i=t.defaultOptions,o=void 0===i?Fs:i;return function(e,t,n){void 0===n&&(n=o);var i={placement:"bottom",orderedModifiers:[],options:Object.assign({},Fs,o),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},a=[],s=!1,l={state:i,setOptions:function(n){var s="function"===typeof n?n(i.options):n;c(),i.options=Object.assign({},o,i.options,s),i.scrollParents={reference:Ba(e)?Ss(e):e.contextElement?Ss(e.contextElement):[],popper:Ss(t)};var u=function(e){var t=Ps(e);return Fa.reduce(function(e,n){return e.concat(t.filter(function(e){return e.phase===n}))},[])}(function(e){var t=e.reduce(function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e},{});return Object.keys(t).map(function(e){return t[e]})}([].concat(r,i.options.modifiers)));return i.orderedModifiers=u.filter(function(e){return e.enabled}),i.orderedModifiers.forEach(function(e){var t=e.name,n=e.options,r=void 0===n?{}:n,o=e.effect;if("function"===typeof o){var s=o({state:i,name:t,instance:l,options:r}),c=function(){};a.push(s||c)}}),l.update()},forceUpdate:function(){if(!s){var e=i.elements,t=e.reference,n=e.popper;if(Hs(t,n)){i.rects={reference:Is(t,rs(n),"fixed"===i.options.strategy),popper:$a(n)},i.reset=!1,i.placement=i.options.placement,i.orderedModifiers.forEach(function(e){return i.modifiersData[e.name]=Object.assign({},e.data)});for(var r=0;r<i.orderedModifiers.length;r++)if(!0!==i.reset){var o=i.orderedModifiers[r],a=o.fn,c=o.options,u=void 0===c?{}:c,d=o.name;"function"===typeof a&&(i=a({state:i,options:u,name:d,instance:l})||i)}else i.reset=!1,r=-1}}},update:js(function(){return new Promise(function(e){l.forceUpdate(),e(i)})}),destroy:function(){c(),s=!0}};if(!Hs(e,t))return l;function c(){a.forEach(function(e){return e()}),a=[]}return l.setOptions(n).then(function(e){!s&&n.onFirstUpdate&&n.onFirstUpdate(e)}),l}}({defaultModifiers:[{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,r=t.rects.reference,i=t.rects.popper,o=t.modifiersData.preventOverflow,a=As(t,{elementContext:"reference"}),s=As(t,{altBoundary:!0}),l=Ms(a,r),c=Ms(s,i,o),u=Ds(l),d=Ds(c);t.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=Ts({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,r=n.gpuAcceleration,i=void 0===r||r,o=n.adaptive,a=void 0===o||o,s=n.roundOffsets,l=void 0===s||s,c={placement:Ha(t.placement),variation:cs(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,ds(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,ds(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},fs,_s,ks,Os,ls]}),Bs=["enabled","placement","strategy","modifiers"];const zs={name:"applyStyles",enabled:!1,phase:"afterWrite",fn:()=>{}},Ws={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:e=>{let{state:t}=e;return()=>{const{reference:e,popper:n}=t.elements;if("removeAttribute"in e){const t=(e.getAttribute("aria-describedby")||"").split(",").filter(e=>e.trim()!==n.id);t.length?e.setAttribute("aria-describedby",t.join(",")):e.removeAttribute("aria-describedby")}}},fn:e=>{let{state:t}=e;var n;const{popper:r,reference:i}=t.elements,o=null==(n=r.getAttribute("role"))?void 0:n.toLowerCase();if(r.id&&"tooltip"===o&&"setAttribute"in i){const e=i.getAttribute("aria-describedby");if(e&&-1!==e.split(",").indexOf(r.id))return;i.setAttribute("aria-describedby",e?"".concat(e,",").concat(r.id):r.id)}}},Vs=[];const Us=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{enabled:r=!0,placement:i="bottom",strategy:o="absolute",modifiers:a=Vs}=n,s=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(n,Bs);const l=(0,g.useRef)(a),c=(0,g.useRef)(void 0),u=(0,g.useCallback)(()=>{var e;null==(e=c.current)||e.update()},[]),d=(0,g.useCallback)(()=>{var e;null==(e=c.current)||e.forceUpdate()},[]),[h,f]=Ea((0,g.useState)({placement:i,update:u,forceUpdate:d,attributes:{},styles:{popper:{},arrow:{}}})),m=(0,g.useMemo)(()=>({name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:e=>{let{state:t}=e;const n={},r={};Object.keys(t.elements).forEach(e=>{n[e]=t.styles[e],r[e]=t.attributes[e]}),f({state:t,styles:n,attributes:r,update:u,forceUpdate:d,placement:t.placement})}}),[u,d,f]),p=(0,g.useMemo)(()=>(Ca(l.current,a)||(l.current=a),l.current),[a]);return(0,g.useEffect)(()=>{c.current&&r&&c.current.setOptions({placement:i,strategy:o,modifiers:[...p,m,zs]})},[o,i,m,r,p]),(0,g.useEffect)(()=>{if(r&&null!=e&&null!=t)return c.current=Ls(e,t,Object.assign({},s,{placement:i,strategy:o,modifiers:[...p,Ws,m]})),()=>{null!=c.current&&(c.current.destroy(),c.current=void 0,f(e=>Object.assign({},e,{attributes:{},styles:{popper:{}}})))}},[r,e,t]),h};const qs=()=>{};const Gs=e=>e&&("current"in e?e.current:e),Ys={click:"mousedown",mouseup:"mousedown",pointerup:"pointerdown"};const Ks=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qs,{disabled:n,clickTrigger:r="click"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=(0,g.useRef)(!1),o=(0,g.useRef)(!1),a=(0,g.useCallback)(t=>{const n=Gs(e);var r;pi(!!n,"ClickOutside captured a close event but does not have a ref to compare it to. useClickOutside(), should be passed a ref that resolves to a DOM node"),i.current=!n||!!((r=t).metaKey||r.altKey||r.ctrlKey||r.shiftKey)||!function(e){return 0===e.button}(t)||!!so(n,t.target)||o.current,o.current=!1},[e]),s=an(t=>{const n=Gs(e);n&&so(n,t.target)?o.current=!0:o.current=!1}),l=an(e=>{i.current||t(e)});(0,g.useEffect)(()=>{if(n||null==e)return;const t=Cn(Gs(e));let i=function(e){const t=e||window;try{var n,r;return null!=(n=t.event)?n:null==(r=t.parent)?void 0:r.event}catch(i){return}}(t.defaultView),o=null;Ys[r]&&(o=Pn(t,Ys[r],s,!0));const c=Pn(t,r,a,!0),u=Pn(t,r,e=>{e!==i?l(e):i=void 0});let d=[];return"ontouchstart"in t.documentElement&&(d=[].slice.call(t.body.children).map(e=>Pn(e,"mousemove",qs))),()=>{null==o||o(),c(),u(),d.forEach(e=>e())}},[e,n,r,a,s,l])};function $s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Array.isArray(e)?e:Object.keys(e).map(t=>(e[t].name=t,e[t]))}function Xs(e){let{enabled:t,enableEvents:n,placement:r,flip:i,offset:o,fixed:a,containerPadding:s,arrowElement:l,popperConfig:c={}}=e;var u,d,h,f,m;const p=function(e){const t={};return Array.isArray(e)?(null==e||e.forEach(e=>{t[e.name]=e}),t):e||t}(c.modifiers);return Object.assign({},c,{placement:r,enabled:t,strategy:a?"fixed":c.strategy,modifiers:$s(Object.assign({},p,{eventListeners:{enabled:n,options:null==(u=p.eventListeners)?void 0:u.options},preventOverflow:Object.assign({},p.preventOverflow,{options:s?Object.assign({padding:s},null==(d=p.preventOverflow)?void 0:d.options):null==(h=p.preventOverflow)?void 0:h.options}),offset:{options:Object.assign({offset:o},null==(f=p.offset)?void 0:f.options)},arrow:Object.assign({},p.arrow,{enabled:!!l,options:Object.assign({},null==(m=p.arrow)?void 0:m.options,{element:l})}),flip:Object.assign({enabled:!!i},p.flip)}))})}const Qs=["children","usePopper"];const Js=()=>{};function Zs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=(0,g.useContext)(wa),[n,r]=io(),i=(0,g.useRef)(!1),{flip:o,offset:a,rootCloseEvent:s,fixed:l=!1,placement:c,popperConfig:u={},enableEventListeners:d=!0,usePopper:h=!!t}=e,f=null==(null==t?void 0:t.show)?!!e.show:t.show;f&&!i.current&&(i.current=!0);const{placement:m,setMenu:p,menuElement:v,toggleElement:y}=t||{},b=Us(y,v,Xs({placement:c||m||"bottom-start",enabled:h,enableEvents:null==d?f:d,offset:a,flip:o,fixed:l,arrowElement:n,popperConfig:u})),w=Object.assign({ref:p||Js,"aria-labelledby":null==y?void 0:y.id},b.attributes.popper,{style:b.styles.popper}),x={show:f,placement:m,hasShown:i.current,toggle:null==t?void 0:t.toggle,popper:h?b:null,arrowProps:h?Object.assign({ref:r},b.attributes.arrow,{style:b.styles.arrow}):{}};return Ks(v,e=>{null==t||t.toggle(!1,e)},{clickTrigger:s,disabled:!f}),[w,x]}function el(e){let{children:t,usePopper:n=!0}=e,r=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,Qs);const[i,o]=Zs(Object.assign({},r,{usePopper:n}));return(0,Bt.jsx)(Bt.Fragment,{children:t(i,o)})}el.displayName="DropdownMenu";const tl=el,nl=e=>{var t;return"menu"===(null==(t=e.getAttribute("role"))?void 0:t.toLowerCase())},rl=()=>{};function il(){const e=(0,g.useId)(),{show:t=!1,toggle:n=rl,setToggle:r,menuElement:i}=(0,g.useContext)(wa)||{},o=(0,g.useCallback)(e=>{n(!t,e)},[t,n]),a={id:e,ref:r||rl,onClick:o,"aria-expanded":!!t};return i&&nl(i)&&(a["aria-haspopup"]=!0),[a,{show:t,toggle:n}]}function ol(e){let{children:t}=e;const[n,r]=il();return(0,Bt.jsx)(Bt.Fragment,{children:t(n,r)})}ol.displayName="DropdownToggle";const al=ol,sl=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null!=e?String(e):t||null},ll=g.createContext(null),cl=g.createContext(null);cl.displayName="NavContext";const ul=cl,dl=["eventKey","disabled","onClick","active","as"];function hl(e){let{key:t,href:n,active:r,disabled:i,onClick:o}=e;const a=(0,g.useContext)(ll),s=(0,g.useContext)(ul),{activeKey:l}=s||{},c=sl(t,n),u=null==r&&null!=t?sl(l)===c:r;return[{onClick:an(e=>{i||(null==o||o(e),a&&!e.isPropagationStopped()&&a(c,e))}),"aria-disabled":i||void 0,"aria-selected":u,[co("dropdown-item")]:""},{isActive:u}]}const fl=g.forwardRef((e,t)=>{let{eventKey:n,disabled:r,onClick:i,active:o,as:a=pn}=e,s=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,dl);const[l]=hl({key:n,href:s.href,disabled:r,onClick:i,active:o});return(0,Bt.jsx)(a,Object.assign({},s,{ref:t},l))});fl.displayName="DropdownItem";const ml=fl;function pl(){const e=ya(),t=(0,g.useRef)(null),n=(0,g.useCallback)(n=>{t.current=n,e()},[e]);return[t,n]}function gl(e){let{defaultShow:t,show:n,onSelect:r,onToggle:i,itemSelector:o="* [".concat(co("dropdown-item"),"]"),focusFirstItemOnShow:a,placement:s="bottom-start",children:l}=e;const c=mo(),[u,d]=nn(n,t,i),[h,f]=pl(),m=h.current,[p,v]=pl(),y=p.current,b=lo(u),w=(0,g.useRef)(null),x=(0,g.useRef)(!1),S=(0,g.useContext)(ll),C=(0,g.useCallback)(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null==t?void 0:t.type;d(e,{originalEvent:t,source:n})},[d]),E=an((e,t)=>{null==r||r(e,t),C(!1,t,"select"),t.isPropagationStopped()||null==S||S(e,t)}),N=(0,g.useMemo)(()=>({toggle:C,placement:s,show:u,menuElement:m,toggleElement:y,setMenu:f,setToggle:v}),[C,s,u,m,y,f,v]);m&&b&&!u&&(x.current=m.contains(m.ownerDocument.activeElement));const T=an(()=>{y&&y.focus&&y.focus()}),A=an(()=>{const e=w.current;let t=a;if(null==t&&(t=!(!h.current||!nl(h.current))&&"keyboard"),!1===t||"keyboard"===t&&!/^key.+$/.test(e))return;const n=Fo(h.current,o)[0];n&&n.focus&&n.focus()});(0,g.useEffect)(()=>{u?A():x.current&&(x.current=!1,T())},[u,x,T,A]),(0,g.useEffect)(()=>{w.current=null});const R=(e,t)=>{if(!h.current)return null;const n=Fo(h.current,o);let r=n.indexOf(e)+t;return r=Math.max(0,Math.min(r,n.length)),n[r]};return ba((0,g.useCallback)(()=>c.document,[c]),"keydown",e=>{var t,n;const{key:r}=e,i=e.target,o=null==(t=h.current)?void 0:t.contains(i),a=null==(n=p.current)?void 0:n.contains(i);if(/input|textarea/i.test(i.tagName)&&(" "===r||"Escape"!==r&&o||"Escape"===r&&"search"===i.type))return;if(!o&&!a)return;if("Tab"===r&&(!h.current||!u))return;w.current=e.type;const s={originalEvent:e,source:e.type};switch(r){case"ArrowUp":{const t=R(i,-1);return t&&t.focus&&t.focus(),void e.preventDefault()}case"ArrowDown":if(e.preventDefault(),u){const e=R(i,1);e&&e.focus&&e.focus()}else d(!0,s);return;case"Tab":On(i.ownerDocument,"keyup",e=>{var t;("Tab"!==e.key||e.target)&&null!=(t=h.current)&&t.contains(e.target)||d(!1,s)},{once:!0});break;case"Escape":"Escape"===r&&(e.preventDefault(),e.stopPropagation()),d(!1,s)}}),(0,Bt.jsx)(ll.Provider,{value:E,children:(0,Bt.jsx)(wa.Provider,{value:N,children:l})})}gl.displayName="Dropdown",gl.Menu=tl,gl.Toggle=al,gl.Item=ml;const vl=gl,yl=g.createContext({});yl.displayName="DropdownContext";const bl=yl,wl=["className","bsPrefix","as","role"],xl=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i="hr",role:o="separator"}=e,a=b(e,wl);return r=Gt(r,"dropdown-divider"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r),role:o},a))});xl.displayName="DropdownDivider";const Sl=xl,Cl=["className","bsPrefix","as","role"],El=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i="div",role:o="heading"}=e,a=b(e,Cl);return r=Gt(r,"dropdown-header"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r),role:o},a))});El.displayName="DropdownHeader";const Nl=El,Tl=["bsPrefix","className","eventKey","disabled","onClick","active","as"],Al=g.forwardRef((e,t)=>{let{bsPrefix:n,className:r,eventKey:i,disabled:o=!1,onClick:a,active:s,as:l=yn}=e,c=b(e,Tl);const u=Gt(n,"dropdown-item"),[d,h]=hl({key:i,href:c.href,disabled:o,onClick:a,active:s});return(0,Bt.jsx)(l,E(E(E({},c),d),{},{ref:t,className:Lt(r,u,h.isActive&&"active",o&&"disabled")}))});Al.displayName="DropdownItem";const Rl=Al,kl=["className","bsPrefix","as"],Ml=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i="span"}=e,o=b(e,kl);return r=Gt(r,"dropdown-item-text"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r)},o))});Ml.displayName="DropdownItemText";const Dl=Ml,_l=g.createContext(null);_l.displayName="InputGroupContext";const Ol=_l,Il=g.createContext(null);Il.displayName="NavbarContext";const Pl=Il;n(2740);function jl(e,t){return e}const Fl=["bsPrefix","className","align","rootCloseEvent","flip","show","renderOnMount","as","popperConfig","variant"];function Hl(e,t,n){let r=e?n?"bottom-start":"bottom-end":n?"bottom-end":"bottom-start";return"up"===t?r=e?n?"top-start":"top-end":n?"top-end":"top-start":"end"===t?r=e?n?"left-end":"right-end":n?"left-start":"right-start":"start"===t?r=e?n?"right-end":"left-end":n?"right-start":"left-start":"down-centered"===t?r="bottom":"up-centered"===t&&(r="top"),r}const Ll=g.forwardRef((e,t)=>{let{bsPrefix:n,className:r,align:i,rootCloseEvent:o,flip:a=!0,show:s,renderOnMount:l,as:c="div",popperConfig:u,variant:d}=e,h=b(e,Fl),f=!1;const m=(0,g.useContext)(Pl),p=Gt(n,"dropdown-menu"),{align:v,drop:y,isRTL:w}=(0,g.useContext)(bl);i=i||v;const x=(0,g.useContext)(Ol),S=[];if(i)if("object"===typeof i){const e=Object.keys(i);if(e.length){const t=e[0],n=i[t];f="start"===n,S.push("".concat(p,"-").concat(t,"-").concat(n))}}else"end"===i&&(f=!0);const C=Hl(f,y,w),[N,{hasShown:T,popper:A,show:R,toggle:k}]=Zs({flip:a,rootCloseEvent:o,show:s,usePopper:!m&&0===S.length,offset:[0,2],popperConfig:u,placement:C});if(N.ref=er(jl(t),N.ref),Co(()=>{R&&(null==A||A.update())},[R]),!T&&!l&&!x)return null;"string"!==typeof c&&(N.show=R,N.close=()=>null==k?void 0:k(!1),N.align=i);let M=h.style;return null!=A&&A.placement&&(M=E(E({},h.style),N.style),h["x-placement"]=A.placement),(0,Bt.jsx)(c,E(E(E(E({},h),N),{},{style:M},(S.length||m)&&{"data-bs-popper":"static"}),{},{className:Lt(r,p,R&&"show",f&&"".concat(p,"-end"),d&&"".concat(p,"-").concat(d),...S)}))});Ll.displayName="DropdownMenu";const Bl=Ll,zl=["bsPrefix","split","className","childBsPrefix","as"],Wl=g.forwardRef((e,t)=>{let{bsPrefix:n,split:r,className:i,childBsPrefix:o,as:a=gr}=e,s=b(e,zl);const l=Gt(n,"dropdown-toggle"),c=(0,g.useContext)(wa);void 0!==o&&(s.bsPrefix=o);const[u]=il();return u.ref=er(u.ref,jl(t)),(0,Bt.jsx)(a,E(E({className:Lt(i,l,r&&"".concat(l,"-split"),(null==c?void 0:c.show)&&"show")},u),s))});Wl.displayName="DropdownToggle";const Vl=Wl,Ul=["bsPrefix","drop","show","className","align","onSelect","onToggle","focusFirstItemOnShow","as","navbar","autoClose"],ql=g.forwardRef((e,t)=>{const n=rn(e,{show:"onToggle"}),{bsPrefix:r,drop:i="down",show:o,className:a,align:s="start",onSelect:l,onToggle:c,focusFirstItemOnShow:u,as:d="div",navbar:h,autoClose:f=!0}=n,m=b(n,Ul),p=(0,g.useContext)(Ol),v=Gt(r,"dropdown"),y=$t(),w=an((e,t)=>{var n;var r;(null==(n=t.originalEvent)||null==(n=n.target)?void 0:n.classList.contains("dropdown-toggle"))&&"mousedown"===t.source||(t.originalEvent.currentTarget!==document||"keydown"===t.source&&"Escape"!==t.originalEvent.key||(t.source="rootClose"),r=t.source,(!1===f?"click"===r:"inside"===f?"rootClose"!==r:"outside"!==f||"select"!==r)&&(null==c||c(e,t)))}),x=Hl("end"===s,i,y),S=(0,g.useMemo)(()=>({align:s,drop:i,isRTL:y}),[s,i,y]),C={down:v,"down-centered":"".concat(v,"-center"),up:"dropup","up-centered":"dropup-center dropup",end:"dropend",start:"dropstart"};return(0,Bt.jsx)(bl.Provider,{value:S,children:(0,Bt.jsx)(vl,{placement:x,show:o,onSelect:l,onToggle:w,focusFirstItemOnShow:u,itemSelector:".".concat(v,"-item:not(.disabled):not(:disabled)"),children:p?m.children:(0,Bt.jsx)(d,E(E({},m),{},{ref:t,className:Lt(a,o&&"show",C[i])}))})})});ql.displayName="Dropdown";const Gl=Object.assign(ql,{Toggle:Vl,Menu:Bl,Item:Rl,ItemText:Dl,Divider:Sl,Header:Nl}),Yl=g.createContext(null),Kl=["as","active","eventKey"];function $l(e){let{key:t,onClick:n,active:r,id:i,role:o,disabled:a}=e;const s=(0,g.useContext)(ll),l=(0,g.useContext)(ul),c=(0,g.useContext)(Yl);let u=r;const d={role:o};if(l){o||"tablist"!==l.role||(d.role="tab");const e=l.getControllerId(null!=t?t:null),n=l.getControlledId(null!=t?t:null);d[co("event-key")]=t,d.id=e||i,u=null==r&&null!=t?l.activeKey===t:r,!u&&(null!=c&&c.unmountOnExit||null!=c&&c.mountOnEnter)||(d["aria-controls"]=n)}return"tab"===d.role&&(d["aria-selected"]=u,u||(d.tabIndex=-1),a&&(d.tabIndex=-1,d["aria-disabled"]=!0)),d.onClick=an(e=>{a||(null==n||n(e),null!=t&&s&&!e.isPropagationStopped()&&s(t,e))}),[d,{isActive:u}]}const Xl=g.forwardRef((e,t)=>{let{as:n=pn,active:r,eventKey:i}=e,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,Kl);const[a,s]=$l(Object.assign({key:sl(i,o.href),active:r},o));return a[co("active")]=s.isActive,(0,Bt.jsx)(n,Object.assign({},o,a,{ref:t}))});Xl.displayName="NavItem";const Ql=Xl,Jl=["bsPrefix","className","as","active","eventKey","disabled"],Zl=g.forwardRef((e,t)=>{let{bsPrefix:n,className:r,as:i=yn,active:o,eventKey:a,disabled:s=!1}=e,l=b(e,Jl);n=Gt(n,"nav-link");const[c,u]=$l(E({key:sl(a,l.href),active:o,disabled:s},l));return(0,Bt.jsx)(i,E(E(E({},l),c),{},{ref:t,disabled:s,className:Lt(r,n,s&&"disabled",u.isActive&&"active")}))});Zl.displayName="NavLink";const ec=Zl,tc=["id","title","children","bsPrefix","className","rootCloseEvent","menuRole","disabled","active","renderMenuOnMount","menuVariant"],nc=g.forwardRef((e,t)=>{let{id:n,title:r,children:i,bsPrefix:o,className:a,rootCloseEvent:s,menuRole:l,disabled:c,active:u,renderMenuOnMount:d,menuVariant:h}=e,f=b(e,tc);const m=Gt(void 0,"nav-item");return(0,Bt.jsxs)(Gl,E(E({ref:t},f),{},{className:Lt(a,m),children:[(0,Bt.jsx)(Gl.Toggle,{id:n,eventKey:null,active:u,disabled:c,childBsPrefix:o,as:ec,children:r}),(0,Bt.jsx)(Gl.Menu,{role:l,renderOnMount:d,rootCloseEvent:s,variant:h,children:i})]}))});nc.displayName="NavDropdown";const rc=Object.assign(nc,{Item:Gl.Item,ItemText:Gl.ItemText,Divider:Gl.Divider,Header:Gl.Header}),ic=["bsPrefix","className","as"],oc=g.forwardRef((e,t)=>{let{bsPrefix:n,className:r,as:i}=e,o=b(e,ic);n=Gt(n,"navbar-brand");const a=i||(o.href?"a":"span");return(0,Bt.jsx)(a,E(E({},o),{},{ref:t,className:Lt(r,n)}))});oc.displayName="NavbarBrand";const ac=oc;const sc=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(e=>null!=e).reduce((e,t)=>{if("function"!==typeof t)throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return null===e?t:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r),t.apply(this,r)}},null)},lc=["onEnter","onEntering","onEntered","onExit","onExiting","className","children","dimension","in","timeout","mountOnEnter","unmountOnExit","appear","getDimensionValue"],cc={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function uc(e,t){const n=t["offset".concat(e[0].toUpperCase()).concat(e.slice(1))],r=cc[e];return n+parseInt(kn(t,r[0]),10)+parseInt(kn(t,r[1]),10)}const dc={exited:"collapse",exiting:"collapsing",entering:"collapsing",entered:"collapse show"},hc=g.forwardRef((e,t)=>{let{onEnter:n,onEntering:r,onEntered:i,onExit:o,onExiting:a,className:s,children:l,dimension:c="height",in:u=!1,timeout:d=300,mountOnEnter:h=!1,unmountOnExit:f=!1,appear:m=!1,getDimensionValue:p=uc}=e,v=b(e,lc);const y="function"===typeof c?c():c,w=(0,g.useMemo)(()=>sc(e=>{e.style[y]="0"},n),[y,n]),x=(0,g.useMemo)(()=>sc(e=>{const t="scroll".concat(y[0].toUpperCase()).concat(y.slice(1));e.style[y]="".concat(e[t],"px")},r),[y,r]),S=(0,g.useMemo)(()=>sc(e=>{e.style[y]=null},i),[y,i]),C=(0,g.useMemo)(()=>sc(e=>{e.style[y]="".concat(p(y,e),"px"),Bn(e)},o),[o,p,y]),N=(0,g.useMemo)(()=>sc(e=>{e.style[y]=null},a),[y,a]);return(0,Bt.jsx)(rr,E(E({ref:t,addEndListener:Ln},v),{},{"aria-expanded":v.role?u:null,onEnter:w,onEntering:x,onEntered:S,onExit:C,onExiting:N,childRef:Sn(l),in:u,timeout:d,mountOnEnter:h,unmountOnExit:f,appear:m,children:(e,t)=>g.cloneElement(l,E(E({},t),{},{className:Lt(s,l.props.className,dc[e],"width"===y&&"collapse-horizontal")}))}))});hc.displayName="Collapse";const fc=hc,mc=["children","bsPrefix"],pc=g.forwardRef((e,t)=>{let{children:n,bsPrefix:r}=e,i=b(e,mc);r=Gt(r,"navbar-collapse");const o=(0,g.useContext)(Pl);return(0,Bt.jsx)(fc,E(E({in:!(!o||!o.expanded)},i),{},{children:(0,Bt.jsx)("div",{ref:t,className:r,children:n})}))});pc.displayName="NavbarCollapse";const gc=pc,vc=["bsPrefix","className","children","label","as","onClick"],yc=g.forwardRef((e,t)=>{let{bsPrefix:n,className:r,children:i,label:o="Toggle navigation",as:a="button",onClick:s}=e,l=b(e,vc);n=Gt(n,"navbar-toggler");const{onToggle:c,expanded:u}=(0,g.useContext)(Pl)||{},d=an(e=>{s&&s(e),c&&c()});return"button"===a&&(l.type="button"),(0,Bt.jsx)(a,E(E({},l),{},{ref:t,onClick:d,"aria-label":o,className:Lt(r,n,!u&&"collapsed"),children:i||(0,Bt.jsx)("span",{className:"".concat(n,"-icon")})}))});yc.displayName="NavbarToggle";const bc=yc,wc=2**31-1;function xc(e,t,n){const r=n-Date.now();e.current=r<=wc?setTimeout(t,r):setTimeout(()=>xc(e,t,n),wc)}function Sc(){const[e,t]=(0,g.useState)(null),n=go(),r=(0,g.useRef)(null);(0,g.useEffect)(()=>{if(!e)return;const{fn:i,delayMs:o}=e;function a(){n()&&t(null),i()}o<=wc?r.current=setTimeout(a,o):xc(r,a,Date.now()+o);const s=r.current;return()=>{r.current!==s&&clearTimeout(s),clearTimeout(r.current),r.current}},[e]);const i=!!e;return(0,g.useMemo)(()=>({set(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;n()&&t({fn:e,delayMs:r})},clear(){t(null)},isPending:i,handleRef:r}),[i,t,r,n])}const Cc=Symbol("EMPTY");const Ec=function(e,t){const n=(0,g.useRef)(null),r=(0,g.useRef)(0),i=(0,g.useRef)(Cc),o=(0,g.useRef)(!1),a=(0,g.useRef)(null),s=an(e),{wait:l,maxWait:c,leading:u=!1,trailing:d=!0}="number"===typeof t?{wait:t}:t,h=Sc();return(0,g.useMemo)(()=>{const e=!!c;function t(){var s,u=Date.now();if(m(u))return function(e){return o.current=!1,d&&a.current?f(e):(a.current=null,i.current===Cc?void 0:i.current)}(u);const p=u-(null!=(s=n.current)?s:0),g=u-r.current,v=l-p;h.set(t,e?Math.min(v,c-g):v)}function f(e){var t;const n=null!=(t=a.current)?t:[];a.current=null,r.current=e;const o=s(...n);return i.current=o,o}function m(t){var i;const o=t-(null!=(i=n.current)?i:0),a=t-r.current;return null===n.current||o>=l||o<0||e&&a>=c}return function(){const s=Date.now(),c=m(s);for(var d=arguments.length,p=new Array(d),g=0;g<d;g++)p[g]=arguments[g];if(a.current=p,n.current=s,c){if(!o.current)return function(e){return r.current=e,o.current=!0,h.set(t,l),u?f(e):i.current===Cc?void 0:i.current}(n.current);if(e)return o.current=!0,h.set(t,l),f(n.current)}return o.current||(o.current=!0,h.set(t,l)),i.current===Cc?void 0:i.current}},[s,l,c,u,d])},Nc=["className","bsPrefix","as"],Tc=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i="div"}=e,o=b(e,Nc);return r=Gt(r,"offcanvas-body"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r)},o))});Tc.displayName="OffcanvasBody";const Ac=Tc,Rc=["bsPrefix","className","children","in","mountOnEnter","unmountOnExit","appear"],kc={entering:"show",entered:"show"},Mc=g.forwardRef((e,t)=>{let{bsPrefix:n,className:r,children:i,in:o=!1,mountOnEnter:a=!1,unmountOnExit:s=!1,appear:l=!1}=e,c=b(e,Rc);return n=Gt(n,"offcanvas"),(0,Bt.jsx)(rr,E(E({ref:t,addEndListener:Ln,in:o,mountOnEnter:a,unmountOnExit:s,appear:l},c),{},{childRef:Sn(i),children:(e,t)=>g.cloneElement(i,E(E({},t),{},{className:Lt(r,i.props.className,("entering"===e||"exiting"===e)&&"".concat(n,"-toggling"),kc[e])}))}))});Mc.displayName="OffcanvasToggling";const Dc=Mc,_c=["bsPrefix","className","closeLabel","closeButton"],Oc=g.forwardRef((e,t)=>{let{bsPrefix:n,className:r,closeLabel:i="Close",closeButton:o=!1}=e,a=b(e,_c);return n=Gt(n,"offcanvas-header"),(0,Bt.jsx)(ia,E(E({ref:t},a),{},{className:Lt(r,n),closeLabel:i,closeButton:o}))});Oc.displayName="OffcanvasHeader";const Ic=Oc,Pc=["className","bsPrefix","as"],jc=sn("h5"),Fc=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i=jc}=e,o=b(e,Pc);return r=Gt(r,"offcanvas-title"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r)},o))});Fc.displayName="OffcanvasTitle";const Hc=Fc,Lc=["bsPrefix","className","children","aria-labelledby","placement","responsive","show","backdrop","keyboard","scroll","onEscapeKeyDown","onShow","onHide","container","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","onEntered","onExit","onExiting","onEnter","onEntering","onExited","backdropClassName","manager"];function Bc(e){return(0,Bt.jsx)(Dc,E({},e))}function zc(e){return(0,Bt.jsx)(sr,E({},e))}const Wc=g.forwardRef((e,t)=>{let{bsPrefix:n,className:r,children:i,"aria-labelledby":o,placement:a="start",responsive:s,show:l=!1,backdrop:c=!0,keyboard:u=!0,scroll:d=!1,onEscapeKeyDown:h,onShow:f,onHide:m,container:p,autoFocus:v=!0,enforceFocus:y=!0,restoreFocus:w=!0,restoreFocusOptions:x,onEntered:S,onExit:C,onExiting:N,onEnter:T,onEntering:A,onExited:R,backdropClassName:k,manager:M}=e,D=b(e,Lc);const _=(0,g.useRef)(null),O=(0,g.useRef)(null);n=Gt(n,"offcanvas");const I=an(m),P=Ec(()=>{l&&s&&_.current&&"fixed"!==getComputedStyle(_.current).position&&I()},300);ba((0,g.useCallback)(()=>window,[]),"resize",P);const j=(0,g.useMemo)(()=>({onHide:I}),[I]);const F=(0,g.useCallback)(e=>(0,Bt.jsx)("div",E(E({},e),{},{className:Lt("".concat(n,"-backdrop"),k)})),[k,n]);return(0,Bt.jsx)($o.Provider,{value:j,children:(0,Bt.jsx)(Po,{show:l,ref:t,backdrop:c,container:p,keyboard:u,autoFocus:v,enforceFocus:y&&!d,restoreFocus:w,restoreFocusOptions:x,onEscapeKeyDown:h,onShow:f,onHide:I,onEnter:function(e){e&&(e.style.visibility="visible");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];null==T||T(e,...n)},onEntering:A,onEntered:S,onExit:C,onExiting:N,onExited:function(e){e&&(e.style.visibility="");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];null==R||R(...n)},manager:M||(d?(O.current||(O.current=new Uo({handleContainerOverflow:!1})),O.current):Vo()),transition:Bc,backdropTransition:zc,renderBackdrop:F,renderDialog:e=>(0,Bt.jsx)("div",E(E(E({},e),D),{},{className:Lt(r,s?"".concat(n,"-").concat(s):n,"".concat(n,"-").concat(a)),"aria-labelledby":o,ref:_,children:i})),mountDialogOnEnter:!1,unmountDialogOnExit:!1,portal:!1})})});Wc.displayName="Offcanvas";const Vc=Object.assign(Wc,{Body:Ac,Header:Ic,Title:Hc}),Uc=["onHide"],qc=g.forwardRef((e,t)=>{let{onHide:n}=e,r=b(e,Uc);const i=(0,g.useContext)(Pl),o=an(()=>{null==i||null==i.onToggle||i.onToggle(),null==n||n()});return(0,Bt.jsx)(Vc,E(E({ref:t,show:!(null==i||!i.expanded)},r),{},{onHide:o}))});qc.displayName="NavbarOffcanvas";const Gc=qc,Yc=["className","bsPrefix","as"],Kc=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i="span"}=e,o=b(e,Yc);return r=Gt(r,"navbar-text"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r)},o))});Kc.displayName="NavbarText";const $c=Kc,Xc=["bsPrefix","expand","variant","bg","fixed","sticky","className","as","expanded","onToggle","onSelect","collapseOnSelect"],Qc=g.forwardRef((e,t)=>{const n=rn(e,{expanded:"onToggle"}),{bsPrefix:r,expand:i=!0,variant:o="light",bg:a,fixed:s,sticky:l,className:c,as:u="nav",expanded:d,onToggle:h,onSelect:f,collapseOnSelect:m=!1}=n,p=b(n,Xc),v=Gt(r,"navbar"),y=(0,g.useCallback)(function(){null==f||f(...arguments),m&&d&&(null==h||h(!1))},[f,m,d,h]);void 0===p.role&&"nav"!==u&&(p.role="navigation");let w="".concat(v,"-expand");"string"===typeof i&&(w="".concat(w,"-").concat(i));const x=(0,g.useMemo)(()=>({onToggle:()=>null==h?void 0:h(!d),bsPrefix:v,expanded:!!d,expand:i}),[v,d,i,h]);return(0,Bt.jsx)(Pl.Provider,{value:x,children:(0,Bt.jsx)(ll.Provider,{value:y,children:(0,Bt.jsx)(u,E(E({ref:t},p),{},{className:Lt(c,v,i&&w,o&&"".concat(v,"-").concat(o),a&&"bg-".concat(a),l&&"sticky-".concat(l),s&&"fixed-".concat(s))}))})})});Qc.displayName="Navbar";const Jc=Object.assign(Qc,{Brand:ac,Collapse:gc,Offcanvas:Gc,Text:$c,Toggle:bc}),Zc=["as","onSelect","activeKey","role","onKeyDown"];const eu=()=>{},tu=co("event-key"),nu=g.forwardRef((e,t)=>{let{as:n="div",onSelect:r,activeKey:i,role:o,onKeyDown:a}=e,s=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,Zc);const l=ya(),c=(0,g.useRef)(!1),u=(0,g.useContext)(ll),d=(0,g.useContext)(Yl);let h,f;d&&(o=o||"tablist",i=d.activeKey,h=d.getControlledId,f=d.getControllerId);const m=(0,g.useRef)(null),p=e=>{const t=m.current;if(!t)return null;const n=Fo(t,"[".concat(tu,"]:not([aria-disabled=true])")),r=t.querySelector("[aria-selected=true]");if(!r||r!==document.activeElement)return null;const i=n.indexOf(r);if(-1===i)return null;let o=i+e;return o>=n.length&&(o=0),o<0&&(o=n.length-1),n[o]},v=(e,t)=>{null!=e&&(null==r||r(e,t),null==u||u(e,t))};(0,g.useEffect)(()=>{if(m.current&&c.current){const e=m.current.querySelector("[".concat(tu,"][aria-selected=true]"));null==e||e.focus()}c.current=!1});const y=er(t,m);return(0,Bt.jsx)(ll.Provider,{value:v,children:(0,Bt.jsx)(ul.Provider,{value:{role:o,activeKey:sl(i),getControlledId:h||eu,getControllerId:f||eu},children:(0,Bt.jsx)(n,Object.assign({},s,{onKeyDown:e=>{if(null==a||a(e),!d)return;let t;switch(e.key){case"ArrowLeft":case"ArrowUp":t=p(-1);break;case"ArrowRight":case"ArrowDown":t=p(1);break;default:return}var n;t&&(e.preventDefault(),v(t.dataset[(n="EventKey","".concat("rrUi").concat(n))]||null,e),c.current=!0,l())},ref:y,role:o}))})})});nu.displayName="Nav";const ru=Object.assign(nu,{Item:Ql}),iu=["className","bsPrefix","as"],ou=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i="div"}=e,o=b(e,iu);return r=Gt(r,"nav-item"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r)},o))});ou.displayName="NavItem";const au=ou,su=["as","bsPrefix","variant","fill","justify","navbar","navbarScroll","className","activeKey"],lu=g.forwardRef((e,t)=>{const n=rn(e,{activeKey:"onSelect"}),{as:r="div",bsPrefix:i,variant:o,fill:a=!1,justify:s=!1,navbar:l,navbarScroll:c,className:u,activeKey:d}=n,h=b(n,su),f=Gt(i,"nav");let m,p,v=!1;const y=(0,g.useContext)(Pl),w=(0,g.useContext)(Er);return y?(m=y.bsPrefix,v=null==l||l):w&&({cardHeaderBsPrefix:p}=w),(0,Bt.jsx)(ru,E({as:r,ref:t,activeKey:d,className:Lt(u,{[f]:!v,["".concat(m,"-nav")]:v,["".concat(m,"-nav-scroll")]:v&&c,["".concat(p,"-").concat(o)]:!!p,["".concat(f,"-").concat(o)]:!!o,["".concat(f,"-fill")]:a,["".concat(f,"-justified")]:s})},h))});lu.displayName="Nav";const cu=Object.assign(lu,{Item:au,Link:ec}),uu=[{src:"/SalmanWipro-directory/ConstructionImage/Sunrise_Residency.PNG",alt:"Construction Site 1"},{src:"/SalmanWipro-directory/ConstructionImage/Oceanic_Towers.PNG",alt:"Construction Site 2"},{src:"/SalmanWipro-directory/ConstructionImage/Lakeview_Apartments.PNG",alt:"Construction Site 3"},{src:"/SalmanWipro-directory/ConstructionImage/Metro_City_Homes.PNG",alt:"Construction Site 4"}];const du=function(){const[e,t]=(0,g.useState)(0);return g.useEffect(()=>{const e=setInterval(()=>{t(e=>(e+1)%uu.length)},3e3);return()=>clearInterval(e)},[]),(0,Bt.jsx)("section",{className:"w-100 py-4 d-flex justify-content-center align-items-center",style:{margin:0,padding:0},children:(0,Bt.jsxs)("div",{style:{maxWidth:"800px",width:"100%",margin:0,padding:0},children:[(0,Bt.jsxs)("div",{className:"d-flex justify-content-center align-items-center mb-3",children:[(0,Bt.jsx)("button",{className:"btn btn-outline-secondary me-2",onClick:()=>t((e-1+uu.length)%uu.length),children:"<"}),(0,Bt.jsx)("img",{src:uu[e].src,alt:uu[e].alt,className:"img-fluid rounded shadow",style:{width:"100%",maxWidth:"800px",height:"220px",objectFit:"cover"}}),(0,Bt.jsx)("button",{className:"btn btn-outline-secondary ms-2",onClick:()=>t((e+1)%uu.length),children:">"})]}),(0,Bt.jsx)("div",{className:"d-flex justify-content-center",children:uu.map((n,r)=>(0,Bt.jsx)("button",{className:"btn btn-sm mx-1 ".concat(r===e?"btn-primary":"btn-outline-primary"),style:{borderRadius:"50%",width:18,height:18,padding:0},onClick:()=>t(r)},r))})]})})},hu=["bsPrefix","className","as"],fu=g.forwardRef((e,t)=>{let{bsPrefix:n,className:r,as:i="div"}=e,o=b(e,hu);const a=Gt(n,"row"),s=Yt(),l=Kt(),c="".concat(a,"-cols"),u=[];return s.forEach(e=>{const t=o[e];let n;delete o[e],null!=t&&"object"===typeof t?({cols:n}=t):n=t;const r=e!==l?"-".concat(e):"";null!=n&&u.push("".concat(c).concat(r,"-").concat(n))}),(0,Bt.jsx)(i,E(E({ref:t},o),{},{className:Lt(r,a,...u)}))});fu.displayName="Row";const mu=fu;const pu=function(e){let{onBack:t,projectId:n,allProjects:r}=e;const i=r.find(e=>e.id===n)||{},o=i.projectdocuments&&i.projectdocuments.length>0?i.projectdocuments:[{name:"Master Plan",url:"#"},{name:"Site Plan",url:"#"},{name:"Booking Form",url:"#"},{name:"Brochure",url:"#"}],a=Array.isArray(i.amenities)&&i.amenities.length>0?i.amenities:[{type:"indoor",items:["Gym","Club House","Indoor Games"]},{type:"outdoor",items:["Swimming Pool","Garden","Children Play Area"]}],s=i&&i.gallery&&i.gallery.length>0?i.gallery:["https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=800&q=80","https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=800&q=80","https://images.unsplash.com/photo-1432888498266-38ffec3eaf0a?auto=format&fit=crop&w=800&q=80","https://images.unsplash.com/photo-1429497419816-9ca5cfb4571a?auto=format&fit=crop&w=800&q=80"],[l,c]=g.useState(0),[u,d]=g.useState({lat:null,lng:null});return g.useEffect(()=>{const e=function(e){return e||""}(i.location);e&&fetch("https://nominatim.openstreetmap.org/search?format=json&q=".concat(encodeURIComponent(e))).then(e=>e.json()).then(e=>{e&&e.length>0?d({lat:e[0].lat,lng:e[0].lon}):d({lat:null,lng:null})}).catch(()=>d({lat:null,lng:null}))},[i.location]),g.useEffect(()=>{const e=setInterval(()=>{c(e=>(e+1)%s.length)},3e3);return()=>clearInterval(e)},[s.length]),i?(0,Bt.jsx)(Jt,{className:"more-details-page py-4",children:(0,Bt.jsxs)(Xr,{className:"mb-4 shadow-sm",children:[(0,Bt.jsxs)(Xr.Header,{className:"d-flex align-items-center justify-content-between",children:[(0,Bt.jsx)(gr,{variant:"outline-secondary",className:"back-btn",onClick:t,children:"\u2190 Back"}),(0,Bt.jsx)("h3",{className:"mb-0 ms-3",children:i.name})]}),(0,Bt.jsx)(Xr.Body,{children:(0,Bt.jsxs)(mu,{children:[(0,Bt.jsxs)(Ri,{md:6,className:"mb-3",children:[(0,Bt.jsx)(Xr,{className:"mb-3",children:(0,Bt.jsx)(Xr.Img,{variant:"top",src:i.image.startsWith("http")?i.image:"/SalmanWipro-directory/"+i.image,alt:i.name,className:"main-project-image"})}),(0,Bt.jsx)(Xr,{className:"mb-3",children:(0,Bt.jsxs)(Xr.Body,{children:[(0,Bt.jsx)(Xr.Title,{children:"Key Details"}),(0,Bt.jsxs)("ul",{className:"list-unstyled mb-0",children:[(0,Bt.jsxs)("li",{children:[(0,Bt.jsx)("b",{children:"Location:"})," ",i.location]}),(0,Bt.jsxs)("li",{children:[(0,Bt.jsx)("b",{children:"Floors:"})," ",i.floors]}),(0,Bt.jsxs)("li",{children:[(0,Bt.jsx)("b",{children:"Flats per Floor:"})," ",i.flatsPerFloor]}),(0,Bt.jsxs)("li",{children:[(0,Bt.jsx)("b",{children:"Price:"})," ",i.sellingPrice]}),(0,Bt.jsxs)("li",{children:[(0,Bt.jsx)("b",{children:"Start Date:"})," ",i.startDate]}),(0,Bt.jsxs)("li",{children:[(0,Bt.jsx)("b",{children:"End Date:"})," ",i.endDate]}),(0,Bt.jsxs)("li",{children:[(0,Bt.jsx)("b",{children:"Status:"})," ",i.status]})]})]})})]}),(0,Bt.jsxs)(Ri,{md:6,children:[(0,Bt.jsx)(Xr,{className:"mb-3",children:(0,Bt.jsxs)(Xr.Body,{children:[(0,Bt.jsx)(Xr.Title,{children:"Amenities"}),(0,Bt.jsx)(mu,{children:a.map((e,t)=>(0,Bt.jsxs)(Ri,{children:[(0,Bt.jsx)("h6",{children:e.type?e.type.charAt(0).toUpperCase()+e.type.slice(1):""}),(0,Bt.jsx)("ul",{className:"list-unstyled",children:e.items.map((e,t)=>(0,Bt.jsx)("li",{children:e},t))})]},e.type||t))})]})}),(0,Bt.jsx)(Xr,{className:"mb-3",children:(0,Bt.jsxs)(Xr.Body,{children:[(0,Bt.jsx)(Xr.Title,{children:"Gallery"}),(0,Bt.jsxs)("div",{className:"gallery-carousel-wrapper position-relative d-flex justify-content-center mb-2",style:{maxWidth:"400px",margin:"0 auto"},children:[(0,Bt.jsx)(gr,{variant:"outline-primary",className:"gallery-btn gallery-btn-left position-absolute",style:{top:"50%",left:"-32px",transform:"translateY(-50%)"},onClick:()=>c((l-1+s.length)%s.length),children:"<"}),(0,Bt.jsx)("img",{src:s[l],alt:"Gallery ".concat(l+1),className:"gallery-image rounded",style:{maxHeight:"220px",maxWidth:"100%",display:"block"}}),(0,Bt.jsx)(gr,{variant:"outline-primary",className:"gallery-btn gallery-btn-right position-absolute",style:{top:"50%",right:"-32px",transform:"translateY(-50%)"},onClick:()=>c((l+1)%s.length),children:">"})]}),(0,Bt.jsx)("div",{className:"gallery-indicators d-flex justify-content-center",children:s.map((e,t)=>(0,Bt.jsx)("span",{className:t===l?"indicator active mx-1":"indicator mx-1",style:{cursor:"pointer",width:12,height:12,borderRadius:"50%",background:t===l?"#1976d2":"#e0e0e0",display:"inline-block"},onClick:()=>c(t)},t))})]})}),(0,Bt.jsx)(Xr,{className:"mb-3",children:(0,Bt.jsxs)(Xr.Body,{children:[(0,Bt.jsx)(Xr.Title,{children:"Documents"}),(0,Bt.jsx)("div",{className:"d-flex flex-wrap gap-2",children:o.map((e,t)=>(0,Bt.jsxs)("a",{href:e.url,className:"btn btn-outline-primary",style:{minWidth:"120px",textAlign:"center"},download:!0,onClick:t=>{e.url&&"#"!==e.url||(t.preventDefault(),alert("No document available for download."))},children:[e.name,(0,Bt.jsx)("span",{style:{marginLeft:8,verticalAlign:"middle"},children:(0,Bt.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",fill:"currentColor",viewBox:"0 0 16 16",children:[(0,Bt.jsx)("path",{d:"M.5 9.9V14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V9.9a.5.5 0 0 0-1 0V14a.5.5 0 0 1-.5.5h-13A.5.5 0 0 1 .5 14V9.9a.5.5 0 0 0-1 0z"}),(0,Bt.jsx)("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})]})})]},t))})]})}),(0,Bt.jsx)(Xr,{className:"mb-3",children:(0,Bt.jsxs)(Xr.Body,{children:[(0,Bt.jsx)(Xr.Title,{children:"Virtual Tours"}),(0,Bt.jsxs)("div",{className:"mb-3",children:[(0,Bt.jsx)("strong",{children:"360\xb0 Walkthrough & Video Tour"}),(0,Bt.jsx)("div",{className:"ratio ratio-16x9 mt-2 mb-2",style:{borderRadius:"12px",overflow:"hidden",boxShadow:"0 2px 8px rgba(33,150,243,0.08)"},children:(0,Bt.jsx)("iframe",{src:"https://www.youtube.com/embed/1La4QzGeaaQ",title:"360\xb0 Virtual Tour Demo",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0,style:{width:"100%",height:"100%",border:0}})}),(0,Bt.jsx)("div",{className:"mt-2",children:(0,Bt.jsx)("a",{href:"https://arvr.google.com/",target:"_blank",rel:"noopener noreferrer",className:"btn btn-outline-primary btn-sm",children:"Try Augmented Reality (AR) Demo"})})]}),(0,Bt.jsx)("div",{className:"text-secondary small",children:"Experience immersive 360\xb0 walkthroughs and AR for your future home."})]})}),(0,Bt.jsx)(Xr,{className:"mb-3",children:(0,Bt.jsxs)(Xr.Body,{children:[(0,Bt.jsx)(Xr.Title,{children:"Location"}),(0,Bt.jsx)("div",{className:"map-container",children:u.lat&&u.lng?(0,Bt.jsx)("iframe",{title:"Google Map",width:"100%",height:"180",frameBorder:"0",style:{border:0,borderRadius:"12px"},src:"https://www.google.com/maps?q=".concat(u.lat,",").concat(u.lng,"&z=15&output=embed"),allowFullScreen:!0}):(0,Bt.jsx)("div",{style:{padding:"2rem",textAlign:"center",color:"#888"},children:"Map not available for this location"})})]})})]})]})})]})}):(0,Bt.jsx)("div",{children:"Project not found"})},gu=[{key:"completed",label:"Completed",icon:"\ud83c\udfc6",showProgress:!1},{key:"running",label:"Running",icon:"\ud83c\udfd7\ufe0f",showProgress:!0},{key:"upcoming",label:"Upcoming",icon:"\ud83d\udea7",showProgress:!1}];function vu(e){let{title:t,projects:n,showProgress:r=!0}=e;return(0,Bt.jsx)("div",{className:"container-fluid mt-3 px-3",children:(0,Bt.jsx)("div",{className:"row",children:n.map((e,t)=>(0,Bt.jsx)("div",{className:"col-12 col-md-6 col-lg-3 mb-4",children:(0,Bt.jsxs)("div",{className:"card h-100 shadow-sm d-flex flex-column",children:[e.image&&(0,Bt.jsx)("img",{src:e.image.startsWith("http")?e.image:"/SalmanWipro-directory/"+e.image,alt:e.name,className:"card-img-top",style:{marginTop:0,paddingTop:0,borderTopLeftRadius:"0.5rem",borderTopRightRadius:"0.5rem"}}),(0,Bt.jsxs)("div",{className:"card-body d-flex flex-column",children:[(0,Bt.jsx)("h5",{className:"card-title",children:e.name}),(0,Bt.jsx)("h6",{className:"card-subtitle mb-2 text-muted",children:e.location}),(0,Bt.jsx)("div",{className:"mb-2",children:e.status}),"running"===e.status&&(0,Bt.jsx)("div",{className:"mb-2",children:(0,Bt.jsxs)("span",{className:"fw-bold",children:["Progress: ",e.progress,"%"]})}),(0,Bt.jsx)("button",{type:"button",className:"btn btn-outline-primary mt-auto",id:e.id,onClick:()=>e.onKnowMore(),children:"More Details"})]})]})},"".concat(e.id,"-").concat(t)))})})}const yu=function(){const[e,t]=(0,g.useState)("completed"),[n,r]=(0,g.useState)(null),[i,o]=(0,g.useState)(""),[a,s]=(0,g.useState)(""),[l,c]=(0,g.useState)(null),[u,d]=(0,g.useState)(!1),[h,f]=(0,g.useState)(null),[m,p]=(0,g.useState)(""),[v,y]=(0,g.useState)(""),[b,w]=(0,g.useState)(""),[x,S]=(0,g.useState)(""),[C,N]=(0,g.useState)(""),[T,A]=(0,g.useState)(""),[R,k]=(0,g.useState)(""),M=gu.find(t=>t.key===e);let D=[];if(g.useEffect(()=>{t("completed");fetch("".concat("https://buildproapi.onrender.com","/api/projects")).then(e=>e.json()).then(e=>{let t;Array.isArray(e)?t={completed:e.filter(e=>"completed"===e.status),running:e.filter(e=>"running"===e.status),upcoming:e.filter(e=>"upcoming"===e.status)}:(t=e,e.completed),r(t),t.completed&&Array.isArray(t.completed)?c(t.completed):(console.warn("processedData.completed is not an array or does not exist"),c([]))}).catch(e=>{console.error("Error fetching projects:",e),r(null),c([])})},[]),!n)return(0,Bt.jsx)("div",{children:"Loading..."});const _=[...n.completed||[],...n.running||[],...n.upcoming||[]],O=Array.from(new Set(_.map(e=>e.location)));null!==l?D=l:("completed"===e&&(D=n.completed||[]),"running"===e&&(D=n.running||[]),"upcoming"===e&&(D=n.upcoming||[]));const I=null!==l?a?{key:a,label:a.charAt(0).toUpperCase()+a.slice(1),icon:"\ud83d\udd0d"}:{key:"all",label:"All",icon:"\ud83d\udd0d"}:M,P=D.map(e=>E(E({},e),{},{onKnowMore:()=>{f(e.id),d(!0)}})),j=()=>{d(!1),f(null)};if(u&&h)return(0,Bt.jsx)(pu,{onBack:j,projectId:h,allProjects:_});function F(e,n){if(console.log("Searching with:",{location:e,status:n}),console.log("All projects:",_),!e&&!n)return c(null),void t("completed");let r=_;e&&(r=r.filter(t=>t.location===e),console.log("After location filter:",r)),n&&(r=r.filter(e=>e.status&&e.status.toLowerCase()===n.toLowerCase()),console.log("After status filter:",r)),console.log("Final filtered projects:",r),c(r),t("filtered")}return(0,Bt.jsxs)("div",{className:"container-fluid px-0",children:[(0,Bt.jsx)(du,{}),(0,Bt.jsx)("div",{className:"card mt-4 mb-4 shadow-sm",children:(0,Bt.jsx)("div",{className:"card-body",children:(0,Bt.jsxs)("div",{className:"row g-3 align-items-end",children:[(0,Bt.jsx)("div",{className:"col-12 col-md-6",children:(0,Bt.jsxs)("div",{className:"mb-3",children:[(0,Bt.jsx)("label",{htmlFor:"location-select",className:"form-label",children:"By Location"}),(0,Bt.jsxs)("select",{id:"location-select",className:"form-select",value:i,onChange:e=>{const t=e.target.value;o(t),F(t,a)},children:[(0,Bt.jsx)("option",{value:"",children:"All"}),O.map(e=>(0,Bt.jsx)("option",{value:e,children:e},e))]})]})}),(0,Bt.jsx)("div",{className:"col-12 col-md-6",children:(0,Bt.jsxs)("div",{className:"mb-3",children:[(0,Bt.jsx)("label",{htmlFor:"status-select",className:"form-label",children:"By Status"}),(0,Bt.jsxs)("select",{id:"status-select",className:"form-select",value:a,onChange:e=>{const t=e.target.value;s(t),F(i,t)},children:[(0,Bt.jsx)("option",{value:"completed",children:"Completed"}),(0,Bt.jsx)("option",{value:"running",children:"Running"}),(0,Bt.jsx)("option",{value:"upcoming",children:"Upcoming"}),(0,Bt.jsx)("option",{value:"",children:"All"})]})]})})]})})}),(0,Bt.jsx)(vu,{title:"".concat(I.icon," ").concat(I.label," Projects"),projects:P,showProgress:I.showProgress}),(0,Bt.jsx)("div",{className:"container mt-3 mb-5",children:(0,Bt.jsxs)("div",{className:"card shadow-sm",children:[(0,Bt.jsx)("div",{className:"card-header bg-primary text-white",children:(0,Bt.jsx)("h4",{className:"mb-0",children:"Enquire Now"})}),(0,Bt.jsx)("div",{className:"card-body",children:(0,Bt.jsxs)("form",{className:"row g-3",onSubmit:function(e){if(e.preventDefault(),A(""),k(""),!m||!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(v)||!function(e){return/^[0-9]{10}$/.test(e)}(x)||!b||!C)return void A("Please fill all fields with valid email and 10-digit phone number.");const t=encodeURIComponent("Enquiry for ".concat(b)),n=encodeURIComponent("Name: ".concat(m,"\nEmail: ").concat(v,"\nPhone: ").concat(x,"\nProject: ").concat(b,"\nMessage: ").concat(C));window.location.href="mailto:".concat(v,"?subject=").concat(t,"&body=").concat(n);const r=encodeURIComponent("Enquiry for ".concat(b,":\n").concat(C,"\nName: ").concat(m,", Phone: ").concat(x,", Email: ").concat(v));window.open("https://wa.me/".concat(x,"?text=").concat(r),"_blank"),k("Your enquiry has been sent!"),p(""),y(""),w(""),S(""),N("")},autoComplete:"off",children:[(0,Bt.jsx)("div",{className:"col-12 col-md-6",children:(0,Bt.jsx)("input",{type:"text",className:"form-control",id:"enq-name",placeholder:"Name",required:!0,value:m,onChange:e=>p(e.target.value)})}),(0,Bt.jsx)("div",{className:"col-12 col-md-6",children:(0,Bt.jsx)("input",{type:"email",className:"form-control",id:"enq-email",placeholder:"Email",required:!0,value:v,onChange:e=>y(e.target.value)})}),(0,Bt.jsx)("div",{className:"col-12 col-md-6",children:(0,Bt.jsxs)("select",{className:"form-select",id:"enq-project",required:!0,value:b,onChange:e=>w(e.target.value),children:[(0,Bt.jsx)("option",{value:"",children:"Select project"}),_.map((e,t)=>(0,Bt.jsx)("option",{value:e.name,children:e.name},"".concat(e.id,"-").concat(t)))]})}),(0,Bt.jsx)("div",{className:"col-12 col-md-6",children:(0,Bt.jsx)("input",{type:"tel",className:"form-control",id:"enq-phone",placeholder:"Phone No.",pattern:"[0-9]{10}",maxLength:10,required:!0,value:x,onChange:e=>S(e.target.value)})}),(0,Bt.jsx)("div",{className:"col-12",children:(0,Bt.jsx)("textarea",{className:"form-control",id:"enq-message",placeholder:"Message",rows:"3",style:{resize:"vertical"},required:!0,value:C,onChange:e=>N(e.target.value)})}),T&&(0,Bt.jsx)("div",{className:"col-12",children:(0,Bt.jsx)("div",{className:"alert alert-danger py-2 mb-0",children:T})}),R&&(0,Bt.jsx)("div",{className:"col-12",children:(0,Bt.jsx)("div",{className:"alert alert-success py-2 mb-0",children:R})}),(0,Bt.jsx)("div",{className:"col-12 d-flex justify-content-end",children:(0,Bt.jsx)("button",{type:"submit",className:"btn btn-success px-4",children:"Submit"})})]})})]})})]})};const bu=function(){return(0,Bt.jsxs)("div",{className:"container py-4",children:[(0,Bt.jsxs)("section",{className:"mb-5 p-4 rounded shadow-sm",style:{background:"#eaf2fb"},children:[(0,Bt.jsx)("h2",{className:"text-primary mb-3",children:"Company Overview"}),(0,Bt.jsxs)("div",{className:"row align-items-center",children:[(0,Bt.jsxs)("div",{className:"col-md-8",children:[(0,Bt.jsxs)("p",{children:[(0,Bt.jsx)("strong",{children:"Founded:"})," 2005"]}),(0,Bt.jsxs)("p",{children:[(0,Bt.jsx)("strong",{children:"Mission:"})," To deliver innovative, sustainable, and high-quality construction solutions."]}),(0,Bt.jsxs)("p",{children:[(0,Bt.jsx)("strong",{children:"Vision:"})," To be the most trusted name in real estate development."]}),(0,Bt.jsx)("ul",{className:"list-unstyled mt-3",children:(0,Bt.jsxs)("li",{children:[(0,Bt.jsx)("span",{className:"badge bg-primary me-2",children:"Integrity"})," ",(0,Bt.jsx)("span",{className:"badge bg-success me-2",children:"Innovation"})," ",(0,Bt.jsx)("span",{className:"badge bg-info",children:"Sustainability"})]})})]}),(0,Bt.jsx)("div",{className:"col-md-4 text-center",children:(0,Bt.jsx)("img",{src:"/SalmanWipro-directory/ConstructionImage/Metro_City_Homes.PNG",alt:"Company",className:"img-fluid rounded shadow",style:{maxHeight:120}})})]})]}),(0,Bt.jsxs)("section",{className:"mb-5 p-4 rounded shadow-sm",style:{background:"#f8f9fa"},children:[(0,Bt.jsx)("h2",{className:"text-primary mb-3",children:"Leadership & Team"}),(0,Bt.jsxs)("div",{className:"row g-4",children:[(0,Bt.jsxs)("div",{className:"col-md-3 text-center",children:[(0,Bt.jsx)("img",{src:"/SalmanWipro-directory/ConstructionImage/Skyline_Heights.PNG",alt:"CEO",className:"img-fluid rounded-circle mb-2",style:{width:80,height:80,objectFit:"cover"}}),(0,Bt.jsx)("h5",{className:"mb-1",children:"Reza Kawsar"}),(0,Bt.jsx)("p",{className:"text-muted small",children:"CEO, PMP, 20+ yrs experience"})]}),(0,Bt.jsxs)("div",{className:"col-md-3 text-center",children:[(0,Bt.jsx)("img",{src:"/SalmanWipro-directory/ConstructionImage/Garden_Estate.PNG",alt:"CTO",className:"img-fluid rounded-circle mb-2",style:{width:80,height:80,objectFit:"cover"}}),(0,Bt.jsx)("h5",{className:"mb-1",children:"Reza Kawsar"}),(0,Bt.jsx)("p",{className:"text-muted small",children:"CTO, LEED AP, 15+ yrs experience"})]}),(0,Bt.jsxs)("div",{className:"col-md-3 text-center",children:[(0,Bt.jsx)("img",{src:"/SalmanWipro-directory/ConstructionImage/Hilltop_Villas.PNG",alt:"Project Manager",className:"img-fluid rounded-circle mb-2",style:{width:80,height:80,objectFit:"cover"}}),(0,Bt.jsx)("h5",{className:"mb-1",children:"Priya Sharma"}),(0,Bt.jsx)("p",{className:"text-muted small",children:"Project Manager, Civil Engg."})]}),(0,Bt.jsxs)("div",{className:"col-md-3 text-center",children:[(0,Bt.jsx)("img",{src:"/SalmanWipro-directory/ConstructionImage/Lakeview_Apartments.PNG",alt:"Architect",className:"img-fluid rounded-circle mb-2",style:{width:80,height:80,objectFit:"cover"}}),(0,Bt.jsx)("h5",{className:"mb-1",children:"Ravi Verma"}),(0,Bt.jsx)("p",{className:"text-muted small",children:"Lead Architect, M.Arch"})]})]}),(0,Bt.jsx)("div",{className:"mt-3 text-center text-secondary",children:"Our collaborative, client-first culture drives every project to success."})]}),(0,Bt.jsxs)("section",{className:"mb-5 p-4 rounded shadow-sm",style:{background:"#eaf2fb"},children:[(0,Bt.jsx)("h2",{className:"text-primary mb-3",children:"Project Portfolio Highlights"}),(0,Bt.jsxs)("div",{className:"row g-4",children:[(0,Bt.jsxs)("div",{className:"col-md-4",children:[(0,Bt.jsx)("img",{src:"/SalmanWipro-directory/ConstructionImage/Sunrise_Residency.PNG",alt:"Sunrise Residency",className:"img-fluid rounded shadow mb-2"}),(0,Bt.jsx)("h6",{children:"Sunrise Residency"}),(0,Bt.jsx)("p",{className:"small",children:"2020-2023 | 120 units | Green Building Award"})]}),(0,Bt.jsxs)("div",{className:"col-md-4",children:[(0,Bt.jsx)("img",{src:"/SalmanWipro-directory/ConstructionImage/Oceanic_Towers.PNG",alt:"Oceanic Towers",className:"img-fluid rounded shadow mb-2"}),(0,Bt.jsx)("h6",{children:"Oceanic Towers"}),(0,Bt.jsx)("p",{className:"small",children:"2018-2021 | 200 units | Landmark Project"})]}),(0,Bt.jsxs)("div",{className:"col-md-4",children:[(0,Bt.jsx)("img",{src:"/SalmanWipro-directory/ConstructionImage/Green_Valley_Residency.PNG",alt:"Green Valley",className:"img-fluid rounded shadow mb-2"}),(0,Bt.jsx)("h6",{children:"Green Valley Residency"}),(0,Bt.jsx)("p",{className:"small",children:"2016-2019 | 80 units | Sustainability Award"})]})]}),(0,Bt.jsx)("div",{className:"mt-3 text-end",children:(0,Bt.jsx)("a",{href:"#portfolio",className:"btn btn-outline-primary btn-sm",children:"View Full Portfolio"})})]}),(0,Bt.jsxs)("section",{className:"mb-5 p-4 rounded shadow-sm",style:{background:"#f8f9fa"},children:[(0,Bt.jsx)("h2",{className:"text-primary mb-3",children:"Client Testimonials"}),(0,Bt.jsxs)("div",{className:"row g-4",children:[(0,Bt.jsx)("div",{className:"col-md-6",children:(0,Bt.jsxs)("blockquote",{className:"blockquote border-start border-3 ps-3 mb-0",style:{borderColor:"#003366"},children:[(0,Bt.jsx)("p",{children:'"BuildPro exceeded our expectations in every way. On-time delivery and top-notch quality!"'}),(0,Bt.jsx)("footer",{className:"blockquote-footer",children:"Amit Gupta, Sunrise Residency"})]})}),(0,Bt.jsx)("div",{className:"col-md-6",children:(0,Bt.jsxs)("blockquote",{className:"blockquote border-start border-3 ps-3 mb-0",style:{borderColor:"#003366"},children:[(0,Bt.jsx)("p",{children:'"Professional, transparent, and innovative. Highly recommended for any real estate project."'}),(0,Bt.jsx)("footer",{className:"blockquote-footer",children:"Neha Jain, Oceanic Towers"})]})})]})]}),(0,Bt.jsxs)("section",{className:"mb-5 p-4 rounded shadow-sm",style:{background:"#eaf2fb"},children:[(0,Bt.jsx)("h2",{className:"text-primary mb-3",children:"Licenses, Certifications & Awards"}),(0,Bt.jsxs)("div",{className:"row g-4",children:[(0,Bt.jsx)("div",{className:"col-md-4",children:(0,Bt.jsxs)("div",{className:"bg-white rounded p-3 shadow-sm text-center",children:[(0,Bt.jsx)("span",{className:"fw-bold text-success",children:"ISO 9001:2015"}),(0,Bt.jsx)("div",{className:"small text-muted",children:"Quality Management"})]})}),(0,Bt.jsx)("div",{className:"col-md-4",children:(0,Bt.jsxs)("div",{className:"bg-white rounded p-3 shadow-sm text-center",children:[(0,Bt.jsx)("span",{className:"fw-bold text-info",children:"LEED Gold"}),(0,Bt.jsx)("div",{className:"small text-muted",children:"Green Building"})]})}),(0,Bt.jsx)("div",{className:"col-md-4",children:(0,Bt.jsxs)("div",{className:"bg-white rounded p-3 shadow-sm text-center",children:[(0,Bt.jsx)("span",{className:"fw-bold text-warning",children:"RERA Registered"}),(0,Bt.jsx)("div",{className:"small text-muted",children:"Real Estate Regulatory"})]})})]}),(0,Bt.jsxs)("div",{className:"mt-3 text-end",children:[(0,Bt.jsx)("span",{className:"badge bg-success me-2",children:"Best Developer 2023"}),(0,Bt.jsx)("span",{className:"badge bg-primary",children:"Sustainability Award"})]})]}),(0,Bt.jsxs)("section",{className:"mb-5 p-4 rounded shadow-sm",style:{background:"#f8f9fa"},children:[(0,Bt.jsx)("h2",{className:"text-primary mb-3",children:"Community Engagement"}),(0,Bt.jsxs)("div",{className:"row g-4",children:[(0,Bt.jsx)("div",{className:"col-md-6",children:(0,Bt.jsxs)("div",{className:"bg-white rounded p-3 shadow-sm",children:[(0,Bt.jsx)("h6",{className:"text-success",children:"CSR Initiatives"}),(0,Bt.jsx)("p",{className:"mb-0",children:"Annual blood donation camps, local school sponsorships, and skill development workshops."})]})}),(0,Bt.jsx)("div",{className:"col-md-6",children:(0,Bt.jsxs)("div",{className:"bg-white rounded p-3 shadow-sm",children:[(0,Bt.jsx)("h6",{className:"text-info",children:"Sustainability Efforts"}),(0,Bt.jsx)("p",{className:"mb-0",children:"Rainwater harvesting, solar panels, and eco-friendly construction materials."})]})})]})]}),(0,Bt.jsxs)("section",{className:"mb-5 p-4 rounded shadow-sm",style:{background:"#eaf2fb"},children:[(0,Bt.jsx)("h2",{className:"text-primary mb-3",children:"Why Choose Us"}),(0,Bt.jsxs)("div",{className:"row g-4",children:[(0,Bt.jsx)("div",{className:"col-md-4",children:(0,Bt.jsxs)("div",{className:"bg-white rounded p-3 shadow-sm text-center",children:[(0,Bt.jsx)("span",{className:"fw-bold text-primary",children:"On-Time Delivery"}),(0,Bt.jsx)("div",{className:"small text-muted",children:"98% projects delivered before deadline"})]})}),(0,Bt.jsx)("div",{className:"col-md-4",children:(0,Bt.jsxs)("div",{className:"bg-white rounded p-3 shadow-sm text-center",children:[(0,Bt.jsx)("span",{className:"fw-bold text-success",children:"Design Excellence"}),(0,Bt.jsx)("div",{className:"small text-muted",children:"Award-winning architects & engineers"})]})}),(0,Bt.jsx)("div",{className:"col-md-4",children:(0,Bt.jsxs)("div",{className:"bg-white rounded p-3 shadow-sm text-center",children:[(0,Bt.jsx)("span",{className:"fw-bold text-info",children:"Client-First Approach"}),(0,Bt.jsx)("div",{className:"small text-muted",children:"Personalized service & transparency"})]})})]})]}),(0,Bt.jsxs)("section",{className:"mb-4 p-4 rounded shadow-sm",style:{background:"#f8f9fa"},children:[(0,Bt.jsx)("h2",{className:"text-primary mb-3",children:"Visuals & Branding"}),(0,Bt.jsxs)("div",{className:"row g-4",children:[(0,Bt.jsx)("div",{className:"col-md-4",children:(0,Bt.jsx)("img",{src:"/SalmanWipro-directory/ConstructionImage/Metro_City_Homes.PNG",alt:"Office",className:"img-fluid rounded shadow"})}),(0,Bt.jsx)("div",{className:"col-md-4",children:(0,Bt.jsx)("img",{src:"/SalmanWipro-directory/ConstructionImage/Riverfront_Residency.PNG",alt:"Team",className:"img-fluid rounded shadow"})}),(0,Bt.jsx)("div",{className:"col-md-4",children:(0,Bt.jsx)("img",{src:"/SalmanWipro-directory/ConstructionImage/Skyline_Heights.PNG",alt:"Site",className:"img-fluid rounded shadow"})})]}),(0,Bt.jsx)("div",{className:"mt-3 text-secondary text-center",children:"Consistent colors, fonts, and tone reflect our brand identity."})]})]})};const wu=function(){return(0,Bt.jsxs)("div",{className:"construction-contact",children:[(0,Bt.jsx)("h2",{children:"Contact Us"}),(0,Bt.jsx)("p",{children:"Email: info@construction.com"})]})},xu=["Site Preparation","Foundation","Framing","Roofing","Electrical & Plumbing","Interior Finishing","Landscaping"],Su={"Site Preparation":{estimated:5e5,actual:52e4},Foundation:{estimated:12e5,actual:125e4},Framing:{estimated:2e6,actual:195e4},Roofing:{estimated:8e5,actual:85e4},"Electrical & Plumbing":{estimated:9e5,actual:95e4},"Interior Finishing":{estimated:15e5,actual:16e5},Landscaping:{estimated:4e5,actual:39e4}};const Cu=function(){const[e,t]=(0,g.useState)([]),[n,r]=(0,g.useState)(""),[i,o]=(0,g.useState)(null);return(0,g.useEffect)(()=>{fetch("/SalmanWipro-directory/projects.json").then(e=>e.json()).then(e=>{const n=[...e.completed,...e.running,...e.upcoming];t(n)})},[]),(0,g.useEffect)(()=>{o(n?e.find(e=>e.id===Number(n)):null)},[n,e]),(0,Bt.jsx)(Jt,{className:"construction-report py-4",children:(0,Bt.jsxs)(Xr,{className:"mb-4 shadow-sm",children:[(0,Bt.jsx)(Xr.Header,{as:"h3",className:"bg-primary text-white",children:"Building Construction Report"}),(0,Bt.jsxs)(Xr.Body,{children:[(0,Bt.jsxs)(Ki.Group,{as:mu,className:"mb-4 report-dropdown-section",controlId:"project-select",children:[(0,Bt.jsx)(Ki.Label,{column:!0,sm:3,className:"dropdown-label",children:"Select Project:"}),(0,Bt.jsx)(Ri,{sm:9,children:(0,Bt.jsxs)(Ki.Select,{className:"modern-dropdown",value:n,onChange:e=>r(e.target.value),children:[(0,Bt.jsx)("option",{value:"",children:"-- Select --"}),e.map(e=>(0,Bt.jsx)("option",{value:e.id,children:e.name},e.id))]})})]}),i&&(0,Bt.jsxs)(Xr,{className:"mb-4 report-summary-section card-style",children:[(0,Bt.jsx)(Xr.Header,{children:(0,Bt.jsx)("h4",{className:"mb-0 section-heading",children:"Project Summary"})}),(0,Bt.jsx)(Xr.Body,{children:(0,Bt.jsxs)(mu,{className:"summary-grid",children:[(0,Bt.jsxs)(Ri,{children:[(0,Bt.jsx)("span",{className:"summary-label",children:"Location:"})," ",i.location]}),(0,Bt.jsxs)(Ri,{children:[(0,Bt.jsx)("span",{className:"summary-label",children:"Start Date:"})," ",i.startDate?new Date(i.startDate).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"2-digit"}):""]}),(0,Bt.jsxs)(Ri,{children:[(0,Bt.jsx)("span",{className:"summary-label",children:"End Date:"})," ",i.endDate?new Date(i.endDate).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"2-digit"}):""]})]})})]}),i&&(0,Bt.jsxs)(Xr,{className:"mb-4 report-phase-table-section card-style",children:[(0,Bt.jsx)(Xr.Header,{children:(0,Bt.jsx)("h4",{className:"mb-0 section-heading",children:"Phase Cost Tracking"})}),(0,Bt.jsx)(Xr.Body,{children:(0,Bt.jsx)("div",{className:"table-responsive",children:(0,Bt.jsxs)("table",{className:"table table-bordered align-middle",children:[(0,Bt.jsx)("thead",{className:"table-light",children:(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("th",{children:"Phase"}),(0,Bt.jsx)("th",{children:"Estimated Cost (\u20b9)"}),(0,Bt.jsx)("th",{children:"Actual Cost (\u20b9)"}),(0,Bt.jsx)("th",{children:"Variance (\u20b9)"}),(0,Bt.jsx)("th",{children:"Variance (%)"})]})}),(0,Bt.jsx)("tbody",{children:xu.map(e=>{var t,n;const r=(null===(t=Su[e])||void 0===t?void 0:t.estimated)||0,i=(null===(n=Su[e])||void 0===n?void 0:n.actual)||0,o=i-r,a=r?(o/r*100).toFixed(2):"0.00";return(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("td",{children:e}),(0,Bt.jsx)("td",{children:r.toLocaleString()}),(0,Bt.jsx)("td",{children:i.toLocaleString()}),(0,Bt.jsx)("td",{className:o>0?"text-danger":"text-success",children:o.toLocaleString()}),(0,Bt.jsxs)("td",{className:o>0?"text-danger":"text-success",children:[a,"%"]})]},e)})})]})})})]})]})]})})};const Eu=function(){return(0,Bt.jsxs)("div",{className:"cost-report-page",children:[(0,Bt.jsx)("h2",{children:"Cost Report"}),(0,Bt.jsx)("p",{children:"This is the Cost Report page. Add your cost report details here."})]})};var Nu=n(8233),Tu={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Au=Nu.createContext&&Nu.createContext(Tu),Ru=["attr","size","title"];function ku(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Mu(){return Mu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Mu.apply(this,arguments)}function Du(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Du(Object(n),!0).forEach(function(t){Ou(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Du(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ou(e,t,n){return t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Iu(e){return e&&e.map((e,t)=>Nu.createElement(e.tag,_u({key:t},e.attr),Iu(e.child)))}function Pu(e){return t=>Nu.createElement(ju,Mu({attr:_u({},e.attr)},t),Iu(e.child))}function ju(e){var t=t=>{var n,{attr:r,size:i,title:o}=e,a=ku(e,Ru),s=i||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),Nu.createElement("svg",Mu({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,a,{className:n,style:_u(_u({color:e.color||t.color},t.style),e.style),height:s,width:s,xmlns:"http://www.w3.org/2000/svg"}),o&&Nu.createElement("title",null,o),e.children)};return void 0!==Au?Nu.createElement(Au.Consumer,null,e=>t(e)):t(Tu)}function Fu(e){return Pu({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M413.1 222.5l22.2 22.2c9.4 9.4 9.4 24.6 0 33.9L241 473c-9.4 9.4-24.6 9.4-33.9 0L12.7 278.6c-9.4-9.4-9.4-24.6 0-33.9l22.2-22.2c9.5-9.5 25-9.3 34.3.4L184 343.4V56c0-13.3 10.7-24 24-24h32c13.3 0 24 10.7 24 24v287.4l114.8-120.5c9.3-9.8 24.8-10 34.3-.4z"},child:[]}]})(e)}function Hu(e){return Pu({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"},child:[]}]})(e)}function Lu(e){return Pu({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"},child:[]}]})(e)}function Bu(e){return Pu({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"},child:[]}]})(e)}function zu(e){return Pu({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(e)}function Wu(e){return Pu({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm60.1 106.5L224 336l60.1 93.5c5.1 8-.6 18.5-10.1 18.5h-34.9c-4.4 0-8.5-2.4-10.6-6.3C208.9 405.5 192 373 192 373c-6.4 14.8-10 20-36.6 68.8-2.1 3.9-6.1 6.3-10.5 6.3H110c-9.5 0-15.2-10.5-10.1-18.5l60.3-93.5-60.3-93.5c-5.2-8 .6-18.5 10.1-18.5h34.8c4.4 0 8.5 2.4 10.6 6.3 26.1 48.8 20 33.6 36.6 68.5 0 0 6.1-11.7 36.6-68.5 2.1-3.9 6.2-6.3 10.6-6.3H274c9.5-.1 15.2 10.4 10.1 18.4zM384 121.9v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(e)}function Vu(e){return Pu({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.976 0H24.028C2.71 0-8.047 25.866 7.058 40.971L192 225.941V432c0 7.831 3.821 15.17 10.237 19.662l80 55.98C298.02 518.69 320 507.493 320 487.98V225.941l184.947-184.97C520.021 25.896 509.338 0 487.976 0z"},child:[]}]})(e)}function Uu(e){return Pu({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(e)}function qu(e){return Pu({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},child:[]}]})(e)}function Gu(e){return Pu({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(e)}function Yu(e){return Pu({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(e)}function Ku(e){return Pu({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"},child:[]}]})(e)}function $u(e){return Pu({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(e)}function Xu(e){return Pu({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(e)}const Qu=function(){const[e,t]=(0,g.useState)([]),n=Me(),r=async()=>{try{const e="https://buildproapi.onrender.com",n=await fetch("".concat(e,"/api/projects")),r=await n.json();if(Array.isArray(r))t(r);else{let e=[];Array.isArray(r.completed)&&(e=e.concat(r.completed)),Array.isArray(r.running)&&(e=e.concat(r.running)),Array.isArray(r.upcoming)&&(e=e.concat(r.upcoming)),t(e)}}catch(mW){console.error("Error loading projects:",mW),t([])}};return(0,g.useEffect)(()=>{r()},[]),(0,Bt.jsxs)(Jt,{className:"py-4",children:[(0,Bt.jsx)(mu,{className:"mb-3",children:(0,Bt.jsx)(Ri,{className:"d-flex justify-content-end",children:(0,Bt.jsxs)(gr,{variant:"success",onClick:()=>{n("/ProjectManagementEntryForm")},title:"New Entry",children:[(0,Bt.jsx)(Gu,{})," New Entry"]})})}),(0,Bt.jsxs)(Xr,{className:"shadow-sm",children:[(0,Bt.jsx)(Xr.Header,{as:"h3",className:"bg-primary text-white",children:"Project Details"}),(0,Bt.jsx)(Xr.Body,{children:(0,Bt.jsxs)(Zr,{striped:!0,bordered:!0,hover:!0,responsive:!0,className:"align-middle",children:[(0,Bt.jsx)("thead",{className:"table-info",children:(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("th",{children:"Project Name"}),(0,Bt.jsx)("th",{children:"Location"}),(0,Bt.jsx)("th",{children:"Start Date"}),(0,Bt.jsx)("th",{children:"End Date"}),(0,Bt.jsx)("th",{className:"text-center",children:"Actions"})]})}),(0,Bt.jsx)("tbody",{children:e.map(e=>(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("td",{children:(0,Bt.jsx)(Mt,{to:"/ProjectManagementEntryForm",state:{project:e},className:"fw-bold text-decoration-underline",children:e.name})}),(0,Bt.jsx)("td",{children:e.location}),(0,Bt.jsx)("td",{children:e.startDate}),(0,Bt.jsx)("td",{children:e.endDate}),(0,Bt.jsx)("td",{className:"text-center",children:(0,Bt.jsxs)("div",{className:"d-flex flex-column flex-md-row justify-content-center align-items-center gap-2",children:[(0,Bt.jsx)(gr,{variant:"outline-primary",size:"sm",onClick:()=>(e=>{n("/ProjectManagementEntryForm",{state:{project:e,edit:!0}})})(e),title:"Edit",children:(0,Bt.jsx)(zu,{})}),(0,Bt.jsx)(gr,{variant:"outline-danger",size:"sm",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this project?"))try{const t="https://buildproapi.onrender.com";if(!(await fetch("".concat(t,"/api/projects/").concat(e),{method:"DELETE"})).ok)throw new Error("Failed to delete project");r(),alert("Project deleted successfully!")}catch(mW){console.error("Error deleting project:",mW),alert("Error deleting project: "+mW.message)}})(e._id),title:"Delete",children:(0,Bt.jsx)(Xu,{})})]})})]},e._id))})]})})]})]})},Ju=["title","children","bsPrefix","rootCloseEvent","variant","size","menuRole","renderMenuOnMount","disabled","href","id","menuVariant","flip"],Zu=g.forwardRef((e,t)=>{let{title:n,children:r,bsPrefix:i,rootCloseEvent:o,variant:a,size:s,menuRole:l,renderMenuOnMount:c,disabled:u,href:d,id:h,menuVariant:f,flip:m}=e,p=b(e,Ju);return(0,Bt.jsxs)(Gl,E(E({ref:t},p),{},{children:[(0,Bt.jsx)(Vl,{id:h,href:d,size:s,variant:a,disabled:u,childBsPrefix:i,children:n}),(0,Bt.jsx)(Bl,{role:l,renderOnMount:c,rootCloseEvent:o,variant:f,flip:m,children:r})]}))});Zu.displayName="DropdownButton";const ed=Zu,td=["Upcoming","Running","Completed"],nd=["Approval process","Planning & Design","Foundation work","Structural Framing","Roofing and Exterior","Interior Finishing","Fixtures and Fitting","Handover"],rd=["Master Plan","Site Plan","Booking Form","Brochure"],id=["Gym","Club House","Indoor Games","Yoga Room","Library"],od=["Swimming Pool","Garden","Children Play Area","Jogging Track","Tennis Court"];const ad=function(){const e=Me(),t=Ae(),n=t.state&&!0===t.state.edit,[r,i]=(0,g.useState)(""),[o,a]=(0,g.useState)(""),[s,l]=(0,g.useState)(""),[c,u]=(0,g.useState)(""),[d,h]=(0,g.useState)(1),[f,m]=(0,g.useState)(1),[p,v]=(0,g.useState)(""),[y,b]=(0,g.useState)(""),[w,x]=(0,g.useState)(""),[S,C]=(0,g.useState)("Upcoming"),[N,T]=(0,g.useState)({show:!1,type:"",message:""}),[A,R]=(0,g.useState)(!1),[k,M]=(0,g.useState)({type:"",data:"",name:""});(0,g.useEffect)(()=>{if(t.state&&t.state.project){const e=t.state.project;if(i(e.name||""),a(e.location||""),l(e.landArea||""),u(e.constructionArea||""),h(e.floors||1),m(e.flatsPerFloor||1),v(e.sellingPrice||""),b(e.startDate||""),x(e.endDate||""),C(e.status||"Upcoming"),e.stages&&Array.isArray(e.stages)){const t=nd.map(t=>{const n=e.stages.find(e=>"string"===typeof e?e===t:e.name===t);return n?"string"===typeof n?{name:t,involvement:!0,status:!1}:{name:t,involvement:n.involvement||!0,status:n.status||!1}:{name:t,involvement:!1,status:!1}});_(t)}if(e.amenities&&Array.isArray(e.amenities)){const t=e.amenities.find(e=>"indoor"===e.type),n=e.amenities.find(e=>"outdoor"===e.type);t&&t.items&&j(t.items),n&&n.items&&H(n.items)}if(e.projectdocuments&&Array.isArray(e.projectdocuments)){const t=rd.map(t=>{const n=e.projectdocuments.find(e=>e.name===t);return n?{name:t,file:{name:n.fileName||t,type:n.contentType||"application/octet-stream",data:n.data,isFromDB:!0}}:{name:t,file:null}});I(t)}}},[t.state]);const[D,_]=(0,g.useState)(nd.map(e=>({name:e,involvement:!1,status:!1}))),[O,I]=(0,g.useState)(rd.map(e=>({name:e,file:null}))),[P,j]=(0,g.useState)([]),[F,H]=(0,g.useState)([]),[L,B]=(0,g.useState)(!1),[z,W]=(0,g.useState)(!1),V=(0,g.useRef)(null),U=(0,g.useRef)(null);(0,g.useEffect)(()=>{function e(e){V.current&&!V.current.contains(e.target)&&B(!1),U.current&&!U.current.contains(e.target)&&W(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const q=(e,t)=>{_(D.map((n,r)=>r===e?E(E({},n),{},{[t]:!n[t]}):n))},G=e=>{M({type:e.type,data:e.data||URL.createObjectURL(e),name:e.name}),R(!0)},Y=()=>{R(!1),M({type:"",data:"",name:""})};return(0,Bt.jsxs)(Jt,{className:"py-4",children:[(0,Bt.jsx)("div",{className:"mb-3",children:(0,Bt.jsx)(gr,{variant:"outline-secondary",onClick:()=>e("/project-management"),children:"\u2190 Back to Project Management"})}),N.show&&(0,Bt.jsx)(fr,{variant:N.type,dismissible:!0,onClose:()=>T({show:!1,type:"",message:""}),style:{position:"sticky",top:"1rem",zIndex:1e3},children:N.message}),(0,Bt.jsxs)(Xr,{className:"mb-4 shadow-sm",children:[(0,Bt.jsx)(Xr.Header,{as:"h3",className:"bg-primary text-white",children:"Project Management"}),(0,Bt.jsx)(Xr.Body,{children:(0,Bt.jsxs)(Ki,{children:[(0,Bt.jsxs)(Xr,{className:"mb-4",children:[(0,Bt.jsx)(Xr.Header,{as:"h5",className:"bg-info text-white",children:"Project Details"}),(0,Bt.jsxs)(Xr.Body,{children:[(0,Bt.jsxs)(mu,{className:"mb-3",children:[(0,Bt.jsx)(Ri,{md:4,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Project Name"}),(0,Bt.jsx)(Ki.Control,{value:r,onChange:e=>i(e.target.value),required:!0})]})}),(0,Bt.jsx)(Ri,{md:4,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Location"}),(0,Bt.jsx)(Ki.Control,{value:o,onChange:e=>a(e.target.value),required:!0})]})}),(0,Bt.jsx)(Ri,{md:4,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Land Area (Katha/Sq ft)"}),(0,Bt.jsx)(Ki.Control,{value:s,onChange:e=>l(e.target.value),placeholder:"e.g., 5 Katha / 3500 sq ft"})]})})]}),(0,Bt.jsxs)(mu,{className:"mb-3",children:[(0,Bt.jsx)(Ri,{md:4,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Construction Area (Sq ft)"}),(0,Bt.jsx)(Ki.Control,{type:"number",value:c,onChange:e=>u(e.target.value),placeholder:"Total construction area"})]})}),(0,Bt.jsx)(Ri,{md:4,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Number of Floors"}),(0,Bt.jsx)(Ki.Control,{type:"number",min:1,value:d,onChange:e=>h(Number(e.target.value)),required:!0})]})}),(0,Bt.jsx)(Ri,{md:4,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Flats per Floor"}),(0,Bt.jsx)(Ki.Control,{type:"number",min:1,value:f,onChange:e=>m(Number(e.target.value)),required:!0})]})})]}),(0,Bt.jsx)(mu,{className:"mb-3",children:(0,Bt.jsx)(Ri,{md:12,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Selling Price Details"}),(0,Bt.jsx)(Ki.Control,{as:"textarea",rows:2,value:p,onChange:e=>v(e.target.value),required:!0})]})})}),(0,Bt.jsxs)(mu,{className:"mb-3",children:[(0,Bt.jsx)(Ri,{md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Project Start Date"}),(0,Bt.jsx)(Ki.Control,{type:"date",value:y,onChange:e=>b(e.target.value),required:!0})]})}),(0,Bt.jsx)(Ri,{md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Estimate End Date"}),(0,Bt.jsx)(Ki.Control,{type:"date",value:w,onChange:e=>x(e.target.value),required:!0})]})})]}),(0,Bt.jsx)(mu,{className:"mb-3",children:(0,Bt.jsx)(Ri,{md:4,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Status"}),(0,Bt.jsx)(Ki.Select,{value:S,onChange:e=>C(e.target.value),children:td.map(e=>(0,Bt.jsx)("option",{children:e},e))})]})})})]})]}),(0,Bt.jsxs)(Xr,{className:"mb-4",children:[(0,Bt.jsx)(Xr.Header,{as:"h5",className:"bg-info text-white",children:"Project Stages"}),(0,Bt.jsx)(Xr.Body,{children:(0,Bt.jsxs)("table",{className:"table table-bordered table-sm",children:[(0,Bt.jsx)("thead",{className:"table-light",children:(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("th",{children:"Stage Name"}),(0,Bt.jsx)("th",{children:"Involvement"}),(0,Bt.jsx)("th",{children:"Status"})]})}),(0,Bt.jsx)("tbody",{children:D.map((e,t)=>(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("td",{children:e.name}),(0,Bt.jsx)("td",{children:(0,Bt.jsx)(Ki.Check,{type:"checkbox",checked:e.involvement,onChange:()=>q(t,"involvement")})}),(0,Bt.jsx)("td",{children:(0,Bt.jsx)(Ki.Check,{type:"checkbox",checked:e.status,onChange:()=>q(t,"status")})})]},e.name))})]})})]}),(0,Bt.jsxs)(Xr,{className:"mb-4",children:[(0,Bt.jsx)(Xr.Header,{as:"h5",className:"bg-info text-white",children:"Project Documentation"}),(0,Bt.jsx)(Xr.Body,{children:(0,Bt.jsx)(mu,{children:O.map((e,t)=>(0,Bt.jsx)(Ri,{md:6,className:"mb-3",children:(0,Bt.jsxs)(Ki.Group,{className:"d-flex flex-column align-items-start justify-content-between",children:[(0,Bt.jsxs)("div",{className:"d-flex w-100 align-items-center justify-content-between",children:[(0,Bt.jsx)(Ki.Label,{className:"mb-0",children:e.name}),(0,Bt.jsx)(Ki.Control,{type:"file",accept:".pdf,.doc,.docx,image/*",capture:"environment",style:{maxWidth:"60%"},onChange:e=>((e,t)=>{t&&I(O.map((n,r)=>r===e?E(E({},n),{},{file:t}):n))})(t,e.target.files[0])})]}),e.file&&(0,Bt.jsx)("div",{className:"mt-2 w-100",style:{wordBreak:"break-all"},children:e.file.isFromDB?(0,Bt.jsx)(Bt.Fragment,{children:e.file.type&&e.file.type.startsWith("image/")?(0,Bt.jsx)("img",{src:e.file.data,alt:"Preview",onClick:()=>G(e.file),style:{maxWidth:"100%",maxHeight:"180px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(33,150,243,0.08)",cursor:"pointer"},title:"Click to view fullscreen"}):(0,Bt.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,Bt.jsxs)(gr,{variant:"link",className:"text-success p-0",onClick:()=>G(e.file),style:{textDecoration:"none"},children:["\u2713 ",e.file.name]}),(0,Bt.jsx)("a",{href:e.file.data,download:e.file.name,className:"btn btn-sm btn-outline-primary",title:"Download",children:"Download"})]})}):(0,Bt.jsx)(Bt.Fragment,{children:e.file.type&&e.file.type.startsWith("image/")?(0,Bt.jsx)("img",{src:URL.createObjectURL(e.file),alt:"Preview",onClick:()=>G(e.file),style:{maxWidth:"100%",maxHeight:"180px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(33,150,243,0.08)",cursor:"pointer"},title:"Click to view fullscreen"}):(0,Bt.jsx)(gr,{variant:"link",className:"text-secondary p-0",onClick:()=>G(e.file),style:{textDecoration:"none"},children:e.file.name})})})]})},e.name))})})]}),(0,Bt.jsxs)(Xr,{className:"mb-4",children:[(0,Bt.jsx)(Xr.Header,{as:"h5",className:"bg-info text-white",children:"Amenities"}),(0,Bt.jsx)(Xr.Body,{children:(0,Bt.jsxs)(mu,{children:[(0,Bt.jsx)(Ri,{md:6,className:"mb-3",children:(0,Bt.jsxs)(Ki.Group,{ref:V,children:[(0,Bt.jsx)(Ki.Label,{children:"Indoor Amenities"}),(0,Bt.jsx)(ed,{title:"Select Indoor Amenities",variant:"outline-primary",className:"w-100",style:{minWidth:"320px",maxWidth:"100%"},show:L,onToggle:B,children:id.map(e=>(0,Bt.jsxs)(Gl.Item,{active:P.includes(e),onClick:t=>{t.stopPropagation(),(e=>{j(P.includes(e)?P.filter(t=>t!==e):[...P,e])})(e)},style:{minWidth:"280px",display:"flex",alignItems:"center",gap:"0.7rem",padding:"0.5rem 1rem"},children:[(0,Bt.jsx)(Ki.Check,{type:"checkbox",checked:P.includes(e),readOnly:!0,style:{marginBottom:0}}),(0,Bt.jsx)("span",{style:{marginBottom:0},children:e})]},e))}),(0,Bt.jsxs)("div",{className:"mt-2",children:[(0,Bt.jsx)("span",{className:"fw-light",children:"Selected:"})," ",P.join(", ")]})]})}),(0,Bt.jsx)(Ri,{md:6,className:"mb-3",children:(0,Bt.jsxs)(Ki.Group,{ref:U,children:[(0,Bt.jsx)(Ki.Label,{children:"Outdoor Amenities"}),(0,Bt.jsx)(ed,{title:"Select Outdoor Amenities",variant:"outline-primary",className:"w-100",style:{minWidth:"320px",maxWidth:"100%"},show:z,onToggle:W,children:od.map(e=>(0,Bt.jsxs)(Gl.Item,{active:F.includes(e),onClick:t=>{t.stopPropagation(),(e=>{H(F.includes(e)?F.filter(t=>t!==e):[...F,e])})(e)},style:{minWidth:"280px",display:"flex",alignItems:"center",gap:"0.7rem",padding:"0.5rem 1rem"},children:[(0,Bt.jsx)(Ki.Check,{type:"checkbox",checked:F.includes(e),readOnly:!0,style:{marginBottom:0}}),(0,Bt.jsx)("span",{style:{marginBottom:0},children:e})]},e))}),(0,Bt.jsxs)("div",{className:"mt-2",children:[(0,Bt.jsx)("span",{className:"fw-light",children:"Selected:"})," ",F.join(", ")]})]})})]})})]}),(!t.state||n)&&(0,Bt.jsx)("div",{className:"d-flex justify-content-end gap-3",children:(0,Bt.jsx)(gr,{variant:"primary",type:"button",onClick:async()=>{try{var n;const i="https://buildproapi.onrender.com",a=null===(n=t.state)||void 0===n?void 0:n.project,l=null===a||void 0===a?void 0:a._id,u=await Promise.all(O.filter(e=>e.file).map(async e=>{return e.file.isFromDB?{name:e.name,fileName:e.file.name,contentType:e.file.type,data:e.file.data}:{name:e.name,fileName:e.file.name,contentType:e.file.type,data:await(t=e.file,new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=e=>n(e)}))};var t})),h={name:r,location:o,landArea:s,constructionArea:c,floors:d,flatsPerFloor:f,sellingPrice:p,startDate:y,endDate:w,status:S.toLowerCase(),stages:D.filter(e=>e.involvement).map(e=>({name:e.name,involvement:e.involvement,status:e.status})),projectdocuments:u,amenities:[{type:"indoor",items:P},{type:"outdoor",items:F}]},m=l?"PUT":"POST",g=l?"".concat(i,"/api/projects/").concat(l):"".concat(i,"/api/projects");if(!(await fetch(g,{method:m,headers:{"Content-Type":"application/json"},body:JSON.stringify(h)})).ok)throw new Error("Failed to ".concat(l?"update":"create"," project"));T({show:!0,type:"success",message:"Project ".concat(l?"updated":"created"," successfully!")}),setTimeout(()=>{T({show:!1,type:"",message:""}),e("/project-management")},3e3)}catch(mW){console.error("Error saving project:",mW),T({show:!0,type:"danger",message:"Error saving project: ".concat(mW.message)}),setTimeout(()=>{T({show:!1,type:"",message:""})},5e3)}},children:"Save"})})]})})]}),(0,Bt.jsxs)(ga,{show:A,onHide:Y,size:"xl",centered:!0,children:[(0,Bt.jsx)(ga.Header,{closeButton:!0,style:{background:"#e3f2fd",borderBottom:"2px solid #1976d2"},children:(0,Bt.jsx)(ga.Title,{style:{color:"#1976d2",fontWeight:600},children:k.name})}),(0,Bt.jsx)(ga.Body,{style:{padding:0,maxHeight:"80vh",overflow:"auto"},children:k.type&&k.type.startsWith("image/")?(0,Bt.jsx)("img",{src:k.data,alt:k.name,style:{width:"100%",height:"auto"}}):k.type&&"application/pdf"===k.type?(0,Bt.jsx)("iframe",{src:k.data,title:k.name,style:{width:"100%",height:"80vh",border:"none"}}):(0,Bt.jsxs)("div",{style:{padding:"2rem",textAlign:"center"},children:[(0,Bt.jsx)("p",{children:"Preview not available for this file type."}),(0,Bt.jsxs)("a",{href:k.data,download:k.name,className:"btn btn-primary",children:["Download ",k.name]})]})}),(0,Bt.jsxs)(ga.Footer,{children:[(0,Bt.jsx)(gr,{variant:"secondary",onClick:Y,children:"Close"}),(0,Bt.jsx)("a",{href:k.data,download:k.name,className:"btn btn-primary",children:"Download"})]})]})]})};function sd(){return sd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},sd.apply(null,arguments)}var ld={relTol:1e-12,absTol:1e-15,matrix:"Matrix",number:"number",numberFallback:"number",precision:64,predictable:!1,randomSeed:null,legacySubset:!1},cd=["Matrix","Array"],ud=["number","BigNumber","bigint","Fraction"];var dd=function(e){if(e)throw new Error("The global config is readonly. \nPlease create a mathjs instance if you want to change the default configuration. \nExample:\n\n  import { create, all } from 'mathjs';\n  const mathjs = create(all);\n  mathjs.config({ number: 'BigNumber' });\n");return Object.freeze(ld)};function hd(e){var t=typeof e;if("number"===t||"bigint"===t||"string"===t||"boolean"===t||null===e||void 0===e)return e;if("function"===typeof e.clone)return e.clone();if(Array.isArray(e))return e.map(function(e){return hd(e)});if(e instanceof Date)return new Date(e.valueOf());if(Rd(e))return e;if(Yd(e))return function(e,t){var n={};for(var r in e)pd(e,r)&&(n[r]=t(e[r]));return n}(e,hd);if("function"===t)return e;throw new TypeError("Cannot clone: unknown type of value (value: ".concat(e,")"))}function fd(e,t){for(var n in t)pd(t,n)&&(e[n]=t[n]);return e}function md(e,t){var n,r,i;if(Array.isArray(e)){if(!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(r=0,i=e.length;r<i;r++)if(!md(e[r],t[r]))return!1;return!0}if("function"===typeof e)return e===t;if(e instanceof Object){if(Array.isArray(t)||!(t instanceof Object))return!1;for(n in e)if(!(n in t)||!md(e[n],t[n]))return!1;for(n in t)if(!(n in e))return!1;return!0}return e===t}function pd(e,t){return e&&Object.hasOwnProperty.call(e,t)}function gd(e,t){if(yd(e,t))return e[t];if("function"===typeof e[t]&&bd(e,t))throw new Error('Cannot access method "'+t+'" as a property');throw new Error('No access to property "'+t+'"')}function vd(e,t,n){if(yd(e,t))return e[t]=n,n;throw new Error('No access to property "'+t+'"')}function yd(e,t){return!(!function(e){return"object"===typeof e&&e&&e.constructor===Object}(e)&&!Array.isArray(e))&&(!!pd(wd,t)||!(t in Object.prototype)&&!(t in Function.prototype))}function bd(e,t){return null!==e&&void 0!==e&&"function"===typeof e[t]&&(!(pd(e,t)&&Object.getPrototypeOf&&t in Object.getPrototypeOf(e))&&(!!pd(xd,t)||!(t in Object.prototype)&&!(t in Function.prototype)))}sd(dd,ld,{MATRIX_OPTIONS:cd,NUMBER_OPTIONS:ud});var wd={length:!0,name:!0},xd={toString:!0,valueOf:!0,toLocaleString:!0};class Sd{constructor(e){this.wrappedObject=e,this[Symbol.iterator]=this.entries}keys(){return Object.keys(this.wrappedObject).filter(e=>this.has(e)).values()}get(e){return gd(this.wrappedObject,e)}set(e,t){return vd(this.wrappedObject,e,t),this}has(e){return yd(this.wrappedObject,e)&&e in this.wrappedObject}entries(){return Ed(this.keys(),e=>[e,this.get(e)])}forEach(e){for(var t of this.keys())e(this.get(t),t,this)}delete(e){yd(this.wrappedObject,e)&&delete this.wrappedObject[e]}clear(){for(var e of this.keys())this.delete(e)}get size(){return Object.keys(this.wrappedObject).length}}class Cd{constructor(e,t,n){this.a=e,this.b=t,this.bKeys=n,this[Symbol.iterator]=this.entries}get(e){return this.bKeys.has(e)?this.b.get(e):this.a.get(e)}set(e,t){return this.bKeys.has(e)?this.b.set(e,t):this.a.set(e,t),this}has(e){return this.b.has(e)||this.a.has(e)}keys(){return new Set([...this.a.keys(),...this.b.keys()])[Symbol.iterator]()}entries(){return Ed(this.keys(),e=>[e,this.get(e)])}forEach(e){for(var t of this.keys())e(this.get(t),t,this)}delete(e){return this.bKeys.has(e)?this.b.delete(e):this.a.delete(e)}clear(){this.a.clear(),this.b.clear()}get size(){return[...this.keys()].length}}function Ed(e,t){return{next:()=>{var n=e.next();return n.done?n:{value:t(n.value),done:!1}}}}function Nd(){return new Map}function Td(e){if(!e)return Nd();if(Kd(e))return e;if(Yd(e))return new Sd(e);throw new Error("createMap can create maps from objects or Maps")}function Ad(e){return"number"===typeof e}function Rd(e){return!(!e||"object"!==typeof e||"function"!==typeof e.constructor)&&(!0===e.isBigNumber&&"object"===typeof e.constructor.prototype&&!0===e.constructor.prototype.isBigNumber||"function"===typeof e.constructor.isDecimal&&!0===e.constructor.isDecimal(e))}function kd(e){return"bigint"===typeof e}function Md(e){return e&&"object"===typeof e&&!0===Object.getPrototypeOf(e).isComplex||!1}function Dd(e){return e&&"object"===typeof e&&!0===Object.getPrototypeOf(e).isFraction||!1}function _d(e){return e&&!0===e.constructor.prototype.isUnit||!1}function Od(e){return"string"===typeof e}var Id=Array.isArray;function Pd(e){return e&&!0===e.constructor.prototype.isMatrix||!1}function jd(e){return Array.isArray(e)||Pd(e)}function Fd(e){return e&&e.isDenseMatrix&&!0===e.constructor.prototype.isMatrix||!1}function Hd(e){return e&&e.isSparseMatrix&&!0===e.constructor.prototype.isMatrix||!1}function Ld(e){return e&&!0===e.constructor.prototype.isRange||!1}function Bd(e){return e&&!0===e.constructor.prototype.isIndex||!1}function zd(e){return"boolean"===typeof e}function Wd(e){return e&&!0===e.constructor.prototype.isResultSet||!1}function Vd(e){return e&&!0===e.constructor.prototype.isHelp||!1}function Ud(e){return"function"===typeof e}function qd(e){return e instanceof Date}function Gd(e){return e instanceof RegExp}function Yd(e){return!(!e||"object"!==typeof e||e.constructor!==Object||Md(e)||Dd(e))}function Kd(e){return!!e&&(e instanceof Map||e instanceof Sd||"function"===typeof e.set&&"function"===typeof e.get&&"function"===typeof e.keys&&"function"===typeof e.has)}function $d(e){return null===e}function Xd(e){return void 0===e}function Qd(e){return e&&!0===e.isAccessorNode&&!0===e.constructor.prototype.isNode||!1}function Jd(e){return e&&!0===e.isArrayNode&&!0===e.constructor.prototype.isNode||!1}function Zd(e){return e&&!0===e.isAssignmentNode&&!0===e.constructor.prototype.isNode||!1}function eh(e){return e&&!0===e.isBlockNode&&!0===e.constructor.prototype.isNode||!1}function th(e){return e&&!0===e.isConditionalNode&&!0===e.constructor.prototype.isNode||!1}function nh(e){return e&&!0===e.isConstantNode&&!0===e.constructor.prototype.isNode||!1}function rh(e){return nh(e)||ch(e)&&1===e.args.length&&nh(e.args[0])&&"-+~".includes(e.op)}function ih(e){return e&&!0===e.isFunctionAssignmentNode&&!0===e.constructor.prototype.isNode||!1}function oh(e){return e&&!0===e.isFunctionNode&&!0===e.constructor.prototype.isNode||!1}function ah(e){return e&&!0===e.isIndexNode&&!0===e.constructor.prototype.isNode||!1}function sh(e){return e&&!0===e.isNode&&!0===e.constructor.prototype.isNode||!1}function lh(e){return e&&!0===e.isObjectNode&&!0===e.constructor.prototype.isNode||!1}function ch(e){return e&&!0===e.isOperatorNode&&!0===e.constructor.prototype.isNode||!1}function uh(e){return e&&!0===e.isParenthesisNode&&!0===e.constructor.prototype.isNode||!1}function dh(e){return e&&!0===e.isRangeNode&&!0===e.constructor.prototype.isNode||!1}function hh(e){return e&&!0===e.isRelationalNode&&!0===e.constructor.prototype.isNode||!1}function fh(e){return e&&!0===e.isSymbolNode&&!0===e.constructor.prototype.isNode||!1}function mh(e){return e&&!0===e.constructor.prototype.isChain||!1}function ph(e){var t=typeof e;return"object"===t?null===e?"null":Rd(e)?"BigNumber":e.constructor&&e.constructor.name?e.constructor.name:"Object":t}var gh=new Set(["end"]);function vh(e,t,n,r){function i(r){var i=function(e,t){for(var n={},r=0;r<t.length;r++){var i=t[r],o=e[i];void 0!==o&&(n[i]=o)}return n}(r,t.map(yh));return function(e,t,n){var r=t.filter(e=>!function(e){return e&&"?"===e[0]}(e)).every(e=>void 0!==n[e]);if(!r){var i=t.filter(e=>void 0===n[e]);throw new Error('Cannot create function "'.concat(e,'", ')+"some dependencies are missing: ".concat(i.map(e=>'"'.concat(e,'"')).join(", "),"."))}}(e,t,r),n(i)}return i.isFactory=!0,i.fn=e,i.dependencies=t.slice().sort(),r&&(i.meta=r),i}function yh(e){return e&&"?"===e[0]?e.slice(1):e}var bh=vh("Node",["mathWithTransform"],e=>{var{mathWithTransform:t}=e;return class{get type(){return"Node"}get isNode(){return!0}evaluate(e){return this.compile().evaluate(e)}compile(){var e=this._compile(t,{}),n={};return{evaluate:function(t){var r=Td(t);return function(e){for(var t of[...gh])if(e.has(t))throw new Error('Scope contains an illegal symbol, "'+t+'" is a reserved keyword')}(r),e(r,n,null)}}}_compile(e,t){throw new Error("Method _compile must be implemented by type "+this.type)}forEach(e){throw new Error("Cannot run forEach on a Node interface")}map(e){throw new Error("Cannot run map on a Node interface")}_ifNode(e){if(!sh(e))throw new TypeError("Callback function must return a Node");return e}traverse(e){e(this,null,null),function e(t,n){t.forEach(function(t,r,i){n(t,r,i),e(t,n)})}(this,e)}transform(e){return function t(n,r,i){var o=e(n,r,i);return o!==n?o:n.map(t)}(this,null,null)}filter(e){var t=[];return this.traverse(function(n,r,i){e(n,r,i)&&t.push(n)}),t}clone(){throw new Error("Cannot clone a Node interface")}cloneDeep(){return this.map(function(e){return e.cloneDeep()})}equals(e){return!!e&&(this.type===e.type&&md(this,e))}toString(e){var t=this._getCustomString(e);return"undefined"!==typeof t?t:this._toString(e)}_toString(){throw new Error("_toString not implemented for "+this.type)}toJSON(){throw new Error("Cannot serialize object: toJSON not implemented by "+this.type)}toHTML(e){var t=this._getCustomString(e);return"undefined"!==typeof t?t:this._toHTML(e)}_toHTML(){throw new Error("_toHTML not implemented for "+this.type)}toTex(e){var t=this._getCustomString(e);return"undefined"!==typeof t?t:this._toTex(e)}_toTex(e){throw new Error("_toTex not implemented for "+this.type)}_getCustomString(e){if(e&&"object"===typeof e)switch(typeof e.handler){case"object":case"undefined":return;case"function":return e.handler(this,e);default:throw new TypeError("Object or function expected as callback")}}getIdentifier(){return this.type}getContent(){return this}}},{isClass:!0,isNode:!0});function wh(e){return"boolean"===typeof e||!!isFinite(e)&&e===Math.round(e)}function xh(e,t){if("bigint"===t.number)try{BigInt(e)}catch(n){return t.numberFallback}return t.number}var Sh=Math.sign||function(e){return e>0?1:e<0?-1:0},Ch=Math.log2||function(e){return Math.log(e)/Math.LN2},Eh=Math.log10||function(e){return Math.log(e)/Math.LN10},Nh=Math.log1p||function(e){return Math.log(e+1)},Th=Math.cbrt||function(e){if(0===e)return e;var t,n=e<0;return n&&(e=-e),t=isFinite(e)?(e/((t=Math.exp(Math.log(e)/3))*t)+2*t)/3:e,n?-t:t},Ah=Math.expm1||function(e){return e>=2e-4||e<=-2e-4?Math.exp(e)-1:e+e*e/2+e*e*e/6};function Rh(e,t,n){var r={2:"0b",8:"0o",16:"0x"}[t],i="";if(n){if(n<1)throw new Error("size must be in greater than 0");if(!wh(n))throw new Error("size must be an integer");if(e>2**(n-1)-1||e<-(2**(n-1)))throw new Error("Value must be in range [-2^".concat(n-1,", 2^").concat(n-1,"-1]"));if(!wh(e))throw new Error("Value must be an integer");e<0&&(e+=2**n),i="i".concat(n)}var o="";return e<0&&(e=-e,o="-"),"".concat(o).concat(r).concat(e.toString(t)).concat(i)}function kh(e,t){if("function"===typeof t)return t(e);if(e===1/0)return"Infinity";if(e===-1/0)return"-Infinity";if(isNaN(e))return"NaN";var{notation:n,precision:r,wordSize:i}=Mh(t);switch(n){case"fixed":return _h(e,r);case"exponential":return Oh(e,r);case"engineering":return function(e,t){if(isNaN(e)||!isFinite(e))return String(e);var n=Dh(e),r=Ih(n,t),i=r.exponent,o=r.coefficients,a=i%3===0?i:i<0?i-3-i%3:i-i%3;if(Ad(t))for(;t>o.length||i-a+1>o.length;)o.push(0);else for(var s=Math.abs(i-a)-(o.length-1),l=0;l<s;l++)o.push(0);var c=Math.abs(i-a),u=1;for(;c>0;)u++,c--;var d=o.slice(u).join(""),h=Ad(t)&&d.length||d.match(/[1-9]/)?"."+d:"",f=o.slice(0,u).join("")+h+"e"+(i>=0?"+":"")+a.toString();return r.sign+f}(e,r);case"bin":return Rh(e,2,i);case"oct":return Rh(e,8,i);case"hex":return Rh(e,16,i);case"auto":return function(e,t,n){if(isNaN(e)||!isFinite(e))return String(e);var r=Uh(null===n||void 0===n?void 0:n.lowerExp,-3),i=Uh(null===n||void 0===n?void 0:n.upperExp,5),o=Dh(e),a=t?Ih(o,t):o;if(a.exponent<r||a.exponent>=i)return Oh(e,t);var s=a.coefficients,l=a.exponent;s.length<t&&(s=s.concat(Ph(t-s.length))),s=s.concat(Ph(l-s.length+1+(s.length<t?t-s.length:0)));var c=l>0?l:0;return c<(s=Ph(-l).concat(s)).length-1&&s.splice(c+1,0,"."),a.sign+s.join("")}(e,r,t).replace(/((\.\d*?)(0+))($|e)/,function(){var e=arguments[2],t=arguments[4];return"."!==e?e+t:t});default:throw new Error('Unknown notation "'+n+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function Mh(e){var t,n,r="auto";if(void 0!==e)if(Ad(e))t=e;else if(Rd(e))t=e.toNumber();else{if(!Yd(e))throw new Error("Unsupported type of options, number, BigNumber, or object expected");void 0!==e.precision&&(t=Vh(e.precision,()=>{throw new Error('Option "precision" must be a number or BigNumber')})),void 0!==e.wordSize&&(n=Vh(e.wordSize,()=>{throw new Error('Option "wordSize" must be a number or BigNumber')})),e.notation&&(r=e.notation)}return{notation:r,precision:t,wordSize:n}}function Dh(e){var t=String(e).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!t)throw new SyntaxError("Invalid number "+e);var n=t[1],r=t[2],i=parseFloat(t[4]||"0"),o=r.indexOf(".");i+=-1!==o?o-1:r.length-1;var a=r.replace(".","").replace(/^0*/,function(e){return i-=e.length,""}).replace(/0*$/,"").split("").map(function(e){return parseInt(e)});return 0===a.length&&(a.push(0),i++),{sign:n,coefficients:a,exponent:i}}function _h(e,t){if(isNaN(e)||!isFinite(e))return String(e);var n=Dh(e),r="number"===typeof t?Ih(n,n.exponent+1+t):n,i=r.coefficients,o=r.exponent+1,a=o+(t||0);return i.length<a&&(i=i.concat(Ph(a-i.length))),o<0&&(i=Ph(1-o).concat(i),o=1),o<i.length&&i.splice(o,0,0===o?"0.":"."),r.sign+i.join("")}function Oh(e,t){if(isNaN(e)||!isFinite(e))return String(e);var n=Dh(e),r=t?Ih(n,t):n,i=r.coefficients,o=r.exponent;i.length<t&&(i=i.concat(Ph(t-i.length)));var a=i.shift();return r.sign+a+(i.length>0?"."+i.join(""):"")+"e"+(o>=0?"+":"")+o}function Ih(e,t){for(var n={sign:e.sign,coefficients:e.coefficients,exponent:e.exponent},r=n.coefficients;t<=0;)r.unshift(0),n.exponent++,t++;if(r.length>t&&r.splice(t,r.length-t)[0]>=5){var i=t-1;for(r[i]++;10===r[i];)r.pop(),0===i&&(r.unshift(0),n.exponent++,i++),r[--i]++}return n}function Ph(e){for(var t=[],n=0;n<e;n++)t.push(0);return t}function jh(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-8,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(n<=0)throw new Error("Relative tolerance must be greater than 0");if(r<0)throw new Error("Absolute tolerance must be at least 0");return!isNaN(e)&&!isNaN(t)&&(isFinite(e)&&isFinite(t)?e===t||Math.abs(e-t)<=Math.max(n*Math.max(Math.abs(e),Math.abs(t)),r):e===t)}var Fh=Math.acosh||function(e){return Math.log(Math.sqrt(e*e-1)+e)},Hh=Math.asinh||function(e){return Math.log(Math.sqrt(e*e+1)+e)},Lh=Math.atanh||function(e){return Math.log((1+e)/(1-e))/2},Bh=Math.cosh||function(e){return(Math.exp(e)+Math.exp(-e))/2},zh=Math.sinh||function(e){return(Math.exp(e)-Math.exp(-e))/2},Wh=Math.tanh||function(e){var t=Math.exp(2*e);return(t-1)/(t+1)};function Vh(e,t){return Ad(e)?e:Rd(e)?e.toNumber():void t()}function Uh(e,t){return Ad(e)?e:Rd(e)?e.toNumber():t}function qh(e,t,n){var r=new(0,e.constructor)(2),i="";if(n){if(n<1)throw new Error("size must be in greater than 0");if(!wh(n))throw new Error("size must be an integer");if(e.greaterThan(r.pow(n-1).sub(1))||e.lessThan(r.pow(n-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(n-1,", 2^").concat(n-1,"-1]"));if(!e.isInteger())throw new Error("Value must be an integer");e.lessThan(0)&&(e=e.add(r.pow(n))),i="i".concat(n)}switch(t){case 2:return"".concat(e.toBinary()).concat(i);case 8:return"".concat(e.toOctal()).concat(i);case 16:return"".concat(e.toHexadecimal()).concat(i);default:throw new Error("Base ".concat(t," not supported "))}}function Gh(e,t){if("function"===typeof t)return t(e);if(!e.isFinite())return e.isNaN()?"NaN":e.gt(0)?"Infinity":"-Infinity";var{notation:n,precision:r,wordSize:i}=Mh(t);switch(n){case"fixed":return function(e,t){return e.toFixed(t)}(e,r);case"exponential":return Yh(e,r);case"engineering":return function(e,t){var n=e.e,r=n%3===0?n:n<0?n-3-n%3:n-n%3,i=e.mul(Math.pow(10,-r)),o=i.toPrecision(t);if(o.includes("e")){o=new(0,e.constructor)(o).toFixed()}return o+"e"+(n>=0?"+":"")+r.toString()}(e,r);case"bin":return qh(e,2,i);case"oct":return qh(e,8,i);case"hex":return qh(e,16,i);case"auto":var o=Kh(null===t||void 0===t?void 0:t.lowerExp,-3),a=Kh(null===t||void 0===t?void 0:t.upperExp,5);if(e.isZero())return"0";var s=e.toSignificantDigits(r),l=s.e;return(l>=o&&l<a?s.toFixed():Yh(e,r)).replace(/((\.\d*?)(0+))($|e)/,function(){var e=arguments[2],t=arguments[4];return"."!==e?e+t:t});default:throw new Error('Unknown notation "'+n+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function Yh(e,t){return void 0!==t?e.toExponential(t-1):e.toExponential()}function Kh(e,t){return Ad(e)?e:Rd(e)?e.toNumber():t}function $h(e,t){var n=e.length-t.length,r=e.length;return e.substring(n,r)===t}function Xh(e,t){var n=function(e,t){if("number"===typeof e)return kh(e,t);if(Rd(e))return Gh(e,t);if(function(e){return e&&"object"===typeof e&&"bigint"===typeof e.s&&"bigint"===typeof e.n&&"bigint"===typeof e.d||!1}(e))return t&&"decimal"===t.fraction?e.toString():"".concat(e.s*e.n,"/").concat(e.d);if(Array.isArray(e))return ef(e,t);if(Od(e))return Qh(e);if("function"===typeof e)return e.syntax?String(e.syntax):"function";if(e&&"object"===typeof e){return"function"===typeof e.format?e.format(t):e&&e.toString(t)!=={}.toString()?e.toString(t):"{"+Object.keys(e).map(n=>Qh(n)+": "+Xh(e[n],t)).join(", ")+"}"}return String(e)}(e,t);return t&&"object"===typeof t&&"truncate"in t&&n.length>t.truncate?n.substring(0,t.truncate-3)+"...":n}function Qh(e){for(var t=String(e),n="",r=0;r<t.length;){var i=t.charAt(r);n+=i in Jh?Jh[i]:i,r++}return'"'+n+'"'}var Jh={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"};function Zh(e){var t=String(e);return t=t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function ef(e,t){if(Array.isArray(e)){for(var n="[",r=e.length,i=0;i<r;i++)0!==i&&(n+=", "),n+=ef(e[i],t);return n+="]"}return Xh(e,t)}function tf(e,t){if(!Od(e))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+ph(e)+", index: 0)");if(!Od(t))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+ph(t)+", index: 1)");return e===t?0:e>t?1:-1}var nf="ObjectNode",rf=vh(nf,["Node"],e=>{var{Node:t}=e;class n extends t{constructor(e){if(super(),this.properties=e||{},e&&("object"!==typeof e||!Object.keys(e).every(function(t){return sh(e[t])})))throw new TypeError("Object containing Nodes expected")}get type(){return nf}get isObjectNode(){return!0}_compile(e,t){var n={};for(var r in this.properties)if(pd(this.properties,r)){var i=Qh(r),o=JSON.parse(i),a=gd(this.properties,r);n[o]=a._compile(e,t)}return function(e,t,r){var i={};for(var o in n)pd(n,o)&&(i[o]=n[o](e,t,r));return i}}forEach(e){for(var t in this.properties)pd(this.properties,t)&&e(this.properties[t],"properties["+Qh(t)+"]",this)}map(e){var t={};for(var r in this.properties)pd(this.properties,r)&&(t[r]=this._ifNode(e(this.properties[r],"properties["+Qh(r)+"]",this)));return new n(t)}clone(){var e={};for(var t in this.properties)pd(this.properties,t)&&(e[t]=this.properties[t]);return new n(e)}_toString(e){var t=[];for(var n in this.properties)pd(this.properties,n)&&t.push(Qh(n)+": "+this.properties[n].toString(e));return"{"+t.join(", ")+"}"}toJSON(){return{mathjs:nf,properties:this.properties}}static fromJSON(e){return new n(e.properties)}_toHTML(e){var t=[];for(var n in this.properties)pd(this.properties,n)&&t.push('<span class="math-symbol math-property">'+Zh(n)+'</span><span class="math-operator math-assignment-operator math-property-assignment-operator math-binary-operator">:</span>'+this.properties[n].toHTML(e));return'<span class="math-parenthesis math-curly-parenthesis">{</span>'+t.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-curly-parenthesis">}</span>'}_toTex(e){var t=[];for(var n in this.properties)pd(this.properties,n)&&t.push("\\mathbf{"+n+":} & "+this.properties[n].toTex(e)+"\\\\");return"\\left\\{\\begin{array}{ll}"+t.join("\n")+"\\end{array}\\right\\}"}}return S(n,"name",nf),n},{isClass:!0,isNode:!0});function of(e,t,n){if(!(this instanceof of))throw new SyntaxError("Constructor must be called with the new operator");this.actual=e,this.expected=t,this.relation=n,this.message="Dimension mismatch ("+(Array.isArray(e)?"["+e.join(", ")+"]":e)+" "+(this.relation||"!=")+" "+(Array.isArray(t)?"["+t.join(", ")+"]":t)+")",this.stack=(new Error).stack}function af(e,t,n){if(!(this instanceof af))throw new SyntaxError("Constructor must be called with the new operator");this.index=e,arguments.length<3?(this.min=0,this.max=t):(this.min=t,this.max=n),void 0!==this.min&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=(new Error).stack}function sf(e){for(var t=[];Array.isArray(e);)t.push(e.length),e=e[0];return t}function lf(e,t,n){var r,i=e.length;if(i!==t[n])throw new of(i,t[n]);if(n<t.length-1){var o=n+1;for(r=0;r<i;r++){var a=e[r];if(!Array.isArray(a))throw new of(t.length-1,t.length,"<");lf(e[r],t,o)}}else for(r=0;r<i;r++)if(Array.isArray(e[r]))throw new of(t.length+1,t.length,">")}function cf(e,t){if(0===t.length){if(Array.isArray(e))throw new of(e.length,0)}else lf(e,t,0)}function uf(e,t){var n=e.isMatrix?e._size:sf(e);t._sourceSize.forEach((e,t)=>{if(null!==e&&e!==n[t])throw new of(e,n[t])})}function df(e,t){if(void 0!==e){if(!Ad(e)||!wh(e))throw new TypeError("Index must be an integer (value: "+e+")");if(e<0||"number"===typeof t&&e>=t)throw new af(e,t)}}function hf(e){for(var t=0;t<e._dimensions.length;++t){var n=e._dimensions[t];if(n._data&&Id(n._data)){if(0===n._size[0])return!0}else if(n.isRange){if(n.start===n.end)return!0}else if(Od(n)&&0===n.length)return!0}return!1}function ff(e,t,n){if(!Array.isArray(t))throw new TypeError("Array expected");if(0===t.length)throw new Error("Resizing to scalar is not supported");return t.forEach(function(e){if(!Ad(e)||!wh(e)||e<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Xh(t)+")")}),(Ad(e)||Rd(e))&&(e=[e]),mf(e,t,0,void 0!==n?n:0),e}function mf(e,t,n,r){var i,o,a=e.length,s=t[n],l=Math.min(a,s);if(e.length=s,n<t.length-1){var c=n+1;for(i=0;i<l;i++)o=e[i],Array.isArray(o)||(o=[o],e[i]=o),mf(o,t,c,r);for(i=l;i<s;i++)o=[],e[i]=o,mf(o,t,c,r)}else{for(i=0;i<l;i++)for(;Array.isArray(e[i]);)e[i]=e[i][0];for(i=l;i<s;i++)e[i]=r}}function pf(e,t){var n=Sf(e,!0),r=n.length;if(!Array.isArray(e)||!Array.isArray(t))throw new TypeError("Array expected");if(0===t.length)throw new of(0,r,"!=");var i=vf(t=gf(t,r));if(r!==i)throw new of(i,r,"!=");try{return function(e,t){for(var n,r=e,i=t.length-1;i>0;i--){var o=t[i];n=[];for(var a=r.length/o,s=0;s<a;s++)n.push(r.slice(s*o,(s+1)*o));r=n}return r}(n,t)}catch(qb){if(qb instanceof of)throw new of(i,r,"!=");throw qb}}function gf(e,t){var n=vf(e),r=e.slice(),i=e.indexOf(-1);if(e.indexOf(-1,i+1)>=0)throw new Error("More than one wildcard in sizes");if(i>=0){if(!(t%n===0))throw new Error("Could not replace wildcard, since "+t+" is no multiple of "+-n);r[i]=-t/n}return r}function vf(e){return e.reduce((e,t)=>e*t,1)}function yf(e,t){for(var n=t||sf(e);Array.isArray(e)&&1===e.length;)e=e[0],n.shift();for(var r=n.length;1===n[r-1];)r--;return r<n.length&&(e=bf(e,r,0),n.length=r),e}function bf(e,t,n){var r,i;if(n<t){var o=n+1;for(r=0,i=e.length;r<i;r++)e[r]=bf(e[r],t,o)}else for(;Array.isArray(e);)e=e[0];return e}function wf(e,t,n,r){var i=r||sf(e);if(n)for(var o=0;o<n;o++)e=[e],i.unshift(1);for(e=xf(e,t,0);i.length<t;)i.push(1);return e}function xf(e,t,n){var r,i;if(Array.isArray(e)){var o=n+1;for(r=0,i=e.length;r<i;r++)e[r]=xf(e[r],t,o)}else for(var a=n;a<t;a++)e=[e];return e}function Sf(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!Array.isArray(e))return e;if("boolean"!==typeof t)throw new TypeError("Boolean expected for second argument of flatten");var n=[];return t?function e(t){if(Array.isArray(t[0]))for(var r=0;r<t.length;r++)e(t[r]);else for(var i=0;i<t.length;i++)n.push(t[i])}(e):function e(t){for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?e(i):n.push(i)}}(e),n}function Cf(e,t){return Array.prototype.map.call(e,t)}function Ef(e,t){Array.prototype.forEach.call(e,t)}function Nf(e,t){if(1!==sf(e).length)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(e,t)}function Tf(e,t){if(1!==sf(e).length)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(e,e=>t.test(e))}function Af(e,t){return Array.prototype.join.call(e,t)}function Rf(e){if(!Array.isArray(e))throw new TypeError("Array input expected");if(0===e.length)return e;var t=[],n=0;t[0]={value:e[0],identifier:0};for(var r=1;r<e.length;r++)e[r]===e[r-1]?n++:n=0,t.push({value:e[r],identifier:n});return t}function kf(e){if(!Array.isArray(e))throw new TypeError("Array input expected");if(0===e.length)return e;for(var t=[],n=0;n<e.length;n++)t.push(e[n].value);return t}function Mf(e,t){for(var n,r=0,i=0;i<e.length;i++){var o=e[i],a=Array.isArray(o);if(0===i&&a&&(r=o.length),a&&o.length!==r)return;var s=a?Mf(o,t):t(o);if(void 0===n)n=s;else if(n!==s)return"mixed"}return n}function Df(e,t,n,r){if(r<n){if(e.length!==t.length)throw new of(e.length,t.length);for(var i=[],o=0;o<e.length;o++)i[o]=Df(e[o],t[o],n,r+1);return i}return e.concat(t)}function _f(){var e=Array.prototype.slice.call(arguments,0,-1),t=Array.prototype.slice.call(arguments,-1);if(1===e.length)return e[0];if(e.length>1)return e.slice(1).reduce(function(e,n){return Df(e,n,t,0)},e[0]);throw new Error("Wrong number of arguments in function concat")}function Of(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=t.map(e=>e.length),i=Math.max(...r),o=new Array(i).fill(null),a=0;a<t.length;a++)for(var s=t[a],l=r[a],c=0;c<l;c++){var u=i-l+c;s[c]>o[u]&&(o[u]=s[c])}for(var d=0;d<t.length;d++)If(t[d],o);return o}function If(e,t){for(var n=t.length,r=e.length,i=0;i<r;i++){var o=n-r+i;if(e[i]<t[o]&&e[i]>1||e[i]>t[o])throw new Error("shape mismatch: mismatch is found in arg with shape (".concat(e,") not possible to broadcast dimension ").concat(r," with size ").concat(e[i]," to size ").concat(t[o]))}}function Pf(e,t){var n=sf(e);if(md(n,t))return e;If(n,t);var r=Of(n,t),i=r.length,o=[...Array(i-n.length).fill(1),...n],a=function(e){return sd([],e)}(e);n.length<i&&(n=sf(a=pf(a,o)));for(var s=0;s<i;s++)n[s]<r[s]&&(n=sf(a=jf(a,r[s],s)));return a}function jf(e,t,n){return _f(...Array(t).fill(e),n)}function Ff(e,t){if(!Array.isArray(e))throw new Error("Array expected");var n=sf(e);if(t.length!==n.length)throw new of(t.length,n.length);for(var r=0;r<t.length;r++)df(t[r],n[r]);return t.reduce((e,t)=>e[t],e)}function Hf(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return[];if(n)return function e(n){if(Array.isArray(n)){for(var r=n.length,i=Array(r),o=0;o<r;o++)i[o]=e(n[o]);return i}return t(n)}(e);var r=[];return function n(i,o){if(Array.isArray(i)){for(var a=i.length,s=Array(a),l=0;l<a;l++)r[o]=l,s[l]=n(i[l],o+1);return s}return t(i,r.slice(0,o),e)}(e,0)}function Lf(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0!==e.length)if(n)(function e(n){if(Array.isArray(n))for(var r=n.length,i=0;i<r;i++)e(n[i]);else t(n)})(e);else{var r=[];!function n(i,o){if(Array.isArray(i))for(var a=i.length,s=0;s<a;s++)r[o]=s,n(i[s],o+1);else t(i,r.slice(0,o),e)}(e,0)}}function Bf(e,t){return new Cd(e,new Sd(t),new Set(Object.keys(t)))}of.prototype=new RangeError,of.prototype.constructor=RangeError,of.prototype.name="DimensionError",of.prototype.isDimensionError=!0,af.prototype=new RangeError,af.prototype.constructor=RangeError,af.prototype.name="IndexError",af.prototype.isIndexError=!0;var zf=[{AssignmentNode:{},FunctionAssignmentNode:{}},{ConditionalNode:{latexLeftParens:!1,latexRightParens:!1,latexParens:!1}},{"OperatorNode:or":{op:"or",associativity:"left",associativeWith:[]}},{"OperatorNode:xor":{op:"xor",associativity:"left",associativeWith:[]}},{"OperatorNode:and":{op:"and",associativity:"left",associativeWith:[]}},{"OperatorNode:bitOr":{op:"|",associativity:"left",associativeWith:[]}},{"OperatorNode:bitXor":{op:"^|",associativity:"left",associativeWith:[]}},{"OperatorNode:bitAnd":{op:"&",associativity:"left",associativeWith:[]}},{"OperatorNode:equal":{op:"==",associativity:"left",associativeWith:[]},"OperatorNode:unequal":{op:"!=",associativity:"left",associativeWith:[]},"OperatorNode:smaller":{op:"<",associativity:"left",associativeWith:[]},"OperatorNode:larger":{op:">",associativity:"left",associativeWith:[]},"OperatorNode:smallerEq":{op:"<=",associativity:"left",associativeWith:[]},"OperatorNode:largerEq":{op:">=",associativity:"left",associativeWith:[]},RelationalNode:{associativity:"left",associativeWith:[]}},{"OperatorNode:leftShift":{op:"<<",associativity:"left",associativeWith:[]},"OperatorNode:rightArithShift":{op:">>",associativity:"left",associativeWith:[]},"OperatorNode:rightLogShift":{op:">>>",associativity:"left",associativeWith:[]}},{"OperatorNode:to":{op:"to",associativity:"left",associativeWith:[]}},{RangeNode:{}},{"OperatorNode:add":{op:"+",associativity:"left",associativeWith:["OperatorNode:add","OperatorNode:subtract"]},"OperatorNode:subtract":{op:"-",associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{op:"*",associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]},"OperatorNode:divide":{op:"/",associativity:"left",associativeWith:[],latexLeftParens:!1,latexRightParens:!1,latexParens:!1},"OperatorNode:dotMultiply":{op:".*",associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","OperatorNode:dotMultiply","OperatorNode:doDivide"]},"OperatorNode:dotDivide":{op:"./",associativity:"left",associativeWith:[]},"OperatorNode:mod":{op:"mod",associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]}},{"OperatorNode:unaryPlus":{op:"+",associativity:"right"},"OperatorNode:unaryMinus":{op:"-",associativity:"right"},"OperatorNode:bitNot":{op:"~",associativity:"right"},"OperatorNode:not":{op:"not",associativity:"right"}},{"OperatorNode:pow":{op:"^",associativity:"right",associativeWith:[],latexRightParens:!1},"OperatorNode:dotPow":{op:".^",associativity:"right",associativeWith:[]}},{"OperatorNode:nullish":{op:"??",associativity:"left",associativeWith:[]}},{"OperatorNode:factorial":{op:"!",associativity:"left"}},{"OperatorNode:ctranspose":{op:"'",associativity:"left"}}];function Wf(e,t){if(!t||"auto"!==t)return e;for(var n=e;uh(n);)n=n.content;return n}function Vf(e,t,n,r){var i=e;"keep"!==t&&(i=e.getContent());for(var o=i.getIdentifier(),a=null,s=0;s<zf.length;s++)if(o in zf[s]){a=s;break}if("OperatorNode:multiply"===o&&i.implicit&&"show"!==n){var l=Wf(i.args[0],t);nh(l)&&r&&"OperatorNode:divide"===r.getIdentifier()&&rh(Wf(r.args[0],t))||"OperatorNode:divide"===l.getIdentifier()&&rh(Wf(l.args[0],t))&&nh(Wf(l.args[1]))||(a+=1)}return a}function Uf(e,t){var n=e;"keep"!==t&&(n=e.getContent());var r=n.getIdentifier(),i=Vf(n,t);if(null===i)return null;var o=zf[i][r];if(pd(o,"associativity")){if("left"===o.associativity)return"left";if("right"===o.associativity)return"right";throw Error("'"+r+"' has the invalid associativity '"+o.associativity+"'.")}return null}function qf(e,t,n){var r="keep"!==n?e.getContent():e,i="keep"!==n?e.getContent():t,o=r.getIdentifier(),a=i.getIdentifier(),s=Vf(r,n);if(null===s)return null;var l=zf[s][o];if(pd(l,"associativeWith")&&l.associativeWith instanceof Array){for(var c=0;c<l.associativeWith.length;c++)if(l.associativeWith[c]===a)return!0;return!1}return null}var Gf=n(1147),Yf={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega",true:"\\mathrm{True}",false:"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"},Kf={transpose:"^\\top",ctranspose:"^H",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"\\~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"},$f={abs:{1:"\\left|${args[0]}\\right|"},add:{2:"\\left(${args[0]}".concat(Kf.add,"${args[1]}\\right)")},cbrt:{1:"\\sqrt[3]{${args[0]}}"},ceil:{1:"\\left\\lceil${args[0]}\\right\\rceil"},cube:{1:"\\left(${args[0]}\\right)^3"},divide:{2:"\\frac{${args[0]}}{${args[1]}}"},dotDivide:{2:"\\left(${args[0]}".concat(Kf.dotDivide,"${args[1]}\\right)")},dotMultiply:{2:"\\left(${args[0]}".concat(Kf.dotMultiply,"${args[1]}\\right)")},dotPow:{2:"\\left(${args[0]}".concat(Kf.dotPow,"${args[1]}\\right)")},exp:{1:"\\exp\\left(${args[0]}\\right)"},expm1:"\\left(e".concat(Kf.pow,"{${args[0]}}-1\\right)"),fix:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},floor:{1:"\\left\\lfloor${args[0]}\\right\\rfloor"},fraction:{2:"\\frac{${args[0]}}{${args[1]}}"},gcd:"\\gcd\\left(${args}\\right)",hypot:"\\hypot\\left(${args}\\right)",log:{1:"\\ln\\left(${args[0]}\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}\\right)"},log10:{1:"\\log_{10}\\left(${args[0]}\\right)"},log1p:{1:"\\ln\\left(${args[0]}+1\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}+1\\right)"},log2:"\\log_{2}\\left(${args[0]}\\right)",mod:{2:"\\left(${args[0]}".concat(Kf.mod,"${args[1]}\\right)")},multiply:{2:"\\left(${args[0]}".concat(Kf.multiply,"${args[1]}\\right)")},norm:{1:"\\left\\|${args[0]}\\right\\|",2:void 0},nthRoot:{2:"\\sqrt[${args[1]}]{${args[0]}}"},nthRoots:{2:"\\{y : y^${args[1]} = {${args[0]}}\\}"},pow:{2:"\\left(${args[0]}\\right)".concat(Kf.pow,"{${args[1]}}")},round:{1:"\\left\\lfloor${args[0]}\\right\\rceil",2:void 0},sign:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},sqrt:{1:"\\sqrt{${args[0]}}"},square:{1:"\\left(${args[0]}\\right)^2"},subtract:{2:"\\left(${args[0]}".concat(Kf.subtract,"${args[1]}\\right)")},unaryMinus:{1:"".concat(Kf.unaryMinus,"\\left(${args[0]}\\right)")},unaryPlus:{1:"".concat(Kf.unaryPlus,"\\left(${args[0]}\\right)")},bitAnd:{2:"\\left(${args[0]}".concat(Kf.bitAnd,"${args[1]}\\right)")},bitNot:{1:Kf.bitNot+"\\left(${args[0]}\\right)"},bitOr:{2:"\\left(${args[0]}".concat(Kf.bitOr,"${args[1]}\\right)")},bitXor:{2:"\\left(${args[0]}".concat(Kf.bitXor,"${args[1]}\\right)")},leftShift:{2:"\\left(${args[0]}".concat(Kf.leftShift,"${args[1]}\\right)")},rightArithShift:{2:"\\left(${args[0]}".concat(Kf.rightArithShift,"${args[1]}\\right)")},rightLogShift:{2:"\\left(${args[0]}".concat(Kf.rightLogShift,"${args[1]}\\right)")},bellNumbers:{1:"\\mathrm{B}_{${args[0]}}"},catalan:{1:"\\mathrm{C}_{${args[0]}}"},stirlingS2:{2:"\\mathrm{S}\\left(${args}\\right)"},arg:{1:"\\arg\\left(${args[0]}\\right)"},conj:{1:"\\left(${args[0]}\\right)^*"},im:{1:"\\Im\\left\\lbrace${args[0]}\\right\\rbrace"},re:{1:"\\Re\\left\\lbrace${args[0]}\\right\\rbrace"},and:{2:"\\left(${args[0]}".concat(Kf.and,"${args[1]}\\right)")},not:{1:Kf.not+"\\left(${args[0]}\\right)"},or:{2:"\\left(${args[0]}".concat(Kf.or,"${args[1]}\\right)")},xor:{2:"\\left(${args[0]}".concat(Kf.xor,"${args[1]}\\right)")},cross:{2:"\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)"},ctranspose:{1:"\\left(${args[0]}\\right)".concat(Kf.ctranspose)},det:{1:"\\det\\left(${args[0]}\\right)"},dot:{2:"\\left(${args[0]}\\cdot${args[1]}\\right)"},expm:{1:"\\exp\\left(${args[0]}\\right)"},inv:{1:"\\left(${args[0]}\\right)^{-1}"},pinv:{1:"\\left(${args[0]}\\right)^{+}"},sqrtm:{1:"{${args[0]}}".concat(Kf.pow,"{\\frac{1}{2}}")},trace:{1:"\\mathrm{tr}\\left(${args[0]}\\right)"},transpose:{1:"\\left(${args[0]}\\right)".concat(Kf.transpose)},combinations:{2:"\\binom{${args[0]}}{${args[1]}}"},combinationsWithRep:{2:"\\left(\\!\\!{\\binom{${args[0]}}{${args[1]}}}\\!\\!\\right)"},factorial:{1:"\\left(${args[0]}\\right)".concat(Kf.factorial)},gamma:{1:"\\Gamma\\left(${args[0]}\\right)"},lgamma:{1:"\\ln\\Gamma\\left(${args[0]}\\right)"},equal:{2:"\\left(${args[0]}".concat(Kf.equal,"${args[1]}\\right)")},larger:{2:"\\left(${args[0]}".concat(Kf.larger,"${args[1]}\\right)")},largerEq:{2:"\\left(${args[0]}".concat(Kf.largerEq,"${args[1]}\\right)")},smaller:{2:"\\left(${args[0]}".concat(Kf.smaller,"${args[1]}\\right)")},smallerEq:{2:"\\left(${args[0]}".concat(Kf.smallerEq,"${args[1]}\\right)")},unequal:{2:"\\left(${args[0]}".concat(Kf.unequal,"${args[1]}\\right)")},erf:{1:"erf\\left(${args[0]}\\right)"},max:"\\max\\left(${args}\\right)",min:"\\min\\left(${args}\\right)",variance:"\\mathrm{Var}\\left(${args}\\right)",acos:{1:"\\cos^{-1}\\left(${args[0]}\\right)"},acosh:{1:"\\cosh^{-1}\\left(${args[0]}\\right)"},acot:{1:"\\cot^{-1}\\left(${args[0]}\\right)"},acoth:{1:"\\coth^{-1}\\left(${args[0]}\\right)"},acsc:{1:"\\csc^{-1}\\left(${args[0]}\\right)"},acsch:{1:"\\mathrm{csch}^{-1}\\left(${args[0]}\\right)"},asec:{1:"\\sec^{-1}\\left(${args[0]}\\right)"},asech:{1:"\\mathrm{sech}^{-1}\\left(${args[0]}\\right)"},asin:{1:"\\sin^{-1}\\left(${args[0]}\\right)"},asinh:{1:"\\sinh^{-1}\\left(${args[0]}\\right)"},atan:{1:"\\tan^{-1}\\left(${args[0]}\\right)"},atan2:{2:"\\mathrm{atan2}\\left(${args}\\right)"},atanh:{1:"\\tanh^{-1}\\left(${args[0]}\\right)"},cos:{1:"\\cos\\left(${args[0]}\\right)"},cosh:{1:"\\cosh\\left(${args[0]}\\right)"},cot:{1:"\\cot\\left(${args[0]}\\right)"},coth:{1:"\\coth\\left(${args[0]}\\right)"},csc:{1:"\\csc\\left(${args[0]}\\right)"},csch:{1:"\\mathrm{csch}\\left(${args[0]}\\right)"},sec:{1:"\\sec\\left(${args[0]}\\right)"},sech:{1:"\\mathrm{sech}\\left(${args[0]}\\right)"},sin:{1:"\\sin\\left(${args[0]}\\right)"},sinh:{1:"\\sinh\\left(${args[0]}\\right)"},tan:{1:"\\tan\\left(${args[0]}\\right)"},tanh:{1:"\\tanh\\left(${args[0]}\\right)"},to:{2:"\\left(${args[0]}".concat(Kf.to,"${args[1]}\\right)")},numeric:function(e,t){return e.args[0].toTex()},number:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},string:{0:'\\mathtt{""}',1:"\\mathrm{string}\\left(${args[0]}\\right)"},bignumber:{0:"0",1:"\\left(${args[0]}\\right)"},bigint:{0:"0",1:"\\left(${args[0]}\\right)"},complex:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)+".concat(Yf.i,"\\cdot\\left(${args[1]}\\right)\\right)")},matrix:{0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"},sparse:{0:"\\begin{bsparse}\\end{bsparse}",1:"\\left(${args[0]}\\right)"},unit:{1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"}},Xf={deg:"^\\circ"};function Qf(e){return Gf(e,{preserveFormatting:!0})}function Jf(e,t){return(t="undefined"!==typeof t&&t)?pd(Xf,e)?Xf[e]:"\\mathrm{"+Qf(e)+"}":pd(Yf,e)?Yf[e]:Qf(e)}var Zf="OperatorNode",em=vh(Zf,["Node"],e=>{var{Node:t}=e;function n(e,t){var r=e;if("auto"===t)for(;uh(r);)r=r.content;return!!nh(r)||!!ch(r)&&n(r.args[0],t)}function r(e,t,r,i,o){var a,s=Vf(e,t,r),l=Uf(e,t);if("all"===t||i.length>2&&"OperatorNode:add"!==e.getIdentifier()&&"OperatorNode:multiply"!==e.getIdentifier())return i.map(function(e){switch(e.getContent().type){case"ArrayNode":case"ConstantNode":case"SymbolNode":case"ParenthesisNode":return!1;default:return!0}});switch(i.length){case 0:a=[];break;case 1:var c=Vf(i[0],t,r,e);if(o&&null!==c){var u,d;if("keep"===t?(u=i[0].getIdentifier(),d=e.getIdentifier()):(u=i[0].getContent().getIdentifier(),d=e.getContent().getIdentifier()),!1===zf[s][d].latexLeftParens){a=[!1];break}if(!1===zf[c][u].latexParens){a=[!1];break}}if(null===c){a=[!1];break}if(c<=s){a=[!0];break}a=[!1];break;case 2:var h,f,m=Vf(i[0],t,r,e),p=qf(e,i[0],t);h=null!==m&&(m===s&&"right"===l&&!p||m<s);var g,v,y,b=Vf(i[1],t,r,e),w=qf(e,i[1],t);if(f=null!==b&&(b===s&&"left"===l&&!w||b<s),o)"keep"===t?(g=e.getIdentifier(),v=e.args[0].getIdentifier(),y=e.args[1].getIdentifier()):(g=e.getContent().getIdentifier(),v=e.args[0].getContent().getIdentifier(),y=e.args[1].getContent().getIdentifier()),null!==m&&(!1===zf[s][g].latexLeftParens&&(h=!1),!1===zf[m][v].latexParens&&(h=!1)),null!==b&&(!1===zf[s][g].latexRightParens&&(f=!1),!1===zf[b][y].latexParens&&(f=!1));a=[h,f];break;default:"OperatorNode:add"!==e.getIdentifier()&&"OperatorNode:multiply"!==e.getIdentifier()||(a=i.map(function(n){var i=Vf(n,t,r,e),o=qf(e,n,t),a=Uf(n,t);return null!==i&&(s===i&&l===a&&!o||i<s)}))}if(i.length>=2&&"OperatorNode:multiply"===e.getIdentifier()&&e.implicit&&"all"!==t&&"hide"===r)for(var x=1;x<a.length;++x)!n(i[x],t)||a[x-1]||"keep"===t&&uh(i[x-1])||(a[x]=!0);return a}class i extends t{constructor(e,t,n,r,i){if(super(),"string"!==typeof e)throw new TypeError('string expected for parameter "op"');if("string"!==typeof t)throw new TypeError('string expected for parameter "fn"');if(!Array.isArray(n)||!n.every(sh))throw new TypeError('Array containing Nodes expected for parameter "args"');this.implicit=!0===r,this.isPercentage=!0===i,this.op=e,this.fn=t,this.args=n||[]}get type(){return Zf}get isOperatorNode(){return!0}_compile(e,t){if("string"!==typeof this.fn||!bd(e,this.fn))throw e[this.fn]?new Error('No access to function "'+this.fn+'"'):new Error("Function "+this.fn+' missing in provided namespace "math"');var n=gd(e,this.fn),r=Cf(this.args,function(n){return n._compile(e,t)});if("function"===typeof n&&!0===n.rawArgs){var i=this.args;return function(t,r,o){return n(i,e,Bf(t,r))}}if(1===r.length){var o=r[0];return function(e,t,r){return n(o(e,t,r))}}if(2===r.length){var a=r[0],s=r[1];return function(e,t,r){return n(a(e,t,r),s(e,t,r))}}return function(e,t,i){return n.apply(null,Cf(r,function(n){return n(e,t,i)}))}}forEach(e){for(var t=0;t<this.args.length;t++)e(this.args[t],"args["+t+"]",this)}map(e){for(var t=[],n=0;n<this.args.length;n++)t[n]=this._ifNode(e(this.args[n],"args["+n+"]",this));return new i(this.op,this.fn,t,this.implicit,this.isPercentage)}clone(){return new i(this.op,this.fn,this.args.slice(0),this.implicit,this.isPercentage)}isUnary(){return 1===this.args.length}isBinary(){return 2===this.args.length}_toString(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=e&&e.implicit?e.implicit:"hide",i=this.args,o=r(this,t,n,i,!1);if(1===i.length){var a=Uf(this,t),s=i[0].toString(e);o[0]&&(s="("+s+")");var l=/[a-zA-Z]+/.test(this.op);return"right"===a?this.op+(l?" ":"")+s:"left"===a?s+(l?" ":"")+this.op:s+this.op}if(2===i.length){var c=i[0].toString(e),u=i[1].toString(e);return o[0]&&(c="("+c+")"),o[1]&&(u="("+u+")"),this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===n?c+" "+u:c+" "+this.op+" "+u}if(i.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())){var d=i.map(function(t,n){return t=t.toString(e),o[n]&&(t="("+t+")"),t});return this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===n?d.join(" "):d.join(" "+this.op+" ")}return this.fn+"("+this.args.join(", ")+")"}toJSON(){return{mathjs:Zf,op:this.op,fn:this.fn,args:this.args,implicit:this.implicit,isPercentage:this.isPercentage}}static fromJSON(e){return new i(e.op,e.fn,e.args,e.implicit,e.isPercentage)}_toHTML(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=e&&e.implicit?e.implicit:"hide",i=this.args,o=r(this,t,n,i,!1);if(1===i.length){var a=Uf(this,t),s=i[0].toHTML(e);return o[0]&&(s='<span class="math-parenthesis math-round-parenthesis">(</span>'+s+'<span class="math-parenthesis math-round-parenthesis">)</span>'),"right"===a?'<span class="math-operator math-unary-operator math-lefthand-unary-operator">'+Zh(this.op)+"</span>"+s:s+'<span class="math-operator math-unary-operator math-righthand-unary-operator">'+Zh(this.op)+"</span>"}if(2===i.length){var l=i[0].toHTML(e),c=i[1].toHTML(e);return o[0]&&(l='<span class="math-parenthesis math-round-parenthesis">(</span>'+l+'<span class="math-parenthesis math-round-parenthesis">)</span>'),o[1]&&(c='<span class="math-parenthesis math-round-parenthesis">(</span>'+c+'<span class="math-parenthesis math-round-parenthesis">)</span>'),this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===n?l+'<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'+c:l+'<span class="math-operator math-binary-operator math-explicit-binary-operator">'+Zh(this.op)+"</span>"+c}var u=i.map(function(t,n){return t=t.toHTML(e),o[n]&&(t='<span class="math-parenthesis math-round-parenthesis">(</span>'+t+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t});return i.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())?this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===n?u.join('<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'):u.join('<span class="math-operator math-binary-operator math-explicit-binary-operator">'+Zh(this.op)+"</span>"):'<span class="math-function">'+Zh(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+u.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'}_toTex(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=e&&e.implicit?e.implicit:"hide",i=this.args,o=r(this,t,n,i,!0),a=Kf[this.fn];if(a="undefined"===typeof a?this.op:a,1===i.length){var s=Uf(this,t),l=i[0].toTex(e);return o[0]&&(l="\\left(".concat(l,"\\right)")),"right"===s?a+l:l+a}if(2===i.length){var c=i[0],u=c.toTex(e);o[0]&&(u="\\left(".concat(u,"\\right)"));var d,h=i[1].toTex(e);switch(o[1]&&(h="\\left(".concat(h,"\\right)")),d="keep"===t?c.getIdentifier():c.getContent().getIdentifier(),this.getIdentifier()){case"OperatorNode:divide":return a+"{"+u+"}{"+h+"}";case"OperatorNode:pow":switch(u="{"+u+"}",h="{"+h+"}",d){case"ConditionalNode":case"OperatorNode:divide":u="\\left(".concat(u,"\\right)")}break;case"OperatorNode:multiply":if(this.implicit&&"hide"===n)return u+"~"+h}return u+a+h}if(i.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())){var f=i.map(function(t,n){return t=t.toTex(e),o[n]&&(t="\\left(".concat(t,"\\right)")),t});return"OperatorNode:multiply"===this.getIdentifier()&&this.implicit&&"hide"===n?f.join("~"):f.join(a)}return"\\mathrm{"+this.fn+"}\\left("+i.map(function(t){return t.toTex(e)}).join(",")+"\\right)"}getIdentifier(){return this.type+":"+this.fn}}return S(i,"name",Zf),i},{isClass:!0,isNode:!0}),tm="ParenthesisNode",nm=vh(tm,["Node"],e=>{var{Node:t}=e;class n extends t{constructor(e){if(super(),!sh(e))throw new TypeError('Node expected for parameter "content"');this.content=e}get type(){return tm}get isParenthesisNode(){return!0}_compile(e,t){return this.content._compile(e,t)}getContent(){return this.content.getContent()}forEach(e){e(this.content,"content",this)}map(e){var t=e(this.content,"content",this);return new n(t)}clone(){return new n(this.content)}_toString(e){return!e||e&&!e.parenthesis||e&&"keep"===e.parenthesis?"("+this.content.toString(e)+")":this.content.toString(e)}toJSON(){return{mathjs:tm,content:this.content}}static fromJSON(e){return new n(e.content)}_toHTML(e){return!e||e&&!e.parenthesis||e&&"keep"===e.parenthesis?'<span class="math-parenthesis math-round-parenthesis">(</span>'+this.content.toHTML(e)+'<span class="math-parenthesis math-round-parenthesis">)</span>':this.content.toHTML(e)}_toTex(e){return!e||e&&!e.parenthesis||e&&"keep"===e.parenthesis?"\\left(".concat(this.content.toTex(e),"\\right)"):this.content.toTex(e)}}return S(n,"name",tm),n},{isClass:!0,isNode:!0}),rm="RelationalNode",im=vh(rm,["Node"],e=>{var{Node:t}=e,n={equal:"==",unequal:"!=",smaller:"<",larger:">",smallerEq:"<=",largerEq:">="};class r extends t{constructor(e,t){if(super(),!Array.isArray(e))throw new TypeError("Parameter conditionals must be an array");if(!Array.isArray(t))throw new TypeError("Parameter params must be an array");if(e.length!==t.length-1)throw new TypeError("Parameter params must contain exactly one more element than parameter conditionals");this.conditionals=e,this.params=t}get type(){return rm}get isRelationalNode(){return!0}_compile(e,t){var n=this,r=this.params.map(n=>n._compile(e,t));return function(t,i,o){for(var a,s=r[0](t,i,o),l=0;l<n.conditionals.length;l++){if(a=s,s=r[l+1](t,i,o),!gd(e,n.conditionals[l])(a,s))return!1}return!0}}forEach(e){this.params.forEach((t,n)=>e(t,"params["+n+"]",this),this)}map(e){return new r(this.conditionals.slice(),this.params.map((t,n)=>this._ifNode(e(t,"params["+n+"]",this)),this))}clone(){return new r(this.conditionals,this.params)}_toString(e){for(var t=e&&e.parenthesis?e.parenthesis:"keep",r=Vf(this,t,e&&e.implicit),i=this.params.map(function(n,i){var o=Vf(n,t,e&&e.implicit);return"all"===t||null!==o&&o<=r?"("+n.toString(e)+")":n.toString(e)}),o=i[0],a=0;a<this.conditionals.length;a++)o+=" "+n[this.conditionals[a]],o+=" "+i[a+1];return o}toJSON(){return{mathjs:rm,conditionals:this.conditionals,params:this.params}}static fromJSON(e){return new r(e.conditionals,e.params)}_toHTML(e){for(var t=e&&e.parenthesis?e.parenthesis:"keep",r=Vf(this,t,e&&e.implicit),i=this.params.map(function(n,i){var o=Vf(n,t,e&&e.implicit);return"all"===t||null!==o&&o<=r?'<span class="math-parenthesis math-round-parenthesis">(</span>'+n.toHTML(e)+'<span class="math-parenthesis math-round-parenthesis">)</span>':n.toHTML(e)}),o=i[0],a=0;a<this.conditionals.length;a++)o+='<span class="math-operator math-binary-operator math-explicit-binary-operator">'+Zh(n[this.conditionals[a]])+"</span>"+i[a+1];return o}_toTex(e){for(var t=e&&e.parenthesis?e.parenthesis:"keep",n=Vf(this,t,e&&e.implicit),r=this.params.map(function(r,i){var o=Vf(r,t,e&&e.implicit);return"all"===t||null!==o&&o<=n?"\\left("+r.toTex(e)+"\right)":r.toTex(e)}),i=r[0],o=0;o<this.conditionals.length;o++)i+=Kf[this.conditionals[o]]+r[o+1];return i}}return S(r,"name",rm),r},{isClass:!0,isNode:!0}),om="ArrayNode",am=vh(om,["Node"],e=>{var{Node:t}=e;class n extends t{constructor(e){if(super(),this.items=e||[],!Array.isArray(this.items)||!this.items.every(sh))throw new TypeError("Array containing Nodes expected")}get type(){return om}get isArrayNode(){return!0}_compile(e,t){var n=Cf(this.items,function(n){return n._compile(e,t)});if("Array"!==e.config.matrix){var r=e.matrix;return function(e,t,i){return r(Cf(n,function(n){return n(e,t,i)}))}}return function(e,t,r){return Cf(n,function(n){return n(e,t,r)})}}forEach(e){for(var t=0;t<this.items.length;t++){e(this.items[t],"items["+t+"]",this)}}map(e){for(var t=[],r=0;r<this.items.length;r++)t[r]=this._ifNode(e(this.items[r],"items["+r+"]",this));return new n(t)}clone(){return new n(this.items.slice(0))}_toString(e){return"["+this.items.map(function(t){return t.toString(e)}).join(", ")+"]"}toJSON(){return{mathjs:om,items:this.items}}static fromJSON(e){return new n(e.items)}_toHTML(e){return'<span class="math-parenthesis math-square-parenthesis">[</span>'+this.items.map(function(t){return t.toHTML(e)}).join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'}_toTex(e){return function t(n,r){var i=n.some(Jd)&&!n.every(Jd),o=r||i,a=o?"&":"\\\\",s=n.map(function(n){return n.items?t(n.items,!r):n.toTex(e)}).join(a);return i||!o||o&&!r?"\\begin{bmatrix}"+s+"\\end{bmatrix}":s}(this.items,!1)}}return S(n,"name",om),n},{isClass:!0,isNode:!0}),sm="BlockNode",lm=vh(sm,["ResultSet","Node"],e=>{var{ResultSet:t,Node:n}=e;class r extends n{constructor(e){if(super(),!Array.isArray(e))throw new Error("Array expected");this.blocks=e.map(function(e){var t=e&&e.node,n=!e||void 0===e.visible||e.visible;if(!sh(t))throw new TypeError('Property "node" must be a Node');if("boolean"!==typeof n)throw new TypeError('Property "visible" must be a boolean');return{node:t,visible:n}})}get type(){return sm}get isBlockNode(){return!0}_compile(e,n){var r=Cf(this.blocks,function(t){return{evaluate:t.node._compile(e,n),visible:t.visible}});return function(e,n,i){var o=[];return Ef(r,function(t){var r=t.evaluate(e,n,i);t.visible&&o.push(r)}),new t(o)}}forEach(e){for(var t=0;t<this.blocks.length;t++)e(this.blocks[t].node,"blocks["+t+"].node",this)}map(e){for(var t=[],n=0;n<this.blocks.length;n++){var i=this.blocks[n],o=this._ifNode(e(i.node,"blocks["+n+"].node",this));t[n]={node:o,visible:i.visible}}return new r(t)}clone(){var e=this.blocks.map(function(e){return{node:e.node,visible:e.visible}});return new r(e)}_toString(e){return this.blocks.map(function(t){return t.node.toString(e)+(t.visible?"":";")}).join("\n")}toJSON(){return{mathjs:sm,blocks:this.blocks}}static fromJSON(e){return new r(e.blocks)}_toHTML(e){return this.blocks.map(function(t){return t.node.toHTML(e)+(t.visible?"":'<span class="math-separator">;</span>')}).join('<span class="math-separator"><br /></span>')}_toTex(e){return this.blocks.map(function(t){return t.node.toTex(e)+(t.visible?"":";")}).join("\\;\\;\n")}}return S(r,"name",sm),r},{isClass:!0,isNode:!0}),cm="ConditionalNode",um=vh(cm,["Node"],e=>{var{Node:t}=e;class n extends t{constructor(e,t,n){if(super(),!sh(e))throw new TypeError("Parameter condition must be a Node");if(!sh(t))throw new TypeError("Parameter trueExpr must be a Node");if(!sh(n))throw new TypeError("Parameter falseExpr must be a Node");this.condition=e,this.trueExpr=t,this.falseExpr=n}get type(){return cm}get isConditionalNode(){return!0}_compile(e,t){var n=this.condition._compile(e,t),r=this.trueExpr._compile(e,t),i=this.falseExpr._compile(e,t);return function(e,t,o){return function(e){if("number"===typeof e||"boolean"===typeof e||"string"===typeof e)return!!e;if(e){if(Rd(e))return!e.isZero();if(Md(e))return!(!e.re&&!e.im);if(_d(e))return!!e.value}if(null===e||void 0===e)return!1;throw new TypeError('Unsupported type of condition "'+ph(e)+'"')}(n(e,t,o))?r(e,t,o):i(e,t,o)}}forEach(e){e(this.condition,"condition",this),e(this.trueExpr,"trueExpr",this),e(this.falseExpr,"falseExpr",this)}map(e){return new n(this._ifNode(e(this.condition,"condition",this)),this._ifNode(e(this.trueExpr,"trueExpr",this)),this._ifNode(e(this.falseExpr,"falseExpr",this)))}clone(){return new n(this.condition,this.trueExpr,this.falseExpr)}_toString(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=Vf(this,t,e&&e.implicit),r=this.condition.toString(e),i=Vf(this.condition,t,e&&e.implicit);("all"===t||"OperatorNode"===this.condition.type||null!==i&&i<=n)&&(r="("+r+")");var o=this.trueExpr.toString(e),a=Vf(this.trueExpr,t,e&&e.implicit);("all"===t||"OperatorNode"===this.trueExpr.type||null!==a&&a<=n)&&(o="("+o+")");var s=this.falseExpr.toString(e),l=Vf(this.falseExpr,t,e&&e.implicit);return("all"===t||"OperatorNode"===this.falseExpr.type||null!==l&&l<=n)&&(s="("+s+")"),r+" ? "+o+" : "+s}toJSON(){return{mathjs:cm,condition:this.condition,trueExpr:this.trueExpr,falseExpr:this.falseExpr}}static fromJSON(e){return new n(e.condition,e.trueExpr,e.falseExpr)}_toHTML(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=Vf(this,t,e&&e.implicit),r=this.condition.toHTML(e),i=Vf(this.condition,t,e&&e.implicit);("all"===t||"OperatorNode"===this.condition.type||null!==i&&i<=n)&&(r='<span class="math-parenthesis math-round-parenthesis">(</span>'+r+'<span class="math-parenthesis math-round-parenthesis">)</span>');var o=this.trueExpr.toHTML(e),a=Vf(this.trueExpr,t,e&&e.implicit);("all"===t||"OperatorNode"===this.trueExpr.type||null!==a&&a<=n)&&(o='<span class="math-parenthesis math-round-parenthesis">(</span>'+o+'<span class="math-parenthesis math-round-parenthesis">)</span>');var s=this.falseExpr.toHTML(e),l=Vf(this.falseExpr,t,e&&e.implicit);return("all"===t||"OperatorNode"===this.falseExpr.type||null!==l&&l<=n)&&(s='<span class="math-parenthesis math-round-parenthesis">(</span>'+s+'<span class="math-parenthesis math-round-parenthesis">)</span>'),r+'<span class="math-operator math-conditional-operator">?</span>'+o+'<span class="math-operator math-conditional-operator">:</span>'+s}_toTex(e){return"\\begin{cases} {"+this.trueExpr.toTex(e)+"}, &\\quad{\\text{if }\\;"+this.condition.toTex(e)+"}\\\\{"+this.falseExpr.toTex(e)+"}, &\\quad{\\text{otherwise}}\\end{cases}"}}return S(n,"name",cm),n},{isClass:!0,isNode:!0}),dm="ConstantNode",hm=vh(dm,["Node"],e=>{var{Node:t}=e;class n extends t{constructor(e){super(),this.value=e}get type(){return dm}get isConstantNode(){return!0}_compile(e,t){var n=this.value;return function(){return n}}forEach(e){}map(e){return this.clone()}clone(){return new n(this.value)}_toString(e){return Xh(this.value,e)}_toHTML(e){var t=this._toString(e);switch(ph(this.value)){case"number":case"bigint":case"BigNumber":case"Fraction":return'<span class="math-number">'+t+"</span>";case"string":return'<span class="math-string">'+t+"</span>";case"boolean":return'<span class="math-boolean">'+t+"</span>";case"null":return'<span class="math-null-symbol">'+t+"</span>";case"undefined":return'<span class="math-undefined">'+t+"</span>";default:return'<span class="math-symbol">'+t+"</span>"}}toJSON(){return{mathjs:dm,value:this.value}}static fromJSON(e){return new n(e.value)}_toTex(e){var t=this._toString(e),n=ph(this.value);switch(n){case"string":return"\\mathtt{"+Qf(t)+"}";case"number":case"BigNumber":if(!("BigNumber"===n?this.value.isFinite():isFinite(this.value)))return this.value.valueOf()<0?"-\\infty":"\\infty";var r=t.toLowerCase().indexOf("e");return-1!==r?t.substring(0,r)+"\\cdot10^{"+t.substring(r+1)+"}":t;case"bigint":return t.toString();case"Fraction":return this.value.toLatex();default:return t}}}return S(n,"name",dm),n},{isClass:!0,isNode:!0}),fm="RangeNode",mm=vh(fm,["Node"],e=>{var{Node:t}=e;function n(e,t,n){var r=Vf(e,t,n),i={},o=Vf(e.start,t,n);if(i.start=null!==o&&o<=r||"all"===t,e.step){var a=Vf(e.step,t,n);i.step=null!==a&&a<=r||"all"===t}var s=Vf(e.end,t,n);return i.end=null!==s&&s<=r||"all"===t,i}class r extends t{constructor(e,t,n){if(super(),!sh(e))throw new TypeError("Node expected");if(!sh(t))throw new TypeError("Node expected");if(n&&!sh(n))throw new TypeError("Node expected");if(arguments.length>3)throw new Error("Too many arguments");this.start=e,this.end=t,this.step=n||null}get type(){return fm}get isRangeNode(){return!0}needsEnd(){return this.filter(function(e){return fh(e)&&"end"===e.name}).length>0}_compile(e,t){var n=e.range,r=this.start._compile(e,t),i=this.end._compile(e,t);if(this.step){var o=this.step._compile(e,t);return function(e,t,a){return n(r(e,t,a),i(e,t,a),o(e,t,a))}}return function(e,t,o){return n(r(e,t,o),i(e,t,o))}}forEach(e){e(this.start,"start",this),e(this.end,"end",this),this.step&&e(this.step,"step",this)}map(e){return new r(this._ifNode(e(this.start,"start",this)),this._ifNode(e(this.end,"end",this)),this.step&&this._ifNode(e(this.step,"step",this)))}clone(){return new r(this.start,this.end,this.step&&this.step)}_toString(e){var t,r=n(this,e&&e.parenthesis?e.parenthesis:"keep",e&&e.implicit),i=this.start.toString(e);if(r.start&&(i="("+i+")"),t=i,this.step){var o=this.step.toString(e);r.step&&(o="("+o+")"),t+=":"+o}var a=this.end.toString(e);return r.end&&(a="("+a+")"),t+=":"+a}toJSON(){return{mathjs:fm,start:this.start,end:this.end,step:this.step}}static fromJSON(e){return new r(e.start,e.end,e.step)}_toHTML(e){var t,r=n(this,e&&e.parenthesis?e.parenthesis:"keep",e&&e.implicit),i=this.start.toHTML(e);if(r.start&&(i='<span class="math-parenthesis math-round-parenthesis">(</span>'+i+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t=i,this.step){var o=this.step.toHTML(e);r.step&&(o='<span class="math-parenthesis math-round-parenthesis">(</span>'+o+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t+='<span class="math-operator math-range-operator">:</span>'+o}var a=this.end.toHTML(e);return r.end&&(a='<span class="math-parenthesis math-round-parenthesis">(</span>'+a+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t+='<span class="math-operator math-range-operator">:</span>'+a}_toTex(e){var t=n(this,e&&e.parenthesis?e.parenthesis:"keep",e&&e.implicit),r=this.start.toTex(e);if(t.start&&(r="\\left(".concat(r,"\\right)")),this.step){var i=this.step.toTex(e);t.step&&(i="\\left(".concat(i,"\\right)")),r+=":"+i}var o=this.end.toTex(e);return t.end&&(o="\\left(".concat(o,"\\right)")),r+=":"+o}}return S(r,"name",fm),r},{isClass:!0,isNode:!0}),pm=vh("reviver",["classes"],e=>{var{classes:t}=e;return function(e,n){var r=t[n&&n.mathjs];return r&&"function"===typeof r.fromJSON?r.fromJSON(n):n}}),gm=vh("Chain",["?on","math","typed"],e=>{var{on:t,math:n,typed:r}=e;function i(e){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");mh(e)?this.value=e.value:this.value=e}function o(e,t){!function(e,t,n){var r,i=!0;Object.defineProperty(e,t,{get:function(){return i&&(r=n(),i=!1),r},set:function(e){r=e,i=!1},configurable:!0,enumerable:!0})}(i.prototype,e,function(){var e=t();if("function"===typeof e)return a(e)})}function a(e){return function(){if(0===arguments.length)return new i(e(this.value));for(var t=[this.value],n=0;n<arguments.length;n++)t[n+1]=arguments[n];if(r.isTypedFunction(e)){var o=r.resolve(e,t);if(1===o.params.length)throw new Error("chain function "+e.name+" cannot match rest parameter between chain value and additional arguments.");return new i(o.implementation.apply(e,t))}return new i(e.apply(e,t))}}i.prototype.type="Chain",i.prototype.isChain=!0,i.prototype.done=function(){return this.value},i.prototype.valueOf=function(){return this.value},i.prototype.toString=function(){return Xh(this.value)},i.prototype.toJSON=function(){return{mathjs:"Chain",value:this.value}},i.fromJSON=function(e){return new i(e.value)},i.createProxy=function(e,t){if("string"===typeof e)l=e,"function"===typeof(c=t)&&(i.prototype[l]=a(c));else{var n=function(t){pd(e,t)&&void 0===s[t]&&o(t,()=>e[t])};for(var r in e)n(r)}var l,c};var s={expression:!0,docs:!0,type:!0,classes:!0,json:!0,error:!0,isChain:!0};return i.createProxy(n),t&&t("import",function(e,t,n){n||o(e,t)}),i},{isClass:!0}),vm="FunctionAssignmentNode",ym=vh(vm,["typed","Node"],e=>{var{typed:t,Node:n}=e;function r(e,t,n){var r=Vf(e,t,n),i=Vf(e.expr,t,n);return"all"===t||null!==i&&i<=r}class i extends n{constructor(e,t,n){if(super(),"string"!==typeof e)throw new TypeError('String expected for parameter "name"');if(!Array.isArray(t))throw new TypeError('Array containing strings or objects expected for parameter "params"');if(!sh(n))throw new TypeError('Node expected for parameter "expr"');if(gh.has(e))throw new Error('Illegal function name, "'+e+'" is a reserved keyword');var r=new Set;for(var i of t){var o="string"===typeof i?i:i.name;if(r.has(o))throw new Error('Duplicate parameter name "'.concat(o,'"'));r.add(o)}this.name=e,this.params=t.map(function(e){return e&&e.name||e}),this.types=t.map(function(e){return e&&e.type||"any"}),this.expr=n}get type(){return vm}get isFunctionAssignmentNode(){return!0}_compile(e,n){var r=Object.create(n);Ef(this.params,function(e){r[e]=!0});var i=this.expr,o=i._compile(e,r),a=this.name,s=this.params,l=Af(this.types,","),c=a+"("+Af(this.params,", ")+")";return function(e,n,r){var u={};u[l]=function(){for(var t=Object.create(n),i=0;i<s.length;i++)t[s[i]]=arguments[i];return o(e,t,r)};var d=t(a,u);return d.syntax=c,d.expr=i.toString(),e.set(a,d),d}}forEach(e){e(this.expr,"expr",this)}map(e){var t=this._ifNode(e(this.expr,"expr",this));return new i(this.name,this.params.slice(0),t)}clone(){return new i(this.name,this.params.slice(0),this.expr)}_toString(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=this.expr.toString(e);return r(this,t,e&&e.implicit)&&(n="("+n+")"),this.name+"("+this.params.join(", ")+") = "+n}toJSON(){var e=this.types;return{mathjs:vm,name:this.name,params:this.params.map(function(t,n){return{name:t,type:e[n]}}),expr:this.expr}}static fromJSON(e){return new i(e.name,e.params,e.expr)}_toHTML(e){for(var t=e&&e.parenthesis?e.parenthesis:"keep",n=[],i=0;i<this.params.length;i++)n.push('<span class="math-symbol math-parameter">'+Zh(this.params[i])+"</span>");var o=this.expr.toHTML(e);return r(this,t,e&&e.implicit)&&(o='<span class="math-parenthesis math-round-parenthesis">(</span>'+o+'<span class="math-parenthesis math-round-parenthesis">)</span>'),'<span class="math-function">'+Zh(this.name)+'</span><span class="math-parenthesis math-round-parenthesis">(</span>'+n.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-round-parenthesis">)</span><span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+o}_toTex(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=this.expr.toTex(e);return r(this,t,e&&e.implicit)&&(n="\\left(".concat(n,"\\right)")),"\\mathrm{"+this.name+"}\\left("+this.params.map(Jf).join(",")+"\\right)="+n}}return S(i,"name",vm),i},{isClass:!0,isNode:!0}),bm="chain",wm=vh(bm,["typed","Chain"],e=>{var{typed:t,Chain:n}=e;return t(bm,{"":function(){return new n},any:function(e){return new n(e)}})}),xm="IndexNode",Sm=vh(xm,["Node","size"],e=>{var{Node:t,size:n}=e;class r extends t{constructor(e,t){if(super(),this.dimensions=e,this.dotNotation=t||!1,!Array.isArray(e)||!e.every(sh))throw new TypeError('Array containing Nodes expected for parameter "dimensions"');if(this.dotNotation&&!this.isObjectProperty())throw new Error("dotNotation only applicable for object properties")}get type(){return xm}get isIndexNode(){return!0}_compile(e,t){var r=Cf(this.dimensions,function(r,i){if(r.filter(e=>e.isSymbolNode&&"end"===e.name).length>0){var o=Object.create(t);o.end=!0;var a=r._compile(e,o);return function(e,t,r){if(!Pd(r)&&!Id(r)&&!Od(r))throw new TypeError('Cannot resolve "end": context must be a Matrix, Array, or string but is '+ph(r));var o=n(r),s=Object.create(t);return s.end=o[i],a(e,s,r)}}return r._compile(e,t)}),i=gd(e,"index");return function(e,t,n){var o=Cf(r,function(r){return r(e,t,n)});return i(...o)}}forEach(e){for(var t=0;t<this.dimensions.length;t++)e(this.dimensions[t],"dimensions["+t+"]",this)}map(e){for(var t=[],n=0;n<this.dimensions.length;n++)t[n]=this._ifNode(e(this.dimensions[n],"dimensions["+n+"]",this));return new r(t,this.dotNotation)}clone(){return new r(this.dimensions.slice(0),this.dotNotation)}isObjectProperty(){return 1===this.dimensions.length&&nh(this.dimensions[0])&&"string"===typeof this.dimensions[0].value}getObjectProperty(){return this.isObjectProperty()?this.dimensions[0].value:null}_toString(e){return this.dotNotation?"."+this.getObjectProperty():"["+this.dimensions.join(", ")+"]"}toJSON(){return{mathjs:xm,dimensions:this.dimensions,dotNotation:this.dotNotation}}static fromJSON(e){return new r(e.dimensions,e.dotNotation)}_toHTML(e){for(var t=[],n=0;n<this.dimensions.length;n++)t[n]=this.dimensions[n].toHTML();return this.dotNotation?'<span class="math-operator math-accessor-operator">.</span><span class="math-symbol math-property">'+Zh(this.getObjectProperty())+"</span>":'<span class="math-parenthesis math-square-parenthesis">[</span>'+t.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'}_toTex(e){var t=this.dimensions.map(function(t){return t.toTex(e)});return this.dotNotation?"."+this.getObjectProperty():"_{"+t.join(",")+"}"}}return S(r,"name",xm),r},{isClass:!0,isNode:!0});function Cm(e){return e&&e.isIndexError?new af(e.index+1,e.min+1,void 0!==e.max?e.max+1:void 0):e}function Em(e){var{subset:t}=e;return function(e,n){try{if(Array.isArray(e))return t(e,n);if(e&&"function"===typeof e.subset)return e.subset(n);if("string"===typeof e)return t(e,n);if("object"===typeof e){if(!n.isObjectProperty())throw new TypeError("Cannot apply a numeric index as object property");return gd(e,n.getObjectProperty())}throw new TypeError("Cannot apply index: unsupported type of object")}catch(r){throw Cm(r)}}}var Nm="AccessorNode",Tm=vh(Nm,["subset","Node"],e=>{var{subset:t,Node:n}=e,r=Em({subset:t});function i(e){return!(Qd(e)||Jd(e)||nh(e)||oh(e)||lh(e)||uh(e)||fh(e))}class o extends n{constructor(e,t){if(super(),!sh(e))throw new TypeError('Node expected for parameter "object"');if(!ah(t))throw new TypeError('IndexNode expected for parameter "index"');this.object=e,this.index=t}get name(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}get type(){return Nm}get isAccessorNode(){return!0}_compile(e,t){var n=this.object._compile(e,t),i=this.index._compile(e,t);if(this.index.isObjectProperty()){var o=this.index.getObjectProperty();return function(e,t,r){return gd(n(e,t,r),o)}}return function(e,t,o){var a=n(e,t,o),s=i(e,t,a);return r(a,s)}}forEach(e){e(this.object,"object",this),e(this.index,"index",this)}map(e){return new o(this._ifNode(e(this.object,"object",this)),this._ifNode(e(this.index,"index",this)))}clone(){return new o(this.object,this.index)}_toString(e){var t=this.object.toString(e);return i(this.object)&&(t="("+t+")"),t+this.index.toString(e)}_toHTML(e){var t=this.object.toHTML(e);return i(this.object)&&(t='<span class="math-parenthesis math-round-parenthesis">(</span>'+t+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t+this.index.toHTML(e)}_toTex(e){var t=this.object.toTex(e);return i(this.object)&&(t="\\left(' + object + '\\right)"),t+this.index.toTex(e)}toJSON(){return{mathjs:Nm,object:this.object,index:this.index}}static fromJSON(e){return new o(e.object,e.index)}}return S(o,"name",Nm),o},{isClass:!0,isNode:!0});var Am="AssignmentNode",Rm=vh(Am,["subset","?matrix","Node"],e=>{var{subset:t,matrix:n,Node:r}=e,i=Em({subset:t}),o=function(e){var{subset:t,matrix:n}=e;return function(e,r,i){try{if(Array.isArray(e))return n(e).subset(r,i).valueOf().forEach((t,n)=>{e[n]=t}),e;if(e&&"function"===typeof e.subset)return e.subset(r,i);if("string"===typeof e)return t(e,r,i);if("object"===typeof e){if(!r.isObjectProperty())throw TypeError("Cannot apply a numeric index as object property");return vd(e,r.getObjectProperty(),i),e}throw new TypeError("Cannot apply index: unsupported type of object")}catch(o){throw Cm(o)}}}({subset:t,matrix:n});function a(e,t,n){t||(t="keep");var r=Vf(e,t,n),i=Vf(e.value,t,n);return"all"===t||null!==i&&i<=r}class s extends r{constructor(e,t,n){if(super(),this.object=e,this.index=n?t:null,this.value=n||t,!fh(e)&&!Qd(e))throw new TypeError('SymbolNode or AccessorNode expected as "object"');if(fh(e)&&"end"===e.name)throw new Error('Cannot assign to symbol "end"');if(this.index&&!ah(this.index))throw new TypeError('IndexNode expected as "index"');if(!sh(this.value))throw new TypeError('Node expected as "value"')}get name(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}get type(){return Am}get isAssignmentNode(){return!0}_compile(e,t){var n=this.object._compile(e,t),r=this.index?this.index._compile(e,t):null,a=this.value._compile(e,t),s=this.object.name;if(this.index){if(this.index.isObjectProperty()){var l=this.index.getObjectProperty();return function(e,t,r){var i=n(e,t,r),o=a(e,t,r);return vd(i,l,o),o}}if(fh(this.object))return function(e,t,i){var l=n(e,t,i),c=a(e,t,i),u=r(e,t,l);return e.set(s,o(l,u,c)),c};var c=this.object.object._compile(e,t);if(this.object.index.isObjectProperty()){var u=this.object.index.getObjectProperty();return function(e,t,n){var i=c(e,t,n),s=gd(i,u),l=r(e,t,s),d=a(e,t,n);return vd(i,u,o(s,l,d)),d}}var d=this.object.index._compile(e,t);return function(e,t,n){var s=c(e,t,n),l=d(e,t,s),u=i(s,l),h=r(e,t,u),f=a(e,t,n);return o(s,l,o(u,h,f)),f}}if(!fh(this.object))throw new TypeError("SymbolNode expected as object");return function(e,t,n){var r=a(e,t,n);return e.set(s,r),r}}forEach(e){e(this.object,"object",this),this.index&&e(this.index,"index",this),e(this.value,"value",this)}map(e){var t=this._ifNode(e(this.object,"object",this)),n=this.index?this._ifNode(e(this.index,"index",this)):null,r=this._ifNode(e(this.value,"value",this));return new s(t,n,r)}clone(){return new s(this.object,this.index,this.value)}_toString(e){var t=this.object.toString(e),n=this.index?this.index.toString(e):"",r=this.value.toString(e);return a(this,e&&e.parenthesis,e&&e.implicit)&&(r="("+r+")"),t+n+" = "+r}toJSON(){return{mathjs:Am,object:this.object,index:this.index,value:this.value}}static fromJSON(e){return new s(e.object,e.index,e.value)}_toHTML(e){var t=this.object.toHTML(e),n=this.index?this.index.toHTML(e):"",r=this.value.toHTML(e);return a(this,e&&e.parenthesis,e&&e.implicit)&&(r='<span class="math-paranthesis math-round-parenthesis">(</span>'+r+'<span class="math-paranthesis math-round-parenthesis">)</span>'),t+n+'<span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+r}_toTex(e){var t=this.object.toTex(e),n=this.index?this.index.toTex(e):"",r=this.value.toTex(e);return a(this,e&&e.parenthesis,e&&e.implicit)&&(r="\\left(".concat(r,"\\right)")),t+n+"="+r}}return S(s,"name",Am),s},{isClass:!0,isNode:!0}),km=vh("SymbolNode",["math","?Unit","Node"],e=>{var{math:t,Unit:n,Node:r}=e;function i(e){return!!n&&n.isValuelessUnit(e)}class o extends r{constructor(e){if(super(),"string"!==typeof e)throw new TypeError('String expected for parameter "name"');this.name=e}get type(){return"SymbolNode"}get isSymbolNode(){return!0}_compile(e,t){var r=this.name;if(!0===t[r])return function(e,t,n){return gd(t,r)};if(r in e)return function(t,n,i){return t.has(r)?t.get(r):gd(e,r)};var a=i(r);return function(e,t,i){return e.has(r)?e.get(r):a?new n(null,r):o.onUndefinedSymbol(r)}}forEach(e){}map(e){return this.clone()}static onUndefinedSymbol(e){throw new Error("Undefined symbol "+e)}clone(){return new o(this.name)}_toString(e){return this.name}_toHTML(e){var t=Zh(this.name);return"true"===t||"false"===t?'<span class="math-symbol math-boolean">'+t+"</span>":"i"===t?'<span class="math-symbol math-imaginary-symbol">'+t+"</span>":"Infinity"===t?'<span class="math-symbol math-infinity-symbol">'+t+"</span>":"NaN"===t?'<span class="math-symbol math-nan-symbol">'+t+"</span>":"null"===t?'<span class="math-symbol math-null-symbol">'+t+"</span>":"undefined"===t?'<span class="math-symbol math-undefined-symbol">'+t+"</span>":'<span class="math-symbol">'+t+"</span>"}toJSON(){return{mathjs:"SymbolNode",name:this.name}}static fromJSON(e){return new o(e.name)}_toTex(e){var n=!1;"undefined"===typeof t[this.name]&&i(this.name)&&(n=!0);var r=Jf(this.name,n);return"\\"===r[0]?r:" "+r}}return o},{isClass:!0,isNode:!0}),Mm="FunctionNode",Dm=vh(Mm,["math","Node","SymbolNode"],e=>{var t,{math:n,Node:r,SymbolNode:i}=e,o=e=>Xh(e,{truncate:78});function a(e,t,n){for(var r,i="",o=/\$(?:\{([a-z_][a-z_0-9]*)(?:\[([0-9]+)\])?\}|\$)/gi,a=0;null!==(r=o.exec(e));)if(i+=e.substring(a,r.index),a=r.index,"$$"===r[0])i+="$",a++;else{a+=r[0].length;var s=t[r[1]];if(!s)throw new ReferenceError("Template: Property "+r[1]+" does not exist.");if(void 0===r[2])switch(typeof s){case"string":i+=s;break;case"object":if(sh(s))i+=s.toTex(n);else{if(!Array.isArray(s))throw new TypeError("Template: "+r[1]+" has to be a Node, String or array of Nodes");i+=s.map(function(e,t){if(sh(e))return e.toTex(n);throw new TypeError("Template: "+r[1]+"["+t+"] is not a Node.")}).join(",")}break;default:throw new TypeError("Template: "+r[1]+" has to be a Node, String or array of Nodes")}else{if(!sh(s[r[2]]&&s[r[2]]))throw new TypeError("Template: "+r[1]+"["+r[2]+"] is not a Node.");i+=s[r[2]].toTex(n)}}return i+=e.slice(a)}class s extends r{constructor(e,t){if(super(),"string"===typeof e&&(e=new i(e)),!sh(e))throw new TypeError('Node expected as parameter "fn"');if(!Array.isArray(t)||!t.every(sh))throw new TypeError('Array containing Nodes expected for parameter "args"');this.fn=e,this.args=t||[]}get name(){return this.fn.name||""}get type(){return Mm}get isFunctionNode(){return!0}_compile(e,t){var n=this.args.map(n=>n._compile(e,t));if(!fh(this.fn)){if(Qd(this.fn)&&ah(this.fn.index)&&this.fn.index.isObjectProperty()){var r=this.fn.object._compile(e,t),i=this.fn.index.getObjectProperty(),a=this.args;return function(t,o,s){var l=r(t,o,s),c=function(e,t){if(!bd(e,t))throw new Error('No access to method "'+t+'"');return e[t]}(l,i);if(null!==c&&void 0!==c&&c.rawArgs)return c(a,e,Bf(t,o));var u=n.map(e=>e(t,o,s));return c.apply(l,u)}}var l=this.fn.toString(),c=this.fn._compile(e,t),u=this.args;return function(t,r,i){var a=c(t,r,i);if("function"!==typeof a)throw new TypeError("Expression '".concat(l,"' did not evaluate to a function; value is:")+"\n  ".concat(o(a)));if(a.rawArgs)return a(u,e,Bf(t,r));var s=n.map(e=>e(t,r,i));return a.apply(a,s)}}var d=this.fn.name;if(t[d]){var h=this.args;return function(t,r,i){var a=gd(r,d);if("function"!==typeof a)throw new TypeError("Argument '".concat(d,"' was not a function; received: ").concat(o(a)));if(a.rawArgs)return a(h,e,Bf(t,r));var s=n.map(e=>e(t,r,i));return a.apply(a,s)}}var f=d in e?gd(e,d):void 0,m="function"===typeof f&&!0===f.rawArgs,p=t=>{var n;if(t.has(d))n=t.get(d);else{if(!(d in e))return s.onUndefinedFunction(d);n=gd(e,d)}if("function"===typeof n)return n;throw new TypeError("'".concat(d,"' is not a function; its value is:\n  ").concat(o(n)))};if(m){var g=this.args;return function(t,r,i){var o=p(t);return!0===o.rawArgs?o(g,e,Bf(t,r)):o(...n.map(e=>e(t,r,i)))}}switch(n.length){case 0:return function(e,t,n){return p(e)()};case 1:return function(e,t,r){return p(e)((0,n[0])(e,t,r))};case 2:return function(e,t,r){var i=p(e),o=n[0],a=n[1];return i(o(e,t,r),a(e,t,r))};default:return function(e,t,r){return p(e)(...n.map(n=>n(e,t,r)))}}}forEach(e){e(this.fn,"fn",this);for(var t=0;t<this.args.length;t++)e(this.args[t],"args["+t+"]",this)}map(e){for(var t=this._ifNode(e(this.fn,"fn",this)),n=[],r=0;r<this.args.length;r++)n[r]=this._ifNode(e(this.args[r],"args["+r+"]",this));return new s(t,n)}clone(){return new s(this.fn,this.args.slice(0))}toString(e){var t,n=this.fn.toString(e);return e&&"object"===typeof e.handler&&pd(e.handler,n)&&(t=e.handler[n](this,e)),"undefined"!==typeof t?t:super.toString(e)}_toString(e){var t=this.args.map(function(t){return t.toString(e)});return(ih(this.fn)?"("+this.fn.toString(e)+")":this.fn.toString(e))+"("+t.join(", ")+")"}toJSON(){return{mathjs:Mm,fn:this.fn,args:this.args}}_toHTML(e){var t=this.args.map(function(t){return t.toHTML(e)});return'<span class="math-function">'+Zh(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+t.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'}toTex(e){var t;return e&&"object"===typeof e.handler&&pd(e.handler,this.name)&&(t=e.handler[this.name](this,e)),"undefined"!==typeof t?t:super.toTex(e)}_toTex(e){var t,r,i=this.args.map(function(t){return t.toTex(e)});switch($f[this.name]&&(t=$f[this.name]),!n[this.name]||"function"!==typeof n[this.name].toTex&&"object"!==typeof n[this.name].toTex&&"string"!==typeof n[this.name].toTex||(t=n[this.name].toTex),typeof t){case"function":r=t(this,e);break;case"string":r=a(t,this,e);break;case"object":switch(typeof t[i.length]){case"function":r=t[i.length](this,e);break;case"string":r=a(t[i.length],this,e)}}return"undefined"!==typeof r?r:a("\\mathrm{${name}}\\left(${args}\\right)",this,e)}getIdentifier(){return this.type+":"+this.name}}return t=s,S(s,"name",Mm),S(s,"onUndefinedFunction",function(e){throw new Error("Undefined function "+e)}),S(s,"fromJSON",function(e){return new t(e.fn,e.args)}),s},{isClass:!0,isNode:!0});function _m(e){var t,n,r=e.length,i=e[0].length,o=[];for(n=0;n<i;n++){var a=[];for(t=0;t<r;t++)a.push(e[t][n]);o.push(a)}return o}function Om(e){for(var t=0;t<e.length;t++)if(jd(e[t]))return!0;return!1}function Im(e,t){Pd(e)?e.forEach(e=>t(e),!1,!0):Lf(e,t,!0)}function Pm(e,t,n){if(!n)return Pd(e)?e.map(e=>t(e),!1,!0):Hf(e,t,!0);var r=e=>0===e?e:t(e);return Pd(e)?e.map(e=>r(e),!1,!0):Hf(e,r,!0)}function jm(e,t,n){var r=Array.isArray(e)?sf(e):e.size();if(t<0||t>=r.length)throw new af(t,r.length);return Pd(e)?e.create(Fm(e.valueOf(),t,n),e.datatype()):Fm(e,t,n)}function Fm(e,t,n){var r,i,o,a;if(t<=0){if(Array.isArray(e[0])){for(a=_m(e),i=[],r=0;r<a.length;r++)i[r]=Fm(a[r],t-1,n);return i}for(o=e[0],r=1;r<e.length;r++)o=n(o,e[r]);return o}for(i=[],r=0;r<e.length;r++)i[r]=Fm(e[r],t-1,n);return i}function Hm(e,t,n,r,i,o,a,s,l,c,u){var d,h,f,m,p=e._values,g=e._index,v=e._ptr;if(r)for(h=v[t],f=v[t+1],d=h;d<f;d++)n[m=g[d]]!==o?(n[m]=o,a.push(m),c?(r[m]=l?s(p[d],u):s(u,p[d]),i[m]=o):r[m]=p[d]):(r[m]=l?s(p[d],r[m]):s(r[m],p[d]),i[m]=o);else for(h=v[t],f=v[t+1],d=h;d<f;d++)n[m=g[d]]!==o?(n[m]=o,a.push(m)):i[m]=o}var Lm="parse",Bm=vh(Lm,["typed","numeric","config","AccessorNode","ArrayNode","AssignmentNode","BlockNode","ConditionalNode","ConstantNode","FunctionAssignmentNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","RangeNode","RelationalNode","SymbolNode"],e=>{var{typed:t,numeric:n,config:r,AccessorNode:i,ArrayNode:o,AssignmentNode:a,BlockNode:s,ConditionalNode:l,ConstantNode:c,FunctionAssignmentNode:u,FunctionNode:d,IndexNode:h,ObjectNode:f,OperatorNode:m,ParenthesisNode:p,RangeNode:g,RelationalNode:v,SymbolNode:y}=e,b=t(Lm,{string:function(e){return j(e,{})},"Array | Matrix":function(e){return w(e,{})},"string, Object":function(e,t){return j(e,void 0!==t.nodes?t.nodes:{})},"Array | Matrix, Object":w});function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=void 0!==t.nodes?t.nodes:{};return Pm(e,function(e){if("string"!==typeof e)throw new TypeError("String expected");return j(e,n)})}var x={NULL:0,DELIMITER:1,NUMBER:2,SYMBOL:3,UNKNOWN:4},S={",":!0,"(":!0,")":!0,"[":!0,"]":!0,"{":!0,"}":!0,'"':!0,"'":!0,";":!0,"+":!0,"-":!0,"*":!0,".*":!0,"/":!0,"./":!0,"%":!0,"^":!0,".^":!0,"~":!0,"!":!0,"&":!0,"|":!0,"^|":!0,"=":!0,":":!0,"?":!0,"??":!0,"==":!0,"!=":!0,"<":!0,">":!0,"<=":!0,">=":!0,"<<":!0,">>":!0,">>>":!0},C={mod:!0,to:!0,in:!0,and:!0,xor:!0,or:!0,not:!0},E={true:!0,false:!1,null:null,undefined:void 0},N=["NaN","Infinity"],T={'"':'"',"'":"'","\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function A(e,t){return e.expression.substr(e.index,t)}function R(e){return A(e,1)}function k(e){e.index++}function M(e){return e.expression.charAt(e.index-1)}function D(e){return e.expression.charAt(e.index+1)}function _(e){for(e.tokenType=x.NULL,e.token="",e.comment="";;){if("#"===R(e))for(;"\n"!==R(e)&&""!==R(e);)e.comment+=R(e),k(e);if(!b.isWhitespace(R(e),e.nestingLevel))break;k(e)}if(""!==R(e)){if("\n"===R(e)&&!e.nestingLevel)return e.tokenType=x.DELIMITER,e.token=R(e),void k(e);var t=R(e),n=A(e,2),r=A(e,3);if(3===r.length&&S[r])return e.tokenType=x.DELIMITER,e.token=r,k(e),k(e),void k(e);if(2===n.length&&S[n])return e.tokenType=x.DELIMITER,e.token=n,k(e),void k(e);if(S[t])return e.tokenType=x.DELIMITER,e.token=t,void k(e);if(b.isDigitDot(t)){e.tokenType=x.NUMBER;var i=A(e,2);if("0b"===i||"0o"===i||"0x"===i){for(e.token+=R(e),k(e),e.token+=R(e),k(e);b.isAlpha(R(e),M(e),D(e))||b.isDigit(R(e));)e.token+=R(e),k(e);if("."===R(e))for(e.token+=".",k(e);b.isAlpha(R(e),M(e),D(e))||b.isDigit(R(e));)e.token+=R(e),k(e);else if("i"===R(e))for(e.token+="i",k(e);b.isDigit(R(e));)e.token+=R(e),k(e);return}if("."===R(e)){if(e.token+=R(e),k(e),!b.isDigit(R(e)))return void(e.tokenType=x.DELIMITER)}else{for(;b.isDigit(R(e));)e.token+=R(e),k(e);b.isDecimalMark(R(e),D(e))&&(e.token+=R(e),k(e))}for(;b.isDigit(R(e));)e.token+=R(e),k(e);if("E"===R(e)||"e"===R(e))if(b.isDigit(D(e))||"-"===D(e)||"+"===D(e)){if(e.token+=R(e),k(e),"+"!==R(e)&&"-"!==R(e)||(e.token+=R(e),k(e)),!b.isDigit(R(e)))throw ie(e,'Digit expected, got "'+R(e)+'"');for(;b.isDigit(R(e));)e.token+=R(e),k(e);if(b.isDecimalMark(R(e),D(e)))throw ie(e,'Digit expected, got "'+R(e)+'"')}else if(b.isDecimalMark(D(e),e.expression.charAt(e.index+2)))throw k(e),ie(e,'Digit expected, got "'+R(e)+'"')}else{if(!b.isAlpha(R(e),M(e),D(e))){for(e.tokenType=x.UNKNOWN;""!==R(e);)e.token+=R(e),k(e);throw ie(e,'Syntax error in part "'+e.token+'"')}for(;b.isAlpha(R(e),M(e),D(e))||b.isDigit(R(e));)e.token+=R(e),k(e);pd(C,e.token)?e.tokenType=x.DELIMITER:e.tokenType=x.SYMBOL}}else e.tokenType=x.DELIMITER}function O(e){do{_(e)}while("\n"===e.token)}function I(e){e.nestingLevel++}function P(e){e.nestingLevel--}function j(e,t){var n={extraNodes:{},expression:"",comment:"",index:0,token:"",tokenType:x.NULL,nestingLevel:0,conditionalLevel:null};sd(n,{expression:e,extraNodes:t}),_(n);var r=function(e){var t,n,r=[];""!==e.token&&"\n"!==e.token&&";"!==e.token&&(t=F(e),e.comment&&(t.comment=e.comment));for(;"\n"===e.token||";"===e.token;)0===r.length&&t&&(n=";"!==e.token,r.push({node:t,visible:n})),_(e),"\n"!==e.token&&";"!==e.token&&""!==e.token&&(t=F(e),e.comment&&(t.comment=e.comment),n=";"!==e.token,r.push({node:t,visible:n}));return r.length>0?new s(r):(t||(t=new c(void 0),e.comment&&(t.comment=e.comment)),t)}(n);if(""!==n.token)throw n.tokenType===x.DELIMITER?oe(n,"Unexpected operator "+n.token):ie(n,'Unexpected part "'+n.token+'"');return r}function F(e){var t,n,r,i,o=function(e){var t=function(e){var t=H(e);for(;"or"===e.token;)O(e),t=new m("or","or",[t,H(e)]);return t}(e);for(;"?"===e.token;){var n=e.conditionalLevel;e.conditionalLevel=e.nestingLevel,O(e);var r=t,i=F(e);if(":"!==e.token)throw ie(e,"False part of conditional expression expected");e.conditionalLevel=null,O(e);var o=F(e);t=new l(r,i,o),e.conditionalLevel=n}return t}(e);if("="===e.token){if(fh(o))return t=o.name,O(e),r=F(e),new a(new y(t),r);if(Qd(o))return O(e),r=F(e),new a(o.object,o.index,r);if(oh(o)&&fh(o.fn)&&(i=!0,n=[],t=o.name,o.args.forEach(function(e,t){fh(e)?n[t]=e.name:i=!1}),i))return O(e),r=F(e),new u(t,n,r);throw ie(e,"Invalid left hand side of assignment operator =")}return o}function H(e){for(var t=L(e);"xor"===e.token;)O(e),t=new m("xor","xor",[t,L(e)]);return t}function L(e){for(var t=B(e);"and"===e.token;)O(e),t=new m("and","and",[t,B(e)]);return t}function B(e){for(var t=z(e);"|"===e.token;)O(e),t=new m("|","bitOr",[t,z(e)]);return t}function z(e){for(var t=W(e);"^|"===e.token;)O(e),t=new m("^|","bitXor",[t,W(e)]);return t}function W(e){for(var t=V(e);"&"===e.token;)O(e),t=new m("&","bitAnd",[t,V(e)]);return t}function V(e){for(var t=[U(e)],n=[],r={"==":"equal","!=":"unequal","<":"smaller",">":"larger","<=":"smallerEq",">=":"largerEq"};pd(r,e.token);){var i={name:e.token,fn:r[e.token]};n.push(i),O(e),t.push(U(e))}return 1===t.length?t[0]:2===t.length?new m(n[0].name,n[0].fn,t):new v(n.map(e=>e.fn),t)}function U(e){var t,n,r,i;t=q(e);for(var o={"<<":"leftShift",">>":"rightArithShift",">>>":"rightLogShift"};pd(o,e.token);)r=o[n=e.token],O(e),i=[t,q(e)],t=new m(n,r,i);return t}function q(e){var t,n,r,i;t=G(e);for(var o={to:"to",in:"to"};pd(o,e.token);)r=o[n=e.token],O(e),"in"===n&&"])},;".includes(e.token)?t=new m("*","multiply",[t,new y("in")],!0):(i=[t,G(e)],t=new m(n,r,i));return t}function G(e){var t,n=[];if(t=":"===e.token?new c(1):Y(e),":"===e.token&&e.conditionalLevel!==e.nestingLevel){for(n.push(t);":"===e.token&&n.length<3;)O(e),")"===e.token||"]"===e.token||","===e.token||""===e.token?n.push(new y("end")):n.push(Y(e));t=3===n.length?new g(n[0],n[2],n[1]):new g(n[0],n[1])}return t}function Y(e){var t,n,r,i;t=K(e);for(var o={"+":"add","-":"subtract"};pd(o,e.token);){r=o[n=e.token],O(e);var a=K(e);i=a.isPercentage?[t,new m("*","multiply",[t,a])]:[t,a],t=new m(n,r,i)}return t}function K(e){var t,n,r,i;n=t=$(e);for(var o={"*":"multiply",".*":"dotMultiply","/":"divide","./":"dotDivide","%":"mod",mod:"mod"};pd(o,e.token);)i=o[r=e.token],O(e),n=$(e),t=new m(r,i,[t,n]);return t}function $(e){var t,n;for(n=t=X(e);e.tokenType===x.SYMBOL||"in"===e.token&&nh(t)||"in"===e.token&&ch(t)&&"unaryMinus"===t.fn&&nh(t.args[0])||!(e.tokenType!==x.NUMBER||nh(n)||ch(n)&&"!"!==n.op)||"("===e.token;)n=X(e),t=new m("*","multiply",[t,n],!0);return t}function X(e){for(var t=Q(e),n=t,r=[];"/"===e.token&&rh(n);){if(r.push(sd({},e)),O(e),e.tokenType!==x.NUMBER){sd(e,r.pop());break}if(r.push(sd({},e)),O(e),e.tokenType!==x.SYMBOL&&"("!==e.token&&"in"!==e.token){r.pop(),sd(e,r.pop());break}sd(e,r.pop()),r.pop(),n=Q(e),t=new m("/","divide",[t,n])}return t}function Q(e){var t=J(e);if("%"===e.token){var n=sd({},e);O(e);try{J(e),sd(e,n)}catch(r){t=new m("/","divide",[t,new c(100)],!1,!0)}}return t}function J(e){var t,n,r,i={"-":"unaryMinus","+":"unaryPlus","~":"bitNot",not:"not"};return pd(i,e.token)?(r=i[e.token],t=e.token,O(e),n=[J(e)],new m(t,r,n)):function(e){var t,n,r,i;t=function(e){var t=Z(e);for(;"??"===e.token;)O(e),t=new m("??","nullish",[t,Z(e)]);return t}(e),("^"===e.token||".^"===e.token)&&(r="^"===(n=e.token)?"pow":"dotPow",O(e),i=[t,J(e)],t=new m(n,r,i));return t}(e)}function Z(e){var t,i,a;t=function(e){var t=[];if(e.tokenType===x.SYMBOL&&pd(e.extraNodes,e.token)){var i=e.extraNodes[e.token];if(_(e),"("===e.token){if(t=[],I(e),_(e),")"!==e.token)for(t.push(F(e));","===e.token;)_(e),t.push(F(e));if(")"!==e.token)throw ie(e,"Parenthesis ) expected");P(e),_(e)}return new i(t)}return function(e){var t;if(e.tokenType===x.SYMBOL||e.tokenType===x.DELIMITER&&e.token in C)return t=e.token,_(e),ee(e,pd(E,t)?new c(E[t]):N.includes(t)?new c(n(t,"number")):new y(t));return function(e){var t;if('"'===e.token||"'"===e.token)return t=te(e,e.token),ee(e,new c(t));return function(e){var t,i,a,s;if("["===e.token){if(I(e),_(e),"]"!==e.token){var l=ne(e);if(";"===e.token){for(a=1,i=[l];";"===e.token;)_(e),"]"!==e.token&&(i[a]=ne(e),a++);if("]"!==e.token)throw ie(e,"End of matrix ] expected");P(e),_(e),s=i[0].items.length;for(var u=1;u<a;u++)if(i[u].items.length!==s)throw oe(e,"Column dimensions mismatch ("+i[u].items.length+" !== "+s+")");t=new o(i)}else{if("]"!==e.token)throw ie(e,"End of matrix ] expected");P(e),_(e),t=l}}else P(e),_(e),t=new o([]);return ee(e,t)}return function(e){if("{"===e.token){var t;I(e);var i={};do{if(_(e),"}"!==e.token){if('"'===e.token||"'"===e.token)t=te(e,e.token);else{if(!(e.tokenType===x.SYMBOL||e.tokenType===x.DELIMITER&&e.token in C))throw ie(e,"Symbol or string expected as object key");t=e.token,_(e)}if(":"!==e.token)throw ie(e,"Colon : expected after object key");_(e),i[t]=F(e)}}while(","===e.token);if("}"!==e.token)throw ie(e,"Comma , or bracket } expected after object value");P(e),_(e);var o=new f(i);return o=ee(e,o)}return function(e){var t;if(e.tokenType===x.NUMBER){t=e.token,_(e);var i=xh(t,r),o=n(t,i);return new c(o)}return function(e){var t;if("("===e.token){if(I(e),_(e),t=F(e),")"!==e.token)throw ie(e,"Parenthesis ) expected");return P(e),_(e),t=ee(e,t=new p(t))}return function(e){throw""===e.token?ie(e,"Unexpected end of expression"):ie(e,"Value expected")}(e)}(e)}(e)}(e)}(e)}(e)}(e)}(e);for(var s={"!":"factorial","'":"ctranspose"};pd(s,e.token);)a=s[i=e.token],_(e),t=ee(e,t=new m(i,a,[t]));return t}function ee(e,t,n){for(var r;("("===e.token||"["===e.token||"."===e.token)&&(!n||n.includes(e.token));)if(r=[],"("===e.token){if(!fh(t)&&!Qd(t))return t;if(I(e),_(e),")"!==e.token)for(r.push(F(e));","===e.token;)_(e),r.push(F(e));if(")"!==e.token)throw ie(e,"Parenthesis ) expected");P(e),_(e),t=new d(t,r)}else if("["===e.token){if(I(e),_(e),"]"!==e.token)for(r.push(F(e));","===e.token;)_(e),r.push(F(e));if("]"!==e.token)throw ie(e,"Parenthesis ] expected");P(e),_(e),t=new i(t,new h(r))}else{if(_(e),!(e.tokenType===x.SYMBOL||e.tokenType===x.DELIMITER&&e.token in C))throw ie(e,"Property name expected after dot");r.push(new c(e.token)),_(e);t=new i(t,new h(r,!0))}return t}function te(e,t){for(var n="";""!==R(e)&&R(e)!==t;)if("\\"===R(e)){k(e);var r=R(e),i=T[r];if(void 0!==i)n+=i,e.index+=1;else{if("u"!==r)throw ie(e,"Bad escape character \\".concat(r));var o=e.expression.slice(e.index+1,e.index+5);if(!/^[0-9A-Fa-f]{4}$/.test(o))throw ie(e,"Invalid unicode character \\u".concat(o));n+=String.fromCharCode(parseInt(o,16)),e.index+=5}}else n+=R(e),k(e);if(_(e),e.token!==t)throw ie(e,"End of string ".concat(t," expected"));return _(e),n}function ne(e){for(var t=[F(e)],n=1;","===e.token;)_(e),"]"!==e.token&&";"!==e.token&&(t[n]=F(e),n++);return new o(t)}function re(e){return e.index-e.token.length+1}function ie(e,t){var n=re(e),r=new SyntaxError(t+" (char "+n+")");return r.char=n,r}function oe(e,t){var n=re(e),r=new SyntaxError(t+" (char "+n+")");return r.char=n,r}return b.isAlpha=function(e,t,n){return b.isValidLatinOrGreek(e)||b.isValidMathSymbol(e,n)||b.isValidMathSymbol(t,e)},b.isValidLatinOrGreek=function(e){return/^[a-zA-Z_$\u00C0-\u02AF\u0370-\u03FF\u2100-\u214F]$/.test(e)},b.isValidMathSymbol=function(e,t){return/^[\uD835]$/.test(e)&&/^[\uDC00-\uDFFF]$/.test(t)&&/^[^\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDFCC\uDFCD]$/.test(t)},b.isWhitespace=function(e,t){return" "===e||"\t"===e||"\xa0"===e||"\n"===e&&t>0},b.isDecimalMark=function(e,t){return"."===e&&"/"!==t&&"*"!==t&&"^"!==t},b.isDigitDot=function(e){return e>="0"&&e<="9"||"."===e},b.isDigit=function(e){return e>="0"&&e<="9"},t.addConversion({from:"string",to:"Node",convert:b}),b}),zm=vh("resolve",["typed","parse","ConstantNode","FunctionNode","OperatorNode","ParenthesisNode"],e=>{var{typed:t,parse:n,ConstantNode:r,FunctionNode:i,OperatorNode:o,ParenthesisNode:a}=e;function s(e,t){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;if(!t)return e;if(fh(e)){if(l.has(e.name)){var c=Array.from(l).join(", ");throw new ReferenceError("recursive loop of variable definitions among {".concat(c,"}"))}var u=t.get(e.name);if(sh(u)){var d=new Set(l);return d.add(e.name),s(u,t,d)}return"number"===typeof u?n(String(u)):void 0!==u?new r(u):e}if(ch(e)){var h=e.args.map(function(e){return s(e,t,l)});return new o(e.op,e.fn,h,e.implicit)}if(uh(e))return new a(s(e.content,t,l));if(oh(e)){var f=e.args.map(function(e){return s(e,t,l)});return new i(e.name,f)}return e.map(e=>s(e,t,l))}return t("resolve",{Node:s,"Node, Map | null | undefined":s,"Node, Object":(e,t)=>s(e,Td(t)),"Array | Matrix":t.referToSelf(e=>t=>t.map(t=>e(t))),"Array | Matrix, null | undefined":t.referToSelf(e=>t=>t.map(t=>e(t))),"Array, Object":t.referTo("Array,Map",e=>(t,n)=>e(t,Td(n))),"Matrix, Object":t.referTo("Matrix,Map",e=>(t,n)=>e(t,Td(n))),"Array | Matrix, Map":t.referToSelf(e=>(t,n)=>t.map(t=>e(t,n)))})});function Wm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Vm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wm(Object(n),!0).forEach(function(t){S(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wm(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Um=vh("simplifyUtil",["FunctionNode","OperatorNode","SymbolNode"],e=>{var{FunctionNode:t,OperatorNode:n,SymbolNode:r}=e,i=!0,o=!1,a="defaultF",s={add:{trivial:i,total:i,commutative:i,associative:i},unaryPlus:{trivial:i,total:i,commutative:i,associative:i},subtract:{trivial:o,total:i,commutative:o,associative:o},multiply:{trivial:i,total:i,commutative:i,associative:i},divide:{trivial:o,total:i,commutative:o,associative:o},paren:{trivial:i,total:i,commutative:i,associative:o},defaultF:{trivial:o,total:i,commutative:o,associative:o}};function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s,r=a;if("string"===typeof e?r=e:ch(e)?r=e.fn.toString():oh(e)?r=e.name:uh(e)&&(r="paren"),pd(n,r)){var i=n[r];if(pd(i,t))return i[t];if(pd(s,r))return s[r][t]}if(pd(n,a)){var o=n[a];return pd(o,t)?o[t]:s[a][t]}if(pd(s,r)){var l=s[r];if(pd(l,t))return l[t]}return s[a][t]}function c(e){return l(e,"associative",arguments.length>1&&void 0!==arguments[1]?arguments[1]:s)}function u(e,t){var n,r=[],i=function(e){for(var t=0;t<e.args.length;t++){var o=e.args[t];ch(o)&&n===o.op?i(o):r.push(o)}};return c(e,t)?(n=e.op,i(e),r):e.args}function d(e){return ch(e)?function(t){try{return new n(e.op,e.fn,t,e.implicit)}catch(r){return console.error(r),[]}}:function(n){return new t(new r(e.name),n)}}return{createMakeNodeFunction:d,hasProperty:l,isCommutative:function(e){return l(e,"commutative",arguments.length>1&&void 0!==arguments[1]?arguments[1]:s)},isAssociative:c,mergeContext:function(e,t){var n=Vm({},e);for(var r in t)pd(e,r)?n[r]=Vm(Vm({},t[r]),e[r]):n[r]=t[r];return n},flatten:function e(t,n){if(!t.args||0===t.args.length)return t;t.args=u(t,n);for(var r=0;r<t.args.length;r++)e(t.args[r],n)},allChildren:u,unflattenr:function e(t,n){if(t.args&&0!==t.args.length){for(var r=d(t),i=t.args.length,o=0;o<i;o++)e(t.args[o],n);if(i>2&&c(t,n)){for(var a=t.args.pop();t.args.length>0;)a=r([t.args.pop(),a]);t.args=a.args}}},unflattenl:function e(t,n){if(t.args&&0!==t.args.length){for(var r=d(t),i=t.args.length,o=0;o<i;o++)e(t.args[o],n);if(i>2&&c(t,n)){for(var a=t.args.shift();t.args.length>0;)a=r([a,t.args.shift()]);t.args=a.args}}},defaultContext:s,realContext:{divide:{total:o},log:{total:o}},positiveContext:{subtract:{total:o},abs:{trivial:i},log:{total:i}}}});function qm(){throw new Error('No "bignumber" implementation available')}function Gm(){throw new Error('No "fraction" implementation available')}var Ym=vh("simplifyConstant",["typed","config","mathWithTransform","matrix","?fraction","?bignumber","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","SymbolNode"],e=>{var{typed:t,config:n,mathWithTransform:r,matrix:i,fraction:o,bignumber:a,AccessorNode:s,ArrayNode:l,ConstantNode:c,FunctionNode:u,IndexNode:d,ObjectNode:h,OperatorNode:f,SymbolNode:m}=e,{isCommutative:p,isAssociative:g,allChildren:v,createMakeNodeFunction:y}=Um({FunctionNode:u,OperatorNode:f,SymbolNode:m}),b=t("simplifyConstant",{Node:e=>C(R(e,{})),"Node, Object":function(e,t){return C(R(e,t))}});function w(e){return Dd(e)?e.valueOf():e instanceof Array?e.map(w):Pd(e)?i(w(e.valueOf())):e}function x(e,t,n){try{return r[e].apply(null,t)}catch(i){return t=t.map(w),N(r[e].apply(null,t),n)}}var S=t({Fraction:function(e){var t=e=>"BigNumber"===n.number&&a?a(e):Number(e),r=e.s*e.n,i=r<0n?new f("-","unaryMinus",[new c(-t(r))]):new c(t(r));return 1n===e.d?i:new f("/","divide",[i,new c(t(e.d))])},number:function(e){return e<0?T(new c(-e)):new c(e)},BigNumber:function(e){return e<0?T(new c(-e)):new c(e)},bigint:function(e){return e<0n?T(new c(-e)):new c(e)},Complex:function(e){throw new Error("Cannot convert Complex number to Node")},string:function(e){return new c(e)},Matrix:function(e){return new l(e.valueOf().map(e=>S(e)))}});function C(e){return sh(e)?e:S(e)}function E(e,t){if(t&&!1!==t.exactFractions&&isFinite(e)&&o){var n=o(e),r=t&&"number"===typeof t.fractionsLimit?t.fractionsLimit:1/0;if(n.valueOf()===e&&n.n<r&&n.d<r)return n}return e}var N=t({"string, Object":function(e,t){var r=xh(e,n);return"BigNumber"===r?(void 0===a&&qm(),a(e)):"bigint"===r?BigInt(e):"Fraction"===r?(void 0===o&&Gm(),o(e)):E(parseFloat(e),t)},"Fraction, Object":function(e,t){return e},"BigNumber, Object":function(e,t){return e},"number, Object":function(e,t){return E(e,t)},"bigint, Object":function(e,t){return e},"Complex, Object":function(e,t){return 0!==e.im?e:E(e.re,t)},"Matrix, Object":function(e,t){return i(E(e.valueOf()))},"Array, Object":function(e,t){return e.map(E)}});function T(e){return new f("-","unaryMinus",[e])}function A(e,t,n,r){var i=t.shift(),o=t.reduce((t,i)=>{if(!sh(i)){var o=t.pop();if(sh(o))return[o,i];try{return t.push(x(e,[o,i],r)),t}catch(s){t.push(o)}}t.push(C(t.pop()));var a=1===t.length?t[0]:n(t);return[n([a,C(i)])]},[i]);return 1===o.length?o[0]:n([o[0],S(o[1])])}function R(e,t){switch(e.type){case"SymbolNode":return e;case"ConstantNode":switch(typeof e.value){case"number":case"bigint":return N(e.value,t);case"string":return e.value;default:if(!isNaN(e.value))return N(e.value,t)}return e;case"FunctionNode":if(r[e.name]&&r[e.name].rawArgs)return e;if(!["add","multiply"].includes(e.name)){var n=e.args.map(e=>R(e,t));if(!n.some(sh))try{return x(e.name,n,t)}catch(O){}if("size"===e.name&&1===n.length&&Jd(n[0])){for(var o=[],a=n[0];Jd(a);)o.push(a.items.length),a=a.items[0];return i(o)}return new u(e.name,n.map(C))}case"OperatorNode":var f,m,w=e.fn.toString(),S=y(e);if(ch(e)&&e.isUnary())m=sh((f=[R(e.args[0],t)])[0])?S(f):x(w,f,t);else if(g(e,t.context))if(f=(f=v(e,t.context)).map(e=>R(e,t)),p(w,t.context)){for(var E=[],T=[],k=0;k<f.length;k++)sh(f[k])?T.push(f[k]):E.push(f[k]);E.length>1?(m=A(w,E,S,t),T.unshift(m),m=A(w,T,S,t)):m=A(w,f,S,t)}else m=A(w,f,S,t);else f=e.args.map(e=>R(e,t)),m=A(w,f,S,t);return m;case"ParenthesisNode":return R(e.content,t);case"AccessorNode":return function(e,t,n){if(!ah(t))return new s(C(e),C(t));if(Jd(e)||Pd(e)){for(var r=Array.from(t.dimensions);r.length>0;)if(nh(r[0])&&"string"!==typeof r[0].value){var o=N(r.shift().value,n);Jd(e)?e=e.items[o-1]:(e=e.valueOf()[o-1])instanceof Array&&(e=i(e))}else{if(!(r.length>1&&nh(r[1])&&"string"!==typeof r[1].value))break;var a=N(r[1].value,n),u=[],h=Jd(e)?e.items:e.valueOf();for(var f of h)if(Jd(f))u.push(f.items[a-1]);else{if(!Pd(e))break;u.push(f[a-1])}if(u.length!==h.length)break;e=Jd(e)?new l(u):i(u),r.splice(1,1)}return r.length===t.dimensions.length?new s(C(e),t):r.length>0?(t=new d(r),new s(C(e),t)):e}if(lh(e)&&1===t.dimensions.length&&nh(t.dimensions[0])){var m=t.dimensions[0].value;return m in e.properties?e.properties[m]:new c}return new s(C(e),t)}(R(e.object,t),R(e.index,t),t);case"ArrayNode":var M=e.items.map(e=>R(e,t));return M.some(sh)?new l(M.map(C)):i(M);case"IndexNode":return new d(e.dimensions.map(e=>b(e,t)));case"ObjectNode":var D={};for(var _ in e.properties)D[_]=b(e.properties[_],t);return new h(D);default:throw new Error("Unimplemented node type in simplifyConstant: ".concat(e.type))}}return b}),Km="compile",$m=vh(Km,["typed","parse"],e=>{var{typed:t,parse:n}=e;return t(Km,{string:function(e){return n(e).compile()},"Array | Matrix":function(e){return Pm(e,function(e){return n(e).compile()})}})}),Xm="simplifyCore",Qm=vh(Xm,["typed","parse","equal","isZero","add","subtract","multiply","divide","pow","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","SymbolNode"],e=>{var{typed:t,parse:n,equal:r,isZero:i,add:o,subtract:a,multiply:s,divide:l,pow:c,AccessorNode:u,ArrayNode:d,ConstantNode:h,FunctionNode:f,IndexNode:m,ObjectNode:p,OperatorNode:g,ParenthesisNode:v,SymbolNode:y}=e,b=new h(0),w=new h(1),x=new h(!0),S=new h(!1);function C(e){return ch(e)&&["and","not","or"].includes(e.op)}var{hasProperty:E,isCommutative:N}=Um({FunctionNode:f,OperatorNode:g,SymbolNode:y});function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t?t.context:void 0;if(E(e,"trivial",n)){if(oh(e)&&1===e.args.length)return T(e.args[0],t);var o=!1,a=0;if(e.forEach(e=>{1===++a&&(o=T(e,t))}),1===a)return o}var s=e;if(oh(s)){var l=function(e){var t="OperatorNode:"+e;for(var n of zf)if(t in n)return n[t].op;return null}(s.name);if(!l)return new f(T(s.fn),s.args.map(e=>T(e,t)));if(s.args.length>2&&E(s,"associative",n))for(;s.args.length>2;){var c=s.args.pop(),h=s.args.pop();s.args.push(new g(l,s.name,[c,h]))}s=new g(l,s.name,s.args)}if(ch(s)&&s.isUnary()){var v=T(s.args[0],t);if("~"===s.op&&ch(v)&&v.isUnary()&&"~"===v.op)return v.args[0];if("not"===s.op&&ch(v)&&v.isUnary()&&"not"===v.op&&C(v.args[0]))return v.args[0];var y=!0;if("-"===s.op&&ch(v)&&(v.isBinary()&&"subtract"===v.fn&&(s=new g("-","subtract",[v.args[1],v.args[0]]),y=!1),v.isUnary()&&"-"===v.op))return v.args[0];if(y)return new g(s.op,s.fn,[v])}if(ch(s)&&s.isBinary()){var A=T(s.args[0],t),R=T(s.args[1],t);if("+"===s.op){if(nh(A)&&i(A.value))return R;if(nh(R)&&i(R.value))return A;ch(R)&&R.isUnary()&&"-"===R.op&&(R=R.args[0],s=new g("-","subtract",[A,R]))}if("-"===s.op)return ch(R)&&R.isUnary()&&"-"===R.op?T(new g("+","add",[A,R.args[0]]),t):nh(A)&&i(A.value)?T(new g("-","unaryMinus",[R])):nh(R)&&i(R.value)?A:new g(s.op,s.fn,[A,R]);if("*"===s.op){if(nh(A)){if(i(A.value))return b;if(r(A.value,1))return R}if(nh(R)){if(i(R.value))return b;if(r(R.value,1))return A;if(N(s,n))return new g(s.op,s.fn,[R,A],s.implicit)}return new g(s.op,s.fn,[A,R],s.implicit)}if("/"===s.op)return nh(A)&&i(A.value)?b:nh(R)&&r(R.value,1)?A:new g(s.op,s.fn,[A,R]);if("^"===s.op&&nh(R)){if(i(R.value))return w;if(r(R.value,1))return A}if("and"===s.op){if(nh(A)){if(!A.value)return S;if(C(R))return R;if(nh(R))return R.value?x:S}if(nh(R)){if(!R.value)return S;if(C(A))return A}}if("or"===s.op){if(nh(A)){if(A.value)return x;if(C(R))return R}if(nh(R)){if(R.value)return x;if(C(A))return A}}return new g(s.op,s.fn,[A,R])}if(ch(s))return new g(s.op,s.fn,s.args.map(e=>T(e,t)));if(Jd(s))return new d(s.items.map(e=>T(e,t)));if(Qd(s))return new u(T(s.object,t),T(s.index,t));if(ah(s))return new m(s.dimensions.map(e=>T(e,t)));if(lh(s)){var k={};for(var M in s.properties)k[M]=T(s.properties[M],t);return new p(k)}return s}return t(Xm,{Node:T,"Node,Object":T})}),Jm="evaluate",Zm=vh(Jm,["typed","parse"],e=>{var{typed:t,parse:n}=e;return t(Jm,{string:function(e){var t=Nd();return n(e).compile().evaluate(t)},"string, Map | Object":function(e,t){return n(e).compile().evaluate(t)},"Array | Matrix":function(e){var t=Nd();return Pm(e,function(e){return n(e).compile().evaluate(t)})},"Array | Matrix, Map | Object":function(e,t){return Pm(e,function(e){return n(e).compile().evaluate(t)})}})}),ep=vh("Help",["evaluate"],e=>{var{evaluate:t}=e;function n(e){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(!e)throw new Error('Argument "doc" missing');this.doc=e}return n.prototype.type="Help",n.prototype.isHelp=!0,n.prototype.toString=function(){var e=this.doc||{},n="\n";if(e.name&&(n+="Name: "+e.name+"\n\n"),e.category&&(n+="Category: "+e.category+"\n\n"),e.description&&(n+="Description:\n    "+e.description+"\n\n"),e.syntax&&(n+="Syntax:\n    "+e.syntax.join("\n    ")+"\n\n"),e.examples){n+="Examples:\n";for(var r=!1,i=t("config()"),o={config:e=>(r=!0,t("config(newConfig)",{newConfig:e}))},a=0;a<e.examples.length;a++){var s=e.examples[a];n+="    "+s+"\n";var l=void 0;try{l=t(s,o)}catch(qb){l=qb}void 0===l||Vd(l)||(n+="        "+Xh(l,{precision:14})+"\n")}n+="\n",r&&t("config(originalConfig)",{originalConfig:i})}return e.mayThrow&&e.mayThrow.length&&(n+="Throws: "+e.mayThrow.join(", ")+"\n\n"),e.seealso&&e.seealso.length&&(n+="See also: "+e.seealso.join(", ")+"\n"),n},n.prototype.toJSON=function(){var e=hd(this.doc);return e.mathjs="Help",e},n.fromJSON=function(e){var t={};return Object.keys(e).filter(e=>"mathjs"!==e).forEach(n=>{t[n]=e[n]}),new n(t)},n.prototype.valueOf=n.prototype.toString,n},{isClass:!0}),tp=vh("Parser",["evaluate","parse"],e=>{var{evaluate:t,parse:n}=e;function r(){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");Object.defineProperty(this,"scope",{value:Nd(),writable:!1})}return r.prototype.type="Parser",r.prototype.isParser=!0,r.prototype.evaluate=function(e){return t(e,this.scope)},r.prototype.get=function(e){if(this.scope.has(e))return this.scope.get(e)},r.prototype.getAll=function(){return function(e){if(e instanceof Sd)return e.wrappedObject;var t={};for(var n of e.keys())vd(t,n,e.get(n));return t}(this.scope)},r.prototype.getAllAsMap=function(){return this.scope},r.prototype.set=function(e,t){if(!function(e){if(0===e.length)return!1;for(var t=0;t<e.length;t++){var r=e.charAt(t-1),i=e.charAt(t),o=e.charAt(t+1);if(!(n.isAlpha(i,r,o)||t>0&&n.isDigit(i)))return!1}return!0}(e))throw new Error("Invalid variable name: '".concat(e,"'. Variable names must follow the specified rules."));return this.scope.set(e,t),t},r.prototype.remove=function(e){this.scope.delete(e)},r.prototype.clear=function(){this.scope.clear()},r.prototype.toJSON=function(){var e={mathjs:"Parser",variables:{},functions:{}};for(var[t,n]of this.scope)if(Ud(n)){if(!np(n))throw new Error("Cannot serialize external function ".concat(t));e.functions[t]="".concat(n.syntax," = ").concat(n.expr)}else e.variables[t]=n;return e},r.fromJSON=function(e){var t=new r;return Object.entries(e.variables).forEach(e=>{var[n,r]=e;return t.set(n,r)}),Object.entries(e.functions).forEach(e=>{var[n,r]=e;return t.evaluate(r)}),t},r},{isClass:!0});function np(e){return"function"===typeof e&&"string"===typeof e.syntax&&"string"===typeof e.expr}function rp(e){return nh(e)||ch(e)&&e.isUnary()&&nh(e.args[0])}function ip(e){return!!nh(e)||(!(!oh(e)&&!ch(e)||!e.args.every(ip))||!(!uh(e)||!ip(e.content)))}var op=["typed","parse","equal","resolve","simplifyConstant","simplifyCore","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","SymbolNode","replacer"],ap=vh("simplify",op,e=>{var{typed:t,parse:n,equal:r,resolve:i,simplifyConstant:o,simplifyCore:a,AccessorNode:s,ArrayNode:l,ConstantNode:c,FunctionNode:u,IndexNode:d,ObjectNode:h,OperatorNode:f,ParenthesisNode:m,SymbolNode:p,replacer:g}=e,{hasProperty:v,isCommutative:y,isAssociative:b,mergeContext:w,flatten:x,unflattenr:S,unflattenl:C,createMakeNodeFunction:E,defaultContext:N,realContext:T,positiveContext:A}=Um({FunctionNode:u,OperatorNode:f,SymbolNode:p});t.addConversion({from:"Object",to:"Map",convert:Td});var R=t("simplify",{Node:I,"Node, Map":(e,t)=>I(e,!1,t),"Node, Map, Object":(e,t,n)=>I(e,!1,t,n),"Node, Array":I,"Node, Array, Map":I,"Node, Array, Map, Object":I});function k(e){return e.transform(function(e){return uh(e)?k(e.content):e})}t.removeConversion({from:"Object",to:"Map",convert:Td}),R.defaultContext=N,R.realContext=T,R.positiveContext=A;var M={true:!0,false:!0,e:!0,i:!0,Infinity:!0,LN2:!0,LN10:!0,LOG2E:!0,LOG10E:!0,NaN:!0,phi:!0,pi:!0,SQRT1_2:!0,SQRT2:!0,tau:!0};function D(e,t){var r={};if(e.s){var i=e.s.split("->");if(2!==i.length)throw SyntaxError("Could not parse rule: "+e.s);r.l=i[0],r.r=i[1]}else r.l=e.l,r.r=e.r;for(var o of(r.l=k(n(r.l)),r.r=k(n(r.r)),["imposeContext","repeat","assuming"]))o in e&&(r[o]=e[o]);if(e.evaluate&&(r.evaluate=n(e.evaluate)),b(r.l,t)){var a,s=!y(r.l,t);s&&(a=O());var l=E(r.l),c=O();r.expanded={},r.expanded.l=l([r.l,c]),x(r.expanded.l,t),S(r.expanded.l,t),r.expanded.r=l([r.r,c]),s&&(r.expandedNC1={},r.expandedNC1.l=l([a,r.l]),r.expandedNC1.r=l([a,r.r]),r.expandedNC2={},r.expandedNC2.l=l([a,r.expanded.l]),r.expandedNC2.r=l([a,r.expanded.r]))}return r}R.rules=[a,{l:"log(e)",r:"1"},{s:"n-n1 -> n+-n1",assuming:{subtract:{total:!0}}},{s:"n-n -> 0",assuming:{subtract:{total:!1}}},{s:"-(cl*v) -> v * (-cl)",assuming:{multiply:{commutative:!0},subtract:{total:!0}}},{s:"-(cl*v) -> (-cl) * v",assuming:{multiply:{commutative:!1},subtract:{total:!0}}},{s:"-(v*cl) -> v * (-cl)",assuming:{multiply:{commutative:!1},subtract:{total:!0}}},{l:"-(n1/n2)",r:"-n1/n2"},{l:"-v",r:"v * (-1)"},{l:"(n1 + n2)*(-1)",r:"n1*(-1) + n2*(-1)",repeat:!0},{l:"n/n1^n2",r:"n*n1^-n2"},{l:"n/n1",r:"n*n1^-1"},{s:"(n1*n2)^n3 -> n1^n3 * n2^n3",assuming:{multiply:{commutative:!0}}},{s:"(n1*n2)^(-1) -> n2^(-1) * n1^(-1)",assuming:{multiply:{commutative:!1}}},{s:"(n ^ n1) ^ n2 -> n ^ (n1 * n2)",assuming:{divide:{total:!0}}},{l:" vd   * ( vd   * n1 + n2)",r:"vd^2       * n1 +  vd   * n2"},{s:" vd   * (vd^n4 * n1 + n2)   ->  vd^(1+n4)  * n1 +  vd   * n2",assuming:{divide:{total:!0}}},{s:"vd^n3 * ( vd   * n1 + n2)   ->  vd^(n3+1)  * n1 + vd^n3 * n2",assuming:{divide:{total:!0}}},{s:"vd^n3 * (vd^n4 * n1 + n2)   ->  vd^(n3+n4) * n1 + vd^n3 * n2",assuming:{divide:{total:!0}}},{l:"n*n",r:"n^2"},{s:"n * n^n1 -> n^(n1+1)",assuming:{divide:{total:!0}}},{s:"n^n1 * n^n2 -> n^(n1+n2)",assuming:{divide:{total:!0}}},o,{s:"n+n -> 2*n",assuming:{add:{total:!0}}},{l:"n+-n",r:"0"},{l:"vd*n + vd",r:"vd*(n+1)"},{l:"n3*n1 + n3*n2",r:"n3*(n1+n2)"},{l:"n3^(-n4)*n1 +   n3  * n2",r:"n3^(-n4)*(n1 + n3^(n4+1) *n2)"},{l:"n3^(-n4)*n1 + n3^n5 * n2",r:"n3^(-n4)*(n1 + n3^(n4+n5)*n2)"},{s:"n*vd + vd -> (n+1)*vd",assuming:{multiply:{commutative:!1}}},{s:"vd + n*vd -> (1+n)*vd",assuming:{multiply:{commutative:!1}}},{s:"n1*n3 + n2*n3 -> (n1+n2)*n3",assuming:{multiply:{commutative:!1}}},{s:"n^n1 * n -> n^(n1+1)",assuming:{divide:{total:!0},multiply:{commutative:!1}}},{s:"n1*n3^(-n4) + n2 * n3    -> (n1 + n2*n3^(n4 +  1))*n3^(-n4)",assuming:{multiply:{commutative:!1}}},{s:"n1*n3^(-n4) + n2 * n3^n5 -> (n1 + n2*n3^(n4 + n5))*n3^(-n4)",assuming:{multiply:{commutative:!1}}},{l:"n*cd + cd",r:"(n+1)*cd"},{s:"cd*n + cd -> cd*(n+1)",assuming:{multiply:{commutative:!1}}},{s:"cd + cd*n -> cd*(1+n)",assuming:{multiply:{commutative:!1}}},o,{s:"(-n)*n1 -> -(n*n1)",assuming:{subtract:{total:!0}}},{s:"n1*(-n) -> -(n1*n)",assuming:{subtract:{total:!0},multiply:{commutative:!1}}},{s:"ce+ve -> ve+ce",assuming:{add:{commutative:!0}},imposeContext:{add:{commutative:!1}}},{s:"vd*cd -> cd*vd",assuming:{multiply:{commutative:!0}},imposeContext:{multiply:{commutative:!1}}},{l:"n+-n1",r:"n-n1"},{l:"n+-(n1)",r:"n-(n1)"},{s:"n*(n1^-1) -> n/n1",assuming:{multiply:{commutative:!0}}},{s:"n*n1^-n2 -> n/n1^n2",assuming:{multiply:{commutative:!0}}},{s:"n^-1 -> 1/n",assuming:{multiply:{commutative:!0}}},{l:"n^1",r:"n"},{s:"n*(n1/n2) -> (n*n1)/n2",assuming:{multiply:{associative:!0}}},{s:"n-(n1+n2) -> n-n1-n2",assuming:{addition:{associative:!0,commutative:!0}}},{l:"1*n",r:"n",imposeContext:{multiply:{commutative:!0}}},{s:"n1/(n2/n3) -> (n1*n3)/n2",assuming:{multiply:{associative:!0}}},{l:"n1/(-n2)",r:"-n1/n2"}];var _=0;function O(){return new p("_p"+_++)}function I(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Nd(),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=r.consoleDebug;t=function(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r],o=void 0,a=typeof i;switch(a){case"string":i={s:i};case"object":o=D(i,t);break;case"function":o=i;break;default:throw TypeError("Unsupported type of rule: "+a)}n.push(o)}return n}(t||R.rules,r.context);for(var a=i(e,n),s={},l=(a=k(a)).toString({parenthesis:"all"});!s[l];){s[l]=!0,_=0;var c=l;o&&console.log("Working on: ",l);for(var u=0;u<t.length;u++){var d="";if("function"===typeof t[u]?(a=t[u](a,r),o&&(d=t[u].name)):(x(a,r.context),a=j(a,t[u],r.context),o&&(d="".concat(t[u].l.toString()," -> ").concat(t[u].r.toString()))),o){var h=a.toString({parenthesis:"all"});h!==c&&(console.log("Applying",d,"produced",h),c=h)}C(a,r.context)}l=a.toString({parenthesis:"all"})}return a}function P(e,t,n){var r=e;if(e)for(var i=0;i<e.length;++i){var o=j(e[i],t,n);o!==e[i]&&(r===e&&(r=e.slice()),r[i]=o)}return r}function j(e,t,n){if(t.assuming)for(var r in t.assuming)for(var i in t.assuming[r])if(v(r,i,n)!==t.assuming[r][i])return e;var o=w(t.imposeContext,n),a=e;if(a instanceof f||a instanceof u){var c=P(a.args,t,n);c!==a.args&&((a=a.clone()).args=c)}else if(a instanceof m){if(a.content){var p=j(a.content,t,n);p!==a.content&&(a=new m(p))}}else if(a instanceof l){var g=P(a.items,t,n);g!==a.items&&(a=new l(g))}else if(a instanceof s){var y=a.object;a.object&&(y=j(a.object,t,n));var b=a.index;a.index&&(b=j(a.index,t,n)),y===a.object&&b===a.index||(a=new s(y,b))}else if(a instanceof d){var x=P(a.dimensions,t,n);x!==a.dimensions&&(a=new d(x))}else if(a instanceof h){var S=!1,C={};for(var E in a.properties)C[E]=j(a.properties[E],t,n),C[E]!==a.properties[E]&&(S=!0);S&&(a=new h(C))}var N=t.r,T=L(t.l,a,o)[0];if(!T&&t.expanded&&(N=t.expanded.r,T=L(t.expanded.l,a,o)[0]),!T&&t.expandedNC1&&(N=t.expandedNC1.r,(T=L(t.expandedNC1.l,a,o)[0])||(N=t.expandedNC2.r,T=L(t.expandedNC2.l,a,o)[0])),T){var A=a.implicit;a=N.clone(),A&&"implicit"in N&&(a.implicit=!0),a=a.transform(function(e){return e.isSymbolNode&&pd(T.placeholders,e.name)?T.placeholders[e.name].clone():e})}return t.repeat&&a!==e&&(a=j(a,t,n)),a}function F(e,t){var n={placeholders:{}};if(!e.placeholders&&!t.placeholders)return n;if(!e.placeholders)return t;if(!t.placeholders)return e;for(var r in e.placeholders)if(pd(e.placeholders,r)&&(n.placeholders[r]=e.placeholders[r],pd(t.placeholders,r)&&!B(e.placeholders[r],t.placeholders[r])))return null;for(var i in t.placeholders)pd(t.placeholders,i)&&(n.placeholders[i]=t.placeholders[i]);return n}function H(e,t){var n,r=[];if(0===e.length||0===t.length)return r;for(var i=0;i<e.length;i++)for(var o=0;o<t.length;o++)(n=F(e[i],t[o]))&&r.push(n);return r}function L(e,t,n,i){var o=[{placeholders:{}}];if(e instanceof f&&t instanceof f||e instanceof u&&t instanceof u){if(e instanceof f){if(e.op!==t.op||e.fn!==t.fn)return[]}else if(e instanceof u&&e.name!==t.name)return[];if(!(1===t.args.length&&1===e.args.length||!b(t,n)&&t.args.length===e.args.length||i)){if(t.args.length>=2&&2===e.args.length){for(var a=function(e,t){var n,r,i=[],o=E(e);if(y(e,t))for(var a=0;a<e.args.length;a++)(r=e.args.slice(0)).splice(a,1),n=1===r.length?r[0]:o(r),i.push(o([e.args[a],n]));else for(var s=1;s<e.args.length;s++){var l=e.args[0];s>1&&(l=o(e.args.slice(0,s))),n=1===(r=e.args.slice(s)).length?r[0]:o(r),i.push(o([l,n]))}return i}(t,n),s=[],l=0;l<a.length;l++){var d=L(e,a[l],n,!0);s=s.concat(d)}return s}if(e.args.length>2)throw Error("Unexpected non-binary associative function: "+e.toString());return[]}for(var h=[],m=0;m<e.args.length;m++){var v=L(e.args[m],t.args[m],n);if(0===v.length)break;h.push(v)}if(h.length!==e.args.length){if(!y(t,n)||1===e.args.length)return[];if(e.args.length>2)throw new Error("permuting >2 commutative non-associative rule arguments not yet implemented");var w=L(e.args[0],t.args[1],n);if(0===w.length)return[];var x=L(e.args[1],t.args[0],n);if(0===x.length)return[];h=[w,x]}o=function(e){if(0===e.length)return e;for(var t=e.reduce(H),n=[],r={},i=0;i<t.length;i++){var o=JSON.stringify(t[i],g);r[o]||(r[o]=!0,n.push(t[i]))}return n}(h)}else if(e instanceof p){if(0===e.name.length)throw new Error("Symbol in rule has 0 length...!?");if(M[e.name]){if(e.name!==t.name)return[]}else switch(e.name[1]>="a"&&e.name[1]<="z"?e.name.substring(0,2):e.name[0]){case"n":case"_p":o[0].placeholders[e.name]=t;break;case"c":case"cl":if(!nh(t))return[];o[0].placeholders[e.name]=t;break;case"v":if(nh(t))return[];o[0].placeholders[e.name]=t;break;case"vl":if(!fh(t))return[];o[0].placeholders[e.name]=t;break;case"cd":if(!rp(t))return[];o[0].placeholders[e.name]=t;break;case"vd":if(rp(t))return[];o[0].placeholders[e.name]=t;break;case"ce":if(!ip(t))return[];o[0].placeholders[e.name]=t;break;case"ve":if(ip(t))return[];o[0].placeholders[e.name]=t;break;default:throw new Error("Invalid symbol in rule: "+e.name)}}else{if(!(e instanceof c))return[];if(!r(e.value,t.value))return[]}return o}function B(e,t){if(e instanceof c&&t instanceof c){if(!r(e.value,t.value))return!1}else if(e instanceof p&&t instanceof p){if(e.name!==t.name)return!1}else{if(!(e instanceof f&&t instanceof f||e instanceof u&&t instanceof u))return!1;if(e instanceof f){if(e.op!==t.op||e.fn!==t.fn)return!1}else if(e instanceof u&&e.name!==t.name)return!1;if(e.args.length!==t.args.length)return!1;for(var n=0;n<e.args.length;n++)if(!B(e.args[n],t.args[n]))return!1}return!0}return R}),sp="symbolicEqual",lp=["parse","simplify","typed","OperatorNode"],cp=vh(sp,lp,e=>{var{parse:t,simplify:n,typed:r,OperatorNode:i}=e;function o(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=new i("-","subtract",[e,t]),a=n(o,{},r);return nh(a)&&!a.value}return r(sp,{"Node, Node":o,"Node, Node, Object":o})}),up="leafCount",dp=["parse","typed"],hp=vh(up,dp,e=>{var{parse:t,typed:n}=e;function r(e){var t=0;return e.forEach(e=>{t+=r(e)}),t||1}return n(up,{Node:function(e){return r(e)}})}),fp="parser",mp=["typed","Parser"],pp=vh(fp,mp,e=>{var{typed:t,Parser:n}=e;return t(fp,{"":function(){return new n}})}),gp="rationalize",vp=["config","typed","equal","isZero","add","subtract","multiply","divide","pow","parse","simplifyConstant","simplifyCore","simplify","?bignumber","?fraction","mathWithTransform","matrix","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","SymbolNode","ParenthesisNode"],yp=vh(gp,vp,e=>{var{config:t,typed:n,equal:r,isZero:i,add:o,subtract:a,multiply:s,divide:l,pow:c,parse:u,simplifyConstant:d,simplifyCore:h,simplify:f,fraction:m,bignumber:p,mathWithTransform:g,matrix:v,AccessorNode:y,ArrayNode:b,ConstantNode:w,FunctionNode:x,IndexNode:S,ObjectNode:C,OperatorNode:E,SymbolNode:N,ParenthesisNode:T}=e;function A(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(){var e=[h,{l:"n+n",r:"2*n"},{l:"n+-n",r:"0"},d,{l:"n*(n1^-1)",r:"n/n1"},{l:"n*n1^-n2",r:"n/n1^n2"},{l:"n1^-1",r:"1/n1"},{l:"n*(n1/n2)",r:"(n*n1)/n2"},{l:"1*n",r:"n"}],t=[{l:"(-n1)/(-n2)",r:"n1/n2"},{l:"(-n1)*(-n2)",r:"n1*n2"},{l:"n1--n2",r:"n1+n2"},{l:"n1-n2",r:"n1+(-n2)"},{l:"(n1+n2)*n3",r:"(n1*n3 + n2*n3)"},{l:"n1*(n2+n3)",r:"(n1*n2+n1*n3)"},{l:"c1*n + c2*n",r:"(c1+c2)*n"},{l:"c1*n + n",r:"(c1+1)*n"},{l:"c1*n - c2*n",r:"(c1-c2)*n"},{l:"c1*n - n",r:"(c1-1)*n"},{l:"v/c",r:"(1/c)*v"},{l:"v/-c",r:"-(1/c)*v"},{l:"-v*-c",r:"c*v"},{l:"-v*c",r:"-c*v"},{l:"v*-c",r:"-c*v"},{l:"v*c",r:"c*v"},{l:"-(-n1*n2)",r:"(n1*n2)"},{l:"-(n1*n2)",r:"(-n1*n2)"},{l:"-(-n1+n2)",r:"(n1-n2)"},{l:"-(n1+n2)",r:"(-n1-n2)"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"},{l:"-(-n1/n2)",r:"(n1/n2)"},{l:"-(n1/n2)",r:"(-n1/n2)"}],n=[{l:"(n1/n2 + n3/n4)",r:"((n1*n4 + n3*n2)/(n2*n4))"},{l:"(n1/n2 + n3)",r:"((n1 + n3*n2)/n2)"},{l:"(n1 + n2/n3)",r:"((n1*n3 + n2)/n3)"}],r=[{l:"(n1/(n2/n3))",r:"((n1*n3)/n2)"},{l:"(n1/n2/n3)",r:"(n1/(n2*n3))"}],i={};return i.firstRules=e.concat(t,r),i.distrDivRules=n,i.sucDivRules=r,i.firstRulesAgain=e.concat(t),i.finalRules=[h,{l:"n*-n",r:"-n^2"},{l:"n*n",r:"n^2"},d,{l:"n*-n^n1",r:"-n^(n1+1)"},{l:"n*n^n1",r:"n^(n1+1)"},{l:"n^n1*-n^n2",r:"-n^(n1+n2)"},{l:"n^n1*n^n2",r:"n^(n1+n2)"},{l:"n^n1*-n",r:"-n^(n1+1)"},{l:"n^n1*n",r:"n^(n1+1)"},{l:"n^n1/-n",r:"-n^(n1-1)"},{l:"n^n1/n",r:"n^(n1-1)"},{l:"n/-n^n1",r:"-n^(1-n1)"},{l:"n/n^n1",r:"n^(1-n1)"},{l:"n^n1/-n^n2",r:"n^(n1-n2)"},{l:"n^n1/n^n2",r:"n^(n1-n2)"},{l:"n1+(-n2*n3)",r:"n1-n2*n3"},{l:"v*(-c)",r:"-c*v"},{l:"n1+-n2",r:"n1-n2"},{l:"v*c",r:"c*v"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"}],i}(),i=function(e,t,n,r){var i=[],o=f(e,r,t,{exactFractions:!1}),a="+-*"+((n=!!n)?"/":"");l(o);var s={};return s.expression=o,s.variables=i,s;function l(e){var t=e.type;if("FunctionNode"===t)throw new Error("There is an unsolved function call");if("OperatorNode"===t)if("^"===e.op){if("ConstantNode"!==e.args[1].type||!wh(parseFloat(e.args[1].value)))throw new Error("There is a non-integer exponent");l(e.args[0])}else{if(!a.includes(e.op))throw new Error("Operator "+e.op+" invalid in polynomial expression");for(var n=0;n<e.args.length;n++)l(e.args[n])}else if("SymbolNode"===t){var r=e.name;-1===i.indexOf(r)&&i.push(r)}else if("ParenthesisNode"===t)l(e.content);else if("ConstantNode"!==t)throw new Error("type "+t+" is not allowed in polynomial expression")}}(e,t,!0,r.firstRules),o=i.variables.length,a={exactFractions:!1},s={exactFractions:!0};if(e=i.expression,o>=1){var l,c;e=R(e);var u,m=!0,p=!1;for(e=f(e,r.firstRules,{},a);c=m?r.distrDivRules:r.sucDivRules,m=!m,(u=(e=f(e,c,{},s)).toString())!==l;)p=!0,l=u;p&&(e=f(e,r.firstRulesAgain,{},a)),e=f(e,r.finalRules,{},a)}var g=[],v={};return"OperatorNode"===e.type&&e.isBinary()&&"/"===e.op?(1===o&&(e.args[0]=k(e.args[0],g),e.args[1]=k(e.args[1])),n&&(v.numerator=e.args[0],v.denominator=e.args[1])):(1===o&&(e=k(e,g)),n&&(v.numerator=e,v.denominator=null)),n?(v.coefficients=g,v.variables=i.variables,v.expression=e,v):e}return n(gp,{Node:A,"Node, boolean":(e,t)=>A(e,{},t),"Node, Object":A,"Node, Object, boolean":A});function R(e,t,n){var r=e.type,i=arguments.length>1;if("OperatorNode"===r&&e.isBinary()){var o,a=!1;if("^"===e.op&&("ParenthesisNode"!==e.args[0].type&&"OperatorNode"!==e.args[0].type||"ConstantNode"!==e.args[1].type||(a=(o=parseFloat(e.args[1].value))>=2&&wh(o))),a){if(o>2){var s=e.args[0],l=new E("^","pow",[e.args[0].cloneDeep(),new w(o-1)]);e=new E("*","multiply",[s,l])}else e=new E("*","multiply",[e.args[0],e.args[0].cloneDeep()]);i&&("content"===n?t.content=e:t.args[n]=e)}}if("ParenthesisNode"===r)R(e.content,e,"content");else if("ConstantNode"!==r&&"SymbolNode"!==r)for(var c=0;c<e.args.length;c++)R(e.args[c],e,c);if(!i)return e}function k(e,t){void 0===t&&(t=[]),t[0]=0;var n={cte:1,oper:"+",fire:""},r=0,i="";!function e(n,o,a){var s=n.type;if("FunctionNode"===s)throw new Error("There is an unsolved function call");if("OperatorNode"===s){if(!"+-*^".includes(n.op))throw new Error("Operator "+n.op+" invalid");if(null!==o){if(("unaryMinus"===n.fn||"pow"===n.fn)&&"add"!==o.fn&&"subtract"!==o.fn&&"multiply"!==o.fn)throw new Error("Invalid "+n.op+" placing");if(("subtract"===n.fn||"add"===n.fn||"multiply"===n.fn)&&"add"!==o.fn&&"subtract"!==o.fn)throw new Error("Invalid "+n.op+" placing");if(("subtract"===n.fn||"add"===n.fn||"unaryMinus"===n.fn)&&0!==a.noFil)throw new Error("Invalid "+n.op+" placing")}"^"!==n.op&&"*"!==n.op||(a.fire=n.op);for(var l=0;l<n.args.length;l++)"unaryMinus"===n.fn&&(a.oper="-"),"+"!==n.op&&"subtract"!==n.fn||(a.fire="",a.cte=1,a.oper=0===l?"+":n.op),a.noFil=l,e(n.args[l],n,a)}else if("SymbolNode"===s){if(n.name!==i&&""!==i)throw new Error("There is more than one variable");if(i=n.name,null===o)return void(t[1]=1);if("^"===o.op&&0!==a.noFil)throw new Error("In power the variable should be the first parameter");if("*"===o.op&&1!==a.noFil)throw new Error("In multiply the variable should be the second parameter");""!==a.fire&&"*"!==a.fire||(r<1&&(t[1]=0),t[1]+=a.cte*("+"===a.oper?1:-1),r=Math.max(1,r))}else{if("ConstantNode"!==s)throw new Error("Type "+s+" is not allowed");var c=parseFloat(n.value);if(null===o)return void(t[0]=c);if("^"===o.op){if(1!==a.noFil)throw new Error("Constant cannot be powered");if(!wh(c)||c<=0)throw new Error("Non-integer exponent is not allowed");for(var u=r+1;u<c;u++)t[u]=0;return c>r&&(t[c]=0),t[c]+=a.cte*("+"===a.oper?1:-1),void(r=Math.max(c,r))}a.cte=c,""===a.fire&&(t[0]+=a.cte*("+"===a.oper?1:-1))}}(e,null,n);for(var o,a=!0,s=r=t.length-1;s>=0;s--)if(0!==t[s]){var l=new w(a?t[s]:Math.abs(t[s])),c=t[s]<0?"-":"+";if(s>0){var u=new N(i);if(s>1){var d=new w(s);u=new E("^","pow",[u,d])}l=-1===t[s]&&a?new E("-","unaryMinus",[u]):1===Math.abs(t[s])?u:new E("*","multiply",[l,u])}o=a?l:"+"===c?new E("+","add",[o,l]):new E("-","subtract",[o,l]),a=!1}return a?new w(0):o}}),bp="derivative",wp=["typed","config","parse","simplify","equal","isZero","numeric","ConstantNode","FunctionNode","OperatorNode","ParenthesisNode","SymbolNode"],xp=vh(bp,wp,e=>{var{typed:t,config:n,parse:r,simplify:i,equal:o,isZero:a,numeric:s,ConstantNode:l,FunctionNode:c,OperatorNode:u,ParenthesisNode:d,SymbolNode:h}=e;function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{simplify:!0},r=new Map,o=t.name;var a=y(e,function e(t){var n=r.get(t);if(void 0!==n)return n;var i=v(e,t,o);return r.set(t,i),i});return n.simplify?i(a):a}function m(e){var t=r(e);if(!t.isSymbolNode)throw new TypeError("Invalid variable. "+"Cannot parse ".concat(JSON.stringify(e)," into a variable in function derivative"));return t}var p=t(bp,{"Node, SymbolNode":f,"Node, SymbolNode, Object":f,"Node, string":(e,t)=>f(e,m(t)),"Node, string, Object":(e,t,n)=>f(e,m(t),n)});p._simplify=!0,p.toTex=function(e){return g.apply(null,e.args)};var g=t("_derivTex",{"Node, SymbolNode":function(e,t){return nh(e)&&"string"===ph(e.value)?g(r(e.value).toString(),t.toString(),1):g(e.toTex(),t.toString(),1)},"Node, ConstantNode":function(e,t){if("string"===ph(t.value))return g(e,r(t.value));throw new Error("The second parameter to 'derivative' is a non-string constant")},"Node, SymbolNode, ConstantNode":function(e,t,n){return g(e.toString(),t.name,n.value)},"string, string, number":function(e,t,n){return(1===n?"{d\\over d"+t+"}":"{d^{"+n+"}\\over d"+t+"^{"+n+"}}")+"\\left[".concat(e,"\\right]")}}),v=t("_isConst",{"function, ConstantNode, string":function(){return!0},"function, SymbolNode, string":function(e,t,n){return t.name!==n},"function, ParenthesisNode, string":function(e,t,n){return e(t.content,n)},"function, FunctionAssignmentNode, string":function(e,t,n){return!t.params.includes(n)||e(t.expr,n)},"function, FunctionNode | OperatorNode, string":function(e,t,n){return t.args.every(t=>e(t,n))}}),y=t("_derivative",{"ConstantNode, function":function(){return b(0)},"SymbolNode, function":function(e,t){return t(e)?b(0):b(1)},"ParenthesisNode, function":function(e,t){return new d(y(e.content,t))},"FunctionAssignmentNode, function":function(e,t){return t(e)?b(0):y(e.expr,t)},"FunctionNode, function":function(e,t){if(t(e))return b(0);var n,r,i,o,a=e.args[0],s=!1,l=!1;switch(e.name){case"cbrt":s=!0,r=new u("*","multiply",[b(3),new u("^","pow",[a,new u("/","divide",[b(2),b(3)])])]);break;case"sqrt":case"nthRoot":if(1===e.args.length)s=!0,r=new u("*","multiply",[b(2),new c("sqrt",[a])]);else if(2===e.args.length)return n=new u("/","divide",[b(1),e.args[1]]),y(new u("^","pow",[a,n]),t);break;case"log10":n=b(10);case"log":if(n||1!==e.args.length){if(1===e.args.length&&n||2===e.args.length&&t(e.args[1]))r=new u("*","multiply",[a.clone(),new c("log",[n||e.args[1]])]),s=!0;else if(2===e.args.length)return y(new u("/","divide",[new c("log",[a]),new c("log",[e.args[1]])]),t)}else r=a.clone(),s=!0;break;case"pow":if(2===e.args.length)return y(new u("^","pow",[a,e.args[1]]),t);break;case"exp":r=new c("exp",[a.clone()]);break;case"sin":r=new c("cos",[a.clone()]);break;case"cos":r=new u("-","unaryMinus",[new c("sin",[a.clone()])]);break;case"tan":r=new u("^","pow",[new c("sec",[a.clone()]),b(2)]);break;case"sec":r=new u("*","multiply",[e,new c("tan",[a.clone()])]);break;case"csc":l=!0,r=new u("*","multiply",[e,new c("cot",[a.clone()])]);break;case"cot":l=!0,r=new u("^","pow",[new c("csc",[a.clone()]),b(2)]);break;case"asin":s=!0,r=new c("sqrt",[new u("-","subtract",[b(1),new u("^","pow",[a.clone(),b(2)])])]);break;case"acos":s=!0,l=!0,r=new c("sqrt",[new u("-","subtract",[b(1),new u("^","pow",[a.clone(),b(2)])])]);break;case"atan":s=!0,r=new u("+","add",[new u("^","pow",[a.clone(),b(2)]),b(1)]);break;case"asec":s=!0,r=new u("*","multiply",[new c("abs",[a.clone()]),new c("sqrt",[new u("-","subtract",[new u("^","pow",[a.clone(),b(2)]),b(1)])])]);break;case"acsc":s=!0,l=!0,r=new u("*","multiply",[new c("abs",[a.clone()]),new c("sqrt",[new u("-","subtract",[new u("^","pow",[a.clone(),b(2)]),b(1)])])]);break;case"acot":s=!0,l=!0,r=new u("+","add",[new u("^","pow",[a.clone(),b(2)]),b(1)]);break;case"sinh":r=new c("cosh",[a.clone()]);break;case"cosh":r=new c("sinh",[a.clone()]);break;case"tanh":r=new u("^","pow",[new c("sech",[a.clone()]),b(2)]);break;case"sech":l=!0,r=new u("*","multiply",[e,new c("tanh",[a.clone()])]);break;case"csch":l=!0,r=new u("*","multiply",[e,new c("coth",[a.clone()])]);break;case"coth":l=!0,r=new u("^","pow",[new c("csch",[a.clone()]),b(2)]);break;case"asinh":s=!0,r=new c("sqrt",[new u("+","add",[new u("^","pow",[a.clone(),b(2)]),b(1)])]);break;case"acosh":s=!0,r=new c("sqrt",[new u("-","subtract",[new u("^","pow",[a.clone(),b(2)]),b(1)])]);break;case"atanh":s=!0,r=new u("-","subtract",[b(1),new u("^","pow",[a.clone(),b(2)])]);break;case"asech":s=!0,l=!0,r=new u("*","multiply",[a.clone(),new c("sqrt",[new u("-","subtract",[b(1),new u("^","pow",[a.clone(),b(2)])])])]);break;case"acsch":s=!0,l=!0,r=new u("*","multiply",[new c("abs",[a.clone()]),new c("sqrt",[new u("+","add",[new u("^","pow",[a.clone(),b(2)]),b(1)])])]);break;case"acoth":s=!0,l=!0,r=new u("-","subtract",[b(1),new u("^","pow",[a.clone(),b(2)])]);break;case"abs":r=new u("/","divide",[new c(new h("abs"),[a.clone()]),a.clone()]);break;default:throw new Error('Cannot process function "'+e.name+'" in derivative: the function is not supported, undefined, or the number of arguments passed to it are not supported')}s?(i="/",o="divide"):(i="*",o="multiply");var d=y(a,t);return l&&(d=new u("-","unaryMinus",[d])),new u(i,o,[d,r])},"OperatorNode, function":function(e,t){if(t(e))return b(0);if("+"===e.op)return new u(e.op,e.fn,e.args.map(function(e){return y(e,t)}));if("-"===e.op){if(e.isUnary())return new u(e.op,e.fn,[y(e.args[0],t)]);if(e.isBinary())return new u(e.op,e.fn,[y(e.args[0],t),y(e.args[1],t)])}if("*"===e.op){var n=e.args.filter(function(e){return t(e)});if(n.length>0){var r=e.args.filter(function(e){return!t(e)}),i=1===r.length?r[0]:new u("*","multiply",r),s=n.concat(y(i,t));return new u("*","multiply",s)}return new u("+","add",e.args.map(function(n){return new u("*","multiply",e.args.map(function(e){return e===n?y(e,t):e.clone()}))}))}if("/"===e.op&&e.isBinary()){var l=e.args[0],d=e.args[1];return t(d)?new u("/","divide",[y(l,t),d]):t(l)?new u("*","multiply",[new u("-","unaryMinus",[l]),new u("/","divide",[y(d,t),new u("^","pow",[d.clone(),b(2)])])]):new u("/","divide",[new u("-","subtract",[new u("*","multiply",[y(l,t),d.clone()]),new u("*","multiply",[l.clone(),y(d,t)])]),new u("^","pow",[d.clone(),b(2)])])}if("^"===e.op&&e.isBinary()){var h=e.args[0],f=e.args[1];if(t(h))return nh(h)&&(a(h.value)||o(h.value,1))?b(0):new u("*","multiply",[e,new u("*","multiply",[new c("log",[h.clone()]),y(f.clone(),t)])]);if(t(f)){if(nh(f)){if(a(f.value))return b(0);if(o(f.value,1))return y(h,t)}var m=new u("^","pow",[h.clone(),new u("-","subtract",[f,b(1)])]);return new u("*","multiply",[f.clone(),new u("*","multiply",[y(h,t),m])])}return new u("*","multiply",[new u("^","pow",[h.clone(),f.clone()]),new u("+","add",[new u("*","multiply",[y(h,t),new u("/","divide",[f.clone(),h.clone()])]),new u("*","multiply",[y(f,t),new c("log",[h.clone()])])])])}throw new Error('Cannot process operator "'+e.op+'" in derivative: the operator is not supported, undefined, or the number of arguments passed to it are not supported')}});function b(e,t){return new l(s(e,t||xh(String(e),n)))}return p}),Sp={name:"e",category:"Constants",syntax:["e"],description:"Euler's number, the base of the natural logarithm. Approximately equal to 2.71828",examples:["e","e ^ 2","exp(2)","log(e)"],seealso:["exp"]},Cp={name:"pi",category:"Constants",syntax:["pi"],description:"The number pi is a mathematical constant that is the ratio of a circle's circumference to its diameter, and is approximately equal to 3.14159",examples:["pi","sin(pi/2)"],seealso:["tau"]},Ep={bignumber:{name:"bignumber",category:"Construction",syntax:["bignumber(x)"],description:"Create a big number from a number or string.",examples:["0.1 + 0.2","bignumber(0.1) + bignumber(0.2)",'bignumber("7.2")','bignumber("7.2e500")',"bignumber([0.1, 0.2, 0.3])"],seealso:["boolean","bigint","complex","fraction","index","matrix","string","unit"]},bigint:{name:"bigint",category:"Construction",syntax:["bigint(x)"],description:"Create a bigint, an integer with an arbitrary number of digits, from a number or string.",examples:["123123123123123123 # a large number will lose digits",'bigint("123123123123123123")','bignumber(["1", "3", "5"])'],seealso:["boolean","bignumber","number","complex","fraction","index","matrix","string","unit"]},boolean:{name:"boolean",category:"Construction",syntax:["x","boolean(x)"],description:"Convert a string or number into a boolean.",examples:["boolean(0)","boolean(1)","boolean(3)",'boolean("true")','boolean("false")',"boolean([1, 0, 1, 1])"],seealso:["bignumber","complex","index","matrix","number","string","unit"]},complex:{name:"complex",category:"Construction",syntax:["complex()","complex(re, im)","complex(string)"],description:"Create a complex number.",examples:["complex()","complex(2, 3)",'complex("7 - 2i")'],seealso:["bignumber","boolean","index","matrix","number","string","unit"]},createUnit:{name:"createUnit",category:"Construction",syntax:["createUnit(definitions)","createUnit(name, definition)"],description:"Create a user-defined unit and register it with the Unit type.",examples:['createUnit("foo")','createUnit("knot", {definition: "0.514444444 m/s", aliases: ["knots", "kt", "kts"]})','createUnit("mph", "1 mile/hour")'],seealso:["unit","splitUnit"]},fraction:{name:"fraction",category:"Construction",syntax:["fraction(num)","fraction(matrix)","fraction(num,den)","fraction({n: num, d: den})"],description:"Create a fraction from a number or from integer numerator and denominator.",examples:["fraction(0.125)","fraction(1, 3) + fraction(2, 5)","fraction({n: 333, d: 53})","fraction([sqrt(9), sqrt(10), sqrt(11)])"],seealso:["bignumber","boolean","complex","index","matrix","string","unit"]},index:{name:"index",category:"Construction",syntax:["[start]","[start:end]","[start:step:end]","[start1, start 2, ...]","[start1:end1, start2:end2, ...]","[start1:step1:end1, start2:step2:end2, ...]"],description:"Create an index to get or replace a subset of a matrix",examples:["A = [1, 2, 3; 4, 5, 6]","A[1, :]","A[1, 2] = 50","A[1:2, 1:2] = 1","B = [1, 2, 3]","B[B>1 and B<3]"],seealso:["bignumber","boolean","complex","matrix","number","range","string","unit"]},matrix:{name:"matrix",category:"Construction",syntax:["[]","[a1, b1, ...; a2, b2, ...]","matrix()",'matrix("dense")',"matrix([...])"],description:"Create a matrix.",examples:["[]","[1, 2, 3]","[1, 2, 3; 4, 5, 6]","matrix()","matrix([3, 4])",'matrix([3, 4; 5, 6], "sparse")','matrix([3, 4; 5, 6], "sparse", "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","sparse"]},number:{name:"number",category:"Construction",syntax:["x","number(x)","number(unit, valuelessUnit)"],description:"Create a number or convert a string or boolean into a number.",examples:["2","2e3","4.05","number(2)",'number("7.2")',"number(true)","number([true, false, true, true])",'number(unit("52cm"), "m")'],seealso:["bignumber","bigint","boolean","complex","fraction","index","matrix","string","unit"]},sparse:{name:"sparse",category:"Construction",syntax:["sparse()","sparse([a1, b1, ...; a1, b2, ...])",'sparse([a1, b1, ...; a1, b2, ...], "number")'],description:"Create a sparse matrix.",examples:["sparse()","sparse([3, 4; 5, 6])",'sparse([3, 0; 5, 0], "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","matrix"]},splitUnit:{name:"splitUnit",category:"Construction",syntax:["splitUnit(unit: Unit, parts: Unit[])"],description:"Split a unit in an array of units whose sum is equal to the original unit.",examples:['splitUnit(1 m, ["feet", "inch"])'],seealso:["unit","createUnit"]},string:{name:"string",category:"Construction",syntax:['"text"',"string(x)"],description:"Create a string or convert a value to a string",examples:['"Hello World!"',"string(4.2)","string(3 + 2i)"],seealso:["bignumber","boolean","complex","index","matrix","number","unit"]},unit:{name:"unit",category:"Construction",syntax:["value unit","unit(value, unit)","unit(string)"],description:"Create a unit.",examples:["5.5 mm","3 inch",'unit(7.1, "kilogram")','unit("23 deg")'],seealso:["bignumber","boolean","complex","index","matrix","number","string"]},e:Sp,E:Sp,false:{name:"false",category:"Constants",syntax:["false"],description:"Boolean value false",examples:["false"],seealso:["true"]},i:{name:"i",category:"Constants",syntax:["i"],description:"Imaginary unit, defined as i*i=-1. A complex number is described as a + b*i, where a is the real part, and b is the imaginary part.",examples:["i","i * i","sqrt(-1)"],seealso:[]},Infinity:{name:"Infinity",category:"Constants",syntax:["Infinity"],description:"Infinity, a number which is larger than the maximum number that can be handled by a floating point number.",examples:["Infinity","1 / 0"],seealso:[]},LN2:{name:"LN2",category:"Constants",syntax:["LN2"],description:"Returns the natural logarithm of 2, approximately equal to 0.693",examples:["LN2","log(2)"],seealso:[]},LN10:{name:"LN10",category:"Constants",syntax:["LN10"],description:"Returns the natural logarithm of 10, approximately equal to 2.302",examples:["LN10","log(10)"],seealso:[]},LOG2E:{name:"LOG2E",category:"Constants",syntax:["LOG2E"],description:"Returns the base-2 logarithm of E, approximately equal to 1.442",examples:["LOG2E","log(e, 2)"],seealso:[]},LOG10E:{name:"LOG10E",category:"Constants",syntax:["LOG10E"],description:"Returns the base-10 logarithm of E, approximately equal to 0.434",examples:["LOG10E","log(e, 10)"],seealso:[]},NaN:{name:"NaN",category:"Constants",syntax:["NaN"],description:"Not a number",examples:["NaN","0 / 0"],seealso:[]},null:{name:"null",category:"Constants",syntax:["null"],description:"Value null",examples:["null"],seealso:["true","false"]},pi:Cp,PI:Cp,phi:{name:"phi",category:"Constants",syntax:["phi"],description:"Phi is the golden ratio. Two quantities are in the golden ratio if their ratio is the same as the ratio of their sum to the larger of the two quantities. Phi is defined as `(1 + sqrt(5)) / 2` and is approximately 1.618034...",examples:["phi"],seealso:[]},SQRT1_2:{name:"SQRT1_2",category:"Constants",syntax:["SQRT1_2"],description:"Returns the square root of 1/2, approximately equal to 0.707",examples:["SQRT1_2","sqrt(1/2)"],seealso:[]},SQRT2:{name:"SQRT2",category:"Constants",syntax:["SQRT2"],description:"Returns the square root of 2, approximately equal to 1.414",examples:["SQRT2","sqrt(2)"],seealso:[]},tau:{name:"tau",category:"Constants",syntax:["tau"],description:"Tau is the ratio constant of a circle's circumference to radius, equal to 2 * pi, approximately 6.2832.",examples:["tau","2 * pi"],seealso:["pi"]},true:{name:"true",category:"Constants",syntax:["true"],description:"Boolean value true",examples:["true"],seealso:["false"]},version:{name:"version",category:"Constants",syntax:["version"],description:"A string with the version number of math.js",examples:["version"],seealso:[]},speedOfLight:{description:"Speed of light in vacuum",examples:["speedOfLight"]},gravitationConstant:{description:"Newtonian constant of gravitation",examples:["gravitationConstant"]},planckConstant:{description:"Planck constant",examples:["planckConstant"]},reducedPlanckConstant:{description:"Reduced Planck constant",examples:["reducedPlanckConstant"]},magneticConstant:{description:"Magnetic constant (vacuum permeability)",examples:["magneticConstant"]},electricConstant:{description:"Electric constant (vacuum permeability)",examples:["electricConstant"]},vacuumImpedance:{description:"Characteristic impedance of vacuum",examples:["vacuumImpedance"]},coulomb:{description:"Coulomb's constant. Deprecated in favor of coulombConstant",examples:["coulombConstant"]},coulombConstant:{description:"Coulomb's constant",examples:["coulombConstant"]},elementaryCharge:{description:"Elementary charge",examples:["elementaryCharge"]},bohrMagneton:{description:"Bohr magneton",examples:["bohrMagneton"]},conductanceQuantum:{description:"Conductance quantum",examples:["conductanceQuantum"]},inverseConductanceQuantum:{description:"Inverse conductance quantum",examples:["inverseConductanceQuantum"]},magneticFluxQuantum:{description:"Magnetic flux quantum",examples:["magneticFluxQuantum"]},nuclearMagneton:{description:"Nuclear magneton",examples:["nuclearMagneton"]},klitzing:{description:"Von Klitzing constant",examples:["klitzing"]},bohrRadius:{description:"Bohr radius",examples:["bohrRadius"]},classicalElectronRadius:{description:"Classical electron radius",examples:["classicalElectronRadius"]},electronMass:{description:"Electron mass",examples:["electronMass"]},fermiCoupling:{description:"Fermi coupling constant",examples:["fermiCoupling"]},fineStructure:{description:"Fine-structure constant",examples:["fineStructure"]},hartreeEnergy:{description:"Hartree energy",examples:["hartreeEnergy"]},protonMass:{description:"Proton mass",examples:["protonMass"]},deuteronMass:{description:"Deuteron Mass",examples:["deuteronMass"]},neutronMass:{description:"Neutron mass",examples:["neutronMass"]},quantumOfCirculation:{description:"Quantum of circulation",examples:["quantumOfCirculation"]},rydberg:{description:"Rydberg constant",examples:["rydberg"]},thomsonCrossSection:{description:"Thomson cross section",examples:["thomsonCrossSection"]},weakMixingAngle:{description:"Weak mixing angle",examples:["weakMixingAngle"]},efimovFactor:{description:"Efimov factor",examples:["efimovFactor"]},atomicMass:{description:"Atomic mass constant",examples:["atomicMass"]},avogadro:{description:"Avogadro's number",examples:["avogadro"]},boltzmann:{description:"Boltzmann constant",examples:["boltzmann"]},faraday:{description:"Faraday constant",examples:["faraday"]},firstRadiation:{description:"First radiation constant",examples:["firstRadiation"]},loschmidt:{description:"Loschmidt constant at T=273.15 K and p=101.325 kPa",examples:["loschmidt"]},gasConstant:{description:"Gas constant",examples:["gasConstant"]},molarPlanckConstant:{description:"Molar Planck constant",examples:["molarPlanckConstant"]},molarVolume:{description:"Molar volume of an ideal gas at T=273.15 K and p=101.325 kPa",examples:["molarVolume"]},sackurTetrode:{description:"Sackur-Tetrode constant at T=1 K and p=101.325 kPa",examples:["sackurTetrode"]},secondRadiation:{description:"Second radiation constant",examples:["secondRadiation"]},stefanBoltzmann:{description:"Stefan-Boltzmann constant",examples:["stefanBoltzmann"]},wienDisplacement:{description:"Wien displacement law constant",examples:["wienDisplacement"]},molarMass:{description:"Molar mass constant",examples:["molarMass"]},molarMassC12:{description:"Molar mass constant of carbon-12",examples:["molarMassC12"]},gravity:{description:"Standard acceleration of gravity (standard acceleration of free-fall on Earth)",examples:["gravity"]},planckLength:{description:"Planck length",examples:["planckLength"]},planckMass:{description:"Planck mass",examples:["planckMass"]},planckTime:{description:"Planck time",examples:["planckTime"]},planckCharge:{description:"Planck charge",examples:["planckCharge"]},planckTemperature:{description:"Planck temperature",examples:["planckTemperature"]},derivative:{name:"derivative",category:"Algebra",syntax:["derivative(expr, variable)","derivative(expr, variable, {simplify: boolean})"],description:"Takes the derivative of an expression expressed in parser Nodes. The derivative will be taken over the supplied variable in the second parameter. If there are multiple variables in the expression, it will return a partial derivative.",examples:['derivative("2x^3", "x")','derivative("2x^3", "x", {simplify: false})','derivative("2x^2 + 3x + 4", "x")','derivative("sin(2x)", "x")','f = parse("x^2 + x")','x = parse("x")',"df = derivative(f, x)","df.evaluate({x: 3})"],seealso:["simplify","parse","evaluate"]},lsolve:{name:"lsolve",category:"Algebra",syntax:["x=lsolve(L, b)"],description:"Finds one solution of the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lsolveAll","lup","lusolve","usolve","matrix","sparse"]},lsolveAll:{name:"lsolveAll",category:"Algebra",syntax:["x=lsolveAll(L, b)"],description:"Finds all solutions of the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lsolve","lup","lusolve","usolve","matrix","sparse"]},lup:{name:"lup",category:"Algebra",syntax:["lup(m)"],description:"Calculate the Matrix LU decomposition with partial pivoting. Matrix A is decomposed in three matrices (L, U, P) where P * A = L * U",examples:["lup([[2, 1], [1, 4]])","lup(matrix([[2, 1], [1, 4]]))","lup(sparse([[2, 1], [1, 4]]))"],seealso:["lusolve","lsolve","usolve","matrix","sparse","slu","qr"]},lusolve:{name:"lusolve",category:"Algebra",syntax:["x=lusolve(A, b)","x=lusolve(lu, b)"],description:"Solves the linear system A * x = b where A is an [n x n] matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lusolve(a, b)"],seealso:["lup","slu","lsolve","usolve","matrix","sparse"]},leafCount:{name:"leafCount",category:"Algebra",syntax:["leafCount(expr)"],description:"Computes the number of leaves in the parse tree of the given expression",examples:['leafCount("e^(i*pi)-1")','leafCount(parse("{a: 22/7, b: 10^(1/2)}"))'],seealso:["simplify"]},polynomialRoot:{name:"polynomialRoot",category:"Algebra",syntax:["x=polynomialRoot(-6, 3)","x=polynomialRoot(4, -4, 1)","x=polynomialRoot(-8, 12, -6, 1)"],description:"Finds the roots of a univariate polynomial given by its coefficients starting from constant, linear, and so on, increasing in degree.",examples:["a = polynomialRoot(-6, 11, -6, 1)"],seealso:["cbrt","sqrt"]},resolve:{name:"resolve",category:"Algebra",syntax:["resolve(node, scope)"],description:"Recursively substitute variables in an expression tree.",examples:['resolve(parse("1 + x"), { x: 7 })','resolve(parse("size(text)"), { text: "Hello World" })','resolve(parse("x + y"), { x: parse("3z") })','resolve(parse("3x"), { x: parse("y+z"), z: parse("w^y") })'],seealso:["simplify","evaluate"],mayThrow:["ReferenceError"]},simplify:{name:"simplify",category:"Algebra",syntax:["simplify(expr)","simplify(expr, rules)"],description:"Simplify an expression tree.",examples:['simplify("3 + 2 / 4")','simplify("2x + x")','f = parse("x * (x + 2 + x)")',"simplified = simplify(f)","simplified.evaluate({x: 2})"],seealso:["simplifyCore","derivative","evaluate","parse","rationalize","resolve"]},simplifyConstant:{name:"simplifyConstant",category:"Algebra",syntax:["simplifyConstant(expr)","simplifyConstant(expr, options)"],description:"Replace constant subexpressions of node with their values.",examples:['simplifyConstant("(3-3)*x")','simplifyConstant(parse("z-cos(tau/8)"))'],seealso:["simplify","simplifyCore","evaluate"]},simplifyCore:{name:"simplifyCore",category:"Algebra",syntax:["simplifyCore(node)"],description:"Perform simple one-pass simplifications on an expression tree.",examples:['simplifyCore(parse("0*x"))','simplifyCore(parse("(x+0)*2"))'],seealso:["simplify","simplifyConstant","evaluate"]},symbolicEqual:{name:"symbolicEqual",category:"Algebra",syntax:["symbolicEqual(expr1, expr2)","symbolicEqual(expr1, expr2, options)"],description:"Returns true if the difference of the expressions simplifies to 0",examples:['symbolicEqual("x*y","y*x")','symbolicEqual("abs(x^2)", "x^2")','symbolicEqual("abs(x)", "x", {context: {abs: {trivial: true}}})'],seealso:["simplify","evaluate"]},rationalize:{name:"rationalize",category:"Algebra",syntax:["rationalize(expr)","rationalize(expr, scope)","rationalize(expr, scope, detailed)"],description:"Transform a rationalizable expression in a rational fraction. If rational fraction is one variable polynomial then converts the numerator and denominator in canonical form, with decreasing exponents, returning the coefficients of numerator.",examples:['rationalize("2x/y - y/(x+1)")','rationalize("2x/y - y/(x+1)", true)'],seealso:["simplify"]},slu:{name:"slu",category:"Algebra",syntax:["slu(A, order, threshold)"],description:"Calculate the Matrix LU decomposition with full pivoting. Matrix A is decomposed in two matrices (L, U) and two permutation vectors (pinv, q) where P * A * Q = L * U",examples:["slu(sparse([4.5, 0, 3.2, 0; 3.1, 2.9, 0, 0.9; 0, 1.7, 3, 0; 3.5, 0.4, 0, 1]), 1, 0.001)"],seealso:["lusolve","lsolve","usolve","matrix","sparse","lup","qr"]},usolve:{name:"usolve",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Finds one solution of the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["usolveAll","lup","lusolve","lsolve","matrix","sparse"]},usolveAll:{name:"usolveAll",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Finds all solutions of the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["usolve","lup","lusolve","lsolve","matrix","sparse"]},qr:{name:"qr",category:"Algebra",syntax:["qr(A)"],description:"Calculates the Matrix QR decomposition. Matrix `A` is decomposed in two matrices (`Q`, `R`) where `Q` is an orthogonal matrix and `R` is an upper triangular matrix.",examples:["qr([[1, -1,  4], [1,  4, -2], [1,  4,  2], [1,  -1, 0]])"],seealso:["lup","slu","matrix"]},abs:{name:"abs",category:"Arithmetic",syntax:["abs(x)"],description:"Compute the absolute value.",examples:["abs(3.5)","abs(-4.2)"],seealso:["sign"]},add:{name:"add",category:"Operators",syntax:["x + y","add(x, y)"],description:"Add two values.",examples:["a = 2.1 + 3.6","a - 3.6","3 + 2i","3 cm + 2 inch",'"2.3" + "4"'],seealso:["subtract"]},cbrt:{name:"cbrt",category:"Arithmetic",syntax:["cbrt(x)","cbrt(x, allRoots)"],description:"Compute the cubic root value. If x = y * y * y, then y is the cubic root of x. When `x` is a number or complex number, an optional second argument `allRoots` can be provided to return all three cubic roots. If not provided, the principal root is returned",examples:["cbrt(64)","cube(4)","cbrt(-8)","cbrt(2 + 3i)","cbrt(8i)","cbrt(8i, true)","cbrt(27 m^3)"],seealso:["square","sqrt","cube","multiply"]},ceil:{name:"ceil",category:"Arithmetic",syntax:["ceil(x)","ceil(x, n)","ceil(unit, valuelessUnit)","ceil(unit, n, valuelessUnit)"],description:"Round a value towards plus infinity. If x is complex, both real and imaginary part are rounded towards plus infinity.",examples:["ceil(3.2)","ceil(3.8)","ceil(-4.2)","ceil(3.241cm, cm)","ceil(3.241cm, 2, cm)"],seealso:["floor","fix","round"]},cube:{name:"cube",category:"Arithmetic",syntax:["cube(x)"],description:"Compute the cube of a value. The cube of x is x * x * x.",examples:["cube(2)","2^3","2 * 2 * 2"],seealso:["multiply","square","pow"]},divide:{name:"divide",category:"Operators",syntax:["x / y","divide(x, y)"],description:"Divide two values.",examples:["a = 2 / 3","a * 3","4.5 / 2","3 + 4 / 2","(3 + 4) / 2","18 km / 4.5"],seealso:["multiply"]},dotDivide:{name:"dotDivide",category:"Operators",syntax:["x ./ y","dotDivide(x, y)"],description:"Divide two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a ./ b"],seealso:["multiply","dotMultiply","divide"]},dotMultiply:{name:"dotMultiply",category:"Operators",syntax:["x .* y","dotMultiply(x, y)"],description:"Multiply two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a .* b"],seealso:["multiply","divide","dotDivide"]},dotPow:{name:"dotPow",category:"Operators",syntax:["x .^ y","dotPow(x, y)"],description:"Calculates the power of x to y element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","a .^ 2"],seealso:["pow"]},exp:{name:"exp",category:"Arithmetic",syntax:["exp(x)"],description:"Calculate the exponent of a value.",examples:["exp(1.3)","e ^ 1.3","log(exp(1.3))","x = 2.4","(exp(i*x) == cos(x) + i*sin(x))   # Euler's formula"],seealso:["expm","expm1","pow","log"]},expm:{name:"expm",category:"Arithmetic",syntax:["exp(x)"],description:"Compute the matrix exponential, expm(A) = e^A. The matrix must be square. Not to be confused with exp(a), which performs element-wise exponentiation.",examples:["expm([[0,2],[0,0]])"],seealso:["exp"]},expm1:{name:"expm1",category:"Arithmetic",syntax:["expm1(x)"],description:"Calculate the value of subtracting 1 from the exponential value.",examples:["expm1(2)","pow(e, 2) - 1","log(expm1(2) + 1)"],seealso:["exp","pow","log"]},fix:{name:"fix",category:"Arithmetic",syntax:["fix(x)","fix(x, n)","fix(unit, valuelessUnit)","fix(unit, n, valuelessUnit)"],description:"Round a value towards zero. If x is complex, both real and imaginary part are rounded towards zero.",examples:["fix(3.2)","fix(3.8)","fix(-4.2)","fix(-4.8)","fix(3.241cm, cm)","fix(3.241cm, 2, cm)"],seealso:["ceil","floor","round"]},floor:{name:"floor",category:"Arithmetic",syntax:["floor(x)","floor(x, n)","floor(unit, valuelessUnit)","floor(unit, n, valuelessUnit)"],description:"Round a value towards minus infinity.If x is complex, both real and imaginary part are rounded towards minus infinity.",examples:["floor(3.2)","floor(3.8)","floor(-4.2)","floor(3.241cm, cm)","floor(3.241cm, 2, cm)"],seealso:["ceil","fix","round"]},gcd:{name:"gcd",category:"Arithmetic",syntax:["gcd(a, b)","gcd(a, b, c, ...)"],description:"Compute the greatest common divisor.",examples:["gcd(8, 12)","gcd(-4, 6)","gcd(25, 15, -10)"],seealso:["lcm","xgcd"]},hypot:{name:"hypot",category:"Arithmetic",syntax:["hypot(a, b, c, ...)","hypot([a, b, c, ...])"],description:"Calculate the hypotenuse of a list with values.",examples:["hypot(3, 4)","sqrt(3^2 + 4^2)","hypot(-2)","hypot([3, 4, 5])"],seealso:["abs","norm"]},lcm:{name:"lcm",category:"Arithmetic",syntax:["lcm(x, y)"],description:"Compute the least common multiple.",examples:["lcm(4, 6)","lcm(6, 21)","lcm(6, 21, 5)"],seealso:["gcd"]},log:{name:"log",category:"Arithmetic",syntax:["log(x)","log(x, base)"],description:"Compute the logarithm of a value. If no base is provided, the natural logarithm of x is calculated. If base if provided, the logarithm is calculated for the specified base. log(x, base) is defined as log(x) / log(base).",examples:["log(3.5)","a = log(2.4)","exp(a)","10 ^ 4","log(10000, 10)","log(10000) / log(10)","b = log(1024, 2)","2 ^ b"],seealso:["exp","log1p","log2","log10"]},log2:{name:"log2",category:"Arithmetic",syntax:["log2(x)"],description:"Calculate the 2-base of a value. This is the same as calculating `log(x, 2)`.",examples:["log2(0.03125)","log2(16)","log2(16) / log2(2)","pow(2, 4)"],seealso:["exp","log1p","log","log10"]},log1p:{name:"log1p",category:"Arithmetic",syntax:["log1p(x)","log1p(x, base)"],description:"Calculate the logarithm of a `value+1`",examples:["log1p(2.5)","exp(log1p(1.4))","pow(10, 4)","log1p(9999, 10)","log1p(9999) / log(10)"],seealso:["exp","log","log2","log10"]},log10:{name:"log10",category:"Arithmetic",syntax:["log10(x)"],description:"Compute the 10-base logarithm of a value.",examples:["log10(0.00001)","log10(10000)","10 ^ 4","log(10000) / log(10)","log(10000, 10)"],seealso:["exp","log"]},mod:{name:"mod",category:"Operators",syntax:["x % y","x mod y","mod(x, y)"],description:"Calculates the modulus, the remainder of an integer division.",examples:["7 % 3","11 % 2","10 mod 4","isOdd(x) = x % 2","isOdd(2)","isOdd(3)"],seealso:["divide"]},multiply:{name:"multiply",category:"Operators",syntax:["x * y","multiply(x, y)"],description:"multiply two values.",examples:["a = 2.1 * 3.4","a / 3.4","2 * 3 + 4","2 * (3 + 4)","3 * 2.1 km"],seealso:["divide"]},norm:{name:"norm",category:"Arithmetic",syntax:["norm(x)","norm(x, p)"],description:"Calculate the norm of a number, vector or matrix.",examples:["abs(-3.5)","norm(-3.5)","norm(3 - 4i)","norm([1, 2, -3], Infinity)","norm([1, 2, -3], -Infinity)","norm([3, 4], 2)","norm([[1, 2], [3, 4]], 1)",'norm([[1, 2], [3, 4]], "inf")','norm([[1, 2], [3, 4]], "fro")']},nthRoot:{name:"nthRoot",category:"Arithmetic",syntax:["nthRoot(a)","nthRoot(a, root)"],description:'Calculate the nth root of a value. The principal nth root of a positive real number A, is the positive real solution of the equation "x^root = A".',examples:["4 ^ 3","nthRoot(64, 3)","nthRoot(9, 2)","sqrt(9)"],seealso:["nthRoots","pow","sqrt"]},nthRoots:{name:"nthRoots",category:"Arithmetic",syntax:["nthRoots(A)","nthRoots(A, root)"],description:'Calculate the nth roots of a value. An nth root of a positive real number A, is a positive real solution of the equation "x^root = A". This function returns an array of complex values.',examples:["nthRoots(1)","nthRoots(1, 3)"],seealso:["sqrt","pow","nthRoot"]},pow:{name:"pow",category:"Operators",syntax:["x ^ y","pow(x, y)"],description:"Calculates the power of x to y, x^y.",examples:["2^3","2*2*2","1 + e ^ (pi * i)","pow([[1, 2], [4, 3]], 2)","pow([[1, 2], [4, 3]], -1)"],seealso:["multiply","nthRoot","nthRoots","sqrt"]},round:{name:"round",category:"Arithmetic",syntax:["round(x)","round(x, n)","round(unit, valuelessUnit)","round(unit, n, valuelessUnit)"],description:"round a value towards the nearest integer.If x is complex, both real and imaginary part are rounded towards the nearest integer. When n is specified, the value is rounded to n decimals.",examples:["round(3.2)","round(3.8)","round(-4.2)","round(-4.8)","round(pi, 3)","round(123.45678, 2)","round(3.241cm, 2, cm)","round([3.2, 3.8, -4.7])"],seealso:["ceil","floor","fix"]},sign:{name:"sign",category:"Arithmetic",syntax:["sign(x)"],description:"Compute the sign of a value. The sign of a value x is 1 when x>0, -1 when x<0, and 0 when x=0.",examples:["sign(3.5)","sign(-4.2)","sign(0)"],seealso:["abs"]},sqrt:{name:"sqrt",category:"Arithmetic",syntax:["sqrt(x)"],description:"Compute the square root value. If x = y * y, then y is the square root of x.",examples:["sqrt(25)","5 * 5","sqrt(-1)"],seealso:["square","sqrtm","multiply","nthRoot","nthRoots","pow"]},sqrtm:{name:"sqrtm",category:"Arithmetic",syntax:["sqrtm(x)"],description:"Calculate the principal square root of a square matrix. The principal square root matrix `X` of another matrix `A` is such that `X * X = A`.",examples:["sqrtm([[33, 24], [48, 57]])"],seealso:["sqrt","abs","square","multiply"]},square:{name:"square",category:"Arithmetic",syntax:["square(x)"],description:"Compute the square of a value. The square of x is x * x.",examples:["square(3)","sqrt(9)","3^2","3 * 3"],seealso:["multiply","pow","sqrt","cube"]},subtract:{name:"subtract",category:"Operators",syntax:["x - y","subtract(x, y)"],description:"subtract two values.",examples:["a = 5.3 - 2","a + 2","2/3 - 1/6","2 * 3 - 3","2.1 km - 500m"],seealso:["add"]},unaryMinus:{name:"unaryMinus",category:"Operators",syntax:["-x","unaryMinus(x)"],description:"Inverse the sign of a value. Converts booleans and strings to numbers.",examples:["-4.5","-(-5.6)",'-"22"'],seealso:["add","subtract","unaryPlus"]},unaryPlus:{name:"unaryPlus",category:"Operators",syntax:["+x","unaryPlus(x)"],description:"Converts booleans and strings to numbers.",examples:["+true",'+"2"'],seealso:["add","subtract","unaryMinus"]},xgcd:{name:"xgcd",category:"Arithmetic",syntax:["xgcd(a, b)"],description:"Calculate the extended greatest common divisor for two values. The result is an array [d, x, y] with 3 entries, where d is the greatest common divisor, and d = x * a + y * b.",examples:["xgcd(8, 12)","gcd(8, 12)","xgcd(36163, 21199)"],seealso:["gcd","lcm"]},invmod:{name:"invmod",category:"Arithmetic",syntax:["invmod(a, b)"],description:"Calculate the (modular) multiplicative inverse of a modulo b. Solution to the equation ax \u2263 1 (mod b)",examples:["invmod(8, 12)","invmod(7, 13)","invmod(15151, 15122)"],seealso:["gcd","xgcd"]},bitAnd:{name:"bitAnd",category:"Bitwise",syntax:["x & y","bitAnd(x, y)"],description:"Bitwise AND operation. Performs the logical AND operation on each pair of the corresponding bits of the two given values by multiplying them. If both bits in the compared position are 1, the bit in the resulting binary representation is 1, otherwise, the result is 0",examples:["5 & 3","bitAnd(53, 131)","[1, 12, 31] & 42"],seealso:["bitNot","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},bitNot:{name:"bitNot",category:"Bitwise",syntax:["~x","bitNot(x)"],description:"Bitwise NOT operation. Performs a logical negation on each bit of the given value. Bits that are 0 become 1, and those that are 1 become 0.",examples:["~1","~2","bitNot([2, -3, 4])"],seealso:["bitAnd","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},bitOr:{name:"bitOr",category:"Bitwise",syntax:["x | y","bitOr(x, y)"],description:"Bitwise OR operation. Performs the logical inclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if the first bit is 1 or the second bit is 1 or both bits are 1, otherwise, the result is 0.",examples:["5 | 3","bitOr([1, 2, 3], 4)"],seealso:["bitAnd","bitNot","bitXor","leftShift","rightArithShift","rightLogShift"]},bitXor:{name:"bitXor",category:"Bitwise",syntax:["bitXor(x, y)"],description:"Bitwise XOR operation, exclusive OR. Performs the logical exclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if only the first bit is 1 or only the second bit is 1, but will be 0 if both are 0 or both are 1.",examples:["bitOr(1, 2)","bitXor([2, 3, 4], 4)"],seealso:["bitAnd","bitNot","bitOr","leftShift","rightArithShift","rightLogShift"]},leftShift:{name:"leftShift",category:"Bitwise",syntax:["x << y","leftShift(x, y)"],description:"Bitwise left logical shift of a value x by y number of bits.",examples:["4 << 1","8 >> 1"],seealso:["bitAnd","bitNot","bitOr","bitXor","rightArithShift","rightLogShift"]},rightArithShift:{name:"rightArithShift",category:"Bitwise",syntax:["x >> y","rightArithShift(x, y)"],description:"Bitwise right arithmetic shift of a value x by y number of bits.",examples:["8 >> 1","4 << 1","-12 >> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightLogShift"]},rightLogShift:{name:"rightLogShift",category:"Bitwise",syntax:["x >>> y","rightLogShift(x, y)"],description:"Bitwise right logical shift of a value x by y number of bits.",examples:["8 >>> 1","4 << 1","-12 >>> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightArithShift"]},bellNumbers:{name:"bellNumbers",category:"Combinatorics",syntax:["bellNumbers(n)"],description:"The Bell Numbers count the number of partitions of a set. A partition is a pairwise disjoint subset of S whose union is S. `bellNumbers` only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["bellNumbers(3)","bellNumbers(8)"],seealso:["stirlingS2"]},catalan:{name:"catalan",category:"Combinatorics",syntax:["catalan(n)"],description:"The Catalan Numbers enumerate combinatorial structures of many different types. catalan only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["catalan(3)","catalan(8)"],seealso:["bellNumbers"]},composition:{name:"composition",category:"Combinatorics",syntax:["composition(n, k)"],description:"The composition counts of n into k parts. composition only takes integer arguments. The following condition must be enforced: k <= n.",examples:["composition(5, 3)"],seealso:["combinations"]},stirlingS2:{name:"stirlingS2",category:"Combinatorics",syntax:["stirlingS2(n, k)"],description:"he Stirling numbers of the second kind, counts the number of ways to partition a set of n labelled objects into k nonempty unlabelled subsets. `stirlingS2` only takes integer arguments. The following condition must be enforced: k <= n. If n = k or k = 1, then s(n,k) = 1.",examples:["stirlingS2(5, 3)"],seealso:["bellNumbers"]},config:{name:"config",category:"Core",syntax:["config()","config(options)"],description:"Get configuration or change configuration.",examples:["config()","1/3 + 1/4",'config({number: "Fraction"})',"1/3 + 1/4"],seealso:[]},import:{name:"import",category:"Core",syntax:["import(functions)","import(functions, options)"],description:"Import functions or constants from an object.",examples:["import({myFn: f(x)=x^2, myConstant: 32 })","myFn(2)","myConstant"],seealso:[]},typed:{name:"typed",category:"Core",syntax:["typed(signatures)","typed(name, signatures)"],description:"Create a typed function.",examples:['double = typed({ "number": f(x)=x+x, "string": f(x)=concat(x,x) })',"double(2)",'double("hello")'],seealso:[]},arg:{name:"arg",category:"Complex",syntax:["arg(x)"],description:"Compute the argument of a complex value. If x = a+bi, the argument is computed as atan2(b, a).",examples:["arg(2 + 2i)","atan2(3, 2)","arg(2 + 3i)"],seealso:["re","im","conj","abs"]},conj:{name:"conj",category:"Complex",syntax:["conj(x)"],description:"Compute the complex conjugate of a complex value. If x = a+bi, the complex conjugate is a-bi.",examples:["conj(2 + 3i)","conj(2 - 3i)","conj(-5.2i)"],seealso:["re","im","abs","arg"]},re:{name:"re",category:"Complex",syntax:["re(x)"],description:"Get the real part of a complex number.",examples:["re(2 + 3i)","im(2 + 3i)","re(-5.2i)","re(2.4)"],seealso:["im","conj","abs","arg"]},im:{name:"im",category:"Complex",syntax:["im(x)"],description:"Get the imaginary part of a complex number.",examples:["im(2 + 3i)","re(2 + 3i)","im(-5.2i)","im(2.4)"],seealso:["re","conj","abs","arg"]},evaluate:{name:"evaluate",category:"Expression",syntax:["evaluate(expression)","evaluate(expression, scope)","evaluate([expr1, expr2, expr3, ...])","evaluate([expr1, expr2, expr3, ...], scope)"],description:"Evaluate an expression or an array with expressions.",examples:['evaluate("2 + 3")','evaluate("sqrt(16)")','evaluate("2 inch to cm")','evaluate("sin(x * pi)", { "x": 1/2 })','evaluate(["width=2", "height=4","width*height"])'],seealso:["parser","parse","compile"]},help:{name:"help",category:"Expression",syntax:["help(object)","help(string)"],description:"Display documentation on a function or data type.",examples:["help(sqrt)",'help("complex")'],seealso:[]},parse:{name:"parse",category:"Expression",syntax:["parse(expr)","parse(expr, options)","parse([expr1, expr2, expr3, ...])","parse([expr1, expr2, expr3, ...], options)"],description:"Parse an expression. Returns a node tree, which can be evaluated by invoking node.evaluate() or transformed into a functional object via node.compile().",examples:['node1 = parse("sqrt(3^2 + 4^2)")',"node1.evaluate()","code1 = node1.compile()","code1.evaluate()","scope = {a: 3, b: 4}",'node2 = parse("a * b")',"node2.evaluate(scope)","code2 = node2.compile()","code2.evaluate(scope)"],seealso:["parser","evaluate","compile"]},parser:{name:"parser",category:"Expression",syntax:["parser()"],description:"Create a parser object that keeps a context of variables and their values, allowing the evaluation of expressions in that context.",examples:["myParser = parser()",'myParser.evaluate("sqrt(3^2 + 4^2)")','myParser.set("x", 3)','myParser.evaluate("y = x + 3")','myParser.evaluate(["y = x + 3", "y = y + 1"])','myParser.get("y")'],seealso:["evaluate","parse","compile"]},compile:{name:"compile",category:"Expression",syntax:["compile(expr) ","compile([expr1, expr2, expr3, ...])"],description:"Parse and compile an expression. Returns a an object with a function evaluate([scope]) to evaluate the compiled expression.",examples:['code1 = compile("sqrt(3^2 + 4^2)")',"code1.evaluate() ",'code2 = compile("a * b")',"code2.evaluate({a: 3, b: 4})"],seealso:["parser","parse","evaluate"]},distance:{name:"distance",category:"Geometry",syntax:["distance([x1, y1], [x2, y2])","distance([[x1, y1], [x2, y2]])"],description:"Calculates the Euclidean distance between two points.",examples:["distance([0,0], [4,4])","distance([[0,0], [4,4]])"],seealso:[]},intersect:{name:"intersect",category:"Geometry",syntax:["intersect(expr1, expr2, expr3, expr4)","intersect(expr1, expr2, expr3)"],description:"Computes the intersection point of lines and/or planes.",examples:["intersect([0, 0], [10, 10], [10, 0], [0, 10])","intersect([1, 0, 1],  [4, -2, 2], [1, 1, 1, 6])"],seealso:[]},and:{name:"and",category:"Logical",syntax:["x and y","and(x, y)"],description:"Logical and. Test whether two values are both defined with a nonzero/nonempty value.",examples:["true and false","true and true","2 and 4"],seealso:["not","or","xor"]},not:{name:"not",category:"Logical",syntax:["not x","not(x)"],description:"Logical not. Flips the boolean value of given argument.",examples:["not true","not false","not 2","not 0"],seealso:["and","or","xor"]},nullish:{name:"nullish",category:"Logical",syntax:["x ?? y","nullish(x, y)"],description:"Nullish coalescing operator. Returns the right-hand operand when the left-hand operand is null or undefined, and otherwise returns the left-hand operand.",examples:["null ?? 42","undefined ?? 42","0 ?? 42","false ?? 42","null ?? undefined ?? 42"],seealso:["and","or","not"]},or:{name:"or",category:"Logical",syntax:["x or y","or(x, y)"],description:"Logical or. Test if at least one value is defined with a nonzero/nonempty value.",examples:["true or false","false or false","0 or 4"],seealso:["not","and","xor"]},xor:{name:"xor",category:"Logical",syntax:["x xor y","xor(x, y)"],description:"Logical exclusive or, xor. Test whether one and only one value is defined with a nonzero/nonempty value.",examples:["true xor false","false xor false","true xor true","0 xor 4"],seealso:["not","and","or"]},mapSlices:{name:"mapSlices",category:"Matrix",syntax:["mapSlices(A, dim, callback)"],description:"Generate a matrix one dimension less than A by applying callback to each slice of A along dimension dim.",examples:["A = [[1, 2], [3, 4]]","mapSlices(A, 1, sum)","mapSlices(A, 2, prod)"],seealso:["map","forEach"]},concat:{name:"concat",category:"Matrix",syntax:["concat(A, B, C, ...)","concat(A, B, C, ..., dim)"],description:"Concatenate matrices. By default, the matrices are concatenated by the last dimension. The dimension on which to concatenate can be provided as last argument.",examples:["A = [1, 2; 5, 6]","B = [3, 4; 7, 8]","concat(A, B)","concat(A, B, 1)","concat(A, B, 2)"],seealso:["det","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},count:{name:"count",category:"Matrix",syntax:["count(x)"],description:"Count the number of elements of a matrix, array or string.",examples:["a = [1, 2; 3, 4; 5, 6]","count(a)","size(a)",'count("hello world")'],seealso:["size"]},cross:{name:"cross",category:"Matrix",syntax:["cross(A, B)"],description:"Calculate the cross product for two vectors in three dimensional space.",examples:["cross([1, 1, 0],  [0, 1, 1])","cross([3, -3, 1], [4, 9, 2])","cross([2, 3, 4],  [5, 6, 7])"],seealso:["multiply","dot"]},column:{name:"column",category:"Matrix",syntax:["column(x, index)"],description:"Return a column from a matrix or array.",examples:["A = [[1, 2], [3, 4]]","column(A, 1)","column(A, 2)"],seealso:["row","matrixFromColumns"]},ctranspose:{name:"ctranspose",category:"Matrix",syntax:["x'","ctranspose(x)"],description:"Complex Conjugate and Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","ctranspose(a)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","zeros"]},det:{name:"det",category:"Matrix",syntax:["det(x)"],description:"Calculate the determinant of a matrix",examples:["det([1, 2; 3, 4])","det([-2, 2, 3; -1, 1, 3; 2, 0, -1])"],seealso:["concat","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},diag:{name:"diag",category:"Matrix",syntax:["diag(x)","diag(x, k)"],description:"Create a diagonal matrix or retrieve the diagonal of a matrix. When x is a vector, a matrix with the vector values on the diagonal will be returned. When x is a matrix, a vector with the diagonal values of the matrix is returned. When k is provided, the k-th diagonal will be filled in or retrieved, if k is positive, the values are placed on the super diagonal. When k is negative, the values are placed on the sub diagonal.",examples:["diag(1:3)","diag(1:3, 1)","a = [1, 2, 3; 4, 5, 6; 7, 8, 9]","diag(a)"],seealso:["concat","det","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},diff:{name:"diff",category:"Matrix",syntax:["diff(arr)","diff(arr, dim)"],description:["Create a new matrix or array with the difference of the passed matrix or array.","Dim parameter is optional and used to indicate the dimension of the array/matrix to apply the difference","If no dimension parameter is passed it is assumed as dimension 0","Dimension is zero-based in javascript and one-based in the parser","Arrays must be 'rectangular' meaning arrays like [1, 2]","If something is passed as a matrix it will be returned as a matrix but other than that all matrices are converted to arrays"],examples:["A = [1, 2, 4, 7, 0]","diff(A)","diff(A, 1)","B = [[1, 2], [3, 4]]","diff(B)","diff(B, 1)","diff(B, 2)","diff(B, bignumber(2))","diff([[1, 2], matrix([3, 4])], 2)"],seealso:["subtract","partitionSelect"]},dot:{name:"dot",category:"Matrix",syntax:["dot(A, B)","A * B"],description:"Calculate the dot product of two vectors. The dot product of A = [a1, a2, a3, ..., an] and B = [b1, b2, b3, ..., bn] is defined as dot(A, B) = a1 * b1 + a2 * b2 + a3 * b3 + ... + an * bn",examples:["dot([2, 4, 1], [2, 2, 3])","[2, 4, 1] * [2, 2, 3]"],seealso:["multiply","cross"]},getMatrixDataType:{name:"getMatrixDataType",category:"Matrix",syntax:["getMatrixDataType(x)"],description:'Find the data type of all elements in a matrix or array, for example "number" if all items are a number and "Complex" if all values are complex numbers. If a matrix contains more than one data type, it will return "mixed".',examples:["getMatrixDataType([1, 2, 3])","getMatrixDataType([[5 cm], [2 inch]])",'getMatrixDataType([1, "text"])',"getMatrixDataType([1, bignumber(4)])"],seealso:["matrix","sparse","typeOf"]},identity:{name:"identity",category:"Matrix",syntax:["identity(n)","identity(m, n)","identity([m, n])"],description:"Returns the identity matrix with size m-by-n. The matrix has ones on the diagonal and zeros elsewhere.",examples:["identity(3)","identity(3, 5)","a = [1, 2, 3; 4, 5, 6]","identity(size(a))"],seealso:["concat","det","diag","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},filter:{name:"filter",category:"Matrix",syntax:["filter(x, test)"],description:"Filter items in a matrix.",examples:["isPositive(x) = x > 0","filter([6, -2, -1, 4, 3], isPositive)","filter([6, -2, 0, 1, 0], x != 0)"],seealso:["sort","map","forEach"]},flatten:{name:"flatten",category:"Matrix",syntax:["flatten(x)"],description:"Flatten a multi dimensional matrix into a single dimensional matrix.",examples:["a = [1, 2, 3; 4, 5, 6]","size(a)","b = flatten(a)","size(b)"],seealso:["concat","resize","size","squeeze"]},forEach:{name:"forEach",category:"Matrix",syntax:["forEach(x, callback)"],description:"Iterates over all elements of a matrix/array, and executes the given callback function.",examples:["numberOfPets = {}","addPet(n) = numberOfPets[n] = (numberOfPets[n] ? numberOfPets[n]:0 ) + 1;",'forEach(["Dog","Cat","Cat"], addPet)',"numberOfPets"],seealso:["map","sort","filter"]},inv:{name:"inv",category:"Matrix",syntax:["inv(x)"],description:"Calculate the inverse of a matrix",examples:["inv([1, 2; 3, 4])","inv(4)","1 / 4"],seealso:["concat","det","diag","identity","ones","range","size","squeeze","subset","trace","transpose","zeros"]},pinv:{name:"pinv",category:"Matrix",syntax:["pinv(x)"],description:"Calculate the Moore\u2013Penrose inverse of a matrix",examples:["pinv([1, 2; 3, 4])","pinv([[1, 0], [0, 1], [0, 1]])","pinv(4)"],seealso:["inv"]},eigs:{name:"eigs",category:"Matrix",syntax:["eigs(x)"],description:"Calculate the eigenvalues and optionally eigenvectors of a square matrix",examples:["eigs([[5, 2.3], [2.3, 1]])","eigs([[1, 2, 3], [4, 5, 6], [7, 8, 9]], { precision: 1e-6, eigenvectors: false })"],seealso:["inv"]},kron:{name:"kron",category:"Matrix",syntax:["kron(x, y)"],description:"Calculates the Kronecker product of 2 matrices or vectors.",examples:["kron([[1, 0], [0, 1]], [[1, 2], [3, 4]])","kron([1,1], [2,3,4])"],seealso:["multiply","dot","cross"]},matrixFromFunction:{name:"matrixFromFunction",category:"Matrix",syntax:["matrixFromFunction(size, fn)","matrixFromFunction(size, fn, format)","matrixFromFunction(size, fn, format, datatype)","matrixFromFunction(size, format, fn)","matrixFromFunction(size, format, datatype, fn)"],description:"Create a matrix by evaluating a generating function at each index.",examples:["f(I) = I[1] - I[2]","matrixFromFunction([3,3], f)","g(I) = I[1] - I[2] == 1 ? 4 : 0",'matrixFromFunction([100, 100], "sparse", g)',"matrixFromFunction([5], random)"],seealso:["matrix","matrixFromRows","matrixFromColumns","zeros"]},matrixFromRows:{name:"matrixFromRows",category:"Matrix",syntax:["matrixFromRows(...arr)","matrixFromRows(row1, row2)","matrixFromRows(row1, row2, row3)"],description:"Create a dense matrix from vectors as individual rows.",examples:["matrixFromRows([1, 2, 3], [[4],[5],[6]])"],seealso:["matrix","matrixFromColumns","matrixFromFunction","zeros"]},matrixFromColumns:{name:"matrixFromColumns",category:"Matrix",syntax:["matrixFromColumns(...arr)","matrixFromColumns(row1, row2)","matrixFromColumns(row1, row2, row3)"],description:"Create a dense matrix from vectors as individual columns.",examples:["matrixFromColumns([1, 2, 3], [[4],[5],[6]])"],seealso:["matrix","matrixFromRows","matrixFromFunction","zeros"]},map:{name:"map",category:"Matrix",syntax:["map(x, callback)","map(x, y, ..., callback)"],description:"Create a new matrix or array with the results of the callback function executed on each entry of the matrix/array or the matrices/arrays.",examples:["map([1, 2, 3], square)","map([1, 2], [3, 4], f(a,b) = a + b)"],seealso:["filter","forEach"]},ones:{name:"ones",category:"Matrix",syntax:["ones(m)","ones(m, n)","ones(m, n, p, ...)","ones([m])","ones([m, n])","ones([m, n, p, ...])"],description:"Create a matrix containing ones.",examples:["ones(3)","ones(3, 5)","ones([2,3]) * 4.5","a = [1, 2, 3; 4, 5, 6]","ones(size(a))"],seealso:["concat","det","diag","identity","inv","range","size","squeeze","subset","trace","transpose","zeros"]},partitionSelect:{name:"partitionSelect",category:"Matrix",syntax:["partitionSelect(x, k)","partitionSelect(x, k, compare)"],description:"Partition-based selection of an array or 1D matrix. Will find the kth smallest value, and mutates the input array. Uses Quickselect.",examples:["partitionSelect([5, 10, 1], 2)",'partitionSelect(["C", "B", "A", "D"], 1, compareText)',"arr = [5, 2, 1]","partitionSelect(arr, 0) # returns 1, arr is now: [1, 2, 5]","arr","partitionSelect(arr, 1, 'desc') # returns 2, arr is now: [5, 2, 1]","arr"],seealso:["sort"]},range:{name:"range",category:"Type",syntax:["start:end","start:step:end","range(start, end)","range(start, end, step)","range(string)"],description:"Create a range. Lower bound of the range is included, upper bound is excluded.",examples:["1:5","3:-1:-3","range(3, 7)","range(0, 12, 2)",'range("4:10")',"range(1m, 1m, 3m)","a = [1, 2, 3, 4; 5, 6, 7, 8]","a[1:2, 1:2]"],seealso:["concat","det","diag","identity","inv","ones","size","squeeze","subset","trace","transpose","zeros"]},resize:{name:"resize",category:"Matrix",syntax:["resize(x, size)","resize(x, size, defaultValue)"],description:"Resize a matrix.",examples:["resize([1,2,3,4,5], [3])","resize([1,2,3], [5])","resize([1,2,3], [5], -1)","resize(2, [2, 3])",'resize("hello", [8], "!")'],seealso:["size","subset","squeeze","reshape"]},reshape:{name:"reshape",category:"Matrix",syntax:["reshape(x, sizes)"],description:"Reshape a multi dimensional array to fit the specified dimensions.",examples:["reshape([1, 2, 3, 4, 5, 6], [2, 3])","reshape([[1, 2], [3, 4]], [1, 4])","reshape([[1, 2], [3, 4]], [4])","reshape([1, 2, 3, 4], [-1, 2])"],seealso:["size","squeeze","resize"]},rotate:{name:"rotate",category:"Matrix",syntax:["rotate(w, theta)","rotate(w, theta, v)"],description:"Returns a 2-D rotation matrix (2x2) for a given angle (in radians). Returns a 2-D rotation matrix (3x3) of a given angle (in radians) around given axis.",examples:["rotate([1, 0], pi / 2)",'rotate(matrix([1, 0]), unit("35deg"))','rotate([1, 0, 0], unit("90deg"), [0, 0, 1])','rotate(matrix([1, 0, 0]), unit("90deg"), matrix([0, 0, 1]))'],seealso:["matrix","rotationMatrix"]},rotationMatrix:{name:"rotationMatrix",category:"Matrix",syntax:["rotationMatrix(theta)","rotationMatrix(theta, v)","rotationMatrix(theta, v, format)"],description:"Returns a 2-D rotation matrix (2x2) for a given angle (in radians). Returns a 2-D rotation matrix (3x3) of a given angle (in radians) around given axis.",examples:["rotationMatrix(pi / 2)",'rotationMatrix(unit("45deg"), [0, 0, 1])','rotationMatrix(1, matrix([0, 0, 1]), "sparse")'],seealso:["cos","sin"]},row:{name:"row",category:"Matrix",syntax:["row(x, index)"],description:"Return a row from a matrix or array.",examples:["A = [[1, 2], [3, 4]]","row(A, 1)","row(A, 2)"],seealso:["column","matrixFromRows"]},size:{name:"size",category:"Matrix",syntax:["size(x)"],description:"Calculate the size of a matrix.",examples:["size(2.3)",'size("hello world")',"a = [1, 2; 3, 4; 5, 6]","size(a)","size(1:6)"],seealso:["concat","count","det","diag","identity","inv","ones","range","squeeze","subset","trace","transpose","zeros"]},sort:{name:"sort",category:"Matrix",syntax:["sort(x)","sort(x, compare)"],description:'Sort the items in a matrix. Compare can be a string "asc", "desc", "natural", or a custom sort function.',examples:["sort([5, 10, 1])",'sort(["C", "B", "A", "D"], "natural")',"sortByLength(a, b) = size(a)[1] - size(b)[1]",'sort(["Langdon", "Tom", "Sara"], sortByLength)','sort(["10", "1", "2"], "natural")'],seealso:["map","filter","forEach"]},squeeze:{name:"squeeze",category:"Matrix",syntax:["squeeze(x)"],description:"Remove inner and outer singleton dimensions from a matrix.",examples:["a = zeros(3,2,1)","size(squeeze(a))","b = zeros(1,1,3)","size(squeeze(b))"],seealso:["concat","det","diag","identity","inv","ones","range","size","subset","trace","transpose","zeros"]},subset:{name:"subset",category:"Matrix",syntax:["value(index)","value(index) = replacement","subset(value, [index])","subset(value, [index], replacement)"],description:"Get or set a subset of the entries of a matrix or characters of a string. Indexes are one-based. There should be one index specification for each dimension of the target. Each specification can be a single index, a list of indices, or a range in colon notation `l:u`. In a range, both the lower bound l and upper bound u are included; and if a bound is omitted it defaults to the most extreme valid value. The cartesian product of the indices specified in each dimension determines the target of the operation.",examples:["d = [1, 2; 3, 4]","e = []","e[1, 1:2] = [5, 6]","e[2, :] = [7, 8]","f = d * e","f[2, 1]","f[:, 1]","f[[1,2], [1,3]] = [9, 10; 11, 12]","f"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","trace","transpose","zeros"]},trace:{name:"trace",category:"Matrix",syntax:["trace(A)"],description:"Calculate the trace of a matrix: the sum of the elements on the main diagonal of a square matrix.",examples:["A = [1, 2, 3; -1, 2, 3; 2, 0, 3]","trace(A)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","transpose","zeros"]},transpose:{name:"transpose",category:"Matrix",syntax:["x'","transpose(x)"],description:"Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","transpose(a)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","zeros"]},zeros:{name:"zeros",category:"Matrix",syntax:["zeros(m)","zeros(m, n)","zeros(m, n, p, ...)","zeros([m])","zeros([m, n])","zeros([m, n, p, ...])"],description:"Create a matrix containing zeros.",examples:["zeros(3)","zeros(3, 5)","a = [1, 2, 3; 4, 5, 6]","zeros(size(a))"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose"]},fft:{name:"fft",category:"Matrix",syntax:["fft(x)"],description:"Calculate N-dimensional Fourier transform",examples:["fft([[1, 0], [1, 0]])"],seealso:["ifft"]},ifft:{name:"ifft",category:"Matrix",syntax:["ifft(x)"],description:"Calculate N-dimensional inverse Fourier transform",examples:["ifft([[2, 2], [0, 0]])"],seealso:["fft"]},sylvester:{name:"sylvester",category:"Algebra",syntax:["sylvester(A,B,C)"],description:"Solves the real-valued Sylvester equation AX+XB=C for X",examples:["sylvester([[-1, -2], [1, 1]], [[-2, 1], [-1, 2]], [[-3, 2], [3, 0]])","A = [[-1, -2], [1, 1]]; B = [[2, -1], [1, -2]]; C = [[-3, 2], [3, 0]]","sylvester(A, B, C)"],seealso:["schur","lyap"]},schur:{name:"schur",category:"Algebra",syntax:["schur(A)"],description:"Performs a real Schur decomposition of the real matrix A = UTU'",examples:["schur([[1, 0], [-4, 3]])","A = [[1, 0], [-4, 3]]","schur(A)"],seealso:["lyap","sylvester"]},lyap:{name:"lyap",category:"Algebra",syntax:["lyap(A,Q)"],description:"Solves the Continuous-time Lyapunov equation AP+PA'+Q=0 for P",examples:["lyap([[-2, 0], [1, -4]], [[3, 1], [1, 3]])","A = [[-2, 0], [1, -4]]","Q = [[3, 1], [1, 3]]","lyap(A,Q)"],seealso:["schur","sylvester"]},solveODE:{name:"solveODE",category:"Numeric",syntax:["solveODE(func, tspan, y0)","solveODE(func, tspan, y0, options)"],description:"Numerical Integration of Ordinary Differential Equations.",examples:["f(t,y) = y","tspan = [0, 4]","solveODE(f, tspan, 1)","solveODE(f, tspan, [1, 2])",'solveODE(f, tspan, 1, { method:"RK23", maxStep:0.1 })'],seealso:["derivative","simplifyCore"]},combinations:{name:"combinations",category:"Probability",syntax:["combinations(n, k)"],description:"Compute the number of combinations of n items taken k at a time",examples:["combinations(7, 5)"],seealso:["combinationsWithRep","permutations","factorial"]},combinationsWithRep:{name:"combinationsWithRep",category:"Probability",syntax:["combinationsWithRep(n, k)"],description:"Compute the number of combinations of n items taken k at a time with replacements.",examples:["combinationsWithRep(7, 5)"],seealso:["combinations","permutations","factorial"]},factorial:{name:"factorial",category:"Probability",syntax:["n!","factorial(n)"],description:"Compute the factorial of a value",examples:["5!","5 * 4 * 3 * 2 * 1","3!"],seealso:["combinations","combinationsWithRep","permutations","gamma"]},gamma:{name:"gamma",category:"Probability",syntax:["gamma(n)"],description:"Compute the gamma function. For small values, the Lanczos approximation is used, and for large values the extended Stirling approximation.",examples:["gamma(4)","3!","gamma(1/2)","sqrt(pi)"],seealso:["factorial"]},kldivergence:{name:"kldivergence",category:"Probability",syntax:["kldivergence(x, y)"],description:"Calculate the Kullback-Leibler (KL) divergence  between two distributions.",examples:["kldivergence([0.7,0.5,0.4], [0.2,0.9,0.5])"],seealso:[]},lgamma:{name:"lgamma",category:"Probability",syntax:["lgamma(n)"],description:"Logarithm of the gamma function for real, positive numbers and complex numbers, using Lanczos approximation for numbers and Stirling series for complex numbers.",examples:["lgamma(4)","lgamma(1/2)","lgamma(i)","lgamma(complex(1.1, 2))"],seealso:["gamma"]},multinomial:{name:"multinomial",category:"Probability",syntax:["multinomial(A)"],description:"Multinomial Coefficients compute the number of ways of picking a1, a2, ..., ai unordered outcomes from `n` possibilities. multinomial takes one array of integers as an argument. The following condition must be enforced: every ai > 0.",examples:["multinomial([1, 2, 1])"],seealso:["combinations","factorial"]},permutations:{name:"permutations",category:"Probability",syntax:["permutations(n)","permutations(n, k)"],description:"Compute the number of permutations of n items taken k at a time",examples:["permutations(5)","permutations(5, 3)"],seealso:["combinations","combinationsWithRep","factorial"]},pickRandom:{name:"pickRandom",category:"Probability",syntax:["pickRandom(array)","pickRandom(array, number)","pickRandom(array, weights)","pickRandom(array, number, weights)","pickRandom(array, weights, number)"],description:"Pick a random entry from a given array.",examples:["pickRandom(0:10)","pickRandom([1, 3, 1, 6])","pickRandom([1, 3, 1, 6], 2)","pickRandom([1, 3, 1, 6], [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], 2, [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], [2, 3, 2, 1], 2)"],seealso:["random","randomInt"]},random:{name:"random",category:"Probability",syntax:["random()","random(max)","random(min, max)","random(size)","random(size, max)","random(size, min, max)"],description:"Return a random number.",examples:["random()","random(10, 20)","random([2, 3])"],seealso:["pickRandom","randomInt"]},randomInt:{name:"randomInt",category:"Probability",syntax:["randomInt(max)","randomInt(min, max)","randomInt(size)","randomInt(size, max)","randomInt(size, min, max)"],description:"Return a random integer number",examples:["randomInt(10, 20)","randomInt([2, 3], 10)"],seealso:["pickRandom","random"]},compare:{name:"compare",category:"Relational",syntax:["compare(x, y)"],description:"Compare two values. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compare(2, 3)","compare(3, 2)","compare(2, 2)","compare(5cm, 40mm)","compare(2, [1, 2, 3])"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compareNatural","compareText"]},compareNatural:{name:"compareNatural",category:"Relational",syntax:["compareNatural(x, y)"],description:"Compare two values of any type in a deterministic, natural way. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compareNatural(2, 3)","compareNatural(3, 2)","compareNatural(2, 2)","compareNatural(5cm, 40mm)",'compareNatural("2", "10")',"compareNatural(2 + 3i, 2 + 4i)","compareNatural([1, 2, 4], [1, 2, 3])","compareNatural([1, 5], [1, 2, 3])","compareNatural([1, 2], [1, 2])","compareNatural({a: 2}, {a: 4})"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare","compareText"]},compareText:{name:"compareText",category:"Relational",syntax:["compareText(x, y)"],description:"Compare two strings lexically. Comparison is case sensitive. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:['compareText("B", "A")','compareText("A", "B")','compareText("A", "A")','compareText("2", "10")','compare("2", "10")',"compare(2, 10)",'compareNatural("2", "10")','compareText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural"]},deepEqual:{name:"deepEqual",category:"Relational",syntax:["deepEqual(x, y)"],description:"Check equality of two matrices element wise. Returns true if the size of both matrices is equal and when and each of the elements are equal.",examples:["deepEqual([1,3,4], [1,3,4])","deepEqual([1,3,4], [1,3])"],seealso:["equal","unequal","smaller","larger","smallerEq","largerEq","compare"]},equal:{name:"equal",category:"Relational",syntax:["x == y","equal(x, y)"],description:"Check equality of two values. Returns true if the values are equal, and false if not.",examples:["2+2 == 3","2+2 == 4","a = 3.2","b = 6-2.8","a == b","50cm == 0.5m"],seealso:["unequal","smaller","larger","smallerEq","largerEq","compare","deepEqual","equalText"]},equalText:{name:"equalText",category:"Relational",syntax:["equalText(x, y)"],description:"Check equality of two strings. Comparison is case sensitive. Returns true if the values are equal, and false if not.",examples:['equalText("Hello", "Hello")','equalText("a", "A")','equal("2e3", "2000")','equalText("2e3", "2000")','equalText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural","compareText","equal"]},larger:{name:"larger",category:"Relational",syntax:["x > y","larger(x, y)"],description:"Check if value x is larger than y. Returns true if x is larger than y, and false if not. Comparing a value with NaN returns false.",examples:["2 > 3","5 > 2*2","a = 3.3","b = 6-2.8","(a > b)","(b < a)","5 cm > 2 inch"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare"]},largerEq:{name:"largerEq",category:"Relational",syntax:["x >= y","largerEq(x, y)"],description:"Check if value x is larger or equal to y. Returns true if x is larger or equal to y, and false if not.",examples:["2 >= 1+1","2 > 1+1","a = 3.2","b = 6-2.8","(a >= b)"],seealso:["equal","unequal","smallerEq","smaller","compare"]},smaller:{name:"smaller",category:"Relational",syntax:["x < y","smaller(x, y)"],description:"Check if value x is smaller than value y. Returns true if x is smaller than y, and false if not. Comparing a value with NaN returns false.",examples:["2 < 3","5 < 2*2","a = 3.3","b = 6-2.8","(a < b)","5 cm < 2 inch"],seealso:["equal","unequal","larger","smallerEq","largerEq","compare"]},smallerEq:{name:"smallerEq",category:"Relational",syntax:["x <= y","smallerEq(x, y)"],description:"Check if value x is smaller or equal to value y. Returns true if x is smaller than y, and false if not.",examples:["2 <= 1+1","2 < 1+1","a = 3.2","b = 6-2.8","(a <= b)"],seealso:["equal","unequal","larger","smaller","largerEq","compare"]},unequal:{name:"unequal",category:"Relational",syntax:["x != y","unequal(x, y)"],description:"Check unequality of two values. Returns true if the values are unequal, and false if they are equal.",examples:["2+2 != 3","2+2 != 4","a = 3.2","b = 6-2.8","a != b","50cm != 0.5m","5 cm != 2 inch"],seealso:["equal","smaller","larger","smallerEq","largerEq","compare","deepEqual"]},setCartesian:{name:"setCartesian",category:"Set",syntax:["setCartesian(set1, set2)"],description:"Create the cartesian product of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays and the values will be sorted in ascending order before the operation.",examples:["setCartesian([1, 2], [3, 4])"],seealso:["setUnion","setIntersect","setDifference","setPowerset"]},setDifference:{name:"setDifference",category:"Set",syntax:["setDifference(set1, set2)"],description:"Create the difference of two (multi)sets: every element of set1, that is not the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setDifference([1, 2, 3, 4], [3, 4, 5, 6])","setDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setSymDifference"]},setDistinct:{name:"setDistinct",category:"Set",syntax:["setDistinct(set)"],description:"Collect the distinct elements of a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setDistinct([1, 1, 1, 2, 2, 3])"],seealso:["setMultiplicity"]},setIntersect:{name:"setIntersect",category:"Set",syntax:["setIntersect(set1, set2)"],description:"Create the intersection of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIntersect([1, 2, 3, 4], [3, 4, 5, 6])","setIntersect([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setDifference"]},setIsSubset:{name:"setIsSubset",category:"Set",syntax:["setIsSubset(set1, set2)"],description:"Check whether a (multi)set is a subset of another (multi)set: every element of set1 is the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIsSubset([1, 2], [3, 4, 5, 6])","setIsSubset([3, 4], [3, 4, 5, 6])"],seealso:["setUnion","setIntersect","setDifference"]},setMultiplicity:{name:"setMultiplicity",category:"Set",syntax:["setMultiplicity(element, set)"],description:"Count the multiplicity of an element in a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setMultiplicity(1, [1, 2, 2, 4])","setMultiplicity(2, [1, 2, 2, 4])"],seealso:["setDistinct","setSize"]},setPowerset:{name:"setPowerset",category:"Set",syntax:["setPowerset(set)"],description:"Create the powerset of a (multi)set: the powerset contains very possible subsets of a (multi)set. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setPowerset([1, 2, 3])"],seealso:["setCartesian"]},setSize:{name:"setSize",category:"Set",syntax:["setSize(set)","setSize(set, unique)"],description:'Count the number of elements of a (multi)set. When the second parameter "unique" is true, count only the unique values. A multi-dimension array will be converted to a single-dimension array before the operation.',examples:["setSize([1, 2, 2, 4])","setSize([1, 2, 2, 4], true)"],seealso:["setUnion","setIntersect","setDifference"]},setSymDifference:{name:"setSymDifference",category:"Set",syntax:["setSymDifference(set1, set2)"],description:"Create the symmetric difference of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setSymDifference([1, 2, 3, 4], [3, 4, 5, 6])","setSymDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setDifference"]},setUnion:{name:"setUnion",category:"Set",syntax:["setUnion(set1, set2)"],description:"Create the union of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setUnion([1, 2, 3, 4], [3, 4, 5, 6])","setUnion([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setIntersect","setDifference"]},zpk2tf:{name:"zpk2tf",category:"Signal",syntax:["zpk2tf(z, p, k)"],description:"Compute the transfer function of a zero-pole-gain model.",examples:["zpk2tf([1, 2], [-1, -2], 1)","zpk2tf([1, 2], [-1, -2])","zpk2tf([1 - 3i, 2 + 2i], [-1, -2])"],seealso:[]},freqz:{name:"freqz",category:"Signal",syntax:["freqz(b, a)","freqz(b, a, w)"],description:"Calculates the frequency response of a filter given its numerator and denominator coefficients.",examples:["freqz([1, 2], [1, 2, 3])","freqz([1, 2], [1, 2, 3], [0, 1])","freqz([1, 2], [1, 2, 3], 512)"],seealso:[]},erf:{name:"erf",category:"Special",syntax:["erf(x)"],description:"Compute the erf function of a value using a rational Chebyshev approximations for different intervals of x",examples:["erf(0.2)","erf(-0.5)","erf(4)"],seealso:[]},zeta:{name:"zeta",category:"Special",syntax:["zeta(s)"],description:"Compute the Riemann Zeta Function using an infinite series and Riemann's Functional Equation for the entire complex plane",examples:["zeta(0.2)","zeta(-0.5)","zeta(4)"],seealso:[]},cumsum:{name:"cumsum",category:"Statistics",syntax:["cumsum(a, b, c, ...)","cumsum(A)"],description:"Compute the cumulative sum of all values.",examples:["cumsum(2, 3, 4, 1)","cumsum([2, 3, 4, 1])","cumsum([1, 2; 3, 4])","cumsum([1, 2; 3, 4], 1)","cumsum([1, 2; 3, 4], 2)"],seealso:["max","mean","median","min","prod","std","sum","variance"]},mad:{name:"mad",category:"Statistics",syntax:["mad(a, b, c, ...)","mad(A)"],description:"Compute the median absolute deviation of a matrix or a list with values. The median absolute deviation is defined as the median of the absolute deviations from the median.",examples:["mad(10, 20, 30)","mad([1, 2, 3])"],seealso:["mean","median","std","abs"]},max:{name:"max",category:"Statistics",syntax:["max(a, b, c, ...)","max(A)","max(A, dimension)"],description:"Compute the maximum value of a list of values. If any NaN values are found, the function yields the last NaN in the input.",examples:["max(2, 3, 4, 1)","max([2, 3, 4, 1])","max([2, 5; 4, 3])","max([2, 5; 4, 3], 1)","max([2, 5; 4, 3], 2)","max(2.7, 7.1, -4.5, 2.0, 4.1)","min(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["mean","median","min","prod","std","sum","variance"]},mean:{name:"mean",category:"Statistics",syntax:["mean(a, b, c, ...)","mean(A)","mean(A, dimension)"],description:"Compute the arithmetic mean of a list of values.",examples:["mean(2, 3, 4, 1)","mean([2, 3, 4, 1])","mean([2, 5; 4, 3])","mean([2, 5; 4, 3], 1)","mean([2, 5; 4, 3], 2)","mean([1.0, 2.7, 3.2, 4.0])"],seealso:["max","median","min","prod","std","sum","variance"]},median:{name:"median",category:"Statistics",syntax:["median(a, b, c, ...)","median(A)"],description:"Compute the median of all values. The values are sorted and the middle value is returned. In case of an even number of values, the average of the two middle values is returned.",examples:["median(5, 2, 7)","median([3, -1, 5, 7])"],seealso:["max","mean","min","prod","std","sum","variance","quantileSeq"]},min:{name:"min",category:"Statistics",syntax:["min(a, b, c, ...)","min(A)","min(A, dimension)"],description:"Compute the minimum value of a list of values. If any NaN values are found, the function yields the last NaN in the input.",examples:["min(2, 3, 4, 1)","min([2, 3, 4, 1])","min([2, 5; 4, 3])","min([2, 5; 4, 3], 1)","min([2, 5; 4, 3], 2)","min(2.7, 7.1, -4.5, 2.0, 4.1)","max(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["max","mean","median","prod","std","sum","variance"]},mode:{name:"mode",category:"Statistics",syntax:["mode(a, b, c, ...)","mode(A)","mode(A, a, b, B, c, ...)"],description:"Computes the mode of all values as an array. In case mode being more than one, multiple values are returned in an array.",examples:["mode(2, 1, 4, 3, 1)","mode([1, 2.7, 3.2, 4, 2.7])","mode(1, 4, 6, 1, 6)"],seealso:["max","mean","min","median","prod","std","sum","variance"]},prod:{name:"prod",category:"Statistics",syntax:["prod(a, b, c, ...)","prod(A)"],description:"Compute the product of all values.",examples:["prod(2, 3, 4)","prod([2, 3, 4])","prod([2, 5; 4, 3])"],seealso:["max","mean","min","median","min","std","sum","variance"]},quantileSeq:{name:"quantileSeq",category:"Statistics",syntax:["quantileSeq(A, prob[, sorted])","quantileSeq(A, [prob1, prob2, ...][, sorted])","quantileSeq(A, N[, sorted])"],description:"Compute the prob order quantile of a matrix or a list with values. The sequence is sorted and the middle value is returned. Supported types of sequence values are: Number, BigNumber, Unit Supported types of probability are: Number, BigNumber. \n\nIn case of a (multi dimensional) array or matrix, the prob order quantile of all elements will be calculated.",examples:["quantileSeq([3, -1, 5, 7], 0.5)","quantileSeq([3, -1, 5, 7], [1/3, 2/3])","quantileSeq([3, -1, 5, 7], 2)","quantileSeq([-1, 3, 5, 7], 0.5, true)"],seealso:["mean","median","min","max","prod","std","sum","variance"]},std:{name:"std",category:"Statistics",syntax:["std(a, b, c, ...)","std(A)","std(A, dimension)","std(A, normalization)","std(A, dimension, normalization)"],description:'Compute the standard deviation of all values, defined as std(A) = sqrt(variance(A)). Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["std(2, 4, 6)","std([2, 4, 6, 8])",'std([2, 4, 6, 8], "uncorrected")','std([2, 4, 6, 8], "biased")',"std([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","prod","sum","variance"]},sum:{name:"sum",category:"Statistics",syntax:["sum(a, b, c, ...)","sum(A)","sum(A, dimension)"],description:"Compute the sum of all values.",examples:["sum(2, 3, 4, 1)","sum([2, 3, 4, 1])","sum([2, 5; 4, 3])"],seealso:["max","mean","median","min","prod","std","variance"]},variance:{name:"variance",category:"Statistics",syntax:["variance(a, b, c, ...)","variance(A)","variance(A, dimension)","variance(A, normalization)","variance(A, dimension, normalization)"],description:'Compute the variance of all values. Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["variance(2, 4, 6)","variance([2, 4, 6, 8])",'variance([2, 4, 6, 8], "uncorrected")','variance([2, 4, 6, 8], "biased")',"variance([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","std","sum"]},corr:{name:"corr",category:"Statistics",syntax:["corr(A,B)"],description:"Compute the correlation coefficient of a two list with values, For matrices, the matrix correlation coefficient is calculated.",examples:["corr([2, 4, 6, 8],[1, 2, 3, 6])","corr(matrix([[1, 2.2, 3, 4.8, 5], [1, 2, 3, 4, 5]]), matrix([[4, 5.3, 6.6, 7, 8], [1, 2, 3, 4, 5]]))"],seealso:["max","mean","min","median","min","prod","std","sum"]},acos:{name:"acos",category:"Trigonometry",syntax:["acos(x)"],description:"Compute the inverse cosine of a value in radians.",examples:["acos(0.5)","acos(cos(2.3))"],seealso:["cos","atan","asin"]},acosh:{name:"acosh",category:"Trigonometry",syntax:["acosh(x)"],description:"Calculate the hyperbolic arccos of a value, defined as `acosh(x) = ln(sqrt(x^2 - 1) + x)`.",examples:["acosh(1.5)"],seealso:["cosh","asinh","atanh"]},acot:{name:"acot",category:"Trigonometry",syntax:["acot(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acot(0.5)","acot(cot(0.5))","acot(2)"],seealso:["cot","atan"]},acoth:{name:"acoth",category:"Trigonometry",syntax:["acoth(x)"],description:"Calculate the inverse hyperbolic tangent of a value, defined as `acoth(x) = (ln((x+1)/x) + ln(x/(x-1))) / 2`.",examples:["acoth(2)","acoth(0.5)"],seealso:["acsch","asech"]},acsc:{name:"acsc",category:"Trigonometry",syntax:["acsc(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acsc(2)","acsc(csc(0.5))","acsc(0.5)"],seealso:["csc","asin","asec"]},acsch:{name:"acsch",category:"Trigonometry",syntax:["acsch(x)"],description:"Calculate the inverse hyperbolic cosecant of a value, defined as `acsch(x) = ln(1/x + sqrt(1/x^2 + 1))`.",examples:["acsch(0.5)"],seealso:["asech","acoth"]},asec:{name:"asec",category:"Trigonometry",syntax:["asec(x)"],description:"Calculate the inverse secant of a value.",examples:["asec(0.5)","asec(sec(0.5))","asec(2)"],seealso:["acos","acot","acsc"]},asech:{name:"asech",category:"Trigonometry",syntax:["asech(x)"],description:"Calculate the inverse secant of a value.",examples:["asech(0.5)"],seealso:["acsch","acoth"]},asin:{name:"asin",category:"Trigonometry",syntax:["asin(x)"],description:"Compute the inverse sine of a value in radians.",examples:["asin(0.5)","asin(sin(0.5))"],seealso:["sin","acos","atan"]},asinh:{name:"asinh",category:"Trigonometry",syntax:["asinh(x)"],description:"Calculate the hyperbolic arcsine of a value, defined as `asinh(x) = ln(x + sqrt(x^2 + 1))`.",examples:["asinh(0.5)"],seealso:["acosh","atanh"]},atan:{name:"atan",category:"Trigonometry",syntax:["atan(x)"],description:"Compute the inverse tangent of a value in radians.",examples:["atan(0.5)","atan(tan(0.5))"],seealso:["tan","acos","asin"]},atanh:{name:"atanh",category:"Trigonometry",syntax:["atanh(x)"],description:"Calculate the hyperbolic arctangent of a value, defined as `atanh(x) = ln((1 + x)/(1 - x)) / 2`.",examples:["atanh(0.5)"],seealso:["acosh","asinh"]},atan2:{name:"atan2",category:"Trigonometry",syntax:["atan2(y, x)"],description:"Computes the principal value of the arc tangent of y/x in radians.",examples:["atan2(2, 2) / pi","angle = 60 deg in rad","x = cos(angle)","y = sin(angle)","atan2(y, x)"],seealso:["sin","cos","tan"]},cos:{name:"cos",category:"Trigonometry",syntax:["cos(x)"],description:"Compute the cosine of x in radians.",examples:["cos(2)","cos(pi / 4) ^ 2","cos(180 deg)","cos(60 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["acos","sin","tan"]},cosh:{name:"cosh",category:"Trigonometry",syntax:["cosh(x)"],description:"Compute the hyperbolic cosine of x in radians.",examples:["cosh(0.5)"],seealso:["sinh","tanh","coth"]},cot:{name:"cot",category:"Trigonometry",syntax:["cot(x)"],description:"Compute the cotangent of x in radians. Defined as 1/tan(x)",examples:["cot(2)","1 / tan(2)"],seealso:["sec","csc","tan"]},coth:{name:"coth",category:"Trigonometry",syntax:["coth(x)"],description:"Compute the hyperbolic cotangent of x in radians.",examples:["coth(2)","1 / tanh(2)"],seealso:["sech","csch","tanh"]},csc:{name:"csc",category:"Trigonometry",syntax:["csc(x)"],description:"Compute the cosecant of x in radians. Defined as 1/sin(x)",examples:["csc(2)","1 / sin(2)"],seealso:["sec","cot","sin"]},csch:{name:"csch",category:"Trigonometry",syntax:["csch(x)"],description:"Compute the hyperbolic cosecant of x in radians. Defined as 1/sinh(x)",examples:["csch(2)","1 / sinh(2)"],seealso:["sech","coth","sinh"]},sec:{name:"sec",category:"Trigonometry",syntax:["sec(x)"],description:"Compute the secant of x in radians. Defined as 1/cos(x)",examples:["sec(2)","1 / cos(2)"],seealso:["cot","csc","cos"]},sech:{name:"sech",category:"Trigonometry",syntax:["sech(x)"],description:"Compute the hyperbolic secant of x in radians. Defined as 1/cosh(x)",examples:["sech(2)","1 / cosh(2)"],seealso:["coth","csch","cosh"]},sin:{name:"sin",category:"Trigonometry",syntax:["sin(x)"],description:"Compute the sine of x in radians.",examples:["sin(2)","sin(pi / 4) ^ 2","sin(90 deg)","sin(30 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["asin","cos","tan"]},sinh:{name:"sinh",category:"Trigonometry",syntax:["sinh(x)"],description:"Compute the hyperbolic sine of x in radians.",examples:["sinh(0.5)"],seealso:["cosh","tanh"]},tan:{name:"tan",category:"Trigonometry",syntax:["tan(x)"],description:"Compute the tangent of x in radians.",examples:["tan(0.5)","sin(0.5) / cos(0.5)","tan(pi / 4)","tan(45 deg)"],seealso:["atan","sin","cos"]},tanh:{name:"tanh",category:"Trigonometry",syntax:["tanh(x)"],description:"Compute the hyperbolic tangent of x in radians.",examples:["tanh(0.5)","sinh(0.5) / cosh(0.5)"],seealso:["sinh","cosh"]},to:{name:"to",category:"Units",syntax:["x to unit","to(x, unit)"],description:"Change the unit of a value.",examples:["5 inch to cm","3.2kg to g","16 bytes in bits"],seealso:[]},toBest:{name:"toBest",category:"Units",syntax:["toBest(x)","toBest(x, unitList)","toBest(x, unitList, options)"],description:"Converts to the most appropriate display unit.",examples:['toBest(unit(5000, "m"))','toBest(unit(3500000, "W"))','toBest(unit(0.000000123, "A"))','toBest(unit(10, "m"), "cm")','toBest(unit(10, "m"), "mm,km", {offset: 1.5})'],seealso:[]},clone:{name:"clone",category:"Utils",syntax:["clone(x)"],description:"Clone a variable. Creates a copy of primitive variables, and a deep copy of matrices",examples:["clone(3.5)","clone(2 - 4i)","clone(45 deg)","clone([1, 2; 3, 4])",'clone("hello world")'],seealso:[]},format:{name:"format",category:"Utils",syntax:["format(value)","format(value, precision)"],description:"Format a value of any type as string.",examples:["format(2.3)","format(3 - 4i)","format([])","format(pi, 3)"],seealso:["print"]},bin:{name:"bin",category:"Utils",syntax:["bin(value)"],description:"Format a number as binary",examples:["bin(2)"],seealso:["oct","hex"]},oct:{name:"oct",category:"Utils",syntax:["oct(value)"],description:"Format a number as octal",examples:["oct(56)"],seealso:["bin","hex"]},hex:{name:"hex",category:"Utils",syntax:["hex(value)"],description:"Format a number as hexadecimal",examples:["hex(240)"],seealso:["bin","oct"]},isNaN:{name:"isNaN",category:"Utils",syntax:["isNaN(x)"],description:"Test whether a value is NaN (not a number)",examples:["isNaN(2)","isNaN(0 / 0)","isNaN(NaN)","isNaN(Infinity)"],seealso:["isNegative","isNumeric","isPositive","isZero"]},isInteger:{name:"isInteger",category:"Utils",syntax:["isInteger(x)"],description:"Test whether a value is an integer number.",examples:["isInteger(2)","isInteger(3.5)","isInteger([3, 0.5, -2])"],seealso:["isNegative","isNumeric","isPositive","isZero"]},isNegative:{name:"isNegative",category:"Utils",syntax:["isNegative(x)"],description:"Test whether a value is negative: smaller than zero.",examples:["isNegative(2)","isNegative(0)","isNegative(-4)","isNegative([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isPositive","isZero"]},isNumeric:{name:"isNumeric",category:"Utils",syntax:["isNumeric(x)"],description:"Test whether a value is a numeric value. Returns true when the input is a number, BigNumber, Fraction, or boolean.",examples:["isNumeric(2)",'isNumeric("2")','hasNumericValue("2")',"isNumeric(0)","isNumeric(bignumber(500))","isNumeric(fraction(0.125))","isNumeric(2 + 3i)",'isNumeric([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN","hasNumericValue"]},hasNumericValue:{name:"hasNumericValue",category:"Utils",syntax:["hasNumericValue(x)"],description:"Test whether a value is an numeric value. In case of a string, true is returned if the string contains a numeric value.",examples:["hasNumericValue(2)",'hasNumericValue("2")','isNumeric("2")',"hasNumericValue(0)","hasNumericValue(bignumber(500))","hasNumericValue(fraction(0.125))","hasNumericValue(2 + 3i)",'hasNumericValue([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN","isNumeric"]},isPositive:{name:"isPositive",category:"Utils",syntax:["isPositive(x)"],description:"Test whether a value is positive: larger than zero.",examples:["isPositive(2)","isPositive(0)","isPositive(-4)","isPositive([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},isPrime:{name:"isPrime",category:"Utils",syntax:["isPrime(x)"],description:"Test whether a value is prime: has no divisors other than itself and one.",examples:["isPrime(3)","isPrime(-2)","isPrime([2, 17, 100])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},isZero:{name:"isZero",category:"Utils",syntax:["isZero(x)"],description:"Test whether a value is zero.",examples:["isZero(2)","isZero(0)","isZero(-4)","isZero([3, 0, -2, 0])"],seealso:["isInteger","isNumeric","isNegative","isPositive"]},print:{name:"print",category:"Utils",syntax:["print(template, values)","print(template, values, precision)"],description:"Interpolate values into a string template.",examples:['print("Lucy is $age years old", {age: 5})','print("The value of pi is $pi", {pi: pi}, 3)','print("Hello, $user.name!", {user: {name: "John"}})','print("Values: $1, $2, $3", [6, 9, 4])'],seealso:["format"]},typeOf:{name:"typeOf",category:"Utils",syntax:["typeOf(x)"],description:"Get the type of a variable.",examples:["typeOf(3.5)","typeOf(2 - 4i)","typeOf(45 deg)",'typeOf("hello world")'],seealso:["getMatrixDataType"]},numeric:{name:"numeric",category:"Utils",syntax:["numeric(x)"],description:"Convert a numeric input to a specific numeric type: number, BigNumber, bigint, or Fraction.",examples:['numeric("4")','numeric("4", "number")','numeric("4", "bigint")','numeric("4", "BigNumber")','numeric("4", "Fraction")','numeric(4, "Fraction")','numeric(fraction(2, 5), "number")'],seealso:["number","bigint","fraction","bignumber","string","format"]}},Np="help",Tp=vh(Np,["typed","mathWithTransform","Help"],e=>{var{typed:t,mathWithTransform:n,Help:r}=e;return t(Np,{any:function(e){var t,i=e;if("string"!==typeof e)for(t in n)if(pd(n,t)&&e===n[t]){i=t;break}var o=gd(Ep,i);if(!o){var a="function"===typeof i?i.name:i;throw new Error('No documentation found on "'+a+'"')}return new r(o)}})}),Ap="mapSlices",Rp=vh(Ap,["typed","isInteger"],e=>{var{typed:t,isInteger:n}=e;return t(Ap,{"Array | Matrix, number | BigNumber, function":function(e,t,r){if(!n(t))throw new TypeError("Integer number expected for dimension");var i=Array.isArray(e)?sf(e):e.size();if(t<0||t>=i.length)throw new af(t,i.length);return Pd(e)?e.create(kp(e.valueOf(),t,r),e.datatype()):kp(e,t,r)}})},{formerly:"apply"});function kp(e,t,n){var r,i,o;if(t<=0){if(Array.isArray(e[0])){for(o=function(e){var t,n,r=e.length,i=e[0].length,o=[];for(n=0;n<i;n++){var a=[];for(t=0;t<r;t++)a.push(e[t][n]);o.push(a)}return o}(e),i=[],r=0;r<o.length;r++)i[r]=kp(o[r],t-1,n);return i}return n(e)}for(i=[],r=0;r<e.length;r++)i[r]=kp(e[r],t-1,n);return i}function Mp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var Dp=vh("mapSlices",["typed","isInteger"],e=>{var{typed:t,isInteger:n}=e,r=Rp({typed:t,isInteger:n});return t("mapSlices",{"...any":function(e){var t=e[1];Ad(t)?e[1]=t-1:Rd(t)&&(e[1]=t.minus(1));try{return r.apply(null,e)}catch(n){throw Cm(n)}}})},function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mp(Object(n),!0).forEach(function(t){S(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mp(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({isTransformFunction:!0},Rp.meta)),_p=n(5422);function Op(e,t,n,r){if(_p.isTypedFunction(e)){var i,o;if(r)i=1;else{var a=(t.isMatrix?t.size():sf(t)).map(()=>0),s=t.isMatrix?t.get(a):Ff(t,a);i=function(e,t,n,r){for(var i=[t,n,r],o=3;o>0;o--){var a=i.slice(0,o);if(null!==_p.resolve(e,a))return o}}(e,s,a,t)}if(t.isMatrix&&"mixed"!==t.dataType&&void 0!==t.dataType){var l=function(e,t){var n=[];if(Object.entries(e.signatures).forEach(e=>{var[r,i]=e;r.split(",").length===t&&n.push(i)}),1===n.length)return n[0]}(e,i);o=void 0!==l?l:e}else o=e;return i>=1&&i<=3?{isUnary:1===i,fn:function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return Pp(o,r.slice(0,i),n,e.name)}}:{isUnary:!1,fn:function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return Pp(o,r,n,e.name)}}}return void 0===r?{isUnary:Ip(e),fn:e}:{isUnary:r,fn:e}}function Ip(e){if(1!==e.length)return!1;var t=e.toString();if(/arguments/.test(t))return!1;var n=t.match(/\(.*?\)/);return!/\.\.\./.test(n)}function Pp(e,t,n,r){try{return e(...t)}catch(i){!function(e,t,n,r){var i;if(e instanceof TypeError&&"wrongType"===(null===(i=e.data)||void 0===i?void 0:i.category)){var o=[];throw o.push("value: ".concat(ph(t[0]))),t.length>=2&&o.push("index: ".concat(ph(t[1]))),t.length>=3&&o.push("array: ".concat(ph(t[2]))),new TypeError("Function ".concat(n," cannot apply callback arguments ")+"".concat(r,"(").concat(o.join(", "),") at index ").concat(JSON.stringify(t[1])))}throw new TypeError("Function ".concat(n," cannot apply callback arguments ")+"to function ".concat(r,": ").concat(e.message))}(i,t,n,r)}}var jp=vh("filter",["typed"],e=>{var{typed:t}=e;return t("filter",{"Array, function":Fp,"Matrix, function":function(e,t){return e.create(Fp(e.valueOf(),t),e.datatype())},"Array, RegExp":Tf,"Matrix, RegExp":function(e,t){return e.create(Tf(e.valueOf(),t),e.datatype())}})});function Fp(e,t){var n=Op(t,e,"filter");return n.isUnary?Nf(e,n.fn):Nf(e,function(e,t,r){return n.fn(e,[t],r)})}function Hp(e,t,n){var r=e.filter(function(e){return fh(e)&&!(e.name in t)&&!n.has(e.name)})[0];if(!r)throw new Error('No undefined variable found in inline expression "'+e+'"');var i=r.name,o=new Map,a=new Cd(n,o,new Set([i])),s=e.compile();return function(e){return o.set(i,e),s.evaluate(a)}}var Lp=vh("transformCallback",["typed"],e=>{var{typed:t}=e;return function(e,r){return t.isTypedFunction(e)?n(e,r):Bp(e,e.length,r)};function n(e,r){var i=Object.fromEntries(Object.entries(e.signatures).map(e=>{var[i,o]=e,a=i.split(",").length;return t.isTypedFunction(o)?[i,n(o,r)]:[i,Bp(o,a,r)]}));return"string"===typeof e.name?t(e.name,i):t(i)}});function Bp(e,t,n){return t===n?e:t===n+1?function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var o=r.slice(0,n),a=zp(r[n]);return e(...o,a)}:t>n+1?function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var o=r.slice(0,n),a=zp(r[n]),s=r.slice(n+1);return e(...o,a,...s)}:e}function zp(e){return e.map(e=>e+1)}var Wp=vh("filter",["typed"],e=>{var{typed:t}=e;function n(e,n,i){var o=jp({typed:t}),a=Lp({typed:t});if(0===e.length)return o();var s=e[0];if(1===e.length)return o(s);var l=e.length-1,c=e[l];return s&&(s=r(s,i)),c&&(c=fh(c)||ih(c)?r(c,i):Hp(c,n,i)),o(s,a(c,l))}function r(e,t){return e.compile().evaluate(t)}return n.rawArgs=!0,n},{isTransformFunction:!0}),Vp="forEach",Up=vh(Vp,["typed"],e=>{var{typed:t}=e;return t(Vp,{"Array, function":qp,"Matrix, function":function(e,t){e.forEach(t)}})});function qp(e,t){var n=Op(t,e,Vp);Lf(e,n.fn,n.isUnary)}var Gp=vh("forEach",["typed"],e=>{var{typed:t}=e,n=Up({typed:t}),r=Lp({typed:t});function i(e,t,i){if(0===e.length)return n();var a=e[0];if(1===e.length)return n(a);var s=e.length-1,l=e[s];return a&&(a=o(a,i)),l&&(l=fh(l)||ih(l)?o(l,i):Hp(l,t,i)),n(a,r(l,s))}function o(e,t){return e.compile().evaluate(t)}return i.rawArgs=!0,i},{isTransformFunction:!0}),Yp="map",Kp=vh(Yp,["typed"],e=>{var{typed:t}=e;return t(Yp,{"Array, function":r,"Matrix, function":function(e,t){return e.map(t)},"Array|Matrix, Array|Matrix, ...Array|Matrix|function":(e,i,o)=>function(e,i){if("function"!==typeof i)throw new Error("Last argument must be a callback function");var o=e[0].isMatrix,a=e.map(e=>e.isMatrix?e.size():sf(e)),s=Of(...a),l=e.length,c=o?(e,t)=>e.get(t):Ff,u=e.map((e,t)=>{var n=a[t].map(()=>0);return e.isMatrix?e.get(n):Ff(e,n)}),d=t.isTypedFunction(i)?function(e,n,r,i){if(null!==t.resolve(e,[...n,r,...i]))return 2;if(null!==t.resolve(e,[...n,r]))return 1;if(null!==t.resolve(e,n))return 0;return 0}(i,u,s.map(()=>0),e):function(e,t){var n=e.toString();if(/arguments/.test(n))return 2;var r=n.match(/\(.*?\)/);if(/\.\.\./.test(r))return 2;if(e.length>t+1)return 2;if(e.length===t+1)return 1;return 0}(i,l);if(d<2){var h=n(d,i,null);return function(e,t){var n=e[0],r=e.map(e=>e.isMatrix?e.valueOf():e),i=e.map(e=>e.isMatrix?e.size():sf(e)),o=Of(...i),a=i.map(e=>o.length-e.length),s=o.length-1,l=t.length>1,c=l?[]:null,u=h(r,0);if(n.isMatrix){var d=n.create();return d._data=u,d._size=o,d}return u;function h(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=o[n],i=Array(r);if(n<s)for(var l=function(t){c&&(c[n]=t),i[t]=h(e.map((e,r)=>a[r]>n?e:1===e.length?e[0]:e[t]),n+1)},u=0;u<r;u++)l(u);else for(var d=function(r){c&&(c[n]=r),i[r]=t(e.map(e=>1===e.length?e[0]:e[r]),c?c.slice():void 0)},f=0;f<r;f++)d(f);return i}}(e,h)}var f=o?e.map(t=>t.isMatrix?t.create(Pf(t.toArray(),s),t.datatype()):e[0].create(Pf(t.valueOf(),s))):e.map(e=>e.isMatrix?Pf(e.toArray(),s):Pf(e,s)),m=n(d,i,f),p=(e,t)=>m([e,...f.slice(1).map(e=>c(e,t))],t);return o?f[0].map(p):r(f[0],p)}([e,i,...o.slice(0,o.length-1)],o[o.length-1])});function n(e,t,n){switch(e){case 0:return e=>t(...e);case 1:return(e,n)=>t(...e,n);case 2:return(e,r)=>t(...e,r,...n)}}function r(e,t){var n=Op(t,e,Yp);return Hf(e,n.fn,n.isUnary)}}),$p=vh("map",["typed"],e=>{var{typed:t}=e,n=Kp({typed:t}),r=Lp({typed:t});function i(e,t,i){if(0===e.length)return n();if(1===e.length)return n(e[0]);var o=e.length-1,a=e.slice(0,o),s=e[o];return a=a.map(e=>l(e,i)),s&&(s=fh(s)||ih(s)?l(s,i):Hp(s,t,i)),n(...a,r(s,o));function l(e,t){return e.compile().evaluate(t)}}return i.rawArgs=!0,i},{isTransformFunction:!0}),Xp=vh("matAlgo03xDSf",["typed"],e=>{var{typed:t}=e;return function(e,n,r,i){var o=e._data,a=e._size,s=e._datatype||e.getDataType(),l=n._values,c=n._index,u=n._ptr,d=n._size,h=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(a.length!==d.length)throw new of(a.length,d.length);if(a[0]!==d[0]||a[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+d+")");if(!l)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var f,m=a[0],p=a[1],g=0,v=r;"string"===typeof s&&s===h&&"mixed"!==s&&(f=s,g=t.convert(0,f),v=t.find(r,[f,f]));for(var y=[],b=0;b<m;b++)y[b]=[];for(var w=[],x=[],S=0;S<p;S++){for(var C=S+1,E=u[S],N=u[S+1],T=E;T<N;T++){var A=c[T];w[A]=i?v(l[T],o[A][S]):v(o[A][S],l[T]),x[A]=C}for(var R=0;R<m;R++)x[R]===C?y[R][S]=w[R]:y[R][S]=i?v(g,o[R][S]):v(o[R][S],g)}return e.createDenseMatrix({data:y,size:[m,p],datatype:s===e._datatype&&h===n._datatype?f:void 0})}}),Qp=vh("matAlgo12xSfs",["typed","DenseMatrix"],e=>{var{typed:t,DenseMatrix:n}=e;return function(e,r,i,o){var a=e._values,s=e._index,l=e._ptr,c=e._size,u=e._datatype;if(!a)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var d,h=c[0],f=c[1],m=i;"string"===typeof u&&(d=u,r=t.convert(r,d),m=t.find(i,[d,d]));for(var p=[],g=[],v=[],y=0;y<f;y++){for(var b=y+1,w=l[y],x=l[y+1],S=w;S<x;S++){var C=s[S];g[C]=a[S],v[C]=b}for(var E=0;E<h;E++)0===y&&(p[E]=[]),v[E]===b?p[E][y]=o?m(r,g[E]):m(g[E],r):p[E][y]=o?m(r,0):m(0,r)}return new n({data:p,size:[h,f],datatype:d})}}),Jp=vh("matAlgo05xSfSf",["typed","equalScalar"],e=>{var{typed:t,equalScalar:n}=e;return function(e,r,i){var o=e._values,a=e._index,s=e._ptr,l=e._size,c=e._datatype||void 0===e._data?e._datatype:e.getDataType(),u=r._values,d=r._index,h=r._ptr,f=r._size,m=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(l.length!==f.length)throw new of(l.length,f.length);if(l[0]!==f[0]||l[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+f+")");var p,g=l[0],v=l[1],y=n,b=0,w=i;"string"===typeof c&&c===m&&"mixed"!==c&&(p=c,y=t.find(n,[p,p]),b=t.convert(0,p),w=t.find(i,[p,p]));var x,S,C,E,N=o&&u?[]:void 0,T=[],A=[],R=N?[]:void 0,k=N?[]:void 0,M=[],D=[];for(S=0;S<v;S++){A[S]=T.length;var _=S+1;for(C=s[S],E=s[S+1];C<E;C++)x=a[C],T.push(x),M[x]=_,R&&(R[x]=o[C]);for(C=h[S],E=h[S+1];C<E;C++)M[x=d[C]]!==_&&T.push(x),D[x]=_,k&&(k[x]=u[C]);if(N)for(C=A[S];C<T.length;){var O=M[x=T[C]],I=D[x];if(O===_||I===_){var P=w(O===_?R[x]:b,I===_?k[x]:b);y(P,b)?T.splice(C,1):(N.push(P),C++)}}}return A[v]=T.length,e.createSparseMatrix({values:N,index:T,ptr:A,size:[g,v],datatype:c===e._datatype&&m===r._datatype?p:void 0})}}),Zp=vh("matAlgo13xDD",["typed"],e=>{var{typed:t}=e;return function(e,r,i){var o,a=e._data,s=e._size,l=e._datatype,c=r._data,u=r._size,d=r._datatype,h=[];if(s.length!==u.length)throw new of(s.length,u.length);for(var f=0;f<s.length;f++){if(s[f]!==u[f])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+u+")");h[f]=s[f]}var m=i;"string"===typeof l&&l===d&&(o=l,m=t.find(i,[o,o]));var p=h.length>0?n(m,0,h,h[0],a,c):[];return e.createDenseMatrix({data:p,size:h,datatype:o})};function n(e,t,r,i,o,a){var s=[];if(t===r.length-1)for(var l=0;l<i;l++)s[l]=e(o[l],a[l]);else for(var c=0;c<i;c++)s[c]=n(e,t+1,r,r[t+1],o[c],a[c]);return s}}),eg=vh("matAlgo14xDs",["typed"],e=>{var{typed:t}=e;return function(e,r,i,o){var a,s=e._data,l=e._size,c=e._datatype,u=i;"string"===typeof c&&(a=c,r=t.convert(r,a),u=t.find(i,[a,a]));var d=l.length>0?n(u,0,l,l[0],s,r,o):[];return e.createDenseMatrix({data:d,size:hd(l),datatype:a})};function n(e,t,r,i,o,a,s){var l=[];if(t===r.length-1)for(var c=0;c<i;c++)l[c]=s?e(a,o[c]):e(o[c],a);else for(var u=0;u<i;u++)l[u]=n(e,t+1,r,r[t+1],o[u],a,s);return l}});function tg(e,t){if(md(e.size(),t.size()))return[e,t];var n=Of(e.size(),t.size());return[e,t].map(e=>function(e,t){if(md(e.size(),t))return e;return e.create(Pf(e.valueOf(),t),e.datatype())}(e,n))}var ng=vh("matrixAlgorithmSuite",["typed","matrix"],e=>{var{typed:t,matrix:n}=e,r=Zp({typed:t}),i=eg({typed:t});return function(e){var o,a=e.elop,s=e.SD||e.DS;a?(o={"DenseMatrix, DenseMatrix":(e,t)=>r(...tg(e,t),a),"Array, Array":(e,t)=>r(...tg(n(e),n(t)),a).valueOf(),"Array, DenseMatrix":(e,t)=>r(...tg(n(e),t),a),"DenseMatrix, Array":(e,t)=>r(...tg(e,n(t)),a)},e.SS&&(o["SparseMatrix, SparseMatrix"]=(t,n)=>e.SS(...tg(t,n),a,!1)),e.DS&&(o["DenseMatrix, SparseMatrix"]=(t,n)=>e.DS(...tg(t,n),a,!1),o["Array, SparseMatrix"]=(t,r)=>e.DS(...tg(n(t),r),a,!1)),s&&(o["SparseMatrix, DenseMatrix"]=(e,t)=>s(...tg(t,e),a,!0),o["SparseMatrix, Array"]=(e,t)=>s(...tg(n(t),e),a,!0))):(o={"DenseMatrix, DenseMatrix":t.referToSelf(e=>(t,n)=>r(...tg(t,n),e)),"Array, Array":t.referToSelf(e=>(t,i)=>r(...tg(n(t),n(i)),e).valueOf()),"Array, DenseMatrix":t.referToSelf(e=>(t,i)=>r(...tg(n(t),i),e)),"DenseMatrix, Array":t.referToSelf(e=>(t,i)=>r(...tg(t,n(i)),e))},e.SS&&(o["SparseMatrix, SparseMatrix"]=t.referToSelf(t=>(n,r)=>e.SS(...tg(n,r),t,!1))),e.DS&&(o["DenseMatrix, SparseMatrix"]=t.referToSelf(t=>(n,r)=>e.DS(...tg(n,r),t,!1)),o["Array, SparseMatrix"]=t.referToSelf(t=>(r,i)=>e.DS(...tg(n(r),i),t,!1))),s&&(o["SparseMatrix, DenseMatrix"]=t.referToSelf(e=>(t,n)=>s(...tg(n,t),e,!0)),o["SparseMatrix, Array"]=t.referToSelf(e=>(t,r)=>s(...tg(n(r),t),e,!0))));var l=e.scalar||"any";(e.Ds||e.Ss)&&(a?(o["DenseMatrix,"+l]=(e,t)=>i(e,t,a,!1),o[l+", DenseMatrix"]=(e,t)=>i(t,e,a,!0),o["Array,"+l]=(e,t)=>i(n(e),t,a,!1).valueOf(),o[l+", Array"]=(e,t)=>i(n(t),e,a,!0).valueOf()):(o["DenseMatrix,"+l]=t.referToSelf(e=>(t,n)=>i(t,n,e,!1)),o[l+", DenseMatrix"]=t.referToSelf(e=>(t,n)=>i(n,t,e,!0)),o["Array,"+l]=t.referToSelf(e=>(t,r)=>i(n(t),r,e,!1).valueOf()),o[l+", Array"]=t.referToSelf(e=>(t,r)=>i(n(r),t,e,!0).valueOf())));var c=void 0!==e.sS?e.sS:e.Ss;return a?(e.Ss&&(o["SparseMatrix,"+l]=(t,n)=>e.Ss(t,n,a,!1)),c&&(o[l+", SparseMatrix"]=(e,t)=>c(t,e,a,!0))):(e.Ss&&(o["SparseMatrix,"+l]=t.referToSelf(t=>(n,r)=>e.Ss(n,r,t,!1))),c&&(o[l+", SparseMatrix"]=t.referToSelf(e=>(t,n)=>c(n,t,e,!0)))),a&&a.signatures&&fd(o,a.signatures),o}}),rg="number, number";function ig(e){return!e}function og(e,t){return!(!e&&!t)}function ag(e,t){return!!e!==!!t}function sg(e,t){return!(!e||!t)}ig.signature="number",og.signature=rg,ag.signature=rg,sg.signature=rg;var lg=vh("or",["typed","matrix","equalScalar","DenseMatrix","concat"],e=>{var{typed:t,matrix:n,equalScalar:r,DenseMatrix:i,concat:o}=e,a=Xp({typed:t}),s=Jp({typed:t,equalScalar:r}),l=Qp({typed:t,DenseMatrix:i}),c=ng({typed:t,matrix:n,concat:o});return t("or",{"number, number":og,"Complex, Complex":function(e,t){return 0!==e.re||0!==e.im||0!==t.re||0!==t.im},"BigNumber, BigNumber":function(e,t){return!e.isZero()&&!e.isNaN()||!t.isZero()&&!t.isNaN()},"bigint, bigint":og,"Unit, Unit":t.referToSelf(e=>(t,n)=>e(t.value||0,n.value||0))},c({SS:s,DS:a,Ss:l}))}),cg=vh("or",["typed","matrix","equalScalar","DenseMatrix","concat"],e=>{var{typed:t,matrix:n,equalScalar:r,DenseMatrix:i,concat:o}=e,a=lg({typed:t,matrix:n,equalScalar:r,DenseMatrix:i,concat:o});function s(e,t,n){var r=e[0].compile().evaluate(n);if(!jd(r)&&a(r,!1))return!0;var i=e[1].compile().evaluate(n);return a(r,i)}return s.rawArgs=!0,s},{isTransformFunction:!0}),ug=vh("matAlgo02xDS0",["typed","equalScalar"],e=>{var{typed:t,equalScalar:n}=e;return function(e,r,i,o){var a=e._data,s=e._size,l=e._datatype||e.getDataType(),c=r._values,u=r._index,d=r._ptr,h=r._size,f=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(s.length!==h.length)throw new of(s.length,h.length);if(s[0]!==h[0]||s[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+h+")");if(!c)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var m,p=s[0],g=s[1],v=n,y=0,b=i;"string"===typeof l&&l===f&&"mixed"!==l&&(m=l,v=t.find(n,[m,m]),y=t.convert(0,m),b=t.find(i,[m,m]));for(var w=[],x=[],S=[],C=0;C<g;C++){S[C]=x.length;for(var E=d[C],N=d[C+1],T=E;T<N;T++){var A=u[T],R=o?b(c[T],a[A][C]):b(a[A][C],c[T]);v(R,y)||(x.push(A),w.push(R))}}return S[g]=x.length,r.createSparseMatrix({values:w,index:x,ptr:S,size:[p,g],datatype:l===e._datatype&&f===r._datatype?m:void 0})}}),dg=vh("matAlgo11xS0s",["typed","equalScalar"],e=>{var{typed:t,equalScalar:n}=e;return function(e,r,i,o){var a=e._values,s=e._index,l=e._ptr,c=e._size,u=e._datatype;if(!a)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var d,h=c[0],f=c[1],m=n,p=0,g=i;"string"===typeof u&&(d=u,m=t.find(n,[d,d]),p=t.convert(0,d),r=t.convert(r,d),g=t.find(i,[d,d]));for(var v=[],y=[],b=[],w=0;w<f;w++){b[w]=y.length;for(var x=l[w],S=l[w+1],C=x;C<S;C++){var E=s[C],N=o?g(r,a[C]):g(a[C],r);m(N,p)||(y.push(E),v.push(N))}}return b[f]=y.length,e.createSparseMatrix({values:v,index:y,ptr:b,size:[h,f],datatype:d})}}),hg=vh("matAlgo06xS0S0",["typed","equalScalar"],e=>{var{typed:t,equalScalar:n}=e;return function(e,r,i){var o=e._values,a=e._size,s=e._datatype||void 0===e._data?e._datatype:e.getDataType(),l=r._values,c=r._size,u=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(a.length!==c.length)throw new of(a.length,c.length);if(a[0]!==c[0]||a[1]!==c[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+c+")");var d,h=a[0],f=a[1],m=n,p=0,g=i;"string"===typeof s&&s===u&&"mixed"!==s&&(d=s,m=t.find(n,[d,d]),p=t.convert(0,d),g=t.find(i,[d,d]));for(var v=o&&l?[]:void 0,y=[],b=[],w=v?[]:void 0,x=[],S=[],C=0;C<f;C++){b[C]=y.length;var E=C+1;if(Hm(e,C,x,w,S,E,y,g),Hm(r,C,x,w,S,E,y,g),w)for(var N=b[C];N<y.length;){var T=y[N];if(S[T]===E){var A=w[T];m(A,p)?y.splice(N,1):(v.push(A),N++)}else y.splice(N,1)}else for(var R=b[C];R<y.length;){S[y[R]]!==E?y.splice(R,1):R++}}return b[f]=y.length,e.createSparseMatrix({values:v,index:y,ptr:b,size:[h,f],datatype:s===e._datatype&&u===r._datatype?d:void 0})}}),fg=vh("and",["typed","matrix","equalScalar","zeros","not","concat"],e=>{var{typed:t,matrix:n,equalScalar:r,zeros:i,not:o,concat:a}=e,s=ug({typed:t,equalScalar:r}),l=hg({typed:t,equalScalar:r}),c=dg({typed:t,equalScalar:r}),u=eg({typed:t}),d=ng({typed:t,matrix:n,concat:a});return t("and",{"number, number":sg,"Complex, Complex":function(e,t){return(0!==e.re||0!==e.im)&&(0!==t.re||0!==t.im)},"BigNumber, BigNumber":function(e,t){return!e.isZero()&&!t.isZero()&&!e.isNaN()&&!t.isNaN()},"bigint, bigint":sg,"Unit, Unit":t.referToSelf(e=>(t,n)=>e(t.value||0,n.value||0)),"SparseMatrix, any":t.referToSelf(e=>(t,n)=>o(n)?i(t.size(),t.storage()):c(t,n,e,!1)),"DenseMatrix, any":t.referToSelf(e=>(t,n)=>o(n)?i(t.size(),t.storage()):u(t,n,e,!1)),"any, SparseMatrix":t.referToSelf(e=>(t,n)=>o(t)?i(t.size(),t.storage()):c(n,t,e,!0)),"any, DenseMatrix":t.referToSelf(e=>(t,n)=>o(t)?i(t.size(),t.storage()):u(n,t,e,!0)),"Array, any":t.referToSelf(e=>(t,r)=>e(n(t),r).valueOf()),"any, Array":t.referToSelf(e=>(t,r)=>e(t,n(r)).valueOf())},d({SS:l,DS:s}))}),mg=vh("and",["typed","matrix","zeros","add","equalScalar","not","concat"],e=>{var{typed:t,matrix:n,equalScalar:r,zeros:i,not:o,concat:a}=e,s=fg({typed:t,matrix:n,equalScalar:r,zeros:i,not:o,concat:a});function l(e,t,n){var r=e[0].compile().evaluate(n);if(!jd(r)&&!s(r,!0))return!1;var i=e[1].compile().evaluate(n);return s(r,i)}return l.rawArgs=!0,l},{isTransformFunction:!0}),pg="concat",gg=vh(pg,["typed","matrix","isInteger"],e=>{var{typed:t,matrix:n,isInteger:r}=e;return t(pg,{"...Array | Matrix | number | BigNumber":function(e){var t,i,o=e.length,a=-1,s=!1,l=[];for(t=0;t<o;t++){var c=e[t];if(Pd(c)&&(s=!0),Ad(c)||Rd(c)){if(t!==o-1)throw new Error("Dimension must be specified as last argument");if(i=a,a=c.valueOf(),!r(a))throw new TypeError("Integer number expected for dimension");if(a<0||t>0&&a>i)throw new af(a,i+1)}else{var u=hd(c).valueOf(),d=sf(u);if(l[t]=u,i=a,a=d.length-1,t>0&&a!==i)throw new of(i+1,a+1)}}if(0===l.length)throw new SyntaxError("At least one matrix expected");for(var h=l.shift();l.length;)h=_f(h,l.shift(),a);return s?n(h):h},"...string":function(e){return e.join("")}})}),vg=vh("concat",["typed","matrix","isInteger"],e=>{var{typed:t,matrix:n,isInteger:r}=e,i=gg({typed:t,matrix:n,isInteger:r});return t("concat",{"...any":function(e){var t=e.length-1,n=e[t];Ad(n)?e[t]=n-1:Rd(n)&&(e[t]=n.minus(1));try{return i.apply(null,e)}catch(r){throw Cm(r)}}})},{isTransformFunction:!0});function yg(e,t,n){var r;return String(e).includes("Unexpected type")?(r=arguments.length>2?" (type: "+ph(n)+", value: "+JSON.stringify(n)+")":" (type: "+e.data.actual+")",new TypeError("Cannot calculate "+t+", unexpected type of argument"+r)):String(e).includes("complex numbers")?(r=arguments.length>2?" (type: "+ph(n)+", value: "+JSON.stringify(n)+")":"",new TypeError("Cannot calculate "+t+", no ordering relation is defined for complex numbers"+r)):e}var bg=vh("max",["typed","config","numeric","larger","isNaN"],e=>{var{typed:t,config:n,numeric:r,larger:i,isNaN:o}=e;return t("max",{"Array | Matrix":s,"Array | Matrix, number | BigNumber":function(e,t){return jm(e,t.valueOf(),a)},"...":function(e){if(Om(e))throw new TypeError("Scalar values expected in function max");return s(e)}});function a(e,t){try{return i(e,t)?e:t}catch(n){throw yg(n,"max",t)}}function s(e){var t;if(Im(e,function(e){try{(o(e)||void 0===t||i(e,t))&&(t=e)}catch(n){throw yg(n,"max",e)}}),void 0===t)throw new Error("Cannot calculate max of an empty array");return"string"===typeof t&&(t=r(t,xh(t,n))),t}});function wg(e){if(2===e.length&&jd(e[0])){var t=(e=e.slice())[1];(Ad(n=t)||Rd(n))&&(e[1]=function(e){return Ad(e)?e-1:Rd(e)?e.minus(1):e}(t))}var n;return e}var xg=vh("max",["typed","config","numeric","larger","isNaN"],e=>{var{typed:t,config:n,numeric:r,larger:i,isNaN:o}=e,a=bg({typed:t,config:n,numeric:r,larger:i,isNaN:o});return t("max",{"...any":function(e){e=wg(e);try{return a.apply(null,e)}catch(t){throw Cm(t)}}})},{isTransformFunction:!0}),Sg=/\$([\w.]+)/g,Cg="print",Eg=vh(Cg,["typed"],e=>{var{typed:t}=e;return t(Cg,{"string, Object | Array":Ng,"string, Object | Array, number | Object":Ng})});function Ng(e,t,n){return e.replace(Sg,function(e,r){var i=r.split("."),o=t[i.shift()];for(void 0!==o&&o.isMatrix&&(o=o.toArray());i.length&&void 0!==o;){var a=i.shift();o=a?o[a]:o+"."}return void 0!==o?Od(o)?o:Xh(o,n):e})}var Tg="print",Ag=vh(Tg,["typed","matrix","zeros","add"],e=>{var{typed:t,matrix:n,zeros:r,add:i}=e,o=Eg({typed:t,matrix:n,zeros:r,add:i});return t(Tg,{"string, Object | Array":function(e,t){return o(a(e),t)},"string, Object | Array, number | Object":function(e,t,n){return o(a(e),t,n)}});function a(e){return e.replace(Sg,e=>"$"+e.slice(1).split(".").map(function(e){return!isNaN(e)&&e.length>0?parseInt(e)-1:e}).join("."))}},{isTransformFunction:!0}),Rg=vh("sum",["typed","config","add","numeric"],e=>{var{typed:t,config:n,add:r,numeric:i}=e;return t("sum",{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(e,t){try{return jm(e,t,r)}catch(n){throw yg(n,"sum")}},"...":function(e){if(Om(e))throw new TypeError("Scalar values expected in function sum");return o(e)}});function o(e){var t;return Im(e,function(e){try{t=void 0===t?e:r(t,e)}catch(n){throw yg(n,"sum",e)}}),void 0===t&&(t=i(0,n.number)),"string"===typeof t&&(t=i(t,xh(t,n))),t}}),kg=vh("sum",["typed","config","add","numeric"],e=>{var{typed:t,config:n,add:r,numeric:i}=e,o=Rg({typed:t,config:n,add:r,numeric:i});return t("sum",{"...any":function(e){e=wg(e);try{return o.apply(null,e)}catch(t){throw Cm(t)}}})},{isTransformFunction:!0});function Mg(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function bitAnd");var n=e.constructor;if(e.isNaN()||t.isNaN())return new n(NaN);if(e.isZero()||t.eq(-1)||e.eq(t))return e;if(t.isZero()||e.eq(-1))return t;if(!e.isFinite()||!t.isFinite()){if(!e.isFinite()&&!t.isFinite())return e.isNegative()===t.isNegative()?e:new n(0);if(!e.isFinite())return t.isNegative()?e:e.isNegative()?new n(0):t;if(!t.isFinite())return e.isNegative()?t:t.isNegative()?new n(0):e}return Og(e,t,function(e,t){return e&t})}function Dg(e){if(e.isFinite()&&!e.isInteger())throw new Error("Integer expected in function bitNot");var t=e.constructor,n=t.precision;t.config({precision:1e9});var r=e.plus(new t(1));return r.s=-r.s||null,t.config({precision:n}),r}function _g(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function bitOr");var n=e.constructor;if(e.isNaN()||t.isNaN())return new n(NaN);var r=new n(-1);return e.isZero()||t.eq(r)||e.eq(t)?t:t.isZero()||e.eq(r)?e:e.isFinite()&&t.isFinite()?Og(e,t,function(e,t){return e|t}):!e.isFinite()&&!e.isNegative()&&t.isNegative()||e.isNegative()&&!t.isNegative()&&!t.isFinite()?r:e.isNegative()&&t.isNegative()?e.isFinite()?e:t:e.isFinite()?t:e}function Og(e,t,n){var r,i,o,a,s,l=e.constructor,c=+(e.s<0),u=+(t.s<0);if(c){r=Ig(Dg(e));for(var d=0;d<r.length;++d)r[d]^=1}else r=Ig(e);if(u){i=Ig(Dg(t));for(var h=0;h<i.length;++h)i[h]^=1}else i=Ig(t);r.length<=i.length?(o=r,a=i,s=c):(o=i,a=r,s=u);var f=o.length,m=a.length,p=1^n(c,u),g=new l(1^p),v=new l(1),y=new l(2),b=l.precision;for(l.config({precision:1e9});f>0;)n(o[--f],a[--m])===p&&(g=g.plus(v)),v=v.times(y);for(;m>0;)n(s,a[--m])===p&&(g=g.plus(v)),v=v.times(y);return l.config({precision:b}),0===p&&(g.s=-g.s),g}function Ig(e){for(var t=e.d,n=t[0]+"",r=1;r<t.length;++r){for(var i=t[r]+"",o=7-i.length;o--;)i="0"+i;n+=i}for(var a=n.length;"0"===n.charAt(a);)a--;var s=e.e,l=n.slice(0,a+1||1),c=l.length;if(s>0)if(++s>c)for(s-=c;s--;)l+="0";else s<c&&(l=l.slice(0,s)+"."+l.slice(s));for(var u=[0],d=0;d<l.length;){for(var h=u.length;h--;)u[h]*=10;u[0]+=parseInt(l.charAt(d++));for(var f=0;f<u.length;++f)u[f]>1&&(null!==u[f+1]&&void 0!==u[f+1]||(u[f+1]=0),u[f+1]+=u[f]>>1,u[f]&=1)}return u.reverse()}function Pg(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function bitXor");var n=e.constructor;if(e.isNaN()||t.isNaN())return new n(NaN);if(e.isZero())return t;if(t.isZero())return e;if(e.eq(t))return new n(0);var r=new n(-1);return e.eq(r)?Dg(t):t.eq(r)?Dg(e):e.isFinite()&&t.isFinite()?Og(e,t,function(e,t){return e^t}):e.isFinite()||t.isFinite()?new n(e.isNegative()===t.isNegative()?1/0:-1/0):r}function jg(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function leftShift");var n=e.constructor;return e.isNaN()||t.isNaN()||t.isNegative()&&!t.isZero()?new n(NaN):e.isZero()||t.isZero()?e:e.isFinite()||t.isFinite()?t.lt(55)?e.times(Math.pow(2,t.toNumber())+""):e.times(new n(2).pow(t)):new n(NaN)}function Fg(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function rightArithShift");var n=e.constructor;return e.isNaN()||t.isNaN()||t.isNegative()&&!t.isZero()?new n(NaN):e.isZero()||t.isZero()?e:t.isFinite()?t.lt(55)?e.div(Math.pow(2,t.toNumber())+"").floor():e.div(new n(2).pow(t)).floor():e.isNegative()?new n(-1):e.isFinite()?new n(0):new n(NaN)}var Hg="number, number";function Lg(e,t){if(!wh(e)||!wh(t))throw new Error("Integers expected in function bitAnd");return e&t}function Bg(e){if(!wh(e))throw new Error("Integer expected in function bitNot");return~e}function zg(e,t){if(!wh(e)||!wh(t))throw new Error("Integers expected in function bitOr");return e|t}function Wg(e,t){if(!wh(e)||!wh(t))throw new Error("Integers expected in function bitXor");return e^t}function Vg(e,t){if(!wh(e)||!wh(t))throw new Error("Integers expected in function leftShift");return e<<t}function Ug(e,t){if(!wh(e)||!wh(t))throw new Error("Integers expected in function rightArithShift");return e>>t}function qg(e,t){if(!wh(e)||!wh(t))throw new Error("Integers expected in function rightLogShift");return e>>>t}Lg.signature=Hg,Bg.signature="number",zg.signature=Hg,Wg.signature=Hg,Vg.signature=Hg,Ug.signature=Hg,qg.signature=Hg;var Gg="bitAnd",Yg=vh(Gg,["typed","matrix","equalScalar","concat"],e=>{var{typed:t,matrix:n,equalScalar:r,concat:i}=e,o=ug({typed:t,equalScalar:r}),a=hg({typed:t,equalScalar:r}),s=dg({typed:t,equalScalar:r}),l=ng({typed:t,matrix:n,concat:i});return t(Gg,{"number, number":Lg,"BigNumber, BigNumber":Mg,"bigint, bigint":(e,t)=>e&t},l({SS:a,DS:o,Ss:s}))}),Kg=vh("bitAnd",["typed","matrix","zeros","add","equalScalar","not","concat"],e=>{var{typed:t,matrix:n,equalScalar:r,zeros:i,not:o,concat:a}=e,s=Yg({typed:t,matrix:n,equalScalar:r,zeros:i,not:o,concat:a});function l(e,t,n){var r=e[0].compile().evaluate(n);if(!jd(r)){if(isNaN(r))return NaN;if(0===r||!1===r)return 0}var i=e[1].compile().evaluate(n);return s(r,i)}return l.rawArgs=!0,l},{isTransformFunction:!0}),$g=vh("min",["typed","config","numeric","smaller","isNaN"],e=>{var{typed:t,config:n,numeric:r,smaller:i,isNaN:o}=e;return t("min",{"Array | Matrix":s,"Array | Matrix, number | BigNumber":function(e,t){return jm(e,t.valueOf(),a)},"...":function(e){if(Om(e))throw new TypeError("Scalar values expected in function min");return s(e)}});function a(e,t){try{return i(e,t)?e:t}catch(n){throw yg(n,"min",t)}}function s(e){var t;if(Im(e,function(e){try{(o(e)||void 0===t||i(e,t))&&(t=e)}catch(n){throw yg(n,"min",e)}}),void 0===t)throw new Error("Cannot calculate min of an empty array");return"string"===typeof t&&(t=r(t,xh(t,n))),t}}),Xg=vh("min",["typed","config","numeric","smaller","isNaN"],e=>{var{typed:t,config:n,numeric:r,smaller:i,isNaN:o}=e,a=$g({typed:t,config:n,numeric:r,smaller:i,isNaN:o});return t("min",{"...any":function(e){e=wg(e);try{return a.apply(null,e)}catch(t){throw Cm(t)}}})},{isTransformFunction:!0}),Qg="nullish",Jg=vh(Qg,["typed","matrix","size","flatten","deepEqual"],e=>{var{typed:t,matrix:n,size:r,flatten:i,deepEqual:o}=e,a=Xp({typed:t}),s=eg({typed:t}),l=Zp({typed:t});return t(Qg,{"number|bigint|Complex|BigNumber|Fraction|Unit|string|boolean|SparseMatrix, any":(e,t)=>e,"null, any":(e,t)=>t,"undefined, any":(e,t)=>t,"SparseMatrix, Array | Matrix":(e,t)=>{var n=r(e),i=r(t);if(o(n,i))return e;throw new of(n,i)},"DenseMatrix, DenseMatrix":t.referToSelf(e=>(t,n)=>l(t,n,e)),"DenseMatrix, SparseMatrix":t.referToSelf(e=>(t,n)=>a(t,n,e,!1)),"DenseMatrix, Array":t.referToSelf(e=>(t,r)=>l(t,n(r),e)),"DenseMatrix, any":t.referToSelf(e=>(t,n)=>s(t,n,e,!1)),"Array, Array":t.referToSelf(e=>(t,r)=>l(n(t),n(r),e).valueOf()),"Array, DenseMatrix":t.referToSelf(e=>(t,r)=>l(n(t),r,e)),"Array, SparseMatrix":t.referToSelf(e=>(t,r)=>a(n(t),r,e,!1)),"Array, any":t.referToSelf(e=>(t,r)=>s(n(t),r,e,!1).valueOf())})}),Zg=vh("nullish",["typed","matrix","size","flatten","deepEqual"],e=>{var{typed:t,matrix:n,size:r,flatten:i,deepEqual:o}=e,a=Jg({typed:t,matrix:n,size:r,flatten:i,deepEqual:o});function s(e,t,n){var r=e[0].compile().evaluate(n);if(!jd(r)&&null!=r&&void 0!==r)return r;var i=e[1].compile().evaluate(n);return a(r,i)}return s.rawArgs=!0,s},{isTransformFunction:!0}),ev="subset",tv=vh(ev,["typed","matrix","zeros","add"],e=>{var{typed:t,matrix:n,zeros:r,add:i}=e;return t(ev,{"Matrix, Index":function(e,t){return hf(t)?n():(uf(e,t),e.subset(t))},"Array, Index":t.referTo("Matrix, Index",function(e){return function(t,r){var i=e(n(t),r);return r.isScalar()?i:i.valueOf()}}),"Object, Index":iv,"string, Index":nv,"Matrix, Index, any, any":function(e,t,n,o){return hf(t)?e:(uf(e,t),e.clone().subset(t,function(e,t){if("string"===typeof e)throw new Error("can't boradcast a string");if(t.isScalar())return e;var n=t.size();if(!n.every(e=>e>0))return e;try{return i(e,r(n))}catch(mW){return e}}(n,t),o))},"Array, Index, any, any":t.referTo("Matrix, Index, any, any",function(e){return function(t,r,i,o){var a=e(n(t),r,i,o);return a.isMatrix?a.valueOf():a}}),"Array, Index, any":t.referTo("Matrix, Index, any, any",function(e){return function(t,r,i){return e(n(t),r,i,void 0).valueOf()}}),"Matrix, Index, any":t.referTo("Matrix, Index, any, any",function(e){return function(t,n,r){return e(t,n,r,void 0)}}),"string, Index, string":rv,"string, Index, string, string":rv,"Object, Index, any":ov})});function nv(e,t){if(!Bd(t))throw new TypeError("Index expected");if(hf(t))return"";if(uf(Array.from(e),t),1!==t.size().length)throw new of(t.size().length,1);var n=e.length;df(t.min()[0],n),df(t.max()[0],n);var r=t.dimension(0),i="";function o(t){i+=e.charAt(t)}return Number.isInteger(r)?o(r):r.forEach(o),i}function rv(e,t,n,r){if(!t||!0!==t.isIndex)throw new TypeError("Index expected");if(hf(t))return e;if(uf(Array.from(e),t),1!==t.size().length)throw new of(t.size().length,1);if(void 0!==r){if("string"!==typeof r||1!==r.length)throw new TypeError("Single character expected as defaultValue")}else r=" ";var i=t.dimension(0);if((Number.isInteger(i)?1:i.size()[0])!==n.length)throw new of(i.size()[0],n.length);var o=e.length;df(t.min()[0]),df(t.max()[0]);for(var a=[],s=0;s<o;s++)a[s]=e.charAt(s);function l(e,t){a[e]=n.charAt(t[0])}if(Number.isInteger(i)?l(i,[0]):i.forEach(l),a.length>o)for(var c=o-1,u=a.length;c<u;c++)a[c]||(a[c]=r);return a.join("")}function iv(e,t){if(!hf(t)){if(1!==t.size().length)throw new of(t.size(),1);var n=t.dimension(0);if("string"!==typeof n)throw new TypeError("String expected as index to retrieve an object property");return gd(e,n)}}function ov(e,t,n){if(hf(t))return e;if(1!==t.size().length)throw new of(t.size(),1);var r=t.dimension(0);if("string"!==typeof r)throw new TypeError("String expected as index to retrieve an object property");var i=hd(e);return vd(i,r,n),i}var av,sv,lv=vh("subset",["typed","matrix","zeros","add"],e=>{var{typed:t,matrix:n,zeros:r,add:i}=e,o=tv({typed:t,matrix:n,zeros:r,add:i});return t("subset",{"...any":function(e){try{return o.apply(null,e)}catch(t){throw Cm(t)}}})},{isTransformFunction:!0}),cv=vh("matAlgo10xSids",["typed","DenseMatrix"],e=>{var{typed:t,DenseMatrix:n}=e;return function(e,r,i,o){var a=e._values,s=e._index,l=e._ptr,c=e._size,u=e._datatype;if(!a)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var d,h=c[0],f=c[1],m=i;"string"===typeof u&&(d=u,r=t.convert(r,d),m=t.find(i,[d,d]));for(var p=[],g=[],v=[],y=0;y<f;y++){for(var b=y+1,w=l[y],x=l[y+1],S=w;S<x;S++){var C=s[S];g[C]=a[S],v[C]=b}for(var E=0;E<h;E++)0===y&&(p[E]=[]),v[E]===b?p[E][y]=o?m(r,g[E]):m(g[E],r):p[E][y]=r}return new n({data:p,size:[h,f],datatype:d})}}),uv=vh("matAlgo04xSidSid",["typed","equalScalar"],e=>{var{typed:t,equalScalar:n}=e;return function(e,r,i){var o=e._values,a=e._index,s=e._ptr,l=e._size,c=e._datatype||void 0===e._data?e._datatype:e.getDataType(),u=r._values,d=r._index,h=r._ptr,f=r._size,m=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(l.length!==f.length)throw new of(l.length,f.length);if(l[0]!==f[0]||l[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+f+")");var p,g=l[0],v=l[1],y=n,b=0,w=i;"string"===typeof c&&c===m&&"mixed"!==c&&(p=c,y=t.find(n,[p,p]),b=t.convert(0,p),w=t.find(i,[p,p]));var x,S,C,E,N,T=o&&u?[]:void 0,A=[],R=[],k=o&&u?[]:void 0,M=o&&u?[]:void 0,D=[],_=[];for(S=0;S<v;S++){R[S]=A.length;var O=S+1;for(E=s[S],N=s[S+1],C=E;C<N;C++)x=a[C],A.push(x),D[x]=O,k&&(k[x]=o[C]);for(E=h[S],N=h[S+1],C=E;C<N;C++)if(D[x=d[C]]===O){if(k){var I=w(k[x],u[C]);y(I,b)?D[x]=null:k[x]=I}}else A.push(x),_[x]=O,M&&(M[x]=u[C]);if(k&&M)for(C=R[S];C<A.length;)D[x=A[C]]===O?(T[C]=k[x],C++):_[x]===O?(T[C]=M[x],C++):A.splice(C,1)}return R[v]=A.length,e.createSparseMatrix({values:T,index:A,ptr:R,size:[g,v],datatype:c===e._datatype&&m===r._datatype?p:void 0})}}),dv=vh("matAlgo01xDSid",["typed"],e=>{var{typed:t}=e;return function(e,n,r,i){var o=e._data,a=e._size,s=e._datatype||e.getDataType(),l=n._values,c=n._index,u=n._ptr,d=n._size,h=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(a.length!==d.length)throw new of(a.length,d.length);if(a[0]!==d[0]||a[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+d+")");if(!l)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var f,m,p=a[0],g=a[1],v="string"===typeof s&&"mixed"!==s&&s===h?s:void 0,y=v?t.find(r,[v,v]):r,b=[];for(f=0;f<p;f++)b[f]=[];var w=[],x=[];for(m=0;m<g;m++){for(var S=m+1,C=u[m],E=u[m+1],N=C;N<E;N++)w[f=c[N]]=i?y(l[N],o[f][m]):y(o[f][m],l[N]),x[f]=S;for(f=0;f<p;f++)x[f]===S?b[f][m]=w[f]:b[f][m]=o[f][m]}return e.createDenseMatrix({data:b,size:[p,g],datatype:s===e._datatype&&h===n._datatype?v:void 0})}}),hv="bitOr",fv=vh(hv,["typed","matrix","equalScalar","DenseMatrix","concat"],e=>{var{typed:t,matrix:n,equalScalar:r,DenseMatrix:i,concat:o}=e,a=dv({typed:t}),s=uv({typed:t,equalScalar:r}),l=cv({typed:t,DenseMatrix:i}),c=ng({typed:t,matrix:n,concat:o});return t(hv,{"number, number":zg,"BigNumber, BigNumber":_g,"bigint, bigint":(e,t)=>e|t},c({SS:s,DS:a,Ss:l}))}),mv=vh("bitOr",["typed","matrix","equalScalar","DenseMatrix","concat"],e=>{var{typed:t,matrix:n,equalScalar:r,DenseMatrix:i,concat:o}=e,a=fv({typed:t,matrix:n,equalScalar:r,DenseMatrix:i,concat:o});function s(e,t,n){var r=e[0].compile().evaluate(n);if(!jd(r)){if(isNaN(r))return NaN;if(-1===r)return-1;if(!0===r)return 1}var i=e[1].compile().evaluate(n);return a(r,i)}return s.rawArgs=!0,s},{isTransformFunction:!0}),pv="diff",gv=vh(pv,["typed","matrix","subtract","number"],e=>{var{typed:t,matrix:n,subtract:r,number:i}=e;return t(pv,{"Array | Matrix":function(e){return Pd(e)?n(a(e.toArray())):a(e)},"Array | Matrix, number":function(e,t){if(!wh(t))throw new RangeError("Dimension must be a whole number");return Pd(e)?n(o(e.toArray(),t)):o(e,t)},"Array, BigNumber":t.referTo("Array,number",e=>(t,n)=>e(t,i(n))),"Matrix, BigNumber":t.referTo("Matrix,number",e=>(t,n)=>e(t,i(n)))});function o(e,t){if(Pd(e)&&(e=e.toArray()),!Array.isArray(e))throw RangeError("Array/Matrix does not have that many dimensions");if(t>0){var n=[];return e.forEach(e=>{n.push(o(e,t-1))}),n}if(0===t)return a(e);throw RangeError("Cannot have negative dimension")}function a(e){for(var t=[],n=e.length,r=1;r<n;r++)t.push(s(e[r-1],e[r]));return t}function s(e,t){Pd(e)&&(e=e.toArray()),Pd(t)&&(t=t.toArray());var n=Array.isArray(e),i=Array.isArray(t);if(n&&i)return function(e,t){if(e.length!==t.length)throw RangeError("Not all sub-arrays have the same length");for(var n=[],r=e.length,i=0;i<r;i++)n.push(s(e[i],t[i]));return n}(e,t);if(!n&&!i)return r(t,e);throw TypeError("Cannot calculate difference between 1 array and 1 non-array")}}),vv="diff",yv=vh(vv,["typed","matrix","subtract","number","bignumber"],e=>{var{typed:t,matrix:n,subtract:r,number:i,bignumber:o}=e,a=gv({typed:t,matrix:n,subtract:r,number:i,bignumber:o});return t(vv,{"...any":function(e){e=wg(e);try{return a.apply(null,e)}catch(t){throw Cm(t)}}})},{isTransformFunction:!0}),bv=vh("index",["Index","getMatrixDataType"],e=>{var{Index:t,getMatrixDataType:n}=e;return function(){for(var e=[],r=0,i=arguments.length;r<i;r++){var o=arguments[r];if(Ld(o))o.start--,o.end-=o.step>0?0:2;else if(o&&!0===o.isSet)o=o.map(function(e){return e-1});else if(Id(o)||Pd(o))"boolean"!==n(o)&&(o=o.map(function(e){return e-1}));else if(Ad(o)||kd(o))o--;else if(Rd(o))o=o.toNumber()-1;else if("string"!==typeof o)throw new TypeError("Dimension must be an Array, Matrix, number, bigint, string, or Range");e[r]=o}var a=new t;return t.apply(a,e),a}},{isTransformFunction:!0}),wv="range",xv=vh(wv,["typed","config","?matrix","?bignumber","equal","smaller","smallerEq","larger","largerEq","add","isZero","isPositive"],e=>{var{typed:t,config:n,matrix:r,bignumber:i,smaller:o,smallerEq:a,larger:s,largerEq:l,add:c,isZero:u,isPositive:d}=e;return t(wv,{string:f,"string, boolean":f,number:function(e){throw new TypeError("Too few arguments to function range(): ".concat(e))},boolean:function(e){throw new TypeError("Unexpected type of argument 1 to function range(): ".concat(e,", number|bigint|BigNumber|Fraction"))},"number, number":function(e,t){return h(m(e,t,1,!1))},"number, number, number":function(e,t,n){return h(m(e,t,n,!1))},"number, number, boolean":function(e,t,n){return h(m(e,t,1,n))},"number, number, number, boolean":function(e,t,n,r){return h(m(e,t,n,r))},"bigint, bigint|number":function(e,t){return h(m(e,t,1n,!1))},"number, bigint":function(e,t){return h(m(BigInt(e),t,1n,!1))},"bigint, bigint|number, bigint|number":function(e,t,n){return h(m(e,t,BigInt(n),!1))},"number, bigint, bigint|number":function(e,t,n){return h(m(BigInt(e),t,BigInt(n),!1))},"bigint, bigint|number, boolean":function(e,t,n){return h(m(e,t,1n,n))},"number, bigint, boolean":function(e,t,n){return h(m(BigInt(e),t,1n,n))},"bigint, bigint|number, bigint|number, boolean":function(e,t,n,r){return h(m(e,t,BigInt(n),r))},"number, bigint, bigint|number, boolean":function(e,t,n,r){return h(m(BigInt(e),t,BigInt(n),r))},"BigNumber, BigNumber":function(e,t){return h(m(e,t,new(0,e.constructor)(1),!1))},"BigNumber, BigNumber, BigNumber":function(e,t,n){return h(m(e,t,n,!1))},"BigNumber, BigNumber, boolean":function(e,t,n){return h(m(e,t,new(0,e.constructor)(1),n))},"BigNumber, BigNumber, BigNumber, boolean":function(e,t,n,r){return h(m(e,t,n,r))},"Fraction, Fraction":function(e,t){return h(m(e,t,1,!1))},"Fraction, Fraction, Fraction":function(e,t,n){return h(m(e,t,n,!1))},"Fraction, Fraction, boolean":function(e,t,n){return h(m(e,t,1,n))},"Fraction, Fraction, Fraction, boolean":function(e,t,n,r){return h(m(e,t,n,r))},"Unit, Unit, Unit":function(e,t,n){return h(m(e,t,n,!1))},"Unit, Unit, Unit, boolean":function(e,t,n,r){return h(m(e,t,n,r))}});function h(e){return"Matrix"===n.matrix?r?r(e):function(){throw new Error('No "matrix" implementation available')}():e}function f(e,t){var r=function(e){var t=e.split(":"),n=t.map(function(e){return Number(e)});if(n.some(function(e){return isNaN(e)}))return null;switch(n.length){case 2:return{start:n[0],end:n[1],step:1};case 3:return{start:n[0],end:n[2],step:n[1]};default:return null}}(e);if(!r)throw new SyntaxError('String "'+e+'" is no valid range');return"BigNumber"===n.number?(void 0===i&&qm(),h(m(i(r.start),i(r.end),i(r.step)))):h(m(r.start,r.end,r.step,t))}function m(e,t,n,r){var i=[];if(u(n))throw new Error("Step must be non-zero");for(var h=d(n)?r?a:o:r?l:s,f=e;h(f,t);)i.push(f),f=c(f,n);return i}}),Sv=vh("range",["typed","config","?matrix","?bignumber","equal","smaller","smallerEq","larger","largerEq","add","isZero","isPositive"],e=>{var{typed:t,config:n,matrix:r,bignumber:i,equal:o,smaller:a,smallerEq:s,larger:l,largerEq:c,add:u,isZero:d,isPositive:h}=e,f=xv({typed:t,config:n,matrix:r,bignumber:i,equal:o,smaller:a,smallerEq:s,larger:l,largerEq:c,add:u,isZero:d,isPositive:h});return t("range",{"...any":function(e){return"boolean"!==typeof e[e.length-1]&&e.push(!0),f.apply(null,e)}})},{isTransformFunction:!0}),Cv=vh("row",["typed","Index","matrix","range"],e=>{var{typed:t,Index:n,matrix:r,range:i}=e;return t("row",{"Matrix, number":o,"Array, number":function(e,t){return o(r(hd(e)),t).valueOf()}});function o(e,t){if(2!==e.size().length)throw new Error("Only two dimensional matrix is supported");df(t,e.size()[0]);var o=i(0,e.size()[1]),a=new n([t],o),s=e.subset(a);return Pd(s)?s:r([[s]])}}),Ev=vh("row",["typed","Index","matrix","range"],e=>{var{typed:t,Index:n,matrix:r,range:i}=e,o=Cv({typed:t,Index:n,matrix:r,range:i});return t("row",{"...any":function(e){var t=e.length-1,n=e[t];Ad(n)&&(e[t]=n-1);try{return o.apply(null,e)}catch(r){throw Cm(r)}}})},{isTransformFunction:!0}),Nv="column",Tv=vh(Nv,["typed","Index","matrix","range"],e=>{var{typed:t,Index:n,matrix:r,range:i}=e;return t(Nv,{"Matrix, number":o,"Array, number":function(e,t){return o(r(hd(e)),t).valueOf()}});function o(e,t){if(2!==e.size().length)throw new Error("Only two dimensional matrix is supported");df(t,e.size()[1]);var o=i(0,e.size()[0]),a=new n(o,[t]),s=e.subset(a);return Pd(s)?s:r([[s]])}}),Av=vh("column",["typed","Index","matrix","range"],e=>{var{typed:t,Index:n,matrix:r,range:i}=e,o=Tv({typed:t,Index:n,matrix:r,range:i});return t("column",{"...any":function(e){var t=e.length-1,n=e[t];Ad(n)&&(e[t]=n-1);try{return o.apply(null,e)}catch(r){throw Cm(r)}}})},{isTransformFunction:!0}),Rv="cumsum",kv=vh(Rv,["typed","add","unaryPlus"],e=>{var{typed:t,add:n,unaryPlus:r}=e;return t(Rv,{Array:i,Matrix:function(e){return e.create(i(e.valueOf(),e.datatype()))},"Array, number | BigNumber":a,"Matrix, number | BigNumber":function(e,t){return e.create(a(e.valueOf(),t),e.datatype())},"...":function(e){if(Om(e))throw new TypeError("All values expected to be scalar in function cumsum");return i(e)}});function i(e){try{return o(e)}catch(t){throw yg(t,Rv)}}function o(e){if(0===e.length)return[];for(var t=[r(e[0])],i=1;i<e.length;++i)t.push(n(t[i-1],e[i]));return t}function a(e,t){var n=sf(e);if(t<0||t>=n.length)throw new af(t,n.length);try{return s(e,t)}catch(r){throw yg(r,Rv)}}function s(e,t){var n,r,i;if(t<=0){var a=e[0][0];if(Array.isArray(a)){for(i=_m(e),r=[],n=0;n<i.length;n++)r[n]=s(i[n],t-1);return r}return o(e)}for(r=[],n=0;n<e.length;n++)r[n]=s(e[n],t-1);return r}}),Mv="cumsum",Dv=vh(Mv,["typed","add","unaryPlus"],e=>{var{typed:t,add:n,unaryPlus:r}=e,i=kv({typed:t,add:n,unaryPlus:r});return t(Mv,{"...any":function(e){if(2===e.length&&jd(e[0])){var t=e[1];Ad(t)?e[1]=t-1:Rd(t)&&(e[1]=t.minus(1))}try{return i.apply(null,e)}catch(n){throw Cm(n)}}})},{isTransformFunction:!0}),_v="mean",Ov=vh(_v,["typed","add","divide"],e=>{var{typed:t,add:n,divide:r}=e;return t(_v,{"Array | Matrix":i,"Array | Matrix, number | BigNumber":function(e,t){try{var i=jm(e,t,n),o=Array.isArray(e)?sf(e):e.size();return r(i,o[t])}catch(a){throw yg(a,"mean")}},"...":function(e){if(Om(e))throw new TypeError("Scalar values expected in function mean");return i(e)}});function i(e){var t,i=0;if(Im(e,function(e){try{t=void 0===t?e:n(t,e),i++}catch(r){throw yg(r,"mean",e)}}),0===i)throw new Error("Cannot calculate the mean of an empty array");return r(t,i)}}),Iv=vh("mean",["typed","add","divide"],e=>{var{typed:t,add:n,divide:r}=e,i=Ov({typed:t,add:n,divide:r});return t("mean",{"...any":function(e){e=wg(e);try{return i.apply(null,e)}catch(t){throw Cm(t)}}})},{isTransformFunction:!0}),Pv="quantileSeq",jv=vh(Pv,["typed","?bignumber","add","subtract","divide","multiply","partitionSelect","compare","isInteger","smaller","smallerEq","larger","mapSlices"],e=>{var{typed:t,bignumber:n,add:r,subtract:i,divide:o,multiply:a,partitionSelect:s,compare:l,isInteger:c,smaller:u,smallerEq:d,larger:h,mapSlices:f}=e;return t(Pv,{"Array | Matrix, number | BigNumber":(e,t)=>p(e,t,!1),"Array | Matrix, number | BigNumber, number":(e,t,n)=>m(e,t,!1,n,p),"Array | Matrix, number | BigNumber, boolean":p,"Array | Matrix, number | BigNumber, boolean, number":(e,t,n,r)=>m(e,t,n,r,p),"Array | Matrix, Array | Matrix":(e,t)=>g(e,t,!1),"Array | Matrix, Array | Matrix, number":(e,t,n)=>m(e,t,!1,n,g),"Array | Matrix, Array | Matrix, boolean":g,"Array | Matrix, Array | Matrix, boolean, number":(e,t,n,r)=>m(e,t,n,r,g)});function m(e,t,n,r,i){return f(e,r,e=>i(e,t,n))}function p(e,t,i){var a,s=e.valueOf();if(u(t,0))throw new Error("N/prob must be non-negative");if(d(t,1))return Ad(t)?v(s,t,i):n(v(s,t,i));if(h(t,1)){if(!c(t))throw new Error("N must be a positive integer");if(h(t,4294967295))throw new Error("N must be less than or equal to 2^32-1, as that is the maximum length of an Array");var l=r(t,1);a=[];for(var f=0;u(f,t);f++){var m=o(f+1,l);a.push(v(s,m,i))}return Ad(t)?a:n(a)}}function g(e,t,n){for(var r=e.valueOf(),i=t.valueOf(),o=[],a=0;a<i.length;++a)o.push(v(r,i[a],n));return o}function v(e,t,n){var o=Sf(e),u=o.length;if(0===u)throw new Error("Cannot calculate quantile of an empty sequence");var d,h,f=Ad(t)?t*(u-1):t.times(u-1),m=Ad(t)?Math.floor(f):f.floor().toNumber(),p=Ad(t)?f%1:f.minus(m);if(c(f))return n?o[f]:s(o,Ad(t)?f:f.valueOf());if(n)d=o[m],h=o[m+1];else{h=s(o,m+1),d=o[m];for(var g=0;g<m;++g)l(o[g],d)>0&&(d=o[g])}return r(a(d,i(1,p)),a(h,p))}}),Fv=vh("quantileSeq",["typed","bignumber","add","subtract","divide","multiply","partitionSelect","compare","isInteger","smaller","smallerEq","larger","mapSlices"],e=>{var{typed:t,bignumber:n,add:r,subtract:i,divide:o,multiply:a,partitionSelect:s,compare:l,isInteger:c,smaller:u,smallerEq:d,larger:h,mapSlices:f}=e,m=jv({typed:t,bignumber:n,add:r,subtract:i,divide:o,multiply:a,partitionSelect:s,compare:l,isInteger:c,smaller:u,smallerEq:d,larger:h,mapSlices:f});return t("quantileSeq",{"Array | Matrix, number | BigNumber":m,"Array | Matrix, number | BigNumber, number":(e,t,n)=>m(e,t,p(n)),"Array | Matrix, number | BigNumber, boolean":m,"Array | Matrix, number | BigNumber, boolean, number":(e,t,n,r)=>m(e,t,n,p(r)),"Array | Matrix, Array | Matrix":m,"Array | Matrix, Array | Matrix, number":(e,t,n)=>m(e,t,p(n)),"Array | Matrix, Array | Matrix, boolean":m,"Array | Matrix, Array | Matrix, boolean, number":(e,t,n,r)=>m(e,t,n,p(r))});function p(e){return wg([[],e])[1]}},{isTransformFunction:!0}),Hv="unbiased",Lv="variance",Bv=vh(Lv,["typed","add","subtract","multiply","divide","mapSlices","isNaN"],e=>{var{typed:t,add:n,subtract:r,multiply:i,divide:o,mapSlices:a,isNaN:s}=e;return t(Lv,{"Array | Matrix":function(e){return l(e,Hv)},"Array | Matrix, string":l,"Array | Matrix, number | BigNumber":function(e,t){return c(e,t,Hv)},"Array | Matrix, number | BigNumber, string":c,"...":function(e){return l(e,Hv)}});function l(e,t){var a,l=0;if(0===e.length)throw new SyntaxError("Function variance requires one or more parameters (0 provided)");if(Im(e,function(e){try{a=void 0===a?e:n(a,e),l++}catch(t){throw yg(t,"variance",e)}}),0===l)throw new Error("Cannot calculate variance of an empty array");var c=o(a,l);if(a=void 0,Im(e,function(e){var t=r(e,c);a=void 0===a?i(t,t):n(a,i(t,t))}),s(a))return a;switch(t){case"uncorrected":return o(a,l);case"biased":return o(a,l+1);case"unbiased":var u=Rd(a)?a.mul(0):0;return 1===l?u:o(a,l-1);default:throw new Error('Unknown normalization "'+t+'". Choose "unbiased" (default), "uncorrected", or "biased".')}}function c(e,t,n){try{if(0===e.length)throw new SyntaxError("Function variance requires one or more parameters (0 provided)");return a(e,t,e=>l(e,n))}catch(r){throw yg(r,"variance")}}}),zv="variance",Wv=vh(zv,["typed","add","subtract","multiply","divide","mapSlices","isNaN"],e=>{var{typed:t,add:n,subtract:r,multiply:i,divide:o,mapSlices:a,isNaN:s}=e,l=Bv({typed:t,add:n,subtract:r,multiply:i,divide:o,mapSlices:a,isNaN:s});return t(zv,{"...any":function(e){e=wg(e);try{return l.apply(null,e)}catch(t){throw Cm(t)}}})},{isTransformFunction:!0}),Vv=vh("std",["typed","map","sqrt","variance"],e=>{var{typed:t,map:n,sqrt:r,variance:i}=e;return t("std",{"Array | Matrix":o,"Array | Matrix, string":o,"Array | Matrix, number | BigNumber":o,"Array | Matrix, number | BigNumber, string":o,"...":function(e){return o(e)}});function o(e,t){if(0===e.length)throw new SyntaxError("Function std requires one or more parameters (0 provided)");try{var o=i.apply(null,arguments);return jd(o)?n(o,r):r(o)}catch(a){throw a instanceof TypeError&&a.message.includes(" variance")?new TypeError(a.message.replace(" variance"," std")):a}}}),Uv=vh("std",["typed","map","sqrt","variance"],e=>{var{typed:t,map:n,sqrt:r,variance:i}=e,o=Vv({typed:t,map:n,sqrt:r,variance:i});return t("std",{"...any":function(e){e=wg(e);try{return o.apply(null,e)}catch(t){throw Cm(t)}}})},{isTransformFunction:!0}),qv=9e15,Gv=1e9,Yv="0123456789abcdef",Kv="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",$v="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Xv={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-qv,maxE:qv,crypto:!1},Qv=!0,Jv="[DecimalError] ",Zv=Jv+"Invalid argument: ",ey=Jv+"Precision limit exceeded",ty=Jv+"crypto unavailable",ny="[object Decimal]",ry=Math.floor,iy=Math.pow,oy=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,ay=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,sy=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,ly=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,cy=1e7,uy=Kv.length-1,dy=$v.length-1,hy={toStringTag:ny};function fy(e){var t,n,r,i=e.length-1,o="",a=e[0];if(i>0){for(o+=a,t=1;t<i;t++)(n=7-(r=e[t]+"").length)&&(o+=Ey(n)),o+=r;(n=7-(r=(a=e[t])+"").length)&&(o+=Ey(n))}else if(0===a)return"0";for(;a%10===0;)a/=10;return o+a}function my(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Zv+e)}function py(e,t,n,r){var i,o,a,s;for(o=e[0];o>=10;o/=10)--t;return--t<0?(t+=7,i=0):(i=Math.ceil((t+1)/7),t%=7),o=iy(10,7-t),s=e[i]%o|0,null==r?t<3?(0==t?s=s/100|0:1==t&&(s=s/10|0),a=n<4&&99999==s||n>3&&49999==s||5e4==s||0==s):a=(n<4&&s+1==o||n>3&&s+1==o/2)&&(e[i+1]/o/100|0)==iy(10,t-2)-1||(s==o/2||0==s)&&0==(e[i+1]/o/100|0):t<4?(0==t?s=s/1e3|0:1==t?s=s/100|0:2==t&&(s=s/10|0),a=(r||n<4)&&9999==s||!r&&n>3&&4999==s):a=((r||n<4)&&s+1==o||!r&&n>3&&s+1==o/2)&&(e[i+1]/o/1e3|0)==iy(10,t-3)-1,a}function gy(e,t,n){for(var r,i,o=[0],a=0,s=e.length;a<s;){for(i=o.length;i--;)o[i]*=t;for(o[0]+=Yv.indexOf(e.charAt(a++)),r=0;r<o.length;r++)o[r]>n-1&&(void 0===o[r+1]&&(o[r+1]=0),o[r+1]+=o[r]/n|0,o[r]%=n)}return o.reverse()}hy.absoluteValue=hy.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),yy(e)},hy.ceil=function(){return yy(new this.constructor(this),this.e+1,2)},hy.clampedTo=hy.clamp=function(e,t){var n=this,r=n.constructor;if(e=new r(e),t=new r(t),!e.s||!t.s)return new r(NaN);if(e.gt(t))throw Error(Zv+t);return n.cmp(e)<0?e:n.cmp(t)>0?t:new r(n)},hy.comparedTo=hy.cmp=function(e){var t,n,r,i,o=this,a=o.d,s=(e=new o.constructor(e)).d,l=o.s,c=e.s;if(!a||!s)return l&&c?l!==c?l:a===s?0:!a^l<0?1:-1:NaN;if(!a[0]||!s[0])return a[0]?l:s[0]?-c:0;if(l!==c)return l;if(o.e!==e.e)return o.e>e.e^l<0?1:-1;for(t=0,n=(r=a.length)<(i=s.length)?r:i;t<n;++t)if(a[t]!==s[t])return a[t]>s[t]^l<0?1:-1;return r===i?0:r>i^l<0?1:-1},hy.cosine=hy.cos=function(){var e,t,n=this,r=n.constructor;return n.d?n.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+7,r.rounding=1,n=function(e,t){var n,r,i;if(t.isZero())return t;r=t.d.length,r<32?i=(1/Iy(4,n=Math.ceil(r/3))).toString():(n=16,i="2.3283064365386962890625e-10");e.precision+=n,t=Oy(e,1,t.times(i),new e(1));for(var o=n;o--;){var a=t.times(t);t=a.times(a).minus(a).times(8).plus(1)}return e.precision-=n,t}(r,Py(r,n)),r.precision=e,r.rounding=t,yy(2==sv||3==sv?n.neg():n,e,t,!0)):new r(1):new r(NaN)},hy.cubeRoot=hy.cbrt=function(){var e,t,n,r,i,o,a,s,l,c,u=this,d=u.constructor;if(!u.isFinite()||u.isZero())return new d(u);for(Qv=!1,(o=u.s*iy(u.s*u,1/3))&&Math.abs(o)!=1/0?r=new d(o.toString()):(n=fy(u.d),(o=((e=u.e)-n.length+1)%3)&&(n+=1==o||-2==o?"0":"00"),o=iy(n,1/3),e=ry((e+1)/3)-(e%3==(e<0?-1:2)),(r=new d(n=o==1/0?"5e"+e:(n=o.toExponential()).slice(0,n.indexOf("e")+1)+e)).s=u.s),a=(e=d.precision)+3;;)if(c=(l=(s=r).times(s).times(s)).plus(u),r=vy(c.plus(u).times(s),c.plus(l),a+2,1),fy(s.d).slice(0,a)===(n=fy(r.d)).slice(0,a)){if("9999"!=(n=n.slice(a-3,a+1))&&(i||"4999"!=n)){+n&&(+n.slice(1)||"5"!=n.charAt(0))||(yy(r,e+1,1),t=!r.times(r).times(r).eq(u));break}if(!i&&(yy(s,e+1,0),s.times(s).times(s).eq(u))){r=s;break}a+=4,i=1}return Qv=!0,yy(r,e,d.rounding,t)},hy.decimalPlaces=hy.dp=function(){var e,t=this.d,n=NaN;if(t){if(n=7*((e=t.length-1)-ry(this.e/7)),e=t[e])for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n},hy.dividedBy=hy.div=function(e){return vy(this,new this.constructor(e))},hy.dividedToIntegerBy=hy.divToInt=function(e){var t=this.constructor;return yy(vy(this,new t(e),0,1,1),t.precision,t.rounding)},hy.equals=hy.eq=function(e){return 0===this.cmp(e)},hy.floor=function(){return yy(new this.constructor(this),this.e+1,3)},hy.greaterThan=hy.gt=function(e){return this.cmp(e)>0},hy.greaterThanOrEqualTo=hy.gte=function(e){var t=this.cmp(e);return 1==t||0===t},hy.hyperbolicCosine=hy.cosh=function(){var e,t,n,r,i,o=this,a=o.constructor,s=new a(1);if(!o.isFinite())return new a(o.s?1/0:NaN);if(o.isZero())return s;n=a.precision,r=a.rounding,a.precision=n+Math.max(o.e,o.sd())+4,a.rounding=1,(i=o.d.length)<32?t=(1/Iy(4,e=Math.ceil(i/3))).toString():(e=16,t="2.3283064365386962890625e-10"),o=Oy(a,1,o.times(t),new a(1),!0);for(var l,c=e,u=new a(8);c--;)l=o.times(o),o=s.minus(l.times(u.minus(l.times(u))));return yy(o,a.precision=n,a.rounding=r,!0)},hy.hyperbolicSine=hy.sinh=function(){var e,t,n,r,i=this,o=i.constructor;if(!i.isFinite()||i.isZero())return new o(i);if(t=o.precision,n=o.rounding,o.precision=t+Math.max(i.e,i.sd())+4,o.rounding=1,(r=i.d.length)<3)i=Oy(o,2,i,i,!0);else{e=(e=1.4*Math.sqrt(r))>16?16:0|e,i=Oy(o,2,i=i.times(1/Iy(5,e)),i,!0);for(var a,s=new o(5),l=new o(16),c=new o(20);e--;)a=i.times(i),i=i.times(s.plus(a.times(l.times(a).plus(c))))}return o.precision=t,o.rounding=n,yy(i,t,n,!0)},hy.hyperbolicTangent=hy.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,vy(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)},hy.inverseCosine=hy.acos=function(){var e=this,t=e.constructor,n=e.abs().cmp(1),r=t.precision,i=t.rounding;return-1!==n?0===n?e.isNeg()?Sy(t,r,i):new t(0):new t(NaN):e.isZero()?Sy(t,r+4,i).times(.5):(t.precision=r+6,t.rounding=1,e=new t(1).minus(e).div(e.plus(1)).sqrt().atan(),t.precision=r,t.rounding=i,e.times(2))},hy.inverseHyperbolicCosine=hy.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,Qv=!1,n=n.times(n).minus(1).sqrt().plus(n),Qv=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)},hy.inverseHyperbolicSine=hy.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,Qv=!1,n=n.times(n).plus(1).sqrt().plus(n),Qv=!0,r.precision=e,r.rounding=t,n.ln())},hy.inverseHyperbolicTangent=hy.atanh=function(){var e,t,n,r,i=this,o=i.constructor;return i.isFinite()?i.e>=0?new o(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=o.precision,t=o.rounding,r=i.sd(),Math.max(r,e)<2*-i.e-1?yy(new o(i),e,t,!0):(o.precision=n=r-i.e,i=vy(i.plus(1),new o(1).minus(i),n+e,1),o.precision=e+4,o.rounding=1,i=i.ln(),o.precision=e,o.rounding=t,i.times(.5))):new o(NaN)},hy.inverseSine=hy.asin=function(){var e,t,n,r,i=this,o=i.constructor;return i.isZero()?new o(i):(t=i.abs().cmp(1),n=o.precision,r=o.rounding,-1!==t?0===t?((e=Sy(o,n+4,r).times(.5)).s=i.s,e):new o(NaN):(o.precision=n+6,o.rounding=1,i=i.div(new o(1).minus(i.times(i)).sqrt().plus(1)).atan(),o.precision=n,o.rounding=r,i.times(2)))},hy.inverseTangent=hy.atan=function(){var e,t,n,r,i,o,a,s,l,c=this,u=c.constructor,d=u.precision,h=u.rounding;if(c.isFinite()){if(c.isZero())return new u(c);if(c.abs().eq(1)&&d+4<=dy)return(a=Sy(u,d+4,h).times(.25)).s=c.s,a}else{if(!c.s)return new u(NaN);if(d+4<=dy)return(a=Sy(u,d+4,h).times(.5)).s=c.s,a}for(u.precision=s=d+10,u.rounding=1,e=n=Math.min(28,s/7+2|0);e;--e)c=c.div(c.times(c).plus(1).sqrt().plus(1));for(Qv=!1,t=Math.ceil(s/7),r=1,l=c.times(c),a=new u(c),i=c;-1!==e;)if(i=i.times(l),o=a.minus(i.div(r+=2)),i=i.times(l),void 0!==(a=o.plus(i.div(r+=2))).d[t])for(e=t;a.d[e]===o.d[e]&&e--;);return n&&(a=a.times(2<<n-1)),Qv=!0,yy(a,u.precision=d,u.rounding=h,!0)},hy.isFinite=function(){return!!this.d},hy.isInteger=hy.isInt=function(){return!!this.d&&ry(this.e/7)>this.d.length-2},hy.isNaN=function(){return!this.s},hy.isNegative=hy.isNeg=function(){return this.s<0},hy.isPositive=hy.isPos=function(){return this.s>0},hy.isZero=function(){return!!this.d&&0===this.d[0]},hy.lessThan=hy.lt=function(e){return this.cmp(e)<0},hy.lessThanOrEqualTo=hy.lte=function(e){return this.cmp(e)<1},hy.logarithm=hy.log=function(e){var t,n,r,i,o,a,s,l,c=this,u=c.constructor,d=u.precision,h=u.rounding;if(null==e)e=new u(10),t=!0;else{if(n=(e=new u(e)).d,e.s<0||!n||!n[0]||e.eq(1))return new u(NaN);t=e.eq(10)}if(n=c.d,c.s<0||!n||!n[0]||c.eq(1))return new u(n&&!n[0]?-1/0:1!=c.s?NaN:n?0:1/0);if(t)if(n.length>1)o=!0;else{for(i=n[0];i%10===0;)i/=10;o=1!==i}if(Qv=!1,a=ky(c,s=d+5),r=t?xy(u,s+10):ky(e,s),py((l=vy(a,r,s,1)).d,i=d,h))do{if(a=ky(c,s+=10),r=t?xy(u,s+10):ky(e,s),l=vy(a,r,s,1),!o){+fy(l.d).slice(i+1,i+15)+1==1e14&&(l=yy(l,d+1,0));break}}while(py(l.d,i+=10,h));return Qv=!0,yy(l,d,h)},hy.minus=hy.sub=function(e){var t,n,r,i,o,a,s,l,c,u,d,h,f=this,m=f.constructor;if(e=new m(e),!f.d||!e.d)return f.s&&e.s?f.d?e.s=-e.s:e=new m(e.d||f.s!==e.s?f:NaN):e=new m(NaN),e;if(f.s!=e.s)return e.s=-e.s,f.plus(e);if(c=f.d,h=e.d,s=m.precision,l=m.rounding,!c[0]||!h[0]){if(h[0])e.s=-e.s;else{if(!c[0])return new m(3===l?-0:0);e=new m(f)}return Qv?yy(e,s,l):e}if(n=ry(e.e/7),u=ry(f.e/7),c=c.slice(),o=u-n){for((d=o<0)?(t=c,o=-o,a=h.length):(t=h,n=u,a=c.length),o>(r=Math.max(Math.ceil(s/7),a)+2)&&(o=r,t.length=1),t.reverse(),r=o;r--;)t.push(0);t.reverse()}else{for((d=(r=c.length)<(a=h.length))&&(a=r),r=0;r<a;r++)if(c[r]!=h[r]){d=c[r]<h[r];break}o=0}for(d&&(t=c,c=h,h=t,e.s=-e.s),a=c.length,r=h.length-a;r>0;--r)c[a++]=0;for(r=h.length;r>o;){if(c[--r]<h[r]){for(i=r;i&&0===c[--i];)c[i]=cy-1;--c[i],c[r]+=cy}c[r]-=h[r]}for(;0===c[--a];)c.pop();for(;0===c[0];c.shift())--n;return c[0]?(e.d=c,e.e=wy(c,n),Qv?yy(e,s,l):e):new m(3===l?-0:0)},hy.modulo=hy.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?yy(new r(n),r.precision,r.rounding):(Qv=!1,9==r.modulo?(t=vy(n,e.abs(),0,3,1)).s*=e.s:t=vy(n,e,0,r.modulo,1),t=t.times(e),Qv=!0,n.minus(t))},hy.naturalExponential=hy.exp=function(){return Ry(this)},hy.naturalLogarithm=hy.ln=function(){return ky(this)},hy.negated=hy.neg=function(){var e=new this.constructor(this);return e.s=-e.s,yy(e)},hy.plus=hy.add=function(e){var t,n,r,i,o,a,s,l,c,u,d=this,h=d.constructor;if(e=new h(e),!d.d||!e.d)return d.s&&e.s?d.d||(e=new h(e.d||d.s===e.s?d:NaN)):e=new h(NaN),e;if(d.s!=e.s)return e.s=-e.s,d.minus(e);if(c=d.d,u=e.d,s=h.precision,l=h.rounding,!c[0]||!u[0])return u[0]||(e=new h(d)),Qv?yy(e,s,l):e;if(o=ry(d.e/7),r=ry(e.e/7),c=c.slice(),i=o-r){for(i<0?(n=c,i=-i,a=u.length):(n=u,r=o,a=c.length),i>(a=(o=Math.ceil(s/7))>a?o+1:a+1)&&(i=a,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for((a=c.length)-(i=u.length)<0&&(i=a,n=u,u=c,c=n),t=0;i;)t=(c[--i]=c[i]+u[i]+t)/cy|0,c[i]%=cy;for(t&&(c.unshift(t),++r),a=c.length;0==c[--a];)c.pop();return e.d=c,e.e=wy(c,r),Qv?yy(e,s,l):e},hy.precision=hy.sd=function(e){var t,n=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(Zv+e);return n.d?(t=Cy(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t},hy.round=function(){var e=this,t=e.constructor;return yy(new t(e),e.e+1,t.rounding)},hy.sine=hy.sin=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+7,r.rounding=1,n=function(e,t){var n,r=t.d.length;if(r<3)return t.isZero()?t:Oy(e,2,t,t);n=(n=1.4*Math.sqrt(r))>16?16:0|n,t=t.times(1/Iy(5,n)),t=Oy(e,2,t,t);for(var i,o=new e(5),a=new e(16),s=new e(20);n--;)i=t.times(t),t=t.times(o.plus(i.times(a.times(i).minus(s))));return t}(r,Py(r,n)),r.precision=e,r.rounding=t,yy(sv>2?n.neg():n,e,t,!0)):new r(NaN)},hy.squareRoot=hy.sqrt=function(){var e,t,n,r,i,o,a=this,s=a.d,l=a.e,c=a.s,u=a.constructor;if(1!==c||!s||!s[0])return new u(!c||c<0&&(!s||s[0])?NaN:s?a:1/0);for(Qv=!1,0==(c=Math.sqrt(+a))||c==1/0?(((t=fy(s)).length+l)%2==0&&(t+="0"),c=Math.sqrt(t),l=ry((l+1)/2)-(l<0||l%2),r=new u(t=c==1/0?"5e"+l:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+l)):r=new u(c.toString()),n=(l=u.precision)+3;;)if(r=(o=r).plus(vy(a,o,n+2,1)).times(.5),fy(o.d).slice(0,n)===(t=fy(r.d)).slice(0,n)){if("9999"!=(t=t.slice(n-3,n+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(yy(r,l+1,1),e=!r.times(r).eq(a));break}if(!i&&(yy(o,l+1,0),o.times(o).eq(a))){r=o;break}n+=4,i=1}return Qv=!0,yy(r,l,u.rounding,e)},hy.tangent=hy.tan=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,(n=n.sin()).s=1,n=vy(n,new r(1).minus(n.times(n)).sqrt(),e+10,0),r.precision=e,r.rounding=t,yy(2==sv||4==sv?n.neg():n,e,t,!0)):new r(NaN)},hy.times=hy.mul=function(e){var t,n,r,i,o,a,s,l,c,u=this,d=u.constructor,h=u.d,f=(e=new d(e)).d;if(e.s*=u.s,!h||!h[0]||!f||!f[0])return new d(!e.s||h&&!h[0]&&!f||f&&!f[0]&&!h?NaN:h&&f?0*e.s:e.s/0);for(n=ry(u.e/7)+ry(e.e/7),(l=h.length)<(c=f.length)&&(o=h,h=f,f=o,a=l,l=c,c=a),o=[],r=a=l+c;r--;)o.push(0);for(r=c;--r>=0;){for(t=0,i=l+r;i>r;)s=o[i]+f[r]*h[i-r-1]+t,o[i--]=s%cy|0,t=s/cy|0;o[i]=(o[i]+t)%cy|0}for(;!o[--a];)o.pop();return t?++n:o.shift(),e.d=o,e.e=wy(o,n),Qv?yy(e,d.precision,d.rounding):e},hy.toBinary=function(e,t){return jy(this,2,e,t)},hy.toDecimalPlaces=hy.toDP=function(e,t){var n=this,r=n.constructor;return n=new r(n),void 0===e?n:(my(e,0,Gv),void 0===t?t=r.rounding:my(t,0,8),yy(n,e+n.e+1,t))},hy.toExponential=function(e,t){var n,r=this,i=r.constructor;return void 0===e?n=by(r,!0):(my(e,0,Gv),void 0===t?t=i.rounding:my(t,0,8),n=by(r=yy(new i(r),e+1,t),!0,e+1)),r.isNeg()&&!r.isZero()?"-"+n:n},hy.toFixed=function(e,t){var n,r,i=this,o=i.constructor;return void 0===e?n=by(i):(my(e,0,Gv),void 0===t?t=o.rounding:my(t,0,8),n=by(r=yy(new o(i),e+i.e+1,t),!1,e+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n},hy.toFraction=function(e){var t,n,r,i,o,a,s,l,c,u,d,h,f=this,m=f.d,p=f.constructor;if(!m)return new p(f);if(c=n=new p(1),r=l=new p(0),a=(o=(t=new p(r)).e=Cy(m)-f.e-1)%7,t.d[0]=iy(10,a<0?7+a:a),null==e)e=o>0?t:c;else{if(!(s=new p(e)).isInt()||s.lt(c))throw Error(Zv+s);e=s.gt(t)?o>0?t:c:s}for(Qv=!1,s=new p(fy(m)),u=p.precision,p.precision=o=7*m.length*2;d=vy(s,t,0,1,1),1!=(i=n.plus(d.times(r))).cmp(e);)n=r,r=i,i=c,c=l.plus(d.times(i)),l=i,i=t,t=s.minus(d.times(i)),s=i;return i=vy(e.minus(n),r,0,1,1),l=l.plus(i.times(c)),n=n.plus(i.times(r)),l.s=c.s=f.s,h=vy(c,r,o,1).minus(f).abs().cmp(vy(l,n,o,1).minus(f).abs())<1?[c,r]:[l,n],p.precision=u,Qv=!0,h},hy.toHexadecimal=hy.toHex=function(e,t){return jy(this,16,e,t)},hy.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),null==e){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),void 0===t?t=r.rounding:my(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(Qv=!1,n=vy(n,e,0,t,1).times(e),Qv=!0,yy(n)):(e.s=n.s,n=e),n},hy.toNumber=function(){return+this},hy.toOctal=function(e,t){return jy(this,8,e,t)},hy.toPower=hy.pow=function(e){var t,n,r,i,o,a,s=this,l=s.constructor,c=+(e=new l(e));if(!s.d||!e.d||!s.d[0]||!e.d[0])return new l(iy(+s,c));if((s=new l(s)).eq(1))return s;if(r=l.precision,o=l.rounding,e.eq(1))return yy(s,r,o);if((t=ry(e.e/7))>=e.d.length-1&&(n=c<0?-c:c)<=9007199254740991)return i=Ny(l,s,n,r),e.s<0?new l(1).div(i):yy(i,r,o);if((a=s.s)<0){if(t<e.d.length-1)return new l(NaN);if(0==(1&e.d[t])&&(a=1),0==s.e&&1==s.d[0]&&1==s.d.length)return s.s=a,s}return(t=0!=(n=iy(+s,c))&&isFinite(n)?new l(n+"").e:ry(c*(Math.log("0."+fy(s.d))/Math.LN10+s.e+1)))>l.maxE+1||t<l.minE-1?new l(t>0?a/0:0):(Qv=!1,l.rounding=s.s=1,n=Math.min(12,(t+"").length),(i=Ry(e.times(ky(s,r+n)),r)).d&&py((i=yy(i,r+5,1)).d,r,o)&&(t=r+10,+fy((i=yy(Ry(e.times(ky(s,t+n)),t),t+5,1)).d).slice(r+1,r+15)+1==1e14&&(i=yy(i,r+1,0))),i.s=a,Qv=!0,l.rounding=o,yy(i,r,o))},hy.toPrecision=function(e,t){var n,r=this,i=r.constructor;return void 0===e?n=by(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(my(e,1,Gv),void 0===t?t=i.rounding:my(t,0,8),n=by(r=yy(new i(r),e,t),e<=r.e||r.e<=i.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+n:n},hy.toSignificantDigits=hy.toSD=function(e,t){var n=this.constructor;return void 0===e?(e=n.precision,t=n.rounding):(my(e,1,Gv),void 0===t?t=n.rounding:my(t,0,8)),yy(new n(this),e,t)},hy.toString=function(){var e=this,t=e.constructor,n=by(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n},hy.truncated=hy.trunc=function(){return yy(new this.constructor(this),this.e+1,1)},hy.valueOf=hy.toJSON=function(){var e=this,t=e.constructor,n=by(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};var vy=function(){function e(e,t,n){var r,i=0,o=e.length;for(e=e.slice();o--;)r=e[o]*t+i,e[o]=r%n|0,i=r/n|0;return i&&e.unshift(i),e}function t(e,t,n,r){var i,o;if(n!=r)o=n>r?1:-1;else for(i=o=0;i<n;i++)if(e[i]!=t[i]){o=e[i]>t[i]?1:-1;break}return o}function n(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(r,i,o,a,s,l){var c,u,d,h,f,m,p,g,v,y,b,w,x,S,C,E,N,T,A,R,k=r.constructor,M=r.s==i.s?1:-1,D=r.d,_=i.d;if(!D||!D[0]||!_||!_[0])return new k(r.s&&i.s&&(D?!_||D[0]!=_[0]:_)?D&&0==D[0]||!_?0*M:M/0:NaN);for(l?(f=1,u=r.e-i.e):(l=cy,f=7,u=ry(r.e/f)-ry(i.e/f)),A=_.length,N=D.length,y=(v=new k(M)).d=[],d=0;_[d]==(D[d]||0);d++);if(_[d]>(D[d]||0)&&u--,null==o?(S=o=k.precision,a=k.rounding):S=s?o+(r.e-i.e)+1:o,S<0)y.push(1),m=!0;else{if(S=S/f+2|0,d=0,1==A){for(h=0,_=_[0],S++;(d<N||h)&&S--;d++)C=h*l+(D[d]||0),y[d]=C/_|0,h=C%_|0;m=h||d<N}else{for((h=l/(_[0]+1)|0)>1&&(_=e(_,h,l),D=e(D,h,l),A=_.length,N=D.length),E=A,w=(b=D.slice(0,A)).length;w<A;)b[w++]=0;(R=_.slice()).unshift(0),T=_[0],_[1]>=l/2&&++T;do{h=0,(c=t(_,b,A,w))<0?(x=b[0],A!=w&&(x=x*l+(b[1]||0)),(h=x/T|0)>1?(h>=l&&(h=l-1),1==(c=t(p=e(_,h,l),b,g=p.length,w=b.length))&&(h--,n(p,A<g?R:_,g,l))):(0==h&&(c=h=1),p=_.slice()),(g=p.length)<w&&p.unshift(0),n(b,p,w,l),-1==c&&(c=t(_,b,A,w=b.length))<1&&(h++,n(b,A<w?R:_,w,l)),w=b.length):0===c&&(h++,b=[0]),y[d++]=h,c&&b[0]?b[w++]=D[E]||0:(b=[D[E]],w=1)}while((E++<N||void 0!==b[0])&&S--);m=void 0!==b[0]}y[0]||y.shift()}if(1==f)v.e=u,av=m;else{for(d=1,h=y[0];h>=10;h/=10)d++;v.e=d+u*f-1,yy(v,s?o+v.e+1:o,a,m)}return v}}();function yy(e,t,n,r){var i,o,a,s,l,c,u,d,h,f=e.constructor;e:if(null!=t){if(!(d=e.d))return e;for(i=1,s=d[0];s>=10;s/=10)i++;if((o=t-i)<0)o+=7,a=t,l=(u=d[h=0])/iy(10,i-a-1)%10|0;else if((h=Math.ceil((o+1)/7))>=(s=d.length)){if(!r)break e;for(;s++<=h;)d.push(0);u=l=0,i=1,a=(o%=7)-7+1}else{for(u=s=d[h],i=1;s>=10;s/=10)i++;l=(a=(o%=7)-7+i)<0?0:u/iy(10,i-a-1)%10|0}if(r=r||t<0||void 0!==d[h+1]||(a<0?u:u%iy(10,i-a-1)),c=n<4?(l||r)&&(0==n||n==(e.s<0?3:2)):l>5||5==l&&(4==n||r||6==n&&(o>0?a>0?u/iy(10,i-a):0:d[h-1])%10&1||n==(e.s<0?8:7)),t<1||!d[0])return d.length=0,c?(t-=e.e+1,d[0]=iy(10,(7-t%7)%7),e.e=-t||0):d[0]=e.e=0,e;if(0==o?(d.length=h,s=1,h--):(d.length=h+1,s=iy(10,7-o),d[h]=a>0?(u/iy(10,i-a)%iy(10,a)|0)*s:0),c)for(;;){if(0==h){for(o=1,a=d[0];a>=10;a/=10)o++;for(a=d[0]+=s,s=1;a>=10;a/=10)s++;o!=s&&(e.e++,d[0]==cy&&(d[0]=1));break}if(d[h]+=s,d[h]!=cy)break;d[h--]=0,s=1}for(o=d.length;0===d[--o];)d.pop()}return Qv&&(e.e>f.maxE?(e.d=null,e.e=NaN):e.e<f.minE&&(e.e=0,e.d=[0])),e}function by(e,t,n){if(!e.isFinite())return My(e);var r,i=e.e,o=fy(e.d),a=o.length;return t?(n&&(r=n-a)>0?o=o.charAt(0)+"."+o.slice(1)+Ey(r):a>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(e.e<0?"e":"e+")+e.e):i<0?(o="0."+Ey(-i-1)+o,n&&(r=n-a)>0&&(o+=Ey(r))):i>=a?(o+=Ey(i+1-a),n&&(r=n-i-1)>0&&(o=o+"."+Ey(r))):((r=i+1)<a&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-a)>0&&(i+1===a&&(o+="."),o+=Ey(r))),o}function wy(e,t){var n=e[0];for(t*=7;n>=10;n/=10)t++;return t}function xy(e,t,n){if(t>uy)throw Qv=!0,n&&(e.precision=n),Error(ey);return yy(new e(Kv),t,1,!0)}function Sy(e,t,n){if(t>dy)throw Error(ey);return yy(new e($v),t,n,!0)}function Cy(e){var t=e.length-1,n=7*t+1;if(t=e[t]){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function Ey(e){for(var t="";e--;)t+="0";return t}function Ny(e,t,n,r){var i,o=new e(1),a=Math.ceil(r/7+4);for(Qv=!1;;){if(n%2&&Fy((o=o.times(t)).d,a)&&(i=!0),0===(n=ry(n/2))){n=o.d.length-1,i&&0===o.d[n]&&++o.d[n];break}Fy((t=t.times(t)).d,a)}return Qv=!0,o}function Ty(e){return 1&e.d[e.d.length-1]}function Ay(e,t,n){for(var r,i,o=new e(t[0]),a=0;++a<t.length;){if(!(i=new e(t[a])).s){o=i;break}((r=o.cmp(i))===n||0===r&&o.s===n)&&(o=i)}return o}function Ry(e,t){var n,r,i,o,a,s,l,c=0,u=0,d=0,h=e.constructor,f=h.rounding,m=h.precision;if(!e.d||!e.d[0]||e.e>17)return new h(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(null==t?(Qv=!1,l=m):l=t,s=new h(.03125);e.e>-2;)e=e.times(s),d+=5;for(l+=r=Math.log(iy(2,d))/Math.LN10*2+5|0,n=o=a=new h(1),h.precision=l;;){if(o=yy(o.times(e),l,1),n=n.times(++u),fy((s=a.plus(vy(o,n,l,1))).d).slice(0,l)===fy(a.d).slice(0,l)){for(i=d;i--;)a=yy(a.times(a),l,1);if(null!=t)return h.precision=m,a;if(!(c<3&&py(a.d,l-r,f,c)))return yy(a,h.precision=m,f,Qv=!0);h.precision=l+=10,n=o=s=new h(1),u=0,c++}a=s}}function ky(e,t){var n,r,i,o,a,s,l,c,u,d,h,f=1,m=e,p=m.d,g=m.constructor,v=g.rounding,y=g.precision;if(m.s<0||!p||!p[0]||!m.e&&1==p[0]&&1==p.length)return new g(p&&!p[0]?-1/0:1!=m.s?NaN:p?0:m);if(null==t?(Qv=!1,u=y):u=t,g.precision=u+=10,r=(n=fy(p)).charAt(0),!(Math.abs(o=m.e)<15e14))return c=xy(g,u+2,y).times(o+""),m=ky(new g(r+"."+n.slice(1)),u-10).plus(c),g.precision=y,null==t?yy(m,y,v,Qv=!0):m;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=fy((m=m.times(e)).d)).charAt(0),f++;for(o=m.e,r>1?(m=new g("0."+n),o++):m=new g(r+"."+n.slice(1)),d=m,l=a=m=vy(m.minus(1),m.plus(1),u,1),h=yy(m.times(m),u,1),i=3;;){if(a=yy(a.times(h),u,1),fy((c=l.plus(vy(a,new g(i),u,1))).d).slice(0,u)===fy(l.d).slice(0,u)){if(l=l.times(2),0!==o&&(l=l.plus(xy(g,u+2,y).times(o+""))),l=vy(l,new g(f),u,1),null!=t)return g.precision=y,l;if(!py(l.d,u-10,v,s))return yy(l,g.precision=y,v,Qv=!0);g.precision=u+=10,c=a=m=vy(d.minus(1),d.plus(1),u,1),h=yy(m.times(m),u,1),i=s=1}l=c,i+=2}}function My(e){return String(e.s*e.s/0)}function Dy(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;48===t.charCodeAt(r);r++);for(i=t.length;48===t.charCodeAt(i-1);--i);if(t=t.slice(r,i)){if(i-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%7,n<0&&(r+=7),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=7;r<i;)e.d.push(+t.slice(r,r+=7));r=7-(t=t.slice(r)).length}else r-=i;for(;r--;)t+="0";e.d.push(+t),Qv&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function _y(e,t){var n,r,i,o,a,s,l,c,u;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),ly.test(t))return Dy(e,t)}else if("Infinity"===t||"NaN"===t)return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(ay.test(t))n=16,t=t.toLowerCase();else if(oy.test(t))n=2;else{if(!sy.test(t))throw Error(Zv+t);n=8}for((o=t.search(/p/i))>0?(l=+t.slice(o+1),t=t.substring(2,o)):t=t.slice(2),a=(o=t.indexOf("."))>=0,r=e.constructor,a&&(o=(s=(t=t.replace(".","")).length)-o,i=Ny(r,new r(n),o,2*o)),o=u=(c=gy(t,n,cy)).length-1;0===c[o];--o)c.pop();return o<0?new r(0*e.s):(e.e=wy(c,u),e.d=c,Qv=!1,a&&(e=vy(e,i,4*s)),l&&(e=e.times(Math.abs(l)<54?iy(2,l):Eb.pow(2,l))),Qv=!0,e)}function Oy(e,t,n,r,i){var o,a,s,l,c=e.precision,u=Math.ceil(c/7);for(Qv=!1,l=n.times(n),s=new e(r);;){if(a=vy(s.times(l),new e(t++*t++),c,1),s=i?r.plus(a):r.minus(a),r=vy(a.times(l),new e(t++*t++),c,1),void 0!==(a=s.plus(r)).d[u]){for(o=u;a.d[o]===s.d[o]&&o--;);if(-1==o)break}o=s,s=r,r=a,a=o}return Qv=!0,a.d.length=u+1,a}function Iy(e,t){for(var n=e;--t;)n*=e;return n}function Py(e,t){var n,r=t.s<0,i=Sy(e,e.precision,1),o=i.times(.5);if((t=t.abs()).lte(o))return sv=r?4:1,t;if((n=t.divToInt(i)).isZero())sv=r?3:2;else{if((t=t.minus(n.times(i))).lte(o))return sv=Ty(n)?r?2:3:r?4:1,t;sv=Ty(n)?r?1:4:r?3:2}return t.minus(i).abs()}function jy(e,t,n,r){var i,o,a,s,l,c,u,d,h,f=e.constructor,m=void 0!==n;if(m?(my(n,1,Gv),void 0===r?r=f.rounding:my(r,0,8)):(n=f.precision,r=f.rounding),e.isFinite()){for(m?(i=2,16==t?n=4*n-3:8==t&&(n=3*n-2)):i=t,(a=(u=by(e)).indexOf("."))>=0&&(u=u.replace(".",""),(h=new f(1)).e=u.length-a,h.d=gy(by(h),10,i),h.e=h.d.length),o=l=(d=gy(u,10,i)).length;0==d[--l];)d.pop();if(d[0]){if(a<0?o--:((e=new f(e)).d=d,e.e=o,d=(e=vy(e,h,n,r,0,i)).d,o=e.e,c=av),a=d[n],s=i/2,c=c||void 0!==d[n+1],c=r<4?(void 0!==a||c)&&(0===r||r===(e.s<0?3:2)):a>s||a===s&&(4===r||c||6===r&&1&d[n-1]||r===(e.s<0?8:7)),d.length=n,c)for(;++d[--n]>i-1;)d[n]=0,n||(++o,d.unshift(1));for(l=d.length;!d[l-1];--l);for(a=0,u="";a<l;a++)u+=Yv.charAt(d[a]);if(m){if(l>1)if(16==t||8==t){for(a=16==t?4:3,--l;l%a;l++)u+="0";for(l=(d=gy(u,i,t)).length;!d[l-1];--l);for(a=1,u="1.";a<l;a++)u+=Yv.charAt(d[a])}else u=u.charAt(0)+"."+u.slice(1);u=u+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)u="0"+u;u="0."+u}else if(++o>l)for(o-=l;o--;)u+="0";else o<l&&(u=u.slice(0,o)+"."+u.slice(o))}else u=m?"0p+0":"0";u=(16==t?"0x":2==t?"0b":8==t?"0o":"")+u}else u=My(e);return e.s<0?"-"+u:u}function Fy(e,t){if(e.length>t)return e.length=t,!0}function Hy(e){return new this(e).abs()}function Ly(e){return new this(e).acos()}function By(e){return new this(e).acosh()}function zy(e,t){return new this(e).plus(t)}function Wy(e){return new this(e).asin()}function Vy(e){return new this(e).asinh()}function Uy(e){return new this(e).atan()}function qy(e){return new this(e).atanh()}function Gy(e,t){e=new this(e),t=new this(t);var n,r=this.precision,i=this.rounding,o=r+4;return e.s&&t.s?e.d||t.d?!t.d||e.isZero()?(n=t.s<0?Sy(this,r,i):new this(0)).s=e.s:!e.d||t.isZero()?(n=Sy(this,o,1).times(.5)).s=e.s:t.s<0?(this.precision=o,this.rounding=1,n=this.atan(vy(e,t,o,1)),t=Sy(this,o,1),this.precision=r,this.rounding=i,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(vy(e,t,o,1)):(n=Sy(this,o,1).times(t.s>0?.25:.75)).s=e.s:n=new this(NaN),n}function Yy(e){return new this(e).cbrt()}function Ky(e){return yy(e=new this(e),e.e+1,2)}function $y(e,t,n){return new this(e).clamp(t,n)}function Xy(e){if(!e||"object"!==typeof e)throw Error(Jv+"Object expected");var t,n,r,i=!0===e.defaults,o=["precision",1,Gv,"rounding",0,8,"toExpNeg",-qv,0,"toExpPos",0,qv,"maxE",0,qv,"minE",-qv,0,"modulo",0,9];for(t=0;t<o.length;t+=3)if(n=o[t],i&&(this[n]=Xv[n]),void 0!==(r=e[n])){if(!(ry(r)===r&&r>=o[t+1]&&r<=o[t+2]))throw Error(Zv+n+": "+r);this[n]=r}if(n="crypto",i&&(this[n]=Xv[n]),void 0!==(r=e[n])){if(!0!==r&&!1!==r&&0!==r&&1!==r)throw Error(Zv+n+": "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(ty);this[n]=!0}else this[n]=!1}return this}function Qy(e){return new this(e).cos()}function Jy(e){return new this(e).cosh()}function Zy(e,t){return new this(e).div(t)}function eb(e){return new this(e).exp()}function tb(e){return yy(e=new this(e),e.e+1,3)}function nb(){var e,t,n=new this(0);for(Qv=!1,e=0;e<arguments.length;)if((t=new this(arguments[e++])).d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return Qv=!0,new this(1/0);n=t}return Qv=!0,n.sqrt()}function rb(e){return e instanceof Eb||e&&e.toStringTag===ny||!1}function ib(e){return new this(e).ln()}function ob(e,t){return new this(e).log(t)}function ab(e){return new this(e).log(2)}function sb(e){return new this(e).log(10)}function lb(){return Ay(this,arguments,-1)}function cb(){return Ay(this,arguments,1)}function ub(e,t){return new this(e).mod(t)}function db(e,t){return new this(e).mul(t)}function hb(e,t){return new this(e).pow(t)}function fb(e){var t,n,r,i,o=0,a=new this(1),s=[];if(void 0===e?e=this.precision:my(e,1,Gv),r=Math.ceil(e/7),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));o<r;)(i=t[o])>=429e7?t[o]=crypto.getRandomValues(new Uint32Array(1))[0]:s[o++]=i%1e7;else{if(!crypto.randomBytes)throw Error(ty);for(t=crypto.randomBytes(r*=4);o<r;)(i=t[o]+(t[o+1]<<8)+(t[o+2]<<16)+((127&t[o+3])<<24))>=214e7?crypto.randomBytes(4).copy(t,o):(s.push(i%1e7),o+=4);o=r/4}else for(;o<r;)s[o++]=1e7*Math.random()|0;for(e%=7,(r=s[--o])&&e&&(i=iy(10,7-e),s[o]=(r/i|0)*i);0===s[o];o--)s.pop();if(o<0)n=0,s=[0];else{for(n=-1;0===s[0];n-=7)s.shift();for(r=1,i=s[0];i>=10;i/=10)r++;r<7&&(n-=7-r)}return a.e=n,a.d=s,a}function mb(e){return yy(e=new this(e),e.e+1,this.rounding)}function pb(e){return(e=new this(e)).d?e.d[0]?e.s:0*e.s:e.s||NaN}function gb(e){return new this(e).sin()}function vb(e){return new this(e).sinh()}function yb(e){return new this(e).sqrt()}function bb(e,t){return new this(e).sub(t)}function wb(){var e=0,t=arguments,n=new this(t[e]);for(Qv=!1;n.s&&++e<t.length;)n=n.plus(t[e]);return Qv=!0,yy(n,this.precision,this.rounding)}function xb(e){return new this(e).tan()}function Sb(e){return new this(e).tanh()}function Cb(e){return yy(e=new this(e),e.e+1,1)}hy[Symbol.for("nodejs.util.inspect.custom")]=hy.toString,hy[Symbol.toStringTag]="Decimal";var Eb=hy.constructor=function e(t){var n,r,i;function o(e){var t,n,r,i=this;if(!(i instanceof o))return new o(e);if(i.constructor=o,rb(e))return i.s=e.s,void(Qv?!e.d||e.e>o.maxE?(i.e=NaN,i.d=null):e.e<o.minE?(i.e=0,i.d=[0]):(i.e=e.e,i.d=e.d.slice()):(i.e=e.e,i.d=e.d?e.d.slice():e.d));if("number"===(r=typeof e)){if(0===e)return i.s=1/e<0?-1:1,i.e=0,void(i.d=[0]);if(e<0?(e=-e,i.s=-1):i.s=1,e===~~e&&e<1e7){for(t=0,n=e;n>=10;n/=10)t++;return void(Qv?t>o.maxE?(i.e=NaN,i.d=null):t<o.minE?(i.e=0,i.d=[0]):(i.e=t,i.d=[e]):(i.e=t,i.d=[e]))}return 0*e!==0?(e||(i.s=NaN),i.e=NaN,void(i.d=null)):Dy(i,e.toString())}if("string"===r)return 45===(n=e.charCodeAt(0))?(e=e.slice(1),i.s=-1):(43===n&&(e=e.slice(1)),i.s=1),ly.test(e)?Dy(i,e):_y(i,e);if("bigint"===r)return e<0?(e=-e,i.s=-1):i.s=1,Dy(i,e.toString());throw Error(Zv+e)}if(o.prototype=hy,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.EUCLID=9,o.config=o.set=Xy,o.clone=e,o.isDecimal=rb,o.abs=Hy,o.acos=Ly,o.acosh=By,o.add=zy,o.asin=Wy,o.asinh=Vy,o.atan=Uy,o.atanh=qy,o.atan2=Gy,o.cbrt=Yy,o.ceil=Ky,o.clamp=$y,o.cos=Qy,o.cosh=Jy,o.div=Zy,o.exp=eb,o.floor=tb,o.hypot=nb,o.ln=ib,o.log=ob,o.log10=sb,o.log2=ab,o.max=lb,o.min=cb,o.mod=ub,o.mul=db,o.pow=hb,o.random=fb,o.round=mb,o.sign=pb,o.sin=gb,o.sinh=vb,o.sqrt=yb,o.sub=bb,o.sum=wb,o.tan=xb,o.tanh=Sb,o.trunc=Cb,void 0===t&&(t={}),t&&!0!==t.defaults)for(i=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],n=0;n<i.length;)t.hasOwnProperty(r=i[n++])||(t[r]=this[r]);return o.config(t),o}(Xv);Kv=new Eb(Kv),$v=new Eb($v);const Nb=Eb;var Tb=vh("BigNumber",["?on","config"],e=>{var{on:t,config:n}=e,r=Nb.clone({precision:n.precision,modulo:Nb.EUCLID});return r.prototype=Object.create(r.prototype),r.prototype.type="BigNumber",r.prototype.isBigNumber=!0,r.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},r.fromJSON=function(e){return new r(e.value)},t&&t("config",function(e,t){e.precision!==t.precision&&r.config({precision:e.precision})}),r},{isClass:!0});const Ab=Math.cosh||function(e){return Math.abs(e)<1e-9?1-e:.5*(Math.exp(e)+Math.exp(-e))},Rb=Math.sinh||function(e){return Math.abs(e)<1e-9?e:.5*(Math.exp(e)-Math.exp(-e))},kb=function(e,t){return(e=Math.abs(e))<(t=Math.abs(t))&&([e,t]=[t,e]),e<1e8?Math.sqrt(e*e+t*t):(t/=e,e*Math.sqrt(1+t*t))},Mb=function(){throw SyntaxError("Invalid Param")};function Db(e,t){const n=Math.abs(e),r=Math.abs(t);return 0===e?Math.log(r):0===t?Math.log(n):n<3e3&&r<3e3?.5*Math.log(e*e+t*t):(e*=.5,t*=.5,.5*Math.log(e*e+t*t)+Math.LN2)}const _b={re:0,im:0},Ob=function(e,t){const n=_b;if(void 0===e||null===e)n.re=n.im=0;else if(void 0!==t)n.re=e,n.im=t;else switch(typeof e){case"object":if("im"in e&&"re"in e)n.re=e.re,n.im=e.im;else if("abs"in e&&"arg"in e){if(!isFinite(e.abs)&&isFinite(e.arg))return Ib.INFINITY;n.re=e.abs*Math.cos(e.arg),n.im=e.abs*Math.sin(e.arg)}else if("r"in e&&"phi"in e){if(!isFinite(e.r)&&isFinite(e.phi))return Ib.INFINITY;n.re=e.r*Math.cos(e.phi),n.im=e.r*Math.sin(e.phi)}else 2===e.length?(n.re=e[0],n.im=e[1]):Mb();break;case"string":n.im=n.re=0;const t=e.replace(/_/g,"").match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g);let r=1,i=0;null===t&&Mb();for(let e=0;e<t.length;e++){const o=t[e];" "===o||"\t"===o||"\n"===o||("+"===o?r++:"-"===o?i++:"i"===o||"I"===o?(r+i===0&&Mb()," "===t[e+1]||isNaN(t[e+1])?n.im+=parseFloat((i%2?"-":"")+"1"):(n.im+=parseFloat((i%2?"-":"")+t[e+1]),e++),r=i=0):((r+i===0||isNaN(o))&&Mb(),"i"===t[e+1]||"I"===t[e+1]?(n.im+=parseFloat((i%2?"-":"")+o),e++):n.re+=parseFloat((i%2?"-":"")+o),r=i=0))}r+i>0&&Mb();break;case"number":n.im=0,n.re=e;break;default:Mb()}return isNaN(n.re)||isNaN(n.im),n};function Ib(e,t){if(!(this instanceof Ib))return new Ib(e,t);const n=Ob(e,t);this.re=n.re,this.im=n.im}Ib.prototype={re:0,im:0,sign:function(){const e=kb(this.re,this.im);return new Ib(this.re/e,this.im/e)},add:function(e,t){const n=Ob(e,t),r=this.isInfinite(),i=!(isFinite(n.re)&&isFinite(n.im));return r||i?r&&i?Ib.NAN:Ib.INFINITY:new Ib(this.re+n.re,this.im+n.im)},sub:function(e,t){const n=Ob(e,t),r=this.isInfinite(),i=!(isFinite(n.re)&&isFinite(n.im));return r||i?r&&i?Ib.NAN:Ib.INFINITY:new Ib(this.re-n.re,this.im-n.im)},mul:function(e,t){const n=Ob(e,t),r=this.isInfinite(),i=!(isFinite(n.re)&&isFinite(n.im)),o=0===this.re&&0===this.im,a=0===n.re&&0===n.im;return r&&a||i&&o?Ib.NAN:r||i?Ib.INFINITY:0===n.im&&0===this.im?new Ib(this.re*n.re,0):new Ib(this.re*n.re-this.im*n.im,this.re*n.im+this.im*n.re)},div:function(e,t){const n=Ob(e,t),r=this.isInfinite(),i=!(isFinite(n.re)&&isFinite(n.im)),o=0===this.re&&0===this.im,a=0===n.re&&0===n.im;if(o&&a||r&&i)return Ib.NAN;if(a||r)return Ib.INFINITY;if(o||i)return Ib.ZERO;if(0===n.im)return new Ib(this.re/n.re,this.im/n.re);if(Math.abs(n.re)<Math.abs(n.im)){const e=n.re/n.im,t=n.re*e+n.im;return new Ib((this.re*e+this.im)/t,(this.im*e-this.re)/t)}{const e=n.im/n.re,t=n.im*e+n.re;return new Ib((this.re+this.im*e)/t,(this.im-this.re*e)/t)}},pow:function(e,t){const n=Ob(e,t),r=0===this.re&&0===this.im;if(0===n.re&&0===n.im)return Ib.ONE;if(0===n.im){if(0===this.im&&this.re>0)return new Ib(Math.pow(this.re,n.re),0);if(0===this.re)switch((n.re%4+4)%4){case 0:return new Ib(Math.pow(this.im,n.re),0);case 1:return new Ib(0,Math.pow(this.im,n.re));case 2:return new Ib(-Math.pow(this.im,n.re),0);case 3:return new Ib(0,-Math.pow(this.im,n.re))}}if(r&&n.re>0)return Ib.ZERO;const i=Math.atan2(this.im,this.re),o=Db(this.re,this.im);let a=Math.exp(n.re*o-n.im*i),s=n.im*o+n.re*i;return new Ib(a*Math.cos(s),a*Math.sin(s))},sqrt:function(){const e=this.re,t=this.im;if(0===t)return e>=0?new Ib(Math.sqrt(e),0):new Ib(0,Math.sqrt(-e));const n=kb(e,t);let r=Math.sqrt(.5*(n+Math.abs(e))),i=Math.abs(t)/(2*r);return e>=0?new Ib(r,t<0?-i:i):new Ib(i,t<0?-r:r)},exp:function(){const e=Math.exp(this.re);return 0===this.im?new Ib(e,0):new Ib(e*Math.cos(this.im),e*Math.sin(this.im))},expm1:function(){const e=this.re,t=this.im;return new Ib(Math.expm1(e)*Math.cos(t)+function(e){const t=Math.PI/4;if(-t>e||e>t)return Math.cos(e)-1;const n=e*e;return n*(n*(n*(n*(n*(n*(n*(n/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-.5)}(t),Math.exp(e)*Math.sin(t))},log:function(){const e=this.re,t=this.im;return 0===t&&e>0?new Ib(Math.log(e),0):new Ib(Db(e,t),Math.atan2(t,e))},abs:function(){return kb(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){const e=this.re,t=this.im;return new Ib(Math.sin(e)*Ab(t),Math.cos(e)*Rb(t))},cos:function(){const e=this.re,t=this.im;return new Ib(Math.cos(e)*Ab(t),-Math.sin(e)*Rb(t))},tan:function(){const e=2*this.re,t=2*this.im,n=Math.cos(e)+Ab(t);return new Ib(Math.sin(e)/n,Rb(t)/n)},cot:function(){const e=2*this.re,t=2*this.im,n=Math.cos(e)-Ab(t);return new Ib(-Math.sin(e)/n,Rb(t)/n)},sec:function(){const e=this.re,t=this.im,n=.5*Ab(2*t)+.5*Math.cos(2*e);return new Ib(Math.cos(e)*Ab(t)/n,Math.sin(e)*Rb(t)/n)},csc:function(){const e=this.re,t=this.im,n=.5*Ab(2*t)-.5*Math.cos(2*e);return new Ib(Math.sin(e)*Ab(t)/n,-Math.cos(e)*Rb(t)/n)},asin:function(){const e=this.re,t=this.im,n=new Ib(t*t-e*e+1,-2*e*t).sqrt(),r=new Ib(n.re-t,n.im+e).log();return new Ib(r.im,-r.re)},acos:function(){const e=this.re,t=this.im,n=new Ib(t*t-e*e+1,-2*e*t).sqrt(),r=new Ib(n.re-t,n.im+e).log();return new Ib(Math.PI/2-r.im,r.re)},atan:function(){const e=this.re,t=this.im;if(0===e){if(1===t)return new Ib(0,1/0);if(-1===t)return new Ib(0,-1/0)}const n=e*e+(1-t)*(1-t),r=new Ib((1-t*t-e*e)/n,-2*e/n).log();return new Ib(-.5*r.im,.5*r.re)},acot:function(){const e=this.re,t=this.im;if(0===t)return new Ib(Math.atan2(1,e),0);const n=e*e+t*t;return 0!==n?new Ib(e/n,-t/n).atan():new Ib(0!==e?e/0:0,0!==t?-t/0:0).atan()},asec:function(){const e=this.re,t=this.im;if(0===e&&0===t)return new Ib(0,1/0);const n=e*e+t*t;return 0!==n?new Ib(e/n,-t/n).acos():new Ib(0!==e?e/0:0,0!==t?-t/0:0).acos()},acsc:function(){const e=this.re,t=this.im;if(0===e&&0===t)return new Ib(Math.PI/2,1/0);const n=e*e+t*t;return 0!==n?new Ib(e/n,-t/n).asin():new Ib(0!==e?e/0:0,0!==t?-t/0:0).asin()},sinh:function(){const e=this.re,t=this.im;return new Ib(Rb(e)*Math.cos(t),Ab(e)*Math.sin(t))},cosh:function(){const e=this.re,t=this.im;return new Ib(Ab(e)*Math.cos(t),Rb(e)*Math.sin(t))},tanh:function(){const e=2*this.re,t=2*this.im,n=Ab(e)+Math.cos(t);return new Ib(Rb(e)/n,Math.sin(t)/n)},coth:function(){const e=2*this.re,t=2*this.im,n=Ab(e)-Math.cos(t);return new Ib(Rb(e)/n,-Math.sin(t)/n)},csch:function(){const e=this.re,t=this.im,n=Math.cos(2*t)-Ab(2*e);return new Ib(-2*Rb(e)*Math.cos(t)/n,2*Ab(e)*Math.sin(t)/n)},sech:function(){const e=this.re,t=this.im,n=Math.cos(2*t)+Ab(2*e);return new Ib(2*Ab(e)*Math.cos(t)/n,-2*Rb(e)*Math.sin(t)/n)},asinh:function(){let e=this.im;this.im=-this.re,this.re=e;const t=this.asin();return this.re=-this.im,this.im=e,e=t.re,t.re=-t.im,t.im=e,t},acosh:function(){const e=this.acos();if(e.im<=0){const t=e.re;e.re=-e.im,e.im=t}else{const t=e.im;e.im=-e.re,e.re=t}return e},atanh:function(){const e=this.re,t=this.im,n=e>1&&0===t,r=1-e,i=1+e,o=r*r+t*t,a=0!==o?new Ib((i*r-t*t)/o,(t*r+i*t)/o):new Ib(-1!==e?e/0:0,0!==t?t/0:0),s=a.re;return a.re=Db(a.re,a.im)/2,a.im=Math.atan2(a.im,s)/2,n&&(a.im=-a.im),a},acoth:function(){const e=this.re,t=this.im;if(0===e&&0===t)return new Ib(0,Math.PI/2);const n=e*e+t*t;return 0!==n?new Ib(e/n,-t/n).atanh():new Ib(0!==e?e/0:0,0!==t?-t/0:0).atanh()},acsch:function(){const e=this.re,t=this.im;if(0===t)return new Ib(0!==e?Math.log(e+Math.sqrt(e*e+1)):1/0,0);const n=e*e+t*t;return 0!==n?new Ib(e/n,-t/n).asinh():new Ib(0!==e?e/0:0,0!==t?-t/0:0).asinh()},asech:function(){const e=this.re,t=this.im;if(this.isZero())return Ib.INFINITY;const n=e*e+t*t;return 0!==n?new Ib(e/n,-t/n).acosh():new Ib(0!==e?e/0:0,0!==t?-t/0:0).acosh()},inverse:function(){if(this.isZero())return Ib.INFINITY;if(this.isInfinite())return Ib.ZERO;const e=this.re,t=this.im,n=e*e+t*t;return new Ib(e/n,-t/n)},conjugate:function(){return new Ib(this.re,-this.im)},neg:function(){return new Ib(-this.re,-this.im)},ceil:function(e){return e=Math.pow(10,e||0),new Ib(Math.ceil(this.re*e)/e,Math.ceil(this.im*e)/e)},floor:function(e){return e=Math.pow(10,e||0),new Ib(Math.floor(this.re*e)/e,Math.floor(this.im*e)/e)},round:function(e){return e=Math.pow(10,e||0),new Ib(Math.round(this.re*e)/e,Math.round(this.im*e)/e)},equals:function(e,t){const n=Ob(e,t);return Math.abs(n.re-this.re)<=Ib.EPSILON&&Math.abs(n.im-this.im)<=Ib.EPSILON},clone:function(){return new Ib(this.re,this.im)},toString:function(){let e=this.re,t=this.im,n="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(e)<Ib.EPSILON&&(e=0),Math.abs(t)<Ib.EPSILON&&(t=0),0===t?n+e:(0!==e?(n+=e,n+=" ",t<0?(t=-t,n+="-"):n+="+",n+=" "):t<0&&(t=-t,n+="-"),1!==t&&(n+=t),n+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return 0===this.im&&0===this.re},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!this.isFinite()}},Ib.ZERO=new Ib(0,0),Ib.ONE=new Ib(1,0),Ib.I=new Ib(0,1),Ib.PI=new Ib(Math.PI,0),Ib.E=new Ib(Math.E,0),Ib.INFINITY=new Ib(1/0,1/0),Ib.NAN=new Ib(NaN,NaN),Ib.EPSILON=1e-15;var Pb=vh("Complex",[],()=>(Object.defineProperty(Ib,"name",{value:"Complex"}),Ib.prototype.constructor=Ib,Ib.prototype.type="Complex",Ib.prototype.isComplex=!0,Ib.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},Ib.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},Ib.prototype.format=function(e){var t=this.im,n=this.re,r=kh(this.re,e),i=kh(this.im,e),o=Ad(e)?e:e?e.precision:null;if(null!==o){var a=Math.pow(10,-o);Math.abs(n/t)<a&&(n=0),Math.abs(t/n)<a&&(t=0)}return 0===t?r:0===n?1===t?"i":-1===t?"-i":i+"i":t<0?-1===t?r+" - i":r+" - "+i.substring(1)+"i":1===t?r+" + i":r+" + "+i+"i"},Ib.fromPolar=function(e){switch(arguments.length){case 1:var t=arguments[0];if("object"===typeof t)return Ib(t);throw new TypeError("Input has to be an object with r and phi keys.");case 2:var n=arguments[0],r=arguments[1];if(Ad(n)){if(_d(r)&&r.hasBase("ANGLE")&&(r=r.toNumber("rad")),Ad(r))return new Ib({r:n,phi:r});throw new TypeError("Phi is not a number nor an angle unit.")}throw new TypeError("Radius r is not a number.");default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},Ib.prototype.valueOf=Ib.prototype.toString,Ib.fromJSON=function(e){return new Ib(e)},Ib.compare=function(e,t){return e.re>t.re?1:e.re<t.re?-1:e.im>t.im?1:e.im<t.im?-1:0},Ib),{isClass:!0});function jb(e){var t=0,n=1,r=Object.create(null),i=Object.create(null),o=0,a=function(e){var a=i[e];if(a&&(delete r[a],delete i[e],--t,n===a)){if(!t)return o=0,void(n=1);for(;!Object.prototype.hasOwnProperty.call(r,++n););}};return e=Math.abs(e),{hit:function(s){var l=i[s],c=++o;if(r[c]=s,i[s]=c,!l){if(++t<=e)return;return s=r[n],a(s),s}if(delete r[l],n===l)for(;!Object.prototype.hasOwnProperty.call(r,++n););},delete:a,clear:function(){t=o=0,n=1,r=Object.create(null),i=Object.create(null)}}}function Fb(e){var{hasher:t,limit:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=null==n?Number.POSITIVE_INFINITY:n,t=null==t?JSON.stringify:t,function r(){"object"!==typeof r.cache&&(r.cache={values:new Map,lru:jb(n||Number.POSITIVE_INFINITY)});for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var a=t(i);if(r.cache.values.has(a))return r.cache.lru.hit(a),r.cache.values.get(a);var s=e.apply(e,i);return r.cache.values.set(a,s),r.cache.values.delete(r.cache.lru.hit(a)),s}}var Hb=Fb(function(e){return new e(1).exp()},{hasher:Wb}),Lb=Fb(function(e){return new e(1).plus(new e(5).sqrt()).div(2)},{hasher:Wb}),Bb=Fb(function(e){return e.acos(-1)},{hasher:Wb}),zb=Fb(function(e){return Bb(e).times(2)},{hasher:Wb});function Wb(e){return e[0].precision}var Vb=Math.PI,Ub=2*Math.PI,qb=Math.E,Gb=vh("true",[],()=>!0),Yb=vh("false",[],()=>!1),Kb=vh("null",[],()=>null),$b=cw("Infinity",["config","?BigNumber"],e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n(1/0):1/0}),Xb=cw("NaN",["config","?BigNumber"],e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n(NaN):NaN}),Qb=cw("pi",["config","?BigNumber"],e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?Bb(n):Vb}),Jb=cw("tau",["config","?BigNumber"],e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?zb(n):Ub}),Zb=cw("e",["config","?BigNumber"],e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?Hb(n):qb}),ew=cw("phi",["config","?BigNumber"],e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?Lb(n):1.618033988749895}),tw=cw("LN2",["config","?BigNumber"],e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n(2).ln():Math.LN2}),nw=cw("LN10",["config","?BigNumber"],e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n(10).ln():Math.LN10}),rw=cw("LOG2E",["config","?BigNumber"],e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n(1).div(new n(2).ln()):Math.LOG2E}),iw=cw("LOG10E",["config","?BigNumber"],e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n(1).div(new n(10).ln()):Math.LOG10E}),ow=cw("SQRT1_2",["config","?BigNumber"],e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n("0.5").sqrt():Math.SQRT1_2}),aw=cw("SQRT2",["config","?BigNumber"],e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n(2).sqrt():Math.SQRT2}),sw=cw("i",["Complex"],e=>{var{Complex:t}=e;return t.I}),lw=vh("version",[],()=>"15.0.0");function cw(e,t,n){return vh(e,t,n,{recreateOnConfigChange:!0})}var uw=sx("speedOfLight","299792458","m s^-1"),dw=sx("gravitationConstant","6.67430e-11","m^3 kg^-1 s^-2"),hw=sx("planckConstant","6.62607015e-34","J s"),fw=sx("reducedPlanckConstant","1.0545718176461565e-34","J s"),mw=sx("magneticConstant","1.25663706212e-6","N A^-2"),pw=sx("electricConstant","8.8541878128e-12","F m^-1"),gw=sx("vacuumImpedance","376.730313667","ohm"),vw=sx("coulomb","8.987551792261171e9","N m^2 C^-2"),yw=sx("coulombConstant","8.987551792261171e9","N m^2 C^-2"),bw=sx("elementaryCharge","1.602176634e-19","C"),ww=sx("bohrMagneton","9.2740100783e-24","J T^-1"),xw=sx("conductanceQuantum","7.748091729863649e-5","S"),Sw=sx("inverseConductanceQuantum","12906.403729652257","ohm"),Cw=sx("magneticFluxQuantum","2.0678338484619295e-15","Wb"),Ew=sx("nuclearMagneton","5.0507837461e-27","J T^-1"),Nw=sx("klitzing","25812.807459304513","ohm"),Tw=sx("bohrRadius","5.29177210903e-11","m"),Aw=sx("classicalElectronRadius","2.8179403262e-15","m"),Rw=sx("electronMass","9.1093837015e-31","kg"),kw=sx("fermiCoupling","1.1663787e-5","GeV^-2"),Mw=lx("fineStructure",.0072973525693),Dw=sx("hartreeEnergy","4.3597447222071e-18","J"),_w=sx("protonMass","1.67262192369e-27","kg"),Ow=sx("deuteronMass","3.3435830926e-27","kg"),Iw=sx("neutronMass","1.6749271613e-27","kg"),Pw=sx("quantumOfCirculation","3.6369475516e-4","m^2 s^-1"),jw=sx("rydberg","10973731.568160","m^-1"),Fw=sx("thomsonCrossSection","6.6524587321e-29","m^2"),Hw=lx("weakMixingAngle",.2229),Lw=lx("efimovFactor",22.7),Bw=sx("atomicMass","1.66053906660e-27","kg"),zw=sx("avogadro","6.02214076e23","mol^-1"),Ww=sx("boltzmann","1.380649e-23","J K^-1"),Vw=sx("faraday","96485.33212331001","C mol^-1"),Uw=sx("firstRadiation","3.7417718521927573e-16","W m^2"),qw=sx("loschmidt","2.686780111798444e25","m^-3"),Gw=sx("gasConstant","8.31446261815324","J K^-1 mol^-1"),Yw=sx("molarPlanckConstant","3.990312712893431e-10","J s mol^-1"),Kw=sx("molarVolume","0.022413969545014137","m^3 mol^-1"),$w=lx("sackurTetrode",-1.16487052358),Xw=sx("secondRadiation","0.014387768775039337","m K"),Qw=sx("stefanBoltzmann","5.67037441918443e-8","W m^-2 K^-4"),Jw=sx("wienDisplacement","2.897771955e-3","m K"),Zw=sx("molarMass","0.99999999965e-3","kg mol^-1"),ex=sx("molarMassC12","11.9999999958e-3","kg mol^-1"),tx=sx("gravity","9.80665","m s^-2"),nx=sx("planckLength","1.616255e-35","m"),rx=sx("planckMass","2.176435e-8","kg"),ix=sx("planckTime","5.391245e-44","s"),ox=sx("planckCharge","1.87554603778e-18","C"),ax=sx("planckTemperature","1.416785e+32","K");function sx(e,t,n){return vh(e,["config","Unit","BigNumber"],e=>{var{config:r,Unit:i,BigNumber:o}=e,a=new i("BigNumber"===r.number?new o(t):parseFloat(t),n);return a.fixPrefix=!0,a})}function lx(e,t){return vh(e,["config","BigNumber"],e=>{var{config:n,BigNumber:r}=e;return"BigNumber"===n.number?new r(t):t})}"undefined"===typeof BigInt&&(BigInt=function(e){if(isNaN(e))throw new Error("");return e});const cx=BigInt(0),ux=BigInt(1),dx=BigInt(2),hx=BigInt(3),fx=BigInt(5),mx=BigInt(10),px=(BigInt(Number.MAX_SAFE_INTEGER),{s:ux,n:cx,d:ux});function gx(e,t){try{e=BigInt(e)}catch(qb){throw Tx()}return e*t}function vx(e){return"bigint"===typeof e?e:Math.floor(e)}function yx(e,t){if(t===cx)throw Nx();const n=Object.create(Ex.prototype);n.s=e<cx?-ux:ux;const r=Cx(e=e<cx?-e:e,t);return n.n=e/r,n.d=t/r,n}const bx=[dx*dx,dx,dx*dx,dx,dx*dx,dx*hx,dx,dx*hx];function wx(e){const t=Object.create(null);if(e<=ux)return t[e]=ux,t;const n=e=>{t[e]=(t[e]||cx)+ux};for(;e%dx===cx;)n(dx),e/=dx;for(;e%hx===cx;)n(hx),e/=hx;for(;e%fx===cx;)n(fx),e/=fx;for(let r=0,i=dx+fx;i*i<=e;){for(;e%i===cx;)n(i),e/=i;i+=bx[r],r=r+1&7}return e>ux&&n(e),t}const xx=function(e,t){let n=cx,r=ux,i=ux;if(void 0===e||null===e);else if(void 0!==t){if("bigint"===typeof e)n=e;else{if(isNaN(e))throw Tx();if(e%1!==0)throw Ax();n=BigInt(e)}if("bigint"===typeof t)r=t;else{if(isNaN(t))throw Tx();if(t%1!==0)throw Ax();r=BigInt(t)}i=n*r}else if("object"===typeof e){if("d"in e&&"n"in e)n=BigInt(e.n),r=BigInt(e.d),"s"in e&&(n*=BigInt(e.s));else if(0 in e)n=BigInt(e[0]),1 in e&&(r=BigInt(e[1]));else{if("bigint"!==typeof e)throw Tx();n=e}i=n*r}else if("number"===typeof e){if(isNaN(e))throw Tx();if(e<0&&(i=-ux,e=-e),e%1===0)n=BigInt(e);else{let t=1,i=0,o=1,a=1,s=1,l=1e7;for(e>=1&&(t=10**Math.floor(1+Math.log10(e)),e/=t);o<=l&&s<=l;){let t=(i+a)/(o+s);if(e===t){o+s<=l?(n=i+a,r=o+s):s>o?(n=a,r=s):(n=i,r=o);break}e>t?(i+=a,o+=s):(a+=i,s+=o),o>l?(n=a,r=s):(n=i,r=o)}n=BigInt(n)*BigInt(t),r=BigInt(r)}}else if("string"===typeof e){let t=0,o=cx,a=cx,s=cx,l=ux,c=ux,u=e.replace(/_/g,"").match(/\d+|./g);if(null===u)throw Tx();if("-"===u[t]?(i=-ux,t++):"+"===u[t]&&t++,u.length===t+1?a=gx(u[t++],i):"."===u[t+1]||"."===u[t]?("."!==u[t]&&(o=gx(u[t++],i)),t++,(t+1===u.length||"("===u[t+1]&&")"===u[t+3]||"'"===u[t+1]&&"'"===u[t+3])&&(a=gx(u[t],i),l=mx**BigInt(u[t].length),t++),("("===u[t]&&")"===u[t+2]||"'"===u[t]&&"'"===u[t+2])&&(s=gx(u[t+1],i),c=mx**BigInt(u[t+1].length)-ux,t+=3)):"/"===u[t+1]||":"===u[t+1]?(a=gx(u[t],i),l=gx(u[t+2],ux),t+=3):"/"===u[t+3]&&" "===u[t+1]&&(o=gx(u[t],i),a=gx(u[t+2],i),l=gx(u[t+4],ux),t+=5),!(u.length<=t))throw Tx();r=l*c,i=n=s+r*o+c*a}else{if("bigint"!==typeof e)throw Tx();n=e,i=e,r=ux}if(r===cx)throw Nx();px.s=i<cx?-ux:ux,px.n=n<cx?-n:n,px.d=r<cx?-r:r};function Sx(e,t,n){let r=ux,i=function(e,t,n){let r=ux;for(;t>cx;e=e*e%n,t>>=ux)t&ux&&(r=r*e%n);return r}(mx,n,t);for(let o=0;o<300;o++){if(r===i)return BigInt(o);r=r*mx%t,i=i*mx%t}return 0}function Cx(e,t){if(!e)return t;if(!t)return e;for(;;){if(!(e%=t))return t;if(!(t%=e))return e}}function Ex(e,t){if(xx(e,t),!(this instanceof Ex))return yx(px.s*px.n,px.d);e=Cx(px.d,px.n),this.s=px.s,this.n=px.n/e,this.d=px.d/e}const Nx=function(){return new Error("Division by Zero")},Tx=function(){return new Error("Invalid argument")},Ax=function(){return new Error("Parameters must be integer")};Ex.prototype={s:ux,n:cx,d:ux,abs:function(){return yx(this.n,this.d)},neg:function(){return yx(-this.s*this.n,this.d)},add:function(e,t){return xx(e,t),yx(this.s*this.n*px.d+px.s*this.d*px.n,this.d*px.d)},sub:function(e,t){return xx(e,t),yx(this.s*this.n*px.d-px.s*this.d*px.n,this.d*px.d)},mul:function(e,t){return xx(e,t),yx(this.s*px.s*this.n*px.n,this.d*px.d)},div:function(e,t){return xx(e,t),yx(this.s*px.s*this.n*px.d,this.d*px.n)},clone:function(){return yx(this.s*this.n,this.d)},mod:function(e,t){if(void 0===e)return yx(this.s*this.n%this.d,ux);if(xx(e,t),cx===px.n*this.d)throw Nx();return yx(this.s*(px.d*this.n)%(px.n*this.d),px.d*this.d)},gcd:function(e,t){return xx(e,t),yx(Cx(px.n,this.n)*Cx(px.d,this.d),px.d*this.d)},lcm:function(e,t){return xx(e,t),px.n===cx&&this.n===cx?yx(cx,ux):yx(px.n*this.n,Cx(px.n,this.n)*Cx(px.d,this.d))},inverse:function(){return yx(this.s*this.d,this.n)},pow:function(e,t){if(xx(e,t),px.d===ux)return px.s<cx?yx((this.s*this.d)**px.n,this.n**px.n):yx((this.s*this.n)**px.n,this.d**px.n);if(this.s<cx)return null;let n=wx(this.n),r=wx(this.d),i=ux,o=ux;for(let a in n)if("1"!==a){if("0"===a){i=cx;break}if(n[a]*=px.n,n[a]%px.d!==cx)return null;n[a]/=px.d,i*=BigInt(a)**n[a]}for(let a in r)if("1"!==a){if(r[a]*=px.n,r[a]%px.d!==cx)return null;r[a]/=px.d,o*=BigInt(a)**r[a]}return px.s<cx?yx(o,i):yx(i,o)},log:function(e,t){if(xx(e,t),this.s<=cx||px.s<=cx)return null;const n=Object.create(null),r=wx(px.n),i=wx(px.d),o=wx(this.n),a=wx(this.d);for(const c in i)r[c]=(r[c]||cx)-i[c];for(const c in a)o[c]=(o[c]||cx)-a[c];for(const c in r)"1"!==c&&(n[c]=!0);for(const c in o)"1"!==c&&(n[c]=!0);let s=null,l=null;for(const c in n){const e=r[c]||cx,t=o[c]||cx;if(e===cx){if(t!==cx)return null;continue}let n=t,i=e;const a=Cx(n,i);if(n/=a,i/=a,null===s&&null===l)s=n,l=i;else if(n*l!==s*i)return null}return null!==s&&null!==l?yx(s,l):null},equals:function(e,t){return xx(e,t),this.s*this.n*px.d===px.s*px.n*this.d},lt:function(e,t){return xx(e,t),this.s*this.n*px.d<px.s*px.n*this.d},lte:function(e,t){return xx(e,t),this.s*this.n*px.d<=px.s*px.n*this.d},gt:function(e,t){return xx(e,t),this.s*this.n*px.d>px.s*px.n*this.d},gte:function(e,t){return xx(e,t),this.s*this.n*px.d>=px.s*px.n*this.d},compare:function(e,t){xx(e,t);let n=this.s*this.n*px.d-px.s*px.n*this.d;return(cx<n)-(n<cx)},ceil:function(e){return e=mx**BigInt(e||0),yx(vx(this.s*e*this.n/this.d)+(e*this.n%this.d>cx&&this.s>=cx?ux:cx),e)},floor:function(e){return e=mx**BigInt(e||0),yx(vx(this.s*e*this.n/this.d)-(e*this.n%this.d>cx&&this.s<cx?ux:cx),e)},round:function(e){return e=mx**BigInt(e||0),yx(vx(this.s*e*this.n/this.d)+this.s*((this.s>=cx?ux:cx)+dx*(e*this.n%this.d)>this.d?ux:cx),e)},roundTo:function(e,t){xx(e,t);const n=this.n*px.d,r=this.d*px.n,i=n%r;let o=vx(n/r);return i+i>=r&&o++,yx(this.s*o*px.n,px.d)},divisible:function(e,t){return xx(e,t),px.n!==cx&&this.n*px.d%(px.n*this.d)===cx},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15,t=this.n,n=this.d,r=function(e,t){for(;t%dx===cx;t/=dx);for(;t%fx===cx;t/=fx);if(t===ux)return cx;let n=mx%t,r=1;for(;n!==ux;r++)if(n=n*mx%t,r>2e3)return cx;return BigInt(r)}(0,n),i=Sx(0,n,r),o=this.s<cx?"-":"";if(o+=vx(t/n),t%=n,t*=mx,t&&(o+="."),r){for(let e=i;e--;)o+=vx(t/n),t%=n,t*=mx;o+="(";for(let e=r;e--;)o+=vx(t/n),t%=n,t*=mx;o+=")"}else for(let a=e;t&&a--;)o+=vx(t/n),t%=n,t*=mx;return o},toFraction:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.n,n=this.d,r=this.s<cx?"-":"";if(n===ux)r+=t;else{const i=vx(t/n);e&&i>cx&&(r+=i,r+=" ",t%=n),r+=t,r+="/",r+=n}return r},toLatex:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.n,n=this.d,r=this.s<cx?"-":"";if(n===ux)r+=t;else{const i=vx(t/n);e&&i>cx&&(r+=i,t%=n),r+="\\frac{",r+=t,r+="}{",r+=n,r+="}"}return r},toContinued:function(){let e=this.n,t=this.d;const n=[];for(;t;){n.push(vx(e/t));const r=e%t;e=t,t=r}return n},simplify:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001;const t=BigInt(Math.ceil(1/e)),n=this.abs(),r=n.toContinued();for(let i=1;i<r.length;i++){let e=yx(r[i-1],ux);for(let t=i-2;t>=0;t--)e=e.inverse().add(r[t]);let o=e.sub(n);if(o.n*t<o.d)return e.mul(this.s)}return this}};var Rx=vh("Fraction",[],()=>(Object.defineProperty(Ex,"name",{value:"Fraction"}),Ex.prototype.constructor=Ex,Ex.prototype.type="Fraction",Ex.prototype.isFraction=!0,Ex.prototype.toJSON=function(){return{mathjs:"Fraction",n:String(this.s*this.n),d:String(this.d)}},Ex.fromJSON=function(e){return new Ex(e)},Ex),{isClass:!0}),kx=vh("Matrix",[],()=>{function e(){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator")}return e.prototype.type="Matrix",e.prototype.isMatrix=!0,e.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},e.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},e.prototype.create=function(e,t){throw new Error("Cannot invoke create on a Matrix interface")},e.prototype.subset=function(e,t,n){throw new Error("Cannot invoke subset on a Matrix interface")},e.prototype.get=function(e){throw new Error("Cannot invoke get on a Matrix interface")},e.prototype.set=function(e,t,n){throw new Error("Cannot invoke set on a Matrix interface")},e.prototype.resize=function(e,t){throw new Error("Cannot invoke resize on a Matrix interface")},e.prototype.reshape=function(e,t){throw new Error("Cannot invoke reshape on a Matrix interface")},e.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},e.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},e.prototype.map=function(e,t){throw new Error("Cannot invoke map on a Matrix interface")},e.prototype.forEach=function(e){throw new Error("Cannot invoke forEach on a Matrix interface")},e.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},e.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},e.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},e.prototype.format=function(e){throw new Error("Cannot invoke format on a Matrix interface")},e.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},e},{isClass:!0}),Mx=vh("Range",[],()=>{function e(t,n,r){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");var i=null!==t&&void 0!==t,o=null!==n&&void 0!==n,a=null!==r&&void 0!==r;if(i)if(Rd(t))t=t.toNumber();else if("number"!==typeof t&&!kd(t))throw new TypeError("Parameter start must be a number or bigint");if(o)if(Rd(n))n=n.toNumber();else if("number"!==typeof n&&!kd(n))throw new TypeError("Parameter end must be a number or bigint");if(a)if(Rd(r))r=r.toNumber();else if("number"!==typeof r&&!kd(r))throw new TypeError("Parameter step must be a number or bigint");if(this.start=i?parseFloat(t):0,this.end=o?parseFloat(n):0,this.step=a?parseFloat(r):1,a&&jh(this.step,0))throw new Error("Step must not be zero")}return e.prototype.type="Range",e.prototype.isRange=!0,e.parse=function(t){if("string"!==typeof t)return null;var n=t.split(":").map(function(e){return parseFloat(e)});if(n.some(function(e){return isNaN(e)}))return null;switch(n.length){case 2:return new e(n[0],n[1]);case 3:return new e(n[0],n[2],n[1]);default:return null}},e.prototype.clone=function(){return new e(this.start,this.end,this.step)},e.prototype.size=function(){var e=0,t=this.start,n=this.step,r=this.end-t;return Sh(n)===Sh(r)?e=Math.ceil(r/n):0===r&&(e=0),isNaN(e)&&(e=0),[e]},e.prototype.min=function(){var e=this.size()[0];return e>0?this.step>0?this.start:this.start+(e-1)*this.step:void 0},e.prototype.max=function(){var e=this.size()[0];return e>0?this.step>0?this.start+(e-1)*this.step:this.start:void 0},e.prototype.forEach=function(e){var t=this.start,n=this.step,r=this.end,i=0;if(n>0)for(;t<r;)e(t,[i],this),t+=n,i++;else if(n<0)for(;t>r;)e(t,[i],this),t+=n,i++},e.prototype.map=function(e){var t=[];return this.forEach(function(n,r,i){t[r[0]]=e(n,r,i)}),t},e.prototype.toArray=function(){var e=[];return this.forEach(function(t,n){e[n[0]]=t}),e},e.prototype.valueOf=function(){return this.toArray()},e.prototype.format=function(e){var t=kh(this.start,e);return 1!==this.step&&(t+=":"+kh(this.step,e)),t+=":"+kh(this.end,e)},e.prototype.toString=function(){return this.format()},e.prototype.toJSON=function(){return{mathjs:"Range",start:this.start,end:this.end,step:this.step}},e.fromJSON=function(t){return new e(t.start,t.end,t.step)},e},{isClass:!0}),Dx=vh("ResultSet",[],()=>{function e(t){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");this.entries=t||[]}return e.prototype.type="ResultSet",e.prototype.isResultSet=!0,e.prototype.valueOf=function(){return this.entries},e.prototype.toString=function(){return"["+this.entries.map(String).join(", ")+"]"},e.prototype.toJSON=function(){return{mathjs:"ResultSet",entries:this.entries}},e.fromJSON=function(t){return new e(t.entries)},e},{isClass:!0}),_x=vh("DenseMatrix",["Matrix","config"],e=>{var{Matrix:t,config:n}=e;function r(e,t){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(t&&!Od(t))throw new Error("Invalid datatype: "+t);if(Pd(e))"DenseMatrix"===e.type?(this._data=hd(e._data),this._size=hd(e._size),this._datatype=t||e._datatype):(this._data=e.toArray(),this._size=e.size(),this._datatype=t||e._datatype);else if(e&&Id(e.data)&&Id(e.size))this._data=e.data,this._size=e.size,cf(this._data,this._size),this._datatype=t||e.datatype;else if(Id(e))this._data=a(e),this._size=sf(this._data),cf(this._data,this._size),this._datatype=t;else{if(e)throw new TypeError("Unsupported type of data ("+ph(e)+")");this._data=[],this._size=[0],this._datatype=t}}function i(e,t,n){if(0===t.length){for(var r=e._data;Id(r);)r=r[0];return r}return e._size=t.slice(0),e._data=ff(e._data,e._size,n),e}function o(e,t,n){for(var r=e._size.slice(0),o=!1;r.length<t.length;)r.push(0),o=!0;for(var a=0,s=t.length;a<s;a++)t[a]>r[a]&&(r[a]=t[a],o=!0);o&&i(e,r,n)}function a(e){return Pd(e)?a(e.valueOf()):Id(e)?e.map(a):e}return r.prototype=new t,r.prototype.createDenseMatrix=function(e,t){return new r(e,t)},Object.defineProperty(r,"name",{value:"DenseMatrix"}),r.prototype.constructor=r,r.prototype.type="DenseMatrix",r.prototype.isDenseMatrix=!0,r.prototype.getDataType=function(){return Mf(this._data,ph)},r.prototype.storage=function(){return"dense"},r.prototype.datatype=function(){return this._datatype},r.prototype.create=function(e,t){return new r(e,t)},r.prototype.subset=function(e,t,i){switch(arguments.length){case 1:return function(e,t){if(!Bd(t))throw new TypeError("Invalid index");var i=n.legacySubset?t.size().every(e=>1===e):t.isScalar();if(i)return e.get(t.min());var o=t.size();if(o.length!==e._size.length)throw new of(o.length,e._size.length);for(var a=t.min(),s=t.max(),l=0,c=e._size.length;l<c;l++)df(a[l],e._size[l]),df(s[l],e._size[l]);var u=new r,d=function(e,t){var n=t.size().length-1,r=Array(n);return{data:i(e),size:r.filter(e=>null!==e)};function i(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=t.dimension(o);function s(e,t){return Ad(e)?t(e):e.map(t).valueOf()}return Ad(a)?r[o]=null:r[o]=a.size()[0],s(a,o<n?t=>(df(t,e.length),i(e[t],o+1)):t=>(df(t,e.length),e[t]))}}(e._data,t);return u._size=d.size,u._datatype=e._datatype,u._data=d.data,n.legacySubset?u.reshape(t.size()):u}(this,e);case 2:case 3:return function(e,t,n,r){if(!t||!0!==t.isIndex)throw new TypeError("Invalid index");var i,a=t.size(),s=t.isScalar();Pd(n)?(i=n.size(),n=n.valueOf()):i=sf(n);if(s){if(0!==i.length)throw new TypeError("Scalar expected");e.set(t.min(),n,r)}else{if(!md(i,a)){if(0===i.length)n=Pf([n],a);else try{n=Pf(n,a)}catch(mW){}i=sf(n)}if(a.length<e._size.length)throw new of(a.length,e._size.length,"<");if(i.length<a.length){for(var l=0,c=0;1===a[l]&&1===i[l];)l++;for(;1===a[l];)c++,l++;n=wf(n,a.length,c,i)}if(!md(a,i))throw new of(a,i,">");var u=t.max().map(function(e){return e+1});o(e,u,r),function(e,t,n){var r=t.size().length-1;function i(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=t.dimension(o),s=(t,r)=>{df(t,e.length),i(e[t],n[r[0]],o+1)},l=(t,r)=>{df(t,e.length),e[t]=n[r[0]]};o<r?Ad(a)?s(a,[0]):a.forEach(s):Ad(a)?l(a,[0]):a.forEach(l)}i(e,n)}(e._data,t,n)}return e}(this,e,t,i);default:throw new SyntaxError("Wrong number of arguments")}},r.prototype.get=function(e){return Ff(this._data,e)},r.prototype.set=function(e,t,n){if(!Id(e))throw new TypeError("Array expected");if(e.length<this._size.length)throw new of(e.length,this._size.length,"<");var r,i,a,s=e.map(function(e){return e+1});o(this,s,n);var l=this._data;for(r=0,i=e.length-1;r<i;r++)df(a=e[r],l.length),l=l[a];return df(a=e[e.length-1],l.length),l[a]=t,this},r.prototype.resize=function(e,t,n){if(!jd(e))throw new TypeError("Array or Matrix expected");var r=e.valueOf().map(e=>Array.isArray(e)&&1===e.length?e[0]:e);return i(n?this.clone():this,r,t)},r.prototype.reshape=function(e,t){var n=t?this.clone():this;n._data=pf(n._data,e);var r=n._size.reduce((e,t)=>e*t);return n._size=gf(e,r),n},r.prototype.clone=function(){return new r({data:hd(this._data),size:hd(this._size),datatype:this._datatype})},r.prototype.size=function(){return this._size.slice(0)},r.prototype.map=function(e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this,r=n._size.length-1;if(r<0)return n.clone();var i=Op(e,n,"map",t),o=i.fn,a=n.create(void 0,n._datatype);if(a._size=n._size,t||i.isUnary)return a._data=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=Array(t.length);if(n<r)for(var a=0;a<t.length;a++)i[a]=e(t[a],n+1);else for(var s=0;s<t.length;s++)i[s]=o(t[s]);return i}(n._data),a;if(0===r){for(var s=n.valueOf(),l=Array(s.length),c=0;c<s.length;c++)l[c]=o(s[c],[c],n);return a._data=l,a}var u=[];return a._data=function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=Array(t.length);if(i<r)for(var s=0;s<t.length;s++)u[i]=s,a[s]=e(t[s],i+1);else for(var l=0;l<t.length;l++)u[i]=l,a[l]=o(t[l],u.slice(),n);return a}(n._data),a},r.prototype.forEach=function(e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this,r=n._size.length-1;if(!(r<0)){var i=Op(e,n,"map",t),o=i.fn;if(t||i.isUnary)(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(n<r)for(var i=0;i<t.length;i++)e(t[i],n+1);else for(var a=0;a<t.length;a++)o(t[a])})(n._data);else if(0!==r){var a=[];!function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(i<r)for(var s=0;s<t.length;s++)a[i]=s,e(t[s],i+1);else for(var l=0;l<t.length;l++)a[i]=l,o(t[l],a.slice(),n)}(n._data)}else for(var s=0;s<n._data.length;s++)o(n._data[s],[s],n)}},r.prototype[Symbol.iterator]=function*(){var e=this._size.length-1;if(!(e<0))if(0!==e)for(var t=Array(e+1).fill(0),n=this._size.reduce((e,t)=>e*t,1),r=0;r<n;r++){for(var i=this._data,o=0;o<e;o++)i=i[t[o]];yield{value:i[t[e]],index:t.slice()};for(var a=e;a>=0&&(t[a]++,!(t[a]<this._size[a]));a--)t[a]=0}else for(var s=0;s<this._data.length;s++)yield{value:this._data[s],index:[s]}},r.prototype.rows=function(){var e=[];if(2!==this.size().length)throw new TypeError("Rows can only be returned for a 2D matrix.");var t=this._data;for(var n of t)e.push(new r([n],this._datatype));return e},r.prototype.columns=function(){var e=this,t=[],n=this.size();if(2!==n.length)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var i=this._data,o=function(n){var o=i.map(e=>[e[n]]);t.push(new r(o,e._datatype))},a=0;a<n[1];a++)o(a);return t},r.prototype.toArray=function(){return hd(this._data)},r.prototype.valueOf=function(){return this._data},r.prototype.format=function(e){return Xh(this._data,e)},r.prototype.toString=function(){return Xh(this._data)},r.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},r.prototype.diagonal=function(e){if(e){if(Rd(e)&&(e=e.toNumber()),!Ad(e)||!wh(e))throw new TypeError("The parameter k must be an integer number")}else e=0;for(var t=e>0?e:0,n=e<0?-e:0,i=this._size[0],o=this._size[1],a=Math.min(i-n,o-t),s=[],l=0;l<a;l++)s[l]=this._data[l+n][l+t];return new r({data:s,size:[a],datatype:this._datatype})},r.diagonal=function(e,t,n,i){if(!Id(e))throw new TypeError("Array expected, size parameter");if(2!==e.length)throw new Error("Only two dimensions matrix are supported");if(e=e.map(function(e){if(Rd(e)&&(e=e.toNumber()),!Ad(e)||!wh(e)||e<1)throw new Error("Size values must be positive integers");return e}),n){if(Rd(n)&&(n=n.toNumber()),!Ad(n)||!wh(n))throw new TypeError("The parameter k must be an integer number")}else n=0;var o,a=n>0?n:0,s=n<0?-n:0,l=e[0],c=e[1],u=Math.min(l-s,c-a);if(Id(t)){if(t.length!==u)throw new Error("Invalid value array length");o=function(e){return t[e]}}else if(Pd(t)){var d=t.size();if(1!==d.length||d[0]!==u)throw new Error("Invalid matrix length");o=function(e){return t.get([e])}}else o=function(){return t};i||(i=Rd(o(0))?o(0).mul(0):0);var h=[];if(e.length>0){h=ff(h,e,i);for(var f=0;f<u;f++)h[f+s][f+a]=o(f)}return new r({data:h,size:[l,c]})},r.fromJSON=function(e){return new r(e)},r.prototype.swapRows=function(e,t){if(!Ad(e)||!wh(e)||!Ad(t)||!wh(t))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return df(e,this._size[0]),df(t,this._size[0]),r._swapRows(e,t,this._data),this},r._swapRows=function(e,t,n){var r=n[e];n[e]=n[t],n[t]=r},r},{isClass:!0}),Ox=vh("replacer",[],()=>function(e,t){return"number"!==typeof t||isFinite(t)&&!isNaN(t)?"bigint"===typeof t?{mathjs:"bigint",value:String(t)}:t:{mathjs:"number",value:String(t)}}),Ix=function(){return Ix=_p.create,_p},Px=vh("typed",["?BigNumber","?Complex","?DenseMatrix","?Fraction"],function(e){var{BigNumber:t,Complex:n,DenseMatrix:r,Fraction:i}=e,o=Ix();return o.clear(),o.addTypes([{name:"number",test:Ad},{name:"Complex",test:Md},{name:"BigNumber",test:Rd},{name:"bigint",test:kd},{name:"Fraction",test:Dd},{name:"Unit",test:_d},{name:"identifier",test:e=>Od&&/^(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])*$/.test(e)},{name:"string",test:Od},{name:"Chain",test:mh},{name:"Array",test:Id},{name:"Matrix",test:Pd},{name:"DenseMatrix",test:Fd},{name:"SparseMatrix",test:Hd},{name:"Range",test:Ld},{name:"Index",test:Bd},{name:"boolean",test:zd},{name:"ResultSet",test:Wd},{name:"Help",test:Vd},{name:"function",test:Ud},{name:"Date",test:qd},{name:"RegExp",test:Gd},{name:"null",test:$d},{name:"undefined",test:Xd},{name:"AccessorNode",test:Qd},{name:"ArrayNode",test:Jd},{name:"AssignmentNode",test:Zd},{name:"BlockNode",test:eh},{name:"ConditionalNode",test:th},{name:"ConstantNode",test:nh},{name:"FunctionNode",test:oh},{name:"FunctionAssignmentNode",test:ih},{name:"IndexNode",test:ah},{name:"Node",test:sh},{name:"ObjectNode",test:lh},{name:"OperatorNode",test:ch},{name:"ParenthesisNode",test:uh},{name:"RangeNode",test:dh},{name:"RelationalNode",test:hh},{name:"SymbolNode",test:fh},{name:"Map",test:Kd},{name:"Object",test:Yd}]),o.addConversions([{from:"number",to:"BigNumber",convert:function(e){if(t||jx(e),e.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+e+"). Use function bignumber(x) to convert to BigNumber.");return new t(e)}},{from:"number",to:"Complex",convert:function(e){return n||Fx(e),new n(e,0)}},{from:"BigNumber",to:"Complex",convert:function(e){return n||Fx(e),new n(e.toNumber(),0)}},{from:"bigint",to:"number",convert:function(e){if(e>Number.MAX_SAFE_INTEGER)throw new TypeError("Cannot implicitly convert bigint to number: value exceeds the max safe integer value (value: "+e+")");return Number(e)}},{from:"bigint",to:"BigNumber",convert:function(e){return t||jx(e),new t(e.toString())}},{from:"bigint",to:"Fraction",convert:function(e){return i||Hx(e),new i(e)}},{from:"Fraction",to:"BigNumber",convert:function(e){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(e){return n||Fx(e),new n(e.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(e){i||Hx(e);var t=new i(e);if(t.valueOf()!==e)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+e+"). Use function fraction(x) to convert to Fraction.");return t}},{from:"string",to:"number",convert:function(e){var t=Number(e);if(isNaN(t))throw new Error('Cannot convert "'+e+'" to a number');return t}},{from:"string",to:"BigNumber",convert:function(e){t||jx(e);try{return new t(e)}catch(n){throw new Error('Cannot convert "'+e+'" to BigNumber')}}},{from:"string",to:"bigint",convert:function(e){try{return BigInt(e)}catch(t){throw new Error('Cannot convert "'+e+'" to BigInt')}}},{from:"string",to:"Fraction",convert:function(e){i||Hx(e);try{return new i(e)}catch(t){throw new Error('Cannot convert "'+e+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(e){n||Fx(e);try{return new n(e)}catch(t){throw new Error('Cannot convert "'+e+'" to Complex')}}},{from:"boolean",to:"number",convert:function(e){return+e}},{from:"boolean",to:"BigNumber",convert:function(e){return t||jx(e),new t(+e)}},{from:"boolean",to:"bigint",convert:function(e){return BigInt(+e)}},{from:"boolean",to:"Fraction",convert:function(e){return i||Hx(e),new i(+e)}},{from:"boolean",to:"string",convert:function(e){return String(e)}},{from:"Array",to:"Matrix",convert:function(e){return r||function(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}(),new r(e)}},{from:"Matrix",to:"Array",convert:function(e){return e.valueOf()}}]),o.onMismatch=(e,t,n)=>{var r=o.createError(e,t,n);if(["wrongType","mismatch"].includes(r.data.category)&&1===t.length&&jd(t[0])&&n.some(e=>!e.params.includes(","))){var i=new TypeError("Function '".concat(e,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(e,")'."));throw i.data=r.data,i}throw r},o.onMismatch=(e,t,n)=>{var r=o.createError(e,t,n);if(["wrongType","mismatch"].includes(r.data.category)&&1===t.length&&jd(t[0])&&n.some(e=>!e.params.includes(","))){var i=new TypeError("Function '".concat(e,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(e,")'."));throw i.data=r.data,i}throw r},o});function jx(e){throw new Error("Cannot convert value ".concat(e," into a BigNumber: no class 'BigNumber' provided"))}function Fx(e){throw new Error("Cannot convert value ".concat(e," into a Complex number: no class 'Complex' provided"))}function Hx(e){throw new Error("Cannot convert value ".concat(e," into a Fraction, no class 'Fraction' provided."))}var Lx="number",Bx="number, number";function zx(e){return Math.abs(e)}function Wx(e,t){return e+t}function Vx(e,t){return e-t}function Ux(e,t){return e*t}function qx(e){return-e}function Gx(e){return e}function Yx(e){return Th(e)}function Kx(e){return e*e*e}function $x(e){return Math.exp(e)}function Xx(e){return Ah(e)}function Qx(e,t){if(!wh(e)||!wh(t))throw new Error("Parameters in function lcm must be integer numbers");if(0===e||0===t)return 0;for(var n,r=e*t;0!==t;)t=e%(n=t),e=n;return Math.abs(r/e)}function Jx(e,t){return t?Math.log(e)/Math.log(t):Math.log(e)}function Zx(e){return Eh(e)}function eS(e){return Ch(e)}function tS(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=t<0;if(n&&(t=-t),0===t)throw new Error("Root must be non-zero");if(e<0&&Math.abs(t)%2!==1)throw new Error("Root must be odd when a is negative.");if(0===e)return n?1/0:0;if(!isFinite(e))return n?0:e;var r=Math.pow(Math.abs(e),1/t);return r=e<0?-r:r,n?1/r:r}function nS(e){return Sh(e)}function rS(e){return e*e}function iS(e,t){var n,r,i,o=0,a=1,s=1,l=0;if(!wh(e)||!wh(t))throw new Error("Parameters in function xgcd must be integer numbers");for(;t;)i=e-(r=Math.floor(e/t))*t,n=o,o=a-r*o,a=n,n=s,s=l-r*s,l=n,e=t,t=i;return e<0?[-e,-a,-l]:[e,e?a:0,l]}function oS(e,t){return e*e<1&&t===1/0||e*e>1&&t===-1/0?0:Math.pow(e,t)}function aS(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!wh(t)||t<0||t>15)throw new Error("Number of decimals in function round must be an integer from 0 to 15 inclusive");return parseFloat(_h(e,t))}zx.signature=Lx,Wx.signature=Bx,Vx.signature=Bx,Ux.signature=Bx,qx.signature=Lx,Gx.signature=Lx,Yx.signature=Lx,Kx.signature=Lx,$x.signature=Lx,Xx.signature=Lx,Qx.signature=Bx,Zx.signature=Lx,eS.signature=Lx,nS.signature=Lx,rS.signature=Lx,iS.signature=Bx,oS.signature=Bx;var sS=vh("abs",["typed"],e=>{var{typed:t}=e;return t("abs",{number:zx,"Complex | BigNumber | Fraction | Unit":e=>e.abs(),bigint:e=>e<0n?-e:e,"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e,!0))})}),lS="acos",cS=vh(lS,["typed","config","Complex"],e=>{var{typed:t,config:n,Complex:r}=e;return t(lS,{number:function(e){return e>=-1&&e<=1||n.predictable?Math.acos(e):new r(e,0).acos()},Complex:function(e){return e.acos()},BigNumber:function(e){return e.acos()}})}),uS="number";function dS(e){return Fh(e)}function hS(e){return Math.atan(1/e)}function fS(e){return isFinite(e)?(Math.log((e+1)/e)+Math.log(e/(e-1)))/2:0}function mS(e){return Math.asin(1/e)}function pS(e){var t=1/e;return Math.log(t+Math.sqrt(t*t+1))}function gS(e){return Math.acos(1/e)}function vS(e){var t=1/e,n=Math.sqrt(t*t-1);return Math.log(n+t)}function yS(e){return Hh(e)}function bS(e){return Lh(e)}function wS(e){return 1/Math.tan(e)}function xS(e){var t=Math.exp(2*e);return(t+1)/(t-1)}function SS(e){return 1/Math.sin(e)}function CS(e){return 0===e?Number.POSITIVE_INFINITY:Math.abs(2/(Math.exp(e)-Math.exp(-e)))*Sh(e)}function ES(e){return 1/Math.cos(e)}function NS(e){return 2/(Math.exp(e)+Math.exp(-e))}function TS(e){return zh(e)}dS.signature=uS,hS.signature=uS,fS.signature=uS,mS.signature=uS,pS.signature=uS,gS.signature=uS,vS.signature=uS,yS.signature=uS,bS.signature=uS,wS.signature=uS,xS.signature=uS,SS.signature=uS,CS.signature=uS,ES.signature=uS,NS.signature=uS,TS.signature=uS;var AS="acot",RS=vh(AS,["typed","BigNumber"],e=>{var{typed:t,BigNumber:n}=e;return t(AS,{number:hS,Complex:function(e){return e.acot()},BigNumber:function(e){return new n(1).div(e).atan()}})}),kS="acsc",MS=vh(kS,["typed","config","Complex","BigNumber"],e=>{var{typed:t,config:n,Complex:r,BigNumber:i}=e;return t(kS,{number:function(e){return e<=-1||e>=1||n.predictable?mS(e):new r(e,0).acsc()},Complex:function(e){return e.acsc()},BigNumber:function(e){return new i(1).div(e).asin()}})}),DS="addScalar",_S=vh(DS,["typed"],e=>{var{typed:t}=e;return t(DS,{"number, number":Wx,"Complex, Complex":function(e,t){return e.add(t)},"BigNumber, BigNumber":function(e,t){return e.plus(t)},"bigint, bigint":function(e,t){return e+t},"Fraction, Fraction":function(e,t){return e.add(t)},"Unit, Unit":t.referToSelf(e=>(n,r)=>{if(null===n.value||void 0===n.value)throw new Error("Parameter x contains a unit with undefined value");if(null===r.value||void 0===r.value)throw new Error("Parameter y contains a unit with undefined value");if(!n.equalBase(r))throw new Error("Units do not match");var i=n.clone();return i.value=t.find(e,[i.valueType(),r.valueType()])(i.value,r.value),i.fixPrefix=!1,i})})}),OS=vh("arg",["typed"],e=>{var{typed:t}=e;return t("arg",{number:function(e){return Math.atan2(0,e)},BigNumber:function(e){return e.constructor.atan2(0,e)},Complex:function(e){return e.arg()},"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))})}),IS="asech",PS=vh(IS,["typed","config","Complex","BigNumber"],e=>{var{typed:t,config:n,Complex:r,BigNumber:i}=e;return t(IS,{number:function(e){if(e<=1&&e>=-1||n.predictable){var t=1/e;if(t>0||n.predictable)return vS(e);var i=Math.sqrt(t*t-1);return new r(Math.log(i-t),Math.PI)}return new r(e,0).asech()},Complex:function(e){return e.asech()},BigNumber:function(e){return new i(1).div(e).acosh()}})}),jS=vh("asinh",["typed"],e=>{var{typed:t}=e;return t("asinh",{number:yS,Complex:function(e){return e.asinh()},BigNumber:function(e){return e.asinh()}})}),FS=vh("atan",["typed"],e=>{var{typed:t}=e;return t("atan",{number:function(e){return Math.atan(e)},Complex:function(e){return e.atan()},BigNumber:function(e){return e.atan()}})}),HS="atanh",LS=vh(HS,["typed","config","Complex"],e=>{var{typed:t,config:n,Complex:r}=e;return t(HS,{number:function(e){return e<=1&&e>=-1||n.predictable?bS(e):new r(e,0).atanh()},Complex:function(e){return e.atanh()},BigNumber:function(e){return e.atanh()}})}),BS=vh("bigint",["typed"],e=>{var{typed:t}=e,n=t("bigint",{"":function(){return 0n},bigint:function(e){return e},number:function(e){return BigInt(e.toFixed())},BigNumber:function(e){return BigInt(e.round().toString())},Fraction:function(e){return BigInt(e.valueOf().toFixed())},"string | boolean":function(e){return BigInt(e)},null:function(e){return 0n},"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))});return n.fromJSON=function(e){return BigInt(e.value)},n}),zS="bitNot",WS=vh(zS,["typed"],e=>{var{typed:t}=e;return t(zS,{number:Bg,BigNumber:Dg,bigint:e=>~e,"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))})}),VS="boolean",US=vh(VS,["typed"],e=>{var{typed:t}=e;return t(VS,{"":function(){return!1},boolean:function(e){return e},number:function(e){return!!e},null:function(e){return!1},BigNumber:function(e){return!e.isZero()},string:function(e){var t=e.toLowerCase();if("true"===t)return!0;if("false"===t)return!1;var n=Number(e);if(""!==e&&!isNaN(n))return!!n;throw new Error('Cannot convert "'+e+'" to a boolean')},"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))})}),qS="clone",GS=vh(qS,["typed"],e=>{var{typed:t}=e;return t(qS,{any:hd})});function YS(e,t){if(t<e)return 1;if(t===e)return t;var n=t+e>>1;return YS(e,n)*YS(n+1,t)}function KS(e,t){if(!wh(e)||e<0)throw new TypeError("Positive integer value expected in function combinations");if(!wh(t)||t<0)throw new TypeError("Positive integer value expected in function combinations");if(t>e)throw new TypeError("k must be less than or equal to n");for(var n=e-t,r=1,i=2,o=t<n?t:n,a=t<n?n+1:t+1;a<=e;++a)for(r*=a;i<=o&&r%i===0;)r/=i,++i;return i<=o&&(r/=YS(i,o)),r}KS.signature="number, number";var $S="combinations",XS=vh($S,["typed"],e=>{var{typed:t}=e;return t($S,{"number, number":KS,"BigNumber, BigNumber":function(e,t){var n,r,i=e.constructor,o=e.minus(t),a=new i(1);if(!QS(e)||!QS(t))throw new TypeError("Positive integer value expected in function combinations");if(t.gt(e))throw new TypeError("k must be less than n in function combinations");if(n=a,t.lt(o))for(r=a;r.lte(o);r=r.plus(a))n=n.times(t.plus(r)).dividedBy(r);else for(r=a;r.lte(t);r=r.plus(a))n=n.times(o.plus(r)).dividedBy(r);return n}})});function QS(e){return e.isInteger()&&e.gte(0)}var JS=vh("complex",["typed","Complex"],e=>{var{typed:t,Complex:n}=e;return t("complex",{"":function(){return n.ZERO},number:function(e){return new n(e,0)},"number, number":function(e,t){return new n(e,t)},"BigNumber, BigNumber":function(e,t){return new n(e.toNumber(),t.toNumber())},Fraction:function(e){return new n(e.valueOf(),0)},Complex:function(e){return e.clone()},string:function(e){return n(e)},null:function(e){return n(0)},Object:function(e){if("re"in e&&"im"in e)return new n(e.re,e.im);if("r"in e&&"phi"in e||"abs"in e&&"arg"in e)return new n(e);throw new Error("Expected object with properties (re and im) or (r and phi) or (abs and arg)")},"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))})}),ZS="conj",eC=vh(ZS,["typed"],e=>{var{typed:t}=e;return t(ZS,{"number | BigNumber | Fraction":e=>e,Complex:e=>e.conjugate(),Unit:t.referToSelf(e=>t=>new t.constructor(e(t.toNumeric()),t.formatUnits())),"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))})}),tC=vh("trigUnit",["typed"],e=>{var{typed:t}=e;return{Unit:t.referToSelf(e=>n=>{if(!n.hasBase(n.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return t.find(e,n.valueType())(n.value)})}}),nC=vh("cos",["typed"],e=>{var{typed:t}=e,n=tC({typed:t});return t("cos",{number:Math.cos,"Complex | BigNumber":e=>e.cos()},n)}),rC=vh("cot",["typed","BigNumber"],e=>{var{typed:t,BigNumber:n}=e;return t("cot",{number:wS,Complex:e=>e.cot(),BigNumber:e=>new n(1).div(e.tan())},tC({typed:t}))}),iC=vh("csc",["typed","BigNumber"],e=>{var{typed:t,BigNumber:n}=e;return t("csc",{number:SS,Complex:e=>e.csc(),BigNumber:e=>new n(1).div(e.sin())},tC({typed:t}))}),oC="cube",aC=vh(oC,["typed"],e=>{var{typed:t}=e;return t(oC,{number:Kx,Complex:function(e){return e.mul(e).mul(e)},BigNumber:function(e){return e.times(e).times(e)},bigint:function(e){return e*e*e},Fraction:function(e){return e.pow(3)},Unit:function(e){return e.pow(3)}})});function sC(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-9,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(n<=0)throw new Error("Relative tolerance must be greater than 0");if(r<0)throw new Error("Absolute tolerance must be at least 0");return!e.isNaN()&&!t.isNaN()&&(e.isFinite()&&t.isFinite()?!!e.eq(t)||e.minus(t).abs().lte(e.constructor.max(e.constructor.max(e.abs(),t.abs()).mul(n),r)):e.eq(t))}var lC=vh("compareUnits",["typed"],e=>{var{typed:t}=e;return{"Unit, Unit":t.referToSelf(e=>(n,r)=>{if(!n.equalBase(r))throw new Error("Cannot compare units with different base");return t.find(e,[n.valueType(),r.valueType()])(n.value,r.value)})}}),cC="equalScalar",uC=vh(cC,["typed","config"],e=>{var{typed:t,config:n}=e,r=lC({typed:t});return t(cC,{"boolean, boolean":function(e,t){return e===t},"number, number":function(e,t){return jh(e,t,n.relTol,n.absTol)},"BigNumber, BigNumber":function(e,t){return e.eq(t)||sC(e,t,n.relTol,n.absTol)},"bigint, bigint":function(e,t){return e===t},"Fraction, Fraction":function(e,t){return e.equals(t)},"Complex, Complex":function(e,t){return function(e,t,n,r){return jh(e.re,t.re,n,r)&&jh(e.im,t.im,n,r)}(e,t,n.relTol,n.absTol)}},r)}),dC=(vh(cC,["typed","config"],e=>{var{typed:t,config:n}=e;return t(cC,{"number, number":function(e,t){return jh(e,t,n.relTol,n.absTol)}})}),vh("erf",["typed"],e=>{var{typed:t}=e;return t("name",{number:function(e){var t=Math.abs(e);return t>=gC?Sh(e):t<=hC?Sh(e)*function(e){var t,n=e*e,r=mC[0][4]*n,i=n;for(t=0;t<3;t+=1)r=(r+mC[0][t])*n,i=(i+pC[0][t])*n;return e*(r+mC[0][3])/(i+pC[0][3])}(t):t<=4?Sh(e)*(1-function(e){var t,n=mC[1][8]*e,r=e;for(t=0;t<7;t+=1)n=(n+mC[1][t])*e,r=(r+pC[1][t])*e;var i=(n+mC[1][7])/(r+pC[1][7]),o=parseInt(16*e)/16,a=(e-o)*(e+o);return Math.exp(-o*o)*Math.exp(-a)*i}(t)):Sh(e)*(1-function(e){var t,n=1/(e*e),r=mC[2][5]*n,i=n;for(t=0;t<4;t+=1)r=(r+mC[2][t])*n,i=(i+pC[2][t])*n;var o=n*(r+mC[2][4])/(i+pC[2][4]);o=(fC-o)/e,n=parseInt(16*e)/16;var a=(e-n)*(e+n);return Math.exp(-n*n)*Math.exp(-a)*o}(t))},"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))})})),hC=.46875,fC=.5641895835477563,mC=[[3.1611237438705655,113.86415415105016,377.485237685302,3209.3775891384694,.18577770618460315],[.5641884969886701,8.883149794388377,66.11919063714163,298.6351381974001,881.952221241769,1712.0476126340707,2051.0783778260716,1230.3393547979972,2.1531153547440383e-8],[.30532663496123236,.36034489994980445,.12578172611122926,.016083785148742275,.0006587491615298378,.016315387137302097]],pC=[[23.601290952344122,244.02463793444417,1282.6165260773723,2844.236833439171],[15.744926110709835,117.6939508913125,537.1811018620099,1621.3895745666903,3290.7992357334597,4362.619090143247,3439.3676741437216,1230.3393548037495],[2.568520192289822,1.8729528499234604,.5279051029514285,.06051834131244132,.0023352049762686918]],gC=Math.pow(2,53),vC=vh("exp",["typed"],e=>{var{typed:t}=e;return t("exp",{number:$x,Complex:function(e){return e.exp()},BigNumber:function(e){return e.exp()}})}),yC="expm1",bC=vh(yC,["typed","Complex"],e=>{var{typed:t,Complex:n}=e;return t(yC,{number:Xx,Complex:function(e){var t=Math.exp(e.re);return new n(t*Math.cos(e.im)-1,t*Math.sin(e.im))},BigNumber:function(e){return e.exp().minus(1)}})}),wC="flatten",xC=vh(wC,["typed"],e=>{var{typed:t}=e;return t(wC,{Array:function(e){return Sf(e)},DenseMatrix:function(e){return e.create(Sf(e.valueOf(),!0),e.datatype())},SparseMatrix:function(e){throw new TypeError("SparseMatrix is not supported by function flatten because it does not support 1D vectors. Convert to a DenseMatrix or Array first. Example: flatten(x.toArray())")}})}),SC="format",CC=vh(SC,["typed"],e=>{var{typed:t}=e;return t(SC,{any:Xh,"any, Object | function | number | BigNumber":Xh})}),EC="getMatrixDataType",NC=vh(EC,["typed"],e=>{var{typed:t}=e;return t(EC,{Array:function(e){return Mf(e,ph)},Matrix:function(e){return e.getDataType()}})}),TC=vh("hex",["typed","format"],e=>{var{typed:t,format:n}=e;return t("hex",{"number | BigNumber":function(e){return n(e,{notation:"hex"})},"number | BigNumber, number | BigNumber":function(e,t){return n(e,{notation:"hex",wordSize:t})}})}),AC=vh("im",["typed"],e=>{var{typed:t}=e;return t("im",{number:()=>0,"BigNumber | Fraction":e=>e.mul(0),Complex:e=>e.im,"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))})}),RC="isInteger",kC=vh(RC,["typed"],e=>{var{typed:t}=e;return t(RC,{number:wh,BigNumber:function(e){return e.isInt()},bigint:function(e){return!0},Fraction:function(e){return 1n===e.d},"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))})}),MC="number";function DC(e){return e<0}function _C(e){return e>0}function OC(e){return Number.isNaN(e)}DC.signature=MC,_C.signature=MC,OC.signature=MC;var IC="isNegative",PC=vh(IC,["typed","config"],e=>{var{typed:t,config:n}=e;return t(IC,{number:e=>!jh(e,0,n.relTol,n.absTol)&&DC(e),BigNumber:e=>!sC(e,new e.constructor(0),n.relTol,n.absTol)&&(e.isNeg()&&!e.isZero()&&!e.isNaN()),bigint:e=>e<0n,Fraction:e=>e.s<0n,Unit:t.referToSelf(e=>n=>t.find(e,n.valueType())(n.value)),"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))})}),jC="isPositive",FC=vh(jC,["typed","config"],e=>{var{typed:t,config:n}=e;return t(jC,{number:e=>!jh(e,0,n.relTol,n.absTol)&&_C(e),BigNumber:e=>!sC(e,new e.constructor(0),n.relTol,n.absTol)&&(!e.isNeg()&&!e.isZero()&&!e.isNaN()),bigint:e=>e>0n,Fraction:e=>e.s>0n&&e.n>0n,Unit:t.referToSelf(e=>n=>t.find(e,n.valueType())(n.value)),"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))})}),HC="isZero",LC=vh(HC,["typed","equalScalar"],e=>{var{typed:t,equalScalar:n}=e;return t(HC,{"number | BigNumber | Complex | Fraction":e=>n(e,0),bigint:e=>0n===e,Unit:t.referToSelf(e=>n=>t.find(e,n.valueType())(n.value)),"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))})});function BC(e){var t;if(wh(e))return e<=0?isFinite(e)?1/0:NaN:e>171?1/0:YS(1,e-1);if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*BC(1-e));if(e>=171.35)return 1/0;if(e>85){var n=e*e,r=n*e,i=r*e,o=i*e;return Math.sqrt(2*Math.PI/e)*Math.pow(e/Math.E,e)*(1+1/(12*e)+1/(288*n)-139/(51840*r)-571/(2488320*i)+163879/(209018880*o)+5246819/(75246796800*o*e))}--e,t=WC[0];for(var a=1;a<WC.length;++a)t+=WC[a]/(e+a);var s=e+zC+.5;return Math.sqrt(2*Math.PI)*Math.pow(s,e+.5)*Math.exp(-s)*t}BC.signature="number";var zC=4.7421875,WC=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],VC=.9189385332046728,UC=[1.000000000190015,76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];function qC(e){if(e<0)return NaN;if(0===e)return 1/0;if(!isFinite(e))return e;if(e<.5)return Math.log(Math.PI/Math.sin(Math.PI*e))-qC(1-e);for(var t=(e-=1)+5+.5,n=UC[0],r=6;r>=1;r--)n+=UC[r]/(e+r);return VC+(e+.5)*Math.log(t)-t+Math.log(n)}qC.signature="number";var GC="lgamma",YC=vh(GC,["Complex","typed"],e=>{var{Complex:t,typed:n}=e,r=[-.029550653594771242,.00641025641025641,-.0019175269175269176,.0008417508417508417,-.0005952380952380953,.0007936507936507937,-.002777777777777778,.08333333333333333];return n(GC,{number:qC,Complex:function e(n){if(n.isNaN())return new t(NaN,NaN);if(0===n.im)return new t(qC(n.re),0);if(n.re>=7||Math.abs(n.im)>=7)return i(n);if(n.re<=.1){var r=(l=6.283185307179586,c=n.im,((l>0||!(l<0)&&1/l===1/0)^(c>0||!(c<0)&&1/c===1/0)?-l:l)*Math.floor(.5*n.re+.25)),a=n.mul(Math.PI).sin().log(),s=e(new t(1-n.re,-n.im));return new t(1.1447298858494002,r).sub(a).sub(s)}return n.im>=0?o(n):o(n.conjugate()).conjugate();var l,c},BigNumber:function(){throw new Error("mathjs doesn't yet provide an implementation of the algorithm lgamma for BigNumber")}});function i(e){for(var n=e.sub(.5).mul(e.log()).sub(e).add(VC),i=new t(1,0).div(e),o=i.div(e),a=r[0],s=r[1],l=2*o.re,c=o.re*o.re+o.im*o.im,u=2;u<8;u++){var d=s;s=-c*a+r[u],a=l*a+d}var h=i.mul(o.mul(a).add(s));return n.add(h)}function o(e){var n=0,r=0,o=e;for(e=e.add(1);e.re<=7;){var a=(o=o.mul(e)).im<0?1:0;0!==a&&0===r&&n++,r=a,e=e.add(1)}return i(e).sub(o.log()).sub(new t(0,2*n*Math.PI*1))}});function KC(e,t,n,r){return function(i){if(i>0||n.predictable){if(i<=0)return NaN;var o=i.toString(16),a=o.substring(0,15);return e*(o.length-a.length)+t(Number("0x"+a))}return r(i.toNumber())}}var $C="log10",XC=["typed","config","Complex"],QC=Zx(16),JC=vh($C,XC,e=>{var{typed:t,config:n,Complex:r}=e;function i(e){return e.log().div(Math.LN10)}function o(e){return i(new r(e,0))}return t($C,{number:function(e){return e>=0||n.predictable?Zx(e):o(e)},bigint:KC(QC,Zx,n,o),Complex:i,BigNumber:function(e){return!e.isNegative()||n.predictable?e.log():o(e.toNumber())},"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))})}),ZC="log2",eE=vh(ZC,["typed","config","Complex"],e=>{var{typed:t,config:n,Complex:r}=e;function i(e){return o(new r(e,0))}return t(ZC,{number:function(e){return e>=0||n.predictable?eS(e):i(e)},bigint:KC(4,eS,n,i),Complex:o,BigNumber:function(e){return!e.isNegative()||n.predictable?e.log(2):i(e.toNumber())},"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))});function o(e){var t=Math.sqrt(e.re*e.re+e.im*e.im);return new r(Math.log2?Math.log2(t):Math.log(t)/Math.LN2,Math.atan2(e.im,e.re)/Math.LN2)}}),tE=vh("multiplyScalar",["typed"],e=>{var{typed:t}=e;return t("multiplyScalar",{"number, number":Ux,"Complex, Complex":function(e,t){return e.mul(t)},"BigNumber, BigNumber":function(e,t){return e.times(t)},"bigint, bigint":function(e,t){return e*t},"Fraction, Fraction":function(e,t){return e.mul(t)},"number | Fraction | BigNumber | Complex, Unit":(e,t)=>t.multiply(e),"Unit, number | Fraction | BigNumber | Complex | Unit":(e,t)=>e.multiply(t)})}),nE=vh("not",["typed"],e=>{var{typed:t}=e;return t("not",{"null | undefined":()=>!0,number:ig,Complex:function(e){return 0===e.re&&0===e.im},BigNumber:function(e){return e.isZero()||e.isNaN()},bigint:e=>!e,Unit:t.referToSelf(e=>n=>t.find(e,n.valueType())(n.value)),"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))})});var rE=vh("number",["typed"],e=>{var{typed:t}=e,n=t("number",{"":function(){return 0},number:function(e){return e},string:function(e){if("NaN"===e)return NaN;var t=function(e){var t=e.match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/);return t?{input:e,radix:{"0b":2,"0o":8,"0x":16}[t[1]],integerPart:t[2],fractionalPart:t[3]}:null}(e);if(t)return function(e){for(var t=parseInt(e.integerPart,e.radix),n=0,r=0;r<e.fractionalPart.length;r++)n+=parseInt(e.fractionalPart[r],e.radix)/Math.pow(e.radix,r+1);var i=t+n;if(isNaN(i))throw new SyntaxError('String "'+e.input+'" is not a valid number');return i}(t);var n=0,r=e.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);r&&(n=Number(r[2]),e=r[1]);var i=Number(e);if(isNaN(i))throw new SyntaxError('String "'+e+'" is not a valid number');if(r){if(i>2**n-1)throw new SyntaxError('String "'.concat(e,'" is out of range'));i>=2**(n-1)&&(i-=2**n)}return i},BigNumber:function(e){return e.toNumber()},bigint:function(e){return Number(e)},Fraction:function(e){return e.valueOf()},Unit:t.referToSelf(e=>t=>{var n=t.clone();return n.value=e(t.value),n}),null:function(e){return 0},"Unit, string | Unit":function(e,t){return e.toNumber(t)},"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))});return n.fromJSON=function(e){return parseFloat(e.value)},n}),iE=vh("oct",["typed","format"],e=>{var{typed:t,format:n}=e;return t("oct",{"number | BigNumber":function(e){return n(e,{notation:"oct"})},"number | BigNumber, number | BigNumber":function(e,t){return n(e,{notation:"oct",wordSize:t})}})}),oE=n(4334),aE=oE(Date.now());function sE(e){var t,n;return t=null===(n=e)?aE:oE(String(n)),function(){return t()}}var lE="pickRandom",cE=vh(lE,["typed","config","?on"],e=>{var{typed:t,config:n,on:r}=e,i=sE(n.randomSeed);return r&&r("config",function(e,t){e.randomSeed!==t.randomSeed&&(i=sE(e.randomSeed))}),t(lE,{"Array | Matrix":function(e){return o(e,{})},"Array | Matrix, Object":function(e,t){return o(e,t)},"Array | Matrix, number":function(e,t){return o(e,{number:t})},"Array | Matrix, Array | Matrix":function(e,t){return o(e,{weights:t})},"Array | Matrix, Array | Matrix, number":function(e,t,n){return o(e,{number:n,weights:t})},"Array | Matrix, number, Array | Matrix":function(e,t,n){return o(e,{number:t,weights:n})}});function o(e,t){var{number:n,weights:r,elementWise:o=!0}=t,a="undefined"===typeof n;a&&(n=1);var s=Pd(e)?e.create:Pd(r)?r.create:null;e=e.valueOf(),r&&(r=r.valueOf()),!0===o&&(e=Sf(e),r=Sf(r));var l=0;if("undefined"!==typeof r){if(r.length!==e.length)throw new Error("Weights must have the same length as possibles");for(var c=0,u=r.length;c<u;c++){if(!Ad(r[c])||r[c]<0)throw new Error("Weights must be an array of positive numbers");l+=r[c]}}for(var d,h=e.length,f=[];f.length<n;){if("undefined"===typeof r)d=e[Math.floor(i()*h)];else for(var m=i()*l,p=0,g=e.length;p<g;p++)if((m-=r[p])<0){d=e[p];break}f.push(d)}return a?f[0]:s?s(f):f}});function uE(e,t){var n=[];if((e=e.slice(0)).length>1)for(var r=0,i=e.shift();r<i;r++)n.push(uE(e,t));else for(var o=0,a=e.shift();o<a;o++)n.push(t());return n}var dE="random",hE=vh(dE,["typed","config","?on"],e=>{var{typed:t,config:n,on:r}=e,i=sE(n.randomSeed);return r&&r("config",function(e,t){e.randomSeed!==t.randomSeed&&(i=sE(e.randomSeed))}),t(dE,{"":()=>a(0,1),number:e=>a(0,e),"number, number":(e,t)=>a(e,t),"Array | Matrix":e=>o(e,0,1),"Array | Matrix, number":(e,t)=>o(e,0,t),"Array | Matrix, number, number":(e,t,n)=>o(e,t,n)});function o(e,t,n){var r=uE(e.valueOf(),()=>a(t,n));return Pd(e)?e.create(r,"number"):r}function a(e,t){return e+i()*(t-e)}}),fE=vh("re",["typed"],e=>{var{typed:t}=e;return t("re",{"number | BigNumber | Fraction":e=>e,Complex:e=>e.re,"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))})}),mE=vh("sec",["typed","BigNumber"],e=>{var{typed:t,BigNumber:n}=e;return t("sec",{number:ES,Complex:e=>e.sec(),BigNumber:e=>new n(1).div(e.cos())},tC({typed:t}))}),pE="sign",gE=vh(pE,["typed","BigNumber","Fraction","complex"],e=>{var{typed:t,BigNumber:n,complex:r,Fraction:i}=e;return t(pE,{number:nS,Complex:function(e){return 0===e.im?r(nS(e.re)):e.sign()},BigNumber:function(e){return new n(e.cmp(0))},bigint:function(e){return e>0n?1n:e<0n?-1n:0n},Fraction:function(e){return 0n===e.n?new i(0):new i(e.s)},"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e,!0)),Unit:t.referToSelf(e=>n=>{if(!n._isDerived()&&0!==n.units[0].unit.offset)throw new TypeError("sign is ambiguous for units with offset");return t.find(e,n.valueType())(n.value)})})}),vE=vh("sin",["typed"],e=>{var{typed:t}=e,n=tC({typed:t});return t("sin",{number:Math.sin,"Complex | BigNumber":e=>e.sin()},n)}),yE="size",bE=vh(yE,["typed"],e=>{var{typed:t}=e;return t(yE,{Matrix:e=>e.size(),Array:sf,string:e=>[e.length],"number | Complex | BigNumber | Unit | boolean | null":e=>[]})}),wE=vh("SparseMatrix",["typed","equalScalar","Matrix"],e=>{var{typed:t,equalScalar:n,Matrix:r}=e;function i(e,t){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(t&&!Od(t))throw new Error("Invalid datatype: "+t);if(Pd(e))!function(e,t,n){"SparseMatrix"===t.type?(e._values=t._values?hd(t._values):void 0,e._index=hd(t._index),e._ptr=hd(t._ptr),e._size=hd(t._size),e._datatype=n||t._datatype):o(e,t.valueOf(),n||t._datatype)}(this,e,t);else if(e&&Id(e.index)&&Id(e.ptr)&&Id(e.size))this._values=e.values,this._index=e.index,this._ptr=e.ptr,this._size=e.size,this._datatype=t||e.datatype;else if(Id(e))o(this,e,t);else{if(e)throw new TypeError("Unsupported type of data ("+ph(e)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=t}}function o(e,r,i){e._values=[],e._index=[],e._ptr=[],e._datatype=i;var o=r.length,a=0,s=n,l=0;if(Od(i)&&(s=t.find(n,[i,i])||n,l=t.convert(0,i)),o>0){var c=0;do{e._ptr.push(e._index.length);for(var u=0;u<o;u++){var d=r[u];if(Id(d)){if(0===c&&a<d.length&&(a=d.length),c<d.length){var h=d[c];s(h,l)||(e._values.push(h),e._index.push(u))}}else 0===c&&a<1&&(a=1),s(d,l)||(e._values.push(d),e._index.push(u))}c++}while(c<a)}e._ptr.push(e._index.length),e._size=[o,a]}function a(e,t,n,r){if(n-t===0)return n;for(var i=t;i<n;i++)if(r[i]===e)return i;return t}function s(e,t,n,r,i,o,a){i.splice(e,0,r),o.splice(e,0,t);for(var s=n+1;s<a.length;s++)a[s]++}function l(e,r,i,o){var a=o||0,s=n,l=0;Od(e._datatype)&&(s=t.find(n,[e._datatype,e._datatype])||n,l=t.convert(0,e._datatype),a=t.convert(a,e._datatype));var c,u,d,h=!s(a,l),f=e._size[0],m=e._size[1];if(i>m){for(u=m;u<i;u++)if(e._ptr[u]=e._values.length,h)for(c=0;c<f;c++)e._values.push(a),e._index.push(c);e._ptr[i]=e._values.length}else i<m&&(e._ptr.splice(i+1,m-i),e._values.splice(e._ptr[i],e._values.length),e._index.splice(e._ptr[i],e._index.length));if(m=i,r>f){if(h){var p=0;for(u=0;u<m;u++){e._ptr[u]=e._ptr[u]+p,d=e._ptr[u+1]+p;var g=0;for(c=f;c<r;c++,g++)e._values.splice(d+g,0,a),e._index.splice(d+g,0,c),p++}e._ptr[m]=e._values.length}}else if(r<f){var v=0;for(u=0;u<m;u++){e._ptr[u]=e._ptr[u]-v;var y=e._ptr[u],b=e._ptr[u+1]-v;for(d=y;d<b;d++)(c=e._index[d])>r-1&&(e._values.splice(d,1),e._index.splice(d,1),v++)}e._ptr[u]=e._values.length}return e._size[0]=r,e._size[1]=i,e}function c(e,t,n,r,i){var o,a,s=r[0],l=r[1],c=[];for(o=0;o<s;o++)for(c[o]=[],a=0;a<l;a++)c[o][a]=0;for(a=0;a<l;a++)for(var u=n[a],d=n[a+1],h=u;h<d;h++)c[o=t[h]][a]=e?i?hd(e[h]):e[h]:1;return c}return i.prototype=new r,i.prototype.createSparseMatrix=function(e,t){return new i(e,t)},Object.defineProperty(i,"name",{value:"SparseMatrix"}),i.prototype.constructor=i,i.prototype.type="SparseMatrix",i.prototype.isSparseMatrix=!0,i.prototype.getDataType=function(){return Mf(this._values,ph)},i.prototype.storage=function(){return"sparse"},i.prototype.datatype=function(){return this._datatype},i.prototype.create=function(e,t){return new i(e,t)},i.prototype.density=function(){var e=this._size[0],t=this._size[1];return 0!==e&&0!==t?this._index.length/(e*t):0},i.prototype.subset=function(e,t,n){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return function(e,t){if(!Bd(t))throw new TypeError("Invalid index");if(t.isScalar())return e.get(t.min());var n,r,o,a,s=t.size();if(s.length!==e._size.length)throw new of(s.length,e._size.length);var l=t.min(),c=t.max();for(n=0,r=e._size.length;n<r;n++)df(l[n],e._size[n]),df(c[n],e._size[n]);var u=e._values,d=e._index,h=e._ptr,f=t.dimension(0),m=t.dimension(1),p=[],g=[];function v(e,t){g[e]=t[0],p[e]=!0}Number.isInteger(f)?v(f,[0]):f.forEach(v);var y=u?[]:void 0,b=[],w=[];function x(e){for(w.push(b.length),o=h[e],a=h[e+1];o<a;o++)n=d[o],!0===p[n]&&(b.push(g[n]),y&&y.push(u[o]))}Number.isInteger(m)?x(m):m.forEach(x);return w.push(b.length),new i({values:y,index:b,ptr:w,size:s,datatype:e._datatype})}(this,e);case 2:case 3:return function(e,t,n,r){if(!t||!0!==t.isIndex)throw new TypeError("Invalid index");var i,o=t.size(),a=t.isScalar();Pd(n)?(i=n.size(),n=n.toArray()):i=sf(n);if(a){if(0!==i.length)throw new TypeError("Scalar expected");e.set(t.min(),n,r)}else{if(1!==o.length&&2!==o.length)throw new of(o.length,e._size.length,"<");if(i.length<o.length){for(var s=0,l=0;1===o[s]&&1===i[s];)s++;for(;1===o[s];)l++,s++;n=wf(n,o.length,l,i)}if(!md(o,i))throw new of(o,i,">");if(1===o.length){d(t.dimension(0),(t,i)=>{df(t),e.set([t,0],n[i[0]],r)})}else{var c=t.dimension(0),u=t.dimension(1);d(c,(t,i)=>{df(t),d(u,(o,a)=>{df(o),e.set([t,o],n[i[0]][a[0]],r)})})}}return e;function d(e,t){Ad(e)?t(e,[0]):e.forEach(t)}}(this,e,t,n);default:throw new SyntaxError("Wrong number of arguments")}},i.prototype.get=function(e){if(!Id(e))throw new TypeError("Array expected");if(e.length!==this._size.length)throw new of(e.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var t=e[0],n=e[1];df(t,this._size[0]),df(n,this._size[1]);var r=a(t,this._ptr[n],this._ptr[n+1],this._index);return r<this._ptr[n+1]&&this._index[r]===t?this._values[r]:0},i.prototype.set=function(e,r,i){if(!Id(e))throw new TypeError("Array expected");if(e.length!==this._size.length)throw new of(e.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var o=e[0],c=e[1],u=this._size[0],d=this._size[1],h=n,f=0;Od(this._datatype)&&(h=t.find(n,[this._datatype,this._datatype])||n,f=t.convert(0,this._datatype)),(o>u-1||c>d-1)&&(l(this,Math.max(o+1,u),Math.max(c+1,d),i),u=this._size[0],d=this._size[1]),df(o,u),df(c,d);var m=a(o,this._ptr[c],this._ptr[c+1],this._index);return m<this._ptr[c+1]&&this._index[m]===o?h(r,f)?function(e,t,n,r,i){n.splice(e,1),r.splice(e,1);for(var o=t+1;o<i.length;o++)i[o]--}(m,c,this._values,this._index,this._ptr):this._values[m]=r:h(r,f)||s(m,o,c,r,this._values,this._index,this._ptr),this},i.prototype.resize=function(e,t,n){if(!jd(e))throw new TypeError("Array or Matrix expected");var r=e.valueOf().map(e=>Array.isArray(e)&&1===e.length?e[0]:e);if(2!==r.length)throw new Error("Only two dimensions matrix are supported");return r.forEach(function(e){if(!Ad(e)||!wh(e)||e<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Xh(r)+")")}),l(n?this.clone():this,r[0],r[1],t)},i.prototype.reshape=function(e,t){if(!Id(e))throw new TypeError("Array expected");if(2!==e.length)throw new Error("Sparse matrices can only be reshaped in two dimensions");e.forEach(function(t){if(!Ad(t)||!wh(t)||t<=-2||0===t)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+Xh(e)+")")});var n=this._size[0]*this._size[1];if(n!==(e=gf(e,n))[0]*e[1])throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var r=t?this.clone():this;if(this._size[0]===e[0]&&this._size[1]===e[1])return r;for(var i=[],o=0;o<r._ptr.length;o++)for(var l=0;l<r._ptr[o+1]-r._ptr[o];l++)i.push(o);for(var c=r._values.slice(),u=r._index.slice(),d=0;d<r._index.length;d++){var h=u[d],f=i[d],m=h*r._size[1]+f;i[d]=m%e[1],u[d]=Math.floor(m/e[1])}r._values.length=0,r._index.length=0,r._ptr.length=e[1]+1,r._size=e.slice();for(var p=0;p<r._ptr.length;p++)r._ptr[p]=0;for(var g=0;g<c.length;g++){var v=u[g],y=i[g],b=c[g];s(a(v,r._ptr[y],r._ptr[y+1],r._index),v,y,b,r._values,r._index,r._ptr)}return r},i.prototype.clone=function(){return new i({values:this._values?hd(this._values):void 0,index:hd(this._index),ptr:hd(this._ptr),size:hd(this._size),datatype:this._datatype})},i.prototype.size=function(){return this._size.slice(0)},i.prototype.map=function(e,r){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var o=this,a=this._size[0],s=this._size[1],l=Op(e,o,"map");return function(e,r,o,a,s,l,c){var u=[],d=[],h=[],f=n,m=0;Od(e._datatype)&&(f=t.find(n,[e._datatype,e._datatype])||n,m=t.convert(0,e._datatype));for(var p=function(e,t,n){var r=l(e,t,n);f(r,m)||(u.push(r),d.push(t))},g=a;g<=s;g++){h.push(u.length);var v=e._ptr[g],y=e._ptr[g+1];if(c)for(var b=v;b<y;b++){var w=e._index[b];w>=r&&w<=o&&p(e._values[b],w-r,g-a)}else{for(var x={},S=v;S<y;S++){x[e._index[S]]=e._values[S]}for(var C=r;C<=o;C++){p(C in x?x[C]:0,C-r,g-a)}}}return h.push(u.length),new i({values:u,index:d,ptr:h,size:[o-r+1,s-a+1]})}(this,0,a-1,0,s-1,function(e,t,n){return l.fn(e,[t,n],o)},r)},i.prototype.forEach=function(e,t){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var n=this,r=this._size[0],i=this._size[1],o=Op(e,n,"forEach"),a=0;a<i;a++){var s=this._ptr[a],l=this._ptr[a+1];if(t)for(var c=s;c<l;c++){var u=this._index[c];o.fn(this._values[c],[u,a],n)}else{for(var d={},h=s;h<l;h++){d[this._index[h]]=this._values[h]}for(var f=0;f<r;f++){var m=f in d?d[f]:0;o.fn(m,[f,a],n)}}}},i.prototype[Symbol.iterator]=function*(){if(!this._values)throw new Error("Cannot iterate a Pattern only matrix");for(var e=this._size[1],t=0;t<e;t++)for(var n=this._ptr[t],r=this._ptr[t+1],i=n;i<r;i++){var o=this._index[i];yield{value:this._values[i],index:[o,t]}}},i.prototype.toArray=function(){return c(this._values,this._index,this._ptr,this._size,!0)},i.prototype.valueOf=function(){return c(this._values,this._index,this._ptr,this._size,!1)},i.prototype.format=function(e){for(var t=this._size[0],n=this._size[1],r=this.density(),i="Sparse Matrix ["+Xh(t,e)+" x "+Xh(n,e)+"] density: "+Xh(r,e)+"\n",o=0;o<n;o++)for(var a=this._ptr[o],s=this._ptr[o+1],l=a;l<s;l++){i+="\n    ("+Xh(this._index[l],e)+", "+Xh(o,e)+") ==> "+(this._values?Xh(this._values[l],e):"X")}return i},i.prototype.toString=function(){return Xh(this.toArray())},i.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},i.prototype.diagonal=function(e){if(e){if(Rd(e)&&(e=e.toNumber()),!Ad(e)||!wh(e))throw new TypeError("The parameter k must be an integer number")}else e=0;var t=e>0?e:0,n=e<0?-e:0,r=this._size[0],o=this._size[1],a=Math.min(r-n,o-t),s=[],l=[],c=[];c[0]=0;for(var u=t;u<o&&s.length<a;u++)for(var d=this._ptr[u],h=this._ptr[u+1],f=d;f<h;f++){var m=this._index[f];if(m===u-t+n){s.push(this._values[f]),l[s.length-1]=m-n;break}}return c.push(s.length),new i({values:s,index:l,ptr:c,size:[a,1]})},i.fromJSON=function(e){return new i(e)},i.diagonal=function(e,r,o,a,s){if(!Id(e))throw new TypeError("Array expected, size parameter");if(2!==e.length)throw new Error("Only two dimensions matrix are supported");if(e=e.map(function(e){if(Rd(e)&&(e=e.toNumber()),!Ad(e)||!wh(e)||e<1)throw new Error("Size values must be positive integers");return e}),o){if(Rd(o)&&(o=o.toNumber()),!Ad(o)||!wh(o))throw new TypeError("The parameter k must be an integer number")}else o=0;var l=n,c=0;Od(s)&&(l=t.find(n,[s,s])||n,c=t.convert(0,s));var u,d=o>0?o:0,h=o<0?-o:0,f=e[0],m=e[1],p=Math.min(f-h,m-d);if(Id(r)){if(r.length!==p)throw new Error("Invalid value array length");u=function(e){return r[e]}}else if(Pd(r)){var g=r.size();if(1!==g.length||g[0]!==p)throw new Error("Invalid matrix length");u=function(e){return r.get([e])}}else u=function(){return r};for(var v=[],y=[],b=[],w=0;w<m;w++){b.push(v.length);var x=w-d;if(x>=0&&x<p){var S=u(x);l(S,c)||(y.push(x+h),v.push(S))}}return b.push(v.length),new i({values:v,index:y,ptr:b,size:[f,m]})},i.prototype.swapRows=function(e,t){if(!Ad(e)||!wh(e)||!Ad(t)||!wh(t))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return df(e,this._size[0]),df(t,this._size[0]),i._swapRows(e,t,this._size[1],this._values,this._index,this._ptr),this},i._forEachRow=function(e,t,n,r,i){for(var o=r[e],a=r[e+1],s=o;s<a;s++)i(n[s],t[s])},i._swapRows=function(e,t,n,r,i,o){for(var s=0;s<n;s++){var l=o[s],c=o[s+1],u=a(e,l,c,i),d=a(t,l,c,i);if(u<c&&d<c&&i[u]===e&&i[d]===t){if(r){var h=r[u];r[u]=r[d],r[d]=h}}else if(u<c&&i[u]===e&&(d>=c||i[d]!==t)){var f=r?r[u]:void 0;i.splice(d,0,t),r&&r.splice(d,0,f),i.splice(d<=u?u+1:u,1),r&&r.splice(d<=u?u+1:u,1)}else if(d<c&&i[d]===t&&(u>=c||i[u]!==e)){var m=r?r[d]:void 0;i.splice(u,0,e),r&&r.splice(u,0,m),i.splice(u<=d?d+1:d,1),r&&r.splice(u<=d?d+1:d,1)}}},i},{isClass:!0}),xE="splitUnit",SE=vh(xE,["typed"],e=>{var{typed:t}=e;return t(xE,{"Unit, Array":function(e,t){return e.splitUnit(t)}})}),CE="square",EE=vh(CE,["typed"],e=>{var{typed:t}=e;return t(CE,{number:rS,Complex:function(e){return e.mul(e)},BigNumber:function(e){return e.times(e)},bigint:function(e){return e*e},Fraction:function(e){return e.mul(e)},Unit:function(e){return e.pow(2)}})}),NE="string",TE=vh(NE,["typed"],e=>{var{typed:t}=e;return t(NE,{"":function(){return""},number:kh,null:function(e){return"null"},boolean:function(e){return e+""},string:function(e){return e},"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e)),any:function(e){return String(e)}})}),AE="subtractScalar",RE=vh(AE,["typed"],e=>{var{typed:t}=e;return t(AE,{"number, number":Vx,"Complex, Complex":function(e,t){return e.sub(t)},"BigNumber, BigNumber":function(e,t){return e.minus(t)},"bigint, bigint":function(e,t){return e-t},"Fraction, Fraction":function(e,t){return e.sub(t)},"Unit, Unit":t.referToSelf(e=>(n,r)=>{if(null===n.value||void 0===n.value)throw new Error("Parameter x contains a unit with undefined value");if(null===r.value||void 0===r.value)throw new Error("Parameter y contains a unit with undefined value");if(!n.equalBase(r))throw new Error("Units do not match");var i=n.clone();return i.value=t.find(e,[i.valueType(),r.valueType()])(i.value,r.value),i.fixPrefix=!1,i})})}),kE=vh("tan",["typed"],e=>{var{typed:t}=e,n=tC({typed:t});return t("tan",{number:Math.tan,"Complex | BigNumber":e=>e.tan()},n)}),ME="toBest",DE=vh(ME,["typed"],e=>{var{typed:t}=e;return t(ME,{Unit:e=>e.toBest(),"Unit, string":(e,t)=>e.toBest(t.split(",")),"Unit, string, Object":(e,t,n)=>e.toBest(t.split(","),n),"Unit, Array":(e,t)=>e.toBest(t),"Unit, Array, Object":(e,t,n)=>e.toBest(t,n)})}),_E="typeOf",OE=vh(_E,["typed"],e=>{var{typed:t}=e;return t(_E,{any:ph})}),IE="acosh",PE=vh(IE,["typed","config","Complex"],e=>{var{typed:t,config:n,Complex:r}=e;return t(IE,{number:function(e){return e>=1||n.predictable?dS(e):e<=-1?new r(Math.log(Math.sqrt(e*e-1)-e),Math.PI):new r(e,0).acosh()},Complex:function(e){return e.acosh()},BigNumber:function(e){return e.acosh()}})}),jE="acsch",FE=vh(jE,["typed","BigNumber"],e=>{var{typed:t,BigNumber:n}=e;return t(jE,{number:pS,Complex:function(e){return e.acsch()},BigNumber:function(e){return new n(1).div(e).asinh()}})}),HE="asec",LE=vh(HE,["typed","config","Complex","BigNumber"],e=>{var{typed:t,config:n,Complex:r,BigNumber:i}=e;return t(HE,{number:function(e){return e<=-1||e>=1||n.predictable?gS(e):new r(e,0).asec()},Complex:function(e){return e.asec()},BigNumber:function(e){return new i(1).div(e).acos()}})}),BE=vh("bignumber",["typed","BigNumber"],e=>{var{typed:t,BigNumber:n}=e;return t("bignumber",{"":function(){return new n(0)},number:function(e){return new n(e+"")},string:function(e){var t=e.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(t){var r=t[2],i=n(t[1]),o=new n(2).pow(Number(r));if(i.gt(o.sub(1)))throw new SyntaxError('String "'.concat(e,'" is out of range'));var a=new n(2).pow(Number(r)-1);return i.gte(a)?i.sub(o):i}return new n(e)},BigNumber:function(e){return e},bigint:function(e){return new n(e.toString())},Unit:t.referToSelf(e=>t=>{var n=t.clone();return n.value=e(t.value),n}),Fraction:function(e){return new n(String(e.n)).div(String(e.d)).times(String(e.s))},null:function(e){return new n(0)},"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))})}),zE="combinationsWithRep",WE=vh(zE,["typed"],e=>{var{typed:t}=e;return t(zE,{"number, number":function(e,t){if(!wh(e)||e<0)throw new TypeError("Positive integer value expected in function combinationsWithRep");if(!wh(t)||t<0)throw new TypeError("Positive integer value expected in function combinationsWithRep");if(e<1)throw new TypeError("k must be less than or equal to n + k - 1");return t<e-1?YS(e,e+t-1)/YS(1,t):YS(t+1,e+t-1)/YS(1,e-1)},"BigNumber, BigNumber":function(e,t){var n,r,i=new(0,e.constructor)(1),o=e.minus(i);if(!VE(e)||!VE(t))throw new TypeError("Positive integer value expected in function combinationsWithRep");if(e.lt(i))throw new TypeError("k must be less than or equal to n + k - 1 in function combinationsWithRep");if(n=i,t.lt(o))for(r=i;r.lte(o);r=r.plus(i))n=n.times(t.plus(r)).dividedBy(r);else for(r=i;r.lte(t);r=r.plus(i))n=n.times(o.plus(r)).dividedBy(r);return n}})});function VE(e){return e.isInteger()&&e.gte(0)}var UE="cosh",qE=vh(UE,["typed"],e=>{var{typed:t}=e;return t(UE,{number:Bh,"Complex | BigNumber":e=>e.cosh()})}),GE="csch",YE=vh(GE,["typed","BigNumber"],e=>{var{typed:t,BigNumber:n}=e;return t(GE,{number:CS,Complex:e=>e.csch(),BigNumber:e=>new n(1).div(e.sinh())})}),KE=vh("dot",["typed","addScalar","multiplyScalar","conj","size"],e=>{var{typed:t,addScalar:n,multiplyScalar:r,conj:i,size:o}=e;return t("dot",{"Array | DenseMatrix, Array | DenseMatrix":function(e,s){var l=a(e,s),c=Pd(e)?e._data:e,u=Pd(e)?e._datatype||e.getDataType():void 0,d=Pd(s)?s._data:s,h=Pd(s)?s._datatype||s.getDataType():void 0,f=2===o(e).length,m=2===o(s).length,p=n,g=r;if(u&&h&&u===h&&"string"===typeof u&&"mixed"!==u){var v=u;p=t.find(n,[v,v]),g=t.find(r,[v,v])}if(!f&&!m){for(var y=g(i(c[0]),d[0]),b=1;b<l;b++)y=p(y,g(i(c[b]),d[b]));return y}if(!f&&m){for(var w=g(i(c[0]),d[0][0]),x=1;x<l;x++)w=p(w,g(i(c[x]),d[x][0]));return w}if(f&&!m){for(var S=g(i(c[0][0]),d[0]),C=1;C<l;C++)S=p(S,g(i(c[C][0]),d[C]));return S}if(f&&m){for(var E=g(i(c[0][0]),d[0][0]),N=1;N<l;N++)E=p(E,g(i(c[N][0]),d[N][0]));return E}},"SparseMatrix, SparseMatrix":function(e,t){a(e,t);var i=e._index,o=e._values,s=t._index,l=t._values,c=0,u=n,d=r,h=0,f=0;for(;h<i.length&&f<s.length;){var m=i[h],p=s[f];m<p?h++:m>p?f++:m===p&&(c=u(c,d(o[h],l[f])),h++,f++)}return c}});function a(e,t){var n,r,i=o(e),a=o(t);if(1===i.length)n=i[0];else{if(2!==i.length||1!==i[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+i.join(", ")+")");n=i[0]}if(1===a.length)r=a[0];else{if(2!==a.length||1!==a[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+a.join(", ")+")");r=a[0]}if(n!==r)throw new RangeError("Vectors must have equal length ("+n+" != "+r+")");if(0===n)throw new RangeError("Cannot calculate the dot product of empty vectors");return n}}),$E="isNaN",XE=vh($E,["typed"],e=>{var{typed:t}=e;return t($E,{number:OC,BigNumber:function(e){return e.isNaN()},bigint:function(e){return!1},Fraction:function(e){return!1},Complex:function(e){return e.isNaN()},Unit:function(e){return Number.isNaN(e.value)},"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))})}),QE="isPrime",JE=vh(QE,["typed"],e=>{var{typed:t}=e;return t(QE,{number:function(e){if(e<=3)return e>1;if(e%2===0||e%3===0)return!1;for(var t=5;t*t<=e;t+=6)if(e%t===0||e%(t+2)===0)return!1;return!0},bigint:function(e){if(e<=3n)return e>1n;if(e%2n===0n||e%3n===0n)return!1;for(var t=5n;t*t<=e;t+=6n)if(e%t===0n||e%(t+2n)===0n)return!1;return!0},BigNumber:function(e){if(e.lte(3))return e.gt(1);if(e.mod(2).eq(0)||e.mod(3).eq(0))return!1;if(e.lt(Math.pow(2,32))){for(var t=e.toNumber(),n=5;n*n<=t;n+=6)if(t%n===0||t%(n+2)===0)return!1;return!0}function r(e,t,n){for(var r=1;!t.eq(0);)t.mod(2).eq(0)?(t=t.div(2),e=e.mul(e).mod(n)):(t=t.sub(1),r=e.mul(r).mod(n));return r}for(var i=e.constructor.clone({precision:2*e.toFixed(0).length}),o=0,a=(e=new i(e)).sub(1);a.mod(2).eq(0);)a=a.div(2),o+=1;var s=null;if(e.lt("3317044064679887385961981"))s=[2,3,5,7,11,13,17,19,23,29,31,37,41].filter(t=>t<e);else{var l=Math.min(e.toNumber()-2,Math.floor(2*Math.pow(e.toFixed(0).length*Math.log(10),2)));s=[];for(var c=2;c<=l;c+=1)s.push(l)}for(var u=0;u<s.length;u+=1){var d=s[u],h=r(e.sub(e).add(d),a,e);if(!h.eq(1))for(var f=0,m=h;!m.eq(e.sub(1));f+=1,m=m.mul(m).mod(e))if(f===o-1)return!1}return!0},"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))})}),ZE="matrix",eN=vh(ZE,["typed","Matrix","DenseMatrix","SparseMatrix"],e=>{var{typed:t,Matrix:n,DenseMatrix:r,SparseMatrix:i}=e;return t(ZE,{"":function(){return o([])},string:function(e){return o([],e)},"string, string":function(e,t){return o([],e,t)},Array:function(e){return o(e)},Matrix:function(e){return o(e,e.storage())},"Array | Matrix, string":o,"Array | Matrix, string, string":o});function o(e,t,n){if("dense"===t||"default"===t||void 0===t)return new r(e,n);if("sparse"===t)return new i(e,n);throw new TypeError("Unknown matrix type "+JSON.stringify(t)+".")}}),tN="matrixFromFunction",nN=vh(tN,["typed","matrix","isZero"],e=>{var{typed:t,matrix:n,isZero:r}=e;return t(tN,{"Array | Matrix, function, string, string":function(e,t,n,r){return i(e,t,n,r)},"Array | Matrix, function, string":function(e,t,n){return i(e,t,n)},"Matrix, function":function(e,t){return i(e,t,"dense")},"Array, function":function(e,t){return i(e,t,"dense").toArray()},"Array | Matrix, string, function":function(e,t,n){return i(e,n,t)},"Array | Matrix, string, string, function":function(e,t,n,r){return i(e,r,t,n)}});function i(e,t,i,o){var a;return(a=void 0!==o?n(i,o):n(i)).resize(e),a.forEach(function(e,n){var i=t(n);r(i)||a.set(n,i)}),a}}),rN="multiply",iN=vh(rN,["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],e=>{var{typed:t,matrix:n,addScalar:r,multiplyScalar:i,equalScalar:o,dot:a}=e,s=dg({typed:t,equalScalar:o}),l=eg({typed:t});function c(e,t){switch(e.length){case 1:switch(t.length){case 1:if(e[0]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(e[0]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+e[0]+") must match Matrix rows ("+t[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+t.length+" dimensions)")}break;case 2:switch(t.length){case 1:if(e[1]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+e[1]+") must match Vector length ("+t[0]+")");break;case 2:if(e[1]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+e[1]+") must match Matrix B rows ("+t[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+t.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+e.length+" dimensions)")}}function u(e,n){if("dense"!==n.storage())throw new Error("Support for SparseMatrix not implemented");return function(e,n){var o,a=e._data,s=e._size,l=e._datatype||e.getDataType(),c=n._data,u=n._size,d=n._datatype||n.getDataType(),h=s[0],f=u[1],m=r,p=i;l&&d&&l===d&&"string"===typeof l&&"mixed"!==l&&(o=l,m=t.find(r,[o,o]),p=t.find(i,[o,o]));for(var g=[],v=0;v<f;v++){for(var y=p(a[0],c[0][v]),b=1;b<h;b++)y=m(y,p(a[b],c[b][v]));g[v]=y}return e.createDenseMatrix({data:g,size:[f],datatype:l===e._datatype&&d===n._datatype?o:void 0})}(e,n)}var d=t("_multiplyMatrixVector",{"DenseMatrix, any":function(e,n){var o,a=e._data,s=e._size,l=e._datatype||e.getDataType(),c=n._data,u=n._datatype||n.getDataType(),d=s[0],h=s[1],f=r,m=i;l&&u&&l===u&&"string"===typeof l&&"mixed"!==l&&(o=l,f=t.find(r,[o,o]),m=t.find(i,[o,o]));for(var p=[],g=0;g<d;g++){for(var v=a[g],y=m(v[0],c[0]),b=1;b<h;b++)y=f(y,m(v[b],c[b]));p[g]=y}return e.createDenseMatrix({data:p,size:[d],datatype:l===e._datatype&&u===n._datatype?o:void 0})},"SparseMatrix, any":function(e,n){var a=e._values,s=e._index,l=e._ptr,c=e._datatype||void 0===e._data?e._datatype:e.getDataType();if(!a)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var u,d=n._data,h=n._datatype||n.getDataType(),f=e._size[0],m=n._size[0],p=[],g=[],v=[],y=r,b=i,w=o,x=0;c&&h&&c===h&&"string"===typeof c&&"mixed"!==c&&(u=c,y=t.find(r,[u,u]),b=t.find(i,[u,u]),w=t.find(o,[u,u]),x=t.convert(0,u));var S=[],C=[];v[0]=0;for(var E=0;E<m;E++){var N=d[E];if(!w(N,x))for(var T=l[E],A=l[E+1],R=T;R<A;R++){var k=s[R];C[k]?S[k]=y(S[k],b(N,a[R])):(C[k]=!0,g.push(k),S[k]=b(N,a[R]))}}for(var M=g.length,D=0;D<M;D++){var _=g[D];p[D]=S[_]}return v[1]=g.length,e.createSparseMatrix({values:p,index:g,ptr:v,size:[f,1],datatype:c===e._datatype&&h===n._datatype?u:void 0})}}),h=t("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":function(e,n){var o,a=e._data,s=e._size,l=e._datatype||e.getDataType(),c=n._data,u=n._size,d=n._datatype||n.getDataType(),h=s[0],f=s[1],m=u[1],p=r,g=i;l&&d&&l===d&&"string"===typeof l&&"mixed"!==l&&"mixed"!==l&&(o=l,p=t.find(r,[o,o]),g=t.find(i,[o,o]));for(var v=[],y=0;y<h;y++){var b=a[y];v[y]=[];for(var w=0;w<m;w++){for(var x=g(b[0],c[0][w]),S=1;S<f;S++)x=p(x,g(b[S],c[S][w]));v[y][w]=x}}return e.createDenseMatrix({data:v,size:[h,m],datatype:l===e._datatype&&d===n._datatype?o:void 0})},"DenseMatrix, SparseMatrix":function(e,n){var a=e._data,s=e._size,l=e._datatype||e.getDataType(),c=n._values,u=n._index,d=n._ptr,h=n._size,f=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(!c)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var m,p=s[0],g=h[1],v=r,y=i,b=o,w=0;l&&f&&l===f&&"string"===typeof l&&"mixed"!==l&&(m=l,v=t.find(r,[m,m]),y=t.find(i,[m,m]),b=t.find(o,[m,m]),w=t.convert(0,m));for(var x=[],S=[],C=[],E=n.createSparseMatrix({values:x,index:S,ptr:C,size:[p,g],datatype:l===e._datatype&&f===n._datatype?m:void 0}),N=0;N<g;N++){C[N]=S.length;var T=d[N],A=d[N+1];if(A>T)for(var R=0,k=0;k<p;k++){for(var M=k+1,D=void 0,_=T;_<A;_++){var O=u[_];R!==M?(D=y(a[k][O],c[_]),R=M):D=v(D,y(a[k][O],c[_]))}R!==M||b(D,w)||(S.push(k),x.push(D))}}return C[g]=S.length,E},"SparseMatrix, DenseMatrix":function(e,n){var a=e._values,s=e._index,l=e._ptr,c=e._datatype||void 0===e._data?e._datatype:e.getDataType();if(!a)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var u,d=n._data,h=n._datatype||n.getDataType(),f=e._size[0],m=n._size[0],p=n._size[1],g=r,v=i,y=o,b=0;c&&h&&c===h&&"string"===typeof c&&"mixed"!==c&&(u=c,g=t.find(r,[u,u]),v=t.find(i,[u,u]),y=t.find(o,[u,u]),b=t.convert(0,u));for(var w=[],x=[],S=[],C=e.createSparseMatrix({values:w,index:x,ptr:S,size:[f,p],datatype:c===e._datatype&&h===n._datatype?u:void 0}),E=[],N=[],T=0;T<p;T++){S[T]=x.length;for(var A=T+1,R=0;R<m;R++){var k=d[R][T];if(!y(k,b))for(var M=l[R],D=l[R+1],_=M;_<D;_++){var O=s[_];N[O]!==A?(N[O]=A,x.push(O),E[O]=v(k,a[_])):E[O]=g(E[O],v(k,a[_]))}}for(var I=S[T],P=x.length,j=I;j<P;j++){var F=x[j];w[j]=E[F]}}return S[p]=x.length,C},"SparseMatrix, SparseMatrix":function(e,n){var o,a=e._values,s=e._index,l=e._ptr,c=e._datatype||void 0===e._data?e._datatype:e.getDataType(),u=n._values,d=n._index,h=n._ptr,f=n._datatype||void 0===n._data?n._datatype:n.getDataType(),m=e._size[0],p=n._size[1],g=a&&u,v=r,y=i;c&&f&&c===f&&"string"===typeof c&&"mixed"!==c&&(o=c,v=t.find(r,[o,o]),y=t.find(i,[o,o]));for(var b,w,x,S,C,E,N,T,A=g?[]:void 0,R=[],k=[],M=e.createSparseMatrix({values:A,index:R,ptr:k,size:[m,p],datatype:c===e._datatype&&f===n._datatype?o:void 0}),D=g?[]:void 0,_=[],O=0;O<p;O++){k[O]=R.length;var I=O+1;for(C=h[O],E=h[O+1],S=C;S<E;S++)if(T=d[S],g)for(w=l[T],x=l[T+1],b=w;b<x;b++)_[N=s[b]]!==I?(_[N]=I,R.push(N),D[N]=y(u[S],a[b])):D[N]=v(D[N],y(u[S],a[b]));else for(w=l[T],x=l[T+1],b=w;b<x;b++)_[N=s[b]]!==I&&(_[N]=I,R.push(N));if(g)for(var P=k[O],j=R.length,F=P;F<j;F++){var H=R[F];A[F]=D[H]}}return k[p]=R.length,M}});return t(rN,i,{"Array, Array":t.referTo("Matrix, Matrix",e=>(t,r)=>{c(sf(t),sf(r));var i=e(n(t),n(r));return Pd(i)?i.valueOf():i}),"Matrix, Matrix":function(e,t){var n=e.size(),r=t.size();return c(n,r),1===n.length?1===r.length?function(e,t,n){if(0===n)throw new Error("Cannot multiply two empty vectors");return a(e,t)}(e,t,n[0]):u(e,t):1===r.length?d(e,t):h(e,t)},"Matrix, Array":t.referTo("Matrix,Matrix",e=>(t,r)=>e(t,n(r))),"Array, Matrix":t.referToSelf(e=>(t,r)=>e(n(t,r.storage()),r)),"SparseMatrix, any":function(e,t){return s(e,t,i,!1)},"DenseMatrix, any":function(e,t){return l(e,t,i,!1)},"any, SparseMatrix":function(e,t){return s(t,e,i,!0)},"any, DenseMatrix":function(e,t){return l(t,e,i,!0)},"Array, any":function(e,t){return l(n(e),t,i,!1).valueOf()},"any, Array":function(e,t){return l(n(t),e,i,!0).valueOf()},"any, any":i,"any, any, ...any":t.referToSelf(e=>(t,n,r)=>{for(var i=e(t,n),o=0;o<r.length;o++)i=e(i,r[o]);return i})})}),oN=vh("ones",["typed","config","matrix","BigNumber"],e=>{var{typed:t,config:n,matrix:r,BigNumber:i}=e;return t("ones",{"":function(){return"Array"===n.matrix?o([]):o([],"default")},"...number | BigNumber | string":function(e){if("string"===typeof e[e.length-1]){var t=e.pop();return o(e,t)}return"Array"===n.matrix?o(e):o(e,"default")},Array:o,Matrix:function(e){var t=e.storage();return o(e.valueOf(),t)},"Array | Matrix, string":function(e,t){return o(e.valueOf(),t)}});function o(e,t){var n=function(e){var t=!1;return e.forEach(function(e,n,r){Rd(e)&&(t=!0,r[n]=e.toNumber())}),t}(e),o=n?new i(1):1;if(function(e){e.forEach(function(e){if("number"!==typeof e||!wh(e)||e<0)throw new Error("Parameters in function ones must be positive integers")})}(e),t){var a=r(t);return e.length>0?a.resize(e,o):a}var s=[];return e.length>0?ff(s,e,o):s}}),aN="randomInt",sN=vh(aN,["typed","config","log2","?on"],e=>{var{typed:t,config:n,log2:r,on:i}=e,o=sE(n.randomSeed);return i&&i("config",function(e,t){e.randomSeed!==t.randomSeed&&(o=sE(e.randomSeed))}),t(aN,{"":()=>s(0,2),number:e=>s(0,e),"number, number":(e,t)=>s(e,t),bigint:e=>l(0n,e),"bigint, bigint":l,"Array | Matrix":e=>a(e,0,1),"Array | Matrix, number":(e,t)=>a(e,0,t),"Array | Matrix, number, number":(e,t,n)=>a(e,t,n)});function a(e,t,n){var r=uE(e.valueOf(),()=>s(t,n));return Pd(e)?e.create(r,"number"):r}function s(e,t){return Math.floor(e+o()*(t-e))}function l(e,t){var n=t-e;if(n<=2n**30n)return e+BigInt(s(0,Number(n)));for(var i=r(n),a=n;a>=n;){a=0n;for(var l=0;l<i;++l)a=2n*a+(o()<.5?0n:1n)}return e+a}}),lN="reshape",cN=vh(lN,["typed","isInteger","matrix"],e=>{var{typed:t,isInteger:n}=e;return t(lN,{"Matrix, Array":function(e,t){return e.reshape(t,!0)},"Array, Array":function(e,t){return t.forEach(function(e){if(!n(e))throw new TypeError("Invalid size for dimension: "+e)}),pf(e,t)}})}),uN="sech",dN=vh(uN,["typed","BigNumber"],e=>{var{typed:t,BigNumber:n}=e;return t(uN,{number:NS,Complex:e=>e.sech(),BigNumber:e=>new n(1).div(e.cosh())})}),hN="sinh",fN=vh(hN,["typed"],e=>{var{typed:t}=e;return t(hN,{number:TS,"Complex | BigNumber":e=>e.sinh()})}),mN="sparse",pN=vh(mN,["typed","SparseMatrix"],e=>{var{typed:t,SparseMatrix:n}=e;return t(mN,{"":function(){return new n([])},string:function(e){return new n([],e)},"Array | Matrix":function(e){return new n(e)},"Array | Matrix, string":function(e,t){return new n(e,t)}})}),gN=vh("sqrt",["config","typed","Complex"],e=>{var{config:t,typed:n,Complex:r}=e;return n("sqrt",{number:i,Complex:function(e){return e.sqrt()},BigNumber:function(e){return!e.isNegative()||t.predictable?e.sqrt():i(e.toNumber())},Unit:function(e){return e.pow(.5)}});function i(e){return isNaN(e)?NaN:e>=0||t.predictable?Math.sqrt(e):new r(e,0).sqrt()}}),vN="squeeze",yN=vh(vN,["typed"],e=>{var{typed:t}=e;return t(vN,{Array:function(e){return yf(hd(e))},Matrix:function(e){var t=yf(e.toArray());return Array.isArray(t)?e.create(t,e.datatype()):t},any:function(e){return hd(e)}})}),bN=vh("tanh",["typed"],e=>{var{typed:t}=e;return t("tanh",{number:Wh,"Complex | BigNumber":e=>e.tanh()})}),wN="transpose",xN=vh(wN,["typed","matrix"],e=>{var{typed:t,matrix:n}=e;return t(wN,{Array:e=>r(n(e)).valueOf(),Matrix:r,any:hd});function r(e){var t,n=e.size();switch(n.length){case 1:t=e.clone();break;case 2:var r=n[0],i=n[1];if(0===i)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+Xh(n)+")");switch(e.storage()){case"dense":t=function(e,t,n){for(var r,i=e._data,o=[],a=0;a<n;a++){r=o[a]=[];for(var s=0;s<t;s++)r[s]=hd(i[s][a])}return e.createDenseMatrix({data:o,size:[n,t],datatype:e._datatype})}(e,r,i);break;case"sparse":t=function(e,t,n){for(var r,i,o,a=e._values,s=e._index,l=e._ptr,c=a?[]:void 0,u=[],d=[],h=[],f=0;f<t;f++)h[f]=0;for(r=0,i=s.length;r<i;r++)h[s[r]]++;for(var m=0,p=0;p<t;p++)d.push(m),m+=h[p],h[p]=d[p];for(d.push(m),o=0;o<n;o++)for(var g=l[o],v=l[o+1],y=g;y<v;y++){var b=h[s[y]]++;u[b]=o,a&&(c[b]=hd(a[y]))}return e.createSparseMatrix({values:c,index:u,ptr:d,size:[n,t],datatype:e._datatype})}(e,r,i)}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+Xh(n)+")")}return t}}),SN="xgcd",CN=vh(SN,["typed","config","matrix","BigNumber"],e=>{var{typed:t,config:n,matrix:r,BigNumber:i}=e;return t(SN,{"number, number":function(e,t){var i=iS(e,t);return"Array"===n.matrix?i:r(i)},"BigNumber, BigNumber":function(e,t){var o,a,s,l,c=new i(0),u=new i(1),d=c,h=u,f=u,m=c;if(!e.isInt()||!t.isInt())throw new Error("Parameters in function xgcd must be integer numbers");for(;!t.isZero();)a=e.div(t).floor(),s=e.mod(t),o=d,d=h.minus(a.times(d)),h=o,o=f,f=m.minus(a.times(f)),m=o,e=t,t=s;l=e.lt(c)?[e.neg(),h.neg(),m.neg()]:[e,e.isZero()?0:h,m];return"Array"===n.matrix?l:r(l)}})}),EN="zeros",NN=vh(EN,["typed","config","matrix","BigNumber"],e=>{var{typed:t,config:n,matrix:r,BigNumber:i}=e;return t(EN,{"":function(){return"Array"===n.matrix?o([]):o([],"default")},"...number | BigNumber | string":function(e){if("string"===typeof e[e.length-1]){var t=e.pop();return o(e,t)}return"Array"===n.matrix?o(e):o(e,"default")},Array:o,Matrix:function(e){var t=e.storage();return o(e.valueOf(),t)},"Array | Matrix, string":function(e,t){return o(e.valueOf(),t)}});function o(e,t){var n=function(e){var t=!1;return e.forEach(function(e,n,r){Rd(e)&&(t=!0,r[n]=e.toNumber())}),t}(e),o=n?new i(0):0;if(function(e){e.forEach(function(e){if("number"!==typeof e||!wh(e)||e<0)throw new Error("Parameters in function zeros must be positive integers")})}(e),t){var a=r(t);return e.length>0?a.resize(e,o):a}var s=[];return e.length>0?ff(s,e,o):s}}),TN="acoth",AN=vh(TN,["typed","config","Complex","BigNumber"],e=>{var{typed:t,config:n,Complex:r,BigNumber:i}=e;return t(TN,{number:function(e){return e>=1||e<=-1||n.predictable?fS(e):new r(e,0).acoth()},Complex:function(e){return e.acoth()},BigNumber:function(e){return new i(1).div(e).atanh()}})}),RN="asin",kN=vh(RN,["typed","config","Complex"],e=>{var{typed:t,config:n,Complex:r}=e;return t(RN,{number:function(e){return e>=-1&&e<=1||n.predictable?Math.asin(e):new r(e,0).asin()},Complex:function(e){return e.asin()},BigNumber:function(e){return e.asin()}})}),MN=vh("bin",["typed","format"],e=>{var{typed:t,format:n}=e;return t("bin",{"number | BigNumber":function(e){return n(e,{notation:"bin"})},"number | BigNumber, number | BigNumber":function(e,t){return n(e,{notation:"bin",wordSize:t})}})}),DN="coth",_N=vh(DN,["typed","BigNumber"],e=>{var{typed:t,BigNumber:n}=e;return t(DN,{number:xS,Complex:e=>e.coth(),BigNumber:e=>new n(1).div(e.tanh())})}),ON="ctranspose",IN=vh(ON,["typed","transpose","conj"],e=>{var{typed:t,transpose:n,conj:r}=e;return t(ON,{any:function(e){return r(n(e))}})}),PN="diag",jN=vh(PN,["typed","matrix","DenseMatrix","SparseMatrix"],e=>{var{typed:t,matrix:n,DenseMatrix:r,SparseMatrix:i}=e;return t(PN,{Array:function(e){return o(e,0,sf(e),null)},"Array, number":function(e,t){return o(e,t,sf(e),null)},"Array, BigNumber":function(e,t){return o(e,t.toNumber(),sf(e),null)},"Array, string":function(e,t){return o(e,0,sf(e),t)},"Array, number, string":function(e,t,n){return o(e,t,sf(e),n)},"Array, BigNumber, string":function(e,t,n){return o(e,t.toNumber(),sf(e),n)},Matrix:function(e){return o(e,0,e.size(),e.storage())},"Matrix, number":function(e,t){return o(e,t,e.size(),e.storage())},"Matrix, BigNumber":function(e,t){return o(e,t.toNumber(),e.size(),e.storage())},"Matrix, string":function(e,t){return o(e,0,e.size(),t)},"Matrix, number, string":function(e,t,n){return o(e,t,e.size(),n)},"Matrix, BigNumber, string":function(e,t,n){return o(e,t.toNumber(),e.size(),n)}});function o(e,t,o,a){if(!wh(t))throw new TypeError("Second parameter in function diag must be an integer");var s=t>0?t:0,l=t<0?-t:0;switch(o.length){case 1:return function(e,t,n,o,a,s){var l=[o+a,o+s];if(n&&"sparse"!==n&&"dense"!==n)throw new TypeError("Unknown matrix type ".concat(n,'"'));var c="sparse"===n?i.diagonal(l,e,t):r.diagonal(l,e,t);return null!==n?c:c.valueOf()}(e,t,a,o[0],l,s);case 2:return function(e,t,r,i,o,a){if(Pd(e)){var s=e.diagonal(t);return null!==r?r!==s.storage()?n(s,r):s:s.valueOf()}for(var l=Math.min(i[0]-o,i[1]-a),c=[],u=0;u<l;u++)c[u]=e[u+o][u+a];return null!==r?n(c):c}(e,t,a,o,l,s)}throw new RangeError("Matrix for function diag must be 2 dimensional")}}),FN=vh("matAlgo09xS0Sf",["typed","equalScalar"],e=>{var{typed:t,equalScalar:n}=e;return function(e,r,i){var o=e._values,a=e._index,s=e._ptr,l=e._size,c=e._datatype||void 0===e._data?e._datatype:e.getDataType(),u=r._values,d=r._index,h=r._ptr,f=r._size,m=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(l.length!==f.length)throw new of(l.length,f.length);if(l[0]!==f[0]||l[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+f+")");var p,g=l[0],v=l[1],y=n,b=0,w=i;"string"===typeof c&&c===m&&"mixed"!==c&&(p=c,y=t.find(n,[p,p]),b=t.convert(0,p),w=t.find(i,[p,p]));var x,S,C,E,N,T=o&&u?[]:void 0,A=[],R=[],k=T?[]:void 0,M=[];for(S=0;S<v;S++){R[S]=A.length;var D=S+1;if(k)for(E=h[S],N=h[S+1],C=E;C<N;C++)M[x=d[C]]=D,k[x]=u[C];for(E=s[S],N=s[S+1],C=E;C<N;C++)if(x=a[C],k){var _=M[x]===D?k[x]:b,O=w(o[C],_);y(O,b)||(A.push(x),T.push(O))}else A.push(x)}return R[v]=A.length,e.createSparseMatrix({values:T,index:A,ptr:R,size:[g,v],datatype:c===e._datatype&&m===r._datatype?p:void 0})}}),HN="dotMultiply",LN=vh(HN,["typed","matrix","equalScalar","multiplyScalar","concat"],e=>{var{typed:t,matrix:n,equalScalar:r,multiplyScalar:i,concat:o}=e,a=ug({typed:t,equalScalar:r}),s=FN({typed:t,equalScalar:r}),l=dg({typed:t,equalScalar:r}),c=ng({typed:t,matrix:n,concat:o});return t(HN,c({elop:i,SS:s,DS:a,Ss:l}))}),BN=vh("matAlgo07xSSf",["typed","SparseMatrix"],e=>{var{typed:t,SparseMatrix:n}=e;return function(e,i,o){var a=e._size,s=e._datatype||void 0===e._data?e._datatype:e.getDataType(),l=i._size,c=i._datatype||void 0===i._data?i._datatype:i.getDataType();if(a.length!==l.length)throw new of(a.length,l.length);if(a[0]!==l[0]||a[1]!==l[1])throw new RangeError("Dimension mismatch. Matrix A ("+a+") must match Matrix B ("+l+")");var u,d=a[0],h=a[1],f=0,m=o;"string"===typeof s&&s===c&&"mixed"!==s&&(u=s,f=t.convert(0,u),m=t.find(o,[u,u]));for(var p=[],g=[],v=new Array(h+1).fill(0),y=[],b=[],w=[],x=[],S=0;S<h;S++){var C=S+1,E=0;r(e,S,w,y,C),r(i,S,x,b,C);for(var N=0;N<d;N++){var T=m(w[N]===C?y[N]:f,x[N]===C?b[N]:f);0!==T&&!1!==T&&(g.push(N),p.push(T),E++)}v[S+1]=v[S]+E}return new n({values:p,index:g,ptr:v,size:[d,h],datatype:s===e._datatype&&c===i._datatype?u:void 0})};function r(e,t,n,r,i){for(var o=e._values,a=e._index,s=e._ptr,l=s[t],c=s[t+1];l<c;l++){var u=a[l];n[u]=i,r[u]=o[l]}}}),zN="equal",WN=vh(zN,["typed","matrix","equalScalar","DenseMatrix","concat","SparseMatrix"],e=>{var{typed:t,matrix:n,equalScalar:r,DenseMatrix:i,concat:o,SparseMatrix:a}=e,s=Xp({typed:t}),l=BN({typed:t,SparseMatrix:a}),c=Qp({typed:t,DenseMatrix:i}),u=ng({typed:t,matrix:n,concat:o});return t(zN,VN({typed:t,equalScalar:r}),u({elop:r,SS:l,DS:s,Ss:c}))}),VN=vh(zN,["typed","equalScalar"],e=>{var{typed:t,equalScalar:n}=e;return t(zN,{"any, any":function(e,t){return null===e?null===t:null===t?null===e:void 0===e?void 0===t:void 0===t?void 0===e:n(e,t)}})}),UN=vh("fraction",["typed","Fraction"],e=>{var{typed:t,Fraction:n}=e;return t("fraction",{number:function(e){if(!isFinite(e)||isNaN(e))throw new Error(e+" cannot be represented as a fraction");return new n(e)},string:function(e){return new n(e)},"number, number":function(e,t){return new n(e,t)},"bigint, bigint":function(e,t){return new n(e,t)},null:function(e){return new n(0)},BigNumber:function(e){return new n(e.toString())},bigint:function(e){return new n(e.toString())},Fraction:function(e){return e},Unit:t.referToSelf(e=>t=>{var n=t.clone();return n.value=e(t.value),n}),Object:function(e){return new n(e)},"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))})}),qN="identity",GN=vh(qN,["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],e=>{var{typed:t,config:n,matrix:r,BigNumber:i,DenseMatrix:o,SparseMatrix:a}=e;return t(qN,{"":function(){return"Matrix"===n.matrix?r([]):[]},string:function(e){return r(e)},"number | BigNumber":function(e){return l(e,e,"Matrix"===n.matrix?"dense":void 0)},"number | BigNumber, string":function(e,t){return l(e,e,t)},"number | BigNumber, number | BigNumber":function(e,t){return l(e,t,"Matrix"===n.matrix?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(e,t,n){return l(e,t,n)},Array:function(e){return s(e)},"Array, string":function(e,t){return s(e,t)},Matrix:function(e){return s(e.valueOf(),e.storage())},"Matrix, string":function(e,t){return s(e.valueOf(),t)}});function s(e,t){switch(e.length){case 0:return t?r(t):[];case 1:return l(e[0],e[0],t);case 2:return l(e[0],e[1],t);default:throw new Error("Vector containing two values expected")}}function l(e,t,n){var r=Rd(e)||Rd(t)?i:null;if(Rd(e)&&(e=e.toNumber()),Rd(t)&&(t=t.toNumber()),!wh(e)||e<1)throw new Error("Parameters in function identity must be positive integers");if(!wh(t)||t<1)throw new Error("Parameters in function identity must be positive integers");var s=r?new i(1):1,l=r?new r(0):0,c=[e,t];if(n){if("sparse"===n)return a.diagonal(c,s,0,l);if("dense"===n)return o.diagonal(c,s,0,l);throw new TypeError('Unknown matrix type "'.concat(n,'"'))}for(var u=ff([],c,l),d=e<t?e:t,h=0;h<d;h++)u[h][h]=s;return u}}),YN="isNumeric",KN=vh(YN,["typed"],e=>{var{typed:t}=e;return t(YN,{"number | BigNumber | bigint | Fraction | boolean":()=>!0,"Complex | Unit | string | null | undefined | Node":()=>!1,"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))})}),$N="kron",XN=vh($N,["typed","matrix","multiplyScalar"],e=>{var{typed:t,matrix:n,multiplyScalar:r}=e;return t($N,{"Matrix, Matrix":function(e,t){return n(i(e.toArray(),t.toArray()))},"Matrix, Array":function(e,t){return n(i(e.toArray(),t))},"Array, Matrix":function(e,t){return n(i(e,t.toArray()))},"Array, Array":i});function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(n<0){var o=sf(e).length,a=sf(t).length;for(n=Math.max(o,a);o++<n;)e=[e];for(;a++<n;)t=[t]}return 1===n?function(e,t){return e.flatMap(e=>t.map(t=>r(e,t)))}(e,t):e.flatMap(e=>t.map(t=>i(e,t,n-1)))}}),QN="largerEq",JN=vh(QN,["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],e=>{var{typed:t,config:n,matrix:r,DenseMatrix:i,concat:o,SparseMatrix:a}=e,s=Xp({typed:t}),l=BN({typed:t,SparseMatrix:a}),c=Qp({typed:t,DenseMatrix:i}),u=ng({typed:t,matrix:r,concat:o}),d=lC({typed:t});return t(QN,ZN({typed:t,config:n}),{"boolean, boolean":(e,t)=>e>=t,"BigNumber, BigNumber":function(e,t){return e.gte(t)||sC(e,t,n.relTol,n.absTol)},"bigint, bigint":function(e,t){return e>=t},"Fraction, Fraction":(e,t)=>-1!==e.compare(t),"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},d,u({SS:l,DS:s,Ss:c}))}),ZN=vh(QN,["typed","config"],e=>{var{typed:t,config:n}=e;return t(QN,{"number, number":function(e,t){return e>=t||jh(e,t,n.relTol,n.absTol)}})}),eT=vh("matAlgo08xS0Sid",["typed","equalScalar"],e=>{var{typed:t,equalScalar:n}=e;return function(e,r,i){var o=e._values,a=e._index,s=e._ptr,l=e._size,c=e._datatype||void 0===e._data?e._datatype:e.getDataType(),u=r._values,d=r._index,h=r._ptr,f=r._size,m=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(l.length!==f.length)throw new of(l.length,f.length);if(l[0]!==f[0]||l[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+f+")");if(!o||!u)throw new Error("Cannot perform operation on Pattern Sparse Matrices");var p,g=l[0],v=l[1],y=n,b=0,w=i;"string"===typeof c&&c===m&&"mixed"!==c&&(p=c,y=t.find(n,[p,p]),b=t.convert(0,p),w=t.find(i,[p,p]));for(var x,S,C,E,N=[],T=[],A=[],R=[],k=[],M=0;M<v;M++){A[M]=T.length;var D=M+1;for(S=s[M],C=s[M+1],x=S;x<C;x++)k[E=a[x]]=D,R[E]=o[x],T.push(E);for(S=h[M],C=h[M+1],x=S;x<C;x++)k[E=d[x]]===D&&(R[E]=w(R[E],u[x]));for(x=A[M];x<T.length;){var _=R[E=T[x]];y(_,b)?T.splice(x,1):(N.push(_),x++)}}return A[v]=T.length,e.createSparseMatrix({values:N,index:T,ptr:A,size:[g,v],datatype:c===e._datatype&&m===r._datatype?p:void 0})}}),tT=vh("useMatrixForArrayScalar",["typed","matrix"],e=>{var{typed:t,matrix:n}=e;return{"Array, number":t.referTo("DenseMatrix, number",e=>(t,r)=>e(n(t),r).valueOf()),"Array, BigNumber":t.referTo("DenseMatrix, BigNumber",e=>(t,r)=>e(n(t),r).valueOf()),"number, Array":t.referTo("number, DenseMatrix",e=>(t,r)=>e(t,n(r)).valueOf()),"BigNumber, Array":t.referTo("BigNumber, DenseMatrix",e=>(t,r)=>e(t,n(r)).valueOf())}}),nT="leftShift",rT=vh(nT,["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],e=>{var{typed:t,matrix:n,equalScalar:r,zeros:i,DenseMatrix:o,concat:a}=e,s=dv({typed:t}),l=ug({typed:t,equalScalar:r}),c=eT({typed:t,equalScalar:r}),u=cv({typed:t,DenseMatrix:o}),d=dg({typed:t,equalScalar:r}),h=eg({typed:t}),f=ng({typed:t,matrix:n,concat:a}),m=tT({typed:t,matrix:n});return t(nT,{"number, number":Vg,"BigNumber, BigNumber":jg,"bigint, bigint":(e,t)=>e<<t,"SparseMatrix, number | BigNumber":t.referToSelf(e=>(t,n)=>r(n,0)?t.clone():d(t,n,e,!1)),"DenseMatrix, number | BigNumber":t.referToSelf(e=>(t,n)=>r(n,0)?t.clone():h(t,n,e,!1)),"number | BigNumber, SparseMatrix":t.referToSelf(e=>(t,n)=>r(t,0)?i(n.size(),n.storage()):u(n,t,e,!0)),"number | BigNumber, DenseMatrix":t.referToSelf(e=>(t,n)=>r(t,0)?i(n.size(),n.storage()):h(n,t,e,!0))},m,f({SS:c,DS:s,SD:l}))}),iT="matrixFromRows",oT=vh(iT,["typed","matrix","flatten","size"],e=>{var{typed:t,matrix:n,flatten:r,size:i}=e;return t(iT,{"...Array":function(e){return o(e)},"...Matrix":function(e){return n(o(e.map(e=>e.toArray())))}});function o(e){if(0===e.length)throw new TypeError("At least one row is needed to construct a matrix.");var t=a(e[0]),n=[];for(var i of e){var o=a(i);if(o!==t)throw new TypeError("The vectors had different length: "+(0|t)+" \u2260 "+(0|o));n.push(r(i))}return n}function a(e){var t=i(e);if(1===t.length)return t[0];if(2===t.length){if(1===t[0])return t[1];if(1===t[1])return t[0];throw new TypeError("At least one of the arguments is not a vector.")}throw new TypeError("Only one- or two-dimensional vectors are supported.")}}),aT="mode",sT=vh(aT,["typed","isNaN","isNumeric"],e=>{var{typed:t,isNaN:n,isNumeric:r}=e;return t(aT,{"Array | Matrix":i,"...":function(e){return i(e)}});function i(e){if(0===(e=Sf(e.valueOf())).length)throw new Error("Cannot calculate mode of an empty array");for(var t={},i=[],o=0,a=0;a<e.length;a++){var s=e[a];if(r(s)&&n(s))throw new Error("Cannot calculate mode of an array containing NaN values");s in t||(t[s]=0),t[s]++,t[s]===o?i.push(s):t[s]>o&&(o=t[s],i=[s])}return i}}),lT="nthRoot",cT=vh(lT,["typed","matrix","equalScalar","BigNumber","concat"],e=>{var{typed:t,matrix:n,equalScalar:r,BigNumber:i,concat:o}=e,a=dv({typed:t}),s=ug({typed:t,equalScalar:r}),l=hg({typed:t,equalScalar:r}),c=dg({typed:t,equalScalar:r}),u=ng({typed:t,matrix:n,concat:o});function d(){throw new Error("Complex number not supported in function nthRoot. Use nthRoots instead.")}return t(lT,{number:tS,"number, number":tS,BigNumber:e=>h(e,new i(2)),"BigNumber, BigNumber":h,Complex:d,"Complex, number":d,Array:t.referTo("DenseMatrix,number",e=>t=>e(n(t),2).valueOf()),DenseMatrix:t.referTo("DenseMatrix,number",e=>t=>e(t,2)),SparseMatrix:t.referTo("SparseMatrix,number",e=>t=>e(t,2)),"SparseMatrix, SparseMatrix":t.referToSelf(e=>(t,n)=>{if(1===n.density())return l(t,n,e);throw new Error("Root must be non-zero")}),"DenseMatrix, SparseMatrix":t.referToSelf(e=>(t,n)=>{if(1===n.density())return a(t,n,e,!1);throw new Error("Root must be non-zero")}),"Array, SparseMatrix":t.referTo("DenseMatrix,SparseMatrix",e=>(t,r)=>e(n(t),r)),"number | BigNumber, SparseMatrix":t.referToSelf(e=>(t,n)=>{if(1===n.density())return c(n,t,e,!0);throw new Error("Root must be non-zero")})},u({scalar:"number | BigNumber",SD:s,Ss:c,sS:!1}));function h(e,t){var n=i.precision,r=i.clone({precision:n+2}),o=new i(0),a=new r(1),s=t.isNegative();if(s&&(t=t.neg()),t.isZero())throw new Error("Root must be non-zero");if(e.isNegative()&&!t.abs().mod(2).equals(1))throw new Error("Root must be odd when a is negative.");if(e.isZero())return s?new r(1/0):0;if(!e.isFinite())return s?o:e;var l=e.abs().pow(a.div(t));return l=e.isNeg()?l.neg():l,new i((s?a.div(l):l).toPrecision(n))}}),uT=vh("numeric",["number","?bignumber","?fraction"],e=>{var{number:t,bignumber:n,fraction:r}=e,i={string:!0,number:!0,BigNumber:!0,Fraction:!0},o={number:e=>t(e),BigNumber:n?e=>n(e):qm,bigint:e=>BigInt(e),Fraction:r?e=>r(e):Gm};return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"number";if(void 0!==(arguments.length>2?arguments[2]:void 0))throw new SyntaxError("numeric() takes one or two arguments");var n=ph(e);if(!(n in i))throw new TypeError("Cannot convert "+e+' of type "'+n+'"; valid input types are '+Object.keys(i).join(", "));if(!(t in o))throw new TypeError("Cannot convert "+e+' to type "'+t+'"; valid output types are '+Object.keys(o).join(", "));return t===n?e:o[t](e)}}),dT="prod",hT=vh(dT,["typed","config","multiplyScalar","numeric"],e=>{var{typed:t,config:n,multiplyScalar:r,numeric:i}=e;return t(dT,{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(e,t){throw new Error("prod(A, dim) is not yet supported")},"...":function(e){return o(e)}});function o(e){var t;if(Im(e,function(e){try{t=void 0===t?e:r(t,e)}catch(n){throw yg(n,"prod",e)}}),"string"===typeof t&&(t=i(t,xh(t,n))),void 0===t)throw new Error("Cannot calculate prod of an empty array");return t}});function fT(e,t,n,r){if(!(this instanceof fT))throw new SyntaxError("Constructor must be called with the new operator");this.fn=e,this.count=t,this.min=n,this.max=r,this.message="Wrong number of arguments in function "+e+" ("+t+" provided, "+n+(void 0!==r&&null!==r?"-"+r:"")+" expected)",this.stack=(new Error).stack}fT.prototype=new Error,fT.prototype.constructor=Error,fT.prototype.name="ArgumentsError",fT.prototype.isArgumentsError=!0;var mT=vh("resize",["config","matrix"],e=>{var{config:t,matrix:n}=e;return function(e,r,i){if(2!==arguments.length&&3!==arguments.length)throw new fT("resize",arguments.length,2,3);if(Pd(r)&&(r=r.valueOf()),Rd(r[0])&&(r=r.map(function(e){return Rd(e)?e.toNumber():e})),Pd(e))return e.resize(r,i,!0);if("string"===typeof e)return function(e,t,n){if(void 0!==n){if("string"!==typeof n||1!==n.length)throw new TypeError("Single character expected as defaultValue")}else n=" ";if(1!==t.length)throw new of(t.length,1);var r=t[0];if("number"!==typeof r||!wh(r))throw new TypeError("Invalid size, must contain positive integers (size: "+Xh(t)+")");if(e.length>r)return e.substring(0,r);if(e.length<r){for(var i=e,o=0,a=r-e.length;o<a;o++)i+=n;return i}return e}(e,r,i);var o=!Array.isArray(e)&&"Array"!==t.matrix;if(0===r.length){for(;Array.isArray(e);)e=e[0];return hd(e)}Array.isArray(e)||(e=[e]);var a=ff(e=hd(e),r,i);return o?n(a):a}}),pT="rightArithShift",gT=vh(pT,["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],e=>{var{typed:t,matrix:n,equalScalar:r,zeros:i,DenseMatrix:o,concat:a}=e,s=dv({typed:t}),l=ug({typed:t,equalScalar:r}),c=eT({typed:t,equalScalar:r}),u=cv({typed:t,DenseMatrix:o}),d=dg({typed:t,equalScalar:r}),h=eg({typed:t}),f=ng({typed:t,matrix:n,concat:a}),m=tT({typed:t,matrix:n});return t(pT,{"number, number":Ug,"BigNumber, BigNumber":Fg,"bigint, bigint":(e,t)=>e>>t,"SparseMatrix, number | BigNumber":t.referToSelf(e=>(t,n)=>r(n,0)?t.clone():d(t,n,e,!1)),"DenseMatrix, number | BigNumber":t.referToSelf(e=>(t,n)=>r(n,0)?t.clone():h(t,n,e,!1)),"number | BigNumber, SparseMatrix":t.referToSelf(e=>(t,n)=>r(t,0)?i(n.size(),n.storage()):u(n,t,e,!0)),"number | BigNumber, DenseMatrix":t.referToSelf(e=>(t,n)=>r(t,0)?i(n.size(),n.storage()):h(n,t,e,!0))},m,f({SS:c,DS:s,SD:l}))}),vT="Number of decimals in function round must be an integer",yT="round",bT=vh(yT,["typed","config","matrix","equalScalar","zeros","BigNumber","DenseMatrix"],e=>{var{typed:t,config:n,matrix:r,equalScalar:i,zeros:o,BigNumber:a,DenseMatrix:s}=e,l=dg({typed:t,equalScalar:i}),c=Qp({typed:t,DenseMatrix:s}),u=eg({typed:t});function d(e){return Math.abs(Dh(e).exponent)}return t(yT,{number:function(e){var t=aS(e,d(n.relTol));return aS(jh(e,t,n.relTol,n.absTol)?t:e)},"number, number":function(e,t){var r=d(n.relTol);if(t>=r)return aS(e,t);var i=aS(e,r);return aS(jh(e,i,n.relTol,n.absTol)?i:e,t)},"number, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(vT);return new a(e).toDecimalPlaces(t.toNumber())},Complex:function(e){return e.round()},"Complex, number":function(e,t){if(t%1)throw new TypeError(vT);return e.round(t)},"Complex, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(vT);var n=t.toNumber();return e.round(n)},BigNumber:function(e){var t=new a(e).toDecimalPlaces(d(n.relTol));return(sC(e,t,n.relTol,n.absTol)?t:e).toDecimalPlaces(0)},"BigNumber, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(vT);var r=d(n.relTol);if(t>=r)return e.toDecimalPlaces(t.toNumber());var i=e.toDecimalPlaces(r);return(sC(e,i,n.relTol,n.absTol)?i:e).toDecimalPlaces(t.toNumber())},bigint:e=>e,"bigint, number":(e,t)=>e,"bigint, BigNumber":(e,t)=>e,Fraction:function(e){return e.round()},"Fraction, number":function(e,t){if(t%1)throw new TypeError(vT);return e.round(t)},"Fraction, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(vT);return e.round(t.toNumber())},"Unit, number, Unit":t.referToSelf(e=>function(t,n,r){var i=t.toNumeric(r);return r.multiply(e(i,n))}),"Unit, BigNumber, Unit":t.referToSelf(e=>(t,n,r)=>e(t,n.toNumber(),r)),"Array | Matrix, number | BigNumber, Unit":t.referToSelf(e=>(t,n,r)=>Pm(t,t=>e(t,n,r),!0)),"Array | Matrix | Unit, Unit":t.referToSelf(e=>(t,n)=>e(t,0,n)),"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e,!0)),"SparseMatrix, number | BigNumber":t.referToSelf(e=>(t,n)=>l(t,n,e,!1)),"DenseMatrix, number | BigNumber":t.referToSelf(e=>(t,n)=>u(t,n,e,!1)),"Array, number | BigNumber":t.referToSelf(e=>(t,n)=>u(r(t),n,e,!1).valueOf()),"number | Complex | BigNumber | Fraction, SparseMatrix":t.referToSelf(e=>(t,n)=>i(t,0)?o(n.size(),n.storage()):c(n,t,e,!0)),"number | Complex | BigNumber | Fraction, DenseMatrix":t.referToSelf(e=>(t,n)=>i(t,0)?o(n.size(),n.storage()):u(n,t,e,!0)),"number | Complex | BigNumber | Fraction, Array":t.referToSelf(e=>(t,n)=>u(r(n),t,e,!0).valueOf())})}),wT="smaller",xT=vh(wT,["typed","config","bignumber","matrix","DenseMatrix","concat","SparseMatrix"],e=>{var{typed:t,config:n,bignumber:r,matrix:i,DenseMatrix:o,concat:a,SparseMatrix:s}=e,l=Xp({typed:t}),c=BN({typed:t,SparseMatrix:s}),u=Qp({typed:t,DenseMatrix:o}),d=ng({typed:t,matrix:i,concat:a}),h=lC({typed:t});function f(e,t){return e.lt(t)&&!sC(e,t,n.relTol,n.absTol)}return t(wT,ST({typed:t,config:n}),{"boolean, boolean":(e,t)=>e<t,"BigNumber, BigNumber":f,"bigint, bigint":(e,t)=>e<t,"Fraction, Fraction":(e,t)=>-1===e.compare(t),"Fraction, BigNumber":function(e,t){return f(r(e),t)},"BigNumber, Fraction":function(e,t){return f(e,r(t))},"Complex, Complex":function(e,t){throw new TypeError("No ordering relation is defined for complex numbers")}},h,d({SS:c,DS:l,Ss:u}))}),ST=vh(wT,["typed","config"],e=>{var{typed:t,config:n}=e;return t(wT,{"number, number":function(e,t){return e<t&&!jh(e,t,n.relTol,n.absTol)}})}),CT=vh("to",["typed","matrix","concat"],e=>{var{typed:t,matrix:n,concat:r}=e;return t("to",{"Unit, Unit | string":(e,t)=>e.to(t)},ng({typed:t,matrix:n,concat:r})({Ds:!0}))}),ET="unaryMinus",NT=vh(ET,["typed"],e=>{var{typed:t}=e;return t(ET,{number:qx,"Complex | BigNumber | Fraction":e=>e.neg(),bigint:e=>-e,Unit:t.referToSelf(e=>n=>{var r=n.clone();return r.value=t.find(e,r.valueType())(n.value),r}),"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e,!0))})}),TT="unequal",AT=vh(TT,["typed","config","equalScalar","matrix","DenseMatrix","concat","SparseMatrix"],e=>{var{typed:t,config:n,equalScalar:r,matrix:i,DenseMatrix:o,concat:a,SparseMatrix:s}=e,l=Xp({typed:t}),c=BN({typed:t,SparseMatrix:s}),u=Qp({typed:t,DenseMatrix:o}),d=ng({typed:t,matrix:i,concat:a});return t(TT,RT({typed:t,equalScalar:r}),d({elop:function(e,t){return!r(e,t)},SS:c,DS:l,Ss:u}))}),RT=vh(TT,["typed","equalScalar"],e=>{var{typed:t,equalScalar:n}=e;return t(TT,{"any, any":function(e,t){return null===e?null!==t:null===t?null!==e:void 0===e?void 0!==t:void 0===t?void 0!==e:!n(e,t)}})}),kT=vh("xor",["typed","matrix","DenseMatrix","concat","SparseMatrix"],e=>{var{typed:t,matrix:n,DenseMatrix:r,concat:i,SparseMatrix:o}=e,a=Xp({typed:t}),s=BN({typed:t,SparseMatrix:o}),l=Qp({typed:t,DenseMatrix:r}),c=ng({typed:t,matrix:n,concat:i});return t("xor",{"number, number":ag,"Complex, Complex":function(e,t){return(0!==e.re||0!==e.im)!==(0!==t.re||0!==t.im)},"bigint, bigint":ag,"BigNumber, BigNumber":function(e,t){return(!e.isZero()&&!e.isNaN())!==(!t.isZero()&&!t.isNaN())},"Unit, Unit":t.referToSelf(e=>(t,n)=>e(t.value||0,n.value||0))},c({SS:s,DS:a,Ss:l}))}),MT=vh("add",["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix","concat"],e=>{var{typed:t,matrix:n,addScalar:r,equalScalar:i,DenseMatrix:o,SparseMatrix:a,concat:s}=e,l=dv({typed:t}),c=uv({typed:t,equalScalar:i}),u=cv({typed:t,DenseMatrix:o}),d=ng({typed:t,matrix:n,concat:s});return t("add",{"any, any":r,"any, any, ...any":t.referToSelf(e=>(t,n,r)=>{for(var i=e(t,n),o=0;o<r.length;o++)i=e(i,r[o]);return i})},d({elop:r,DS:l,SS:c,Ss:u}))}),DT="atan2",_T=vh(DT,["typed","matrix","equalScalar","BigNumber","DenseMatrix","concat"],e=>{var{typed:t,matrix:n,equalScalar:r,BigNumber:i,DenseMatrix:o,concat:a}=e,s=ug({typed:t,equalScalar:r}),l=Xp({typed:t}),c=FN({typed:t,equalScalar:r}),u=dg({typed:t,equalScalar:r}),d=Qp({typed:t,DenseMatrix:o}),h=ng({typed:t,matrix:n,concat:a});return t(DT,{"number, number":Math.atan2,"BigNumber, BigNumber":(e,t)=>i.atan2(e,t)},h({scalar:"number | BigNumber",SS:c,DS:l,SD:s,Ss:u,sS:d}))}),OT="bitXor",IT=vh(OT,["typed","matrix","DenseMatrix","concat","SparseMatrix"],e=>{var{typed:t,matrix:n,DenseMatrix:r,concat:i,SparseMatrix:o}=e,a=Xp({typed:t}),s=BN({typed:t,SparseMatrix:o}),l=Qp({typed:t,DenseMatrix:r}),c=ng({typed:t,matrix:n,concat:i});return t(OT,{"number, number":Wg,"BigNumber, BigNumber":Pg,"bigint, bigint":(e,t)=>e^t},c({SS:s,DS:a,Ss:l}))}),PT="cbrt",jT=vh(PT,["config","typed","isNegative","unaryMinus","matrix","Complex","BigNumber","Fraction"],e=>{var{config:t,typed:n,isNegative:r,unaryMinus:i,matrix:o,Complex:a,BigNumber:s,Fraction:l}=e;return n(PT,{number:Yx,Complex:c,"Complex, boolean":c,BigNumber:function(e){return e.cbrt()},Unit:function(e){if(e.value&&Md(e.value)){var t=e.clone();return t.value=1,(t=t.pow(1/3)).value=c(e.value),t}var n,o=r(e.value);o&&(e.value=i(e.value)),n=Rd(e.value)?new s(1).div(3):Dd(e.value)?new l(1,3):1/3;var a=e.pow(n);return o&&(a.value=i(a.value)),a}});function c(e,n){var r=e.arg()/3,i=e.abs(),s=new a(Yx(i),0).mul(new a(0,r).exp());if(n){var l=[s,new a(Yx(i),0).mul(new a(0,r+2*Math.PI/3).exp()),new a(Yx(i),0).mul(new a(0,r-2*Math.PI/3).exp())];return"Array"===t.matrix?l:o(l)}return s}}),FT="compare",HT=vh(FT,["typed","config","matrix","equalScalar","BigNumber","Fraction","DenseMatrix","concat"],e=>{var{typed:t,config:n,equalScalar:r,matrix:i,BigNumber:o,Fraction:a,DenseMatrix:s,concat:l}=e,c=Xp({typed:t}),u=Jp({typed:t,equalScalar:r}),d=Qp({typed:t,DenseMatrix:s}),h=ng({typed:t,matrix:i,concat:l}),f=lC({typed:t});return t(FT,LT({typed:t,config:n}),{"boolean, boolean":function(e,t){return e===t?0:e>t?1:-1},"BigNumber, BigNumber":function(e,t){return sC(e,t,n.relTol,n.absTol)?new o(0):new o(e.cmp(t))},"bigint, bigint":function(e,t){return e===t?0n:e>t?1n:-1n},"Fraction, Fraction":function(e,t){return new a(e.compare(t))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},f,h({SS:u,DS:c,Ss:d}))}),LT=vh(FT,["typed","config"],e=>{var{typed:t,config:n}=e;return t(FT,{"number, number":function(e,t){return jh(e,t,n.relTol,n.absTol)?0:e>t?1:-1}})}),BT="compareText",zT=["typed","matrix","concat"];tf.signature="any, any";var WT=vh(BT,zT,e=>{var{typed:t,matrix:n,concat:r}=e,i=ng({typed:t,matrix:n,concat:r});return t(BT,tf,i({elop:tf,Ds:!0}))}),VT="count",UT=vh(VT,["typed","size","prod"],e=>{var{typed:t,size:n,prod:r}=e;return t(VT,{string:function(e){return e.length},"Matrix | Array":function(e){return r(n(e))}})}),qT="deepEqual",GT=vh(qT,["typed","equal"],e=>{var{typed:t,equal:n}=e;return t(qT,{"any, any":function(e,t){return r(e.valueOf(),t.valueOf())}});function r(e,t){if(Array.isArray(e)){if(Array.isArray(t)){var i=e.length;if(i!==t.length)return!1;for(var o=0;o<i;o++)if(!r(e[o],t[o]))return!1;return!0}return!1}return!Array.isArray(t)&&n(e,t)}}),YT="divideScalar",KT=vh(YT,["typed","numeric"],e=>{var{typed:t,numeric:n}=e;return t(YT,{"number, number":function(e,t){return e/t},"Complex, Complex":function(e,t){return e.div(t)},"BigNumber, BigNumber":function(e,t){return e.div(t)},"bigint, bigint":function(e,t){return e/t},"Fraction, Fraction":function(e,t){return e.div(t)},"Unit, number | Complex | Fraction | BigNumber | Unit":(e,t)=>e.divide(t),"number | Fraction | Complex | BigNumber, Unit":(e,t)=>t.divideInto(e)})}),$T="equalText",XT=vh($T,["typed","compareText","isZero"],e=>{var{typed:t,compareText:n,isZero:r}=e;return t($T,{"any, any":function(e,t){return r(n(e,t))}})}),QT="floor",JT=["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],ZT=new Nb(10),eA=vh(QT,["typed","config","round"],e=>{var{typed:t,config:n,round:r}=e;function i(e){var t=Math.floor(e),i=r(e);return t===i?t:jh(e,i,n.relTol,n.absTol)&&!jh(e,t,n.relTol,n.absTol)?i:t}return t(QT,{number:i,"number, number":function(e,t){if(!wh(t))throw new RangeError("number of decimals in function floor must be an integer");if(t<0||t>15)throw new RangeError("number of decimals in floor number must be in range 0 - 15");var n=10**t;return i(e*n)/n}})}),tA=vh(QT,JT,e=>{var{typed:t,config:n,round:r,matrix:i,equalScalar:o,zeros:a,DenseMatrix:s}=e,l=dg({typed:t,equalScalar:o}),c=Qp({typed:t,DenseMatrix:s}),u=eg({typed:t}),d=eA({typed:t,config:n,round:r});function h(e){var t=(e,t)=>sC(e,t,n.relTol,n.absTol),i=e.floor(),o=r(e);return i.eq(o)?i:t(e,o)&&!t(e,i)?o:i}return t("floor",{number:d.signatures.number,"number,number":d.signatures["number,number"],Complex:function(e){return e.floor()},"Complex, number":function(e,t){return e.floor(t)},"Complex, BigNumber":function(e,t){return e.floor(t.toNumber())},BigNumber:h,"BigNumber, BigNumber":function(e,t){var n=ZT.pow(t);return h(e.mul(n)).div(n)},bigint:e=>e,"bigint, number":(e,t)=>e,"bigint, BigNumber":(e,t)=>e,Fraction:function(e){return e.floor()},"Fraction, number":function(e,t){return e.floor(t)},"Fraction, BigNumber":function(e,t){return e.floor(t.toNumber())},"Unit, number, Unit":t.referToSelf(e=>function(t,n,r){var i=t.toNumeric(r);return r.multiply(e(i,n))}),"Unit, BigNumber, Unit":t.referToSelf(e=>(t,n,r)=>e(t,n.toNumber(),r)),"Array | Matrix, number | BigNumber, Unit":t.referToSelf(e=>(t,n,r)=>Pm(t,t=>e(t,n,r),!0)),"Array | Matrix | Unit, Unit":t.referToSelf(e=>(t,n)=>e(t,0,n)),"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e,!0)),"Array, number | BigNumber":t.referToSelf(e=>(t,n)=>Pm(t,t=>e(t,n),!0)),"SparseMatrix, number | BigNumber":t.referToSelf(e=>(t,n)=>l(t,n,e,!1)),"DenseMatrix, number | BigNumber":t.referToSelf(e=>(t,n)=>u(t,n,e,!1)),"number | Complex | Fraction | BigNumber, Array":t.referToSelf(e=>(t,n)=>u(i(n),t,e,!0).valueOf()),"number | Complex | Fraction | BigNumber, Matrix":t.referToSelf(e=>(t,n)=>o(t,0)?a(n.size(),n.storage()):"dense"===n.storage()?u(n,t,e,!0):c(n,t,e,!0))})}),nA=vh("mod",["typed","config","round","matrix","equalScalar","zeros","DenseMatrix","concat"],e=>{var{typed:t,config:n,round:r,matrix:i,equalScalar:o,zeros:a,DenseMatrix:s,concat:l}=e,c=tA({typed:t,config:n,round:r,matrix:i,equalScalar:o,zeros:a,DenseMatrix:s}),u=ug({typed:t,equalScalar:o}),d=Xp({typed:t}),h=Jp({typed:t,equalScalar:o}),f=dg({typed:t,equalScalar:o}),m=Qp({typed:t,DenseMatrix:s});return t("mod",{"number, number":function(e,t){return 0===t?e:e-t*c(e/t)},"BigNumber, BigNumber":function(e,t){return t.isZero()?e:e.sub(t.mul(c(e.div(t))))},"bigint, bigint":function(e,t){if(0n===t)return e;if(e<0){var n=e%t;return 0n===n?n:n+t}return e%t},"Fraction, Fraction":function(e,t){return t.equals(0)?e:e.sub(t.mul(c(e.div(t))))}},ng({typed:t,matrix:i,concat:l})({SS:h,DS:d,SD:u,Ss:f,sS:m}))}),rA=["typed","config","round","matrix","equalScalar","zeros","BigNumber","DenseMatrix","concat"],iA="number | BigNumber | Fraction | Matrix | Array",oA="".concat(iA,", ").concat(iA,", ...").concat(iA);function aA(e){return!e.some(e=>Array.isArray(e))}var sA=vh("gcd",rA,e=>{var{typed:t,matrix:n,config:r,round:i,equalScalar:o,zeros:a,BigNumber:s,DenseMatrix:l,concat:c}=e,u=nA({typed:t,config:r,round:i,matrix:n,equalScalar:o,zeros:a,DenseMatrix:l,concat:c}),d=dv({typed:t}),h=uv({typed:t,equalScalar:o}),f=cv({typed:t,DenseMatrix:l});return t("gcd",{"number, number":function(e,t){if(!wh(e)||!wh(t))throw new Error("Parameters in function gcd must be integer numbers");var n;for(;0!==t;)n=u(e,t),e=t,t=n;return e<0?-e:e},"BigNumber, BigNumber":function(e,t){if(!e.isInt()||!t.isInt())throw new Error("Parameters in function gcd must be integer numbers");var n=new s(0);for(;!t.isZero();){var r=u(e,t);e=t,t=r}return e.lt(n)?e.neg():e},"Fraction, Fraction":(e,t)=>e.gcd(t)},ng({typed:t,matrix:n,concat:c})({SS:h,DS:d,Ss:f}),{[oA]:t.referToSelf(e=>(t,n,r)=>{for(var i=e(t,n),o=0;o<r.length;o++)i=e(i,r[o]);return i}),Array:t.referToSelf(e=>t=>{if(1===t.length&&Array.isArray(t[0])&&aA(t[0]))return e(...t[0]);if(aA(t))return e(...t);throw new fT("gcd() supports only 1d matrices!")}),Matrix:t.referToSelf(e=>t=>e(t.toArray()))})}),lA="hasNumericValue",cA=vh(lA,["typed","isNumeric"],e=>{var{typed:t,isNumeric:n}=e;return t(lA,{boolean:()=>!0,string:function(e){return e.trim().length>0&&!isNaN(Number(e))},any:function(e){return n(e)}})}),uA="hypot",dA=vh(uA,["typed","abs","addScalar","divideScalar","multiplyScalar","sqrt","smaller","isPositive"],e=>{var{typed:t,abs:n,addScalar:r,divideScalar:i,multiplyScalar:o,sqrt:a,smaller:s,isPositive:l}=e;return t(uA,{"... number | BigNumber":c,Array:c,Matrix:e=>c(Sf(e.toArray(),!0))});function c(e){for(var t=0,c=0,u=0;u<e.length;u++){if(Md(e[u]))throw new TypeError("Unexpected type of argument to hypot");var d=n(e[u]);s(c,d)?(t=o(t,o(i(c,d),i(c,d))),t=r(t,1),c=d):t=r(t,l(d)?o(i(d,c),i(d,c)):d)}return o(c,a(t))}}),hA=vh("ImmutableDenseMatrix",["smaller","DenseMatrix"],e=>{var{smaller:t,DenseMatrix:n}=e;function r(e,t){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(t&&!Od(t))throw new Error("Invalid datatype: "+t);if(Pd(e)||Id(e)){var i=new n(e,t);this._data=i._data,this._size=i._size,this._datatype=i._datatype,this._min=null,this._max=null}else if(e&&Id(e.data)&&Id(e.size))this._data=e.data,this._size=e.size,this._datatype=e.datatype,this._min="undefined"!==typeof e.min?e.min:null,this._max="undefined"!==typeof e.max?e.max:null;else{if(e)throw new TypeError("Unsupported type of data ("+ph(e)+")");this._data=[],this._size=[0],this._datatype=t,this._min=null,this._max=null}}return r.prototype=new n,r.prototype.type="ImmutableDenseMatrix",r.prototype.isImmutableDenseMatrix=!0,r.prototype.subset=function(e){switch(arguments.length){case 1:var t=n.prototype.subset.call(this,e);return Pd(t)?new r({data:t._data,size:t._size,datatype:t._datatype}):t;case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},r.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},r.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},r.prototype.reshape=function(){throw new Error("Cannot invoke reshape on an Immutable Matrix instance")},r.prototype.clone=function(){return new r({data:hd(this._data),size:hd(this._size),datatype:this._datatype})},r.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},r.fromJSON=function(e){return new r(e)},r.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},r.prototype.min=function(){if(null===this._min){var e=null;this.forEach(function(n){(null===e||t(n,e))&&(e=n)}),this._min=null!==e?e:void 0}return this._min},r.prototype.max=function(){if(null===this._max){var e=null;this.forEach(function(n){(null===e||t(e,n))&&(e=n)}),this._max=null!==e?e:void 0}return this._max},r},{isClass:!0}),fA=vh("Index",["ImmutableDenseMatrix","getMatrixDataType"],e=>{var{ImmutableDenseMatrix:t,getMatrixDataType:n}=e;function r(){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._sourceSize=[],this._isScalar=!0;for(var e=0,t=arguments.length;e<t;e++){var o=e<0||arguments.length<=e?void 0:arguments[e],a=Id(o),s=Pd(o),l=typeof o,c=null;if(Ld(o))this._dimensions.push(o),this._isScalar=!1;else if(a||s){var u=void 0;this._isScalar=!1,"boolean"===n(o)?(a&&(u=i(mA(o).valueOf())),s&&(u=i(mA(o._data).valueOf())),c=o.valueOf().length):u=i(o.valueOf()),this._dimensions.push(u)}else if("number"===l)this._dimensions.push(o);else if("bigint"===l)this._dimensions.push(Number(o));else{if("string"!==l)throw new TypeError("Dimension must be an Array, Matrix, number, bigint, string, or Range");this._dimensions.push(o)}this._sourceSize.push(c)}}function i(e){for(var n=0,r=e.length;n<r;n++)if(!Ad(e[n])||!wh(e[n]))throw new TypeError("Index parameters must be positive integer numbers");var i=new t;return i._data=e,i._size=[e.length],i}return r.prototype.type="Index",r.prototype.isIndex=!0,r.prototype.clone=function(){var e=new r;return e._dimensions=hd(this._dimensions),e._isScalar=this._isScalar,e._sourceSize=this._sourceSize,e},r.create=function(e){var t=new r;return r.apply(t,e),t},r.prototype.size=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];e[t]=Od(r)||Ad(r)?1:r.size()[0]}return e},r.prototype.max=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];e[t]=Od(r)||Ad(r)?r:r.max()}return e},r.prototype.min=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];e[t]=Od(r)||Ad(r)?r:r.min()}return e},r.prototype.forEach=function(e){for(var t=0,n=this._dimensions.length;t<n;t++)e(this._dimensions[t],t,this)},r.prototype.dimension=function(e){var t;return Ad(e)&&null!==(t=this._dimensions[e])&&void 0!==t?t:null},r.prototype.isObjectProperty=function(){return 1===this._dimensions.length&&Od(this._dimensions[0])},r.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},r.prototype.isScalar=function(){return this._isScalar},r.prototype.toArray=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];e.push(Od(r)||Ad(r)?r:r.toArray())}return e},r.prototype.valueOf=r.prototype.toArray,r.prototype.toString=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];Od(r)?e.push(JSON.stringify(r)):e.push(r.toString())}return"["+e.join(", ")+"]"},r.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},r.fromJSON=function(e){return r.create(e.dimensions)},r},{isClass:!0});function mA(e){var t=[];return e.forEach((e,n)=>{e&&t.push(n)}),t}var pA="larger",gA=vh(pA,["typed","config","bignumber","matrix","DenseMatrix","concat","SparseMatrix"],e=>{var{typed:t,config:n,bignumber:r,matrix:i,DenseMatrix:o,concat:a,SparseMatrix:s}=e,l=Xp({typed:t}),c=BN({typed:t,SparseMatrix:s}),u=Qp({typed:t,DenseMatrix:o}),d=ng({typed:t,matrix:i,concat:a}),h=lC({typed:t});function f(e,t){return e.gt(t)&&!sC(e,t,n.relTol,n.absTol)}return t(pA,vA({typed:t,config:n}),{"boolean, boolean":(e,t)=>e>t,"BigNumber, BigNumber":f,"bigint, bigint":(e,t)=>e>t,"Fraction, Fraction":(e,t)=>1===e.compare(t),"Fraction, BigNumber":function(e,t){return f(r(e),t)},"BigNumber, Fraction":function(e,t){return f(e,r(t))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},h,d({SS:c,DS:l,Ss:u}))}),vA=vh(pA,["typed","config"],e=>{var{typed:t,config:n}=e;return t(pA,{"number, number":function(e,t){return e>t&&!jh(e,t,n.relTol,n.absTol)}})}),yA=["config","typed","typeOf","divideScalar","Complex"],bA=Math.log(16),wA=vh("log",yA,e=>{var{typed:t,typeOf:n,config:r,divideScalar:i,Complex:o}=e;function a(e){return e.log()}function s(e){return a(new o(e,0))}return t("log",{number:function(e){return e>=0||r.predictable?Jx(e):s(e)},bigint:KC(bA,Jx,r,s),Complex:a,BigNumber:function(e){return!e.isNegative()||r.predictable?e.ln():s(e.toNumber())},"any, any":t.referToSelf(e=>(t,r)=>{if("Fraction"===n(t)&&"Fraction"===n(r)){var o=t.log(r);if(null!==o)return o}return i(e(t),e(r))})})});function xA(e){var{DenseMatrix:t}=e;return function(e,n,r){var i=e.size();if(2!==i.length)throw new RangeError("Matrix must be two dimensional (size: "+Xh(i)+")");var o=i[0];if(o!==i[1])throw new RangeError("Matrix must be square (size: "+Xh(i)+")");var a=[];if(Pd(n)){var s=n.size(),l=n._data;if(1===s.length){if(s[0]!==o)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var c=0;c<o;c++)a[c]=[l[c]];return new t({data:a,size:[o,1],datatype:n._datatype})}if(2===s.length){if(s[0]!==o||1!==s[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");if(Fd(n)){if(r){a=[];for(var u=0;u<o;u++)a[u]=[l[u][0]];return new t({data:a,size:[o,1],datatype:n._datatype})}return n}if(Hd(n)){for(var d=0;d<o;d++)a[d]=[0];for(var h=n._values,f=n._index,m=n._ptr,p=m[1],g=m[0];g<p;g++){a[f[g]][0]=h[g]}return new t({data:a,size:[o,1],datatype:n._datatype})}}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}if(Id(n)){var v=sf(n);if(1===v.length){if(v[0]!==o)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var y=0;y<o;y++)a[y]=[n[y]];return new t({data:a,size:[o,1]})}if(2===v.length){if(v[0]!==o||1!==v[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var b=0;b<o;b++)a[b]=[n[b][0]];return new t({data:a,size:[o,1]})}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}}}var SA="lsolve",CA=vh(SA,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],e=>{var{typed:t,matrix:n,divideScalar:r,multiplyScalar:i,subtractScalar:o,equalScalar:a,DenseMatrix:s}=e,l=xA({DenseMatrix:s});return t(SA,{"SparseMatrix, Array | Matrix":function(e,t){return function(e,t){for(var n=(t=l(e,t,!0))._data,c=e._size[0],u=e._size[1],d=e._values,h=e._index,f=e._ptr,m=[],p=0;p<u;p++){var g=n[p][0]||0;if(a(g,0))m[p]=[0];else{for(var v=0,y=[],b=[],w=f[p],x=f[p+1],S=w;S<x;S++){var C=h[S];C===p?v=d[S]:C>p&&(y.push(d[S]),b.push(C))}if(a(v,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var E=r(g,v),N=0,T=b.length;N<T;N++){var A=b[N];n[A]=[o(n[A][0]||0,i(E,y[N]))]}m[p]=[E]}}return new s({data:m,size:[c,1]})}(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return c(e,t)},"Array, Array | Matrix":function(e,t){return c(n(e),t).valueOf()}});function c(e,t){for(var n=(t=l(e,t,!0))._data,c=e._size[0],u=e._size[1],d=[],h=e._data,f=0;f<u;f++){var m=n[f][0]||0,p=void 0;if(a(m,0))p=0;else{var g=h[f][f];if(a(g,0))throw new Error("Linear system cannot be solved since matrix is singular");p=r(m,g);for(var v=f+1;v<c;v++)n[v]=[o(n[v][0]||0,i(p,h[v][f]))]}d[f]=[p]}return new s({data:d,size:[c,1]})}}),EA="matrixFromColumns",NA=vh(EA,["typed","matrix","flatten","size"],e=>{var{typed:t,matrix:n,flatten:r,size:i}=e;return t(EA,{"...Array":function(e){return o(e)},"...Matrix":function(e){return n(o(e.map(e=>e.toArray())))}});function o(e){if(0===e.length)throw new TypeError("At least one column is needed to construct a matrix.");for(var t=a(e[0]),n=[],i=0;i<t;i++)n[i]=[];for(var o of e){var s=a(o);if(s!==t)throw new TypeError("The vectors had different length: "+(0|t)+" \u2260 "+(0|s));for(var l=r(o),c=0;c<t;c++)n[c].push(l[c])}return n}function a(e){var t=i(e);if(1===t.length)return t[0];if(2===t.length){if(1===t[0])return t[1];if(1===t[1])return t[0];throw new TypeError("At least one of the arguments is not a vector.")}throw new TypeError("Only one- or two-dimensional vectors are supported.")}}),TA="nthRoots",AA=vh(TA,["config","typed","divideScalar","Complex"],e=>{var{typed:t,config:n,divideScalar:r,Complex:i}=e,o=[function(e){return new i(e,0)},function(e){return new i(0,e)},function(e){return new i(-e,0)},function(e){return new i(0,-e)}];function a(e,t){if(t<0)throw new Error("Root must be greater than zero");if(0===t)throw new Error("Root must be non-zero");if(t%1!==0)throw new Error("Root must be an integer");if(0===e||0===e.abs())return[new i(0,0)];var n,r="number"===typeof e;(r||0===e.re||0===e.im)&&(n=r?2*+(e<0):0===e.im?2*+(e.re<0):2*+(e.im<0)+1);for(var a=e.arg(),s=e.abs(),l=[],c=Math.pow(s,1/t),u=0;u<t;u++){var d=(n+4*u)/t;d!==Math.round(d)?l.push(new i({r:c,phi:(a+2*Math.PI*u)/t})):l.push(o[d%4](c))}return l}return t(TA,{Complex:function(e){return a(e,2)},"Complex, number":a})}),RA="partitionSelect",kA=vh(RA,["typed","isNumeric","isNaN","compare"],e=>{var{typed:t,isNumeric:n,isNaN:r,compare:i}=e,o=i,a=(e,t)=>-i(e,t);return t(RA,{"Array | Matrix, number":function(e,t){return s(e,t,o)},"Array | Matrix, number, string":function(e,t,n){if("asc"===n)return s(e,t,o);if("desc"===n)return s(e,t,a);throw new Error('Compare string must be "asc" or "desc"')},"Array | Matrix, number, function":s});function s(e,t,n){if(!wh(t)||t<0)throw new Error("k must be a non-negative integer");if(Pd(e)){if(e.size().length>1)throw new Error("Only one dimensional matrices supported");return l(e.valueOf(),t,n)}if(Array.isArray(e))return l(e,t,n)}function l(e,t,i){if(t>=e.length)throw new Error("k out of bounds");for(var o=0;o<e.length;o++)if(n(e[o])&&r(e[o]))return e[o];for(var a=0,s=e.length-1;a<s;){for(var l=a,c=s,u=e[Math.floor(Math.random()*(s-a+1))+a];l<c;)if(i(e[l],u)>=0){var d=e[c];e[c]=e[l],e[l]=d,--c}else++l;i(e[l],u)>0&&--l,t<=l?s=l:a=l+1}return e[t]}}),MA=vh("qr",["typed","matrix","zeros","identity","isZero","equal","sign","sqrt","conj","unaryMinus","addScalar","divideScalar","multiplyScalar","subtractScalar","complex"],e=>{var{typed:t,matrix:n,zeros:r,identity:i,isZero:o,equal:a,sign:s,sqrt:l,conj:c,unaryMinus:u,addScalar:d,divideScalar:h,multiplyScalar:f,subtractScalar:m,complex:p}=e;return sd(t("qr",{DenseMatrix:function(e){return v(e)},SparseMatrix:function(e){return function(){throw new Error("qr not implemented for sparse matrices yet")}()},Array:function(e){var t=v(n(e));return{Q:t.Q.valueOf(),R:t.R.valueOf()}}}),{_denseQRimpl:g});function g(e){var t,n,p,g=e._size[0],v=e._size[1],y=i([g],"dense"),b=y._data,w=e.clone(),x=w._data,S=r([g],"");for(p=0;p<Math.min(v,g);++p){var C=x[p][p],E=u(a(C,0)?1:s(C)),N=c(E),T=0;for(t=p;t<g;t++)T=d(T,f(x[t][p],c(x[t][p])));var A=f(E,l(T));if(!o(A)){var R=m(C,A);for(S[p]=1,t=p+1;t<g;t++)S[t]=h(x[t][p],R);var k=u(c(h(R,A))),M=void 0;for(n=p;n<v;n++){for(M=0,t=p;t<g;t++)M=d(M,f(c(S[t]),x[t][n]));for(M=f(M,k),t=p;t<g;t++)x[t][n]=f(m(x[t][n],f(S[t],M)),N)}for(t=0;t<g;t++){for(M=0,n=p;n<g;n++)M=d(M,f(b[t][n],S[n]));for(M=f(M,k),n=p;n<g;++n)b[t][n]=h(m(b[t][n],f(M,c(S[n]))),N)}}}return{Q:y,R:w,toString:function(){return"Q: "+this.Q.toString()+"\nR: "+this.R.toString()}}}function v(e){var t=g(e),n=t.R._data;if(e._data.length>0)for(var r="Complex"===n[0][0].type?p(0):0,i=0;i<n.length;++i)for(var o=0;o<i&&o<(n[0]||[]).length;++o)n[i][o]=r;return t}}),DA="rightLogShift",_A=vh(DA,["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],e=>{var{typed:t,matrix:n,equalScalar:r,zeros:i,DenseMatrix:o,concat:a}=e,s=dv({typed:t}),l=ug({typed:t,equalScalar:r}),c=eT({typed:t,equalScalar:r}),u=cv({typed:t,DenseMatrix:o}),d=dg({typed:t,equalScalar:r}),h=eg({typed:t}),f=ng({typed:t,matrix:n,concat:a}),m=tT({typed:t,matrix:n});return t(DA,{"number, number":qg,"SparseMatrix, number | BigNumber":t.referToSelf(e=>(t,n)=>r(n,0)?t.clone():d(t,n,e,!1)),"DenseMatrix, number | BigNumber":t.referToSelf(e=>(t,n)=>r(n,0)?t.clone():h(t,n,e,!1)),"number | BigNumber, SparseMatrix":t.referToSelf(e=>(t,n)=>r(t,0)?i(n.size(),n.storage()):u(n,t,e,!0)),"number | BigNumber, DenseMatrix":t.referToSelf(e=>(t,n)=>r(t,0)?i(n.size(),n.storage()):h(n,t,e,!0))},m,f({SS:c,DS:s,SD:l}))}),OA="smallerEq",IA=vh(OA,["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],e=>{var{typed:t,config:n,matrix:r,DenseMatrix:i,concat:o,SparseMatrix:a}=e,s=Xp({typed:t}),l=BN({typed:t,SparseMatrix:a}),c=Qp({typed:t,DenseMatrix:i}),u=ng({typed:t,matrix:r,concat:o}),d=lC({typed:t});return t(OA,PA({typed:t,config:n}),{"boolean, boolean":(e,t)=>e<=t,"BigNumber, BigNumber":function(e,t){return e.lte(t)||sC(e,t,n.relTol,n.absTol)},"bigint, bigint":(e,t)=>e<=t,"Fraction, Fraction":(e,t)=>1!==e.compare(t),"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},d,u({SS:l,DS:s,Ss:c}))}),PA=vh(OA,["typed","config"],e=>{var{typed:t,config:n}=e;return t(OA,{"number, number":function(e,t){return e<=t||jh(e,t,n.relTol,n.absTol)}})}),jA="subtract",FA=vh(jA,["typed","matrix","equalScalar","subtractScalar","unaryMinus","DenseMatrix","concat"],e=>{var{typed:t,matrix:n,equalScalar:r,subtractScalar:i,unaryMinus:o,DenseMatrix:a,concat:s}=e,l=dv({typed:t}),c=Xp({typed:t}),u=Jp({typed:t,equalScalar:r}),d=cv({typed:t,DenseMatrix:a}),h=Qp({typed:t,DenseMatrix:a}),f=ng({typed:t,matrix:n,concat:s});return t(jA,{"any, any":i},f({elop:i,SS:u,DS:l,SD:c,Ss:h,sS:d}))}),HA=vh("trace",["typed","matrix","add"],e=>{var{typed:t,matrix:n,add:r}=e;return t("trace",{Array:function(e){return i(n(e))},SparseMatrix:function(e){var t=e._values,n=e._index,i=e._ptr,o=e._size,a=o[0],s=o[1];if(a===s){var l=0;if(t.length>0)for(var c=0;c<s;c++)for(var u=i[c],d=i[c+1],h=u;h<d;h++){var f=n[h];if(f===c){l=r(l,t[h]);break}if(f>c)break}return l}throw new RangeError("Matrix must be square (size: "+Xh(o)+")")},DenseMatrix:i,any:hd});function i(e){var t=e._size,n=e._data;switch(t.length){case 1:if(1===t[0])return hd(n[0]);throw new RangeError("Matrix must be square (size: "+Xh(t)+")");case 2:var i=t[0];if(i===t[1]){for(var o=0,a=0;a<i;a++)o=r(o,n[a][a]);return o}throw new RangeError("Matrix must be square (size: "+Xh(t)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+Xh(t)+")")}}}),LA="usolve",BA=vh(LA,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],e=>{var{typed:t,matrix:n,divideScalar:r,multiplyScalar:i,subtractScalar:o,equalScalar:a,DenseMatrix:s}=e,l=xA({DenseMatrix:s});return t(LA,{"SparseMatrix, Array | Matrix":function(e,t){return function(e,t){for(var n=(t=l(e,t,!0))._data,c=e._size[0],u=e._size[1],d=e._values,h=e._index,f=e._ptr,m=[],p=u-1;p>=0;p--){var g=n[p][0]||0;if(a(g,0))m[p]=[0];else{for(var v=0,y=[],b=[],w=f[p],x=f[p+1]-1;x>=w;x--){var S=h[x];S===p?v=d[x]:S<p&&(y.push(d[x]),b.push(S))}if(a(v,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var C=r(g,v),E=0,N=b.length;E<N;E++){var T=b[E];n[T]=[o(n[T][0],i(C,y[E]))]}m[p]=[C]}}return new s({data:m,size:[c,1]})}(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return c(e,t)},"Array, Array | Matrix":function(e,t){return c(n(e),t).valueOf()}});function c(e,t){for(var n=(t=l(e,t,!0))._data,c=e._size[0],u=e._size[1],d=[],h=e._data,f=u-1;f>=0;f--){var m=n[f][0]||0,p=void 0;if(a(m,0))p=0;else{var g=h[f][f];if(a(g,0))throw new Error("Linear system cannot be solved since matrix is singular");p=r(m,g);for(var v=f-1;v>=0;v--)n[v]=[o(n[v][0]||0,i(p,h[v][f]))]}d[f]=[p]}return new s({data:d,size:[c,1]})}}),zA="zpk2tf",WA=vh(zA,["typed","add","multiply","Complex","number"],e=>{var{typed:t,add:n,multiply:r,Complex:i,number:o}=e;return t(zA,{"Array,Array,number":function(e,t,n){return a(e,t,n)},"Array,Array":function(e,t){return a(e,t,1)},"Matrix,Matrix,number":function(e,t,n){return a(e.valueOf(),t.valueOf(),n)},"Matrix,Matrix":function(e,t){return a(e.valueOf(),t.valueOf(),1)}});function a(e,t,n){e.some(e=>"BigNumber"===e.type)&&(e=e.map(e=>o(e))),t.some(e=>"BigNumber"===e.type)&&(t=t.map(e=>o(e)));for(var a=[i(1,0)],l=[i(1,0)],c=0;c<e.length;c++){var u=e[c];"number"===typeof u&&(u=i(u,0)),a=s(a,[i(1,0),i(-u.re,-u.im)])}for(var d=0;d<t.length;d++){var h=t[d];"number"===typeof h&&(h=i(h,0)),l=s(l,[i(1,0),i(-h.re,-h.im)])}for(var f=0;f<a.length;f++)a[f]=r(a[f],n);return[a,l]}function s(e,t){for(var o=[],a=0;a<e.length+t.length-1;a++){o[a]=i(0,0);for(var s=0;s<e.length;s++)a-s>=0&&a-s<t.length&&(o[a]=n(o[a],r(e[s],t[a-s])))}return o}}),VA="catalan",UA=vh(VA,["typed","addScalar","divideScalar","multiplyScalar","combinations","isNegative","isInteger"],e=>{var{typed:t,addScalar:n,divideScalar:r,multiplyScalar:i,combinations:o,isNegative:a,isInteger:s}=e;return t(VA,{"number | BigNumber":function(e){if(!s(e)||a(e))throw new TypeError("Non-negative integer value expected in function catalan");return r(o(i(e,2),e),n(e,1))}})}),qA=n(5939),GA="compareNatural",YA=vh(GA,["typed","compare"],e=>{var{typed:t,compare:n}=e,r=n.signatures["boolean,boolean"];return t(GA,{"any, any":function e(t,a){var s,l=ph(t),c=ph(a);if(("number"===l||"BigNumber"===l||"Fraction"===l)&&("number"===c||"BigNumber"===c||"Fraction"===c))return"0"!==(s=n(t,a)).toString()?s>0?1:-1:qA(l,c);var u=["Array","DenseMatrix","SparseMatrix"];if(u.includes(l)||u.includes(c))return 0!==(s=i(e,t,a))?s:qA(l,c);if(l!==c)return qA(l,c);if("Complex"===l)return function(e,t){if(e.re>t.re)return 1;if(e.re<t.re)return-1;if(e.im>t.im)return 1;if(e.im<t.im)return-1;return 0}(t,a);if("Unit"===l)return t.equalBase(a)?e(t.value,a.value):o(e,t.formatUnits(),a.formatUnits());if("boolean"===l)return r(t,a);if("string"===l)return qA(t,a);if("Object"===l)return function(e,t,n){var r=Object.keys(t),i=Object.keys(n);r.sort(qA),i.sort(qA);var a=o(e,r,i);if(0!==a)return a;for(var s=0;s<r.length;s++){var l=e(t[r[s]],n[i[s]]);if(0!==l)return l}return 0}(e,t,a);if("null"===l)return 0;if("undefined"===l)return 0;throw new TypeError('Unsupported type of value "'+l+'"')}});function i(e,t,n){return Hd(t)&&Hd(n)?o(e,t.toJSON().values,n.toJSON().values):Hd(t)?i(e,t.toArray(),n):Hd(n)?i(e,t,n.toArray()):Fd(t)?i(e,t.toJSON().data,n):Fd(n)?i(e,t,n.toJSON().data):Array.isArray(t)?Array.isArray(n)?o(e,t,n):i(e,t,[n]):i(e,[t],n)}function o(e,t,n){for(var r=0,i=Math.min(t.length,n.length);r<i;r++){var o=e(t[r],n[r]);if(0!==o)return o}return t.length>n.length?1:t.length<n.length?-1:0}});var KA="composition",$A=vh(KA,["typed","addScalar","combinations","isNegative","isPositive","isInteger","larger"],e=>{var{typed:t,addScalar:n,combinations:r,isPositive:i,isNegative:o,isInteger:a,larger:s}=e;return t(KA,{"number | BigNumber, number | BigNumber":function(e,t){if(!(a(e)&&i(e)&&a(t)&&i(t)))throw new TypeError("Positive integer value expected in function composition");if(s(t,e))throw new TypeError("k must be less than or equal to n in function composition");return r(n(e,-1),n(t,-1))}})}),XA="cross",QA=vh(XA,["typed","matrix","subtract","multiply"],e=>{var{typed:t,matrix:n,subtract:r,multiply:i}=e;return t(XA,{"Matrix, Matrix":function(e,t){return n(o(e.toArray(),t.toArray()))},"Matrix, Array":function(e,t){return n(o(e.toArray(),t))},"Array, Matrix":function(e,t){return n(o(e,t.toArray()))},"Array, Array":o});function o(e,t){var n=Math.max(sf(e).length,sf(t).length);e=yf(e),t=yf(t);var o=sf(e),a=sf(t);if(1!==o.length||1!==a.length||3!==o[0]||3!==a[0])throw new RangeError("Vectors with length 3 expected (Size A = ["+o.join(", ")+"], B = ["+a.join(", ")+"])");var s=[r(i(e[1],t[2]),i(e[2],t[1])),r(i(e[2],t[0]),i(e[0],t[2])),r(i(e[0],t[1]),i(e[1],t[0]))];return n>1?[s]:s}}),JA=vh("det",["typed","matrix","subtractScalar","multiply","divideScalar","isZero","unaryMinus"],e=>{var{typed:t,matrix:n,subtractScalar:r,multiply:i,divideScalar:o,isZero:a,unaryMinus:s}=e;return t("det",{any:function(e){return hd(e)},"Array | Matrix":function(e){var t;switch((t=Pd(e)?e.size():Array.isArray(e)?(e=n(e)).size():[]).length){case 0:return hd(e);case 1:if(1===t[0])return hd(e.valueOf()[0]);if(0===t[0])return 1;throw new RangeError("Matrix must be square (size: "+Xh(t)+")");case 2:var l=t[0],c=t[1];if(l===c)return function(e,t){if(1===t)return hd(e[0][0]);if(2===t)return r(i(e[0][0],e[1][1]),i(e[1][0],e[0][1]));for(var n=!1,l=new Array(t).fill(0).map((e,t)=>t),c=0;c<t;c++){var u=l[c];if(a(e[u][c])){var d=void 0;for(d=c+1;d<t;d++)if(!a(e[l[d]][c])){u=l[d],l[d]=l[c],l[c]=u,n=!n;break}if(d===t)return e[u][c]}for(var h=e[u][c],f=0===c?1:e[l[c-1]][c-1],m=c+1;m<t;m++)for(var p=l[m],g=c+1;g<t;g++)e[p][g]=o(r(i(e[p][g],h),i(e[p][c],e[u][g])),f)}var v=e[l[t-1]][t-1];return n?s(v):v}(e.clone().valueOf(),l);if(0===c)return 1;throw new RangeError("Matrix must be square (size: "+Xh(t)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+Xh(t)+")")}}})}),ZA="distance",eR=vh(ZA,["typed","addScalar","subtractScalar","divideScalar","multiplyScalar","deepEqual","sqrt","abs"],e=>{var{typed:t,addScalar:n,subtractScalar:r,multiplyScalar:i,divideScalar:o,deepEqual:a,sqrt:s,abs:l}=e;return t(ZA,{"Array, Array, Array":function(e,t,n){if(2===e.length&&2===t.length&&2===n.length){if(!u(e))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!u(t))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!u(n))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");if(a(t,n))throw new TypeError("LinePoint1 should not be same with LinePoint2");var o=r(n[1],t[1]),s=r(t[0],n[0]),l=r(i(n[0],t[1]),i(t[0],n[1]));return p(e[0],e[1],o,s,l)}throw new TypeError("Invalid Arguments: Try again")},"Object, Object, Object":function(e,t,n){if(2===Object.keys(e).length&&2===Object.keys(t).length&&2===Object.keys(n).length){if(!u(e))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!u(t))throw new TypeError("Values of lineOnePtX and lineOnePtY should be numbers or BigNumbers");if(!u(n))throw new TypeError("Values of lineTwoPtX and lineTwoPtY should be numbers or BigNumbers");if(a(m(t),m(n)))throw new TypeError("LinePoint1 should not be same with LinePoint2");if("pointX"in e&&"pointY"in e&&"lineOnePtX"in t&&"lineOnePtY"in t&&"lineTwoPtX"in n&&"lineTwoPtY"in n){var o=r(n.lineTwoPtY,t.lineOnePtY),s=r(t.lineOnePtX,n.lineTwoPtX),l=r(i(n.lineTwoPtX,t.lineOnePtY),i(t.lineOnePtX,n.lineTwoPtY));return p(e.pointX,e.pointY,o,s,l)}throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},"Array, Array":function(e,t){if(2===e.length&&3===t.length){if(!u(e))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!d(t))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");return p(e[0],e[1],t[0],t[1],t[2])}if(3===e.length&&6===t.length){if(!d(e))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!f(t))throw new TypeError("Array with 6 numbers or BigNumbers expected for second argument");return g(e[0],e[1],e[2],t[0],t[1],t[2],t[3],t[4],t[5])}if(e.length===t.length&&e.length>0){if(!h(e))throw new TypeError("All values of an array should be numbers or BigNumbers");if(!h(t))throw new TypeError("All values of an array should be numbers or BigNumbers");return v(e,t)}throw new TypeError("Invalid Arguments: Try again")},"Object, Object":function(e,t){if(2===Object.keys(e).length&&3===Object.keys(t).length){if(!u(e))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!d(t))throw new TypeError("Values of xCoeffLine, yCoeffLine and constant should be numbers or BigNumbers");if("pointX"in e&&"pointY"in e&&"xCoeffLine"in t&&"yCoeffLine"in t&&"constant"in t)return p(e.pointX,e.pointY,t.xCoeffLine,t.yCoeffLine,t.constant);throw new TypeError("Key names do not match")}if(3===Object.keys(e).length&&6===Object.keys(t).length){if(!d(e))throw new TypeError("Values of pointX, pointY and pointZ should be numbers or BigNumbers");if(!f(t))throw new TypeError("Values of x0, y0, z0, a, b and c should be numbers or BigNumbers");if("pointX"in e&&"pointY"in e&&"x0"in t&&"y0"in t&&"z0"in t&&"a"in t&&"b"in t&&"c"in t)return g(e.pointX,e.pointY,e.pointZ,t.x0,t.y0,t.z0,t.a,t.b,t.c);throw new TypeError("Key names do not match")}if(2===Object.keys(e).length&&2===Object.keys(t).length){if(!u(e))throw new TypeError("Values of pointOneX and pointOneY should be numbers or BigNumbers");if(!u(t))throw new TypeError("Values of pointTwoX and pointTwoY should be numbers or BigNumbers");if("pointOneX"in e&&"pointOneY"in e&&"pointTwoX"in t&&"pointTwoY"in t)return v([e.pointOneX,e.pointOneY],[t.pointTwoX,t.pointTwoY]);throw new TypeError("Key names do not match")}if(3===Object.keys(e).length&&3===Object.keys(t).length){if(!d(e))throw new TypeError("Values of pointOneX, pointOneY and pointOneZ should be numbers or BigNumbers");if(!d(t))throw new TypeError("Values of pointTwoX, pointTwoY and pointTwoZ should be numbers or BigNumbers");if("pointOneX"in e&&"pointOneY"in e&&"pointOneZ"in e&&"pointTwoX"in t&&"pointTwoY"in t&&"pointTwoZ"in t)return v([e.pointOneX,e.pointOneY,e.pointOneZ],[t.pointTwoX,t.pointTwoY,t.pointTwoZ]);throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},Array:function(e){if(!function(e){if(2===e[0].length&&c(e[0][0])&&c(e[0][1])){if(e.some(e=>2!==e.length||!c(e[0])||!c(e[1])))return!1}else{if(!(3===e[0].length&&c(e[0][0])&&c(e[0][1])&&c(e[0][2])))return!1;if(e.some(e=>3!==e.length||!c(e[0])||!c(e[1])||!c(e[2])))return!1}return!0}(e))throw new TypeError("Incorrect array format entered for pairwise distance calculation");return function(e){for(var t=[],n=[],r=[],i=0;i<e.length-1;i++)for(var o=i+1;o<e.length;o++)2===e[0].length?(n=[e[i][0],e[i][1]],r=[e[o][0],e[o][1]]):3===e[0].length&&(n=[e[i][0],e[i][1],e[i][2]],r=[e[o][0],e[o][1],e[o][2]]),t.push(v(n,r));return t}(e)}});function c(e){return"number"===typeof e||Rd(e)}function u(e){return e.constructor!==Array&&(e=m(e)),c(e[0])&&c(e[1])}function d(e){return e.constructor!==Array&&(e=m(e)),c(e[0])&&c(e[1])&&c(e[2])}function h(e){return Array.isArray(e)||(e=m(e)),e.every(c)}function f(e){return e.constructor!==Array&&(e=m(e)),c(e[0])&&c(e[1])&&c(e[2])&&c(e[3])&&c(e[4])&&c(e[5])}function m(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;r++)n.push(e[t[r]]);return n}function p(e,t,r,a,c){var u=l(n(n(i(r,e),i(a,t)),c)),d=s(n(i(r,r),i(a,a)));return o(u,d)}function g(e,t,a,l,c,u,d,h,f){var m=[r(i(r(c,t),f),i(r(u,a),h)),r(i(r(u,a),d),i(r(l,e),f)),r(i(r(l,e),h),i(r(c,t),d))];m=s(n(n(i(m[0],m[0]),i(m[1],m[1])),i(m[2],m[2])));var p=s(n(n(i(d,d),i(h,h)),i(f,f)));return o(m,p)}function v(e,t){for(var o=e.length,a=0,l=0,c=0;c<o;c++)l=r(e[c],t[c]),a=n(i(l,l),a);return s(a)}}),tR="dotDivide",nR=vh(tR,["typed","matrix","equalScalar","divideScalar","DenseMatrix","concat","SparseMatrix"],e=>{var{typed:t,matrix:n,equalScalar:r,divideScalar:i,DenseMatrix:o,concat:a,SparseMatrix:s}=e,l=ug({typed:t,equalScalar:r}),c=Xp({typed:t}),u=BN({typed:t,SparseMatrix:s}),d=dg({typed:t,equalScalar:r}),h=Qp({typed:t,DenseMatrix:o}),f=ng({typed:t,matrix:n,concat:a});return t(tR,f({elop:i,SS:u,DS:c,SD:l,Ss:d,sS:h}))}),rR=vh("FibonacciHeap",["smaller","larger"],e=>{var{smaller:t,larger:n}=e,r=1/Math.log((1+Math.sqrt(5))/2);function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}function o(e,t,n){t.left.right=t.right,t.right.left=t.left,n.degree--,n.child===t&&(n.child=t.right),0===n.degree&&(n.child=null),t.left=e,t.right=e.right,e.right=t,t.right.left=t,t.parent=null,t.mark=!1}function a(e,t){var n=t.parent;n&&(t.mark?(o(e,t,n),a(n)):t.mark=!0)}i.prototype.type="FibonacciHeap",i.prototype.isFibonacciHeap=!0,i.prototype.insert=function(e,n){var r={key:e,value:n,degree:0};if(this._minimum){var i=this._minimum;r.left=i,r.right=i.right,i.right=r,r.right.left=r,t(e,i.key)&&(this._minimum=r)}else r.left=r,r.right=r,this._minimum=r;return this._size++,r},i.prototype.size=function(){return this._size},i.prototype.clear=function(){this._minimum=null,this._size=0},i.prototype.isEmpty=function(){return 0===this._size},i.prototype.extractMinimum=function(){var e=this._minimum;if(null===e)return e;for(var i=this._minimum,o=e.degree,a=e.child;o>0;){var l=a.right;a.left.right=a.right,a.right.left=a.left,a.left=i,a.right=i.right,i.right=a,a.right.left=a,a.parent=null,a=l,o--}return e.left.right=e.right,e.right.left=e.left,i=e===e.right?null:function(e,i){var o,a=Math.floor(Math.log(i)*r)+1,l=new Array(a),c=0,u=e;if(u)for(c++,u=u.right;u!==e;)c++,u=u.right;for(;c>0;){for(var d=u.degree,h=u.right;o=l[d];){if(n(u.key,o.key)){var f=o;o=u,u=f}s(o,u),l[d]=null,d++}l[d]=u,u=h,c--}e=null;for(var m=0;m<a;m++)(o=l[m])&&(e?(o.left.right=o.right,o.right.left=o.left,o.left=e,o.right=e.right,e.right=o,o.right.left=o,t(o.key,e.key)&&(e=o)):e=o);return e}(i=e.right,this._size),this._size--,this._minimum=i,e},i.prototype.remove=function(e){this._minimum=function(e,n,r){n.key=r;var i=n.parent;i&&t(n.key,i.key)&&(o(e,n,i),a(e,i));t(n.key,e.key)&&(e=n);return e}(this._minimum,e,-1),this.extractMinimum()};var s=function(e,t){e.left.right=e.right,e.right.left=e.left,e.parent=t,t.child?(e.left=t.child,e.right=t.child.right,t.child.right=e,e.right.left=e):(t.child=e,e.right=e,e.left=e),t.degree++,e.mark=!1};return i},{isClass:!0}),iR="index",oR=vh(iR,["typed","Index"],e=>{var{typed:t,Index:n}=e;return t(iR,{"...number | string | BigNumber | Range | Array | Matrix":function(e){var t=e.map(function(e){return Rd(e)?e.toNumber():Id(e)||Pd(e)?e.map(function(e){return Rd(e)?e.toNumber():e}):e}),r=new n;return n.apply(r,t),r}})}),aR=vh("intersect",["typed","config","abs","add","addScalar","matrix","multiply","multiplyScalar","divideScalar","subtract","smaller","equalScalar","flatten","isZero","isNumeric"],e=>{var{typed:t,config:n,abs:r,add:i,addScalar:o,matrix:a,multiply:s,multiplyScalar:l,divideScalar:c,subtract:u,smaller:d,equalScalar:h,flatten:f,isZero:m,isNumeric:p}=e;return t("intersect",{"Array, Array, Array":g,"Array, Array, Array, Array":v,"Matrix, Matrix, Matrix":function(e,t,n){var r=g(e.valueOf(),t.valueOf(),n.valueOf());return null===r?null:a(r)},"Matrix, Matrix, Matrix, Matrix":function(e,t,n,r){var i=v(e.valueOf(),t.valueOf(),n.valueOf(),r.valueOf());return null===i?null:a(i)}});function g(e,t,n){if(e=y(e),t=y(t),n=y(n),!w(e))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!w(t))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!function(e){return 4===e.length&&p(e[0])&&p(e[1])&&p(e[2])&&p(e[3])}(n))throw new TypeError("Array with 4 numbers expected as third argument");return function(e,t,n,r,i,a,s,d,h,f){var m=l(e,s),p=l(r,s),g=l(t,d),v=l(i,d),y=l(n,h),b=l(a,h),w=u(u(u(f,m),g),y),x=u(u(u(o(o(p,v),b),m),g),y),S=c(w,x),C=o(e,l(S,u(r,e))),E=o(t,l(S,u(i,t))),N=o(n,l(S,u(a,n)));return[C,E,N]}(e[0],e[1],e[2],t[0],t[1],t[2],n[0],n[1],n[2],n[3])}function v(e,t,a,f){if(e=y(e),t=y(t),a=y(a),f=y(f),2===e.length){if(!b(e))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!b(t))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!b(a))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");if(!b(f))throw new TypeError("Array with 2 numbers or BigNumbers expected for fourth argument");return function(e,t,a,h){var f=e,p=a,g=u(f,t),v=u(p,h),y=u(l(g[0],v[1]),l(v[0],g[1]));if(m(y))return null;if(d(r(y),n.relTol))return null;var b=l(v[0],f[1]),w=l(v[1],f[0]),x=l(v[0],p[1]),S=l(v[1],p[0]),C=c(o(u(u(b,w),x),S),y);return i(s(g,C),f)}(e,t,a,f)}if(3===e.length){if(!w(e))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!w(t))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!w(a))throw new TypeError("Array with 3 numbers or BigNumbers expected for third argument");if(!w(f))throw new TypeError("Array with 3 numbers or BigNumbers expected for fourth argument");return function(e,t,n,r,i,a,s,d,f,p,g,v){var y=x(e,s,p,s,t,d,g,d,n,f,v,f),b=x(p,s,r,e,g,d,i,t,v,f,a,n),w=x(e,s,r,e,t,d,i,t,n,f,a,n),S=x(p,s,p,s,g,d,g,d,v,f,v,f),C=x(r,e,r,e,i,t,i,t,a,n,a,n),E=u(l(y,b),l(w,S)),N=u(l(C,S),l(b,b));if(m(N))return null;var T=c(E,N),A=c(o(y,l(T,b)),S),R=o(e,l(T,u(r,e))),k=o(t,l(T,u(i,t))),M=o(n,l(T,u(a,n))),D=o(s,l(A,u(p,s))),_=o(d,l(A,u(g,d))),O=o(f,l(A,u(v,f)));return h(R,D)&&h(k,_)&&h(M,O)?[R,k,M]:null}(e[0],e[1],e[2],t[0],t[1],t[2],a[0],a[1],a[2],f[0],f[1],f[2])}throw new TypeError("Arrays with two or thee dimensional points expected")}function y(e){return 1===e.length?e[0]:e.length>1&&Array.isArray(e[0])&&e.every(e=>Array.isArray(e)&&1===e.length)?f(e):e}function b(e){return 2===e.length&&p(e[0])&&p(e[1])}function w(e){return 3===e.length&&p(e[0])&&p(e[1])&&p(e[2])}function x(e,t,n,r,i,a,s,c,d,h,f,m){var p=l(u(e,t),u(n,r)),g=l(u(i,a),u(s,c)),v=l(u(d,h),u(f,m));return o(o(p,g),v)}}),sR="invmod",lR=vh(sR,["typed","config","BigNumber","xgcd","equal","smaller","mod","add","isInteger"],e=>{var{typed:t,config:n,BigNumber:r,xgcd:i,equal:o,smaller:a,mod:s,add:l,isInteger:c}=e;return t(sR,{"number, number":u,"BigNumber, BigNumber":u});function u(e,t){if(!c(e)||!c(t))throw new Error("Parameters in function invmod must be integer numbers");if(e=s(e,t),o(t,0))throw new Error("Divisor must be non zero");var n=i(e,t);n=n.valueOf();var[u,d]=n;return o(u,r(1))?(d=s(d,t),a(d,r(0))&&(d=l(d,t)),d):NaN}}),cR=vh("lcm",["typed","matrix","equalScalar","concat"],e=>{var{typed:t,matrix:n,equalScalar:r,concat:i}=e,o=ug({typed:t,equalScalar:r}),a=hg({typed:t,equalScalar:r}),s=dg({typed:t,equalScalar:r}),l=ng({typed:t,matrix:n,concat:i}),c="number | BigNumber | Fraction | Matrix | Array",u={};return u["".concat(c,", ").concat(c,", ...").concat(c)]=t.referToSelf(e=>(t,n,r)=>{for(var i=e(t,n),o=0;o<r.length;o++)i=e(i,r[o]);return i}),t("lcm",{"number, number":Qx,"BigNumber, BigNumber":function(e,t){if(!e.isInt()||!t.isInt())throw new Error("Parameters in function lcm must be integer numbers");if(e.isZero())return e;if(t.isZero())return t;var n=e.times(t);for(;!t.isZero();){var r=t;t=e.mod(r),e=r}return n.div(e).abs()},"Fraction, Fraction":(e,t)=>e.lcm(t)},l({SS:a,DS:o,Ss:s}),u)}),uR="log1p",dR=vh(uR,["typed","config","divideScalar","log","Complex"],e=>{var{typed:t,config:n,divideScalar:r,log:i,Complex:o}=e;return t(uR,{number:function(e){return e>=-1||n.predictable?Nh(e):a(new o(e,0))},Complex:a,BigNumber:function(e){var t=e.plus(1);return!t.isNegative()||n.predictable?t.ln():a(new o(e.toNumber(),0))},"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e)),"any, any":t.referToSelf(e=>(t,n)=>r(e(t),i(n)))});function a(e){var t=e.re+1;return new o(Math.log(Math.sqrt(t*t+e.im*e.im)),Math.atan2(e.im,t))}}),hR="lsolveAll",fR=vh(hR,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],e=>{var{typed:t,matrix:n,divideScalar:r,multiplyScalar:i,subtractScalar:o,equalScalar:a,DenseMatrix:s}=e,l=xA({DenseMatrix:s});return t(hR,{"SparseMatrix, Array | Matrix":function(e,t){return function(e,t){for(var n=[l(e,t,!0)._data.map(e=>e[0])],c=e._size[0],u=e._size[1],d=e._values,h=e._index,f=e._ptr,m=0;m<u;m++)for(var p=n.length,g=0;g<p;g++){for(var v=n[g],y=[],b=[],w=f[m],x=f[m+1],S=0,C=w;C<x;C++){var E=h[C];E===m?S=d[C]:E>m&&(y.push(d[C]),b.push(E))}if(a(S,0))if(a(v[m],0)){if(0===g){var N=[...v];N[m]=1;for(var T=0,A=b.length;T<A;T++){var R=b[T];N[R]=o(N[R],y[T])}n.push(N)}}else{if(0===g)return[];n.splice(g,1),g-=1,p-=1}else{v[m]=r(v[m],S);for(var k=0,M=b.length;k<M;k++){var D=b[k];v[D]=o(v[D],i(v[m],y[k]))}}}return n.map(e=>new s({data:e.map(e=>[e]),size:[c,1]}))}(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return c(e,t)},"Array, Array | Matrix":function(e,t){return c(n(e),t).map(e=>e.valueOf())}});function c(e,t){for(var n=[l(e,t,!0)._data.map(e=>e[0])],c=e._data,u=e._size[0],d=e._size[1],h=0;h<d;h++)for(var f=n.length,m=0;m<f;m++){var p=n[m];if(a(c[h][h],0))if(a(p[h],0)){if(0===m){var g=[...p];g[h]=1;for(var v=h+1;v<d;v++)g[v]=o(g[v],c[v][h]);n.push(g)}}else{if(0===m)return[];n.splice(m,1),m-=1,f-=1}else{p[h]=r(p[h],c[h][h]);for(var y=h+1;y<d;y++)p[y]=o(p[y],i(p[h],c[y][h]))}}return n.map(e=>new s({data:e.map(e=>[e]),size:[u,1]}))}}),mR="setCartesian",pR=vh(mR,["typed","size","subset","compareNatural","Index","DenseMatrix"],e=>{var{typed:t,size:n,subset:r,compareNatural:i,Index:o,DenseMatrix:a}=e;return t(mR,{"Array | Matrix, Array | Matrix":function(e,t){var s=[];if(0!==r(n(e),new o(0))&&0!==r(n(t),new o(0))){var l=Sf(Array.isArray(e)?e:e.toArray()).sort(i),c=Sf(Array.isArray(t)?t:t.toArray()).sort(i);s=[];for(var u=0;u<l.length;u++)for(var d=0;d<c.length;d++)s.push([l[u],c[d]])}return Array.isArray(e)&&Array.isArray(t)?s:new a(s)}})}),gR="setDistinct",vR=vh(gR,["typed","size","subset","compareNatural","Index","DenseMatrix"],e=>{var{typed:t,size:n,subset:r,compareNatural:i,Index:o,DenseMatrix:a}=e;return t(gR,{"Array | Matrix":function(e){var t;if(0===r(n(e),new o(0)))t=[];else{var s=Sf(Array.isArray(e)?e:e.toArray()).sort(i);(t=[]).push(s[0]);for(var l=1;l<s.length;l++)0!==i(s[l],s[l-1])&&t.push(s[l])}return Array.isArray(e)?t:new a(t)}})}),yR="setIsSubset",bR=vh(yR,["typed","size","subset","compareNatural","Index"],e=>{var{typed:t,size:n,subset:r,compareNatural:i,Index:o}=e;return t(yR,{"Array | Matrix, Array | Matrix":function(e,t){if(0===r(n(e),new o(0)))return!0;if(0===r(n(t),new o(0)))return!1;for(var a,s=Rf(Sf(Array.isArray(e)?e:e.toArray()).sort(i)),l=Rf(Sf(Array.isArray(t)?t:t.toArray()).sort(i)),c=0;c<s.length;c++){a=!1;for(var u=0;u<l.length;u++)if(0===i(s[c].value,l[u].value)&&s[c].identifier===l[u].identifier){a=!0;break}if(!1===a)return!1}return!0}})}),wR="setPowerset",xR=vh(wR,["typed","size","subset","compareNatural","Index"],e=>{var{typed:t,size:n,subset:r,compareNatural:i,Index:o}=e;return t(wR,{"Array | Matrix":function(e){if(0===r(n(e),new o(0)))return[];for(var t=Sf(Array.isArray(e)?e:e.toArray()).sort(i),s=[],l=0;l.toString(2).length<=t.length;)s.push(a(t,l.toString(2).split("").reverse())),l++;return function(e){for(var t=[],n=e.length-1;n>0;n--)for(var r=0;r<n;r++)e[r].length>e[r+1].length&&(t=e[r],e[r]=e[r+1],e[r+1]=t);return e}(s)}});function a(e,t){for(var n=[],r=0;r<t.length;r++)"1"===t[r]&&n.push(e[r]);return n}});function SR(e,t,n,r,i,o,a){var s=0;for(n[a]=e;s>=0;){var l=n[a+s],c=n[r+l];-1===c?(s--,o[t++]=l):(n[r+l]=n[i+c],n[a+ ++s]=c)}return t}function CR(e){return-e-2}var ER=vh("csAmd",["add","multiply","transpose"],e=>{var{add:t,multiply:n,transpose:r}=e;return function(e,a){if(!a||e<=0||e>3)return null;var s=a._size,l=s[0],c=s[1],u=0,d=Math.max(16,10*Math.sqrt(c)),h=function(e,i,o,a,s){var l=r(i);if(1===e&&a===o)return t(i,l);if(2===e){for(var c=l._index,u=l._ptr,d=0,h=0;h<o;h++){var f=u[h];if(u[h]=d,!(u[h+1]-f>s))for(var m=u[h+1];f<m;f++)c[d++]=c[f]}return u[o]=d,i=r(l),n(l,i)}return n(l,i)}(e,a,l,c,d=Math.min(c-2,d));!function(e,t,n){for(var r=e._values,i=e._index,o=e._ptr,a=e._size[1],s=0,l=0;l<a;l++){var c=o[l];for(o[l]=s;c<o[l+1];c++)t(i[c],l,r?r[c]:1,n)&&(i[s]=i[c],r&&(r[s]=r[c]),s++)}o[a]=s,i.splice(s,i.length-s),r&&r.splice(s,r.length-s)}(h,o,null);for(var f,m,p,g,v,y,b,w,x,S,C,E,N,T,A,R,k=h._index,M=h._ptr,D=M[c],_=[],O=[],I=c+1,P=2*(c+1),j=3*(c+1),F=4*(c+1),H=5*(c+1),L=6*(c+1),B=7*(c+1),z=_,W=function(e,t,n,r,o,a,s,l,c,u,d,h){for(var f=0;f<e;f++)n[r+f]=t[f+1]-t[f];n[r+e]=0;for(var m=0;m<=e;m++)n[o+m]=-1,a[m]=-1,n[s+m]=-1,n[l+m]=-1,n[c+m]=1,n[u+m]=1,n[d+m]=0,n[h+m]=n[r+m];var p=i(0,0,n,u,e);return n[d+e]=-2,t[e]=-1,n[u+e]=0,p}(c,M,O,0,j,z,P,B,I,L,F,H),V=function(e,t,n,r,i,o,a,s,l,c,u){for(var d=0,h=0;h<e;h++){var f=n[r+h];if(0===f)n[i+h]=-2,d++,t[h]=-1,n[o+h]=0;else if(f>a)n[s+h]=0,n[i+h]=-1,d++,t[h]=CR(e),n[s+e]++;else{var m=n[l+f];-1!==m&&(c[m]=h),n[u+h]=n[l+f],n[l+f]=h}}return d}(c,M,O,H,F,L,d,I,j,z,P),U=0;V<c;){for(p=-1;U<c&&-1===(p=O[j+U]);U++);-1!==O[P+p]&&(z[O[P+p]]=-1),O[j+U]=O[P+p];var q=O[F+p],G=O[I+p];V+=G;var Y=0;O[I+p]=-G;var K=M[p],$=0===q?K:D,X=$;for(g=1;g<=q+1;g++){for(g>q?(y=p,b=K,w=O[0+p]-q):(b=M[y=k[K++]],w=O[0+y]),v=1;v<=w;v++)(x=O[I+(f=k[b++])])<=0||(Y+=x,O[I+f]=-x,k[X++]=f,-1!==O[P+f]&&(z[O[P+f]]=z[f]),-1!==z[f]?O[P+z[f]]=O[P+f]:O[j+O[H+f]]=O[P+f]);y!==p&&(M[y]=CR(p),O[L+y]=0)}for(0!==q&&(D=X),O[H+p]=Y,M[p]=$,O[0+p]=X-$,O[F+p]=-2,W=i(W,u,O,L,c),S=$;S<X;S++)if(!((C=O[F+(f=k[S])])<=0)){var Q=W-(x=-O[I+f]);for(K=M[f],E=M[f]+C-1;K<=E;K++)O[L+(y=k[K])]>=W?O[L+y]-=x:0!==O[L+y]&&(O[L+y]=O[H+y]+Q)}for(S=$;S<X;S++){for(N=(E=M[f=k[S]])+O[F+f]-1,T=E,A=0,R=0,K=E;K<=N;K++)if(0!==O[L+(y=k[K])]){var J=O[L+y]-W;J>0?(R+=J,k[T++]=y,A+=y):(M[y]=CR(p),O[L+y]=0)}O[F+f]=T-E+1;var Z=T,ee=E+O[0+f];for(K=N+1;K<ee;K++){var te=O[I+(m=k[K])];te<=0||(R+=te,k[T++]=m,A+=m)}0===R?(M[f]=CR(p),Y-=x=-O[I+f],G+=x,V+=x,O[I+f]=0,O[F+f]=-1):(O[H+f]=Math.min(O[H+f],R),k[T]=k[Z],k[Z]=k[E],k[E]=p,O[0+f]=T-E+1,A=(A<0?-A:A)%c,O[P+f]=O[B+A],O[B+A]=f,z[f]=A)}for(O[H+p]=Y,W=i(W+(u=Math.max(u,Y)),u,O,L,c),S=$;S<X;S++)if(!(O[I+(f=k[S])]>=0))for(f=O[B+(A=z[f])],O[B+A]=-1;-1!==f&&-1!==O[P+f];f=O[P+f],W++){for(w=O[0+f],C=O[F+f],K=M[f]+1;K<=M[f]+w-1;K++)O[L+k[K]]=W;var ne=f;for(m=O[P+f];-1!==m;){var re=O[0+m]===w&&O[F+m]===C;for(K=M[m]+1;re&&K<=M[m]+w-1;K++)O[L+k[K]]!==W&&(re=0);re?(M[m]=CR(f),O[I+f]+=O[I+m],O[I+m]=0,O[F+m]=-1,m=O[P+m],O[P+ne]=m):(ne=m,m=O[P+m])}}for(K=$,S=$;S<X;S++)(x=-O[I+(f=k[S])])<=0||(O[I+f]=x,R=O[H+f]+Y-x,-1!==O[j+(R=Math.min(R,c-V-x))]&&(z[O[j+R]]=f),O[P+f]=O[j+R],z[f]=-1,O[j+R]=f,U=Math.min(U,R),O[H+f]=R,k[K++]=f);O[I+p]=G,0===(O[0+p]=K-$)&&(M[p]=-1,O[L+p]=0),0!==q&&(D=K)}for(f=0;f<c;f++)M[f]=CR(M[f]);for(m=0;m<=c;m++)O[j+m]=-1;for(m=c;m>=0;m--)O[I+m]>0||(O[P+m]=O[j+M[m]],O[j+M[m]]=m);for(y=c;y>=0;y--)O[I+y]<=0||-1!==M[y]&&(O[P+y]=O[j+M[y]],O[j+M[y]]=y);for(p=0,f=0;f<=c;f++)-1===M[f]&&(p=SR(f,p,O,j,P,_,L));return _.splice(_.length-1,1),_};function i(e,t,n,r,i){if(e<2||e+t<0){for(var o=0;o<i;o++)0!==n[r+o]&&(n[r+o]=1);e=2}return e}function o(e,t){return e!==t}});function NR(e,t,n,r,i,o,a){var s,l,c,u=0;if(e<=t||n[r+t]<=n[i+e])return-1;n[i+e]=n[r+t];var d=n[o+e];if(n[o+e]=t,-1===d)u=1,c=e;else{for(u=2,c=d;c!==n[a+c];c=n[a+c]);for(s=d;s!==c;s=l)l=n[a+s],n[a+s]=c}return{jleaf:u,q:c}}var TR=vh("csCounts",["transpose"],e=>{var{transpose:t}=e;return function(e,n,r,i){if(!e||!n||!r)return null;var o,a,s,l,c,u,d,h=e._size,f=h[0],m=h[1],p=4*m+(i?m+f+1:0),g=[],v=m,y=2*m,b=3*m,w=4*m,x=5*m+1;for(s=0;s<p;s++)g[s]=-1;var S=[],C=t(e),E=C._index,N=C._ptr;for(s=0;s<m;s++)for(S[a=r[s]]=-1===g[b+a]?1:0;-1!==a&&-1===g[b+a];a=n[a])g[b+a]=s;if(i){for(s=0;s<m;s++)g[r[s]]=s;for(o=0;o<f;o++){for(s=m,u=N[o],d=N[o+1],c=u;c<d;c++)s=Math.min(s,g[E[c]]);g[x+o]=g[w+s],g[w+s]=o}}for(o=0;o<m;o++)g[0+o]=o;for(s=0;s<m;s++){for(-1!==n[a=r[s]]&&S[n[a]]--,l=i?g[w+s]:a;-1!==l;l=i?g[x+l]:-1)for(c=N[l];c<N[l+1];c++){var T=NR(o=E[c],a,g,b,v,y,0);T.jleaf>=1&&S[a]++,2===T.jleaf&&S[T.q]--}-1!==n[a]&&(g[0+a]=n[a])}for(a=0;a<m;a++)-1!==n[a]&&(S[n[a]]+=S[a]);return S}}),AR=vh("csSqr",["add","multiply","transpose"],e=>{var{add:t,multiply:n,transpose:r}=e,i=ER({add:t,multiply:n,transpose:r}),o=TR({transpose:r});return function(e,t,n){var r,a=t._ptr,s=t._size[1],l={};if(l.q=i(e,t),e&&!l.q)return null;if(n){var c=e?function(e,t,n,r){for(var i=e._values,o=e._index,a=e._ptr,s=e._size,l=e._datatype,c=s[0],u=s[1],d=r&&e._values?[]:null,h=[],f=[],m=0,p=0;p<u;p++){f[p]=m;for(var g=n?n[p]:p,v=a[g],y=a[g+1],b=v;b<y;b++){var w=t?t[o[b]]:o[b];h[m]=w,d&&(d[m]=i[b]),m++}}return f[u]=m,e.createSparseMatrix({values:d,index:h,ptr:f,size:[c,u],datatype:l})}(t,null,l.q,0):t;l.parent=function(e,t){if(!e)return null;var n,r,i=e._index,o=e._ptr,a=e._size,s=a[0],l=a[1],c=[],u=[],d=l;if(t)for(n=0;n<s;n++)u[d+n]=-1;for(var h=0;h<l;h++){c[h]=-1,u[0+h]=-1;for(var f=o[h],m=o[h+1],p=f;p<m;p++){var g=i[p];for(n=t?u[d+g]:g;-1!==n&&n<h;n=r)r=u[0+n],u[0+n]=h,-1===r&&(c[n]=h);t&&(u[d+g]=h)}}return c}(c,1);var u=function(e,t){if(!e)return null;var n,r=0,i=[],o=[],a=t,s=2*t;for(n=0;n<t;n++)o[0+n]=-1;for(n=t-1;n>=0;n--)-1!==e[n]&&(o[a+n]=o[0+e[n]],o[0+e[n]]=n);for(n=0;n<t;n++)-1===e[n]&&(r=SR(n,r,o,0,a,i,s));return i}(l.parent,s);if(l.cp=o(c,l.parent,u,1),c&&l.parent&&l.cp&&function(e,t){var n=e._ptr,r=e._index,i=e._size,o=i[0],a=i[1];t.pinv=[],t.leftmost=[];var s,l,c,u,d,h=t.parent,f=t.pinv,m=t.leftmost,p=[],g=0,v=o,y=o+a,b=o+2*a;for(l=0;l<a;l++)p[v+l]=-1,p[y+l]=-1,p[b+l]=0;for(s=0;s<o;s++)m[s]=-1;for(l=a-1;l>=0;l--)for(u=n[l],d=n[l+1],c=u;c<d;c++)m[r[c]]=l;for(s=o-1;s>=0;s--)f[s]=-1,-1!==(l=m[s])&&(0===p[b+l]++&&(p[y+l]=s),p[g+s]=p[v+l],p[v+l]=s);for(t.lnz=0,t.m2=o,l=0;l<a;l++)if(s=p[v+l],t.lnz++,s<0&&(s=t.m2++),f[s]=l,!(--b[l]<=0)){t.lnz+=p[b+l];var w=h[l];-1!==w&&(0===p[b+w]&&(p[y+w]=p[y+l]),p[g+p[y+l]]=p[v+w],p[v+w]=p[g+s],p[b+w]+=p[b+l])}for(s=0;s<o;s++)f[s]<0&&(f[s]=l++);return!0}(c,l))for(l.unz=0,r=0;r<s;r++)l.unz+=l.cp[r]}else l.unz=4*a[s]+s,l.lnz=l.unz;return l}});function RR(e,t){return e[t]<0}function kR(e,t){e[t]=CR(e[t])}function MR(e){return e<0?CR(e):e}function DR(e,t,n,r,i){var o,a,s,l=t._index,c=t._ptr,u=t._size[1],d=0;for(r[0]=e;d>=0;){e=r[d];var h=i?i[e]:e;RR(c,e)||(kR(c,e),r[u+d]=h<0?0:MR(c[h]));var f=1;for(a=r[u+d],s=h<0?0:MR(c[h+1]);a<s;a++)if(!RR(c,o=l[a])){r[u+d]=a,r[++d]=o,f=0;break}f&&(d--,r[--n]=e)}return n}var _R=vh("csSpsolve",["divideScalar","multiply","subtract"],e=>{var{divideScalar:t,multiply:n,subtract:r}=e;return function(e,i,o,a,s,l,c){var u,d,h,f,m=e._values,p=e._index,g=e._ptr,v=e._size[1],y=i._values,b=i._index,w=i._ptr,x=function(e,t,n,r,i){var o,a,s,l=e._ptr,c=e._size,u=t._index,d=t._ptr,h=c[1],f=h;for(a=d[n],s=d[n+1],o=a;o<s;o++){var m=u[o];RR(l,m)||(f=DR(m,e,f,r,i))}for(o=f;o<h;o++)kR(l,r[o]);return f}(e,i,o,a,l);for(u=x;u<v;u++)s[a[u]]=0;for(d=w[o],h=w[o+1],u=d;u<h;u++)s[b[u]]=y[u];for(var S=x;S<v;S++){var C=a[S],E=l?l[C]:C;if(!(E<0))for(d=g[E],h=g[E+1],s[C]=t(s[C],m[c?d:h-1]),u=c?d+1:d,f=c?h:h-1;u<f;u++){var N=p[u];s[N]=r(s[N],n(m[u],s[C]))}}return x}}),OR=vh("csLu",["abs","divideScalar","multiply","subtract","larger","largerEq","SparseMatrix"],e=>{var{abs:t,divideScalar:n,multiply:r,subtract:i,larger:o,largerEq:a,SparseMatrix:s}=e,l=_R({divideScalar:n,multiply:r,subtract:i});return function(e,i,c){if(!e)return null;var u,d=e._size[1],h=100,f=100;i&&(u=i.q,h=i.lnz||h,f=i.unz||f);var m,p,g=[],v=[],y=[],b=new s({values:g,index:v,ptr:y,size:[d,d]}),w=[],x=[],S=[],C=new s({values:w,index:x,ptr:S,size:[d,d]}),E=[],N=[],T=[];for(m=0;m<d;m++)N[m]=0,E[m]=-1,y[m+1]=0;h=0,f=0;for(var A=0;A<d;A++){y[A]=h,S[A]=f;var R=u?u[A]:A,k=l(b,e,R,T,N,E,1),M=-1,D=-1;for(p=k;p<d;p++)if(E[m=T[p]]<0){var _=t(N[m]);o(_,D)&&(D=_,M=m)}else x[f]=E[m],w[f++]=N[m];if(-1===M||D<=0)return null;E[R]<0&&a(t(N[R]),r(D,c))&&(M=R);var O=N[M];for(x[f]=A,w[f++]=O,E[M]=A,v[h]=M,g[h++]=1,p=k;p<d;p++)E[m=T[p]]<0&&(v[h]=m,g[h++]=n(N[m],O)),N[m]=0}for(y[d]=h,S[d]=f,p=0;p<h;p++)v[p]=E[v[p]];return g.splice(h,g.length-h),v.splice(h,v.length-h),w.splice(f,w.length-f),x.splice(f,x.length-f),{L:b,U:C,pinv:E}}}),IR=vh("slu",["typed","abs","add","multiply","transpose","divideScalar","subtract","larger","largerEq","SparseMatrix"],e=>{var{typed:t,abs:n,add:r,multiply:i,transpose:o,divideScalar:a,subtract:s,larger:l,largerEq:c,SparseMatrix:u}=e,d=AR({add:r,multiply:i,transpose:o}),h=OR({abs:n,divideScalar:a,multiply:i,subtract:s,larger:l,largerEq:c,SparseMatrix:u});return t("slu",{"SparseMatrix, number, number":function(e,t,n){if(!wh(t)||t<0||t>3)throw new Error("Symbolic Ordering and Analysis order must be an integer number in the interval [0, 3]");if(n<0||n>1)throw new Error("Partial pivoting threshold must be a number from 0 to 1");var r=d(t,e,!1),i=h(e,r,n);return{L:i.L,U:i.U,p:i.pinv,q:r.q,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\np: "+this.p.toString()+(this.q?"\nq: "+this.q.toString():"")+"\n"}}}})}),PR="sort",jR=vh(PR,["typed","matrix","compare","compareNatural"],e=>{var{typed:t,matrix:n,compare:r,compareNatural:i}=e,o=r,a=(e,t)=>-r(e,t);return t(PR,{Array:function(e){return l(e),e.sort(o)},Matrix:function(e){return c(e),n(e.toArray().sort(o),e.storage())},"Array, function":function(e,t){return l(e),e.sort(t)},"Matrix, function":function(e,t){return c(e),n(e.toArray().sort(t),e.storage())},"Array, string":function(e,t){return l(e),e.sort(s(t))},"Matrix, string":function(e,t){return c(e),n(e.toArray().sort(s(t)),e.storage())}});function s(e){if("asc"===e)return o;if("desc"===e)return a;if("natural"===e)return i;throw new Error('String "asc", "desc", or "natural" expected')}function l(e){if(1!==sf(e).length)throw new Error("One dimensional array expected")}function c(e){if(1!==e.size().length)throw new Error("One dimensional matrix expected")}}),FR="unaryPlus",HR=vh(FR,["typed","config","numeric"],e=>{var{typed:t,config:n,numeric:r}=e;return t(FR,{number:Gx,Complex:function(e){return e},BigNumber:function(e){return e},bigint:function(e){return e},Fraction:function(e){return e},Unit:function(e){return e.clone()},"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e,!0)),boolean:function(e){return r(e?1:0,n.number)},string:function(e){return r(e,xh(e,n))}})}),LR="usolveAll",BR=vh(LR,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],e=>{var{typed:t,matrix:n,divideScalar:r,multiplyScalar:i,subtractScalar:o,equalScalar:a,DenseMatrix:s}=e,l=xA({DenseMatrix:s});return t(LR,{"SparseMatrix, Array | Matrix":function(e,t){return function(e,t){for(var n=[l(e,t,!0)._data.map(e=>e[0])],c=e._size[0],u=e._size[1],d=e._values,h=e._index,f=e._ptr,m=u-1;m>=0;m--)for(var p=n.length,g=0;g<p;g++){for(var v=n[g],y=[],b=[],w=f[m],x=0,S=f[m+1]-1;S>=w;S--){var C=h[S];C===m?x=d[S]:C<m&&(y.push(d[S]),b.push(C))}if(a(x,0))if(a(v[m],0)){if(0===g){var E=[...v];E[m]=1;for(var N=0,T=b.length;N<T;N++){var A=b[N];E[A]=o(E[A],y[N])}n.push(E)}}else{if(0===g)return[];n.splice(g,1),g-=1,p-=1}else{v[m]=r(v[m],x);for(var R=0,k=b.length;R<k;R++){var M=b[R];v[M]=o(v[M],i(v[m],y[R]))}}}return n.map(e=>new s({data:e.map(e=>[e]),size:[c,1]}))}(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return c(e,t)},"Array, Array | Matrix":function(e,t){return c(n(e),t).map(e=>e.valueOf())}});function c(e,t){for(var n=[l(e,t,!0)._data.map(e=>e[0])],c=e._data,u=e._size[0],d=e._size[1]-1;d>=0;d--)for(var h=n.length,f=0;f<h;f++){var m=n[f];if(a(c[d][d],0))if(a(m[d],0)){if(0===f){var p=[...m];p[d]=1;for(var g=d-1;g>=0;g--)p[g]=o(p[g],c[g][d]);n.push(p)}}else{if(0===f)return[];n.splice(f,1),f-=1,h-=1}else{m[d]=r(m[d],c[d][d]);for(var v=d-1;v>=0;v--)m[v]=o(m[v],i(m[d],c[v][d]))}}return n.map(e=>new s({data:e.map(e=>[e]),size:[u,1]}))}}),zR="ceil",WR=["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],VR=new Nb(10),UR=vh(zR,["typed","config","round"],e=>{var{typed:t,config:n,round:r}=e;function i(e){var t=Math.ceil(e),i=r(e);return t===i?t:jh(e,i,n.relTol,n.absTol)&&!jh(e,t,n.relTol,n.absTol)?i:t}return t(zR,{number:i,"number, number":function(e,t){if(!wh(t))throw new RangeError("number of decimals in function ceil must be an integer");if(t<0||t>15)throw new RangeError("number of decimals in ceil number must be in range 0-15");var n=10**t;return i(e*n)/n}})}),qR=vh(zR,WR,e=>{var{typed:t,config:n,round:r,matrix:i,equalScalar:o,zeros:a,DenseMatrix:s}=e,l=dg({typed:t,equalScalar:o}),c=Qp({typed:t,DenseMatrix:s}),u=eg({typed:t}),d=UR({typed:t,config:n,round:r});function h(e){var t=(e,t)=>sC(e,t,n.relTol,n.absTol),i=e.ceil(),o=r(e);return i.eq(o)?i:t(e,o)&&!t(e,i)?o:i}return t("ceil",{number:d.signatures.number,"number,number":d.signatures["number,number"],Complex:function(e){return e.ceil()},"Complex, number":function(e,t){return e.ceil(t)},"Complex, BigNumber":function(e,t){return e.ceil(t.toNumber())},BigNumber:h,"BigNumber, BigNumber":function(e,t){var n=VR.pow(t);return h(e.mul(n)).div(n)},bigint:e=>e,"bigint, number":(e,t)=>e,"bigint, BigNumber":(e,t)=>e,Fraction:function(e){return e.ceil()},"Fraction, number":function(e,t){return e.ceil(t)},"Fraction, BigNumber":function(e,t){return e.ceil(t.toNumber())},"Unit, number, Unit":t.referToSelf(e=>function(t,n,r){var i=t.toNumeric(r);return r.multiply(e(i,n))}),"Unit, BigNumber, Unit":t.referToSelf(e=>(t,n,r)=>e(t,n.toNumber(),r)),"Array | Matrix, number | BigNumber, Unit":t.referToSelf(e=>(t,n,r)=>Pm(t,t=>e(t,n,r),!0)),"Array | Matrix | Unit, Unit":t.referToSelf(e=>(t,n)=>e(t,0,n)),"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e,!0)),"Array, number | BigNumber":t.referToSelf(e=>(t,n)=>Pm(t,t=>e(t,n),!0)),"SparseMatrix, number | BigNumber":t.referToSelf(e=>(t,n)=>l(t,n,e,!1)),"DenseMatrix, number | BigNumber":t.referToSelf(e=>(t,n)=>u(t,n,e,!1)),"number | Complex | Fraction | BigNumber, Array":t.referToSelf(e=>(t,n)=>u(i(n),t,e,!0).valueOf()),"number | Complex | Fraction | BigNumber, Matrix":t.referToSelf(e=>(t,n)=>o(t,0)?a(n.size(),n.storage()):"dense"===n.storage()?u(n,t,e,!0):c(n,t,e,!0))})}),GR="fix",YR=["typed","Complex","matrix","ceil","floor","equalScalar","zeros","DenseMatrix"],KR=vh(GR,["typed","ceil","floor"],e=>{var{typed:t,ceil:n,floor:r}=e;return t(GR,{number:function(e){return e>0?r(e):n(e)},"number, number":function(e,t){return e>0?r(e,t):n(e,t)}})}),$R=vh(GR,YR,e=>{var{typed:t,Complex:n,matrix:r,ceil:i,floor:o,equalScalar:a,zeros:s,DenseMatrix:l}=e,c=Qp({typed:t,DenseMatrix:l}),u=eg({typed:t}),d=KR({typed:t,ceil:i,floor:o});return t("fix",{number:d.signatures.number,"number, number | BigNumber":d.signatures["number,number"],Complex:function(e){return new n(e.re>0?Math.floor(e.re):Math.ceil(e.re),e.im>0?Math.floor(e.im):Math.ceil(e.im))},"Complex, number":function(e,t){return new n(e.re>0?o(e.re,t):i(e.re,t),e.im>0?o(e.im,t):i(e.im,t))},"Complex, BigNumber":function(e,t){var r=t.toNumber();return new n(e.re>0?o(e.re,r):i(e.re,r),e.im>0?o(e.im,r):i(e.im,r))},BigNumber:function(e){return e.isNegative()?i(e):o(e)},"BigNumber, number | BigNumber":function(e,t){return e.isNegative()?i(e,t):o(e,t)},bigint:e=>e,"bigint, number":(e,t)=>e,"bigint, BigNumber":(e,t)=>e,Fraction:function(e){return e.s<0n?e.ceil():e.floor()},"Fraction, number | BigNumber":function(e,t){return e.s<0n?i(e,t):o(e,t)},"Unit, number, Unit":t.referToSelf(e=>function(t,n,r){var i=t.toNumeric(r);return r.multiply(e(i,n))}),"Unit, BigNumber, Unit":t.referToSelf(e=>(t,n,r)=>e(t,n.toNumber(),r)),"Array | Matrix, number | BigNumber, Unit":t.referToSelf(e=>(t,n,r)=>Pm(t,t=>e(t,n,r),!0)),"Array | Matrix | Unit, Unit":t.referToSelf(e=>(t,n)=>e(t,0,n)),"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e,!0)),"Array | Matrix, number | BigNumber":t.referToSelf(e=>(t,n)=>Pm(t,t=>e(t,n),!0)),"number | Complex | Fraction | BigNumber, Array":t.referToSelf(e=>(t,n)=>u(r(n),t,e,!0).valueOf()),"number | Complex | Fraction | BigNumber, Matrix":t.referToSelf(e=>(t,n)=>a(t,0)?s(n.size(),n.storage()):"dense"===n.storage()?u(n,t,e,!0):c(n,t,e,!0))})}),XR="setDifference",QR=vh(XR,["typed","size","subset","compareNatural","Index","DenseMatrix"],e=>{var{typed:t,size:n,subset:r,compareNatural:i,Index:o,DenseMatrix:a}=e;return t(XR,{"Array | Matrix, Array | Matrix":function(e,t){var s;if(0===r(n(e),new o(0)))s=[];else{if(0===r(n(t),new o(0)))return Sf(e.toArray());var l,c=Rf(Sf(Array.isArray(e)?e:e.toArray()).sort(i)),u=Rf(Sf(Array.isArray(t)?t:t.toArray()).sort(i));s=[];for(var d=0;d<c.length;d++){l=!1;for(var h=0;h<u.length;h++)if(0===i(c[d].value,u[h].value)&&c[d].identifier===u[h].identifier){l=!0;break}l||s.push(c[d])}}return Array.isArray(e)&&Array.isArray(t)?kf(s):new a(kf(s))}})}),JR="setMultiplicity",ZR=vh(JR,["typed","size","subset","compareNatural","Index"],e=>{var{typed:t,size:n,subset:r,compareNatural:i,Index:o}=e;return t(JR,{"number | BigNumber | Fraction | Complex, Array | Matrix":function(e,t){if(0===r(n(t),new o(0)))return 0;for(var a=Sf(Array.isArray(t)?t:t.toArray()),s=0,l=0;l<a.length;l++)0===i(a[l],e)&&s++;return s}})}),ek="setSymDifference",tk=vh(ek,["typed","size","concat","subset","setDifference","Index"],e=>{var{typed:t,size:n,concat:r,subset:i,setDifference:o,Index:a}=e;return t(ek,{"Array | Matrix, Array | Matrix":function(e,t){if(0===i(n(e),new a(0)))return Sf(t);if(0===i(n(t),new a(0)))return Sf(e);var s=Sf(e),l=Sf(t);return r(o(s,l),o(l,s))}})}),nk=vh("Spa",["addScalar","equalScalar","FibonacciHeap"],e=>{var{addScalar:t,equalScalar:n,FibonacciHeap:r}=e;function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new r}return i.prototype.type="Spa",i.prototype.isSpa=!0,i.prototype.set=function(e,t){if(this._values[e])this._values[e].value=t;else{var n=this._heap.insert(e,t);this._values[e]=n}},i.prototype.get=function(e){var t=this._values[e];return t?t.value:0},i.prototype.accumulate=function(e,n){var r=this._values[e];r?r.value=t(r.value,n):(r=this._heap.insert(e,n),this._values[e]=r)},i.prototype.forEach=function(e,t,r){var i=this._heap,o=this._values,a=[],s=i.extractMinimum();for(s&&a.push(s);s&&s.key<=t;)s.key>=e&&(n(s.value,0)||r(s.key,s.value,this)),(s=i.extractMinimum())&&a.push(s);for(var l=0;l<a.length;l++){var c=a[l];o[(s=i.insert(c.key,c.value)).key]=s}},i.prototype.swap=function(e,t){var n=this._values[e],r=this._values[t];if(!n&&r)n=this._heap.insert(e,r.value),this._heap.remove(r),this._values[e]=n,this._values[t]=void 0;else if(n&&!r)r=this._heap.insert(t,n.value),this._heap.remove(n),this._values[t]=r,this._values[e]=void 0;else if(n&&r){var i=n.value;n.value=r.value,r.value=i}},i},{isClass:!0}),rk=vh("inv",["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],e=>{var{typed:t,matrix:n,divideScalar:r,addScalar:i,multiply:o,unaryMinus:a,det:s,identity:l,abs:c}=e;return t("inv",{"Array | Matrix":function(e){var t=Pd(e)?e.size():sf(e);switch(t.length){case 1:if(1===t[0])return Pd(e)?n([r(1,e.valueOf()[0])]):[r(1,e[0])];throw new RangeError("Matrix must be square (size: "+Xh(t)+")");case 2:var i=t[0],o=t[1];if(i===o)return Pd(e)?n(u(e.valueOf(),i,o),e.storage()):u(e,i,o);throw new RangeError("Matrix must be square (size: "+Xh(t)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+Xh(t)+")")}},any:function(e){return r(1,e)}});function u(e,t,n){var u,d,h,f,m;if(1===t){if(0===(f=e[0][0]))throw Error("Cannot calculate inverse, determinant is zero");return[[r(1,f)]]}if(2===t){var p=s(e);if(0===p)throw Error("Cannot calculate inverse, determinant is zero");return[[r(e[1][1],p),r(a(e[0][1]),p)],[r(a(e[1][0]),p),r(e[0][0],p)]]}var g=e.concat();for(u=0;u<t;u++)g[u]=g[u].concat();for(var v=l(t).valueOf(),y=0;y<n;y++){var b=c(g[y][y]),w=y;for(u=y+1;u<t;)c(g[u][y])>b&&(b=c(g[u][y]),w=u),u++;if(0===b)throw Error("Cannot calculate inverse, determinant is zero");(u=w)!==y&&(m=g[y],g[y]=g[u],g[u]=m,m=v[y],v[y]=v[u],v[u]=m);var x=g[y],S=v[y];for(u=0;u<t;u++){var C=g[u],E=v[u];if(u!==y){if(0!==C[y]){for(h=r(a(C[y]),x[y]),d=y;d<n;d++)C[d]=i(C[d],o(h,x[d]));for(d=0;d<n;d++)E[d]=i(E[d],o(h,S[d]))}}else{for(h=x[y],d=y;d<n;d++)C[d]=r(C[d],h);for(d=0;d<n;d++)E[d]=r(E[d],h)}}}return v}}),ik=vh("lup",["typed","matrix","abs","addScalar","divideScalar","multiplyScalar","subtractScalar","larger","equalScalar","unaryMinus","DenseMatrix","SparseMatrix","Spa"],e=>{var{typed:t,matrix:n,abs:r,addScalar:i,divideScalar:o,multiplyScalar:a,subtractScalar:s,larger:l,equalScalar:c,unaryMinus:u,DenseMatrix:d,SparseMatrix:h,Spa:f}=e;return t("lup",{DenseMatrix:function(e){return m(e)},SparseMatrix:function(e){return p(e)},Array:function(e){var t=m(n(e));return{L:t.L.valueOf(),U:t.U.valueOf(),p:t.p}}});function m(e){var t,n,u,h=e._size[0],f=e._size[1],m=Math.min(h,f),p=hd(e._data),g=[],v=[h,m],y=[],b=[m,f],w=[];for(t=0;t<h;t++)w[t]=t;for(n=0;n<f;n++){if(n>0)for(t=0;t<h;t++){var x=Math.min(t,n),S=0;for(u=0;u<x;u++)S=i(S,a(p[t][u],p[u][n]));p[t][n]=s(p[t][n],S)}var C=n,E=0,N=0;for(t=n;t<h;t++){var T=p[t][n],A=r(T);l(A,E)&&(C=t,E=A,N=T)}if(n!==C&&(w[n]=[w[C],w[C]=w[n]][0],d._swapRows(n,C,p)),n<h)for(t=n+1;t<h;t++){var R=p[t][n];c(R,0)||(p[t][n]=o(p[t][n],N))}}for(n=0;n<f;n++)for(t=0;t<h;t++)0===n&&(t<f&&(y[t]=[]),g[t]=[]),t<n?(t<f&&(y[t][n]=p[t][n]),n<h&&(g[t][n]=0)):t!==n?(t<f&&(y[t][n]=0),n<h&&(g[t][n]=p[t][n])):(t<f&&(y[t][n]=p[t][n]),n<h&&(g[t][n]=1));var k=new d({data:g,size:v}),M=new d({data:y,size:b}),D=[];for(t=0,m=w.length;t<m;t++)D[w[t]]=t;return{L:k,U:M,p:D,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}function p(e){var t,n,i,s=e._size[0],d=e._size[1],m=Math.min(s,d),p=e._values,g=e._index,v=e._ptr,y=[],b=[],w=[],x=[s,m],S=[],C=[],E=[],N=[m,d],T=[],A=[];for(t=0;t<s;t++)T[t]=t,A[t]=t;var R=function(){var e=new f;n<s&&(w.push(y.length),y.push(1),b.push(n)),E.push(S.length);var d=v[n],m=v[n+1];for(i=d;i<m;i++)t=g[i],e.set(T[t],p[i]);n>0&&e.forEach(0,n-1,function(t,n){h._forEachRow(t,y,b,w,function(r,i){r>t&&e.accumulate(r,u(a(i,n)))})});var R=n,k=e.get(n),M=r(k);e.forEach(n+1,s-1,function(e,t){var n=r(t);l(n,M)&&(R=e,M=n,k=t)}),n!==R&&(h._swapRows(n,R,x[1],y,b,w),h._swapRows(n,R,N[1],S,C,E),e.swap(n,R),function(e,t){var n=A[e],r=A[t];T[n]=t,T[r]=e,A[e]=r,A[t]=n}(n,R)),e.forEach(0,s-1,function(e,t){e<=n?(S.push(t),C.push(e)):(t=o(t,k),c(t,0)||(y.push(t),b.push(e)))})};for(n=0;n<d;n++)R();return E.push(S.length),w.push(y.length),{L:new h({values:y,index:b,ptr:w,size:x}),U:new h({values:S,index:C,ptr:E,size:N}),p:T,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}}),ok="pinv",ak=vh(ok,["typed","matrix","inv","deepEqual","equal","dotDivide","dot","ctranspose","divideScalar","multiply","add","Complex"],e=>{var{typed:t,matrix:n,inv:r,deepEqual:i,equal:o,dotDivide:a,dot:s,ctranspose:l,divideScalar:c,multiply:u,add:d,Complex:h}=e;return t(ok,{"Array | Matrix":function(e){var t=Pd(e)?e.size():sf(e);switch(t.length){case 1:return p(e)?l(e):1===t[0]?r(e):a(l(e),s(e,e));case 2:if(p(e))return l(e);var i=t[0],o=t[1];if(i===o)try{return r(e)}catch(c){if(!(c instanceof Error&&c.message.match(/Cannot calculate inverse, determinant is zero/)))throw c}return Pd(e)?n(f(e.valueOf(),i,o),e.storage()):f(e,i,o);default:throw new RangeError("Matrix must be two dimensional (size: "+Xh(t)+")")}},any:function(e){return o(e,0)?hd(e):c(1,e)}});function f(e,t,n){var{C:i,F:o}=function(e,t,n){var r=function(e,t,n){for(var r=hd(e),i=0,o=0;o<t;o++){if(n<=i)return r;for(var s=o;m(r[s][i]);)if(t===++s&&(s=o,n===++i))return r;[r[s],r[o]]=[r[o],r[s]];for(var l=r[o][i],c=0;c<n;c++)r[o][c]=a(r[o][c],l);for(var h=0;h<t;h++)if(h!==o){l=r[h][i];for(var f=0;f<n;f++)r[h][f]=d(r[h][f],u(-1,u(l,r[o][f])))}i++}return r}(e,t,n),i=e.map((e,n)=>e.filter((e,n)=>n<t&&!m(s(r[n],r[n])))),o=r.filter((e,t)=>!m(s(r[t],r[t])));return{C:i,F:o}}(e,t,n),c=u(r(u(l(i),i)),l(i)),h=u(l(o),r(u(o,l(o))));return u(h,c)}function m(e){return o(d(e,h(1,1)),d(0,h(1,1)))}function p(e){return i(d(e,h(1,1)),d(u(e,0),h(1,1)))}}),sk=vh("pow",["typed","config","identity","multiply","matrix","inv","fraction","number","Complex"],e=>{var{typed:t,config:n,identity:r,multiply:i,matrix:o,inv:a,number:s,fraction:l,Complex:c}=e;return t("pow",{"number, number":u,"Complex, Complex":function(e,t){return e.pow(t)},"BigNumber, BigNumber":function(e,t){return t.isInteger()||e>=0||n.predictable?e.pow(t):new c(e.toNumber(),0).pow(t.toNumber(),0)},"bigint, bigint":(e,t)=>e**t,"Fraction, Fraction":function(e,t){var r=e.pow(t);if(null!=r)return r;if(n.predictable)throw new Error("Result of pow is non-rational and cannot be expressed as a fraction");return u(e.valueOf(),t.valueOf())},"Array, number":d,"Array, BigNumber":function(e,t){return d(e,t.toNumber())},"Matrix, number":h,"Matrix, BigNumber":function(e,t){return h(e,t.toNumber())},"Unit, number | BigNumber":function(e,t){return e.pow(t)}});function u(e,t){if(n.predictable&&!wh(t)&&e<0)try{var r=l(t),i=s(r);if((t===i||Math.abs((t-i)/t)<1e-14)&&r.d%2n===1n)return(r.n%2n===0n?1:-1)*Math.pow(-e,t)}catch(o){}return n.predictable&&(e<-1&&t===1/0||e>-1&&e<0&&t===-1/0)?NaN:wh(t)||e>=0||n.predictable?oS(e,t):e*e<1&&t===1/0||e*e>1&&t===-1/0?0:new c(e,0).pow(t,0)}function d(e,t){if(!wh(t))throw new TypeError("For A^b, b must be an integer (value is "+t+")");var n=sf(e);if(2!==n.length)throw new Error("For A^b, A must be 2 dimensional (A has "+n.length+" dimensions)");if(n[0]!==n[1])throw new Error("For A^b, A must be square (size is "+n[0]+"x"+n[1]+")");if(t<0)try{return d(a(e),-t)}catch(mW){if("Cannot calculate inverse, determinant is zero"===mW.message)throw new TypeError("For A^b, when A is not invertible, b must be a positive integer (value is "+t+")");throw mW}for(var o=r(n[0]).valueOf(),s=e;t>=1;)1===(1&t)&&(o=i(s,o)),t>>=1,s=i(s,s);return o}function h(e,t){return o(d(e.valueOf(),t))}}),lk="setIntersect",ck=vh(lk,["typed","size","subset","compareNatural","Index","DenseMatrix"],e=>{var{typed:t,size:n,subset:r,compareNatural:i,Index:o,DenseMatrix:a}=e;return t(lk,{"Array | Matrix, Array | Matrix":function(e,t){var s;if(0===r(n(e),new o(0))||0===r(n(t),new o(0)))s=[];else{var l=Rf(Sf(Array.isArray(e)?e:e.toArray()).sort(i)),c=Rf(Sf(Array.isArray(t)?t:t.toArray()).sort(i));s=[];for(var u=0;u<l.length;u++)for(var d=0;d<c.length;d++)if(0===i(l[u].value,c[d].value)&&l[u].identifier===c[d].identifier){s.push(l[u]);break}}return Array.isArray(e)&&Array.isArray(t)?kf(s):new a(kf(s))}})}),uk="setUnion",dk=vh(uk,["typed","size","concat","subset","setIntersect","setSymDifference","Index"],e=>{var{typed:t,size:n,concat:r,subset:i,setIntersect:o,setSymDifference:a,Index:s}=e;return t(uk,{"Array | Matrix, Array | Matrix":function(e,t){if(0===i(n(e),new s(0)))return Sf(t);if(0===i(n(t),new s(0)))return Sf(e);var l=Sf(e),c=Sf(t);return r(a(l,c),o(l,c))}})}),hk="sqrtm",fk=vh(hk,["typed","abs","add","multiply","map","sqrt","subtract","inv","size","max","identity"],e=>{var{typed:t,abs:n,add:r,multiply:i,map:o,sqrt:a,subtract:s,inv:l,size:c,max:u,identity:d}=e,h=1e-6;function f(e){var t,o=0,a=e,f=d(c(e));do{var m=a;if(a=i(.5,r(m,l(f))),f=i(.5,r(f,l(m))),(t=u(n(s(a,m))))>h&&++o>1e3)throw new Error("computing square root of matrix: iterative method could not converge")}while(t>h);return a}return t(hk,{"Array | Matrix":function(e){var t=Pd(e)?e.size():sf(e);switch(t.length){case 1:if(1===t[0])return o(e,a);throw new RangeError("Matrix must be square (size: "+Xh(t)+")");case 2:if(t[0]===t[1])return f(e);throw new RangeError("Matrix must be square (size: "+Xh(t)+")");default:throw new RangeError("Matrix must be at most two dimensional (size: "+Xh(t)+")")}}})});function mk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function pk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mk(Object(n),!0).forEach(function(t){S(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mk(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var gk=vh("Unit",["?on","config","addScalar","subtractScalar","multiplyScalar","divideScalar","pow","abs","fix","round","equal","isNumeric","format","toBest","number","Complex","BigNumber","Fraction"],e=>{var t,n,r,{on:i,config:o,addScalar:a,subtractScalar:s,multiplyScalar:l,divideScalar:c,pow:u,abs:d,fix:h,round:f,equal:m,isNumeric:p,format:g,toBest:v,number:y,Complex:b,BigNumber:w,Fraction:x}=e,S=y;function C(e,t){if(!(this instanceof C))throw new Error("Constructor must be called with the new operator");if(null!==e&&void 0!==e&&!p(e)&&!Md(e))throw new TypeError("First parameter in Unit constructor must be number, BigNumber, Fraction, Complex, or undefined");if(this.fixPrefix=!1,this.skipAutomaticSimplification=!0,void 0===t)this.units=[],this.dimensions=j.map(e=>0);else if("string"===typeof t){var n=C.parse(t);this.units=n.units,this.dimensions=n.dimensions}else{if(!_d(t)||null!==t.value)throw new TypeError("Second parameter in Unit constructor must be a string or valueless Unit");this.fixPrefix=t.fixPrefix,this.skipAutomaticSimplification=t.skipAutomaticSimplification,this.dimensions=t.dimensions.slice(0),this.units=t.units.map(e=>sd({},e))}this.value=this._normalize(e)}function E(){for(;" "===r||"\t"===r;)T()}function N(e){return e>="0"&&e<="9"}function T(){n++,r=t.charAt(n)}function A(e){n=e,r=t.charAt(n)}function R(){var e="",t=n;if("+"===r?T():"-"===r&&(e+=r,T()),!function(e){return e>="0"&&e<="9"||"."===e}(r))return A(t),null;if("."===r){if(e+=r,T(),!N(r))return A(t),null}else{for(;N(r);)e+=r,T();"."===r&&(e+=r,T())}for(;N(r);)e+=r,T();if("E"===r||"e"===r){var i="",o=n;if(i+=r,T(),"+"!==r&&"-"!==r||(i+=r,T()),!N(r))return A(o),e;for(e+=i;N(r);)e+=r,T()}return e}function k(){for(var e="";N(r)||C.isValidAlpha(r);)e+=r,T();var t=e.charAt(0);return C.isValidAlpha(t)?e:null}function M(e){return r===e?(T(),e):null}Object.defineProperty(C,"name",{value:"Unit"}),C.prototype.constructor=C,C.prototype.type="Unit",C.prototype.isUnit=!0,C.parse=function(e,i){if(i=i||{},n=-1,r="","string"!==typeof(t=e))throw new TypeError("Invalid argument in Unit.parse, string expected");var a=new C;a.units=[];var s=1,l=!1;T(),E();var c=R(),u=null;if(c){if("BigNumber"===o.number)u=new w(c);else if("Fraction"===o.number)try{u=new x(c)}catch(S){u=parseFloat(c)}else u=parseFloat(c);E(),M("*")?(s=1,l=!0):M("/")&&(s=-1,l=!0)}for(var d=[],h=1;;){for(E();"("===r;)d.push(s),h*=s,s=1,T(),E();var f=void 0;if(!r)break;var m=r;if(null===(f=k()))throw new SyntaxError('Unexpected "'+m+'" in "'+t+'" at index '+n.toString());var p=D(f);if(null===p)throw new SyntaxError('Unit "'+f+'" not found.');var g=s*h;if(E(),M("^")){E();var v=R();if(null===v)throw new SyntaxError('In "'+e+'", "^" must be followed by a floating-point number');g*=v}a.units.push({unit:p.unit,prefix:p.prefix,power:g});for(var y=0;y<j.length;y++)a.dimensions[y]+=(p.unit.dimensions[y]||0)*g;for(E();")"===r;){if(0===d.length)throw new SyntaxError('Unmatched ")" in "'+t+'" at index '+n.toString());h/=d.pop(),T(),E()}if(l=!1,M("*")?(s=1,l=!0):M("/")?(s=-1,l=!0):s=1,p.unit.base){var b=p.unit.base.key;V.auto[b]={unit:p.unit,prefix:p.prefix}}}if(E(),r)throw new SyntaxError('Could not parse: "'+e+'"');if(l)throw new SyntaxError('Trailing characters: "'+e+'"');if(0!==d.length)throw new SyntaxError('Unmatched "(" in "'+t+'"');if(0===a.units.length&&!i.allowNoUnits)throw new SyntaxError('"'+e+'" contains no units');return a.value=void 0!==u?a._normalize(u):null,a},C.prototype.clone=function(){var e=new C;e.fixPrefix=this.fixPrefix,e.skipAutomaticSimplification=this.skipAutomaticSimplification,e.value=hd(this.value),e.dimensions=this.dimensions.slice(0),e.units=[];for(var t=0;t<this.units.length;t++)for(var n in e.units[t]={},this.units[t])pd(this.units[t],n)&&(e.units[t][n]=this.units[t][n]);return e},C.prototype.valueType=function(){return ph(this.value)},C.prototype._isDerived=function(){return 0!==this.units.length&&(this.units.length>1||Math.abs(this.units[0].power-1)>1e-15)},C.prototype._normalize=function(e){if(null===e||void 0===e||0===this.units.length)return e;for(var t=e,n=C._getNumberConverter(ph(e)),r=0;r<this.units.length;r++){var i=n(this.units[r].unit.value),o=n(this.units[r].prefix.value),a=n(this.units[r].power);t=l(t,u(l(i,o),a))}return t},C.prototype._denormalize=function(e,t){if(null===e||void 0===e||0===this.units.length)return e;for(var n=e,r=C._getNumberConverter(ph(e)),i=0;i<this.units.length;i++){var o=r(this.units[i].unit.value),a=r(this.units[i].prefix.value),s=r(this.units[i].power);n=c(n,u(l(o,a),s))}return n};var D=Fb(e=>{if(pd(B,e)){var t=B[e];return{unit:t,prefix:t.prefixes[""]}}for(var n in B)if(pd(B,n)&&$h(e,n)){var r=B[n],i=e.length-n.length,o=e.substring(0,i),a=pd(r.prefixes,o)?r.prefixes[o]:void 0;if(void 0!==a)return{unit:r,prefix:a}}return null},{hasher:e=>e[0],limit:100});function _(e){return e.equalBase(F.NONE)&&null!==e.value&&!o.predictable?e.value:e}function O(e){return C._getNumberConverter(ph(e))(1)}function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.skipAutomaticSimplification||null===e.value?e.clone():e.simplify();!function(e){var t=!1;"undefined"!==typeof e.value&&null!==e.value&&Md(e.value)&&(t=Math.abs(e.value.re)<1e-14);for(var n in e.units)pd(e.units,n)&&e.units[n].unit&&("VA"===e.units[n].unit.name&&t?e.units[n].unit=B.VAR:"VAR"!==e.units[n].unit.name||t||(e.units[n].unit=B.VA))}(n),function(e,t){1!==e.units.length||e.fixPrefix||Math.abs(e.units[0].power-Math.round(e.units[0].power))<1e-14&&(e.units[0].prefix=e._bestPrefix(t))}(n,t.offset);var r=n._denormalize(n.value),i=null!==n.value?g(r,t||{}):"",o=n.formatUnits();return{simp:n,valueStr:i,unitStr:o}}C.isValuelessUnit=function(e){return null!==D(e)},C.prototype.hasBase=function(e){if("string"===typeof e&&(e=F[e]),!e)return!1;for(var t=0;t<j.length;t++)if(Math.abs((this.dimensions[t]||0)-(e.dimensions[t]||0))>1e-12)return!1;return!0},C.prototype.equalBase=function(e){for(var t=0;t<j.length;t++)if(Math.abs((this.dimensions[t]||0)-(e.dimensions[t]||0))>1e-12)return!1;return!0},C.prototype.equals=function(e){return this.equalBase(e)&&m(this.value,e.value)},C.prototype.multiply=function(e){for(var t=this.clone(),n=_d(e)?e:new C(e),r=0;r<j.length;r++)t.dimensions[r]=(this.dimensions[r]||0)+(n.dimensions[r]||0);for(var i=0;i<n.units.length;i++){var o=pk({},n.units[i]);t.units.push(o)}if(null!==this.value||null!==n.value){var a=null===this.value?this._normalize(O(n.value)):this.value,s=null===n.value?n._normalize(O(this.value)):n.value;t.value=l(a,s)}else t.value=null;return _d(e)&&(t.skipAutomaticSimplification=!1),_(t)},C.prototype.divideInto=function(e){return new C(e).divide(this)},C.prototype.divide=function(e){for(var t=this.clone(),n=_d(e)?e:new C(e),r=0;r<j.length;r++)t.dimensions[r]=(this.dimensions[r]||0)-(n.dimensions[r]||0);for(var i=0;i<n.units.length;i++){var o=pk(pk({},n.units[i]),{},{power:-n.units[i].power});t.units.push(o)}if(null!==this.value||null!==n.value){var a=null===this.value?this._normalize(O(n.value)):this.value,s=null===n.value?n._normalize(O(this.value)):n.value;t.value=c(a,s)}else t.value=null;return _d(e)&&(t.skipAutomaticSimplification=!1),_(t)},C.prototype.pow=function(e){for(var t=this.clone(),n=0;n<j.length;n++)t.dimensions[n]=(this.dimensions[n]||0)*e;for(var r=0;r<t.units.length;r++)t.units[r].power*=e;return null!==t.value?t.value=u(t.value,e):t.value=null,t.skipAutomaticSimplification=!1,_(t)},C.prototype.abs=function(){var e=this.clone();if(null!==e.value)if(e._isDerived()||0===e.units.length||0===e.units[0].unit.offset)e.value=d(e.value);else{var t=e._numberConverter(),n=t(e.units[0].unit.value),r=t(e.units[0].unit.offset),i=l(n,r);e.value=s(d(a(e.value,i)),i)}for(var o in e.units)"VA"!==e.units[o].unit.name&&"VAR"!==e.units[o].unit.name||(e.units[o].unit=B.W);return e},C.prototype.to=function(e){var t,n=null===this.value?this._normalize(1):this.value;if("string"===typeof e)t=C.parse(e);else{if(!_d(e))throw new Error("String or Unit expected as parameter");t=e.clone()}if(!this.equalBase(t))throw new Error("Units do not match ('".concat(t.toString(),"' != '").concat(this.toString(),"')"));if(null!==t.value)throw new Error("Cannot convert to a unit with a value");if(null===this.value||this._isDerived()||0===this.units.length||0===t.units.length||this.units[0].unit.offset===t.units[0].unit.offset)t.value=hd(n);else{var r=C._getNumberConverter(ph(n)),i=this.units[0].unit.value,o=this.units[0].unit.offset,c=l(i,o),u=t.units[0].unit.value,d=t.units[0].unit.offset,h=l(u,d);t.value=a(n,r(s(c,h)))}return t.fixPrefix=!0,t.skipAutomaticSimplification=!0,t},C.prototype.toNumber=function(e){return S(this.toNumeric(e))},C.prototype.toNumeric=function(e){var t;return(t=e?this.to(e):this.clone())._isDerived()||0===t.units.length?t._denormalize(t.value):t._denormalize(t.value,t.units[0].prefix.value)},C.prototype.toString=function(){return this.format()},C.prototype.toJSON=function(){return{mathjs:"Unit",value:this._denormalize(this.value),unit:this.units.length>0?this.formatUnits():null,fixPrefix:this.fixPrefix}},C.fromJSON=function(e){var t,n=new C(e.value,null!==(t=e.unit)&&void 0!==t?t:void 0);return n.fixPrefix=e.fixPrefix||!1,n},C.prototype.valueOf=C.prototype.toString,C.prototype.simplify=function(){var e,t,n=this.clone(),r=[];for(var i in U)if(pd(U,i)&&n.hasBase(F[i])){e=i;break}if("NONE"===e)n.units=[];else if(e&&pd(U,e)&&(t=U[e]),t)n.units=[{unit:t.unit,prefix:t.prefix,power:1}];else{for(var o=!1,a=0;a<j.length;a++){var s=j[a];Math.abs(n.dimensions[a]||0)>1e-12&&(pd(U,s)?r.push({unit:U[s].unit,prefix:U[s].prefix,power:n.dimensions[a]||0}):o=!0)}r.length<n.units.length&&!o&&(n.units=r)}return n},C.prototype.toSI=function(){for(var e=this.clone(),t=[],n=0;n<j.length;n++){var r=j[n];if(Math.abs(e.dimensions[n]||0)>1e-12){if(!pd(V.si,r))throw new Error("Cannot express custom unit "+r+" in SI units");t.push({unit:V.si[r].unit,prefix:V.si[r].prefix,power:e.dimensions[n]||0})}}return e.units=t,e.fixPrefix=!0,e.skipAutomaticSimplification=!0,null!==this.value?(e.value=null,this.to(e)):e},C.prototype.formatUnits=function(){for(var e="",t="",n=0,r=0,i=0;i<this.units.length;i++)this.units[i].power>0?(n++,e+=" "+this.units[i].prefix.name+this.units[i].unit.name,Math.abs(this.units[i].power-1)>1e-15&&(e+="^"+this.units[i].power)):this.units[i].power<0&&r++;if(r>0)for(var o=0;o<this.units.length;o++)this.units[o].power<0&&(n>0?(t+=" "+this.units[o].prefix.name+this.units[o].unit.name,Math.abs(this.units[o].power+1)>1e-15&&(t+="^"+-this.units[o].power)):(t+=" "+this.units[o].prefix.name+this.units[o].unit.name,t+="^"+this.units[o].power));e=e.substr(1),t=t.substr(1),n>1&&r>0&&(e="("+e+")"),r>1&&n>0&&(t="("+t+")");var a=e;return n>0&&r>0&&(a+=" / "),a+=t},C.prototype.toBest=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&!Array.isArray(e))throw new Error("Invalid unit type. Expected string or Unit.");var n=this.units[0].unit.prefixes;if(e&&e.length>0){var r=e.map(e=>{var t=null;if("string"===typeof e){if(!(t=C.parse(e)))throw new Error("Invalid unit type. Expected compatible string or Unit.")}else if(!_d(e))throw new Error("Invalid unit type. Expected compatible string or Unit.");null===t&&(t=e.clone());try{return this.to(t.formatUnits()),t}catch(qb){throw new Error("Invalid unit type. Expected compatible string or Unit.")}}),i=r.map(e=>e.units[0].prefix);this.units[0].unit.prefixes=i.reduce((e,t)=>(e[t.name]=t,e),{}),this.units[0].prefix=i[0]}var o=I(this,t).simp;return this.units[0].unit.prefixes=n,o.fixPrefix=!0,o},C.prototype.format=function(e){var{simp:t,valueStr:n,unitStr:r}=I(this,e),i=n;return t.value&&Md(t.value)&&(i="("+i+")"),r.length>0&&i.length>0&&(i+=" "),i+=r},C.prototype._bestPrefix=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1.2;if(1!==this.units.length)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");if(Math.abs(this.units[0].power-Math.round(this.units[0].power))>=1e-14)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");var t=null!==this.value?d(this.value):0,n=d(this.units[0].unit.value),r=this.units[0].prefix;if(0===t)return r;var i=this.units[0].power,o=Math.log(t/Math.pow(r.value*n,i))/Math.LN10-e;if(o>-2.200001&&o<1.800001)return r;o=Math.abs(o);var a=this.units[0].unit.prefixes;for(var s in a)if(pd(a,s)){var l=a[s];if(l.scientific){var c=Math.abs(Math.log(t/Math.pow(l.value*n,i))/Math.LN10-e);(c<o||c===o&&l.name.length<r.name.length)&&(r=l,o=c)}}return r},C.prototype.splitUnit=function(e){for(var t=this.clone(),n=[],r=0;r<e.length&&(t=t.to(e[r]),r!==e.length-1);r++){var i=t.toNumeric(),o=f(i),l=new C(m(o,i)?o:h(t.toNumeric()),e[r].toString());n.push(l),t=s(t,l)}for(var c=0,u=0;u<n.length;u++)c=a(c,n[u].value);return m(c,this.value)&&(t.value=0),n.push(t),n};var P={NONE:{"":{name:"",value:1,scientific:!0}},SHORT:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:10,scientific:!1},h:{name:"h",value:100,scientific:!1},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},R:{name:"R",value:1e27,scientific:!0},Q:{name:"Q",value:1e30,scientific:!0},d:{name:"d",value:.1,scientific:!1},c:{name:"c",value:.01,scientific:!1},m:{name:"m",value:.001,scientific:!0},u:{name:"u",value:1e-6,scientific:!0},n:{name:"n",value:1e-9,scientific:!0},p:{name:"p",value:1e-12,scientific:!0},f:{name:"f",value:1e-15,scientific:!0},a:{name:"a",value:1e-18,scientific:!0},z:{name:"z",value:1e-21,scientific:!0},y:{name:"y",value:1e-24,scientific:!0},r:{name:"r",value:1e-27,scientific:!0},q:{name:"q",value:1e-30,scientific:!0}},LONG:{"":{name:"",value:1,scientific:!0},deca:{name:"deca",value:10,scientific:!1},hecto:{name:"hecto",value:100,scientific:!1},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},ronna:{name:"ronna",value:1e27,scientific:!0},quetta:{name:"quetta",value:1e30,scientific:!0},deci:{name:"deci",value:.1,scientific:!1},centi:{name:"centi",value:.01,scientific:!1},milli:{name:"milli",value:.001,scientific:!0},micro:{name:"micro",value:1e-6,scientific:!0},nano:{name:"nano",value:1e-9,scientific:!0},pico:{name:"pico",value:1e-12,scientific:!0},femto:{name:"femto",value:1e-15,scientific:!0},atto:{name:"atto",value:1e-18,scientific:!0},zepto:{name:"zepto",value:1e-21,scientific:!0},yocto:{name:"yocto",value:1e-24,scientific:!0},ronto:{name:"ronto",value:1e-27,scientific:!0},quecto:{name:"quecto",value:1e-30,scientific:!0}},SQUARED:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:100,scientific:!1},h:{name:"h",value:1e4,scientific:!1},k:{name:"k",value:1e6,scientific:!0},M:{name:"M",value:1e12,scientific:!0},G:{name:"G",value:1e18,scientific:!0},T:{name:"T",value:1e24,scientific:!0},P:{name:"P",value:1e30,scientific:!0},E:{name:"E",value:1e36,scientific:!0},Z:{name:"Z",value:1e42,scientific:!0},Y:{name:"Y",value:1e48,scientific:!0},R:{name:"R",value:1e54,scientific:!0},Q:{name:"Q",value:1e60,scientific:!0},d:{name:"d",value:.01,scientific:!1},c:{name:"c",value:1e-4,scientific:!1},m:{name:"m",value:1e-6,scientific:!0},u:{name:"u",value:1e-12,scientific:!0},n:{name:"n",value:1e-18,scientific:!0},p:{name:"p",value:1e-24,scientific:!0},f:{name:"f",value:1e-30,scientific:!0},a:{name:"a",value:1e-36,scientific:!0},z:{name:"z",value:1e-42,scientific:!0},y:{name:"y",value:1e-48,scientific:!0},r:{name:"r",value:1e-54,scientific:!0},q:{name:"q",value:1e-60,scientific:!0}},CUBIC:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:1e3,scientific:!1},h:{name:"h",value:1e6,scientific:!1},k:{name:"k",value:1e9,scientific:!0},M:{name:"M",value:1e18,scientific:!0},G:{name:"G",value:1e27,scientific:!0},T:{name:"T",value:1e36,scientific:!0},P:{name:"P",value:1e45,scientific:!0},E:{name:"E",value:1e54,scientific:!0},Z:{name:"Z",value:1e63,scientific:!0},Y:{name:"Y",value:1e72,scientific:!0},R:{name:"R",value:1e81,scientific:!0},Q:{name:"Q",value:1e90,scientific:!0},d:{name:"d",value:.001,scientific:!1},c:{name:"c",value:1e-6,scientific:!1},m:{name:"m",value:1e-9,scientific:!0},u:{name:"u",value:1e-18,scientific:!0},n:{name:"n",value:1e-27,scientific:!0},p:{name:"p",value:1e-36,scientific:!0},f:{name:"f",value:1e-45,scientific:!0},a:{name:"a",value:1e-54,scientific:!0},z:{name:"z",value:1e-63,scientific:!0},y:{name:"y",value:1e-72,scientific:!0},r:{name:"r",value:1e-81,scientific:!0},q:{name:"q",value:1e-90,scientific:!0}},BINARY_SHORT_SI:{"":{name:"",value:1,scientific:!0},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0}},BINARY_SHORT_IEC:{"":{name:"",value:1,scientific:!0},Ki:{name:"Ki",value:1024,scientific:!0},Mi:{name:"Mi",value:Math.pow(1024,2),scientific:!0},Gi:{name:"Gi",value:Math.pow(1024,3),scientific:!0},Ti:{name:"Ti",value:Math.pow(1024,4),scientific:!0},Pi:{name:"Pi",value:Math.pow(1024,5),scientific:!0},Ei:{name:"Ei",value:Math.pow(1024,6),scientific:!0},Zi:{name:"Zi",value:Math.pow(1024,7),scientific:!0},Yi:{name:"Yi",value:Math.pow(1024,8),scientific:!0}},BINARY_LONG_SI:{"":{name:"",value:1,scientific:!0},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0}},BINARY_LONG_IEC:{"":{name:"",value:1,scientific:!0},kibi:{name:"kibi",value:1024,scientific:!0},mebi:{name:"mebi",value:Math.pow(1024,2),scientific:!0},gibi:{name:"gibi",value:Math.pow(1024,3),scientific:!0},tebi:{name:"tebi",value:Math.pow(1024,4),scientific:!0},pebi:{name:"pebi",value:Math.pow(1024,5),scientific:!0},exi:{name:"exi",value:Math.pow(1024,6),scientific:!0},zebi:{name:"zebi",value:Math.pow(1024,7),scientific:!0},yobi:{name:"yobi",value:Math.pow(1024,8),scientific:!0}},BTU:{"":{name:"",value:1,scientific:!0},MM:{name:"MM",value:1e6,scientific:!0}}};P.SHORTLONG=sd({},P.SHORT,P.LONG),P.BINARY_SHORT=sd({},P.BINARY_SHORT_SI,P.BINARY_SHORT_IEC),P.BINARY_LONG=sd({},P.BINARY_LONG_SI,P.BINARY_LONG_IEC);var j=["MASS","LENGTH","TIME","CURRENT","TEMPERATURE","LUMINOUS_INTENSITY","AMOUNT_OF_SUBSTANCE","ANGLE","BIT"],F={NONE:{dimensions:[0,0,0,0,0,0,0,0,0]},MASS:{dimensions:[1,0,0,0,0,0,0,0,0]},LENGTH:{dimensions:[0,1,0,0,0,0,0,0,0]},TIME:{dimensions:[0,0,1,0,0,0,0,0,0]},CURRENT:{dimensions:[0,0,0,1,0,0,0,0,0]},TEMPERATURE:{dimensions:[0,0,0,0,1,0,0,0,0]},LUMINOUS_INTENSITY:{dimensions:[0,0,0,0,0,1,0,0,0]},AMOUNT_OF_SUBSTANCE:{dimensions:[0,0,0,0,0,0,1,0,0]},FORCE:{dimensions:[1,1,-2,0,0,0,0,0,0]},SURFACE:{dimensions:[0,2,0,0,0,0,0,0,0]},VOLUME:{dimensions:[0,3,0,0,0,0,0,0,0]},ENERGY:{dimensions:[1,2,-2,0,0,0,0,0,0]},POWER:{dimensions:[1,2,-3,0,0,0,0,0,0]},PRESSURE:{dimensions:[1,-1,-2,0,0,0,0,0,0]},ELECTRIC_CHARGE:{dimensions:[0,0,1,1,0,0,0,0,0]},ELECTRIC_CAPACITANCE:{dimensions:[-1,-2,4,2,0,0,0,0,0]},ELECTRIC_POTENTIAL:{dimensions:[1,2,-3,-1,0,0,0,0,0]},ELECTRIC_RESISTANCE:{dimensions:[1,2,-3,-2,0,0,0,0,0]},ELECTRIC_INDUCTANCE:{dimensions:[1,2,-2,-2,0,0,0,0,0]},ELECTRIC_CONDUCTANCE:{dimensions:[-1,-2,3,2,0,0,0,0,0]},MAGNETIC_FLUX:{dimensions:[1,2,-2,-1,0,0,0,0,0]},MAGNETIC_FLUX_DENSITY:{dimensions:[1,0,-2,-1,0,0,0,0,0]},FREQUENCY:{dimensions:[0,0,-1,0,0,0,0,0,0]},ANGLE:{dimensions:[0,0,0,0,0,0,0,1,0]},BIT:{dimensions:[0,0,0,0,0,0,0,0,1]}};for(var H in F)pd(F,H)&&(F[H].key=H);var L={name:"",base:{},value:1,offset:0,dimensions:j.map(e=>0)},B={meter:{name:"meter",base:F.LENGTH,prefixes:P.LONG,value:1,offset:0},inch:{name:"inch",base:F.LENGTH,prefixes:P.NONE,value:.0254,offset:0},foot:{name:"foot",base:F.LENGTH,prefixes:P.NONE,value:.3048,offset:0},yard:{name:"yard",base:F.LENGTH,prefixes:P.NONE,value:.9144,offset:0},mile:{name:"mile",base:F.LENGTH,prefixes:P.NONE,value:1609.344,offset:0},link:{name:"link",base:F.LENGTH,prefixes:P.NONE,value:.201168,offset:0},rod:{name:"rod",base:F.LENGTH,prefixes:P.NONE,value:5.0292,offset:0},chain:{name:"chain",base:F.LENGTH,prefixes:P.NONE,value:20.1168,offset:0},angstrom:{name:"angstrom",base:F.LENGTH,prefixes:P.NONE,value:1e-10,offset:0},m:{name:"m",base:F.LENGTH,prefixes:P.SHORT,value:1,offset:0},in:{name:"in",base:F.LENGTH,prefixes:P.NONE,value:.0254,offset:0},ft:{name:"ft",base:F.LENGTH,prefixes:P.NONE,value:.3048,offset:0},yd:{name:"yd",base:F.LENGTH,prefixes:P.NONE,value:.9144,offset:0},mi:{name:"mi",base:F.LENGTH,prefixes:P.NONE,value:1609.344,offset:0},li:{name:"li",base:F.LENGTH,prefixes:P.NONE,value:.201168,offset:0},rd:{name:"rd",base:F.LENGTH,prefixes:P.NONE,value:5.02921,offset:0},ch:{name:"ch",base:F.LENGTH,prefixes:P.NONE,value:20.1168,offset:0},mil:{name:"mil",base:F.LENGTH,prefixes:P.NONE,value:254e-7,offset:0},m2:{name:"m2",base:F.SURFACE,prefixes:P.SQUARED,value:1,offset:0},sqin:{name:"sqin",base:F.SURFACE,prefixes:P.NONE,value:64516e-8,offset:0},sqft:{name:"sqft",base:F.SURFACE,prefixes:P.NONE,value:.09290304,offset:0},sqyd:{name:"sqyd",base:F.SURFACE,prefixes:P.NONE,value:.83612736,offset:0},sqmi:{name:"sqmi",base:F.SURFACE,prefixes:P.NONE,value:2589988.110336,offset:0},sqrd:{name:"sqrd",base:F.SURFACE,prefixes:P.NONE,value:25.29295,offset:0},sqch:{name:"sqch",base:F.SURFACE,prefixes:P.NONE,value:404.6873,offset:0},sqmil:{name:"sqmil",base:F.SURFACE,prefixes:P.NONE,value:6.4516e-10,offset:0},acre:{name:"acre",base:F.SURFACE,prefixes:P.NONE,value:4046.86,offset:0},hectare:{name:"hectare",base:F.SURFACE,prefixes:P.NONE,value:1e4,offset:0},m3:{name:"m3",base:F.VOLUME,prefixes:P.CUBIC,value:1,offset:0},L:{name:"L",base:F.VOLUME,prefixes:P.SHORT,value:.001,offset:0},l:{name:"l",base:F.VOLUME,prefixes:P.SHORT,value:.001,offset:0},litre:{name:"litre",base:F.VOLUME,prefixes:P.LONG,value:.001,offset:0},cuin:{name:"cuin",base:F.VOLUME,prefixes:P.NONE,value:16387064e-12,offset:0},cuft:{name:"cuft",base:F.VOLUME,prefixes:P.NONE,value:.028316846592,offset:0},cuyd:{name:"cuyd",base:F.VOLUME,prefixes:P.NONE,value:.764554857984,offset:0},teaspoon:{name:"teaspoon",base:F.VOLUME,prefixes:P.NONE,value:5e-6,offset:0},tablespoon:{name:"tablespoon",base:F.VOLUME,prefixes:P.NONE,value:15e-6,offset:0},drop:{name:"drop",base:F.VOLUME,prefixes:P.NONE,value:5e-8,offset:0},gtt:{name:"gtt",base:F.VOLUME,prefixes:P.NONE,value:5e-8,offset:0},minim:{name:"minim",base:F.VOLUME,prefixes:P.NONE,value:6.1611519921875e-8,offset:0},fluiddram:{name:"fluiddram",base:F.VOLUME,prefixes:P.NONE,value:36966911953125e-19,offset:0},fluidounce:{name:"fluidounce",base:F.VOLUME,prefixes:P.NONE,value:295735295625e-16,offset:0},gill:{name:"gill",base:F.VOLUME,prefixes:P.NONE,value:.00011829411825,offset:0},cc:{name:"cc",base:F.VOLUME,prefixes:P.NONE,value:1e-6,offset:0},cup:{name:"cup",base:F.VOLUME,prefixes:P.NONE,value:.0002365882365,offset:0},pint:{name:"pint",base:F.VOLUME,prefixes:P.NONE,value:.000473176473,offset:0},quart:{name:"quart",base:F.VOLUME,prefixes:P.NONE,value:.000946352946,offset:0},gallon:{name:"gallon",base:F.VOLUME,prefixes:P.NONE,value:.003785411784,offset:0},beerbarrel:{name:"beerbarrel",base:F.VOLUME,prefixes:P.NONE,value:.117347765304,offset:0},oilbarrel:{name:"oilbarrel",base:F.VOLUME,prefixes:P.NONE,value:.158987294928,offset:0},hogshead:{name:"hogshead",base:F.VOLUME,prefixes:P.NONE,value:.238480942392,offset:0},g:{name:"g",base:F.MASS,prefixes:P.SHORT,value:.001,offset:0},gram:{name:"gram",base:F.MASS,prefixes:P.LONG,value:.001,offset:0},ton:{name:"ton",base:F.MASS,prefixes:P.SHORT,value:907.18474,offset:0},t:{name:"t",base:F.MASS,prefixes:P.SHORT,value:1e3,offset:0},tonne:{name:"tonne",base:F.MASS,prefixes:P.LONG,value:1e3,offset:0},grain:{name:"grain",base:F.MASS,prefixes:P.NONE,value:6479891e-11,offset:0},dram:{name:"dram",base:F.MASS,prefixes:P.NONE,value:.0017718451953125,offset:0},ounce:{name:"ounce",base:F.MASS,prefixes:P.NONE,value:.028349523125,offset:0},poundmass:{name:"poundmass",base:F.MASS,prefixes:P.NONE,value:.45359237,offset:0},hundredweight:{name:"hundredweight",base:F.MASS,prefixes:P.NONE,value:45.359237,offset:0},stick:{name:"stick",base:F.MASS,prefixes:P.NONE,value:.115,offset:0},stone:{name:"stone",base:F.MASS,prefixes:P.NONE,value:6.35029318,offset:0},gr:{name:"gr",base:F.MASS,prefixes:P.NONE,value:6479891e-11,offset:0},dr:{name:"dr",base:F.MASS,prefixes:P.NONE,value:.0017718451953125,offset:0},oz:{name:"oz",base:F.MASS,prefixes:P.NONE,value:.028349523125,offset:0},lbm:{name:"lbm",base:F.MASS,prefixes:P.NONE,value:.45359237,offset:0},cwt:{name:"cwt",base:F.MASS,prefixes:P.NONE,value:45.359237,offset:0},s:{name:"s",base:F.TIME,prefixes:P.SHORT,value:1,offset:0},min:{name:"min",base:F.TIME,prefixes:P.NONE,value:60,offset:0},h:{name:"h",base:F.TIME,prefixes:P.NONE,value:3600,offset:0},second:{name:"second",base:F.TIME,prefixes:P.LONG,value:1,offset:0},sec:{name:"sec",base:F.TIME,prefixes:P.LONG,value:1,offset:0},minute:{name:"minute",base:F.TIME,prefixes:P.NONE,value:60,offset:0},hour:{name:"hour",base:F.TIME,prefixes:P.NONE,value:3600,offset:0},day:{name:"day",base:F.TIME,prefixes:P.NONE,value:86400,offset:0},week:{name:"week",base:F.TIME,prefixes:P.NONE,value:604800,offset:0},month:{name:"month",base:F.TIME,prefixes:P.NONE,value:2629800,offset:0},year:{name:"year",base:F.TIME,prefixes:P.NONE,value:31557600,offset:0},decade:{name:"decade",base:F.TIME,prefixes:P.NONE,value:315576e3,offset:0},century:{name:"century",base:F.TIME,prefixes:P.NONE,value:315576e4,offset:0},millennium:{name:"millennium",base:F.TIME,prefixes:P.NONE,value:315576e5,offset:0},hertz:{name:"Hertz",base:F.FREQUENCY,prefixes:P.LONG,value:1,offset:0,reciprocal:!0},Hz:{name:"Hz",base:F.FREQUENCY,prefixes:P.SHORT,value:1,offset:0,reciprocal:!0},rad:{name:"rad",base:F.ANGLE,prefixes:P.SHORT,value:1,offset:0},radian:{name:"radian",base:F.ANGLE,prefixes:P.LONG,value:1,offset:0},deg:{name:"deg",base:F.ANGLE,prefixes:P.SHORT,value:null,offset:0},degree:{name:"degree",base:F.ANGLE,prefixes:P.LONG,value:null,offset:0},grad:{name:"grad",base:F.ANGLE,prefixes:P.SHORT,value:null,offset:0},gradian:{name:"gradian",base:F.ANGLE,prefixes:P.LONG,value:null,offset:0},cycle:{name:"cycle",base:F.ANGLE,prefixes:P.NONE,value:null,offset:0},arcsec:{name:"arcsec",base:F.ANGLE,prefixes:P.NONE,value:null,offset:0},arcmin:{name:"arcmin",base:F.ANGLE,prefixes:P.NONE,value:null,offset:0},A:{name:"A",base:F.CURRENT,prefixes:P.SHORT,value:1,offset:0},ampere:{name:"ampere",base:F.CURRENT,prefixes:P.LONG,value:1,offset:0},K:{name:"K",base:F.TEMPERATURE,prefixes:P.SHORT,value:1,offset:0},degC:{name:"degC",base:F.TEMPERATURE,prefixes:P.SHORT,value:1,offset:273.15},degF:{name:"degF",base:F.TEMPERATURE,prefixes:P.SHORT,value:new x(5,9),offset:459.67},degR:{name:"degR",base:F.TEMPERATURE,prefixes:P.SHORT,value:new x(5,9),offset:0},kelvin:{name:"kelvin",base:F.TEMPERATURE,prefixes:P.LONG,value:1,offset:0},celsius:{name:"celsius",base:F.TEMPERATURE,prefixes:P.LONG,value:1,offset:273.15},fahrenheit:{name:"fahrenheit",base:F.TEMPERATURE,prefixes:P.LONG,value:new x(5,9),offset:459.67},rankine:{name:"rankine",base:F.TEMPERATURE,prefixes:P.LONG,value:new x(5,9),offset:0},mol:{name:"mol",base:F.AMOUNT_OF_SUBSTANCE,prefixes:P.SHORT,value:1,offset:0},mole:{name:"mole",base:F.AMOUNT_OF_SUBSTANCE,prefixes:P.LONG,value:1,offset:0},cd:{name:"cd",base:F.LUMINOUS_INTENSITY,prefixes:P.SHORT,value:1,offset:0},candela:{name:"candela",base:F.LUMINOUS_INTENSITY,prefixes:P.LONG,value:1,offset:0},N:{name:"N",base:F.FORCE,prefixes:P.SHORT,value:1,offset:0},newton:{name:"newton",base:F.FORCE,prefixes:P.LONG,value:1,offset:0},dyn:{name:"dyn",base:F.FORCE,prefixes:P.SHORT,value:1e-5,offset:0},dyne:{name:"dyne",base:F.FORCE,prefixes:P.LONG,value:1e-5,offset:0},lbf:{name:"lbf",base:F.FORCE,prefixes:P.NONE,value:4.4482216152605,offset:0},poundforce:{name:"poundforce",base:F.FORCE,prefixes:P.NONE,value:4.4482216152605,offset:0},kip:{name:"kip",base:F.FORCE,prefixes:P.LONG,value:4448.2216,offset:0},kilogramforce:{name:"kilogramforce",base:F.FORCE,prefixes:P.NONE,value:9.80665,offset:0},J:{name:"J",base:F.ENERGY,prefixes:P.SHORT,value:1,offset:0},joule:{name:"joule",base:F.ENERGY,prefixes:P.LONG,value:1,offset:0},erg:{name:"erg",base:F.ENERGY,prefixes:P.SHORTLONG,value:1e-7,offset:0},Wh:{name:"Wh",base:F.ENERGY,prefixes:P.SHORT,value:3600,offset:0},BTU:{name:"BTU",base:F.ENERGY,prefixes:P.BTU,value:1055.05585262,offset:0},eV:{name:"eV",base:F.ENERGY,prefixes:P.SHORT,value:1602176565e-28,offset:0},electronvolt:{name:"electronvolt",base:F.ENERGY,prefixes:P.LONG,value:1602176565e-28,offset:0},W:{name:"W",base:F.POWER,prefixes:P.SHORT,value:1,offset:0},watt:{name:"watt",base:F.POWER,prefixes:P.LONG,value:1,offset:0},hp:{name:"hp",base:F.POWER,prefixes:P.NONE,value:745.6998715386,offset:0},VAR:{name:"VAR",base:F.POWER,prefixes:P.SHORT,value:b.I,offset:0},VA:{name:"VA",base:F.POWER,prefixes:P.SHORT,value:1,offset:0},Pa:{name:"Pa",base:F.PRESSURE,prefixes:P.SHORT,value:1,offset:0},psi:{name:"psi",base:F.PRESSURE,prefixes:P.NONE,value:6894.75729276459,offset:0},atm:{name:"atm",base:F.PRESSURE,prefixes:P.NONE,value:101325,offset:0},bar:{name:"bar",base:F.PRESSURE,prefixes:P.SHORTLONG,value:1e5,offset:0},torr:{name:"torr",base:F.PRESSURE,prefixes:P.NONE,value:133.322,offset:0},mmHg:{name:"mmHg",base:F.PRESSURE,prefixes:P.NONE,value:133.322,offset:0},mmH2O:{name:"mmH2O",base:F.PRESSURE,prefixes:P.NONE,value:9.80665,offset:0},cmH2O:{name:"cmH2O",base:F.PRESSURE,prefixes:P.NONE,value:98.0665,offset:0},coulomb:{name:"coulomb",base:F.ELECTRIC_CHARGE,prefixes:P.LONG,value:1,offset:0},C:{name:"C",base:F.ELECTRIC_CHARGE,prefixes:P.SHORT,value:1,offset:0},farad:{name:"farad",base:F.ELECTRIC_CAPACITANCE,prefixes:P.LONG,value:1,offset:0},F:{name:"F",base:F.ELECTRIC_CAPACITANCE,prefixes:P.SHORT,value:1,offset:0},volt:{name:"volt",base:F.ELECTRIC_POTENTIAL,prefixes:P.LONG,value:1,offset:0},V:{name:"V",base:F.ELECTRIC_POTENTIAL,prefixes:P.SHORT,value:1,offset:0},ohm:{name:"ohm",base:F.ELECTRIC_RESISTANCE,prefixes:P.SHORTLONG,value:1,offset:0},henry:{name:"henry",base:F.ELECTRIC_INDUCTANCE,prefixes:P.LONG,value:1,offset:0},H:{name:"H",base:F.ELECTRIC_INDUCTANCE,prefixes:P.SHORT,value:1,offset:0},siemens:{name:"siemens",base:F.ELECTRIC_CONDUCTANCE,prefixes:P.LONG,value:1,offset:0},S:{name:"S",base:F.ELECTRIC_CONDUCTANCE,prefixes:P.SHORT,value:1,offset:0},weber:{name:"weber",base:F.MAGNETIC_FLUX,prefixes:P.LONG,value:1,offset:0},Wb:{name:"Wb",base:F.MAGNETIC_FLUX,prefixes:P.SHORT,value:1,offset:0},tesla:{name:"tesla",base:F.MAGNETIC_FLUX_DENSITY,prefixes:P.LONG,value:1,offset:0},T:{name:"T",base:F.MAGNETIC_FLUX_DENSITY,prefixes:P.SHORT,value:1,offset:0},b:{name:"b",base:F.BIT,prefixes:P.BINARY_SHORT,value:1,offset:0},bits:{name:"bits",base:F.BIT,prefixes:P.BINARY_LONG,value:1,offset:0},B:{name:"B",base:F.BIT,prefixes:P.BINARY_SHORT,value:8,offset:0},bytes:{name:"bytes",base:F.BIT,prefixes:P.BINARY_LONG,value:8,offset:0}},z={meters:"meter",inches:"inch",feet:"foot",yards:"yard",miles:"mile",links:"link",rods:"rod",chains:"chain",angstroms:"angstrom",lt:"l",litres:"litre",liter:"litre",liters:"litre",teaspoons:"teaspoon",tablespoons:"tablespoon",minims:"minim",fldr:"fluiddram",fluiddrams:"fluiddram",floz:"fluidounce",fluidounces:"fluidounce",gi:"gill",gills:"gill",cp:"cup",cups:"cup",pt:"pint",pints:"pint",qt:"quart",quarts:"quart",gal:"gallon",gallons:"gallon",bbl:"beerbarrel",beerbarrels:"beerbarrel",obl:"oilbarrel",oilbarrels:"oilbarrel",hogsheads:"hogshead",gtts:"gtt",grams:"gram",tons:"ton",tonnes:"tonne",grains:"grain",drams:"dram",ounces:"ounce",poundmasses:"poundmass",hundredweights:"hundredweight",sticks:"stick",lb:"lbm",lbs:"lbm",kips:"kip",kgf:"kilogramforce",acres:"acre",hectares:"hectare",sqfeet:"sqft",sqyard:"sqyd",sqmile:"sqmi",sqmiles:"sqmi",mmhg:"mmHg",mmh2o:"mmH2O",cmh2o:"cmH2O",seconds:"second",secs:"second",minutes:"minute",mins:"minute",hours:"hour",hr:"hour",hrs:"hour",days:"day",weeks:"week",months:"month",years:"year",decades:"decade",centuries:"century",millennia:"millennium",hertz:"hertz",radians:"radian",degrees:"degree",gradians:"gradian",cycles:"cycle",arcsecond:"arcsec",arcseconds:"arcsec",arcminute:"arcmin",arcminutes:"arcmin",BTUs:"BTU",watts:"watt",joules:"joule",amperes:"ampere",amps:"ampere",amp:"ampere",coulombs:"coulomb",volts:"volt",ohms:"ohm",farads:"farad",webers:"weber",teslas:"tesla",electronvolts:"electronvolt",moles:"mole",bit:"bits",byte:"bytes"};function W(e){if("BigNumber"===e.number){var t=Bb(w);B.rad.value=new w(1),B.deg.value=t.div(180),B.grad.value=t.div(200),B.cycle.value=t.times(2),B.arcsec.value=t.div(648e3),B.arcmin.value=t.div(10800)}else B.rad.value=1,B.deg.value=Math.PI/180,B.grad.value=Math.PI/200,B.cycle.value=2*Math.PI,B.arcsec.value=Math.PI/648e3,B.arcmin.value=Math.PI/10800;B.radian.value=B.rad.value,B.degree.value=B.deg.value,B.gradian.value=B.grad.value}W(o),i&&i("config",function(e,t){e.number!==t.number&&W(e)});var V={si:{NONE:{unit:L,prefix:P.NONE[""]},LENGTH:{unit:B.m,prefix:P.SHORT[""]},MASS:{unit:B.g,prefix:P.SHORT.k},TIME:{unit:B.s,prefix:P.SHORT[""]},CURRENT:{unit:B.A,prefix:P.SHORT[""]},TEMPERATURE:{unit:B.K,prefix:P.SHORT[""]},LUMINOUS_INTENSITY:{unit:B.cd,prefix:P.SHORT[""]},AMOUNT_OF_SUBSTANCE:{unit:B.mol,prefix:P.SHORT[""]},ANGLE:{unit:B.rad,prefix:P.SHORT[""]},BIT:{unit:B.bits,prefix:P.SHORT[""]},FORCE:{unit:B.N,prefix:P.SHORT[""]},ENERGY:{unit:B.J,prefix:P.SHORT[""]},POWER:{unit:B.W,prefix:P.SHORT[""]},PRESSURE:{unit:B.Pa,prefix:P.SHORT[""]},ELECTRIC_CHARGE:{unit:B.C,prefix:P.SHORT[""]},ELECTRIC_CAPACITANCE:{unit:B.F,prefix:P.SHORT[""]},ELECTRIC_POTENTIAL:{unit:B.V,prefix:P.SHORT[""]},ELECTRIC_RESISTANCE:{unit:B.ohm,prefix:P.SHORT[""]},ELECTRIC_INDUCTANCE:{unit:B.H,prefix:P.SHORT[""]},ELECTRIC_CONDUCTANCE:{unit:B.S,prefix:P.SHORT[""]},MAGNETIC_FLUX:{unit:B.Wb,prefix:P.SHORT[""]},MAGNETIC_FLUX_DENSITY:{unit:B.T,prefix:P.SHORT[""]},FREQUENCY:{unit:B.Hz,prefix:P.SHORT[""]}}};V.cgs=JSON.parse(JSON.stringify(V.si)),V.cgs.LENGTH={unit:B.m,prefix:P.SHORT.c},V.cgs.MASS={unit:B.g,prefix:P.SHORT[""]},V.cgs.FORCE={unit:B.dyn,prefix:P.SHORT[""]},V.cgs.ENERGY={unit:B.erg,prefix:P.NONE[""]},V.us=JSON.parse(JSON.stringify(V.si)),V.us.LENGTH={unit:B.ft,prefix:P.NONE[""]},V.us.MASS={unit:B.lbm,prefix:P.NONE[""]},V.us.TEMPERATURE={unit:B.degF,prefix:P.NONE[""]},V.us.FORCE={unit:B.lbf,prefix:P.NONE[""]},V.us.ENERGY={unit:B.BTU,prefix:P.BTU[""]},V.us.POWER={unit:B.hp,prefix:P.NONE[""]},V.us.PRESSURE={unit:B.psi,prefix:P.NONE[""]},V.auto=JSON.parse(JSON.stringify(V.si));var U=V.auto;for(var q in C.setUnitSystem=function(e){if(!pd(V,e))throw new Error("Unit system "+e+" does not exist. Choices are: "+Object.keys(V).join(", "));U=V[e]},C.getUnitSystem=function(){for(var e in V)if(pd(V,e)&&V[e]===U)return e},C.typeConverters={BigNumber:function(e){return null!==e&&void 0!==e&&e.isFraction?new w(String(e.n)).div(String(e.d)).times(String(e.s)):new w(e+"")},Fraction:function(e){return new x(e)},Complex:function(e){return e},number:function(e){return null!==e&&void 0!==e&&e.isFraction?y(e):e}},C.prototype._numberConverter=function(){var e=C.typeConverters[this.valueType()];if(e)return e;throw new TypeError('Unsupported Unit value type "'+this.valueType()+'"')},C._getNumberConverter=function(e){if(!C.typeConverters[e])throw new TypeError('Unsupported type "'+e+'"');return C.typeConverters[e]},B)if(pd(B,q)){var G=B[q];G.dimensions=G.base.dimensions}for(var Y in z)if(pd(z,Y)){var K=B[z[Y]],$={};for(var X in K)pd(K,X)&&($[X]=K[X]);$.name=Y,B[Y]=$}return C.isValidAlpha=function(e){return/^[a-zA-Z]$/.test(e)},C.createUnit=function(e,t){if("object"!==typeof e)throw new TypeError("createUnit expects first parameter to be of type 'Object'");if(t&&t.override)for(var n in e)if(pd(e,n)&&C.deleteUnit(n),e[n].aliases)for(var r=0;r<e[n].aliases.length;r++)C.deleteUnit(e[n].aliases[r]);var i;for(var o in e)pd(e,o)&&(i=C.createUnitSingle(o,e[o]));return i},C.createUnitSingle=function(e,t){if("undefined"!==typeof t&&null!==t||(t={}),"string"!==typeof e)throw new TypeError("createUnitSingle expects first parameter to be of type 'string'");if(pd(B,e))throw new Error('Cannot create unit "'+e+'": a unit with that name already exists');!function(e){for(var t=0;t<e.length;t++){if(r=e.charAt(t),0===t&&!C.isValidAlpha(r))throw new Error('Invalid unit name (must begin with alpha character): "'+e+'"');if(t>0&&!C.isValidAlpha(r)&&!N(r))throw new Error('Invalid unit name (only alphanumeric characters are allowed): "'+e+'"')}}(e);var n,i,o,a=null,s=[],l=0;if(t&&"Unit"===t.type)a=t.clone();else if("string"===typeof t)""!==t&&(n=t);else{if("object"!==typeof t)throw new TypeError('Cannot create unit "'+e+'" from "'+t.toString()+'": expecting "string" or "Unit" or "Object"');n=t.definition,i=t.prefixes,l=t.offset,o=t.baseName,t.aliases&&(s=t.aliases.valueOf())}if(s)for(var c=0;c<s.length;c++)if(pd(B,s[c]))throw new Error('Cannot create alias "'+s[c]+'": a unit with that name already exists');if(n&&"string"===typeof n&&!a)try{a=C.parse(n,{allowNoUnits:!0})}catch(E){throw E.message='Could not create unit "'+e+'" from "'+n+'": '+E.message,E}else n&&"Unit"===n.type&&(a=n.clone());s=s||[],l=l||0,i=i&&i.toUpperCase&&P[i.toUpperCase()]||P.NONE;var u={};if(a){u={name:e,value:a.value,dimensions:a.dimensions.slice(0),prefixes:i,offset:l};var d=!1;for(var h in F)if(pd(F,h)){for(var f=!0,m=0;m<j.length;m++)if(Math.abs((u.dimensions[m]||0)-(F[h].dimensions[m]||0))>1e-12){f=!1;break}if(f){d=!0,u.base=F[h];break}}if(!d){o=o||e+"_STUFF";var p={dimensions:a.dimensions.slice(0)};p.key=o,F[o]=p,U[o]={unit:u,prefix:P.NONE[""]},u.base=F[o]}}else{if(o=o||e+"_STUFF",j.indexOf(o)>=0)throw new Error('Cannot create new base unit "'+e+'": a base unit with that name already exists (and cannot be overridden)');for(var g in j.push(o),F)pd(F,g)&&(F[g].dimensions[j.length-1]=0);for(var v={dimensions:[]},y=0;y<j.length;y++)v.dimensions[y]=0;v.dimensions[j.length-1]=1,v.key=o,F[o]=v,u={name:e,value:1,dimensions:F[o].dimensions.slice(0),prefixes:i,offset:l,base:F[o]},U[o]={unit:u,prefix:P.NONE[""]}}C.UNITS[e]=u;for(var b=0;b<s.length;b++){var w=s[b],x={};for(var S in u)pd(u,S)&&(x[S]=u[S]);x.name=w,C.UNITS[w]=x}return delete D.cache,new C(null,e)},C.deleteUnit=function(e){delete C.UNITS[e],delete D.cache},C.PREFIXES=P,C.BASE_DIMENSIONS=j,C.BASE_UNITS=F,C.UNIT_SYSTEMS=V,C.UNITS=B,C},{isClass:!0}),vk="createUnit",yk=vh(vk,["typed","Unit"],e=>{var{typed:t,Unit:n}=e;return t(vk,{"Object, Object":function(e,t){return n.createUnit(e,t)},Object:function(e){return n.createUnit(e,{})},"string, Unit | string | Object, Object":function(e,t,r){var i={};return i[e]=t,n.createUnit(i,r)},"string, Unit | string | Object":function(e,t){var r={};return r[e]=t,n.createUnit(r,{})},string:function(e){var t={};return t[e]={},n.createUnit(t,{})}})}),bk="dotPow",wk=vh(bk,["typed","equalScalar","matrix","pow","DenseMatrix","concat","SparseMatrix"],e=>{var{typed:t,equalScalar:n,matrix:r,pow:i,DenseMatrix:o,concat:a,SparseMatrix:s}=e,l=Xp({typed:t}),c=BN({typed:t,SparseMatrix:s}),u=dg({typed:t,equalScalar:n}),d=Qp({typed:t,DenseMatrix:o}),h=ng({typed:t,matrix:r,concat:a}),f={};for(var m in i.signatures)Object.prototype.hasOwnProperty.call(i.signatures,m)&&(m.includes("Matrix")||m.includes("Array")||(f[m]=i.signatures[m]));var p=t(f);return t(bk,h({elop:p,SS:c,DS:l,Ss:u,sS:d}))}),xk="expm",Sk=vh(xk,["typed","abs","add","identity","inv","multiply"],e=>{var{typed:t,abs:n,add:r,identity:i,inv:o,multiply:a}=e;return t(xk,{Matrix:function(e){var t=e.size();if(2!==t.length||t[0]!==t[1])throw new RangeError("Matrix must be square (size: "+Xh(t)+")");for(var l=t[0],c=function(e){for(var t=e.size()[0],r=0,i=0;i<t;i++){for(var o=0,a=0;a<t;a++)o+=n(e.get([i,a]));r=Math.max(o,r)}return r}(e),u=function(e,t){for(var n=30,r=0;r<n;r++)for(var i=0;i<=r;i++){var o=r-i;if(s(e,i,o)<t)return{q:i,j:o}}throw new Error("Could not find acceptable parameters to compute the matrix exponential (try increasing maxSearchSize in expm.js)")}(c,1e-15),d=u.q,h=u.j,f=a(e,Math.pow(2,-h)),m=i(l),p=i(l),g=1,v=f,y=-1,b=1;b<=d;b++)b>1&&(v=a(v,f),y=-y),m=r(m,a(g=g*(d-b+1)/((2*d-b+1)*b),v)),p=r(p,a(g*y,v));for(var w=a(o(p),m),x=0;x<h;x++)w=a(w,w);return Hd(e)?e.createSparseMatrix(w):w}});function s(e,t,n){for(var r=1,i=2;i<=t;i++)r*=i;for(var o=r,a=t+1;a<=2*t;a++)o*=a;var s=o*(2*t+1);return 8*Math.pow(e/Math.pow(2,n),2*t)*r*r/(o*s)}}),Ck=vh("fft",["typed","matrix","addScalar","multiplyScalar","divideScalar","exp","tau","i","dotDivide","conj","pow","ceil","log2"],e=>{var{typed:t,matrix:n,addScalar:r,multiplyScalar:i,divideScalar:o,exp:a,tau:s,i:l,dotDivide:c,conj:u,pow:d,ceil:h,log2:f}=e;return t("fft",{Array:m,Matrix:function(e){return e.create(m(e.valueOf()),e.datatype())}});function m(e){var t=sf(e);return 1===t.length?g(e,t[0]):p(e.map(e=>m(e,t.slice(1))),0)}function p(e,t){var n=sf(e);if(0!==t)return new Array(n[0]).fill(0).map((n,r)=>p(e[r],t-1));if(1===n.length)return g(e);function r(e){var t=sf(e);return new Array(t[1]).fill(0).map((n,r)=>new Array(t[0]).fill(0).map((t,n)=>e[n][r]))}return r(p(r(e),1))}function g(e){var t=e.length;if(1===t)return[e[0]];if(t%2===0){for(var n=[...g(e.filter((e,t)=>t%2===0)),...g(e.filter((e,t)=>t%2===1))],p=0;p<t/2;p++){var v=n[p],y=i(n[p+t/2],a(i(i(s,l),o(-p,t))));n[p]=r(v,y),n[p+t/2]=r(v,i(-1,y))}return n}return function(e){for(var t=e.length,n=a(o(i(-1,i(l,s)),t)),r=[],p=1-t;p<t;p++)r.push(d(n,o(d(p,2),2)));for(var v=d(2,h(f(t+t-1))),y=[...new Array(t).fill(0).map((n,o)=>i(e[o],r[t-1+o])),...new Array(v-t).fill(0)],b=[...new Array(t+t-1).fill(0).map((e,t)=>o(1,r[t])),...new Array(v-(t+t-1)).fill(0)],w=g(y),x=g(b),S=new Array(v).fill(0).map((e,t)=>i(w[t],x[t])),C=c(u(m(u(S))),v),E=[],N=t-1;N<t+t-1;N++)E.push(i(C[N],r[N]));return E}(e)}}),Ek="gamma",Nk=vh(Ek,["typed","config","multiplyScalar","pow","BigNumber","Complex"],e=>{var{typed:t,config:n,multiplyScalar:r,pow:i,BigNumber:o,Complex:a}=e;return t(Ek,{number:BC,Complex:function e(t){if(0===t.im)return BC(t.re);if(t.re<.5){var n=new a(1-t.re,-t.im),r=new a(Math.PI*t.re,Math.PI*t.im);return new a(Math.PI).div(r.sin()).div(e(n))}t=new a(t.re-1,t.im);for(var i=new a(WC[0],0),o=1;o<WC.length;++o){var s=new a(WC[o],0);i=i.add(s.div(t.add(o)))}var l=new a(t.re+zC+.5,t.im),c=Math.sqrt(2*Math.PI),u=l.pow(t.add(.5)),d=l.neg().exp();return i.mul(c).mul(u).mul(d)},BigNumber:function(e){if(e.isInteger())return e.isNegative()||e.isZero()?new o(1/0):s(e.minus(1));if(!e.isFinite())return new o(e.isNegative()?NaN:1/0);throw new Error("Integer BigNumber expected")}});function s(e){if(e<8)return new o([1,1,2,6,24,120,720,5040][e]);var t=n.precision+(0|Math.log(e.toNumber())),r=o.clone({precision:t});if(e%2===1)return e.times(s(new o(e-1)));for(var i=e,a=new r(e),l=e.toNumber();i>2;)l+=i-=2,a=a.times(l);return new o(a.toPrecision(o.precision))}}),Tk="ifft",Ak=vh(Tk,["typed","fft","dotDivide","conj"],e=>{var{typed:t,fft:n,dotDivide:r,conj:i}=e;return t(Tk,{"Array | Matrix":function(e){var t=Pd(e)?e.size():sf(e);return r(i(n(i(e))),t.reduce((e,t)=>e*t,1))}})}),Rk=vh("divide",["typed","matrix","multiply","equalScalar","divideScalar","inv"],e=>{var{typed:t,matrix:n,multiply:r,equalScalar:i,divideScalar:o,inv:a}=e,s=dg({typed:t,equalScalar:i}),l=eg({typed:t});return t("divide",fd({"Array | Matrix, Array | Matrix":function(e,t){return r(e,a(t))},"DenseMatrix, any":function(e,t){return l(e,t,o,!1)},"SparseMatrix, any":function(e,t){return s(e,t,o,!1)},"Array, any":function(e,t){return l(n(e),t,o,!1).valueOf()},"any, Array | Matrix":function(e,t){return r(e,a(t))}},o.signatures))}),kk="factorial",Mk=vh(kk,["typed","gamma"],e=>{var{typed:t,gamma:n}=e;return t(kk,{number:function(e){if(e<0)throw new Error("Value must be non-negative");return n(e+1)},BigNumber:function(e){if(e.isNegative())throw new Error("Value must be non-negative");return n(e.plus(1))},"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))})});function Dk(e,t){var n,r=t.length,i=[];if(e)for(n=0;n<r;n++)i[e[n]]=t[n];else for(n=0;n<r;n++)i[n]=t[n];return i}var _k="lusolve",Ok=vh(_k,["typed","matrix","lup","slu","usolve","lsolve","DenseMatrix"],e=>{var{typed:t,matrix:n,lup:r,slu:i,usolve:o,lsolve:a,DenseMatrix:s}=e,l=xA({DenseMatrix:s});return t(_k,{"Array, Array | Matrix":function(e,t){e=n(e);var i=r(e);return u(i.L,i.U,i.p,null,t).valueOf()},"DenseMatrix, Array | Matrix":function(e,t){var n=r(e);return u(n.L,n.U,n.p,null,t)},"SparseMatrix, Array | Matrix":function(e,t){var n=r(e);return u(n.L,n.U,n.p,null,t)},"SparseMatrix, Array | Matrix, number, number":function(e,t,n,r){var o=i(e,n,r);return u(o.L,o.U,o.p,o.q,t)},"Object, Array | Matrix":function(e,t){return u(e.L,e.U,e.p,e.q,t)}});function c(e){if(Pd(e))return e;if(Id(e))return n(e);throw new TypeError("Invalid Matrix LU decomposition")}function u(e,t,n,r,i){e=c(e),t=c(t),n&&((i=l(e,i,!0))._data=Dk(n,i._data));var s=a(e,i),u=o(t,s);return r&&(u._data=Dk(r,u._data)),u}}),Ik="multinomial",Pk=vh(Ik,["typed","add","divide","multiply","factorial","isInteger","isPositive"],e=>{var{typed:t,add:n,divide:r,multiply:i,factorial:o,isInteger:a,isPositive:s}=e;return t(Ik,{"Array | Matrix":function(e){var t=0,l=1;return Im(e,function(e){if(!a(e)||!s(e))throw new TypeError("Positive integer value expected in function multinomial");t=n(t,e),l=i(l,o(e))}),r(o(t),l)}})}),jk="permutations",Fk=vh(jk,["typed","factorial"],e=>{var{typed:t,factorial:n}=e;return t(jk,{"number | BigNumber":n,"number, number":function(e,t){if(!wh(e)||e<0)throw new TypeError("Positive integer value expected in function permutations");if(!wh(t)||t<0)throw new TypeError("Positive integer value expected in function permutations");if(t>e)throw new TypeError("second argument k must be less than or equal to first argument n");return YS(e-t+1,e)},"BigNumber, BigNumber":function(e,t){var n,r;if(!Hk(e)||!Hk(t))throw new TypeError("Positive integer value expected in function permutations");if(t.gt(e))throw new TypeError("second argument k must be less than or equal to first argument n");for(n=e.mul(0).add(1),r=e.minus(t).plus(1);r.lte(e);r=r.plus(1))n=n.times(r);return n}})});function Hk(e){return e.isInteger()&&e.gte(0)}var Lk="polynomialRoot",Bk=vh(Lk,["typed","isZero","equalScalar","add","subtract","multiply","divide","sqrt","unaryMinus","cbrt","typeOf","im","re"],e=>{var{typed:t,isZero:n,equalScalar:r,add:i,subtract:o,multiply:a,divide:s,sqrt:l,unaryMinus:c,cbrt:u,typeOf:d,im:h,re:f}=e;return t(Lk,{"number|Complex, ...number|Complex":(e,t)=>{for(var m=[e,...t];m.length>0&&n(m[m.length-1]);)m.pop();if(m.length<2)throw new RangeError("Polynomial [".concat(e,", ").concat(t,"] must have a non-zero non-constant coefficient"));switch(m.length){case 2:return[c(s(m[0],m[1]))];case 3:var[p,g,v]=m,y=a(2,v),b=a(g,g),w=a(4,v,p);if(r(b,w))return[s(c(g),y)];var x=l(o(b,w));return[s(o(x,g),y),s(o(c(x),g),y)];case 4:var[S,C,E,N]=m,T=c(a(3,N)),A=a(E,E),R=a(3,N,C),k=i(a(2,E,E,E),a(27,N,N,S)),M=a(9,N,E,C);if(r(A,R)&&r(k,M))return[s(E,T)];var D,_=o(A,R),O=o(k,M),I=i(a(18,N,E,C,S),a(E,E,C,C)),P=i(a(4,E,E,E,S),a(4,N,C,C,C),a(27,N,N,S,S));if(r(I,P))return[s(o(a(4,N,E,C),i(a(9,N,N,S),a(E,E,E))),a(N,_)),s(o(a(9,N,S),a(E,C)),a(2,_))];D=r(A,R)?O:s(i(O,l(o(a(O,O),a(4,_,_,_)))),2);return u(D,!0).toArray().map(e=>s(i(E,e,s(_,e)),T)).map(e=>"Complex"===d(e)&&r(f(e),f(e)+h(e))?f(e):e);default:throw new RangeError("only implemented for cubic or lower-order polynomials, not ".concat(m))}}})}),zk="setSize",Wk=vh(zk,["typed","compareNatural"],e=>{var{typed:t,compareNatural:n}=e;return t(zk,{"Array | Matrix":function(e){return Array.isArray(e)?Sf(e).length:Sf(e.toArray()).length},"Array | Matrix, boolean":function(e,t){if(!1===t||0===e.length)return Array.isArray(e)?Sf(e).length:Sf(e.toArray()).length;for(var r=Sf(Array.isArray(e)?e:e.toArray()).sort(n),i=1,o=1;o<r.length;o++)0!==n(r[o],r[o-1])&&i++;return i}})});function Vk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var Uk=vh("solveODE",["typed","add","subtract","multiply","divide","max","map","abs","isPositive","isNegative","larger","smaller","matrix","bignumber","unaryMinus"],e=>{var{typed:t,add:n,subtract:r,multiply:i,divide:o,max:a,map:s,abs:l,isPositive:c,isNegative:u,larger:d,smaller:h,matrix:f,bignumber:m,unaryMinus:p}=e;function g(e){return function(t,f,g,v){if(!(2===f.length&&(f.every(w)||f.every(_d))))throw new Error('"tspan" must be an Array of two numeric values or two units [tStart, tEnd]');var y=f[0],b=f[1],x=d(b,y),S=v.firstStep;if(void 0!==S&&!c(S))throw new Error('"firstStep" must be positive');var C=v.maxStep;if(void 0!==C&&!c(C))throw new Error('"maxStep" must be positive');var E=v.minStep;if(E&&u(E))throw new Error('"minStep" must be positive or zero');var N=[y,b,S,E,C].filter(e=>void 0!==e);if(!N.every(w)&&!N.every(_d))throw new Error('Inconsistent type of "t" dependant variables');for(var T=v.tol?v.tol:1e-4,A=v.minDelta?v.minDelta:.2,R=v.maxDelta?v.maxDelta:5,k=v.maxIter?v.maxIter:1e4,M=[y,b,...g,C,E].some(Rd),[D,_,O,I]=M?[m(e.a),m(e.c),m(e.b),m(e.bp)]:[e.a,e.c,e.b,e.bp],P=S?x?S:p(S):o(r(b,y),1),j=[y],F=[g],H=r(O,I),L=0,B=0,z=function(e){return e?h:d}(x),W=function(e){var t=e?d:h;return function(e,i,o){var a=n(e,o);return t(a,i)?r(i,e):o}}(x);z(j[L],b);){var V=[];P=W(j[L],b,P),V.push(t(j[L],F[L]));for(var U=1;U<_.length;++U)V.push(t(n(j[L],i(_[U],P)),n(F[L],i(P,D[U],V))));var q=a(l(s(i(H,V),e=>_d(e)?e.value:e)));q<T&&T/q>1/4&&(j.push(n(j[L],P)),F.push(n(F[L],i(P,O,V))),L++);var G=.84*(T/q)**.2;if(h(G,A)?G=A:d(G,R)&&(G=R),G=M?m(G):G,P=i(P,G),C&&d(l(P),C)?P=x?C:p(C):E&&h(l(P),E)&&(P=x?E:p(E)),++B>k)throw new Error("Maximum number of iterations reached, try changing options")}return{t:j,y:F}}}function v(e,t,n,r){return g({a:[[],[.5],[0,3/4],[2/9,1/3,4/9]],c:[null,.5,3/4,1],b:[2/9,1/3,4/9,0],bp:[7/24,1/4,1/3,1/8]})(e,t,n,r)}function y(e,t,n,r){return g({a:[[],[.2],[3/40,9/40],[44/45,-56/15,32/9],[19372/6561,-25360/2187,64448/6561,-212/729],[9017/3168,-355/33,46732/5247,49/176,-5103/18656],[35/384,0,500/1113,125/192,-2187/6784,11/84]],c:[null,.2,.3,.8,8/9,1,1],b:[35/384,0,500/1113,125/192,-2187/6784,11/84,0],bp:[5179/57600,0,7571/16695,393/640,-92097/339200,187/2100,1/40]})(e,t,n,r)}function b(e,t,n,r){var i=r.method?r.method:"RK45",o={RK23:v,RK45:y};if(i.toUpperCase()in o){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vk(Object(n),!0).forEach(function(t){S(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vk(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},r);return delete a.method,o[i.toUpperCase()](e,t,n,a)}var s=Object.keys(o).map(e=>'"'.concat(e,'"')),l="".concat(s.slice(0,-1).join(", ")," and ").concat(s.slice(-1));throw new Error('Unavailable method "'.concat(i,'". Available methods are ').concat(l))}function w(e){return Rd(e)||Ad(e)}function x(e,t,n,r){var i=b(e,t.toArray(),n.toArray(),r);return{t:f(i.t),y:f(i.y)}}return t("solveODE",{"function, Array, Array, Object":b,"function, Matrix, Matrix, Object":x,"function, Array, Array":(e,t,n)=>b(e,t,n,{}),"function, Matrix, Matrix":(e,t,n)=>x(e,t,n,{}),"function, Array, number | BigNumber | Unit":(e,t,n)=>{var r=b(e,t,[n],{});return{t:r.t,y:r.y.map(e=>e[0])}},"function, Matrix, number | BigNumber | Unit":(e,t,n)=>{var r=b(e,t.toArray(),[n],{});return{t:f(r.t),y:f(r.y.map(e=>e[0]))}},"function, Array, number | BigNumber | Unit, Object":(e,t,n,r)=>{var i=b(e,t,[n],r);return{t:i.t,y:i.y.map(e=>e[0])}},"function, Matrix, number | BigNumber | Unit, Object":(e,t,n,r)=>{var i=b(e,t.toArray(),[n],r);return{t:f(i.t),y:f(i.y.map(e=>e[0]))}}})}),qk="stirlingS2",Gk=vh(qk,["typed","addScalar","subtractScalar","multiplyScalar","divideScalar","pow","factorial","combinations","isNegative","isInteger","number","?bignumber","larger"],e=>{var{typed:t,addScalar:n,subtractScalar:r,multiplyScalar:i,divideScalar:o,pow:a,factorial:s,combinations:l,isNegative:c,isInteger:u,number:d,bignumber:h,larger:f}=e,m=[],p=[];return t(qk,{"number | BigNumber, number | BigNumber":function(e,t){if(!u(e)||c(e)||!u(t)||c(t))throw new TypeError("Non-negative integer value expected in function stirlingS2");if(f(t,e))throw new TypeError("k must be less than or equal to n in function stirlingS2");var r=!(Ad(e)&&Ad(t)),o=r?p:m,a=r?h:d,s=d(e),l=d(t);if(o[s]&&o[s].length>l)return o[s][l];for(var g=0;g<=s;++g)if(o[g]||(o[g]=[a(0===g?1:0)]),0!==g)for(var v=o[g],y=o[g-1],b=v.length;b<=g&&b<=l;++b)v[b]=b===g?1:n(i(a(b),y[b]),y[b-1]);return o[s][l]}})}),Yk="unit",Kk=vh(Yk,["typed","Unit"],e=>{var{typed:t,Unit:n}=e;return t(Yk,{Unit:function(e){return e.clone()},string:function(e){return n.isValuelessUnit(e)?new n(null,e):n.parse(e,{allowNoUnits:!0})},"number | BigNumber | Fraction | Complex, string | Unit":function(e,t){return new n(e,t)},"number | BigNumber | Fraction":function(e){return new n(e)},"Array | Matrix":t.referToSelf(e=>t=>Pm(t,e))})}),$k="bellNumbers",Xk=vh($k,["typed","addScalar","isNegative","isInteger","stirlingS2"],e=>{var{typed:t,addScalar:n,isNegative:r,isInteger:i,stirlingS2:o}=e;return t($k,{"number | BigNumber":function(e){if(!i(e)||r(e))throw new TypeError("Non-negative integer value expected in function bellNumbers");for(var t=0,a=0;a<=e;a++)t=n(t,o(e,a));return t}})});function Qk(e){var{addScalar:t,subtract:n,flatten:r,multiply:i,multiplyScalar:o,divideScalar:a,sqrt:s,abs:l,bignumber:c,diag:u,size:d,reshape:h,inv:f,qr:m,usolve:p,usolveAll:g,equal:v,complex:y,larger:b,smaller:w,matrixFromColumns:x,dot:S}=e;function C(e,r,i,a){var l=t(e,a),c=n(o(e,a),o(r,i)),u=o(l,.5),d=o(s(n(o(l,l),o(4,c))),.5);return[t(u,d),n(u,d)]}function E(e,t,r,i,o,a,s,u){var d="BigNumber"===u,h="Complex"===u,f=d?c(0):h?y(0):0,m=d?c(1):h?y(1):1;if(w(l(r),s))return[[m,f],[f,m]];if(b(l(n(o,a)),s))return[[n(o,i),n(a,i)],[r,r]];var p=n(e,o),g=n(i,o);return w(l(t),s)&&w(l(g),s)?[[p,m],[r,f]]:[[t,f],[g,m]]}function N(e,t){for(var n=0;n<e.length;n++)e[n].push(...Array(t-e[n].length).fill(0));for(var r=e.length;r<t;r++)e.push(Array(t).fill(0)),e[r][r]=1;return e}function T(e,t,n){for(var r=0;r<e.length;r++)if(n(e[r],t))return r;return-1}function A(e,t,n,r,i){for(var o,a="BigNumber"===i?c(1e3):1e3,s=0;s<5;++s){o=R(t,n,i);try{o=p(e,o)}catch(u){continue}if(b(M(o),a))break}if(s>=5)return null;for(s=0;;){var l=p(e,o);if(w(M(k(o,[l])),r))break;if(++s>=10)return null;o=D(l)}return o}function R(e,t,n){var r="BigNumber"===n,i="Complex"===n,o=Array(e).fill(0).map(e=>2*Math.random()-1);return r&&(o=o.map(e=>c(e))),i&&(o=o.map(e=>y(e))),D(o=k(o,t),n)}function k(e,t){var r=d(e);for(var o of t)o=h(o,r),e=n(e,i(a(S(o,e),S(o,o)),o));return e}function M(e){return l(s(S(e,e)))}function D(e,t){var n="Complex"===t,r="BigNumber"===t?c(1):n?y(1):1;return i(a(r,M(e)),e)}return function(e,s,d,h){var p=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],x=function(e,n,r,i,s){var d,h="BigNumber"===i,f="Complex"===i,m=h?c(0):0,p=h?c(1):f?y(1):1,g=h?c(1):1,x=h?c(10):2,S=o(x,x);s&&(d=Array(n).fill(p));var C=!1;for(;!C;){C=!0;for(var E=0;E<n;E++){for(var N=m,T=m,A=0;A<n;A++)E!==A&&(N=t(N,l(e[A][E])),T=t(T,l(e[E][A])));if(!v(N,0)&&!v(T,0)){for(var R=g,k=N,M=a(T,x),D=o(T,x);w(k,M);)k=o(k,S),R=o(R,x);for(;b(k,D);)k=a(k,S),R=a(R,x);if(w(a(t(k,T),R),o(t(N,T),.95))){C=!1;for(var _=a(1,R),O=0;O<n;O++)E!==O&&(e[E][O]=o(e[E][O],_),e[O][E]=o(e[O][E],R));s&&(d[E]=o(d[E],_))}}}}return s?u(d):null}(e,s,0,h,p);!function(e,r,i,s,u,d){var h="BigNumber"===s,f="Complex"===s,m=h?c(0):f?y(0):0;h&&(i=c(i));for(var p=0;p<r-2;p++){for(var g=0,v=m,b=p+1;b<r;b++){var x=e[b][p];w(l(v),l(x))&&(v=x,g=b)}if(!w(l(v),i)){if(g!==p+1){var S=e[g];e[g]=e[p+1],e[p+1]=S;for(var C=0;C<r;C++){var E=e[C][g];e[C][g]=e[C][p+1],e[C][p+1]=E}if(u){var N=d[g];d[g]=d[p+1],d[p+1]=N}}for(var T=p+2;T<r;T++){var A=a(e[T][p],v);if(0!==A){for(var R=0;R<r;R++)e[T][R]=n(e[T][R],o(A,e[p+1][R]));for(var k=0;k<r;k++)e[k][p+1]=t(e[k][p+1],o(A,e[k][T]));if(u)for(var M=0;M<r;M++)d[T][M]=n(d[T][M],o(A,d[p+1][M]))}}}}}(e,s,d,h,p,x);var{values:S,C:R}=function(e,r,o,a,s){var d="BigNumber"===a,h="Complex"===a,f=d?c(1):h?y(1):1;d&&(o=c(o));var p=hd(e),g=[],v=r,b=[],x=s?u(Array(r).fill(f)):void 0,S=s?u(Array(v).fill(f)):void 0,T=0;for(;T<=100;){T+=1;for(var A=p[v-1][v-1],R=0;R<v;R++)p[R][R]=n(p[R][R],A);var{Q:k,R:M}=m(p);p=i(M,k);for(var D=0;D<v;D++)p[D][D]=t(p[D][D],A);if(s&&(S=i(S,k)),1===v||w(l(p[v-1][v-2]),o)){T=0,g.push(p[v-1][v-1]),s&&(b.unshift([[1]]),N(S,r),x=i(x,S),v>1&&(S=u(Array(v-1).fill(f)))),v-=1,p.pop();for(var _=0;_<v;_++)p[_].pop()}else if(2===v||w(l(p[v-2][v-3]),o)){T=0;var O=C(p[v-2][v-2],p[v-2][v-1],p[v-1][v-2],p[v-1][v-1]);g.push(...O),s&&(b.unshift(E(p[v-2][v-2],p[v-2][v-1],p[v-1][v-2],p[v-1][v-1],O[0],O[1],o,a)),N(S,r),x=i(x,S),v>2&&(S=u(Array(v-2).fill(f)))),v-=2,p.pop(),p.pop();for(var I=0;I<v;I++)p[I].pop(),p[I].pop()}if(0===v)break}if(g.sort((e,t)=>+n(l(e),l(t))),T>100){var P=Error("The eigenvalues failed to converge. Only found these eigenvalues: "+g.join(", "));throw P.values=g,P.vectors=[],P}var j=s?i(x,function(e,t){for(var n=[],r=0;r<t;r++)n[r]=Array(t).fill(0);var i=0;for(var o of e){for(var a=o.length,s=0;s<a;s++)for(var l=0;l<a;l++)n[i+s][i+l]=o[s][l];i+=a}return n}(b,r)):void 0;return{values:g,C:j}}(e,s,d,h,p);if(p){var k=function(e,t,o,a,s,l,d){var h=f(o),m=i(h,e,o),p="BigNumber"===d,b="Complex"===d,w=p?c(0):b?y(0):0,x=p?c(1):b?y(1):1,S=[],C=[];for(var E of s){var N=T(S,E,v);-1===N?(S.push(E),C.push(1)):C[N]+=1}for(var R=[],k=S.length,M=Array(t).fill(w),D=u(Array(t).fill(x)),_=function(){var e=S[O],s=n(m,i(e,D)),c=g(s,M);for(c.shift();c.length<C[O];){var u=A(s,t,c,l,d);if(null===u)break;c.push(u)}var h=i(f(a),o);c=c.map(e=>i(h,e)),R.push(...c.map(t=>({value:e,vector:r(t)})))},O=0;O<k;O++)_();return R}(e,s,R,x,S,d,h);return{values:S,eigenvectors:k}}return{values:S}}}function Jk(e){var{config:t,addScalar:n,subtract:r,abs:i,atan:o,cos:a,sin:s,multiplyScalar:l,inv:c,bignumber:u,multiply:d,add:h}=e;function f(e,n,r){var i=n-e;return Math.abs(i)<=t.relTol?Math.PI/4:.5*Math.atan(2*r/(n-e))}function m(e,n,a){var s=r(n,e);return i(s)<=t.relTol?u(-1).acos().div(4):l(.5,o(d(2,a,c(s))))}function p(e,t,n,r){for(var i=e.length,o=Math.cos(t),a=Math.sin(t),s=Array(i).fill(0),l=Array(i).fill(0),c=0;c<i;c++)s[c]=o*e[c][n]-a*e[c][r],l[c]=a*e[c][n]+o*e[c][r];for(var u=0;u<i;u++)e[u][n]=s[u],e[u][r]=l[u];return e}function g(e,t,i,o){for(var c=e.length,d=a(t),h=s(t),f=Array(c).fill(u(0)),m=Array(c).fill(u(0)),p=0;p<c;p++)f[p]=r(l(d,e[p][i]),l(h,e[p][o])),m[p]=n(l(h,e[p][i]),l(d,e[p][o]));for(var g=0;g<c;g++)e[g][i]=f[g],e[g][o]=m[g];return e}function v(e,t,i,o){for(var c=e.length,f=u(a(t)),m=u(s(t)),p=l(f,f),g=l(m,m),v=Array(c).fill(u(0)),y=Array(c).fill(u(0)),b=d(u(2),f,m,e[i][o]),w=n(r(l(p,e[i][i]),b),l(g,e[o][o])),x=h(l(g,e[i][i]),b,l(p,e[o][o])),S=0;S<c;S++)v[S]=r(l(f,e[i][S]),l(m,e[o][S])),y[S]=n(l(m,e[i][S]),l(f,e[o][S]));e[i][i]=w,e[o][o]=x,e[i][o]=u(0),e[o][i]=u(0);for(var C=0;C<c;C++)C!==i&&C!==o&&(e[i][C]=v[C],e[C][i]=v[C],e[o][C]=y[C],e[C][o]=y[C]);return e}function y(e,t,n,r){for(var i=e.length,o=Math.cos(t),a=Math.sin(t),s=o*o,l=a*a,c=Array(i).fill(0),u=Array(i).fill(0),d=s*e[n][n]-2*o*a*e[n][r]+l*e[r][r],h=l*e[n][n]+2*o*a*e[n][r]+s*e[r][r],f=0;f<i;f++)c[f]=o*e[n][f]-a*e[r][f],u[f]=a*e[n][f]+o*e[r][f];e[n][n]=d,e[r][r]=h,e[n][r]=0,e[r][n]=0;for(var m=0;m<i;m++)m!==n&&m!==r&&(e[n][m]=c[m],e[m][n]=c[m],e[r][m]=u[m],e[m][r]=u[m]);return e}function b(e){for(var t=e.length,n=0,r=[0,1],i=0;i<t;i++)for(var o=i+1;o<t;o++)Math.abs(n)<Math.abs(e[i][o])&&(n=Math.abs(e[i][o]),r=[i,o]);return[r,n]}function w(e){for(var t=e.length,n=0,r=[0,1],o=0;o<t;o++)for(var a=o+1;a<t;a++)i(n)<i(e[o][a])&&(n=i(e[o][a]),r=[o,a]);return[r,n]}function x(e,t,n){var r,o=e.length,a=Array(o);if(n){r=Array(o);for(var s=0;s<o;s++)r[s]=Array(o)}for(var l=0;l<o;l++){for(var c=0,u=e[0],d=0;d<e.length;d++)i(e[d])<i(u)&&(u=e[c=d]);if(a[l]=e.splice(c,1)[0],n)for(var h=0;h<o;h++)r[l][h]=t[h][c],t[h].splice(c,1)}if(!n)return{values:a};var f=r.map((e,t)=>({value:a[t],vector:e}));return{values:a,eigenvectors:f}}return function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.relTol,o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if("number"===o)return function(e,t,n){var r,i,o=e.length,a=Math.abs(t/o);if(n){i=new Array(o);for(var s=0;s<o;s++)i[s]=Array(o).fill(0),i[s][s]=1}var l=b(e);for(;Math.abs(l[1])>=Math.abs(a);){var c=l[0][0],u=l[0][1];e=y(e,r=f(e[c][c],e[u][u],e[c][u]),c,u),n&&(i=p(i,r,c,u)),l=b(e)}for(var d=Array(o).fill(0),h=0;h<o;h++)d[h]=e[h][h];return x(hd(d),i,n)}(e,r,a);if("BigNumber"===o)return function(e,t,n){var r,o,a=e.length,s=i(t/a);if(n){o=new Array(a);for(var l=0;l<a;l++)o[l]=Array(a).fill(0),o[l][l]=1}var c=w(e);for(;i(c[1])>=i(s);){var u=c[0][0],d=c[0][1];e=v(e,r=m(e[u][u],e[d][d],e[u][d]),u,d),n&&(o=g(o,r,u,d)),c=w(e)}for(var h=Array(a).fill(0),f=0;f<a;f++)h[f]=e[f][f];return x(hd(h),o,n)}(e,r,a);throw TypeError("Unsupported data type: "+o)}}var Zk=["config","typed","matrix","addScalar","equal","subtract","abs","atan","cos","sin","multiplyScalar","divideScalar","inv","bignumber","multiply","add","larger","column","flatten","number","complex","sqrt","diag","size","reshape","qr","usolve","usolveAll","im","re","smaller","matrixFromColumns","dot"],eM=vh("eigs",Zk,e=>{var{config:t,typed:n,matrix:r,addScalar:i,subtract:o,equal:a,abs:s,atan:l,cos:c,sin:u,multiplyScalar:d,divideScalar:h,inv:f,bignumber:m,multiply:p,add:g,larger:v,column:y,flatten:b,number:w,complex:x,sqrt:S,diag:C,size:E,reshape:N,qr:T,usolve:A,usolveAll:R,im:k,re:M,smaller:D,matrixFromColumns:_,dot:O}=e,I=Jk({config:t,addScalar:i,subtract:o,column:y,flatten:b,equal:a,abs:s,atan:l,cos:c,sin:u,multiplyScalar:d,inv:f,bignumber:m,complex:x,multiply:p,add:g}),P=Qk({config:t,addScalar:i,subtract:o,multiply:p,multiplyScalar:d,flatten:b,divideScalar:h,sqrt:S,abs:s,bignumber:m,diag:C,size:E,reshape:N,qr:T,inv:f,usolve:A,usolveAll:R,equal:a,complex:x,larger:v,smaller:D,matrixFromColumns:_,dot:O});return n("eigs",{Array:function(e){return j(r(e))},"Array, number|BigNumber":function(e,t){return j(r(e),{precision:t})},"Array, Object":(e,t)=>j(r(e),t),Matrix:function(e){return j(e,{matricize:!0})},"Matrix, number|BigNumber":function(e,t){return j(e,{precision:t,matricize:!0})},"Matrix, Object":function(e,t){var n={matricize:!0};return sd(n,t),j(e,n)}});function j(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=!("eigenvectors"in i)||i.eigenvectors,l=function(e,t,n){var r=e.toArray(),i=e.size();if(2!==i.length||i[0]!==i[1])throw new RangeError("Matrix must be square (size: ".concat(Xh(i),")"));var a=i[0];if(function(e,t,n){for(var r=0;r<t;r++)for(var i=0;i<t;i++)if(v(m(s(k(e[r][i]))),n))return!1;return!0}(r,a,t)&&(function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)e[n][r]=M(e[n][r])}(r,a),function(e,t,n){for(var r=0;r<t;r++)for(var i=r;i<t;i++)if(v(m(s(o(e[r][i],e[i][r]))),n))return!1;return!0}(r,a,t))){var l=F(e,r,a);return I(r,a,t,l,n)}var c=F(e,r,a);return P(r,a,t,c,n)}(e,null!==(n=i.precision)&&void 0!==n?n:t.relTol,a);return i.matricize&&(l.values=r(l.values),a&&(l.eigenvectors=l.eigenvectors.map(e=>{var{value:t,vector:n}=e;return{value:t,vector:r(n)}}))),a&&Object.defineProperty(l,"vectors",{enumerable:!1,get:()=>{throw new Error("eigs(M).vectors replaced with eigs(M).eigenvectors")}}),l}function F(e,t,n){var r=e.datatype();if("number"===r||"BigNumber"===r||"Complex"===r)return r;for(var i=!1,o=!1,a=!1,s=0;s<n;s++)for(var l=0;l<n;l++){var c=t[s][l];if(Ad(c)||Dd(c))i=!0;else if(Rd(c))o=!0;else{if(!Md(c))throw TypeError("Unsupported type in Matrix: "+ph(c));a=!0}}if(o&&a&&console.warn("Complex BigNumbers not supported, this operation will lose precission."),a){for(var u=0;u<n;u++)for(var d=0;d<n;d++)t[u][d]=x(t[u][d]);return"Complex"}if(o){for(var h=0;h<n;h++)for(var f=0;f<n;f++)t[h][f]=m(t[h][f]);return"BigNumber"}if(i){for(var p=0;p<n;p++)for(var g=0;g<n;g++)t[p][g]=w(t[p][g]);return"number"}throw TypeError("Matrix contains unsupported types only.")}}),tM="kldivergence",nM=["typed","matrix","divide","sum","multiply","map","dotDivide","log","isNumeric"],rM=vh(tM,nM,e=>{var{typed:t,matrix:n,divide:r,sum:i,multiply:o,map:a,dotDivide:s,log:l,isNumeric:c}=e;return t(tM,{"Array, Array":function(e,t){return u(n(e),n(t))},"Matrix, Array":function(e,t){return u(e,n(t))},"Array, Matrix":function(e,t){return u(n(e),t)},"Matrix, Matrix":function(e,t){return u(e,t)}});function u(e,t){var n=t.size().length,u=e.size().length;if(n>1)throw new Error("first object must be one dimensional");if(u>1)throw new Error("second object must be one dimensional");if(n!==u)throw new Error("Length of two vectors must be equal");if(0===i(e))throw new Error("Sum of elements in first object must be non zero");if(0===i(t))throw new Error("Sum of elements in second object must be non zero");var d=r(e,i(e)),h=r(t,i(t)),f=i(o(d,a(s(d,h),e=>l(e))));return c(f)?f:Number.NaN}}),iM="median",oM=["typed","add","divide","compare","partitionSelect"],aM=vh(iM,oM,e=>{var{typed:t,add:n,divide:r,compare:i,partitionSelect:o}=e;function a(e){try{var t=(e=Sf(e.valueOf())).length;if(0===t)throw new Error("Cannot calculate median of an empty array");if(t%2===0){for(var n=t/2-1,r=o(e,n+1),a=e[n],c=0;c<n;++c)i(e[c],a)>0&&(a=e[c]);return l(a,r)}var u=o(e,(t-1)/2);return s(u)}catch(d){throw yg(d,"median")}}var s=t({"number | BigNumber | Complex | Unit":function(e){return e}}),l=t({"number | BigNumber | Complex | Unit, number | BigNumber | Complex | Unit":function(e,t){return r(n(e,t),2)}});return t(iM,{"Array | Matrix":a,"Array | Matrix, number | BigNumber":function(e,t){throw new Error("median(A, dim) is not yet supported")},"...":function(e){if(Om(e))throw new TypeError("Scalar values expected in function median");return a(e)}})}),sM="corr",lM=["typed","matrix","mean","sqrt","sum","add","subtract","multiply","pow","divide"],cM=vh(sM,lM,e=>{var{typed:t,matrix:n,sqrt:r,sum:i,add:o,subtract:a,multiply:s,pow:l,divide:c}=e;return t(sM,{"Array, Array":function(e,t){return u(e,t)},"Matrix, Matrix":function(e,t){var r=u(e.toArray(),t.toArray());return Array.isArray(r)?n(r):r}});function u(e,t){var n=[];if(Array.isArray(e[0])&&Array.isArray(t[0])){if(e.length!==t.length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same length.");for(var r=0;r<e.length;r++){if(e[r].length!==t[r].length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same number of elements.");n.push(d(e[r],t[r]))}return n}if(e.length!==t.length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same number of elements.");return d(e,t)}function d(e,t){var n=e.length,u=i(e),d=i(t),h=e.reduce((e,n,r)=>o(e,s(n,t[r])),0),f=i(e.map(e=>l(e,2))),m=i(t.map(e=>l(e,2))),p=a(s(n,h),s(u,d)),g=r(s(a(s(n,f),l(u,2)),a(s(n,m),l(d,2))));return c(p,g)}}),uM="freqz",dM=["typed","add","multiply","Complex","divide","matrix"],hM=vh(uM,dM,e=>{var{typed:t,add:n,multiply:r,Complex:i,divide:o,matrix:a}=e;return t(uM,{"Array, Array":function(e,t){return s(e,t,l(512))},"Array, Array, Array":function(e,t,n){return s(e,t,n)},"Array, Array, number":function(e,t,n){if(n<0)throw new Error("w must be a positive number");return s(e,t,l(n))},"Matrix, Matrix":function(e,t){var n=l(512),{w:r,h:i}=s(e.valueOf(),t.valueOf(),n);return{w:a(r),h:a(i)}},"Matrix, Matrix, Matrix":function(e,t,n){var{h:r}=s(e.valueOf(),t.valueOf(),n.valueOf());return{h:a(r),w:a(n)}},"Matrix, Matrix, number":function(e,t,n){if(n<0)throw new Error("w must be a positive number");var r=l(n),{h:i}=s(e.valueOf(),t.valueOf(),r);return{h:a(i),w:a(r)}}});function s(e,t,a){for(var s=[],l=[],c=0;c<a.length;c++){for(var u=i(0,0),d=i(0,0),h=0;h<e.length;h++)u=n(u,r(e[h],i(Math.cos(-h*a[c]),Math.sin(-h*a[c]))));for(var f=0;f<t.length;f++)d=n(d,r(t[f],i(Math.cos(-f*a[c]),Math.sin(-f*a[c]))));s.push(u),l.push(d)}for(var m=[],p=0;p<s.length;p++)m.push(o(s[p],l[p]));return{h:m,w:a}}function l(e){for(var t=[],n=0;n<e;n++)t.push(n/e*Math.PI);return t}}),fM=["typed","abs","map","median","subtract"],mM=vh("mad",fM,e=>{var{typed:t,abs:n,map:r,median:i,subtract:o}=e;return t("mad",{"Array | Matrix":a,"...":function(e){return a(e)}});function a(e){if(0===(e=Sf(e.valueOf())).length)throw new Error("Cannot calculate median absolute deviation (mad) of an empty array");try{var t=i(e);return i(r(e,function(e){return n(o(e,t))}))}catch(a){throw a instanceof TypeError&&a.message.includes("median")?new TypeError(a.message.replace("median","mad")):yg(a,"mad")}}}),pM="zeta",gM=["typed","config","multiply","pow","divide","factorial","equal","smallerEq","isNegative","gamma","sin","subtract","add","?Complex","?BigNumber","pi"],vM=vh(pM,gM,e=>{var{typed:t,config:n,multiply:r,pow:i,divide:o,factorial:a,equal:s,smallerEq:l,isNegative:c,gamma:u,sin:d,subtract:h,add:f,Complex:m,BigNumber:p,pi:g}=e;return t(pM,{number:e=>v(e,e=>e,()=>20),BigNumber:e=>v(e,e=>new p(e),()=>Math.abs(Math.log10(n.relTol))),Complex:function(e){if(0===e.re&&0===e.im)return new m(-.5);if(1===e.re)return new m(NaN,NaN);if(e.re===1/0&&0===e.im)return new m(1);if(e.im===1/0||e.re===-1/0)return new m(NaN,NaN);return y(e,e=>e,e=>Math.round(19.5+.9*Math.abs(e.im)),e=>e.re)}});function v(e,t,n){return s(e,0)?t(-.5):s(e,1)?t(NaN):isFinite(e)?y(e,t,n,e=>e):c(e)?t(NaN):t(1)}function y(e,t,n,a){var s=n(e);if(a(e)>-(s-1)/2)return function(e,t,n){for(var a=o(1,r(b(n(0),t),h(1,i(2,h(1,e))))),s=n(0),c=n(1);l(c,t);c=f(c,1))s=f(s,o(r((-1)**(c-1),b(c,t)),i(c,e)));return r(a,s)}(e,t(s),t);var c=r(i(2,e),i(t(g),h(e,1)));return c=r(c,d(r(o(t(g),2),e))),c=r(c,u(h(1,e))),r(c,y(h(1,e),t,n,a))}function b(e,t){for(var n=e,s=e;l(s,t);s=f(s,1)){var c=o(r(a(f(t,h(s,1))),i(4,s)),r(a(h(t,s)),a(r(2,s))));n=f(n,c)}return r(t,n)}}),yM="norm",bM=["typed","abs","add","pow","conj","sqrt","multiply","equalScalar","larger","smaller","matrix","ctranspose","eigs"],wM=vh(yM,bM,e=>{var{typed:t,abs:n,add:r,pow:i,conj:o,sqrt:a,multiply:s,equalScalar:l,larger:c,smaller:u,matrix:d,ctranspose:h,eigs:f}=e;return t(yM,{number:Math.abs,Complex:function(e){return e.abs()},BigNumber:function(e){return e.abs()},boolean:function(e){return Math.abs(e)},Array:function(e){return g(d(e),2)},Matrix:function(e){return g(e,2)},"Array, number | BigNumber | string":function(e,t){return g(d(e),t)},"Matrix, number | BigNumber | string":function(e,t){return g(e,t)}});function m(e,t){if(t===Number.POSITIVE_INFINITY||"inf"===t)return function(e){var t=0;return e.forEach(function(e){var r=n(e);c(r,t)&&(t=r)},!0),t}(e);if(t===Number.NEGATIVE_INFINITY||"-inf"===t)return function(e){var t;return e.forEach(function(e){var r=n(e);t&&!u(r,t)||(t=r)},!0),t||0}(e);if("fro"===t)return g(e,2);if("number"===typeof t&&!isNaN(t)){if(!l(t,0)){var o=0;return e.forEach(function(e){o=r(i(n(e),t),o)},!0),i(o,1/t)}return Number.POSITIVE_INFINITY}throw new Error("Unsupported parameter value")}function p(e,t){if(1===t)return function(e){var t=[],i=0;return e.forEach(function(e,o){var a=o[1],s=r(t[a]||0,n(e));c(s,i)&&(i=s),t[a]=s},!0),i}(e);if(t===Number.POSITIVE_INFINITY||"inf"===t)return function(e){var t=[],i=0;return e.forEach(function(e,o){var a=o[0],s=r(t[a]||0,n(e));c(s,i)&&(i=s),t[a]=s},!0),i}(e);if("fro"===t)return function(e){var t=0;return e.forEach(function(e,n){t=r(t,s(e,o(e)))}),n(a(t))}(e);if(2===t)return function(e){var t=e.size();if(t[0]!==t[1])throw new RangeError("Invalid matrix dimensions");var r=h(e),i=s(r,e),o=f(i).values.toArray(),l=o[o.length-1];return n(a(l))}(e);throw new Error("Unsupported parameter value "+t)}function g(e,t){var n=e.size();if(1===n.length)return m(e,t);if(2===n.length){if(n[0]&&n[1])return p(e,t);throw new RangeError("Invalid matrix dimensions")}}}),xM="rotationMatrix",SM=["typed","config","multiplyScalar","addScalar","unaryMinus","norm","matrix","BigNumber","DenseMatrix","SparseMatrix","cos","sin"],CM=vh(xM,SM,e=>{var{typed:t,config:n,multiplyScalar:r,addScalar:i,unaryMinus:o,norm:a,BigNumber:s,matrix:l,DenseMatrix:c,SparseMatrix:u,cos:d,sin:h}=e;return t(xM,{"":function(){return"Matrix"===n.matrix?l([]):[]},string:function(e){return l(e)},"number | BigNumber | Complex | Unit":function(e){return f(e,"Matrix"===n.matrix?"dense":void 0)},"number | BigNumber | Complex | Unit, string":function(e,t){return f(e,t)},"number | BigNumber | Complex | Unit, Array":function(e,t){var n=l(t);return m(n),v(e,n,void 0)},"number | BigNumber | Complex | Unit, Matrix":function(e,t){m(t);var r=t.storage()||("Matrix"===n.matrix?"dense":void 0);return v(e,t,r)},"number | BigNumber | Complex | Unit, Array, string":function(e,t,n){var r=l(t);return m(r),v(e,r,n)},"number | BigNumber | Complex | Unit, Matrix, string":function(e,t,n){return m(t),v(e,t,n)}});function f(e,t){var n=Rd(e)?new s(-1):-1,i=d(e),o=h(e);return g([[i,r(n,o)],[o,i]],t)}function m(e){var t=e.size();if(t.length<1||3!==t[0])throw new RangeError("Vector must be of dimensions 1x3")}function p(e){return e.reduce((e,t)=>r(e,t))}function g(e,t){if(t){if("sparse"===t)return new u(e);if("dense"===t)return new c(e);throw new TypeError('Unknown matrix type "'.concat(t,'"'))}return e}function v(e,t,n){var r=a(t);if(0===r)throw new RangeError("Rotation around zero vector");var l=Rd(e)?s:null,c=l?new l(1):1,u=l?new l(-1):-1,f=l?new l(t.get([0])/r):t.get([0])/r,m=l?new l(t.get([1])/r):t.get([1])/r,v=l?new l(t.get([2])/r):t.get([2])/r,y=d(e),b=i(c,o(y)),w=h(e);return g([[i(y,p([f,f,b])),i(p([f,m,b]),p([u,v,w])),i(p([f,v,b]),p([m,w]))],[i(p([f,m,b]),p([v,w])),i(y,p([m,m,b])),i(p([m,v,b]),p([u,f,w]))],[i(p([f,v,b]),p([u,m,w])),i(p([m,v,b]),p([f,w])),i(y,p([v,v,b]))]],n)}}),EM="schur",NM=["typed","matrix","identity","multiply","qr","norm","subtract"],TM=vh(EM,NM,e=>{var{typed:t,matrix:n,identity:r,multiply:i,qr:o,norm:a,subtract:s}=e;return t(EM,{Array:function(e){var t=l(n(e));return{U:t.U.valueOf(),T:t.T.valueOf()}},Matrix:function(e){return l(e)}});function l(e){var t,n=e.size()[0],l=e,c=r(n),u=0;do{t=l;var d=o(l),h=d.Q,f=d.R;if(l=i(f,h),c=i(c,h),u++>100)break}while(a(s(l,t))>1e-4);return{U:c,T:l}}}),AM="rotate",RM=["typed","multiply","rotationMatrix"],kM=vh(AM,RM,e=>{var{typed:t,multiply:n,rotationMatrix:r}=e;return t(AM,{"Array , number | BigNumber | Complex | Unit":function(e,t){return i(e,2),n(r(t),e).toArray()},"Matrix , number | BigNumber | Complex | Unit":function(e,t){return i(e,2),n(r(t),e)},"Array, number | BigNumber | Complex | Unit, Array | Matrix":function(e,t,o){return i(e,3),n(r(t,o),e)},"Matrix, number | BigNumber | Complex | Unit, Array | Matrix":function(e,t,o){return i(e,3),n(r(t,o),e)}});function i(e,t){var n=Array.isArray(e)?sf(e):e.size();if(n.length>2)throw new RangeError("Vector must be of dimensions 1x".concat(t));if(2===n.length&&1!==n[1])throw new RangeError("Vector must be of dimensions 1x".concat(t));if(n[0]!==t)throw new RangeError("Vector must be of dimensions 1x".concat(t))}}),MM="sylvester",DM=["typed","schur","matrixFromColumns","matrix","multiply","range","concat","transpose","index","subset","add","subtract","identity","lusolve","abs"],_M=vh(MM,DM,e=>{var{typed:t,schur:n,matrixFromColumns:r,matrix:i,multiply:o,range:a,concat:s,transpose:l,index:c,subset:u,add:d,subtract:h,identity:f,lusolve:m,abs:p,config:g}=e;return t(MM,{"Matrix, Matrix, Matrix":v,"Array, Matrix, Matrix":function(e,t,n){return v(i(e),t,n)},"Array, Array, Matrix":function(e,t,n){return v(i(e),i(t),n)},"Array, Matrix, Array":function(e,t,n){return v(i(e),t,i(n))},"Matrix, Array, Matrix":function(e,t,n){return v(e,i(t),n)},"Matrix, Array, Array":function(e,t,n){return v(e,i(t),i(n))},"Matrix, Matrix, Array":function(e,t,n){return v(e,t,i(n))},"Array, Array, Array":function(e,t,n){return v(i(e),i(t),i(n)).toArray()}});function v(e,t,g){for(var v=t.size()[0],y=e.size()[0],b=n(e),w=b.T,x=b.U,S=n(o(-1,t)),C=S.T,E=S.U,N=o(o(l(x),g),E),T=a(0,y),A=[],R=(e,t)=>s(e,t,1),k=(e,t)=>s(e,t,0),M=0;M<v;M++)if(M<v-1&&p(u(C,c(M+1,M)))>1e-5){for(var D=k(u(N,c(T,[M])),u(N,c(T,[M+1]))),_=0;_<M;_++)D=d(D,k(o(A[_],u(C,c(_,M))),o(A[_],u(C,c(_,M+1)))));var O=o(f(y),o(-1,u(C,c(M,M)))),I=o(f(y),o(-1,u(C,c(M+1,M)))),P=o(f(y),o(-1,u(C,c(M,M+1)))),j=o(f(y),o(-1,u(C,c(M+1,M+1)))),F=k(R(d(w,O),I),R(P,d(w,j))),H=m(F,D);A[M]=H.subset(c(a(0,y),[0])),A[M+1]=H.subset(c(a(y,2*y),[0])),M++}else{for(var L=u(N,c(T,[M])),B=0;B<M;B++)L=d(L,o(A[B],u(C,c(B,M))));var z=u(C,c(M,M)),W=h(w,o(z,f(y)));A[M]=m(W,L)}var V=i(r(...A));return o(x,o(V,l(E)))}}),OM="lyap",IM=["typed","matrix","sylvester","multiply","transpose"],PM=vh(OM,IM,e=>{var{typed:t,matrix:n,sylvester:r,multiply:i,transpose:o}=e;return t(OM,{"Matrix, Matrix":function(e,t){return r(e,o(e),i(-1,t))},"Array, Matrix":function(e,t){return r(n(e),o(n(e)),i(-1,t))},"Matrix, Array":function(e,t){return r(e,o(n(e)),n(i(-1,t)))},"Array, Array":function(e,t){return r(n(e),o(n(e)),n(i(-1,t))).toArray()}})}),jM=Tb({config:dd}),FM=Pb({}),HM=Zb({BigNumber:jM,config:dd}),LM=Yb({}),BM=Mw({BigNumber:jM,config:dd}),zM=Rx({}),WM=sw({Complex:FM}),VM=$b({BigNumber:jM,config:dd}),UM=nw({BigNumber:jM,config:dd}),qM=iw({BigNumber:jM,config:dd}),GM=kx({}),YM=Xb({BigNumber:jM,config:dd}),KM=Kb({}),$M=ew({BigNumber:jM,config:dd}),XM=Mx({}),QM=Dx({}),JM=ow({BigNumber:jM,config:dd}),ZM=$w({BigNumber:jM,config:dd}),eD=Jb({BigNumber:jM,config:dd}),tD=Gb({}),nD=lw({}),rD=_x({Matrix:GM,config:dd}),iD=Lw({BigNumber:jM,config:dd}),oD=tw({BigNumber:jM,config:dd}),aD=Qb({BigNumber:jM,config:dd}),sD=Ox({}),lD=aw({BigNumber:jM,config:dd}),cD=Px({BigNumber:jM,Complex:FM,DenseMatrix:rD,Fraction:zM}),uD=Hw({BigNumber:jM,config:dd}),dD=sS({typed:cD}),hD=cS({Complex:FM,config:dd,typed:cD}),fD=RS({BigNumber:jM,typed:cD}),mD=MS({BigNumber:jM,Complex:FM,config:dd,typed:cD}),pD=_S({typed:cD}),gD=OS({typed:cD}),vD=PS({BigNumber:jM,Complex:FM,config:dd,typed:cD}),yD=jS({typed:cD}),bD=FS({typed:cD}),wD=LS({Complex:FM,config:dd,typed:cD}),xD=BS({typed:cD}),SD=WS({typed:cD}),CD=US({typed:cD}),ED=GS({typed:cD}),ND=XS({typed:cD}),TD=JS({Complex:FM,typed:cD}),AD=eC({typed:cD}),RD=nC({typed:cD}),kD=rC({BigNumber:jM,typed:cD}),MD=iC({BigNumber:jM,typed:cD}),DD=aC({typed:cD}),_D=uC({config:dd,typed:cD}),OD=dC({typed:cD}),ID=vC({typed:cD}),PD=bC({Complex:FM,typed:cD}),jD=jp({typed:cD}),FD=xC({typed:cD}),HD=Up({typed:cD}),LD=CC({typed:cD}),BD=NC({typed:cD}),zD=TC({format:LD,typed:cD}),WD=AC({typed:cD}),VD=kC({typed:cD}),UD=PC({config:dd,typed:cD}),qD=FC({config:dd,typed:cD}),GD=LC({equalScalar:_D,typed:cD}),YD=rw({BigNumber:jM,config:dd}),KD=YC({Complex:FM,typed:cD}),$D=JC({Complex:FM,config:dd,typed:cD}),XD=eE({Complex:FM,config:dd,typed:cD}),QD=Kp({typed:cD}),JD=tE({typed:cD}),ZD=nE({typed:cD}),e_=rE({typed:cD}),t_=iE({format:LD,typed:cD}),n_=cE({config:dd,typed:cD}),r_=Eg({typed:cD}),i_=hE({config:dd,typed:cD}),o_=fE({typed:cD}),a_=mE({BigNumber:jM,typed:cD}),s_=gE({BigNumber:jM,Fraction:zM,complex:TD,typed:cD}),l_=vE({typed:cD}),c_=bE({typed:cD}),u_=wE({Matrix:GM,equalScalar:_D,typed:cD}),d_=SE({typed:cD}),h_=EE({typed:cD}),f_=TE({typed:cD}),m_=RE({typed:cD}),p_=kE({typed:cD}),g_=DE({typed:cD}),v_=OE({typed:cD}),y_=PE({Complex:FM,config:dd,typed:cD}),b_=FE({BigNumber:jM,typed:cD}),w_=LE({BigNumber:jM,Complex:FM,config:dd,typed:cD}),x_=BE({BigNumber:jM,typed:cD}),S_=WE({typed:cD}),C_=qE({typed:cD}),E_=YE({BigNumber:jM,typed:cD}),N_=KE({addScalar:pD,conj:AD,multiplyScalar:JD,size:c_,typed:cD}),T_=XE({typed:cD}),A_=JE({typed:cD}),R_=Rp({isInteger:VD,typed:cD}),k_=eN({DenseMatrix:rD,Matrix:GM,SparseMatrix:u_,typed:cD}),M_=nN({isZero:GD,matrix:k_,typed:cD}),D_=iN({addScalar:pD,dot:N_,equalScalar:_D,matrix:k_,multiplyScalar:JD,typed:cD}),__=oN({BigNumber:jM,config:dd,matrix:k_,typed:cD}),O_=sN({config:dd,log2:XD,typed:cD}),I_=cN({isInteger:VD,matrix:k_,typed:cD}),P_=dN({BigNumber:jM,typed:cD}),j_=fN({typed:cD}),F_=pN({SparseMatrix:u_,typed:cD}),H_=gN({Complex:FM,config:dd,typed:cD}),L_=yN({typed:cD}),B_=bN({typed:cD}),z_=xN({matrix:k_,typed:cD}),W_=CN({BigNumber:jM,config:dd,matrix:k_,typed:cD}),V_=NN({BigNumber:jM,config:dd,matrix:k_,typed:cD}),U_=AN({BigNumber:jM,Complex:FM,config:dd,typed:cD}),q_=kN({Complex:FM,config:dd,typed:cD}),G_=MN({format:LD,typed:cD}),Y_=gg({isInteger:VD,matrix:k_,typed:cD}),K_=_N({BigNumber:jM,typed:cD}),$_=IN({conj:AD,transpose:z_,typed:cD}),X_=jN({DenseMatrix:rD,SparseMatrix:u_,matrix:k_,typed:cD}),Q_=LN({concat:Y_,equalScalar:_D,matrix:k_,multiplyScalar:JD,typed:cD}),J_=WN({DenseMatrix:rD,SparseMatrix:u_,concat:Y_,equalScalar:_D,matrix:k_,typed:cD}),Z_=UN({Fraction:zM,typed:cD}),eO=GN({BigNumber:jM,DenseMatrix:rD,SparseMatrix:u_,config:dd,matrix:k_,typed:cD}),tO=KN({typed:cD}),nO=XN({matrix:k_,multiplyScalar:JD,typed:cD}),rO=JN({DenseMatrix:rD,SparseMatrix:u_,concat:Y_,config:dd,matrix:k_,typed:cD}),iO=rT({DenseMatrix:rD,concat:Y_,equalScalar:_D,matrix:k_,typed:cD,zeros:V_}),oO=oT({flatten:FD,matrix:k_,size:c_,typed:cD}),aO=sT({isNaN:T_,isNumeric:tO,typed:cD}),sO=cT({BigNumber:jM,concat:Y_,equalScalar:_D,matrix:k_,typed:cD}),lO=uT({bignumber:x_,fraction:Z_,number:e_}),cO=hT({config:dd,multiplyScalar:JD,numeric:lO,typed:cD}),uO=mT({config:dd,matrix:k_}),dO=gT({DenseMatrix:rD,concat:Y_,equalScalar:_D,matrix:k_,typed:cD,zeros:V_}),hO=bT({BigNumber:jM,DenseMatrix:rD,config:dd,equalScalar:_D,matrix:k_,typed:cD,zeros:V_}),fO=xT({DenseMatrix:rD,SparseMatrix:u_,bignumber:x_,concat:Y_,config:dd,matrix:k_,typed:cD}),mO=CT({concat:Y_,matrix:k_,typed:cD}),pO=NT({typed:cD}),gO=AT({DenseMatrix:rD,SparseMatrix:u_,concat:Y_,config:dd,equalScalar:_D,matrix:k_,typed:cD}),vO=kT({DenseMatrix:rD,SparseMatrix:u_,concat:Y_,matrix:k_,typed:cD}),yO=MT({DenseMatrix:rD,SparseMatrix:u_,addScalar:pD,concat:Y_,equalScalar:_D,matrix:k_,typed:cD}),bO=_T({BigNumber:jM,DenseMatrix:rD,concat:Y_,equalScalar:_D,matrix:k_,typed:cD}),wO=Yg({concat:Y_,equalScalar:_D,matrix:k_,typed:cD}),xO=fv({DenseMatrix:rD,concat:Y_,equalScalar:_D,matrix:k_,typed:cD}),SO=IT({DenseMatrix:rD,SparseMatrix:u_,concat:Y_,matrix:k_,typed:cD}),CO=jT({BigNumber:jM,Complex:FM,Fraction:zM,config:dd,isNegative:UD,matrix:k_,typed:cD,unaryMinus:pO}),EO=HT({BigNumber:jM,DenseMatrix:rD,Fraction:zM,concat:Y_,config:dd,equalScalar:_D,matrix:k_,typed:cD}),NO=WT({concat:Y_,matrix:k_,typed:cD}),TO=UT({prod:cO,size:c_,typed:cD}),AO=GT({equal:J_,typed:cD}),RO=KT({numeric:lO,typed:cD}),kO=XT({compareText:NO,isZero:GD,typed:cD}),MO=tA({DenseMatrix:rD,config:dd,equalScalar:_D,matrix:k_,round:hO,typed:cD,zeros:V_}),DO=sA({BigNumber:jM,DenseMatrix:rD,concat:Y_,config:dd,equalScalar:_D,matrix:k_,round:hO,typed:cD,zeros:V_}),_O=cA({isNumeric:tO,typed:cD}),OO=dA({abs:dD,addScalar:pD,divideScalar:RO,isPositive:qD,multiplyScalar:JD,smaller:fO,sqrt:H_,typed:cD}),IO=hA({DenseMatrix:rD,smaller:fO}),PO=fA({ImmutableDenseMatrix:IO,getMatrixDataType:BD}),jO=gA({DenseMatrix:rD,SparseMatrix:u_,bignumber:x_,concat:Y_,config:dd,matrix:k_,typed:cD}),FO=wA({Complex:FM,config:dd,divideScalar:RO,typeOf:v_,typed:cD}),HO=CA({DenseMatrix:rD,divideScalar:RO,equalScalar:_D,matrix:k_,multiplyScalar:JD,subtractScalar:m_,typed:cD}),LO=NA({flatten:FD,matrix:k_,size:c_,typed:cD}),BO=$g({config:dd,isNaN:T_,numeric:lO,smaller:fO,typed:cD}),zO=nA({DenseMatrix:rD,concat:Y_,config:dd,equalScalar:_D,matrix:k_,round:hO,typed:cD,zeros:V_}),WO=AA({Complex:FM,config:dd,divideScalar:RO,typed:cD}),VO=Jg({deepEqual:AO,flatten:FD,matrix:k_,size:c_,typed:cD}),UO=lg({DenseMatrix:rD,concat:Y_,equalScalar:_D,matrix:k_,typed:cD}),qO=kA({compare:EO,isNaN:T_,isNumeric:tO,typed:cD}),GO=MA({addScalar:pD,complex:TD,conj:AD,divideScalar:RO,equal:J_,identity:eO,isZero:GD,matrix:k_,multiplyScalar:JD,sign:s_,sqrt:H_,subtractScalar:m_,typed:cD,unaryMinus:pO,zeros:V_}),YO=_A({DenseMatrix:rD,concat:Y_,equalScalar:_D,matrix:k_,typed:cD,zeros:V_}),KO=IA({DenseMatrix:rD,SparseMatrix:u_,concat:Y_,config:dd,matrix:k_,typed:cD}),$O=tv({add:yO,matrix:k_,typed:cD,zeros:V_}),XO=FA({DenseMatrix:rD,concat:Y_,equalScalar:_D,matrix:k_,subtractScalar:m_,typed:cD,unaryMinus:pO}),QO=HA({add:yO,matrix:k_,typed:cD}),JO=BA({DenseMatrix:rD,divideScalar:RO,equalScalar:_D,matrix:k_,multiplyScalar:JD,subtractScalar:m_,typed:cD}),ZO=WA({Complex:FM,add:yO,multiply:D_,number:e_,typed:cD}),eI=UA({addScalar:pD,combinations:ND,divideScalar:RO,isInteger:VD,isNegative:UD,multiplyScalar:JD,typed:cD}),tI=YA({compare:EO,typed:cD}),nI=$A({addScalar:pD,combinations:ND,isInteger:VD,isNegative:UD,isPositive:qD,larger:jO,typed:cD}),rI=QA({matrix:k_,multiply:D_,subtract:XO,typed:cD}),iI=JA({divideScalar:RO,isZero:GD,matrix:k_,multiply:D_,subtractScalar:m_,typed:cD,unaryMinus:pO}),oI=gv({matrix:k_,number:e_,subtract:XO,typed:cD}),aI=eR({abs:dD,addScalar:pD,deepEqual:AO,divideScalar:RO,multiplyScalar:JD,sqrt:H_,subtractScalar:m_,typed:cD}),sI=nR({DenseMatrix:rD,SparseMatrix:u_,concat:Y_,divideScalar:RO,equalScalar:_D,matrix:k_,typed:cD}),lI=rR({larger:jO,smaller:fO}),cI=oR({Index:PO,typed:cD}),uI=aR({abs:dD,add:yO,addScalar:pD,config:dd,divideScalar:RO,equalScalar:_D,flatten:FD,isNumeric:tO,isZero:GD,matrix:k_,multiply:D_,multiplyScalar:JD,smaller:fO,subtract:XO,typed:cD}),dI=lR({BigNumber:jM,add:yO,config:dd,equal:J_,isInteger:VD,mod:zO,smaller:fO,typed:cD,xgcd:W_}),hI=cR({concat:Y_,equalScalar:_D,matrix:k_,typed:cD}),fI=dR({Complex:FM,config:dd,divideScalar:RO,log:FO,typed:cD}),mI=fR({DenseMatrix:rD,divideScalar:RO,equalScalar:_D,matrix:k_,multiplyScalar:JD,subtractScalar:m_,typed:cD}),pI=bg({config:dd,isNaN:T_,larger:jO,numeric:lO,typed:cD}),gI=xv({bignumber:x_,matrix:k_,add:yO,config:dd,equal:J_,isPositive:qD,isZero:GD,larger:jO,largerEq:rO,smaller:fO,smallerEq:KO,typed:cD}),vI=Cv({Index:PO,matrix:k_,range:gI,typed:cD}),yI=pR({DenseMatrix:rD,Index:PO,compareNatural:tI,size:c_,subset:$O,typed:cD}),bI=vR({DenseMatrix:rD,Index:PO,compareNatural:tI,size:c_,subset:$O,typed:cD}),wI=bR({Index:PO,compareNatural:tI,size:c_,subset:$O,typed:cD}),xI=xR({Index:PO,compareNatural:tI,size:c_,subset:$O,typed:cD}),SI=IR({SparseMatrix:u_,abs:dD,add:yO,divideScalar:RO,larger:jO,largerEq:rO,multiply:D_,subtract:XO,transpose:z_,typed:cD}),CI=jR({compare:EO,compareNatural:tI,matrix:k_,typed:cD}),EI=HR({config:dd,numeric:lO,typed:cD}),NI=BR({DenseMatrix:rD,divideScalar:RO,equalScalar:_D,matrix:k_,multiplyScalar:JD,subtractScalar:m_,typed:cD}),TI=fg({concat:Y_,equalScalar:_D,matrix:k_,not:ZD,typed:cD,zeros:V_}),AI=qR({DenseMatrix:rD,config:dd,equalScalar:_D,matrix:k_,round:hO,typed:cD,zeros:V_}),RI=Tv({Index:PO,matrix:k_,range:gI,typed:cD}),kI=kv({add:yO,typed:cD,unaryPlus:EI}),MI=$R({Complex:FM,DenseMatrix:rD,ceil:AI,equalScalar:_D,floor:MO,matrix:k_,typed:cD,zeros:V_}),DI=QR({DenseMatrix:rD,Index:PO,compareNatural:tI,size:c_,subset:$O,typed:cD}),_I=ZR({Index:PO,compareNatural:tI,size:c_,subset:$O,typed:cD}),OI=tk({Index:PO,concat:Y_,setDifference:DI,size:c_,subset:$O,typed:cD}),II=nk({FibonacciHeap:lI,addScalar:pD,equalScalar:_D}),PI=Rg({add:yO,config:dd,numeric:lO,typed:cD}),jI=rk({abs:dD,addScalar:pD,det:iI,divideScalar:RO,identity:eO,matrix:k_,multiply:D_,typed:cD,unaryMinus:pO}),FI=ik({DenseMatrix:rD,Spa:II,SparseMatrix:u_,abs:dD,addScalar:pD,divideScalar:RO,equalScalar:_D,larger:jO,matrix:k_,multiplyScalar:JD,subtractScalar:m_,typed:cD,unaryMinus:pO}),HI=ak({Complex:FM,add:yO,ctranspose:$_,deepEqual:AO,divideScalar:RO,dot:N_,dotDivide:sI,equal:J_,inv:jI,matrix:k_,multiply:D_,typed:cD}),LI=sk({Complex:FM,config:dd,fraction:Z_,identity:eO,inv:jI,matrix:k_,multiply:D_,number:e_,typed:cD}),BI=ck({DenseMatrix:rD,Index:PO,compareNatural:tI,size:c_,subset:$O,typed:cD}),zI=dk({Index:PO,concat:Y_,setIntersect:BI,setSymDifference:OI,size:c_,subset:$O,typed:cD}),WI=fk({abs:dD,add:yO,identity:eO,inv:jI,map:QD,max:pI,multiply:D_,size:c_,sqrt:H_,subtract:XO,typed:cD}),VI=gk({BigNumber:jM,Complex:FM,Fraction:zM,abs:dD,addScalar:pD,config:dd,divideScalar:RO,equal:J_,fix:MI,format:LD,isNumeric:tO,multiplyScalar:JD,number:e_,pow:LI,round:hO,subtractScalar:m_,toBest:g_}),UI=gw({BigNumber:jM,Unit:VI,config:dd}),qI=Jw({BigNumber:jM,Unit:VI,config:dd}),GI=Bw({BigNumber:jM,Unit:VI,config:dd}),YI=ww({BigNumber:jM,Unit:VI,config:dd}),KI=Ww({BigNumber:jM,Unit:VI,config:dd}),$I=xw({BigNumber:jM,Unit:VI,config:dd}),XI=vw({BigNumber:jM,Unit:VI,config:dd}),QI=yk({Unit:VI,typed:cD}),JI=Ow({BigNumber:jM,Unit:VI,config:dd}),ZI=wk({DenseMatrix:rD,SparseMatrix:u_,concat:Y_,equalScalar:_D,matrix:k_,pow:LI,typed:cD}),eP=pw({BigNumber:jM,Unit:VI,config:dd}),tP=bw({BigNumber:jM,Unit:VI,config:dd}),nP=Sk({abs:dD,add:yO,identity:eO,inv:jI,multiply:D_,typed:cD}),rP=Vw({BigNumber:jM,Unit:VI,config:dd}),iP=Ck({addScalar:pD,ceil:AI,conj:AD,divideScalar:RO,dotDivide:sI,exp:ID,i:WM,log2:XD,matrix:k_,multiplyScalar:JD,pow:LI,tau:eD,typed:cD}),oP=Nk({BigNumber:jM,Complex:FM,config:dd,multiplyScalar:JD,pow:LI,typed:cD}),aP=dw({BigNumber:jM,Unit:VI,config:dd}),sP=Dw({BigNumber:jM,Unit:VI,config:dd}),lP=Ak({conj:AD,dotDivide:sI,fft:iP,typed:cD}),cP=Nw({BigNumber:jM,Unit:VI,config:dd}),uP=qw({BigNumber:jM,Unit:VI,config:dd}),dP=mw({BigNumber:jM,Unit:VI,config:dd}),hP=Zw({BigNumber:jM,Unit:VI,config:dd}),fP=Yw({BigNumber:jM,Unit:VI,config:dd}),mP=Iw({BigNumber:jM,Unit:VI,config:dd}),pP=Ew({BigNumber:jM,Unit:VI,config:dd}),gP=ox({BigNumber:jM,Unit:VI,config:dd}),vP=nx({BigNumber:jM,Unit:VI,config:dd}),yP=ax({BigNumber:jM,Unit:VI,config:dd}),bP=_w({BigNumber:jM,Unit:VI,config:dd}),wP=Pw({BigNumber:jM,Unit:VI,config:dd}),xP=fw({BigNumber:jM,Unit:VI,config:dd}),SP=jw({BigNumber:jM,Unit:VI,config:dd}),CP=Xw({BigNumber:jM,Unit:VI,config:dd}),EP=uw({BigNumber:jM,Unit:VI,config:dd}),NP=Qw({BigNumber:jM,Unit:VI,config:dd}),TP=Fw({BigNumber:jM,Unit:VI,config:dd}),AP=zw({BigNumber:jM,Unit:VI,config:dd}),RP=Tw({BigNumber:jM,Unit:VI,config:dd}),kP=yw({BigNumber:jM,Unit:VI,config:dd}),MP=Rk({divideScalar:RO,equalScalar:_D,inv:jI,matrix:k_,multiply:D_,typed:cD}),DP=Rw({BigNumber:jM,Unit:VI,config:dd}),_P=Mk({gamma:oP,typed:cD}),OP=Uw({BigNumber:jM,Unit:VI,config:dd}),IP=tx({BigNumber:jM,Unit:VI,config:dd}),PP=Sw({BigNumber:jM,Unit:VI,config:dd}),jP=Ok({DenseMatrix:rD,lsolve:HO,lup:FI,matrix:k_,slu:SI,typed:cD,usolve:JO}),FP=Cw({BigNumber:jM,Unit:VI,config:dd}),HP=ex({BigNumber:jM,Unit:VI,config:dd}),LP=Pk({add:yO,divide:MP,factorial:_P,isInteger:VD,isPositive:qD,multiply:D_,typed:cD}),BP=Fk({factorial:_P,typed:cD}),zP=rx({BigNumber:jM,Unit:VI,config:dd}),WP=Bk({add:yO,cbrt:CO,divide:MP,equalScalar:_D,im:WD,isZero:GD,multiply:D_,re:o_,sqrt:H_,subtract:XO,typeOf:v_,typed:cD,unaryMinus:pO}),VP=Wk({compareNatural:tI,typed:cD}),UP=Uk({abs:dD,add:yO,bignumber:x_,divide:MP,isNegative:UD,isPositive:qD,larger:jO,map:QD,matrix:k_,max:pI,multiply:D_,smaller:fO,subtract:XO,typed:cD,unaryMinus:pO}),qP=Gk({bignumber:x_,addScalar:pD,combinations:ND,divideScalar:RO,factorial:_P,isInteger:VD,isNegative:UD,larger:jO,multiplyScalar:JD,number:e_,pow:LI,subtractScalar:m_,typed:cD}),GP=Kk({Unit:VI,typed:cD}),YP=Xk({addScalar:pD,isInteger:VD,isNegative:UD,stirlingS2:qP,typed:cD}),KP=eM({abs:dD,add:yO,addScalar:pD,atan:bD,bignumber:x_,column:RI,complex:TD,config:dd,cos:RD,diag:X_,divideScalar:RO,dot:N_,equal:J_,flatten:FD,im:WD,inv:jI,larger:jO,matrix:k_,matrixFromColumns:LO,multiply:D_,multiplyScalar:JD,number:e_,qr:GO,re:o_,reshape:I_,sin:l_,size:c_,smaller:fO,sqrt:H_,subtract:XO,typed:cD,usolve:JO,usolveAll:NI}),$P=kw({BigNumber:jM,Unit:VI,config:dd}),XP=Gw({BigNumber:jM,Unit:VI,config:dd}),QP=rM({divide:MP,dotDivide:sI,isNumeric:tO,log:FO,map:QD,matrix:k_,multiply:D_,sum:PI,typed:cD}),JP=Ov({add:yO,divide:MP,typed:cD}),ZP=Kw({BigNumber:jM,Unit:VI,config:dd}),ej=hw({BigNumber:jM,Unit:VI,config:dd}),tj=jv({bignumber:x_,add:yO,compare:EO,divide:MP,isInteger:VD,larger:jO,mapSlices:R_,multiply:D_,partitionSelect:qO,smaller:fO,smallerEq:KO,subtract:XO,typed:cD}),nj=Bv({add:yO,divide:MP,isNaN:T_,mapSlices:R_,multiply:D_,subtract:XO,typed:cD}),rj=Aw({BigNumber:jM,Unit:VI,config:dd}),ij=aM({add:yO,compare:EO,divide:MP,partitionSelect:qO,typed:cD}),oj=cM({add:yO,divide:MP,matrix:k_,mean:JP,multiply:D_,pow:LI,sqrt:H_,subtract:XO,sum:PI,typed:cD}),aj=hM({Complex:FM,add:yO,divide:MP,matrix:k_,multiply:D_,typed:cD}),sj=mM({abs:dD,map:QD,median:ij,subtract:XO,typed:cD}),lj=Vv({map:QD,sqrt:H_,typed:cD,variance:nj}),cj=vM({BigNumber:jM,Complex:FM,add:yO,config:dd,divide:MP,equal:J_,factorial:_P,gamma:oP,isNegative:UD,multiply:D_,pi:aD,pow:LI,sin:l_,smallerEq:KO,subtract:XO,typed:cD}),uj=wM({abs:dD,add:yO,conj:AD,ctranspose:$_,eigs:KP,equalScalar:_D,larger:jO,matrix:k_,multiply:D_,pow:LI,smaller:fO,sqrt:H_,typed:cD}),dj=CM({BigNumber:jM,DenseMatrix:rD,SparseMatrix:u_,addScalar:pD,config:dd,cos:RD,matrix:k_,multiplyScalar:JD,norm:uj,sin:l_,typed:cD,unaryMinus:pO}),hj=ix({BigNumber:jM,Unit:VI,config:dd}),fj=TM({identity:eO,matrix:k_,multiply:D_,norm:uj,qr:GO,subtract:XO,typed:cD}),mj=kM({multiply:D_,rotationMatrix:dj,typed:cD}),pj=_M({abs:dD,add:yO,concat:Y_,identity:eO,index:cI,lusolve:jP,matrix:k_,matrixFromColumns:LO,multiply:D_,range:gI,schur:fj,subset:$O,subtract:XO,transpose:z_,typed:cD}),gj=PM({matrix:k_,multiply:D_,sylvester:pj,transpose:z_,typed:cD}),vj={},yj={},bj={},wj=bh({mathWithTransform:yj}),xj=rf({Node:wj}),Sj=em({Node:wj}),Cj=nm({Node:wj}),Ej=im({Node:wj}),Nj=am({Node:wj}),Tj=lm({Node:wj,ResultSet:QM}),Aj=um({Node:wj}),Rj=hm({Node:wj}),kj=mm({Node:wj}),Mj=pm({classes:bj}),Dj=gm({math:vj,typed:cD}),_j=ym({Node:wj,typed:cD}),Oj=wm({Chain:Dj,typed:cD}),Ij=Sm({Node:wj,size:c_}),Pj=Tm({Node:wj,subset:$O}),jj=Rm({matrix:k_,Node:wj,subset:$O}),Fj=km({Unit:VI,Node:wj,math:vj}),Hj=Dm({Node:wj,SymbolNode:Fj,math:vj}),Lj=Bm({AccessorNode:Pj,ArrayNode:Nj,AssignmentNode:jj,BlockNode:Tj,ConditionalNode:Aj,ConstantNode:Rj,FunctionAssignmentNode:_j,FunctionNode:Hj,IndexNode:Ij,ObjectNode:xj,OperatorNode:Sj,ParenthesisNode:Cj,RangeNode:kj,RelationalNode:Ej,SymbolNode:Fj,config:dd,numeric:lO,typed:cD}),Bj=zm({ConstantNode:Rj,FunctionNode:Hj,OperatorNode:Sj,ParenthesisNode:Cj,parse:Lj,typed:cD}),zj=Ym({bignumber:x_,fraction:Z_,AccessorNode:Pj,ArrayNode:Nj,ConstantNode:Rj,FunctionNode:Hj,IndexNode:Ij,ObjectNode:xj,OperatorNode:Sj,SymbolNode:Fj,config:dd,mathWithTransform:yj,matrix:k_,typed:cD}),Wj=$m({parse:Lj,typed:cD}),Vj=Qm({AccessorNode:Pj,ArrayNode:Nj,ConstantNode:Rj,FunctionNode:Hj,IndexNode:Ij,ObjectNode:xj,OperatorNode:Sj,ParenthesisNode:Cj,SymbolNode:Fj,add:yO,divide:MP,equal:J_,isZero:GD,multiply:D_,parse:Lj,pow:LI,subtract:XO,typed:cD}),Uj=Zm({parse:Lj,typed:cD}),qj=ep({evaluate:Uj}),Gj=tp({evaluate:Uj,parse:Lj}),Yj=ap({AccessorNode:Pj,ArrayNode:Nj,ConstantNode:Rj,FunctionNode:Hj,IndexNode:Ij,ObjectNode:xj,OperatorNode:Sj,ParenthesisNode:Cj,SymbolNode:Fj,equal:J_,parse:Lj,replacer:sD,resolve:Bj,simplifyConstant:zj,simplifyCore:Vj,typed:cD}),Kj=cp({OperatorNode:Sj,parse:Lj,simplify:Yj,typed:cD}),$j=hp({parse:Lj,typed:cD}),Xj=pp({Parser:Gj,typed:cD}),Qj=yp({bignumber:x_,fraction:Z_,AccessorNode:Pj,ArrayNode:Nj,ConstantNode:Rj,FunctionNode:Hj,IndexNode:Ij,ObjectNode:xj,OperatorNode:Sj,ParenthesisNode:Cj,SymbolNode:Fj,add:yO,config:dd,divide:MP,equal:J_,isZero:GD,mathWithTransform:yj,matrix:k_,multiply:D_,parse:Lj,pow:LI,simplify:Yj,simplifyConstant:zj,simplifyCore:Vj,subtract:XO,typed:cD}),Jj=xp({ConstantNode:Rj,FunctionNode:Hj,OperatorNode:Sj,ParenthesisNode:Cj,SymbolNode:Fj,config:dd,equal:J_,isZero:GD,numeric:lO,parse:Lj,simplify:Yj,typed:cD}),Zj=Tp({Help:qj,mathWithTransform:yj,typed:cD});function eF(e,t){return Array.isArray(e)?e.includes(t):e===t}sd(vj,{e:HM,false:LM,fineStructure:BM,i:WM,Infinity:VM,LN10:UM,LOG10E:qM,NaN:YM,null:KM,phi:$M,SQRT1_2:JM,sackurTetrode:ZM,tau:eD,true:tD,E:HM,version:nD,efimovFactor:iD,LN2:oD,pi:aD,replacer:sD,reviver:Mj,SQRT2:lD,typed:cD,PI:aD,weakMixingAngle:uD,abs:dD,acos:hD,acot:fD,acsc:mD,addScalar:pD,arg:gD,asech:vD,asinh:yD,atan:bD,atanh:wD,bigint:xD,bitNot:SD,boolean:CD,clone:ED,combinations:ND,complex:TD,conj:AD,cos:RD,cot:kD,csc:MD,cube:DD,equalScalar:_D,erf:OD,exp:ID,expm1:PD,filter:jD,flatten:FD,forEach:HD,format:LD,getMatrixDataType:BD,hex:zD,im:WD,isInteger:VD,isNegative:UD,isPositive:qD,isZero:GD,LOG2E:YD,lgamma:KD,log10:$D,log2:XD,map:QD,multiplyScalar:JD,not:ZD,number:e_,oct:t_,pickRandom:n_,print:r_,random:i_,re:o_,sec:a_,sign:s_,sin:l_,size:c_,splitUnit:d_,square:h_,string:f_,subtractScalar:m_,tan:p_,toBest:g_,typeOf:v_,acosh:y_,acsch:b_,asec:w_,bignumber:x_,chain:Oj,combinationsWithRep:S_,cosh:C_,csch:E_,dot:N_,isNaN:T_,isPrime:A_,mapSlices:R_,matrix:k_,matrixFromFunction:M_,multiply:D_,ones:__,randomInt:O_,reshape:I_,sech:P_,sinh:j_,sparse:F_,sqrt:H_,squeeze:L_,tanh:B_,transpose:z_,xgcd:W_,zeros:V_,acoth:U_,asin:q_,bin:G_,concat:Y_,coth:K_,ctranspose:$_,diag:X_,dotMultiply:Q_,equal:J_,fraction:Z_,identity:eO,isNumeric:tO,kron:nO,largerEq:rO,leftShift:iO,matrixFromRows:oO,mode:aO,nthRoot:sO,numeric:lO,prod:cO,resize:uO,rightArithShift:dO,round:hO,smaller:fO,to:mO,unaryMinus:pO,unequal:gO,xor:vO,add:yO,atan2:bO,bitAnd:wO,bitOr:xO,bitXor:SO,cbrt:CO,compare:EO,compareText:NO,count:TO,deepEqual:AO,divideScalar:RO,equalText:kO,floor:MO,gcd:DO,hasNumericValue:_O,hypot:OO,larger:jO,log:FO,lsolve:HO,matrixFromColumns:LO,min:BO,mod:zO,nthRoots:WO,nullish:VO,or:UO,partitionSelect:qO,qr:GO,rightLogShift:YO,smallerEq:KO,subset:$O,subtract:XO,trace:QO,usolve:JO,zpk2tf:ZO,catalan:eI,compareNatural:tI,composition:nI,cross:rI,det:iI,diff:oI,distance:aI,dotDivide:sI,index:cI,intersect:uI,invmod:dI,lcm:hI,log1p:fI,lsolveAll:mI,max:pI,range:gI,row:vI,setCartesian:yI,setDistinct:bI,setIsSubset:wI,setPowerset:xI,slu:SI,sort:CI,unaryPlus:EI,usolveAll:NI,and:TI,ceil:AI,column:RI,cumsum:kI,fix:MI,setDifference:DI,setMultiplicity:_I,setSymDifference:OI,sum:PI,inv:jI,lup:FI,pinv:HI,pow:LI,setIntersect:BI,setUnion:zI,sqrtm:WI,vacuumImpedance:UI,wienDisplacement:qI,atomicMass:GI,bohrMagneton:YI,boltzmann:KI,conductanceQuantum:$I,coulomb:XI,createUnit:QI,deuteronMass:JI,dotPow:ZI,electricConstant:eP,elementaryCharge:tP,expm:nP,faraday:rP,fft:iP,gamma:oP,gravitationConstant:aP,hartreeEnergy:sP,ifft:lP,klitzing:cP,loschmidt:uP,magneticConstant:dP,molarMass:hP,molarPlanckConstant:fP,neutronMass:mP,nuclearMagneton:pP,planckCharge:gP,planckLength:vP,planckTemperature:yP,protonMass:bP,quantumOfCirculation:wP,reducedPlanckConstant:xP,rydberg:SP,secondRadiation:CP,speedOfLight:EP,stefanBoltzmann:NP,thomsonCrossSection:TP,avogadro:AP,bohrRadius:RP,coulombConstant:kP,divide:MP,electronMass:DP,factorial:_P,firstRadiation:OP,gravity:IP,inverseConductanceQuantum:PP,lusolve:jP,magneticFluxQuantum:FP,molarMassC12:HP,multinomial:LP,parse:Lj,permutations:BP,planckMass:zP,polynomialRoot:WP,resolve:Bj,setSize:VP,simplifyConstant:zj,solveODE:UP,stirlingS2:qP,unit:GP,bellNumbers:YP,compile:Wj,eigs:KP,fermiCoupling:$P,gasConstant:XP,kldivergence:QP,mean:JP,molarVolume:ZP,planckConstant:ej,quantileSeq:tj,simplifyCore:Vj,variance:nj,classicalElectronRadius:rj,evaluate:Uj,median:ij,simplify:Yj,symbolicEqual:Kj,corr:oj,freqz:aj,leafCount:$j,mad:sj,parser:Xj,rationalize:Qj,std:lj,zeta:cj,derivative:Jj,norm:uj,rotationMatrix:dj,help:Zj,planckTime:hj,schur:fj,rotate:mj,sylvester:pj,lyap:gj,config:dd}),sd(yj,vj,{mapSlices:Dp({isInteger:VD,typed:cD}),filter:Wp({typed:cD}),forEach:Gp({typed:cD}),map:$p({typed:cD}),or:cg({DenseMatrix:rD,concat:Y_,equalScalar:_D,matrix:k_,typed:cD}),and:mg({add:yO,concat:Y_,equalScalar:_D,matrix:k_,not:ZD,typed:cD,zeros:V_}),concat:vg({isInteger:VD,matrix:k_,typed:cD}),max:xg({config:dd,isNaN:T_,larger:jO,numeric:lO,typed:cD}),print:Ag({add:yO,matrix:k_,typed:cD,zeros:V_}),sum:kg({add:yO,config:dd,numeric:lO,typed:cD}),bitAnd:Kg({add:yO,concat:Y_,equalScalar:_D,matrix:k_,not:ZD,typed:cD,zeros:V_}),min:Xg({config:dd,isNaN:T_,numeric:lO,smaller:fO,typed:cD}),nullish:Zg({deepEqual:AO,flatten:FD,matrix:k_,size:c_,typed:cD}),subset:lv({add:yO,matrix:k_,typed:cD,zeros:V_}),bitOr:mv({DenseMatrix:rD,concat:Y_,equalScalar:_D,matrix:k_,typed:cD}),diff:yv({bignumber:x_,matrix:k_,number:e_,subtract:XO,typed:cD}),index:bv({Index:PO,getMatrixDataType:BD}),range:Sv({bignumber:x_,matrix:k_,add:yO,config:dd,equal:J_,isPositive:qD,isZero:GD,larger:jO,largerEq:rO,smaller:fO,smallerEq:KO,typed:cD}),row:Ev({Index:PO,matrix:k_,range:gI,typed:cD}),column:Av({Index:PO,matrix:k_,range:gI,typed:cD}),cumsum:Dv({add:yO,typed:cD,unaryPlus:EI}),mean:Iv({add:yO,divide:MP,typed:cD}),quantileSeq:Fv({add:yO,bignumber:x_,compare:EO,divide:MP,isInteger:VD,larger:jO,mapSlices:R_,multiply:D_,partitionSelect:qO,smaller:fO,smallerEq:KO,subtract:XO,typed:cD}),variance:Wv({add:yO,divide:MP,isNaN:T_,mapSlices:R_,multiply:D_,subtract:XO,typed:cD}),std:Uv({map:QD,sqrt:H_,typed:cD,variance:nj})}),sd(bj,{BigNumber:jM,Complex:FM,Fraction:zM,Matrix:GM,Node:wj,ObjectNode:xj,OperatorNode:Sj,ParenthesisNode:Cj,Range:XM,RelationalNode:Ej,ResultSet:QM,ArrayNode:Nj,BlockNode:Tj,ConditionalNode:Aj,ConstantNode:Rj,DenseMatrix:rD,RangeNode:kj,Chain:Dj,FunctionAssignmentNode:_j,SparseMatrix:u_,IndexNode:Ij,ImmutableDenseMatrix:IO,Index:PO,AccessorNode:Pj,AssignmentNode:jj,FibonacciHeap:lI,Spa:II,Unit:VI,SymbolNode:Fj,FunctionNode:Hj,Help:qj,Parser:Gj}),Dj.createProxy(vj);const tF=g.createContext({});tF.displayName="AccordionContext";const nF=tF,rF=["as","bsPrefix","className","children","eventKey"],iF=g.forwardRef((e,t)=>{let{as:n="div",bsPrefix:r,className:i,children:o,eventKey:a}=e,s=b(e,rF);const{activeEventKey:l}=(0,g.useContext)(nF);return r=Gt(r,"accordion-collapse"),(0,Bt.jsx)(fc,E(E({ref:t,in:eF(l,a)},s),{},{className:Lt(i,r),children:(0,Bt.jsx)(n,{children:g.Children.only(o)})}))});iF.displayName="AccordionCollapse";const oF=iF,aF=g.createContext({eventKey:""});aF.displayName="AccordionItemContext";const sF=aF,lF=["as","bsPrefix","className","onEnter","onEntering","onEntered","onExit","onExiting","onExited"],cF=g.forwardRef((e,t)=>{let{as:n="div",bsPrefix:r,className:i,onEnter:o,onEntering:a,onEntered:s,onExit:l,onExiting:c,onExited:u}=e,d=b(e,lF);r=Gt(r,"accordion-body");const{eventKey:h}=(0,g.useContext)(sF);return(0,Bt.jsx)(oF,{eventKey:h,onEnter:o,onEntering:a,onEntered:s,onExit:l,onExiting:c,onExited:u,children:(0,Bt.jsx)(n,E(E({ref:t},d),{},{className:Lt(i,r)}))})});cF.displayName="AccordionBody";const uF=cF;const dF=["as","bsPrefix","className","onClick"],hF=g.forwardRef((e,t)=>{let{as:n="button",bsPrefix:r,className:i,onClick:o}=e,a=b(e,dF);r=Gt(r,"accordion-button");const{eventKey:s}=(0,g.useContext)(sF),l=function(e,t){const{activeEventKey:n,onSelect:r,alwaysOpen:i}=(0,g.useContext)(nF);return o=>{let a=e===n?null:e;i&&(a=Array.isArray(n)?n.includes(e)?n.filter(t=>t!==e):[...n,e]:[e]),null==r||r(a,o),null==t||t(o)}}(s,o),{activeEventKey:c}=(0,g.useContext)(nF);return"button"===n&&(a.type="button"),(0,Bt.jsx)(n,E(E({ref:t,onClick:l},a),{},{"aria-expanded":Array.isArray(c)?c.includes(s):s===c,className:Lt(i,r,!eF(c,s)&&"collapsed")}))});hF.displayName="AccordionButton";const fF=hF,mF=["as","aria-controls","bsPrefix","className","children","disabled","onClick"],pF=g.forwardRef((e,t)=>{let{as:n="h2","aria-controls":r,bsPrefix:i,className:o,children:a,disabled:s,onClick:l}=e,c=b(e,mF);return i=Gt(i,"accordion-header"),(0,Bt.jsx)(n,E(E({ref:t},c),{},{className:Lt(o,i),children:(0,Bt.jsx)(fF,{onClick:l,"aria-controls":r,disabled:s,children:a})}))});pF.displayName="AccordionHeader";const gF=pF,vF=["as","bsPrefix","className","eventKey"],yF=g.forwardRef((e,t)=>{let{as:n="div",bsPrefix:r,className:i,eventKey:o}=e,a=b(e,vF);r=Gt(r,"accordion-item");const s=(0,g.useMemo)(()=>({eventKey:o}),[o]);return(0,Bt.jsx)(sF.Provider,{value:s,children:(0,Bt.jsx)(n,E(E({ref:t},a),{},{className:Lt(i,r)}))})});yF.displayName="AccordionItem";const bF=yF,wF=["as","activeKey","bsPrefix","className","onSelect","flush","alwaysOpen"],xF=g.forwardRef((e,t)=>{const n=rn(e,{activeKey:"onSelect"}),{as:r="div",activeKey:i,bsPrefix:o,className:a,onSelect:s,flush:l,alwaysOpen:c}=n,u=b(n,wF),d=Gt(o,"accordion"),h=(0,g.useMemo)(()=>({activeEventKey:i,onSelect:s,alwaysOpen:c}),[i,s,c]);return(0,Bt.jsx)(nF.Provider,{value:h,children:(0,Bt.jsx)(r,E(E({ref:t},u),{},{className:Lt(a,d,l&&"".concat(d,"-flush"))}))})});xF.displayName="Accordion";const SF=Object.assign(xF,{Button:fF,Collapse:oF,Item:bF,Header:gF,Body:uF});n(8776),n(4647);const{entries:CF,setPrototypeOf:EF,isFrozen:NF,getPrototypeOf:TF,getOwnPropertyDescriptor:AF}=Object;let{freeze:RF,seal:kF,create:MF}=Object,{apply:DF,construct:_F}="undefined"!==typeof Reflect&&Reflect;RF||(RF=function(e){return e}),kF||(kF=function(e){return e}),DF||(DF=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return e.apply(t,r)}),_F||(_F=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new e(...n)});const OF=KF(Array.prototype.forEach),IF=KF(Array.prototype.lastIndexOf),PF=KF(Array.prototype.pop),jF=KF(Array.prototype.push),FF=KF(Array.prototype.splice),HF=KF(String.prototype.toLowerCase),LF=KF(String.prototype.toString),BF=KF(String.prototype.match),zF=KF(String.prototype.replace),WF=KF(String.prototype.indexOf),VF=KF(String.prototype.trim),UF=KF(Object.prototype.hasOwnProperty),qF=KF(RegExp.prototype.test),GF=(YF=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return _F(YF,t)});var YF;function KF(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return DF(e,t,r)}}function $F(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:HF;EF&&EF(e,null);let r=t.length;for(;r--;){let i=t[r];if("string"===typeof i){const e=n(i);e!==i&&(NF(t)||(t[r]=e),i=e)}e[i]=!0}return e}function XF(e){for(let t=0;t<e.length;t++){UF(e,t)||(e[t]=null)}return e}function QF(e){const t=MF(null);for(const[n,r]of CF(e)){UF(e,n)&&(Array.isArray(r)?t[n]=XF(r):r&&"object"===typeof r&&r.constructor===Object?t[n]=QF(r):t[n]=r)}return t}function JF(e,t){for(;null!==e;){const n=AF(e,t);if(n){if(n.get)return KF(n.get);if("function"===typeof n.value)return KF(n.value)}e=TF(e)}return function(){return null}}const ZF=RF(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),eH=RF(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),tH=RF(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),nH=RF(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),rH=RF(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),iH=RF(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),oH=RF(["#text"]),aH=RF(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),sH=RF(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),lH=RF(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),cH=RF(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),uH=kF(/\{\{[\w\W]*|[\w\W]*\}\}/gm),dH=kF(/<%[\w\W]*|[\w\W]*%>/gm),hH=kF(/\$\{[\w\W]*/gm),fH=kF(/^data-[\-\w.\u00B7-\uFFFF]+$/),mH=kF(/^aria-[\-\w]+$/),pH=kF(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),gH=kF(/^(?:\w+script|data):/i),vH=kF(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),yH=kF(/^html$/i),bH=kF(/^[a-z][.\w]*(-[.\w]+)+$/i);var wH=Object.freeze({__proto__:null,ARIA_ATTR:mH,ATTR_WHITESPACE:vH,CUSTOM_ELEMENT:bH,DATA_ATTR:fH,DOCTYPE_NAME:yH,ERB_EXPR:dH,IS_ALLOWED_URI:pH,IS_SCRIPT_OR_DATA:gH,MUSTACHE_EXPR:uH,TMPLIT_EXPR:hH});const xH=1,SH=3,CH=7,EH=8,NH=9,TH=function(){return"undefined"===typeof window?null:window};var AH=function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:TH();const n=t=>e(t);if(n.version="3.3.0",n.removed=[],!t||!t.document||t.document.nodeType!==NH||!t.Element)return n.isSupported=!1,n;let{document:r}=t;const i=r,o=i.currentScript,{DocumentFragment:a,HTMLTemplateElement:s,Node:l,Element:c,NodeFilter:u,NamedNodeMap:d=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:f,trustedTypes:m}=t,p=c.prototype,g=JF(p,"cloneNode"),v=JF(p,"remove"),y=JF(p,"nextSibling"),b=JF(p,"childNodes"),w=JF(p,"parentNode");if("function"===typeof s){const e=r.createElement("template");e.content&&e.content.ownerDocument&&(r=e.content.ownerDocument)}let x,S="";const{implementation:C,createNodeIterator:E,createDocumentFragment:N,getElementsByTagName:T}=r,{importNode:A}=i;let R={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};n.isSupported="function"===typeof CF&&"function"===typeof w&&C&&void 0!==C.createHTMLDocument;const{MUSTACHE_EXPR:k,ERB_EXPR:M,TMPLIT_EXPR:D,DATA_ATTR:_,ARIA_ATTR:O,IS_SCRIPT_OR_DATA:I,ATTR_WHITESPACE:P,CUSTOM_ELEMENT:j}=wH;let{IS_ALLOWED_URI:F}=wH,H=null;const L=$F({},[...ZF,...eH,...tH,...rH,...oH]);let B=null;const z=$F({},[...aH,...sH,...lH,...cH]);let W=Object.seal(MF(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),V=null,U=null;const q=Object.seal(MF(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let G=!0,Y=!0,K=!1,$=!0,X=!1,Q=!0,J=!1,Z=!1,ee=!1,te=!1,ne=!1,re=!1,ie=!0,oe=!1,ae=!0,se=!1,le={},ce=null;const ue=$F({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let de=null;const he=$F({},["audio","video","img","source","image","track"]);let fe=null;const me=$F({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),pe="http://www.w3.org/1998/Math/MathML",ge="http://www.w3.org/2000/svg",ve="http://www.w3.org/1999/xhtml";let ye=ve,be=!1,we=null;const xe=$F({},[pe,ge,ve],LF);let Se=$F({},["mi","mo","mn","ms","mtext"]),Ce=$F({},["annotation-xml"]);const Ee=$F({},["title","style","font","a","script"]);let Ne=null;const Te=["application/xhtml+xml","text/html"];let Ae=null,Re=null;const ke=r.createElement("form"),Me=function(e){return e instanceof RegExp||e instanceof Function},De=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!Re||Re!==e){if(e&&"object"===typeof e||(e={}),e=QF(e),Ne=-1===Te.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,Ae="application/xhtml+xml"===Ne?LF:HF,H=UF(e,"ALLOWED_TAGS")?$F({},e.ALLOWED_TAGS,Ae):L,B=UF(e,"ALLOWED_ATTR")?$F({},e.ALLOWED_ATTR,Ae):z,we=UF(e,"ALLOWED_NAMESPACES")?$F({},e.ALLOWED_NAMESPACES,LF):xe,fe=UF(e,"ADD_URI_SAFE_ATTR")?$F(QF(me),e.ADD_URI_SAFE_ATTR,Ae):me,de=UF(e,"ADD_DATA_URI_TAGS")?$F(QF(he),e.ADD_DATA_URI_TAGS,Ae):he,ce=UF(e,"FORBID_CONTENTS")?$F({},e.FORBID_CONTENTS,Ae):ue,V=UF(e,"FORBID_TAGS")?$F({},e.FORBID_TAGS,Ae):QF({}),U=UF(e,"FORBID_ATTR")?$F({},e.FORBID_ATTR,Ae):QF({}),le=!!UF(e,"USE_PROFILES")&&e.USE_PROFILES,G=!1!==e.ALLOW_ARIA_ATTR,Y=!1!==e.ALLOW_DATA_ATTR,K=e.ALLOW_UNKNOWN_PROTOCOLS||!1,$=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,X=e.SAFE_FOR_TEMPLATES||!1,Q=!1!==e.SAFE_FOR_XML,J=e.WHOLE_DOCUMENT||!1,te=e.RETURN_DOM||!1,ne=e.RETURN_DOM_FRAGMENT||!1,re=e.RETURN_TRUSTED_TYPE||!1,ee=e.FORCE_BODY||!1,ie=!1!==e.SANITIZE_DOM,oe=e.SANITIZE_NAMED_PROPS||!1,ae=!1!==e.KEEP_CONTENT,se=e.IN_PLACE||!1,F=e.ALLOWED_URI_REGEXP||pH,ye=e.NAMESPACE||ve,Se=e.MATHML_TEXT_INTEGRATION_POINTS||Se,Ce=e.HTML_INTEGRATION_POINTS||Ce,W=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&Me(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(W.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&Me(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(W.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"===typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(W.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),X&&(Y=!1),ne&&(te=!0),le&&(H=$F({},oH),B=[],!0===le.html&&($F(H,ZF),$F(B,aH)),!0===le.svg&&($F(H,eH),$F(B,sH),$F(B,cH)),!0===le.svgFilters&&($F(H,tH),$F(B,sH),$F(B,cH)),!0===le.mathMl&&($F(H,rH),$F(B,lH),$F(B,cH))),e.ADD_TAGS&&("function"===typeof e.ADD_TAGS?q.tagCheck=e.ADD_TAGS:(H===L&&(H=QF(H)),$F(H,e.ADD_TAGS,Ae))),e.ADD_ATTR&&("function"===typeof e.ADD_ATTR?q.attributeCheck=e.ADD_ATTR:(B===z&&(B=QF(B)),$F(B,e.ADD_ATTR,Ae))),e.ADD_URI_SAFE_ATTR&&$F(fe,e.ADD_URI_SAFE_ATTR,Ae),e.FORBID_CONTENTS&&(ce===ue&&(ce=QF(ce)),$F(ce,e.FORBID_CONTENTS,Ae)),ae&&(H["#text"]=!0),J&&$F(H,["html","head","body"]),H.table&&($F(H,["tbody"]),delete V.tbody),e.TRUSTED_TYPES_POLICY){if("function"!==typeof e.TRUSTED_TYPES_POLICY.createHTML)throw GF('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!==typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw GF('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');x=e.TRUSTED_TYPES_POLICY,S=x.createHTML("")}else void 0===x&&(x=function(e,t){if("object"!==typeof e||"function"!==typeof e.createPolicy)return null;let n=null;const r="data-tt-policy-suffix";t&&t.hasAttribute(r)&&(n=t.getAttribute(r));const i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML:e=>e,createScriptURL:e=>e})}catch(o){return console.warn("TrustedTypes policy "+i+" could not be created."),null}}(m,o)),null!==x&&"string"===typeof S&&(S=x.createHTML(""));RF&&RF(e),Re=e}},_e=$F({},[...eH,...tH,...nH]),Oe=$F({},[...rH,...iH]),Ie=function(e){jF(n.removed,{element:e});try{w(e).removeChild(e)}catch(t){v(e)}},Pe=function(e,t){try{jF(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(r){jF(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(te||ne)try{Ie(t)}catch(r){}else try{t.setAttribute(e,"")}catch(r){}},je=function(e){let t=null,n=null;if(ee)e="<remove></remove>"+e;else{const t=BF(e,/^[\r\n\t ]+/);n=t&&t[0]}"application/xhtml+xml"===Ne&&ye===ve&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const i=x?x.createHTML(e):e;if(ye===ve)try{t=(new f).parseFromString(i,Ne)}catch(a){}if(!t||!t.documentElement){t=C.createDocument(ye,"template",null);try{t.documentElement.innerHTML=be?S:i}catch(a){}}const o=t.body||t.documentElement;return e&&n&&o.insertBefore(r.createTextNode(n),o.childNodes[0]||null),ye===ve?T.call(t,J?"html":"body")[0]:J?t.documentElement:o},Fe=function(e){return E.call(e.ownerDocument||e,e,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},He=function(e){return e instanceof h&&("string"!==typeof e.nodeName||"string"!==typeof e.textContent||"function"!==typeof e.removeChild||!(e.attributes instanceof d)||"function"!==typeof e.removeAttribute||"function"!==typeof e.setAttribute||"string"!==typeof e.namespaceURI||"function"!==typeof e.insertBefore||"function"!==typeof e.hasChildNodes)},Le=function(e){return"function"===typeof l&&e instanceof l};function Be(e,t,r){OF(e,e=>{e.call(n,t,r,Re)})}const ze=function(e){let t=null;if(Be(R.beforeSanitizeElements,e,null),He(e))return Ie(e),!0;const r=Ae(e.nodeName);if(Be(R.uponSanitizeElement,e,{tagName:r,allowedTags:H}),Q&&e.hasChildNodes()&&!Le(e.firstElementChild)&&qF(/<[/\w!]/g,e.innerHTML)&&qF(/<[/\w!]/g,e.textContent))return Ie(e),!0;if(e.nodeType===CH)return Ie(e),!0;if(Q&&e.nodeType===EH&&qF(/<[/\w]/g,e.data))return Ie(e),!0;if(!(q.tagCheck instanceof Function&&q.tagCheck(r))&&(!H[r]||V[r])){if(!V[r]&&Ve(r)){if(W.tagNameCheck instanceof RegExp&&qF(W.tagNameCheck,r))return!1;if(W.tagNameCheck instanceof Function&&W.tagNameCheck(r))return!1}if(ae&&!ce[r]){const t=w(e)||e.parentNode,n=b(e)||e.childNodes;if(n&&t){for(let r=n.length-1;r>=0;--r){const i=g(n[r],!0);i.__removalCount=(e.__removalCount||0)+1,t.insertBefore(i,y(e))}}}return Ie(e),!0}return e instanceof c&&!function(e){let t=w(e);t&&t.tagName||(t={namespaceURI:ye,tagName:"template"});const n=HF(e.tagName),r=HF(t.tagName);return!!we[e.namespaceURI]&&(e.namespaceURI===ge?t.namespaceURI===ve?"svg"===n:t.namespaceURI===pe?"svg"===n&&("annotation-xml"===r||Se[r]):Boolean(_e[n]):e.namespaceURI===pe?t.namespaceURI===ve?"math"===n:t.namespaceURI===ge?"math"===n&&Ce[r]:Boolean(Oe[n]):e.namespaceURI===ve?!(t.namespaceURI===ge&&!Ce[r])&&!(t.namespaceURI===pe&&!Se[r])&&!Oe[n]&&(Ee[n]||!_e[n]):!("application/xhtml+xml"!==Ne||!we[e.namespaceURI]))}(e)?(Ie(e),!0):"noscript"!==r&&"noembed"!==r&&"noframes"!==r||!qF(/<\/no(script|embed|frames)/i,e.innerHTML)?(X&&e.nodeType===SH&&(t=e.textContent,OF([k,M,D],e=>{t=zF(t,e," ")}),e.textContent!==t&&(jF(n.removed,{element:e.cloneNode()}),e.textContent=t)),Be(R.afterSanitizeElements,e,null),!1):(Ie(e),!0)},We=function(e,t,n){if(ie&&("id"===t||"name"===t)&&(n in r||n in ke))return!1;if(Y&&!U[t]&&qF(_,t));else if(G&&qF(O,t));else if(q.attributeCheck instanceof Function&&q.attributeCheck(t,e));else if(!B[t]||U[t]){if(!(Ve(e)&&(W.tagNameCheck instanceof RegExp&&qF(W.tagNameCheck,e)||W.tagNameCheck instanceof Function&&W.tagNameCheck(e))&&(W.attributeNameCheck instanceof RegExp&&qF(W.attributeNameCheck,t)||W.attributeNameCheck instanceof Function&&W.attributeNameCheck(t,e))||"is"===t&&W.allowCustomizedBuiltInElements&&(W.tagNameCheck instanceof RegExp&&qF(W.tagNameCheck,n)||W.tagNameCheck instanceof Function&&W.tagNameCheck(n))))return!1}else if(fe[t]);else if(qF(F,zF(n,P,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==WF(n,"data:")||!de[e]){if(K&&!qF(I,zF(n,P,"")));else if(n)return!1}else;return!0},Ve=function(e){return"annotation-xml"!==e&&BF(e,j)},Ue=function(e){Be(R.beforeSanitizeAttributes,e,null);const{attributes:t}=e;if(!t||He(e))return;const r={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:B,forceKeepAttr:void 0};let i=t.length;for(;i--;){const a=t[i],{name:s,namespaceURI:l,value:c}=a,u=Ae(s),d=c;let h="value"===s?d:VF(d);if(r.attrName=u,r.attrValue=h,r.keepAttr=!0,r.forceKeepAttr=void 0,Be(R.uponSanitizeAttribute,e,r),h=r.attrValue,!oe||"id"!==u&&"name"!==u||(Pe(s,e),h="user-content-"+h),Q&&qF(/((--!?|])>)|<\/(style|title|textarea)/i,h)){Pe(s,e);continue}if("attributename"===u&&BF(h,"href")){Pe(s,e);continue}if(r.forceKeepAttr)continue;if(!r.keepAttr){Pe(s,e);continue}if(!$&&qF(/\/>/i,h)){Pe(s,e);continue}X&&OF([k,M,D],e=>{h=zF(h,e," ")});const f=Ae(e.nodeName);if(We(f,u,h)){if(x&&"object"===typeof m&&"function"===typeof m.getAttributeType)if(l);else switch(m.getAttributeType(f,u)){case"TrustedHTML":h=x.createHTML(h);break;case"TrustedScriptURL":h=x.createScriptURL(h)}if(h!==d)try{l?e.setAttributeNS(l,s,h):e.setAttribute(s,h),He(e)?Ie(e):PF(n.removed)}catch(o){Pe(s,e)}}else Pe(s,e)}Be(R.afterSanitizeAttributes,e,null)},qe=function e(t){let n=null;const r=Fe(t);for(Be(R.beforeSanitizeShadowDOM,t,null);n=r.nextNode();)Be(R.uponSanitizeShadowNode,n,null),ze(n),Ue(n),n.content instanceof a&&e(n.content);Be(R.afterSanitizeShadowDOM,t,null)};return n.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,o=null,s=null,c=null;if(be=!e,be&&(e="\x3c!--\x3e"),"string"!==typeof e&&!Le(e)){if("function"!==typeof e.toString)throw GF("toString is not a function");if("string"!==typeof(e=e.toString()))throw GF("dirty is not a string, aborting")}if(!n.isSupported)return e;if(Z||De(t),n.removed=[],"string"===typeof e&&(se=!1),se){if(e.nodeName){const t=Ae(e.nodeName);if(!H[t]||V[t])throw GF("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof l)r=je("\x3c!----\x3e"),o=r.ownerDocument.importNode(e,!0),o.nodeType===xH&&"BODY"===o.nodeName||"HTML"===o.nodeName?r=o:r.appendChild(o);else{if(!te&&!X&&!J&&-1===e.indexOf("<"))return x&&re?x.createHTML(e):e;if(r=je(e),!r)return te?null:re?S:""}r&&ee&&Ie(r.firstChild);const u=Fe(se?e:r);for(;s=u.nextNode();)ze(s),Ue(s),s.content instanceof a&&qe(s.content);if(se)return e;if(te){if(ne)for(c=N.call(r.ownerDocument);r.firstChild;)c.appendChild(r.firstChild);else c=r;return(B.shadowroot||B.shadowrootmode)&&(c=A.call(i,c,!0)),c}let d=J?r.outerHTML:r.innerHTML;return J&&H["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&qF(yH,r.ownerDocument.doctype.name)&&(d="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+d),X&&OF([k,M,D],e=>{d=zF(d,e," ")}),x&&re?x.createHTML(d):d},n.setConfig=function(){De(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Z=!0},n.clearConfig=function(){Re=null,Z=!1},n.isValidAttribute=function(e,t,n){Re||De({});const r=Ae(e),i=Ae(t);return We(r,i,n)},n.addHook=function(e,t){"function"===typeof t&&jF(R[e],t)},n.removeHook=function(e,t){if(void 0!==t){const n=IF(R[e],t);return-1===n?void 0:FF(R[e],n,1)[0]}return PF(R[e])},n.removeHooks=function(e){R[e]=[]},n.removeAllHooks=function(){R={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},n}();function RH(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var kH,MH,DH,_H,OH,IH,PH=n(6178);function jH(e){const t=e.length;let n=0;for(;n<t;)e[n]=[e[n]],n+=1}function FH(e,t){const n=t.length;let r=0;for(;r<n;)e.push(t[r]),r+=1}function HH(e){const t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;const n=e.length,r=e[0].length;for(let i=0;i<n;i++)for(let n=0;n<r;n++)t[n]||(t[n]=[]),t[n][i]=e[i][n];return t}function LH(e,t,n,r){let i=-1,o=e,a=n;Array.isArray(e)||(o=Array.from(e));const s=o.length;for(r&&s&&(i+=1,a=o[i]),i+=1;i<s;)a=t(a,o[i],i,o),i+=1;return a}function BH(e,t){let n=0,r=e;Array.isArray(e)||(r=Array.from(e));const i=r.length,o=[];let a=-1;for(;n<i;){const e=r[n];t(e,n,r)&&(a+=1,o[a]=e),n+=1}return o}function zH(e,t){let n=0,r=e;Array.isArray(e)||(r=Array.from(e));const i=r.length,o=[];let a=-1;for(;n<i;){const e=r[n];a+=1,o[a]=t(e,n,r),n+=1}return o}function WH(e,t){let n=0,r=e;Array.isArray(e)||(r=Array.from(e));const i=r.length;for(;n<i&&!1!==t(r[n],n,r);)n+=1;return e}function VH(e){return LH(e,(e,t)=>e+t,0)}function UH(e){return LH(e,(e,t)=>e>t?e:t,Array.isArray(e)?e[0]:void 0)}function qH(e){return LH(e,(e,t)=>e<t?e:t,Array.isArray(e)?e[0]:void 0)}function GH(e){return e.length?VH(e)/e.length:0}function YH(e){return LH(e,(e,t)=>e.concat(Array.isArray(t)?YH(t):t),[])}function KH(e){const t=[];return WH(e,e=>{-1===t.indexOf(e)&&t.push(e)}),t}function $H(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,...i]=[...t];let o=r;return WH(i,e=>{o=o.filter(t=>!e.includes(t))}),o}function XH(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,...i]=[...t];let o=r;return WH(i,e=>{o=o.filter(t=>e.includes(t))}),o}function QH(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,...i]=[...t],o=new Set(r);return WH(i,e=>{WH(e,e=>{o.has(e)||o.add(e)})}),Array.from(o)}function JH(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e.split(t)}function ZH(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=LH(e,(e,t,r)=>e+t.replace(/\r?\n\s*/g,"")+(n[r]?n[r]:""),"");return i.trim()}function eL(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=document.createElement("template");i.innerHTML=e.reduce((e,t,r)=>{var i;return e+t+(null!==(i=n[r])&&void 0!==i?i:"")},"");const o=i.content.cloneNode(!0),a={};return o.querySelectorAll("[data-ref]").forEach(e=>{const t=e.getAttribute("data-ref");e.removeAttribute("data-ref"),a[t]=e}),{fragment:o,refs:a}}function tL(e){let t;switch(typeof e){case"string":case"number":t="".concat(e);break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString()}return t}function nL(e){return"undefined"!==typeof e}function rL(e){return"undefined"===typeof e}function iL(e){return null===e||""===e||rL(e)}function oL(e){return"[object RegExp]"===Object.prototype.toString.call(e)}const aL="length",sL=e=>parseInt(e,16),lL=e=>parseInt(e,10),cL=(e,t,n)=>e.substr(t,n),uL=e=>e.codePointAt(0)-65,dL=e=>"".concat(e).replace(/\-/g,""),hL=e=>sL(cL(dL(e),sL("12"),uL("F")))/(sL(cL(dL(e),uL("B"),~~![][aL]))||9),fL=()=>"undefined"!==typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let mL=!1;const pL={invalid:()=>ZH(kH||(kH=RH(["\n    The license key for Handsontable is invalid. \n    If you need any help, contact us at support@handsontable.com."],["\n    The license key for Handsontable is invalid.\\x20\n    If you need any help, contact us at support@handsontable.com."]))),expired:e=>{let{keyValidityDate:t,hotVersion:n}=e;return ZH(MH||(MH=RH(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior \n    to ",". If you need any help, contact us at sales@handsontable.com."],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior\\x20\n    to ",". If you need any help, contact us at sales@handsontable.com."])),t,n,t)},missing:()=>ZH(DH||(DH=RH(["\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact \n    us at support@handsontable.com."],["\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20\n    us at support@handsontable.com."]))),non_commercial:()=>""},gL={invalid:()=>ZH(_H||(_H=RH(['\n    The license key for Handsontable is invalid. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to \n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is invalid.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20\n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.']))),expired:e=>{let{keyValidityDate:t,hotVersion:n}=e;return ZH(OH||(OH=RH(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your \n    license key or downgrade to a version released prior to ','. If you need any \n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20\n    license key or downgrade to a version released prior to ','. If you need any\\x20\n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'])),t,n,t)},missing:()=>ZH(IH||(IH=RH(['\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: \'non-commercial-and-evaluation\'. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in \n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: \'non-commercial-and-evaluation\'.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20\n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.']))),non_commercial:()=>""};function vL(e,t){const n=!iL(e),r="string"===typeof e&&"non-commercial-and-evaluation"===e.toLowerCase(),i="16.2.0";let o,a="invalid",s="invalid";const l=function(e){let t=[][aL],n=t;if(e[aL]!==uL("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=uL(i.shift());o;o=uL(i.shift()||"A"))--o<""[aL]?n|=(lL("".concat(lL(sL(r)+(sL(cL(e,Math.abs(o),2))+[]).padStart(2,"0"))))%97||2)>>1:r=cL(e,o,o?1===i[aL]?9:8:6);return n===t}(e=dL(e||""));if(n||r||l)if(l){const t=PH("25/11/2025","DD/MM/YYYY"),n=Math.floor(t.toDate().getTime()/864e5),r=hL(e);o=PH(864e5*(r+1),"x").format("MMMM DD, YYYY"),n>r?(a="expired",s="expired"):(a="valid",s="valid")}else r?(a="non_commercial",s="valid"):(a="invalid",s="invalid");else a="missing",s="missing";if(fL()&&(a="valid",s="valid"),!mL&&"valid"!==a){pL[a]({keyValidityDate:o,hotVersion:i})&&console["non_commercial"===a?"info":"warn"](pL[a]({keyValidityDate:o,hotVersion:i})),mL=!0}if("valid"!==s&&t){if(gL[s]({keyValidityDate:o,hotVersion:i})){const e=document.createElement("div");e.className="handsontable hot-display-license-info",e.innerHTML=gL[s]({keyValidityDate:o,hotVersion:i}),t.appendChild(e)}}}function yL(e){return e[0].toUpperCase()+e.substr(1)}function bL(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const t=tL(n[i]).toLowerCase();-1===e.indexOf(t)&&e.push(t)}return 1===e.length}function wL(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function xL(e){if("string"!==typeof e)return!1;try{const t=JSON.parse(e);return"object"===typeof t&&null!==t}catch(t){return!1}}function SL(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function CL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,(e,n)=>"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===t[n]?"":t[n])}function EL(e){return NL("".concat(e),{ALLOWED_TAGS:[]})}function NL(e,t){return AH.sanitize(e,t)}const TL=e=>["tabindex",e],AL=()=>["role","gridcell"],RL=()=>["role","gridcell button"],kL=()=>["role","rowheader"],ML=()=>["role","columnheader"],DL=()=>["role","row"],_L=()=>["scope","col"],OL=()=>["scope","row"],IL=e=>["aria-label",e],PL=e=>["aria-describedby",e],jL=()=>["aria-hidden","true"],FL=function(){return["aria-disabled",!(arguments.length>0&&void 0!==arguments[0])||arguments[0]]},HL=e=>["aria-haspopup",e],LL=e=>["aria-rowcount",e],BL=e=>["aria-colcount",e],zL=e=>["aria-rowindex",e],WL=e=>["aria-colindex",e],VL=e=>["aria-expanded",e],UL=e=>["aria-checked",e],qL=e=>["aria-relevant",e],GL=e=>["aria-posinset",e];function YL(e){let t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},rB(e,(e,n)=>{"__children"!==n&&(e&&"object"===typeof e&&!Array.isArray(e)?t[n]=YL(e):Array.isArray(e)?e.length&&"object"===typeof e[0]&&!Array.isArray(e[0])?t[n]=[YL(e[0])]:t[n]=[]:t[n]=null)})),t}function KL(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function $L(e,t,n){const r=Array.isArray(n);return rB(t,(t,i)=>{(!1===r||n.includes(i))&&(e[i]=t)}),e}function XL(e,t){rB(t,(n,r)=>{t[r]&&"object"===typeof t[r]?(e[r]||(Array.isArray(t[r])?e[r]=[]:"[object Date]"===Object.prototype.toString.call(t[r])?e[r]=t[r]:e[r]={}),XL(e[r],t[r])):e[r]=t[r]})}function QL(e){return"object"===typeof e?JSON.parse(JSON.stringify(e)):e}function JL(e){const t={};return rB(e,(e,n)=>{t[n]=e}),t}function ZL(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return WH(n,t=>{e.MIXINS.push(t.MIXIN_NAME),rB(t,(t,n)=>{if(void 0!==e.prototype[n])throw new Error("Mixin conflict. Property '".concat(n,"' already exist and cannot be overwritten."));if("function"===typeof t)e.prototype[n]=t;else{const r=function(e,t){const n="_".concat(e);return function(){return void 0===this[n]&&(this[n]=(e=>{let t=e;return(Array.isArray(t)||tB(t))&&(t=QL(t)),t})(t)),this[n]}},i=function(e){const t="_".concat(e);return function(e){this[t]=e}};Object.defineProperty(e.prototype,n,{get:r(n,t),set:i(n),configurable:!0})}})}),e}function eB(e,t){return JSON.stringify(e)===JSON.stringify(t)}function tB(e){return"[object Object]"===Object.prototype.toString.call(e)}function nB(e,t,n,r){r.value=n,r.writable=!1!==r.writable,r.enumerable=!1!==r.enumerable,r.configurable=!1!==r.configurable,Object.defineProperty(e,t,r)}function rB(e,t){for(const n in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,n))&&!1===t(e[n],n,e))break;return e}function iB(e,t){const n=t.split(".");let r=e;return rB(n,e=>{if(r=r[e],void 0===r)return r=void 0,!1}),r}function oB(e,t,n){if("string"!==typeof t)return;const r=t.split(".");let i=e;r.forEach((e,t)=>{"__proto__"!==e&&"constructor"!==e&&"prototype"!==e&&(t!==r.length-1?(lB(i,e)||(i[e]={}),i=i[e]):i[e]=n)})}function aB(e){if(!tB(e))return 0;const t=function(e){let n=0;return tB(e)?rB(e,(e,r)=>{"__children"!==r&&(n+=t(e))}):n+=1,n};return t(e)}function sB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";const n="_".concat(t),r={_touched:!1,[n]:e,isTouched(){return this._touched}};return Object.defineProperty(r,t,{get(){return this[n]},set(e){this._touched=!0,this[n]=e},enumerable:!0,configurable:!0}),r}function lB(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function cB(e,t){if("object"!==typeof e||null===e)return t;if("object"!==typeof t||null===t)return e;const n={};return Object.keys(t).forEach(r=>{"object"!==typeof t[r]||null===t[r]||Array.isArray(t[r])?n[r]=lB(e,r)&&void 0!==e[r]?e[r]:t[r]:n[r]=cB(e[r],t[r])}),Object.keys(e).forEach(t=>{lB(n,t)||(n[t]=e[t])}),n}function uB(e){return window.requestAnimationFrame(e)}function dB(e){window.cancelAnimationFrame(e)}function hB(){return"ontouchstart"in window}function fB(){return"undefined"!==typeof window}let mB;function pB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return mB||(mB="object"===typeof Intl?new Intl.Collator(e,t).compare:"function"===typeof String.prototype.localeCompare?(e,t)=>"".concat(e).localeCompare(t):(e,t)=>e===t?0:e>t?-1:1,mB)}const gB=e=>{const t={value:!1,test:(n,r)=>{t.value=e(n,r)}};return t},vB={chrome:gB((e,t)=>/Chrome/.test(e)&&/Google/.test(t)),chromeWebKit:gB(e=>/CriOS/.test(e)),edge:gB(e=>/Edge/.test(e)),edgeWebKit:gB(e=>/EdgiOS/.test(e)),firefox:gB(e=>/Firefox/.test(e)),firefoxWebKit:gB(e=>/FxiOS/.test(e)),mobile:gB(e=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)),safari:gB((e,t)=>/Safari/.test(e)&&/Apple Computer/.test(t))},yB={mac:gB(e=>/^Mac/.test(e)),win:gB(e=>/^Win/.test(e)),linux:gB(e=>/^Linux/.test(e)),ios:gB(e=>/iPhone|iPad|iPod/i.test(e))};function bB(){let{userAgent:e=navigator.userAgent,vendor:t=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};rB(vB,n=>{let{test:r}=n;r(e,t)})}function wB(){let{platform:e=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};rB(yB,t=>{let{test:n}=t;n(e)})}function xB(){return vB.chrome.value}function SB(){return vB.chromeWebKit.value}function CB(){return vB.firefox.value}function EB(){return vB.firefoxWebKit.value}function NB(){return vB.safari.value}function TB(){return vB.edge.value}function AB(){return vB.edgeWebKit.value}function RB(){return vB.mobile.value}function kB(){return yB.ios.value}function MB(){let{maxTouchPoints:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return e>2&&yB.mac.value}function DB(){return yB.win.value}function _B(){return yB.mac.value}function OB(){return yB.linux.value}function IB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,r=null,i=e;for(;null!==i;){if(n===t){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function PB(e,t){const n=e.closest(".handsontable");return!!n&&(n.parentNode===t||n===t)}function jB(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function FB(e){return jB(e)&&e.parent}function HB(e){return!!Object.getPrototypeOf(e.parent)}function LB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=e;for(;null!==o&&void 0!==o&&o!==n;){const{nodeType:e,nodeName:n}=o;if(e===r&&(t.includes(n)||t.includes(o)))return o;const{host:a}=o;o=a&&e===i?a:o.parentNode}return null}function BB(e,t,n){const r=[];let i=e;for(;i&&(i=LB(i,t,n),i&&(!n||n.contains(i)));)r.push(i),i=i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.host:i.parentNode;const o=r.length;return o?r[o-1]:null}function zB(e,t){const n={element:void 0,classNames:[]};let r=e;for(;null!==r&&r!==e.ownerDocument.documentElement&&!n.element;){if("string"===typeof t&&r.classList.contains(t))n.element=r,n.classNames.push(t);else if(t instanceof RegExp){const e=Array.from(r.classList).filter(e=>t.test(e));e.length&&(n.element=r,n.classNames.push(...e))}r=r.parentElement}return n}function WB(e,t){let n=e.parentNode,r=[];for("string"===typeof t?r=e.defaultView?Array.prototype.slice.call(e.querySelectorAll(t),0):Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):r.push(t);null!==n;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function VB(e){let t=0,n=e;if(n.previousSibling)for(;n=n.previousSibling;)t+=1;return t}function UB(e,t,n){const r=n.parentElement.querySelector(".ht_clone_".concat(e));return r?r.contains(t):null}function qB(e){return e&&e.length?e.filter(e=>!!e):[]}function GB(e,t){if(!e||!e.length)return t?{regexFree:[],regexes:[]}:[];const n=[],r=[];return r.push(...e.filter(e=>{const r=e instanceof RegExp;return r&&t&&n.push(e),!r})),t?{regexFree:r,regexes:n}:r}function YB(e,t){return void 0!==e.classList&&"string"===typeof t&&""!==t&&e.classList.contains(t)}function KB(e,t){"string"===typeof t&&(t=t.split(" ")),(t=qB(t)).length>0&&e.classList.add(...t)}function $B(e,t){"string"===typeof t?t=t.split(" "):t instanceof RegExp&&(t=[t]);let{regexFree:n,regexes:r}=GB(t,!0);n=qB(n),n.length>0&&e.classList.remove(...n),r.forEach(t=>{e.classList.forEach(n=>{t.test(n)&&e.classList.remove(n)})})}function XB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(t)||(t=[[t,n]]),t.forEach(t=>{Array.isArray(t)&&""!==t[0]&&e.setAttribute(...t)})}function QB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"===typeof t?t=t.split(" "):t instanceof RegExp&&(t=[t]);const{regexFree:n,regexes:r}=GB(t,!0);n.forEach(t=>{""!==t&&e.removeAttribute(t)}),r.forEach(t=>{e.getAttributeNames().forEach(n=>{t.test(n)&&e.removeAttribute(n)})})}function JB(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1){const t=e.childNodes;for(let e=t.length-1;e>=0;e--)JB(t[e])}}function ZB(e){let t;for(;t=e.lastChild;)e.removeChild(t)}fB()&&(bB(),wB());const ez=/(<(.*)>|&(.*);)/;function tz(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];ez.test(t)?e.innerHTML=n?NL(t):t:nz(e,t)}function nz(e,t){const n=e.firstChild;n&&3===n.nodeType&&null===n.nextSibling?n.textContent=t:(ZB(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function rz(e){const t=e.ownerDocument.documentElement,n=e.ownerDocument.defaultView;let r=e;for(;r!==t;){if(null===r)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(r.host){if(r.host.impl)return rz(r.host.impl);if(r.host)return rz(r.host);throw new Error("Lost in Web Components world")}return!1}if("none"===n.getComputedStyle(r).display)return!1;r=r.parentNode}return!0}function iz(e){const t=e.ownerDocument.defaultView;let n=e;for(;n.parentNode;){if("0px"===n.style.height||"0"===n.style.height)return"hidden"===t.getComputedStyle(n).overflow;n=n.parentNode}return!1}function oz(e){const t=e.ownerDocument,n=t.defaultView,r=t.documentElement;let i,o,a,s=e;for(i=s.offsetLeft,o=s.offsetTop,a=s;(s=s.offsetParent)&&s!==t.body&&"offsetLeft"in s;)i+=s.offsetLeft,o+=s.offsetTop,a=s;return a&&"fixed"===a.style.position&&(i+=n.pageXOffset||r.scrollLeft,o+=n.pageYOffset||r.scrollTop),{left:i,top:o}}function az(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollY}function sz(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollX}function lz(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?az(t):e.scrollTop}function cz(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?sz(t):e.scrollLeft}function uz(e){let t=e.ownerDocument,n=t?t.defaultView:void 0;t||(t=e.document?e.document:e,n=t.defaultView);const r=["auto","scroll"];let i=e.parentNode;for(;i&&i.style&&t.body!==i;){let{overflow:e,overflowX:t,overflowY:o}=i.style;if([e,t,o].includes("scroll"))return i;if(({overflow:e,overflowX:t,overflowY:o}=n.getComputedStyle(i)),r.includes(e)||r.includes(t)||r.includes(o))return i;if(i.clientHeight<=i.scrollHeight+1&&(r.includes(o)||r.includes(e)))return i;if(i.clientWidth<=i.scrollWidth+1&&(r.includes(t)||r.includes(e)))return i;i=i.parentNode}return n}function dz(e){return e.scrollHeight-e.clientHeight}function hz(e){return e.scrollWidth-e.clientWidth}function fz(e){const t=e.ownerDocument,n=t.defaultView;let r=e.parentNode;for(;r&&r.style&&t.body!==r;){if("visible"!==r.style.overflow&&""!==r.style.overflow)return r;const e=n.getComputedStyle(r),t=["scroll","hidden","auto"],i=e.getPropertyValue("overflow"),o=e.getPropertyValue("overflow-y"),a=e.getPropertyValue("overflow-x");if(t.includes(i)||t.includes(o)||t.includes(a))return r;r=r.parentNode}return n}function mz(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!e)return;if(e===n)return"width"===t?"".concat(n.innerWidth,"px"):"height"===t?"".concat(n.innerHeight,"px"):void 0;const r=e.style[t];if(""!==r&&void 0!==r)return r;const i=n.getComputedStyle(e);return""!==i[t]&&void 0!==i[t]?i[t]:void 0}function pz(e,t){const{selectorText:n}=t;let r=!1;return t.type===CSSRule.STYLE_RULE&&n&&(e.msMatchesSelector?r=e.msMatchesSelector(n):e.matches&&(r=e.matches(n))),r}function gz(e){return e.offsetWidth}function vz(e){return e.getBoundingClientRect().height}function yz(e){return e.clientHeight||e.innerHeight}function bz(e){return e.clientWidth||e.innerWidth}function wz(e,t,n){e.addEventListener(t,n,!1)}function xz(e,t,n){e.removeEventListener(t,n,!1)}function Sz(e){return e.selectionStart?e.selectionStart:0}function Cz(e){return e.selectionEnd?e.selectionEnd:0}function Ez(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;const t=e.document;let n="";return e.getSelection?n=e.getSelection().toString():t.selection&&"Control"!==t.selection.type&&(n=t.selection.createRange().text),n}function Nz(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;e.getSelection&&(e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges())}function Tz(e,t,n){if(void 0===n&&(n=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,n)}catch(r){const i=e.parentNode,o=i.style.display;i.style.display="block",e.setSelectionRange(t,n),i.style.display=o}}}let Az;function Rz(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return DB()?Number.isInteger(e.defaultView.devicePixelRatio||1)?0:2:0}function kz(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===Az&&(Az=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const t=e.createElement("div");t.style.height="200px",t.style.width="100%";const n=e.createElement("div");!NB()||RB()||MB()||n.classList.add("htScrollbarSafariTest"),n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(t),(e.body||e.documentElement).appendChild(n);const r=t.getBoundingClientRect().width;n.style.overflow="scroll";let i=t.getBoundingClientRect().width;return r===i&&(i=n.clientWidth),(e.body||e.documentElement).removeChild(n),parseFloat((r-i).toFixed(3))}(e)),Az}function Mz(e){return e instanceof Window?e.document.body.scrollHeight>e.innerHeight:e.offsetWidth!==e.clientWidth}function Dz(e){return e instanceof Window?e.document.body.scrollWidth>e.innerWidth:e.offsetHeight!==e.clientHeight}function _z(e,t,n){e.style.transform="translate3d(".concat(t,",").concat(n,",0)")}function Oz(e){let t;return e.style.transform&&""!==(t=e.style.transform)?["transform",t]:-1}function Iz(e){e.style.transform&&""!==e.style.transform&&(e.style.transform="")}function Pz(e){return e&&(["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)>-1||"true"===e.contentEditable)}function jz(e){return Pz(e)&&!1===e.hasAttribute("data-hot-input")}function Fz(e){jz(e.ownerDocument.activeElement)||e.select()}function Hz(e){return!e.parentNode}function Lz(e,t){const n=new IntersectionObserver((n,r)=>{n.forEach(n=>{n.isIntersecting&&null!==e.offsetParent&&(t(),r.unobserve(e))})},{root:e.ownerDocument.body});n.observe(e)}function Bz(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=e.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();XB(e,"contenteditable",!0),n&&XB(e,...jL()),t&&KB(e,"invisibleSelection"),i.selectNodeContents(e),o.removeAllRanges(),o.addRange(i)}function zz(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=e.ownerDocument.defaultView.getSelection();e.hasAttribute("aria-hidden")&&e.removeAttribute("aria-hidden"),n.removeAllRanges(),t&&$B(e,"invisibleSelection"),e.removeAttribute("contenteditable")}function Wz(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Bz(e,n),t(),zz(e,n)}function Vz(e){var t;const n=null===e||void 0===e||null===(t=e.ownerDocument)||void 0===t?void 0:t.defaultView.Element;return!!(n&&null!==n&&e instanceof n)}function Uz(e){return"function"===typeof e}function qz(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;return function(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];const l=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=l,c=!0);const u=t-(l-n);return c?(r.lastCallThrottled=!1,e.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,e.apply(this,a),n=0,i=void 0},u)),r}}function Gz(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;const n=qz(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:200);let r=t;function i(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return r?(r-=1,e.apply(this,i)):n.apply(this,i)}return i.clearHits=function(){r=t},i}function Yz(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;return function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r&&clearTimeout(r),r=setTimeout(()=>{t=e.apply(this,o)},n),t}}function Kz(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,...i]=t;return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return LH(i,(e,t)=>t(e),r.apply(this,t))}}function $z(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.apply(this,n.concat(r))}}function Xz(e){const t=e.length;return function n(r){return function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];const s=r.concat(o);let l;return l=s.length>=t?e.apply(this,s):n(s),l}}([])}function Qz(e){const t=e.length;return function n(r){return function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];const s=r.concat(o.reverse());let l;return l=s.length>=t?e.apply(this,s):n(s),l}}([])}function Jz(e,t,n,r,i,o,a,s){return nL(s)?e.call(t,n,r,i,o,a,s):nL(a)?e.call(t,n,r,i,o,a):nL(o)?e.call(t,n,r,i,o):nL(i)?e.call(t,n,r,i):nL(r)?e.call(t,n,r):nL(n)?e.call(t,n):e.call(t)}const Zz={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:CB()?182:174,AUDIO_MUTE:CB()?181:173,AUDIO_UP:CB()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},eW=[Zz.ALT,Zz.ARROW_DOWN,Zz.ARROW_LEFT,Zz.ARROW_RIGHT,Zz.ARROW_UP,Zz.AUDIO_DOWN,Zz.AUDIO_MUTE,Zz.AUDIO_UP,Zz.BACKSPACE,Zz.CAPS_LOCK,Zz.DELETE,Zz.END,Zz.ENTER,Zz.ESCAPE,Zz.F1,Zz.F2,Zz.F3,Zz.F4,Zz.F5,Zz.F6,Zz.F7,Zz.F8,Zz.F9,Zz.F10,Zz.F11,Zz.F12,Zz.F13,Zz.F14,Zz.F15,Zz.F16,Zz.F17,Zz.F18,Zz.F19,Zz.HOME,Zz.INSERT,Zz.MEDIA_NEXT,Zz.MEDIA_PLAY_PAUSE,Zz.MEDIA_PREV,Zz.MEDIA_STOP,Zz.NULL,Zz.NUM_LOCK,Zz.PAGE_DOWN,Zz.PAGE_UP,Zz.PAUSE,Zz.SCROLL_LOCK,Zz.SHIFT,Zz.TAB];function tW(e){return 32===e||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function nW(e){return eW.includes(e)}function rW(e){const t=[];return _B()?t.push(Zz.COMMAND_LEFT,Zz.COMMAND_RIGHT,Zz.COMMAND_FIREFOX):t.push(Zz.CONTROL),t.includes(e)}function iW(e){return[Zz.CONTROL,Zz.COMMAND_LEFT,Zz.COMMAND_RIGHT,Zz.COMMAND_FIREFOX].includes(e)}function oW(e,t){const n=t.split("|");let r=!1;return WH(n,t=>{if(e===Zz[t])return r=!0,!1}),r}function aW(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function sW(e){return!1===e.isImmediatePropagationEnabled}function lW(e){return 2===e.button}function cW(e){return 0===e.button}function uW(e){return"undefined"!==typeof TouchEvent&&e instanceof TouchEvent}function dW(e,t){const n={x:e.offsetX,y:e.offsetY};let r=e.target;if(!Vz(t)||r!==t&&r.contains(t))return n;for(;r!==t;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}function hW(){nL(console)&&console.warn(...arguments)}function fW(e){nL(console)&&console.warn("Deprecated: ".concat(e))}function mW(){nL(console)&&console.error(...arguments)}const pW=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceCacheUpdate","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceCacheUpdate","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","beforeSelectAll","afterSelectAll","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeHeightChange","beforeWidthChange","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","beforePageChange","afterPageChange","beforePageSizeChange","afterPageSizeChange","afterPageSizeVisibilityChange","afterPageCounterVisibilityChange","afterPageNavigationVisibilityChange","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterDialogHide","afterDialogShow","beforeDialogHide","beforeDialogShow","dialogFocusPreviousElement","dialogFocusNextElement","afterDialogFocus","beforeLoadingShow","afterLoadingShow","beforeLoadingHide","afterLoadingHide","beforeEmptyDataStateShow","afterEmptyDataStateShow","beforeEmptyDataStateHide","afterEmptyDataStateHide","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],gW=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),vW=new Map([[]]);function yW(e,t,n){bW(e,t),t.set(e,n)}function bW(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wW(e,t,n){return e.set(SW(e,t),n),n}function xW(e,t){return e.get(SW(e,t))}function SW(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var CW,EW=new WeakMap,NW=new WeakMap,TW=new WeakMap,AW=new WeakSet;class RW{constructor(){!function(e,t){bW(e,t),t.add(e)}(this,AW),yW(this,EW,new Map),yW(this,NW,new Map),yW(this,TW,new Set),pW.forEach(e=>SW(AW,this,kW).call(this,e))}getHooks(e){var t;return null!==(t=xW(EW,this).get(e))&&void 0!==t?t:[]}add(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};xW(EW,this).has(e)||(SW(AW,this,kW).call(this,e),pW.push(e));const r=xW(EW,this).get(e),i=r.find(e=>e.callback===t);if(i)return void(!0===i.skip&&(i.skip=!1));const o=Number.isInteger(n.orderIndex)?n.orderIndex:0,a=!!n.runOnce,s=!!n.initialHook;let l=!1;if(s){const e=r.find(e=>e.initialHook);e&&(e.callback=t,l=!0)}if(!l){r.push({callback:t,orderIndex:o,runOnce:a,initialHook:s,skip:!1});let n=xW(TW,this).has(e);n||0===o||(n=!0,xW(TW,this).add(e)),n&&r.length>1&&xW(EW,this).set(e,r.toSorted((e,t)=>e.orderIndex-t.orderIndex))}}has(e){return xW(EW,this).has(e)&&xW(EW,this).get(e).length>0}remove(e,t){if(!xW(EW,this).has(e))return!1;const n=xW(EW,this).get(e),r=n.find(e=>e.callback===t);if(r){let t=xW(NW,this).get(e);return r.skip=!0,t+=1,t>100&&(xW(EW,this).set(e,n.filter(e=>!e.skip)),t=0),xW(NW,this).set(e,t),!0}return!1}destroy(){xW(EW,this).clear(),xW(NW,this).clear(),wW(EW,this,null),wW(NW,this,null)}}function kW(e){xW(EW,this).set(e,[]),xW(NW,this).set(e,0)}function MW(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const DW=ZH(CW||(CW=RH(['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. \n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to \n  learn about the migration path.'],['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20\n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20\n  learn about the migration path.'])));class _W{constructor(){MW(this,"globalBucket",new RW)}static getSingleton(){return OW}getBucket(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new RW),e.pluginHookBucket):this.globalBucket}add(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(t)?WH(t,t=>this.add(e,t,n)):(gW.has(e)&&hW(CL(DW,{hookName:e,removedInVersion:gW.get(e)})),vW.has(e)&&hW(vW.get(e)),this.getBucket(n).add(e,t,{orderIndex:r,runOnce:!1})),this}once(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(t)?WH(t,t=>this.once(e,t,n)):this.getBucket(n).add(e,t,{orderIndex:r,runOnce:!0}),this}addAsFixed(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Array.isArray(t)?WH(t,t=>this.addAsFixed(e,t,n)):this.getBucket(n).add(e,t,{initialHook:!0}),this}remove(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.getBucket(n).remove(e,t)}has(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.getBucket(t).has(e)}run(e,t,n,r,i,o,a,s){{const l=this.getBucket().getHooks(t),c=l?l.length:0;let u=0;if(c)for(;u<c;){if(!l[u]||l[u].skip){u+=1;continue}const c=Jz(l[u].callback,e,n,r,i,o,a,s);void 0!==c&&(n=c),l[u]&&l[u].runOnce&&this.remove(t,l[u].callback),u+=1}}{const l=this.getBucket(e).getHooks(t),c=l?l.length:0;let u=0;if(c)for(;u<c;){if(!l[u]||l[u].skip){u+=1;continue}const c=Jz(l[u].callback,e,n,r,i,o,a,s);void 0!==c&&(n=c),l[u]&&l[u].runOnce&&this.remove(t,l[u].callback,e),u+=1}}return n}destroy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||pW.push(e)}deregister(e){this.isRegistered(e)&&pW.splice(pW.indexOf(e),1)}isDeprecated(e){return vW.has(e)||gW.has(e)}isRegistered(e){return pW.indexOf(e)>=0}getRegistered(){return pW}}const OW=new _W;const IW=new Map;function PW(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";IW.has(e)||IW.set(e,new Map);const t=IW.get(e);return{register:function(e,n){t.set(e,n)},getItem:function(e){return t.get(e)},hasItem:function(e){return t.has(e)},getNames:function(){return[...t.keys()]},getValues:function(){return[...t.values()]},clear:function(){IW.delete(e),t.clear()}}}function jW(e,t){var n;return null===IW||void 0===IW||null===(n=IW.get(e.guid))||void 0===n?void 0:n.get(t)}const FW=new WeakMap,{register:HW,getItem:LW,hasItem:BW,getNames:zW,getValues:WW}=PW("editors");function VW(e){const t={},n=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new n(e)),t[e.guid]},_W.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function UW(e,t){let n;if("function"===typeof e)FW.get(e)||GW(null,e),n=FW.get(e);else{if("string"!==typeof e)throw Error('Only strings and functions can be passed as "editor" parameter');n=LW(e)}if(!n)throw Error('No editor registered under name "'.concat(e,'"'));return n.getInstance(t)}function qW(e){if("function"===typeof e)return e;if(!BW(e))throw Error('No registered editor found under "'.concat(e,'" name'));return LW(e).getConstructor()}function GW(e,t){e&&"string"!==typeof e&&(e=(t=e).EDITOR_TYPE);const n=new VW(t);"string"===typeof e&&HW(e,n),FW.set(t,n)}function YW(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let KW=0;const $W=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;YW(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function i(e){n.call(this,function(e){const t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),aW(this)},e}(e))}return this.context.eventListeners.push({element:e,event:t,callback:n,callbackProxy:i,options:r,eventManager:this}),e.addEventListener(t,i,r),KW+=1,()=>{this.removeEventListener(e,t,n)}}removeEventListener(e,t,n){let r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.context.eventListeners.length;for(;o;)if(o-=1,r=this.context.eventListeners[o],r.event===t&&r.element===e){if(n&&n!==r.callback)continue;if(i&&r.eventManager!==this)continue;this.context.eventListeners.splice(o,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),KW-=1}}clearEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const n=this.context.eventListeners[t];e&&n.eventManager!==this||(this.context.eventListeners.splice(t,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),KW-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let n=e.document,r=e;n||(n=e.ownerDocument?e.ownerDocument:e,r=n.defaultView);const i={bubbles:!0,cancelable:"mousemove"!==t,view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let o;n.createEvent?(o=n.createEvent("MouseEvents"),o.initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||n.body.parentNode)):o=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent("on".concat(t),o)}};function XW(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function QW(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function JW(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var ZW=new WeakSet;class eV{constructor(e,t,n){XW(this,ZW),QW(this,"hot",void 0),QW(this,"tableMeta",void 0),QW(this,"selection",void 0),QW(this,"eventManager",void 0),QW(this,"destroyed",!1),QW(this,"activeEditor",void 0),QW(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=n,this.eventManager=new $W(e),this.hot.addHook("afterDocumentKeyDown",e=>JW(ZW,this,tV).call(this,e)),this.hot.addHook("beforeCompositionStart",e=>JW(ZW,this,tV).call(this,e)),this.hot.view._wt.update("onCellDblClick",(e,t,n)=>JW(ZW,this,nV).call(this,e,t,n))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting())return void this.closeEditor(!1,!1,e=>{e&&this.prepareEditor()});const t=null===(e=this.hot.getSelectedRangeActive())||void 0===e?void 0:e.highlight;if(!t||t.isHeader())return;const{row:n,col:r}=t,i=this.hot.runHooks("modifyGetCellCoords",n,r,!1,"meta");let o=n,a=r;if(Array.isArray(i)&&([o,a]=i),this.cellProperties=this.hot.getCellMeta(o,a),!this.isCellEditable())return void this.clearActiveEditor();const s=this.hot.getCell(n,r,!0);if(s){const e=this.hot.getCellEditor(this.cellProperties),t=this.hot.colToProp(a),i=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),a);this.activeEditor=UW(e,this.hot),this.activeEditor.prepare(n,r,t,s,i,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isCellEditable())return void this.clearActiveEditor();const r=this.hot.getSelectedRangeActive();let i=this.hot.runHooks("beforeBeginEditing",r.highlight.row,r.highlight.col,e,t,n);t instanceof MouseEvent&&"boolean"!==typeof i&&(i=0===this.hot.selection.getLayerLevel()&&r.isSingle()),!1!==i?(this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))):this.clearActiveEditor()}closeEditor(e,t,n){this.activeEditor?this.activeEditor.finishEditing(e,t,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeActive();if(!e)return!1;const t=this.hot.getCellEditor(this.cellProperties),{row:n,col:r}=e.highlight,{rowIndexMapper:i,columnIndexMapper:o}=this.hot,a=i.isHidden(this.hot.toPhysicalRow(n))||o.isHidden(this.hot.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!t||a)}moveSelectionAfterEnter(e){const t=E({},"function"===typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves);e.shiftKey&&(t.row=-t.row,t.col=-t.col),this.hot.selection.isMultiple()?this.selection.transformFocus(t.row,t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function tV(e){const t=this.hot.getSelectedRangeActive();if(!this.hot.isListening()||!t||t.highlight.isHeader()||sW(e))return;const{keyCode:n}=e,r=(e.ctrlKey||e.metaKey)&&!e.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&(nW(n)||iW(n)||r||this.isEditorOpened()||this.openEditor("",e))}function nV(e,t){t.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,e,!0))}const rV=new WeakMap;eV.getInstance=function(e,t,n){let r=rV.get(e);return r||(r=new eV(e,t,n),rV.set(e,r)),r};const iV=eV,oV={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},aV=new RegExp(Object.keys(oV).map(e=>"(".concat(e,")")).join("|"),"gi");function sV(e){const t=e.hasColHeaders(),n=e.hasRowHeaders(),r=[t?-1:0,n?-1:0,e.countRows()-1,e.countCols()-1],i=e.getData(...r),o=i.length,a=o>0?i[0].length:0,s=["<table>","</table>"],l=t?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],u=n?1:0,d=t?1:0;for(let h=0;h<o;h+=1){const r=t&&0===h,o=[];for(let t=0;t<a;t+=1){const a=!r&&n&&0===t;let s="";if(r)s="<th>".concat(e.getColHeader(t-u),"</th>");else if(a)s="<th>".concat(e.getRowHeader(h-d),"</th>");else{const n=i[h][t],{hidden:r,rowspan:o,colspan:a}=e.getCellMeta(h-d,t-u);if(!r){const e=[];if(o&&e.push('rowspan="'.concat(o,'"')),a&&e.push('colspan="'.concat(a,'"')),iL(n))s="<td ".concat(e.join(" "),"></td>");else{const t=n.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");s="<td ".concat(e.join(" "),">").concat(t,"</td>")}}}o.push(s)}const s=["<tr>",...o,"</tr>"].join("");r?l.splice(1,0,s):c.splice(-1,0,s)}return s.splice(1,0,l.join(""),c.join("")),s.join("")}function lV(e){const t=e.length,n=["<table>"];for(let r=0;r<t;r+=1){const i=e[r],o=i.length,a=[];0===r&&n.push("<tbody>");for(let e=0;e<o;e+=1){const t=i[e],n=iL(t)?"":t.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,e=>'<span style="mso-spacerun: yes">'.concat("&nbsp;".repeat(e.length-1)," </span>")).replace(/\t/gi,"&#9;");a.push("<td>".concat(n,"</td>"))}n.push("<tr>",...a,"</tr>"),r+1===t&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function cV(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;const n={},r=t.createDocumentFragment(),i=t.createElement("div");r.appendChild(i);let o=e;if("string"===typeof o){const e=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,e=>{const t=e.match(/<td\b[^>]*?>/g)[0],n=e.substring(t.length,e.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(/<p.*?>/g,"\n").replace("\n","").replaceAll(/<\/(.*)>\s+$/gm,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/gm,"");return"".concat(t).concat(n).concat("</td>")});i.insertAdjacentHTML("afterbegin","".concat(e)),o=i.querySelector("table")}if(!o||!function(e){return"TABLE"===(e&&e.nodeName||"")}(o))return;const a=i.querySelector('meta[name$="enerator"]'),s=null!==o.querySelector("tbody th"),l=o.querySelector("tr"),c=l?Array.from(l.cells).reduce((e,t)=>e+t.colSpan,0)-(s?1:0):0,u=o.tFoot&&Array.from(o.tFoot.rows)||[],d=[];let h=!1,f=0,m=0;if(o.tHead){const e=Array.from(o.tHead.rows).filter(e=>{const t=null!==e.querySelector("td");return t&&d.push(e),!t});f=e.length,h=f>0,f>1?n.nestedHeaders=Array.from(e).reduce((e,t)=>{const n=Array.from(t.cells).reduce((e,t,n)=>{if(s&&0===n)return e;const{colSpan:r,innerHTML:i}=t,o=r>1?{label:i,colspan:r}:i;return e.push(o),e},[]);return e.push(n),e},[]):h&&(n.colHeaders=Array.from(e[0].children).reduce((e,t,n)=>(s&&0===n||e.push(t.innerHTML),e),[]))}d.length&&(n.fixedRowsTop=d.length),u.length&&(n.fixedRowsBottom=u.length);const p=[...d,...Array.from(o.tBodies).reduce((e,t)=>(e.push(...Array.from(t.rows)),e),[]),...u];m=p.length;const g=new Array(m);for(let b=0;b<m;b++)g[b]=new Array(c);const v=[],y=[];for(let b=0;b<m;b++){const e=p[b],t=Array.from(e.cells),n=t.length;for(let r=0;r<n;r++){const e=t[r],{nodeName:n,innerHTML:i,rowSpan:o,colSpan:s}=e,l=g[b].findIndex(e=>void 0===e);if("TD"===n){if(o>1||s>1){for(let e=b;e<b+o;e++)if(e<m)for(let t=l;t<l+s;t++)g[e][t]=null;const t=e.getAttribute("style");t&&t.includes("mso-ignore:colspan")||v.push({col:l,row:b,rowspan:o,colspan:s})}let t="";t=a&&/excel/gi.test(a.content)?i.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):i.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),g[b][l]=t.replace(aV,e=>oV[e])}else y.push(i)}}return v.length&&(n.mergeCells=v),y.length&&(n.rowHeaders=y),g.length&&(n.data=g),n}function uV(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=typeof e;if("number"===n)return!isNaN(e)&&isFinite(e);if("string"===n){if(0===e.length)return!1;if(1===e.length)return/\d/.test(e);const n=Array.from(new Set([".",...t])).map(e=>"\\".concat(e)).join("|");return new RegExp("^[+-]?(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}return"object"===n&&(!!e&&"number"===typeof e.valueOf()&&!(e instanceof Date))}function dV(e){return uV(e,[","])}function hV(e,t,n){let r=-1;for("function"===typeof t?(n=t,t=e):r=e-1;++r<=t&&!1!==n(r););}function fV(e,t,n){let r=e+1;for("function"===typeof t&&(n=t,t=0);--r>=t&&!1!==n(r););}function mV(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}function pV(e,t,n){return Math.min(e,t)===e?t:Math.max(e,n)===e?n:e}function gV(e){const t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):null}function vV(e){return Number.isInteger(e)&&e>=0}const yV="asc",bV=new Map([[yV,[-1,1]],["desc",[1,-1]]]),wV=e=>"The priority '".concat(e,"' is already declared in a map."),xV=e=>"The priority '".concat(e,"' is not a number.");const SV=e=>"The id '".concat(e,"' is already declared in a map.");function CV(){let{errorIdExists:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Map;function n(){return[...t]}function r(e){return t.has(e)}return e=Uz(e)?e:SV,{addItem:function(n,i){if(r(n))throw new Error(e(n));t.set(n,i)},clear:function(){t.clear()},getId:function(e){const[t]=n().find(t=>{let[n,r]=t;return e===r&&n})||[null];return t},getItem:function(e){return t.get(e)},getItems:n,getValues:function(){return[...t.values()]},hasItem:r,removeItem:function(e){return t.delete(e)}}}const EV=e=>"'".concat(e,"' value is already declared in a unique set.");const NV=e=>'There is already registered "'.concat(e,'" plugin.'),TV=function(){let{errorPriorityExists:e,errorPriorityNaN:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=new Map;return e=Uz(e)?e:wV,t=Uz(t)?t:xV,{addItem:function(r,i){if(!uV(r))throw new Error(t(r));if(n.has(r))throw new Error(e(r));n.set(r,i)},getItems:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yV;const[t,r]=bV.get(e)||bV.get(yV);return[...n].sort((e,n)=>e[0]<n[0]?t:r).map(e=>e[1])}}}({errorPriorityExists:e=>'There is already registered plugin on priority "'.concat(e,'".'),errorPriorityNaN:e=>'The priority "'.concat(e,'" is not a number.')}),AV=function(){let{errorItemExists:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Set;return e=Uz(e)?e:EV,{addItem:function(n){if(t.has(n))throw new Error(e(n));t.add(n)},clear:function(){t.clear()},getItems:function(){return[...t]}}}({errorItemExists:NV}),RV=CV({errorIdExists:NV});function kV(){return[...TV.getItems(),...AV.getItems()]}function MV(e){const t=yL(e);return RV.getItem(t)}function DV(e,t,n){[e,t,n]=function(e,t,n){"function"===typeof e&&(e=(t=e).PLUGIN_KEY,n=t.PLUGIN_PRIORITY);return[e,t,n]}(e,t,n),void 0===MV(e)&&function(e,t,n){const r=yL(e);if(RV.hasItem(r))throw new Error(NV(r));void 0===n?AV.addItem(r):TV.addItem(n,r);RV.addItem(r,t)}(e,t,n)}const{register:_V,getItem:OV,hasItem:IV,getNames:PV,getValues:jV}=PW("renderers");function FV(e){if("function"===typeof e)return e;if(!IV(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return OV(e)}function HV(e,t){"string"!==typeof e&&(e=(t=e).RENDERER_TYPE),_V(e,t)}const{register:LV,getItem:BV,hasItem:zV,getNames:WV,getValues:VV}=PW("validators");function UV(e){if("function"===typeof e)return e;if(!zV(e))throw Error('No registered validator found under "'.concat(e,'" name'));return BV(e)}function qV(e,t){"string"!==typeof e&&(e=(t=e).VALIDATOR_TYPE),LV(e,t)}function GV(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function YV(e,t){return e.get($V(e,t))}function KV(e,t,n){return e.set($V(e,t),n),n}function $V(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var XV=new WeakMap,QV=new WeakMap,JV=new WeakMap,ZV=new WeakMap,eU=new WeakMap,tU=new WeakMap,nU=new WeakMap,rU=new WeakMap,iU=new WeakMap,oU=new WeakMap;const aU=class{constructor(e,t,n,r,i,o){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;GV(this,XV,void 0),GV(this,QV,void 0),GV(this,JV,void 0),GV(this,ZV,void 0),GV(this,eU,void 0),GV(this,tU,void 0),GV(this,nU,void 0),GV(this,rU,void 0),GV(this,iU,[null,null]),GV(this,oU,[null,null]),KV(XV,this,n),KV(QV,this,t),KV(JV,this,i),KV(ZV,this,o),KV(eU,this,a),KV(tU,this,r),KV(nU,this,e),this.registerEvents()}registerEvents(){YV(tU,this).addEventListener(YV(JV,this).holder,"contextmenu",e=>this.onContextMenu(e)),YV(tU,this).addEventListener(YV(JV,this).TABLE,"mouseover",e=>this.onMouseOver(e)),YV(tU,this).addEventListener(YV(JV,this).TABLE,"mouseout",e=>this.onMouseOut(e));const e=()=>{YV(tU,this).addEventListener(YV(JV,this).holder,"touchstart",e=>this.onTouchStart(e)),YV(tU,this).addEventListener(YV(JV,this).holder,"touchend",e=>this.onTouchEnd(e)),this.momentumScrolling||(this.momentumScrolling={}),YV(tU,this).addEventListener(YV(JV,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||YV(XV,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,YV(XV,this).getSetting("onAfterMomentumScroll"))},200)})},t=()=>{YV(tU,this).addEventListener(YV(JV,this).holder,"mouseup",e=>this.onMouseUp(e)),YV(tU,this).addEventListener(YV(JV,this).holder,"mousedown",e=>this.onMouseDown(e))};RB()?e():(hB()&&e(),t())}selectedCellWasTouched(e){const t=this.parentCell(e).coords;if(YV(rU,this)&&t){const[e,n]=[t.row,YV(rU,this).from.row],[r,i]=[t.col,YV(rU,this).from.col];return e===n&&r===i}return!1}parentCell(e){const t={},n=BB(e,["TD","TH"],YV(JV,this).TABLE);return n?(t.coords=YV(JV,this).getCoords(n),t.TD=n):YB(e,"wtBorder")&&YB(e,"current")?(t.coords=YV(ZV,this).getFocusSelection().cellRange.highlight,t.TD=YV(JV,this).getCell(t.coords)):YB(e,"wtBorder")&&YB(e,"area")&&YV(ZV,this).getAreaSelection().cellRange&&(t.coords=YV(ZV,this).getAreaSelection().cellRange.to,t.TD=YV(JV,this).getCell(t.coords)),t}onMouseDown(e){const t=YV(QV,this).rootDocument.activeElement,n=$z(IB,e.target),r=e.target;if(!["TD","TH"].includes(t.nodeName)&&(r===t||n(0)===t||n(1)===t))return;const i=this.parentCell(r);YB(r,"corner")?YV(XV,this).getSetting("onCellCornerMouseDown",e,r):i.TD&&YV(XV,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,i.coords,i.TD),(0===e.button||this.touchApplied)&&i.TD&&(YV(oU,this)[0]=i.TD,clearTimeout(YV(iU,this)[0]),YV(iU,this)[0]=setTimeout(()=>{YV(oU,this)[0]=null},1e3))}onContextMenu(e){if(YV(XV,this).has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!YV(XV,this).has("onCellMouseOver"))return;const t=YV(JV,this).TABLE,n=BB(e.target,["TD","TH"],t),r=YV(eU,this)||this;n&&n!==r.lastMouseOver&&WB(n,t)&&(r.lastMouseOver=n,this.callListener("onCellMouseOver",e,YV(JV,this).getCoords(n),n))}onMouseOut(e){if(!YV(XV,this).has("onCellMouseOut"))return;const t=YV(JV,this).TABLE,n=BB(e.target,["TD","TH"],t),r=BB(e.relatedTarget,["TD","TH"],t),i=YV(eU,this)||this;n&&n!==r&&WB(n,t)&&(this.callListener("onCellMouseOut",e,YV(JV,this).getCoords(n),n),null===r&&(i.lastMouseOver=null))}onMouseUp(e){const t=this.parentCell(e.target);t.TD&&YV(XV,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),(0===e.button||this.touchApplied)&&(t.TD===YV(oU,this)[0]&&t.TD===YV(oU,this)[1]?(YB(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),YV(oU,this)[0]=null,YV(oU,this)[1]=null):t.TD===YV(oU,this)[0]&&(YV(oU,this)[1]=t.TD,clearTimeout(YV(iU,this)[1]),YV(iU,this)[1]=setTimeout(()=>{YV(oU,this)[1]=null},500)))}onTouchStart(e){KV(rU,this,YV(ZV,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const n=e.target,r=null===(t=this.parentCell(n))||void 0===t?void 0:t.coords,i=nL(r)&&r.row>=0&&r.col>=0;if(e.cancelable&&i&&YV(XV,this).getSetting("isDataViewInstance")){const t=["A","BUTTON","INPUT"];kB()&&(SB()||EB())&&this.selectedCellWasTouched(n)&&!t.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,n,r){const i=YV(XV,this).getSettingPure(e);i&&i(t,n,r,YV(nU,this).call(this))}destroy(){clearTimeout(YV(iU,this)[0]),clearTimeout(YV(iU,this)[1]),YV(tU,this).destroy()}};function sU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const lU=class{constructor(e,t,n){sU(this,"offset",void 0),sU(this,"total",void 0),sU(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}};function cU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const uU=class{constructor(e,t,n){cU(this,"offset",void 0),cU(this,"total",void 0),cU(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}};function dU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class hU{constructor(){dU(this,"currentSize",0),dU(this,"nextSize",0),dU(this,"currentOffset",0),dU(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function fU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class mU{constructor(){fU(this,"size",new hU),fU(this,"workingSpace",0),fU(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return null!==this.sharedSize}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}}function pU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class gU{constructor(e,t){pU(this,"order",[]),this.order=[...Array(t).keys()].map(t=>e+t)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function vU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class yU{constructor(e){vU(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:t,nextSize:n}=e.getViewSize();let r=Math.max(n,t);if(0===r)return[];const{currentOffset:i,nextOffset:o}=e.getViewSize(),a=new gU(i,t),s=new gU(o,n),l=[];for(let c=0;c<r;c++){const t=a.get(c),i=s.get(c);if(-1===i)l.push(["remove",t]);else if(-1===t)!e.isShared()||e.isShared()&&e.isPlaceOn(2)?l.push(["append",i]):l.push(["prepend",i]);else if(i>t)a.has(i)&&(a.remove(i),n<=a.length&&(r-=1)),l.push(["replace",i,t]);else if(i<t){const e=a.prepend(i);l.push(["insert_before",i,t,e])}else l.push(["none",i])}return l}}function bU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class wU{constructor(e,t){bU(this,"rootNode",void 0),bU(this,"nodesPool",void 0),bU(this,"sizeSet",new mU),bU(this,"collectedNodes",[]),bU(this,"viewDiffer",new yU(this.sizeSet)),bU(this,"leads",[]),this.rootNode=e,this.nodesPool=t}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:t}=this,[n,r,i,o]=e,a=this.nodesPool(r);switch(this.collectedNodes.push(a),n){case"prepend":t.insertBefore(a,t.firstChild);break;case"append":t.appendChild(a);break;case"insert_before":t.insertBefore(a,this.nodesPool(i)),t.removeChild(this.nodesPool(o));break;case"replace":t.replaceChild(a,this.nodesPool(i));break;case"remove":t.removeChild(a)}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class xU extends wU{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function SU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class CU{constructor(e){SU(this,"nodeType",void 0),SU(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,t){const n="number"===typeof t?"".concat(e,"x").concat(t):e.toString();if(this.pool.has(n))return this.pool.get(n);const r=this.rootDocument.createElement(this.nodeType);return this.pool.set(n,r),r}}function EU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class NU{constructor(e,t){EU(this,"nodesPool",null),EU(this,"nodeType",void 0),EU(this,"rootNode",void 0),EU(this,"table",null),EU(this,"renderedNodes",0),this.nodesPool="string"===typeof e?new CU(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function TU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class AU extends NU{constructor(){super("TH"),TU(this,"orderViews",new WeakMap),TU(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new xU(e,e=>this.nodesPool.obtain(this.sourceRowIndex,e)),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:n,rows:r,cells:i}=this.table;for(let o=0;o<e;o++){const e=this.table.renderedRowToSource(o),a=r.getRenderedNode(o);this.sourceRowIndex=e;const s=this.obtainOrderView(a),l=i.obtainOrderView(a);s.appendView(l).setSize(n).setOffset(0).start();for(let r=n-1;r>=0;r--){s.render();const n=s.getCurrentNode();n.className="",n.removeAttribute("style"),QB(n,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&XB(n,[kL(),OL(),WL(r+1),TL(-1)]),t[r](e,n,r)}s.end()}}}class RU extends NU{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:r}=this.table,i=r+t;for(let t=0,a=e;t<a;t++){for(n=this.rootNode.childNodes[t],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<i;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>i;)n.removeChild(n.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let t=e;t<o;t++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&ZB(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&XB(this.rootNode,[["role","rowgroup"]]);for(let t=0;t<e;t+=1){const{columnHeaderFunctions:e,columnsToRender:n,rowHeadersCount:r}=this.table,i=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&XB(i,[DL(),zL(t+1)]);for(let o=-1*r;o<n;o+=1){const n=this.table.renderedColumnToSource(o),a=i.childNodes[o+r];a.className="",a.removeAttribute("style"),QB(a,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&XB(a,[WL(o+1+this.table.rowHeadersCount),TL(-1),ML(),...o>=0?[_L()]:[RL(),IL("Select whole grid")]]),e[t](n,a,t)}}}}var kU;let MU=!1;class DU extends NU{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,n=e+t;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;!MU&&e>1e3&&(MU=!0,hW(ZH(kU||(kU=RH(['Performance tip: Handsontable rendered more than 1000 visible columns. \n        Consider limiting the number of rendered columns by specifying the table width and/or \n        turning off the "renderAllColumns" option.'],['Performance tip: Handsontable rendered more than 1000 visible columns.\\x20\n        Consider limiting the number of rendered columns by specifying the table width and/or\\x20\n        turning off the "renderAllColumns" option.'])))));for(let r=0;r<t;r++){const e=this.table.renderedColumnToSource(r),t=this.table.columnUtils.getHeaderWidth(e);this.rootNode.childNodes[r].style.width="".concat(t,"px")}for(let r=0;r<e;r++){const e=this.table.renderedColumnToSource(r),n=this.table.columnUtils.getWidth(e);this.rootNode.childNodes[r+t].style.width="".concat(n,"px")}const n=this.rootNode.firstChild;n&&KB(n,"rowHeader")}}var _U;function OU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const IU="ht__row_even",PU="ht__row_odd";let jU=!1;class FU extends NU{constructor(e){super("TR",e),OU(this,"orderView",void 0),this.orderView=new wU(e,e=>this.nodesPool.obtain(e))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!jU&&e>1e3&&(jU=!0,hW(ZH(_U||(_U=RH(['Performance tip: Handsontable rendered more than 1000 visible rows. \n        Consider limiting the number of rendered rows by specifying the table height and/or \n        turning off the "renderAllRows" option.'],['Performance tip: Handsontable rendered more than 1000 visible rows.\\x20\n        Consider limiting the number of rendered rows by specifying the table height and/or\\x20\n        turning off the "renderAllRows" option.']))))),this.table.isAriaEnabled()&&XB(this.rootNode,[["role","rowgroup"]]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let r=0;r<e;r++){this.orderView.render();const e=this.orderView.getCurrentNode(),i=this.table.renderedRowToSource(r);var t,n;if(this.table.isAriaEnabled())XB(e,[DL(),zL(i+(null!==(t=null===(n=this.table.rowUtils)||void 0===n||null===(n=n.dataAccessObject)||void 0===n?void 0:n.columnHeaders.length)&&void 0!==t?t:0)+1)]);(i+1)%2===0?YB(e,IU)||($B(e,PU),KB(e,IU)):YB(e,PU)||($B(e,IU),KB(e,PU))}this.orderView.end()}}function HU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class LU extends NU{constructor(){super("TD"),HU(this,"orderViews",new WeakMap),HU(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new xU(e,e=>this.nodesPool.obtain(this.sourceRowIndex,e),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:n,rowHeaders:r}=this.table;for(let a=0;a<e;a++){const e=this.table.renderedRowToSource(a),s=n.getRenderedNode(a);this.sourceRowIndex=e;const l=this.obtainOrderView(s),c=r.obtainOrderView(s);l.prependView(c).setSize(t).setOffset(0).start();for(let n=0;n<t;n++){l.render();const t=this.table.renderedColumnToSource(n),r=l.getCurrentNode();var i,o;if(YB(r,"hide")||(r.className=""),r.removeAttribute("style"),r.removeAttribute("dir"),QB(r,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(e,t,r),this.table.isAriaEnabled())XB(r,[...r.hasAttribute("role")?[]:[AL()],TL(-1),WL(t+(null!==(i=null===(o=this.table.rowUtils)||void 0===o||null===(o=o.dataAccessObject)||void 0===o?void 0:o.rowHeaders.length)&&void 0!==i?i:0)+1)])}l.end()}}}function BU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class zU{constructor(e){let{cellRenderer:t,stylesHandler:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};BU(this,"rootNode",void 0),BU(this,"rootDocument",void 0),BU(this,"rowHeaders",null),BU(this,"columnHeaders",null),BU(this,"colGroup",null),BU(this,"rows",null),BU(this,"cells",null),BU(this,"rowFilter",null),BU(this,"columnFilter",null),BU(this,"rowUtils",null),BU(this,"columnUtils",null),BU(this,"rowsToRender",0),BU(this,"columnsToRender",0),BU(this,"rowHeaderFunctions",[]),BU(this,"rowHeadersCount",0),BU(this,"columnHeaderFunctions",[]),BU(this,"columnHeadersCount",0),BU(this,"cellRenderer",void 0),BU(this,"activeOverlayName",void 0),BU(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:n,rows:r,cells:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.setTable(this),t.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=n,this.rows=r,this.cells=i}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let n=0;n<e;n++){const e=t.getRenderedNode(n),r=this.rowUtils;if(e.firstChild){const t=this.renderedRowToSource(n),i=r.getHeightByOverlayName(t,this.activeOverlayName),o=this.stylesHandler.areCellsBorderBox()?0:1;e.firstChild.style.height=i?"".concat(i-o,"px"):""}}}}class WU{constructor(){let{TABLE:e,THEAD:t,COLGROUP:n,TBODY:r,rowUtils:i,columnUtils:o,cellRenderer:a,stylesHandler:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new zU(e,{cellRenderer:a,stylesHandler:s}),this.renderer.setRenderers({rowHeaders:new AU,columnHeaders:new RU(t),colGroup:new DU(n),rows:new FU(r),cells:new LU}),this.renderer.setAxisUtils(i,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function VU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class UU{constructor(e,t){VU(this,"dataAccessObject",void 0),VU(this,"wtSettings",void 0),VU(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=t}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let t=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return void 0!==n&&(t=t?Math.max(t,n):n),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let t=e.getSetting("rowHeaderWidth");if(t=e.getSetting("onModifyRowHeaderWidth",t),null!==t&&void 0!==t){const n=e.getSetting("rowHeaders").length,r=e.getSetting("defaultColumnWidth");for(let e=0;e<n;e++){let n=Array.isArray(t)?t[e]:t;n=null===n||void 0===n?r:n,this.headerWidths.set(e,n)}}}}function qU(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class GU{constructor(e,t){qU(this,"dataAccessObject",void 0),qU(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==n&&(t=void 0===t?n:Math.max(t,n)),t}getHeightByOverlayName(e,t){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,t);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==r&&(n=void 0===n?r:Math.max(n,r)),n}}const YU="top",KU="bottom",$U="inline_start",XU="top_inline_start_corner",QU="bottom_inline_start_corner",JU=[YU,KU,$U,XU,QU],ZU=new Map([[YU,"ht_clone_".concat(YU)],[KU,"ht_clone_".concat(KU)],[$U,"ht_clone_".concat($U," ht_clone_left")],[XU,"ht_clone_".concat(XU," ht_clone_top_left_corner")],[QU,"ht_clone_".concat(QU," ht_clone_bottom_left_corner")]]);function eq(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const tq=class{constructor(e,t,n,r,i){eq(this,"wtSettings",null),eq(this,"domBindings",void 0),eq(this,"TBODY",null),eq(this,"THEAD",null),eq(this,"COLGROUP",null),eq(this,"hasTableHeight",!0),eq(this,"hasTableWidth",!0),eq(this,"isTableVisible",!1),eq(this,"tableOffset",0),eq(this,"holderOffset",0),this.domBindings=n,this.isMaster="master"===i,this.name=i,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=r,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,JB(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new GU(this.dataAccessObject,this.wtSettings),this.columnUtils=new UU(this.dataAccessObject,this.wtSettings),this.tableRenderer=new WU({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let n;return t&&t.nodeType===Node.ELEMENT_NODE&&YB(t,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",t&&t.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&XB(n,[["role","presentation"]]),n}createHider(e){const t=e.parentNode;let n;return t&&t.nodeType===Node.ELEMENT_NODE&&YB(t,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",t&&t.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&XB(n,[["role","presentation"]]),n}createHolder(e){const t=e.parentNode;let n;return t&&t.nodeType===Node.ELEMENT_NODE&&YB(t,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",this.isMaster&&XB(n,[TL(-1)]),t&&t.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&XB(n.parentNode,[["role","presentation"]])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&XB(n,[["role","presentation"]]),n}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:t}=this,{wtOverlays:n,wtViewport:r}=this.dataAccessObject,i=t.getSetting("totalRows"),o=t.getSetting("totalColumns"),a=t.getSetting("rowHeaders"),s=a.length,l=t.getSetting("columnHeaders"),c=l.length;let u=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=oz(this.holder),u=r.createCalculators(u),s&&!t.getSetting("fixedColumnsStart"))){const e=n.inlineStartOverlay.getScrollPosition(),t=this.correctHeaderWidth;this.correctHeaderWidth=0!==e,t!==this.correctHeaderWidth&&(u=!1)}if(u)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=oz(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const e=Math.max(this.getFirstRenderedRow(),0),t=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new uU(e,i,c),this.columnFilter=new lU(t,o,s);let u=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const e={};this.wtSettings.getSetting("beforeDraw",!0,e),u=!0!==e.skipRender}u&&(this.tableRenderer.setHeaderContentRenderers(a,l),(this.is(KU)||this.is(QU))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(KU))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||r.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(KU)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(d=n.bottomOverlay.resetFixedPosition()||d),d=n.inlineStartOverlay.resetFixedPosition()||d,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(u),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i,o,a;const s=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,i=this.getColumnHeaderHeight(n),o=this.getColumnHeader(t,n),o&&(a=yz(o),(!i&&r<a||i<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(s)?null!==s[n]&&void 0!==s[n]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=s[n]):isNaN(s)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=s),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(s[n]||s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=s[n]||s))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders;for(let r=0,i=e.getSetting("columnHeaders").length;r<i;r++)if(n[r]){if(!t[r]||0===t[r].childNodes.length)return;t[r].childNodes[0].style.height="".concat(n[r],"px")}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if((this.isMaster||this.is(KU))&&!e.getSetting("externalRowCalculator")){const e=this.getRenderedRowsCount();for(let n=0;n<e;n++){const e=this.rowFilter.renderedToSource(n);t.oversizedRows&&t.oversizedRows[e]&&(t.oversizedRows[e]=void 0)}}}getCell(e){let t=e.row,n=e.col;const r=this.wtSettings.getSetting("onModifyGetCellCoords",t,n,!this.isMaster,"render");if(r&&Array.isArray(r)&&([t,n]=r),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const i=this.getRow(t);if(!i&&t>=0)throw new Error("TR was expected to be rendered but is not");const o=i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!o&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let t=null,n=null;var r,i;e<0?(t=null===(r=this.rowFilter)||void 0===r?void 0:r.sourceRowToVisibleColHeadedRow(e),n=this.THEAD):(t=null===(i=this.rowFilter)||void 0===i?void 0:i.sourceToRendered(e),n=this.TBODY);return void 0!==t&&void 0!==n&&(!(n.childNodes.length<t+1)&&n.childNodes[t])}getColumnHeader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.THEAD.childNodes[t];return null===n||void 0===n?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(e=>{const r=e.childNodes[n];r&&t.push(r)}),t}getRowHeader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t>=this.wtSettings.getSetting("rowHeaders").length)return;const n=this.rowFilter.sourceToRendered(e),r=n<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):n,i=(n<0?this.THEAD:this.TBODY).childNodes[r];return null===i||void 0===i?void 0:i.childNodes[t]}getRowHeaders(e){const t=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<n;r++){const n=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],i=null===n||void 0===n?void 0:n.childNodes[r];i&&t.push(i)}return t}getCoords(e){let t=e;if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=LB(t,["TD","TH"])),null===t)return null;const n=t.parentNode;if(!n)return null;const r=n.parentNode;let i=VB(n),o=t.cellIndex;if(UB(XU,t,this.wtRootElement)||UB(YU,t,this.wtRootElement))"THEAD"===r.nodeName&&(i-=r.childNodes.length);else if(UB(QU,t,this.wtRootElement)||UB(KU,t,this.wtRootElement)){i=this.wtSettings.getSetting("totalRows")-r.childNodes.length+i}else r===this.THEAD?i=this.rowFilter.visibleColHeadedRowToSourceRow(i):this.rowFilter&&(i=this.rowFilter.renderedToSource(i));UB(XU,t,this.wtRootElement)||UB($U,t,this.wtRootElement)||UB(QU,t,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):this.columnFilter&&(o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",i,o);return a&&Array.isArray(a)&&([i,o]=a),this.wot.createCellCoords(i,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=this.wtSettings.getSetting("stylesHandler"),n=e*t.getDefaultRowHeight(),r=yz(this.TBODY)-1,i=t.areCellsBorderBox(),o=i?vz:yz,a=i?0:1,s=i?1:0;let l,c,u,d,h;if(n!==r||this.wtSettings.getSetting("fixedRowsBottom"))for(;e;){e-=1,u=this.rowFilter.renderedToSource(e),l=this.getRowHeight(u),d=this.getTrForRow(u),h=d.querySelector("th");const n=0===u?s:0;c=h?o(h):o(d)-a,(!l&&t.getDefaultRowHeight()<c-n||l<c)&&(i||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[u]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const t=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=t}isRowHeaderRendered(e){if(e>=0)return!1;const t=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=t}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return gz(this.TABLE)}getHeight(){return vz(this.TABLE)}getTotalWidth(){const e=gz(this.hider);return 0!==e?e:this.getWidth()}getTotalHeight(){const e=vz(this.hider);return 0!==e?e:this.getHeight()}isVisible(){return rz(this.TABLE)}_modifyRowHeaderWidth(e){let t=Uz(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return"number"!==typeof e&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}},nq={getFirstRenderedRow(){return 0===this.getRenderedRowsCount()?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};nB(nq,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});const rq=nq,iq={getFirstRenderedColumn(){const e=this.dataAccessObject.startColumnRendered;return null===e?-1:e},getFirstVisibleColumn(){const e=this.dataAccessObject.startColumnVisible;return null===e?-1:e},getFirstPartiallyVisibleColumn(){const e=this.dataAccessObject.startColumnPartiallyVisible;return null===e?-1:e},getLastRenderedColumn(){const e=this.dataAccessObject.endColumnRendered;return null===e?-1:e},getLastVisibleColumn(){const e=this.dataAccessObject.endColumnVisible;return null===e?-1:e},getLastPartiallyVisibleColumn(){const e=this.dataAccessObject.endColumnPartiallyVisible;return null===e?-1:e},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};nB(iq,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});const oq=iq;class aq extends tq{constructor(e,t,n,r){super(e,t,n,r,YU)}}ZL(aq,rq),ZL(aq,oq);const sq=aq;function lq(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function cq(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uq(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var dq=new WeakSet;function hq(e){const{wtSettings:t,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:a}=this.dataAccessObject;if(n.mainTableScrollableElement===a){let s=null;if(t.getSetting("rtlMode")){const e=r.TABLE.getBoundingClientRect(),t=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;s=Math.abs(e.right-t)}else{s=oz(r.wtRootElement).left}const l=Math.abs(cz(a,a));if(s>l){const t=bz(a);let r=i.getRowHeaderWidth();for(let i=1;i<=o;i++)if(r+=n.sumCellSizes(i-1,i),s+r-l>=t){e=i-2;break}}}return e}function fq(e){const{topOverlay:t,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(t.mainTableScrollableElement===o){const a=oz(n.wtRootElement),s=lz(o,o);if(a.top>s){const n=yz(o);let l=r.getColumnHeaderHeight();for(let r=1;r<=i;r++)if(l+=t.sumCellSizes(r-1,r),a.top+l-s>=n){e=r-2;break}}}return e}const mq=class{constructor(e){lq(this,dq),cq(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,t,n){if(e.col<0||e.row<0)return!1;const r=this.scrollViewportHorizontally(e.col,t),i=this.scrollViewportVertically(e.row,n);return r||i}scrollViewportHorizontally(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";const{drawn:n,totalColumns:r}=this.dataAccessObject;if(!n)return!1;const i=sB(t);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,i),!Number.isInteger(e)||e<0||e>r)return!1;t=i.value;const{fixedColumnsStart:o,inlineStartOverlay:a}=this.dataAccessObject,s="auto"===t;if(s&&e<o)return!1;const l=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let u=!1;return(s&&(e<l||e>c)||!s)&&(u=a.scrollTo(e,s?e>=this.getLastPartiallyVisibleColumn():"end"===t)),u}scrollViewportVertically(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";const{drawn:n,totalRows:r}=this.dataAccessObject;if(!n)return!1;const i=sB(t);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,i),!Number.isInteger(e)||e<0||e>r)return!1;t=i.value;const{fixedRowsBottom:o,fixedRowsTop:a,topOverlay:s}=this.dataAccessObject,l="auto"===t;if(l&&(e<a||e>r-o-1))return!1;const c=this.getFirstVisibleRow(),u=this.getLastVisibleRow();let d=!1;return(l&&(e<c||e>u)||!l)&&(d=s.scrollTo(e,l?e>=this.getLastPartiallyVisibleRow():"bottom"===t)),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return uq(dq,this,fq).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return uq(dq,this,fq).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return uq(dq,this,hq).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return uq(dq,this,hq).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}};function pq(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function gq(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vq(e,t){return e.get(bq(e,t))}function yq(e,t,n){return e.set(bq(e,t),n),n}function bq(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var wq=new WeakMap;class xq{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];gq(this,"row",null),gq(this,"col",null),pq(this,wq,!1),yq(wq,this,n),"undefined"!==typeof e&&"undefined"!==typeof t&&(this.row=e,this.col=t)}isValid(e){const{countRows:t,countCols:n,countRowHeaders:r,countColHeaders:i}=E({countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0},e);return!(!Number.isInteger(this.row)||!Number.isInteger(this.col))&&(!(this.row<-i||this.col<-r)&&!(this.row>=t||this.col>=n))}isEqual(e){return e===this||this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return vq(wq,this)}isSouthEastOf(e){return this.row>=e.row&&(vq(wq,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(vq(wq,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(vq(wq,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(vq(wq,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(null===e||void 0===e?void 0:e.row)&&(this.row=e.row),Number.isInteger(null===e||void 0===e?void 0:e.col)&&(this.col=e.col),e instanceof xq&&yq(wq,this,e.isRtl()),this}clone(){return new xq(this.row,this.col,vq(wq,this))}toObject(){return{row:this.row,col:this.col}}}const Sq=xq;function Cq(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function Eq(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nq(e,t){return e.get(Tq(e,t))}function Tq(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Aq=new WeakMap;class Rq{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Eq(this,"highlight",null),Eq(this,"from",null),Eq(this,"to",null),Cq(this,Aq,!1),this.highlight=e.clone(),this.from=t.clone(),this.to=n.clone(),function(e,t,n){e.set(Tq(e,t),n)}(Aq,this,r)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return!(!this.from.isHeader()||!this.to.isHeader())||(this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0)}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:n}=e,r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return r.row<=t&&i.row>=t&&r.col<=n&&i.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return(e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col)&&(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0)}expandByRange(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=this.getDirection(),o=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),s=Math.min(n.row,o.row),l=Math.min(n.col,o.col),c=Math.max(r.row,a.row),u=Math.max(r.col,a.col),d=this._createCellCoords(s,l),h=this._createCellCoords(c,u);return this.from=d,this.to=h,this.setDirection(i),t&&(this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally()),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Nq(Aq,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Nq(Aq,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Nq(Aq,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Nq(Aq,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Nq(Aq,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Nq(Aq,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Nq(Aq,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Nq(Aq,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){return e instanceof Sq&&(e.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():e.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():e.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():e.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),r=Math.min(this.from.col,this.to.col),i=Math.max(this.from.col,this.to.col),o=Math.min(e.from.row,e.to.row),a=Math.max(e.from.row,e.to.row),s=Math.min(e.from.col,e.to.col),l=Math.max(e.from.col,e.to.col),c=[];return t===o&&c.push("top"),i===l&&c.push(Nq(Aq,this)?"left":"right"),n===a&&c.push("bottom"),r===s&&c.push(Nq(Aq,this)?"right":"left"),c}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[];for(let r=e.row;r<=t.row;r++)for(let i=e.col;i<=t.col;i++)this.from.row===r&&this.from.col===i||this.to.row===r&&this.to.col===i||n.push(this._createCellCoords(r,i));return n}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[];for(let r=e.row;r<=t.row;r++)for(let i=e.col;i<=t.col;i++)e.row===r&&e.col===i?n.push(e):t.row===r&&t.col===i?n.push(t):n.push(this._createCellCoords(r,i));return n}forAll(e){const t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let r=t.row;r<=n.row;r++)for(let i=t.col;i<=n.col;i++){if(!1===e(r,i))return}}clone(){return new Rq(this.highlight,this.from,this.to,Nq(Aq,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new Sq(e,t,Nq(Aq,this))}}const kq=Rq;function Mq(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Dq{get eventManager(){return new $W(this)}constructor(e,t){Mq(this,"wtTable",void 0),Mq(this,"wtScroll",void 0),Mq(this,"wtViewport",void 0),Mq(this,"wtOverlays",void 0),Mq(this,"selectionManager",void 0),Mq(this,"wtEvent",void 0),Mq(this,"guid","wt_".concat(wL())),Mq(this,"drawInterrupted",!1),Mq(this,"drawn",!1),Mq(this,"activeOverlayName","master"),Mq(this,"domBindings",void 0),Mq(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new mq(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;t<n;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,n){nz(n,e[t])}])}}createCellCoords(e,t){return new Sq(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,n){return new kq(e,t,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,!this.wtTable.isVisible()||iz(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(e);const t=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),r=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<n&&e.col<i)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<i&&e.row>=t-r){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<i)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<t&&e.row>=t-r&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,n){return this.wtScroll.scrollViewport(e,t,n)}scrollViewportHorizontally(e,t){return this.wtScroll.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this.wtScroll.scrollViewportVertically(e,t)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function _q(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Oq extends Dq{constructor(e,t,n){super(e,t),_q(this,"cloneSource",void 0),_q(this,"cloneOverlay",void 0);const r=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new aU(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function Iq(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Pq{constructor(e,t,n,r,i){Iq(this,"wtSettings",null),nB(this,"wot",e,{writable:!1}),this.domBindings=i,this.facadeGetter=t,this.wtSettings=r;const{TABLE:o,hider:a,spreader:s,holder:l,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=s,this.holder=l,this.wtRootElement=c,this.trimmingContainer=fz(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){"before"===e&&this.shouldBeRendered()?this.needFullRender=!0:"after"!==e||this.shouldBeRendered()||(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=fz(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=uz(e.TABLE)}getRelativeCellPosition(e,t,n){if(!1===this.clone.wtTable.holder.contains(e))return void hW("The provided element is not a child of the ".concat(this.type," overlay"));const r=this.mainTableScrollableElement===this.domBindings.rootWindow,i=n<this.wtSettings.getSetting("fixedColumnsStart"),o=t<this.wtSettings.getSetting("fixedRowsTop"),a=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),s=this.clone.wtTable.spreader,l={start:this.getRelativeStartPosition(s),top:s.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let u=null;return u=r?this.getRelativeCellPositionWithinWindow(o,i,c,l):this.getRelativeCellPositionWithinHolder(o,a,i,c,l),u}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,n,r){const i=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,a=0;if(t){let e=i.left;this.isRtl()&&(e=this.domBindings.rootWindow.innerWidth-(i.left+i.width+kz())),o=e<=0?-1*e:0}else o=r.start;if(e){a=this.clone.wtTable.TABLE.getBoundingClientRect().top-i.top}else a=r.top;return{start:n.start+o,top:n.top+a}}getRelativeCellPositionWithinHolder(e,t,n,r,i){const o=this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),a=this.wot.wtOverlays.topOverlay.getScrollPosition();let s=0,l=0;if(n||(s=o-i.start),t){const e=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+e.top}else e||(l=a-i.top);return{start:r.start-s,top:r.top-l}}makeClone(){if(-1===JU.indexOf(this.type))throw new Error('Clone type "'.concat(this.type,'" is not supported.'));const{wtTable:e,wtSettings:t}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=n.createElement("div"),o=n.createElement("table"),a=e.wtRootElement.parentNode;i.className="".concat(ZU.get(this.type)," handsontable"),i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,t.getSetting("ariaTags")&&XB(i,[["role","presentation"]]),o.className=e.TABLE.className;e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),i.appendChild(o),a.appendChild(i);const s=this.wtSettings.getSetting("preventOverflow");return!0===s||"horizontal"===s&&this.type===YU||"vertical"===s&&this.type===$U?this.mainTableScrollableElement=r:"hidden"===r.getComputedStyle(a).getPropertyValue("overflow")?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=uz(e.TABLE),new Oq(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.needFullRender){const t=this.clone.cloneSource;t.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),t.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider;[e.style,t.style,e.parentNode.style].forEach(e=>{e.width="",e.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}const jq=e=>{const t=e.wtSettings.getSetting("stylesHandler");if(t.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=t.getCSSVariableValue("cell-autofill-size"),r=t.getCSSVariableValue("cell-autofill-border-width"),i=t.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};function Fq(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Hq extends Pq{constructor(e,t,n,r){super(e,t,YU,n,r),Fq(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new sq(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0,i=!1;if(this.trimmingContainer!==t||n&&"vertical"===n)r=this.getScrollPosition(),Iz(e);else{const{wtTable:t}=this.wot,n=t.hider.getBoundingClientRect();i=Math.ceil(n.bottom)===e.offsetHeight,r=this.getOverlayOffset(),_z(e,"0px","".concat(r,"px"))}const o=this.adjustHeaderBordersPosition(r,i);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:t}=this.domBindings,n=this.mainTableScrollableElement;let r=!1;if(n===t&&e!==t.scrollY){const n=t.scrollY;t.scrollTo(sz(t),e),r=n!==t.scrollY}else if(e!==n.scrollTop){const t=n.scrollTop;n.scrollTop=e,r=t!==n.scrollTop}return r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let r=e,i=0;for(;r<t;){const e=this.wot.wtTable.getRowHeight(r);i+=void 0===e?n:e,r+=1}return i}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode.style,o=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===o){let r=t.getWorkspaceWidth();t.hasVerticalScroll()&&(r-=kz(n)),r=Math.min(r,e.wtRootElement.scrollWidth),i.width="".concat(r,"px")}else i.width="";this.clone.wtTable.holder.style.width=i.width;let a=vz(this.clone.wtTable.TABLE);e.hasDefinedSize()||(a=0),i.height="".concat(a,"px")}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=jq(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(t.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height="".concat(parseInt(e.parentNode.style.height,10)+n,"px")}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):t.style[e]=""}scrollTo(e,t){const{wot:n,wtSettings:r}=this,i=(n.cloneSource?n.cloneSource:n).wtTable.holder,o=r.getSetting("columnHeaders"),a=0===r.getSetting("fixedRowsTop")&&o.length>0&&!YB(i.parentNode,"innerBorderTop")?1:0;let s=this.getTableParentOffset(),l=0;if(t){this.wot.wtTable.getRowHeight(e)>this.wot.wtViewport.getViewportHeight()&&(t=!1)}if(t&&i.offsetHeight!==i.clientHeight&&(l=kz(this.domBindings.rootDocument)),t){const t=r.getSetting("fixedRowsBottom"),i=r.getSetting("totalRows");s+=this.sumCellSizes(0,e+1),s-=n.wtViewport.getViewportHeight()-this.sumCellSizes(i-t,i),s+=1,s+=a}else s+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);return s+=l,dz(this.mainTableScrollableElement)===s-a&&a>0&&this.wot.wtOverlays.expandHiderVerticallyBy(a),this.setScrollPosition(s)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return lz(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){const e=this.wot.wtTable.getTotalHeight()-this.clone.wtTable.getTotalHeight();n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>e&&(n=0)}return n}adjustHeaderBordersPosition(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("totalColumns"),o="horizontal"===n.getSetting("preventOverflow");i?$B(r,"emptyColumns"):KB(r,"emptyColumns");let a=!1;if(!t&&!o){const t=n.getSetting("fixedRowsTop"),i=this.cachedFixedRowsTop!==t,o=n.getSetting("columnHeaders");if((i||0===t)&&o.length>0){const t=YB(r,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||0===n.getSetting("totalRows")?(KB(r,"innerBorderTop"),a=!t):($B(r,"innerBorderTop"),a=t)}}return a}}const Lq={getFirstRenderedRow(){const e=this.getRenderedRowsCount();return 0===e?-1:this.wtSettings.getSetting("totalRows")-e},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return 0===this.getRenderedRowsCount()?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount:()=>0};nB(Lq,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});const Bq=Lq;class zq extends tq{constructor(e,t,n,r){super(e,t,n,r,KU)}}ZL(zq,Bq),ZL(zq,oq);const Wq=zq;function Vq(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Uq extends Pq{constructor(e,t,n,r){super(e,t,KU,n,r),Vq(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Wq(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let n=0;const r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==e||r&&"vertical"===r?(n=this.getScrollPosition(),this.repositionOverlay()):(n=this.getOverlayOffset(),t.style.bottom="".concat(n,"px"));const i=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),i}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=kz(n)),r.style.bottom="".concat(i,"px")}setScrollPosition(e){const{rootWindow:t}=this.domBindings,n=this.mainTableScrollableElement;let r=!1;if(n===t&&e!==t.scrollY){const e=t.scrollY;t.scrollTo(sz(t),top),r=e!==t.scrollY}else if(e!==n.scrollTop){const t=n.scrollTop;n.scrollTop=e,r=t!==n.scrollTop}return r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:n,wtSettings:r}=this.wot,i=r.getSetting("stylesHandler").getDefaultRowHeight();let o=e,a=0;for(;o<t;){const e=n.getRowHeight(o);a+=void 0===e?i:e,o+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode.style,o=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===o){let r=t.getWorkspaceWidth();t.hasVerticalScroll()&&(r-=kz(n)),r=Math.min(r,e.wtRootElement.scrollWidth),i.width="".concat(r,"px")}else i.width="";this.clone.wtTable.holder.style.width=i.width;let a=vz(this.clone.wtTable.TABLE);e.hasDefinedSize()||(a=0),i.height="".concat(a,"px")}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):t.style[e]=""}scrollTo(e,t){let n=this.getTableParentOffset();const r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let i=0;t&&r.offsetHeight!==r.clientHeight&&(i=kz(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=i,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return lz(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){const e=this.wot.wtTable.getTotalHeight(),t=e-this.clone.wtTable.getTotalHeight(),r=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-r+e,0),n>t&&(n=0)}return n}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==t,r=this.wtSettings.getSetting("columnHeaders");let i=!1;if((n||0===t)&&r.length>0){const t=this.wot.wtTable.holder.parentNode,n=YB(t,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||0===this.wtSettings.getSetting("totalRows")?(KB(t,"innerBorderBottom"),i=!n):($B(t,"innerBorderBottom"),i=n)}return i}}const qq={getFirstRenderedRow(){const e=this.dataAccessObject.startRowRendered;return null===e?-1:e},getFirstVisibleRow(){const e=this.dataAccessObject.startRowVisible;return null===e?-1:e},getFirstPartiallyVisibleRow(){const e=this.dataAccessObject.startRowPartiallyVisible;return null===e?-1:e},getLastRenderedRow(){const e=this.dataAccessObject.endRowRendered;return null===e?-1:e},getLastVisibleRow(){const e=this.dataAccessObject.endRowVisible;return null===e?-1:e},getLastPartiallyVisibleRow(){const e=this.dataAccessObject.endRowPartiallyVisible;return null===e?-1:e},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};nB(qq,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});const Gq=qq,Yq={getFirstRenderedColumn(){return 0===this.getRenderedColumnsCount()?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};nB(Yq,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});const Kq=Yq;class $q extends tq{constructor(e,t,n,r){super(e,t,n,r,$U)}}ZL($q,Gq),ZL($q,Kq);const Xq=$q;class Qq extends Pq{constructor(e,t,n,r){super(e,t,$U,n,r)}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Xq(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,n=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow");let i=0;this.trimmingContainer!==t||r&&"horizontal"===r?(i=this.getScrollPosition(),Iz(n)):(i=this.getOverlayOffset()*(this.isRtl()?-1:1),_z(n,"".concat(i,"px"),"0px"));const o=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let n=!1;this.isRtl()&&(e=-e);const r=this.mainTableScrollableElement;if(r===t&&e!==t.scrollX){const r=t.scrollX;t.scrollTo(e,az(t)),n=r!==t.scrollX}else if(e!==r.scrollLeft){const t=r.scrollLeft;r.scrollLeft=e,n=t!==r.scrollLeft}return n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const n=this.wtSettings.getSetting("defaultColumnWidth");let r=e,i=0;for(;r<t;)i+=this.wot.wtTable.getColumnWidth(r)||n,r+=1;return i}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode.style,o=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"vertical"===o){let r=t.getWorkspaceHeight();t.hasHorizontalScroll()&&(r-=kz(n)),r=Math.min(r,e.wtRootElement.scrollHeight),i.height="".concat(r,"px")}else i.height="";this.clone.wtTable.holder.style.height=i.height;const a=gz(this.clone.wtTable.TABLE);i.width="".concat(a,"px")}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=jq(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(t.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width="".concat(parseInt(e.parentNode.style.width,10)+n,"px")}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if("number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[t]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[t]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){const{wtSettings:n}=this,r=n.getSetting("rowHeaders"),i=n.getSetting("fixedColumnsStart"),o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,a=0===i&&r.length>0&&!YB(o.parentNode,"innerBorderInlineStart")?1:0;let s=this.getTableParentOffset(),l=0;if(t){this.wot.wtTable.getColumnWidth(e)>this.wot.wtViewport.getViewportWidth()&&(t=!1)}return t&&o.offsetWidth!==o.clientWidth&&(l=kz(this.domBindings.rootDocument)),t?(s+=this.sumCellSizes(0,e+1),s-=this.wot.wtViewport.getViewportWidth(),s+=a):s+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),s+=l,hz(this.mainTableScrollableElement)===s-a&&a>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(a),this.setScrollPosition(s)}getTableParentOffset(){let e=0;return this.wtSettings.getSetting("preventOverflow")||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}getScrollPosition(){return Math.abs(cz(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||"horizontal"!==t)){n=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);n>this.wot.wtTable.getTotalWidth()-this.clone.wtTable.getTotalWidth()&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:t}=this,n=this.wot.wtTable.holder.parentNode,r=t.getSetting("rowHeaders"),i=t.getSetting("fixedColumnsStart"),o=t.getSetting("totalRows"),a="vertical"===t.getSetting("preventOverflow");o?$B(n,"emptyRows"):KB(n,"emptyRows");let s=!1;if(!a)if(i&&!r.length)KB(n,"innerBorderLeft innerBorderInlineStart");else if(!i&&r.length){const t=YB(n,"innerBorderInlineStart");e?(KB(n,"innerBorderLeft innerBorderInlineStart"),s=!t):($B(n,"innerBorderLeft innerBorderInlineStart"),s=t)}return s}}class Jq extends tq{constructor(e,t,n,r){super(e,t,n,r,XU)}}ZL(Jq,rq),ZL(Jq,Kq);const Zq=Jq;function eG(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class tG extends Pq{constructor(e,t,n,r,i,o){super(e,t,XU,n,r),eG(this,"topOverlay",void 0),eG(this,"inlineStartOverlay",void 0),this.topOverlay=i,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Zq(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const t=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),n=this.topOverlay.getOverlayOffset();_z(e,"".concat(t,"px"),"".concat(n,"px"))}else Iz(e);let t=vz(this.clone.wtTable.TABLE);const n=gz(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height="".concat(t,"px"),e.style.width="".concat(n,"px"),!1}}class nG extends tq{constructor(e,t,n,r){super(e,t,n,r,QU)}}ZL(nG,Bq),ZL(nG,Kq);const rG=nG;class iG extends Pq{constructor(e,t,n,r,i,o){super(e,t,QU,n,r),this.bottomOverlay=i,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new rG(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const e=this.inlineStartOverlay.getOverlayOffset(),n=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]="".concat(e,"px"),t.style.bottom="".concat(n,"px")}else Iz(t),this.repositionOverlay();let n=vz(this.clone.wtTable.TABLE);const r=gz(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),t.style.height="".concat(n,"px"),t.style.width="".concat(r,"px"),!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=kz(n)),r.style.bottom="".concat(i,"px")}}function oG(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function aG(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sG(e,t,n){return e.set(cG(e,t),n),n}function lG(e,t){return e.get(cG(e,t))}function cG(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var uG=new WeakMap,dG=new WeakMap,hG=new WeakMap,fG=new WeakMap;const mG=class{constructor(e,t,n,r,i,o){aG(this,"wot",null),oG(this,uG,[]),aG(this,"topOverlay",null),aG(this,"bottomOverlay",null),aG(this,"inlineStartOverlay",null),aG(this,"topInlineStartCornerOverlay",null),aG(this,"bottomInlineStartCornerOverlay",null),aG(this,"browserLineHeight",void 0),aG(this,"wtSettings",null),oG(this,dG,!1),oG(this,hG,0),oG(this,fG,null),aG(this,"resizeObserver",new ResizeObserver(e=>{uB(()=>{Array.isArray(e)&&e.length&&(sG(hG,this,lG(hG,this)+1),300===lG(hG,this)&&(hW("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),null!==lG(fG,this)&&clearTimeout(lG(fG,this)),sG(fG,this,setTimeout(()=>{sG(hG,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=r,this.domBindings=n,this.facadeGetter=t,this.wtTable=o;const{rootDocument:a,rootWindow:s}=this.domBindings;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=kz(a);const l="hidden"===s.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=l?o.holder:uz(o.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=s.scrollX,this.lastScrollY=s.scrollY}getOverlays(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=[...lG(uG,this)];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,n=e.getComputedStyle(t.body),r=parseInt(n.lineHeight,10),i=1.2*parseInt(n.fontSize,10);this.browserLineHeight=r||i}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Hq(...e),this.bottomOverlay=new Uq(...e),this.inlineStartOverlay=new Qq(...e),this.topInlineStartCornerOverlay=new tG(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new iG(...e,this.bottomOverlay,this.inlineStartOverlay),sG(uG,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){sG(dG,this,lG(uG,this).reduce((e,t)=>t.hasRenderingStateChanged()||e,!1)),lG(uG,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),lG(uG,this).forEach(e=>{const t=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),t&&!e.needFullRender&&e.reset()})}refreshAll(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:r}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",e=>this.onKeyDown(e)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",e=>this.onTableScroll(e),{passive:!0}),n!==r&&this.eventManager.addEventListener(r,"scroll",e=>this.onTableScroll(e),{passive:!0});const i=t.devicePixelRatio&&t.devicePixelRatio>1,o=this.scrollableElement===t,a=this.wtSettings.getSetting("preventWheel"),s={passive:o};(a||i||!xB())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",e=>this.onCloneWheel(e,a),s);let l;[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(e=>{this.eventManager.addEventListener(e.clone.wtTable.holder,"wheel",e=>this.onCloneWheel(e,a),s)}),this.eventManager.addEventListener(t,"resize",()=>{uB(()=>{clearTimeout(l),this.wtSettings.getSetting("onWindowResize"),l=setTimeout(()=>{sG(hG,this,0)},200)})}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const t=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,i=e.target;this.keyPressed&&(r!==t&&i!==t&&!e.target.contains(r)||n!==t&&i!==t&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,t){if(e.ctrlKey)return;const{rootWindow:n}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target,a=i!==n&&o!==n&&!o.contains(i),s=r!==n&&o!==n&&!o.contains(r);if(this.keyPressed&&(a||s)||this.scrollableElement===n)return;const l=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==n&&l)&&e.preventDefault()}onKeyDown(e){this.keyPressed=oW(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(n+=n*this.browserLineHeight,t+=t*this.browserLineHeight);const r=this.scrollVertically(t),i=this.scrollHorizontally(n);return r||i}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,t=this.inlineStartOverlay.clone.wtTable.holder;let n=this.scrollableElement.scrollLeft,r=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(n=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(r=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==n,this.verticalScrolling=this.lastScrollY!==r,this.lastScrollX=n,this.lastScrollY=r,this.horizontalScrolling){e.scrollLeft=n;const t=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;t&&(t.scrollLeft=n)}this.verticalScrolling&&(t.scrollTop=r),this.refreshAll()}syncScrollWithMaster(){if(!lG(dG,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),sG(dG,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=e.holder:this.scrollableElement=uz(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,n=e.clientHeight,r=t!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=n),r}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:t}=this,{rootWindow:n}=this.domBindings,r=this.scrollableElement===n,i=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),s=e.getColumnHeaderHeight(),l=this.wtSettings.getSetting("externalRowCalculator")?0:1,c=s+this.topOverlay.sumCellSizes(0,o)+l,u=a+this.inlineStartOverlay.sumCellSizes(0,i),d=t.hider.style,h=(()=>!r&&this.scrollableElement.scrollTop>Math.max(0,c-t.holder.clientHeight))()?1:0,f=(()=>!r&&this.scrollableElement.scrollLeft>Math.max(0,u-t.holder.clientWidth))()?1:0;d.width="".concat(u+f,"px"),d.height="".concat(c+h,"px"),this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:t}=this;t.hider.style.height="".concat(parseInt(t.hider.style.height,10)+e,"px")}expandHiderHorizontallyBy(e){const{wtTable:t}=this;t.hider.style.width="".concat(parseInt(t.hider.style.width,10)+e,"px")}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return WH(t,t=>{t&&t.clone&&t.clone.wtTable.TABLE.contains(e)&&(n=t.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE;WH([this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],t=>{t&&(t.clone.wtTable.TABLE.className=e.className)})}};function pG(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class gG{constructor(e){pG(this,"settings",{}),pG(this,"defaults",Object.freeze(this.getDefaults())),rB(this.defaults,(t,n)=>{if(void 0!==e[n])this.settings[n]=e[n];else{if(void 0===t)throw new Error('A required setting "'.concat(n,'" was not provided'));this.settings[n]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow:()=>!1,preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders:()=>[],columnHeaders:()=>[],totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,n)=>{const r=this.getSetting("data",e,t);nz(n,void 0===r||null===r?"":r)},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,t){return void 0===t?rB(e,(e,t)=>{this.settings[t]=e}):this.settings[e]=t,this}getSetting(e,t,n,r,i){return"function"===typeof this.settings[e]?this.settings[e](t,n,r,i):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class vG extends tq{constructor(e,t,n,r){super(e,t,n,r,"master")}alignOverlaysWithTrimmingContainer(){const e=fz(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t){this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{const n=e.parentElement,r=mz(e,"height",t),i=mz(e,"overflow",t),o=this.holder.style,{scrollWidth:a,scrollHeight:s}=e;let l=e.offsetWidth,c=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(i)){const r=e.cloneNode(!1);r.style.overflow="auto",r.style.position="absolute",e.nextElementSibling?n.insertBefore(r,e.nextElementSibling):n.appendChild(r);const i=parseInt(t.getComputedStyle(r).height,10);n.removeChild(r),0===i&&(c=0)}c=Math.min(c,s),o.height="auto"===r?"auto":"".concat(c,"px"),l=Math.min(l,a),o.width="".concat(l,"px"),o.overflow="",this.hasTableHeight="auto"===o.height||c>0,this.hasTableWidth=l>0}this.isTableVisible=rz(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,n="master",r=e.getSetting("columnHeaders").length;if(r&&!t.hasOversizedColumnHeadersMarked[n]){const i=e.getSetting("rowHeaders").length,o=this.getRenderedColumnsCount();for(let e=0;e<r;e++)for(let t=-1*i;t<o;t++)this.markIfOversizedColumnHeader(t);t.hasOversizedColumnHeadersMarked[n]=!0}}}ZL(vG,Gq),ZL(vG,oq);const yG=vG;function bG(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class wG{constructor(){bG(this,"count",0),bG(this,"startRow",0),bG(this,"endRow",0),bG(this,"startPosition",0),bG(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:t}=e;this.count=t,this.endRow=this.count-1}process(){}finalize(){}}function xG(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class SG{constructor(){xG(this,"count",0),xG(this,"startRow",null),xG(this,"endRow",null),xG(this,"startPosition",null),xG(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:n,zeroBasedScrollOffset:r,innerViewportHeight:i}=t;n<=r&&(this.startRow=e),n>=r&&n<=i&&null===this.startRow&&(this.startRow=e),this.endRow=e}finalize(e){var t;const{scrollOffset:n,viewportHeight:r,horizontalScrollbarHeight:i,totalRows:o,needReverse:a,startPositions:s,rowHeight:l}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const e=s[this.endRow]+l-s[this.startRow-1];if(this.startRow-=1,e>=r-i)break}this.startPosition=null!==(t=s[this.startRow])&&void 0!==t?t:null;n+r-i<0||n>s.at(-1)+l?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function CG(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class EG extends SG{constructor(){super(...arguments),CG(this,"rowStartOffset",0),CG(this,"rowEndOffset",0)}finalize(e){var t;super.finalize(e);const{overrideFn:n,totalRows:r,startPositions:i}=e;if(null!==this.startRow&&"function"===typeof n){const e=this.startRow,t=this.endRow;n(this),this.rowStartOffset=e-this.startRow,this.rowEndOffset=this.endRow-t}this.startRow<0&&(this.startRow=0),this.startPosition=null!==(t=i[this.startRow])&&void 0!==t?t:null,r<this.endRow&&(this.endRow=r-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function NG(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class TG{constructor(){NG(this,"count",0),NG(this,"startRow",null),NG(this,"endRow",null),NG(this,"startPosition",null),NG(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:n,zeroBasedScrollOffset:r,innerViewportHeight:i,rowHeight:o}=t;n>=r&&n+o<=i&&(null===this.startRow&&(this.startRow=e),this.endRow=e)}finalize(e){var t;const{scrollOffset:n,viewportHeight:r,horizontalScrollbarHeight:i,totalRows:o,needReverse:a,startPositions:s,rowHeight:l}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const e=s[this.endRow]+l-s[this.startRow-1];if(e<=r-i&&(this.startRow-=1),e>=r-i)break}this.startPosition=null!==(t=s[this.startRow])&&void 0!==t?t:null;n+r-i<(null===this.startRow?0:e.getRowHeight(this.startRow))||n>s.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function AG(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class RG{constructor(){AG(this,"count",0),AG(this,"startColumn",0),AG(this,"endColumn",0),AG(this,"startPosition",0),AG(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:t}=e;this.count=t,this.endColumn=this.count-1}process(){}finalize(){}}function kG(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class MG{constructor(){kG(this,"count",0),kG(this,"startColumn",null),kG(this,"endColumn",null),kG(this,"startPosition",null),kG(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:n,zeroBasedScrollOffset:r,viewportWidth:i}=t;n<=r&&(this.startColumn=e);n>=r&&n<=r+(r>0?i+1:i)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=e)),this.endColumn=e}finalize(e){var t;const{scrollOffset:n,viewportWidth:r,inlineStartOffset:i,zeroBasedScrollOffset:o,totalColumns:a,needReverse:s,startPositions:l,columnWidth:c}=e;if(this.endColumn===a-1&&s)for(this.startColumn=this.endColumn;this.startColumn>0;){const e=l[this.endColumn]+c-l[this.startColumn-1];if(this.startColumn-=1,e>r)break}this.startPosition=null!==(t=l[this.startColumn])&&void 0!==t?t:null;n+r-(o>0?r+1:r)<-1*i||n>l.at(-1)+c||-1*n-r>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function DG(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class _G extends MG{constructor(){super(...arguments),DG(this,"columnStartOffset",0),DG(this,"columnEndOffset",0)}finalize(e){var t;super.finalize(e);const{overrideFn:n,totalColumns:r,startPositions:i}=e;if(null!==this.startColumn&&"function"===typeof n){const e=this.startColumn,t=this.endColumn;n(this),this.columnStartOffset=e-this.startColumn,this.columnEndOffset=this.endColumn-t}this.startColumn<0&&(this.startColumn=0),this.startPosition=null!==(t=i[this.startColumn])&&void 0!==t?t:null,r<this.endColumn&&(this.endColumn=r-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function OG(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class IG{constructor(){OG(this,"count",0),OG(this,"startColumn",null),OG(this,"endColumn",null),OG(this,"startPosition",null),OG(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:n,zeroBasedScrollOffset:r,viewportWidth:i,columnWidth:o}=t;n>=r&&n+o<=r+(r>0?i+1:i)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=e),this.endColumn=e)}finalize(e){var t;const{scrollOffset:n,viewportWidth:r,inlineStartOffset:i,zeroBasedScrollOffset:o,totalColumns:a,needReverse:s,startPositions:l,columnWidth:c}=e;if(this.endColumn===a-1&&s)for(this.startColumn=this.endColumn;this.startColumn>0;){const e=l[this.endColumn]+c-l[this.startColumn-1];if(e<=r&&(this.startColumn-=1),e>=r)break}this.startPosition=null!==(t=l[this.startColumn])&&void 0!==t?t:null;const u=n+r-(o>0?r+1:r),d=null===this.startColumn?0:e.getColumnWidth(this.startColumn);u<-1*i||n>l.at(-1)||-1*n-r>-1*d?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function PG(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class jG{constructor(e){PG(this,"calculationTypes",[]),PG(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(t=>{let[n,r]=t;this.calculationResults.set(n,r),r.initialize(e)})}_process(e,t){this.calculationTypes.forEach(n=>{let[,r]=n;return r.process(e,t)})}_finalize(e){this.calculationTypes.forEach(t=>{let[,n]=t;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function FG(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class HG extends jG{constructor(e){let{calculationTypes:t,viewportHeight:n,scrollOffset:r,totalRows:i,defaultRowHeight:o,rowHeightFn:a,overrideFn:s,horizontalScrollbarHeight:l}=e;super(t),FG(this,"viewportHeight",0),FG(this,"scrollOffset",0),FG(this,"zeroBasedScrollOffset",0),FG(this,"totalRows",0),FG(this,"rowHeightFn",null),FG(this,"rowHeight",0),FG(this,"overrideFn",null),FG(this,"horizontalScrollbarHeight",0),FG(this,"innerViewportHeight",0),FG(this,"totalCalculatedHeight",0),FG(this,"startPositions",[]),FG(this,"needReverse",!0),this.defaultHeight=o,this.viewportHeight=n,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalRows=i,this.rowHeightFn=a,this.overrideFn=s,this.horizontalScrollbarHeight=null!==l&&void 0!==l?l:0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const t=this.rowHeightFn(e);return isNaN(t)?this.defaultHeight:t}}function LG(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const BG=50;class zG extends jG{constructor(e){let{calculationTypes:t,viewportWidth:n,scrollOffset:r,totalColumns:i,columnWidthFn:o,overrideFn:a,inlineStartOffset:s}=e;super(t),LG(this,"viewportWidth",0),LG(this,"scrollOffset",0),LG(this,"zeroBasedScrollOffset",0),LG(this,"totalColumns",0),LG(this,"columnWidthFn",null),LG(this,"columnWidth",0),LG(this,"overrideFn",null),LG(this,"inlineStartOffset",0),LG(this,"totalCalculatedWidth",0),LG(this,"startPositions",[]),LG(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalColumns=i,this.columnWidthFn=o,this.overrideFn=a,this.inlineStartOffset=s,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const t=this.columnWidthFn(e);return isNaN(t)?BG:t}}const WG=class{constructor(e,t,n,r,i){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new wG:new EG],["fullyVisible",()=>new TG],["partiallyVisible",()=>new SG]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new RG:new _G],["fullyVisible",()=>new IG],["partiallyVisible",()=>new MG]]),this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;if(t===this.domBindings.rootWindow)n=e.documentElement.clientHeight;else{n=vz(t)>0&&t.clientHeight>0?t.clientHeight:1/0}return n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:t}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let r;if(n===t){const t=this.wtSettings.getSetting("totalColumns");r=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,t)>r&&(r=e.documentElement.clientWidth)}else r=n.clientWidth;return r}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const e=this.domBindings.rootDocument.documentElement;return e.scrollHeight>e.clientHeight}const{holder:e,hider:t}=this.wtTable,n=e.clientHeight,r=t.offsetHeight;return n<r||r>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const e=this.domBindings.rootDocument.documentElement;return e.scrollWidth>e.clientWidth}const{hider:e}=this.wtTable,t=e.offsetWidth,n=this.hasVerticalScroll()?kz():0;return t>this.getWorkspaceWidth()-n}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,t){let n=0,r=e;for(;r<t;)n+=this.wtTable.getColumnWidth(r),r+=1;return n}getWorkspaceOffset(){return oz(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=vz(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,r=t.length;n<r;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let e=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let n=0,r=t.length;n<r;n++)e?(this.rowHeaderWidth+=gz(e),e=e.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:n}=this;let r,i,o=this.getViewportHeight();this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const s=t.getSetting("fixedRowsTop"),l=t.getSetting("fixedRowsBottom"),c=t.getSetting("totalRows");return s&&a>=0&&(i=this.dataAccessObject.topOverlay.sumCellSizes(0,s),a+=i,o-=i),l&&this.dataAccessObject.bottomOverlay.clone&&(i=this.dataAccessObject.bottomOverlay.sumCellSizes(c-l,c),o-=i),r=n.holder.clientHeight===n.holder.offsetHeight?0:kz(this.domBindings.rootDocument),new HG({calculationTypes:e.map(e=>[e,this.rowsCalculatorTypes.get(e)()]),viewportHeight:o,scrollOffset:a,totalRows:t.getSetting("totalRows"),defaultRowHeight:t.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:e=>n.getRowHeight(e),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:r})}createColumnsCalculator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:n}=this;let r=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=t.getSetting("fixedColumnsStart");if(o&&i>=0){const e=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);i+=e,r-=e}return n.holder.clientWidth!==n.holder.offsetWidth&&(r-=kz(this.domBindings.rootDocument)),new zG({calculationTypes:e.map(e=>[e,this.columnsCalculatorTypes.get(e)()]),viewportWidth:r,scrollOffset:i,totalColumns:t.getSetting("totalColumns"),columnWidthFn:e=>n.getColumnWidth(e),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:t}=this,n=this.createRowsCalculator(),r=this.createColumnsCalculator();if(e&&!t.getSetting("renderAllRows")){const t=n.getResultsFor("fullyVisible"),r=n.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(t,r)}if(e&&!t.getSetting("renderAllColumns")){const t=r.getResultsFor("fullyVisible"),n=r.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(t,n)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=r.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),t=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=t.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e,t){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r}=e;const{startRow:i,endRow:o}=t;if(null===n&&null===r){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isRowBeforeRenderedRows(i)&&!this.wtTable.isRowAfterRenderedRows(o))return!0;n=i,r=o}const{startRow:a,endRow:s,rowStartOffset:l,rowEndOffset:c}=this.rowsRenderCalculator,u=this.wtSettings.getSetting("totalRows")-1,d=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(d)&&d>0?(n=Math.max(0,n-Math.min(l,d)),r=Math.min(u,r+Math.min(c,d))):"auto"===d&&(n=Math.max(0,n-Math.ceil(l/2)),r=Math.min(u,r+Math.ceil(c/2))),!(n<a||n===a&&n>0)&&!(r>s||r===s&&r<u)}areAllProposedVisibleColumnsAlreadyRendered(e,t){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r}=e;const{startColumn:i,endColumn:o}=t;if(null===n&&null===r){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isColumnBeforeRenderedColumns(i)&&!this.wtTable.isColumnAfterRenderedColumns(o))return!0;n=i,r=o}const{startColumn:a,endColumn:s,columnStartOffset:l,columnEndOffset:c}=this.columnsRenderCalculator,u=this.wtSettings.getSetting("totalColumns")-1,d=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(d)&&d>0?(n=Math.max(0,n-Math.min(l,d)),r=Math.min(u,r+Math.min(c,d))):"auto"===d&&(n=Math.max(0,n-Math.ceil(l/2)),r=Math.min(u,r+Math.ceil(c/2))),!(n<a||n===a&&n>0)&&!(r>s||r===s&&r<u)}resetHasOversizedColumnHeadersMarked(){rB(this.hasOversizedColumnHeadersMarked,(e,t,n)=>{n[t]=void 0})}};n(1001);function VG(e,t,n){UG(e,t),t.set(e,n)}function UG(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qG(e,t){return e.get(YG(e,t))}function GG(e,t,n){return e.set(YG(e,t),n),n}function YG(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var KG=new WeakMap,$G=new WeakMap,XG=new WeakSet;class QG{constructor(){!function(e,t){UG(e,t),t.add(e)}(this,XG),VG(this,KG,void 0),VG(this,$G,void 0)}setActiveOverlay(e){return GG($G,this,e),this}setActiveSelection(e){return GG(KG,this,e),this}scan(){const e=qG(KG,this).settings.selectionType,t=new Set;return"active-header"===e?(this.scanColumnsInHeadersRange(e=>t.add(e)),this.scanRowsInHeadersRange(e=>t.add(e))):"area"===e?this.scanCellsRange(e=>t.add(e)):"focus"===e?(this.scanColumnsInHeadersRange(e=>t.add(e)),this.scanRowsInHeadersRange(e=>t.add(e)),this.scanCellsRange(e=>t.add(e))):"fill"===e?this.scanCellsRange(e=>t.add(e)):"header"===e?(this.scanColumnsInHeadersRange(e=>t.add(e)),this.scanRowsInHeadersRange(e=>t.add(e))):"row"===e?(this.scanRowsInHeadersRange(e=>t.add(e)),this.scanRowsInCellsRange(e=>t.add(e))):"column"===e&&(this.scanColumnsInHeadersRange(e=>t.add(e)),this.scanColumnsInCellsRange(e=>t.add(e))),t}scanColumnsInHeadersRange(e){const[t,n,r,i]=qG(KG,this).getCorners(),{wtTable:o}=qG($G,this),a=o.getRenderedColumnsCount(),s=o.getColumnHeadersCount();let l=0;for(let c=-o.getRowHeadersCount();c<a;c++){const a=o.columnFilter.renderedToSource(c);if(!(a<n||a>i)){for(let c=-s;c<0;c++){if(c<t||c>r)continue;const u=c+s;let d=o.getColumnHeader(a,u);const h=qG($G,this).getSetting("onBeforeHighlightingColumnHeader",a,u,{selectionType:qG(KG,this).settings.selectionType,columnCursor:l,selectionWidth:i-n+1});null!==h&&(h!==a&&(d=o.getColumnHeader(h,u)),e(d))}l+=1}}}scanRowsInHeadersRange(e){const[t,n,r,i]=qG(KG,this).getCorners(),{wtTable:o}=qG($G,this),a=o.getRenderedRowsCount(),s=o.getRowHeadersCount();let l=0;for(let c=-o.getColumnHeadersCount();c<a;c++){const a=o.rowFilter.renderedToSource(c);if(!(a<t||a>r)){for(let c=-s;c<0;c++){if(c<n||c>i)continue;const u=c+s;let d=o.getRowHeader(a,u);const h=qG($G,this).getSetting("onBeforeHighlightingRowHeader",a,u,{selectionType:qG(KG,this).settings.selectionType,rowCursor:l,selectionHeight:r-t+1});null!==h&&(h!==a&&(d=o.getRowHeader(h,u)),e(d))}l+=1}}}scanCellsRange(e){const{wtTable:t}=qG($G,this);YG(XG,this,JG).call(this,(n,r)=>{const i=t.getCell(qG($G,this).createCellCoords(n,r)),o=qG($G,this).getSetting("onAfterDrawSelection",n,r,qG(KG,this).settings.layerLevel);"string"===typeof o&&KB(i,o),e(i)})}scanRowsInCellsRange(e){const[t,,n]=qG(KG,this).getCorners(),{wtTable:r}=qG($G,this);YG(XG,this,ZG).call(this,(i,o)=>{if(i>=t&&i<=n){const t=r.getCell(qG($G,this).createCellCoords(i,o));e(t)}})}scanColumnsInCellsRange(e){const[,t,,n]=qG(KG,this).getCorners(),{wtTable:r}=qG($G,this);YG(XG,this,ZG).call(this,(i,o)=>{if(o>=t&&o<=n){const t=r.getCell(qG($G,this).createCellCoords(i,o));e(t)}})}}function JG(e){let[t,n,r,i]=qG(KG,this).getCorners();if(t<0&&r<0||n<0&&i<0)return;const{wtTable:o}=qG($G,this),a=t!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),t=Math.max(t,0),r=Math.max(r,0),a){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),t=Math.max(t,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<t)return}else{if(!Vz(o.getCell(qG($G,this).createCellCoords(t,n))))return}for(let s=t;s<=r;s+=1)for(let t=n;t<=i;t+=1)e(s,t)}function ZG(e){const{wtTable:t}=qG($G,this),n=t.getRenderedRowsCount(),r=t.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const n=t.rowFilter.renderedToSource(i);for(let i=0;i<r;i+=1)e(n,t.columnFilter.renderedToSource(i))}}const eY="ht-border-style-";const tY=class{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=jq(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,n=this.main.childNodes.length;t<n;t++){const e=this.main.childNodes[t];this.eventManager.addEventListener(e,"mouseenter",e=>this.onMouseEnter(e,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),aW(e);const n=this,r=this.wot.rootDocument.body,i=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(r,"mousemove",function e(o){var a;((a=o).clientY<Math.floor(i.top)||a.clientY>Math.ceil(i.top+i.height)||a.clientX<Math.floor(i.left)||a.clientX>Math.ceil(i.left+i.width))&&(n.eventManager.removeEventListener(r,"mousemove",e),t.style.display="block")})}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const n=["top","start","bottom","end","corner"];let r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let a=0;a<5;a++){const i=n[a],o=t.createElement("div"),s=t=>this.settings[i]&&this.settings[i][t]?this.settings[i][t]:e.border[t];o.className="wtBorder ".concat(this.settings.className||""),this.settings[i]&&this.settings[i].hide&&(o.className+=" hidden"),r=o.style;const l=s("style");l?(["start","end"].includes(i)?o.className+=" ".concat(eY).concat(l).concat("-vertical"):o.className+=" ".concat(eY).concat(l).concat("-horizontal"),r.setProperty("--ht-custom-border-size","".concat(s("width"),"px")),r.setProperty("--ht-custom-border-color",s("color"))):r.backgroundColor=s("color"),r.height="".concat(s("width"),"px"),r.width="".concat(s("width"),"px"),this.main.appendChild(o)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width="".concat(this.cornerDefaultStyle.width,"px"),this.cornerStyle.height="".concat(this.cornerDefaultStyle.height,"px"),this.cornerStyle.border=["".concat(this.cornerDefaultStyle.borderWidth,"px"),this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),RB()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:i}=this.wot;let o=i.bordersHolder;o||(o=t.createElement("div"),o.className="htBorders",i.bordersHolder=o,i.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:t}=this.wot,n=t.getSetting("stylesHandler"),r=n.getCSSVariableValue("cell-mobile-handle-size"),i=n.getCSSVariableValue("cell-mobile-handle-border-radius"),o=n.getCSSVariableValue("cell-mobile-handle-background-color"),a=n.getCSSVariableValue("cell-mobile-handle-border-width"),s=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};rB({position:"absolute",height:"".concat(40,"px"),width:"".concat(40,"px"),"border-radius":"".concat(parseInt(40/1.5,10),"px")},(e,t)=>{this.selectionHandles.styles.bottomHitArea[t]=e,this.selectionHandles.styles.topHitArea[t]=e});rB(n.isClassicTheme()?{position:"absolute",height:"".concat(10,"px"),width:"".concat(10,"px"),"border-radius":"".concat(parseInt(10/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:"".concat(r,"px"),width:"".concat(r,"px"),"border-radius":"".concat(i,"px"),background:"".concat(o),border:"".concat(a,"px solid ").concat(s)},(e,t)=>{this.selectionHandles.styles.bottom[t]=e,this.selectionHandles.styles.top[t]=e}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const n=this.wot.selectionManager.getAreaSelection();return!(!n.cellRange||e===n.cellRange.to.row&&t===n.cellRange.to.col)}updateMultipleSelectionHandlesPosition(e,t,n,r,i,o){const a=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:s,topHitArea:l,bottom:c,bottomHitArea:u}=this.selectionHandles.styles,d=parseInt(s.borderWidth,10),h=parseInt(s.width,10),f=parseInt(l.width,10),m=this.wot.wtTable.getWidth(),p=this.wot.wtTable.getHeight();s.top="".concat(parseInt(n-h-1,10),"px"),s[a]="".concat(parseInt(r-h-1,10),"px"),l.top="".concat(parseInt(n-f/4*3,10),"px"),l[a]="".concat(parseInt(r-f/4*3,10),"px");const g=Math.min(parseInt(r+i,10),m-h-2*d),v=Math.min(parseInt(r+i-f/4,10),m-f-2*d);c[a]="".concat(g,"px"),u[a]="".concat(v,"px");const y=Math.min(parseInt(n+o,10),p-h-2*d),b=Math.min(parseInt(n+o-f/4,10),p-f-2*d);c.top="".concat(y,"px"),u.top="".concat(b,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(s.display="block",l.display="block",this.isPartRange(e,t)?(c.display="none",u.display="none"):(c.display="block",u.display="block")):(s.display="none",c.display="none",l.display="none",u.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(s.zIndex="9999",l.zIndex="9999"):(s.zIndex="",l.zIndex="")}appear(e){if(this.disabled)return;let[t,n,r,i]=e;if(t<0&&r<0||n<0&&i<0)return void this.disappear();const{wtTable:o,rootDocument:a,rootWindow:s}=this.wot,l=t!==r||n!==i,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),u=o.getFirstRenderedRow(),d=o.getLastRenderedRow(),h=o.getFirstRenderedColumn(),f=o.getLastRenderedColumn();if(h<0&&f<0||u<0&&d<0)return void this.disappear();let m;if(l){if(n=Math.max(n,h),i=Math.min(i,f),t=Math.max(t,u),r=Math.min(r,d),i<n||r<t)return void this.disappear();m=o.getCell(this.wot.createCellCoords(t,n))}else if(m=o.getCell(this.wot.createCellCoords(t,n)),!Vz(m))return void this.disappear();const p=l?o.getCell(this.wot.createCellCoords(r,i)):m,g=oz(m),v=l?oz(p):g,y=oz(o.TABLE),b=g.top,w=g.left,x=this.wot.wtSettings.getSetting("rtlMode");let S=0,C=0;if(x){const e=gz(o.TABLE),t=gz(m),n=s.innerWidth-y.left-e;C=w+t-v.left,S=s.innerWidth-w-t-n-1}else C=v.left+gz(p)-w,S=w-y.left-1;if(this.isEntireColumnSelected(t,r)){const e=t,r=this.getDimensionsFromHeader("columns",n,i,e,y);let o=null;r&&([o,S,C]=r),o&&(m=o)}let E=b-y.top-1,N=v.top+vz(p)-b;if(this.isEntireRowSelected(n,i)){const e=n,i=this.getDimensionsFromHeader("rows",t,r,e,y);let o=null;i&&([o,E,N]=i),o&&(m=o)}const T=s.getComputedStyle(m);parseInt(T.borderTopWidth,10)>0&&(E+=1,N=N>0?N-1:0),parseInt(T[x?"borderRightWidth":"borderLeftWidth"],10)>0&&(S+=1,C=C>0?C-1:0);const A=x?"right":"left",R=Math.ceil(this.settings.border.width/2);this.topStyle.top="".concat(E,"px"),this.topStyle[A]="".concat(S,"px"),this.topStyle.width="".concat(C+R,"px"),this.topStyle.display="block",this.startStyle.top="".concat(E,"px"),this.startStyle[A]="".concat(S,"px"),this.startStyle.height="".concat(N+R,"px"),this.startStyle.display="block",this.bottomStyle.top="".concat(E+N-parseInt(this.bottomStyle.height,10)+R,"px"),this.bottomStyle[A]="".concat(S,"px"),this.bottomStyle.width="".concat(C+R,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(E,"px"),this.endStyle[A]="".concat(S+C-parseInt(this.endStyle.width,10)+R,"px"),this.endStyle.height="".concat(N+R,"px"),this.endStyle.display="block";let k=this.settings.border.cornerVisible;k="function"===typeof k?k(this.settings.layerLevel):k;const M=this.wot.getSetting("onModifyGetCellCoords",r,i,!1,"render");let[D,_]=[r,i];if(M&&Array.isArray(M)&&([,,D,_]=M),RB()||!k||this.isPartRange(D,_))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(E+N+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth,"px"),this.cornerStyle[A]="".concat(S+C+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth,"px"),this.cornerStyle.borderRightWidth="".concat(this.cornerDefaultStyle.borderWidth,"px"),this.cornerStyle.borderLeftWidth="".concat(this.cornerDefaultStyle.borderWidth,"px"),this.cornerStyle.borderBottomWidth="".concat(this.cornerDefaultStyle.borderWidth,"px"),this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let e=fz(o.TABLE);const t=e===s;t&&(e=a.documentElement);const n=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,l=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),u=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(i===this.wot.getSetting("totalColumns")-1){const r=t?p.getBoundingClientRect().left:p.offsetLeft;let i=!1,o=0;if(x?(o=r-parseInt(this.cornerDefaultStyle.width,10)/2,i=o<0):(o=r+gz(p)+parseInt(this.cornerDefaultStyle.width,10)/2,i=o>=bz(e)),i){const e=Math.floor(S+C+this.cornerCenterPointOffset-l-n);c?(this.cornerStyle[A]="".concat(e,"px"),this.cornerStyle[x?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[A]="".concat(e-1,"px")}}if(r===this.wot.getSetting("totalRows")-1){if((t?p.getBoundingClientRect().top:p.offsetTop)+vz(p)+parseInt(this.cornerDefaultStyle.height,10)/2>=yz(e)){const e=Math.floor(E+N+this.cornerCenterPointOffset-u-n);c?(this.cornerStyle.top="".concat(e,"px"),this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top="".concat(e-1,"px")}}this.cornerStyle.display="block"}RB()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(r,i,E,S,C,N)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,n,r,i){const{wtTable:o}=this.wot,a=o.wtRootElement.parentNode;let s=null,l=null,c=null,u=null,d=null,h=null,f=null,m=null;switch(e){case"rows":s=function(){return o.getRowHeader(...arguments)},l=function(){return vz(...arguments)},c="ht__selection--rows",h="top";break;case"columns":s=function(){return o.getColumnHeader(...arguments)},l=function(){return gz(...arguments)},c="ht__selection--columns",h="left"}if(a.classList.contains(c)){const e=this.wot.getSetting("columnHeaders").length;if(f=s(t,e-r),m=s(n,e-r),!f||!m)return!1;const o=oz(f),a=oz(m);return f&&m&&(u=o[h]-i[h]-1,d=a[h]+l(m)-o[h]),[f,u,d]}return!1}changeBorderStyle(e,t){const n=this[e].style,r=t[e];!r||r.hide?KB(this[e],"hidden"):(YB(this[e],"hidden")&&$B(this[e],"hidden"),n.backgroundColor=r.color,"top"!==e&&"bottom"!==e||(n.height="".concat(r.width,"px")),"start"!==e&&"end"!==e||(n.width="".concat(r.width,"px")))}changeBorderToDefaultStyle(e){const t=1,n="#000",r=this[e].style;r.backgroundColor=n,r.width="".concat(t,"px"),r.height="".concat(t,"px")}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?KB(this[e],"hidden"):$B(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",RB()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}};function nY(e,t,n){rY(e,t),t.set(e,n)}function rY(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iY(e,t){return e.get(aY(e,t))}function oY(e,t,n){return e.set(aY(e,t),n),n}function aY(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var sY=new WeakMap,lY=new WeakMap,cY=new WeakMap,uY=new WeakMap,dY=new WeakMap,hY=new WeakMap,fY=new WeakSet;class mY{constructor(e){!function(e,t){rY(e,t),t.add(e)}(this,fY),nY(this,sY,void 0),nY(this,lY,void 0),nY(this,cY,new QG),nY(this,uY,new WeakMap),nY(this,dY,new WeakSet),nY(this,hY,new Map),oY(lY,this,e)}setActiveOverlay(e){return oY(sY,this,e),iY(cY,this).setActiveOverlay(iY(sY,this)),iY(uY,this).has(iY(sY,this))||iY(uY,this).set(iY(sY,this),new Set),this}getFocusSelection(){return null!==iY(lY,this)?iY(lY,this).getFocus():null}getAreaSelection(){return null!==iY(lY,this)?iY(lY,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(iY(hY,this).has(e)){const t=iY(hY,this).get(e);if(t.has(iY(sY,this)))return t.get(iY(sY,this));const n=new tY(iY(sY,this),e.settings);return t.set(iY(sY,this),n),n}const t=new tY(iY(sY,this),e.settings);return iY(hY,this).set(e,new Map([[iY(sY,this),t]])),t}getBorderInstances(e){var t,n;return Array.from(null!==(t=null===(n=iY(hY,this).get(e))||void 0===n?void 0:n.values())&&void 0!==t?t:[])}destroyBorders(e){iY(hY,this).get(e).forEach(e=>e.destroy()),iY(hY,this).delete(e)}render(e){if(null===iY(lY,this))return;e&&aY(fY,this,pY).call(this);const t=Array.from(iY(lY,this)),n=new Map,r=new Map;for(let i=0;i<t.length;i++){const e=t[i],{className:o,headerAttributes:a,createLayers:s,selectionType:l}=e.settings;iY(dY,this).has(e)||(iY(dY,this).add(e),e.addLocalHook("destroy",()=>this.destroyBorders(e)));const c=this.getBorderInstance(e);if(e.isEmpty()){null===c||void 0===c||c.disappear();continue}if(o){iY(cY,this).setActiveSelection(e).scan().forEach(e=>{if(n.has(e)){const t=n.get(e);t.has(o)&&!0===s?t.set(o,t.get(o)+1):t.set(o,1)}else n.set(e,new Map([[o,1]]));a&&(r.has(e)||r.set(e,[]),"TH"===e.nodeName&&r.get(e).push(...a))})}const u=e.getCorners();iY(sY,this).getSetting("onBeforeDrawBorders",u,l),null===c||void 0===c||c.appear(u)}n.forEach((e,t)=>{var n;const r=Array.from(e).map(e=>{let[t,n]=e;return 1===n?t:[t,...Array.from({length:n-1},(e,n)=>"".concat(t,"-").concat(n+1))]}).flat();r.forEach(e=>iY(uY,this).get(iY(sY,this)).add(e)),KB(t,r),"TD"===t.nodeName&&Array.isArray(null===(n=iY(lY,this).options)||void 0===n?void 0:n.cellAttributes)&&XB(t,iY(lY,this).options.cellAttributes)}),Array.from(r.keys()).forEach(e=>{XB(e,[...r.get(e)])})}}function pY(){const e=iY(uY,this).get(iY(sY,this)),t=iY(sY,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(t))for(let n=0;n<t.length;n++)e.add(t[n]);e.forEach(e=>{var t,n;const r=iY(sY,this).wtTable.TABLE.querySelectorAll(".".concat(e));let i=[];Array.isArray(null===(t=iY(lY,this).options)||void 0===t?void 0:t.cellAttributes)&&(i=iY(lY,this).options.cellAttributes.map(e=>e[0])),Array.isArray(null===(n=iY(lY,this).options)||void 0===n?void 0:n.headerAttributes)&&(i=[...i,...iY(lY,this).options.headerAttributes.map(e=>e[0])]);for(let o=0,a=r.length;o<a;o++)$B(r[o],e),QB(r[o],i)}),e.clear()}class gY extends Dq{constructor(e,t){super(e,new gG(t));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new yG(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new WG(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new mY(this.wtSettings.getSetting("selections")),this.wtEvent=new aU(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new mG(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e=[],t=[];rB({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(n,r)=>{this.wtSettings.getSetting(r).length&&t.push(n),e.push(n)}),$B(this.wtTable.wtRootElement.parentNode,e),KB(this.wtTable.wtRootElement.parentNode,t)}getOverlayByName(e){var t;if(!JU.includes(e))return null;const n=e.replace(/_([a-z])/g,e=>e[1].toUpperCase());return null!==(t=this.wtOverlays["".concat(n,"Overlay")])&&void 0!==t?t:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class vY{constructor(e){e instanceof Dq?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=e=>{const t=new vY(e);return()=>t},this._wot=new gY(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,n){return this._wot.createCellRange(e,t,n)}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(e,t)}scrollViewport(e,t,n){return this._wot.scrollViewport(e,t,n)}scrollViewportHorizontally(e,t){return this._wot.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this._wot.scrollViewportVertically(e,t)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,n,r,i){return this._wot.wtSettings.getSetting(e,t,n,r,i)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function yY(e){let{isShiftKey:t,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:a,cellCoordsFactory:s}=e;const l=o.isSelected()?o.getSelectedRange().current():null,c=o.isSelectedByCorner(),u=o.isSelectedByRowHeader();if(o.markSource("mouse"),t&&l)i.row>=0&&i.col>=0&&!a.cell?o.setRangeEnd(i):(c||u)&&i.row>=0&&i.col>=0&&!a.cell?o.setRangeEnd(s(i.row,i.col)):c&&i.row<0&&!a.column?o.setRangeEnd(s(l.to.row,i.col)):u&&i.col<0&&!a.row?o.setRangeEnd(s(i.row,l.to.col)):(!c&&!u&&i.col<0||c&&i.col<0)&&!a.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!c&&!u&&i.row<0||u&&i.row<0)&&!a.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const e=!o.inInSelection(i),t=n||r&&e;i.row<0&&i.col>=0&&!a.column?t&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!a.row?t&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!a.cell?t&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function bY(e){let{isLeftClick:t,selection:n,cellRangeMapper:r}=e;if(!t||"multiple"!==n.settings.selectionMode)return;const i=n.getSelectedRange(),o=i.clone().map(e=>r.toRenderable(e)),a=o.current();if(o.size()>1&&!a.isHeader()&&!n.isMultiple(a)){const e=o.findAll(a);e.length===o.size()?(i.pop(),n.refresh()):e.length>1&&(i.removeLayers(e.map(e=>{let{layer:t}=e;return t})),n.refresh())}}const wY=new Map([["touchstart",yY],["touchend",bY],["mousedown",yY],["mouseover",function(e){let{isLeftClick:t,coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;if(!t)return;const a=r.isSelectedByRowHeader(),s=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),c=r.tableProps.countRows();r.markSource("mouse"),s&&!i.column?r.setRangeEnd(o(c-1,n.col)):a&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}],["mouseup",bY]]);function xY(e,t){wY.get(e.type)(E({isShiftKey:e.shiftKey,isLeftClick:cW(e)||"touchstart"===e.type,isRightClick:lW(e)},t))}const SY=new WeakMap,CY=Symbol("rootInstance");function EY(e){return e===CY}function NY(e){return SY.has(e)}function TY(e,t,n){AY(e,t),t.set(e,n)}function AY(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RY(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kY(e,t){return e.get(DY(e,t))}function MY(e,t,n){return e.set(DY(e,t),n),n}function DY(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _Y=new WeakMap,OY=new WeakMap,IY=new WeakMap,PY=new WeakMap,jY=new WeakMap,FY=new WeakMap,HY=new WeakMap,LY=new WeakMap,BY=new WeakSet;function zY(){return parseInt(this.hot.rootElement.getAttribute(BL()[0]),10)}function WY(e){const t=DY(BY,this,zY).call(this)+e;XB(this.hot.rootElement,...BL(t))}function VY(){const e=this.hot.rootElement;this.hasVerticalScroll()?KB(e,"htHasScrollY"):$B(e,"htHasScrollY"),this.isVerticallyScrollableByWindow()?KB(e,"htVerticallyScrollableByWindow"):$B(e,"htVerticallyScrollableByWindow"),this.hasHorizontalScroll()?KB(e,"htHasScrollX"):$B(e,"htHasScrollX"),this.isHorizontallyScrollableByWindow()?KB(e,"htHorizontallyScrollableByWindow"):$B(e,"htHorizontallyScrollableByWindow")}const UY=class{constructor(e){!function(e,t){AY(e,t),t.add(e)}(this,BY),RY(this,"hot",void 0),RY(this,"eventManager",void 0),RY(this,"settings",void 0),RY(this,"THEAD",void 0),RY(this,"TBODY",void 0),RY(this,"_wt",void 0),RY(this,"activeWt",void 0),TY(this,_Y,0),TY(this,OY,0),RY(this,"postponedAdjustElementsSize",!1),TY(this,IY,!1),TY(this,PY,void 0),TY(this,jY,void 0),TY(this,FY,0),TY(this,HY,0),TY(this,LY,null),this.hot=e,this.eventManager=new $W(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this._wt.draw(!e),DY(BY,this,VY).call(this),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this._wt.wtOverlays.adjustElementsSize():this.postponedAdjustElementsSize=!0}getCellAtCoords(e,t){const n=this._wt.getCell(e,t);return n<0?null:n}scrollViewport(e,t,n){return this._wt.scrollViewport(e,t,n)}scrollViewportHorizontally(e,t){return this._wt.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this._wt.scrollViewportVertically(e,t)}createElements(){const{rootElement:e,rootDocument:t}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),KB(e,"handsontable"),MY(jY,this,t.createElement("TABLE")),KB(kY(jY,this),"htCore"),this.hot.getSettings().tableClassName&&KB(kY(jY,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(XB(kY(jY,this),[["role","presentation"]]),XB(e,[["role","treegrid"],LL(-1),BL(this.hot.countCols()),["aria-multiselectable","true"]])),this.THEAD=t.createElement("THEAD"),kY(jY,this).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),kY(jY,this).appendChild(this.TBODY),this.hot.table=kY(jY,this),this.hot.container.insertBefore(kY(jY,this),this.hot.container.firstChild)}registerEvents(){const{rootWrapperElement:e,rootElement:t,rootDocument:n,selection:r,rootWindow:i}=this.hot,o=n.documentElement;this.eventManager.addEventListener(t,"mousedown",e=>{MY(IY,this,!0),this.isTextSelectionAllowed(e.target)||(Nz(i),e.preventDefault(),i.focus())}),this.eventManager.addEventListener(t,"mouseup",()=>{MY(IY,this,!1)}),this.eventManager.addEventListener(t,"mousemove",e=>{kY(IY,this)&&!this.isTextSelectionAllowed(e.target)&&(this.settings.fragmentSelection&&Nz(i),e.preventDefault())}),this.eventManager.addEventListener(o,"keyup",e=>{r.isInProgress()&&!e.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",i=>{r.isInProgress()&&cW(i)&&r.finish(),MY(PY,this,!1);const o=jz(n.activeElement);Pz(n.activeElement)&&!o||!o&&(r.isSelected()||r.isSelectedByAnyHeader()||(null!==e&&void 0!==e?e:t).contains(i.target)||lW(i))||this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",e=>{r.isInProgress()&&lW(e)&&(r.finish(),MY(PY,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),MY(PY,this,!1)}),this.eventManager.addEventListener(o,"mousedown",e=>{const r=e.target,i=e.x||e.clientX,a=e.y||e.clientY;let s=e.target;if(kY(PY,this)||!t||!this.hot.view)return;const{holder:l}=this._wt.wtTable;if(s===l){const e=kz(n);if(n.elementFromPoint(i+e,a)!==l||n.elementFromPoint(i,a+e)!==l)return}else for(;s!==o;){if(null===s){if(e.isTargetWebComponent)break;return}if(s===t)return;s=s.parentNode}("function"===typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(r):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=FB(i);for(;null!==a;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=FB(a);this.eventManager.addEventListener(kY(jY,this),"selectstart",e=>{this.settings.fragmentSelection||Pz(e.target)||e.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,n))}translateFromRenderableToVisualIndex(e,t){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===n&&(n=e),null===r&&(r=t),[n,r]}countRenderableIndexes(e,t){const n=Math.min(e.getNotTrimmedIndexesLength(),t),r=e.getNearestNotHiddenIndex(n-1,-1);return null===r?0:e.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,n,r){if(isNaN(e)||e<0)return 0;const i=n.getNearestNotHiddenIndex(e,t),o=n.getRenderableFromVisualIndex(i);if(!Number.isInteger(o))return 0;let a=0;return t<0?a=o+1:t>0&&(a=r-o),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let n=0;for(let r=e;r<=t;r++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)&&(n+=1);return n}countRenderableRowsInRange(e,t){let n=0;for(let r=e;r<=t;r++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)&&(n+=1);return n}addClassNameToLicenseElement(e){var t;const n=null===(t=this.hot.rootElement.parentNode)||void 0===t?void 0:t.querySelector(".hot-display-license-info");n&&KB(n,e)}removeClassNameFromLicenseElement(e){var t;const n=null===(t=this.hot.rootElement.parentNode)||void 0===t?void 0:t.querySelector(".hot-display-license-info");n&&$B(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:kY(jY,this),isDataViewInstance:()=>NY(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(e,t)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(e,t)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const e=[];return this.hot.hasRowHeaders()&&e.push((e,t)=>{const n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e;this.appendRowHeader(n,t)}),this.hot.runHooks("afterGetRowHeaderRenderers",e),MY(OY,this,e.length),this.hot.getSettings().ariaTags&&DY(BY,this,zY).call(this)===this.hot.countCols()&&DY(BY,this,WY).call(this,kY(OY,this)),e},columnHeaders:()=>{const e=[];return this.hot.hasColHeaders()&&e.push((e,t)=>{const n=e>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(e):e;this.appendColHeader(n,t)}),this.hot.runHooks("afterGetColumnHeaderRenderers",e),MY(_Y,this,e.length),e},columnWidth:e=>{const t=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e);return this.hot.getColWidth(null===t?e:t)},rowHeight:e=>{const t=this.hot.rowIndexMapper.getVisualFromRenderableIndex(e);return this.hot.getRowHeight(null===t?e:t)},rowHeightByOverlayName:(e,t)=>{const n=this.hot.rowIndexMapper.getVisualFromRenderableIndex(e),r=null===n?e:n;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(r),r,t)},cellRenderer:(e,t,n)=>{const[r,i]=this.translateFromRenderableToVisualIndex(e,t),o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let a=r,s=i;Array.isArray(o)&&([a,s]=o);const l=this.hot.getCellMeta(a,s),c=this.hot.colToProp(s);let u=this.hot.getDataAtRowProp(a,c);this.hot.hasHook("beforeValueRender")&&(u=this.hot.runHooks("beforeValueRender",u,l)),this.hot.runHooks("beforeRenderer",n,r,i,c,u,l),this.hot.getCellRenderer(l)(this.hot,n,r,i,c,u,l),this.hot.runHooks("afterRenderer",n,r,i,c,u,l)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&rz(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(e,t,n,r)=>{const i=this.translateFromRenderableToVisualCoords(t),o={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=r,MY(PY,this,!0),MY(LY,this,{x:e.clientX,y:e.clientY}),this.hot.runHooks("beforeOnCellMouseDown",e,i,n,o),sW(e)||(xY(e,{coords:i,selection:this.hot.selection,controller:o,cellCoordsFactory:(e,t)=>this.hot._createCellCoords(e,t)}),this.hot.runHooks("afterOnCellMouseDown",e,i,n),this.activeWt=this._wt)},onCellContextMenu:(e,t,n,r)=>{const i=this.translateFromRenderableToVisualCoords(t);this.activeWt=r,MY(PY,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",e,i,n),sW(e)||(this.hot.runHooks("afterOnCellContextMenu",e,i,n),this.activeWt=this._wt)},onCellMouseOut:(e,t,n,r)=>{const i=this.translateFromRenderableToVisualCoords(t);this.activeWt=r,this.hot.runHooks("beforeOnCellMouseOut",e,i,n),sW(e)||(this.hot.runHooks("afterOnCellMouseOut",e,i,n),this.activeWt=this._wt)},onCellMouseOver:(e,t,n,r)=>{const i=this.translateFromRenderableToVisualCoords(t),o={row:!1,column:!1,cell:!1};this.activeWt=r,this.hot.runHooks("beforeOnCellMouseOver",e,i,n,o),sW(e)||(!kY(PY,this)||kY(LY,this)&&kY(LY,this).x===e.clientX&&kY(LY,this).y===e.clientY||xY(e,{coords:i,selection:this.hot.selection,controller:o,cellCoordsFactory:(e,t)=>this.hot._createCellCoords(e,t)}),this.hot.runHooks("afterOnCellMouseOver",e,i,n),this.activeWt=this._wt,MY(LY,this,null))},onCellMouseUp:(e,t,n,r)=>{const i=this.translateFromRenderableToVisualCoords(t);this.activeWt=r,this.hot.runHooks("beforeOnCellMouseUp",e,i,n),sW(e)||this.hot.isDestroyed||(xY(e,{coords:i,selection:this.hot.selection,cellRangeMapper:jW(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",e,i,n),this.activeWt=this._wt)},onCellCornerMouseDown:e=>{e.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",e)},onCellCornerDblClick:e=>{e.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",e)},beforeDraw:(e,t)=>this.beforeRender(e,t),onDraw:e=>this.afterRender(e),onBeforeViewportScrollVertically:(e,t)=>{const n=this.hot.rowIndexMapper,r=e<0;let i=e;return r||(i=n.getVisualFromRenderableIndex(e),null!==i)?(i=this.hot.runHooks("beforeViewportScrollVertically",i,t),this.hot.runHooks("beforeViewportScroll"),r?i:n.getRenderableFromVisualIndex(i)):e},onBeforeViewportScrollHorizontally:(e,t)=>{const n=this.hot.columnIndexMapper,r=e<0;let i=e;return r||(i=n.getVisualFromRenderableIndex(e),null!==i)?(i=this.hot.runHooks("beforeViewportScrollHorizontally",i,t),this.hot.runHooks("beforeViewportScroll"),r?i:n.getRenderableFromVisualIndex(i)):e},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(e,t,n)=>{const r=this.hot.rowIndexMapper,i=e<0;let o=e;i||(o=r.getVisualFromRenderableIndex(e));const a=this.hot.runHooks("beforeHighlightingRowHeader",o,t,n);return i?a:r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,1))},onBeforeHighlightingColumnHeader:(e,t,n)=>{const r=this.hot.columnIndexMapper,i=e<0;let o=e;i||(o=r.getVisualFromRenderableIndex(e));const a=this.hot.runHooks("beforeHighlightingColumnHeader",o,t,n);return i?a:r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,1))},onAfterDrawSelection:(e,t,n)=>{let r;const[i,o]=this.translateFromRenderableToVisualIndex(e,t),a=this.hot.selection.getSelectedRange();if(a.size()>0){const e=a.peekByIndex(null!==n&&void 0!==n?n:0);r=[e.from.row,e.from.col,e.to.row,e.to.col]}return this.hot.runHooks("afterDrawSelection",i,o,r,n)},onBeforeDrawBorders:(e,t)=>{const[n,r,i,o]=e,a=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(n),this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)];return this.hot.runHooks("beforeDrawBorders",a,t)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:e=>this.hot.runHooks("modifyRowHeaderWidth",e),onModifyGetCellCoords:(e,t,n,r)=>{const i=this.hot.rowIndexMapper,o=this.hot.columnIndexMapper,a=t>=0?o.getVisualFromRenderableIndex(t):t,s=e>=0?i.getVisualFromRenderableIndex(e):e,l=this.hot.runHooks("modifyGetCellCoords",s,a,n,r);if(Array.isArray(l)){const[e,t,n,r]=l;return[e>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(e,1)):e,t>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(t,1)):t,n>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(n,-1)):n,r>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(r,-1)):r]}},onModifyGetCoordsElement:(e,t)=>{const n=this.hot.rowIndexMapper,r=this.hot.columnIndexMapper,i=t>=0?r.getVisualFromRenderableIndex(t):t,o=e>=0?n.getVisualFromRenderableIndex(e):e,a=this.hot.runHooks("modifyGetCoordsElement",o,i);if(Array.isArray(a)){const[e,t]=a;return[e>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(e,1)):e,t>=0?r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(t,1)):t]}},viewportRowCalculatorOverride:e=>{let t=this.settings.viewportRowRenderingOffset;if("auto"===t&&this.settings.fixedRowsTop&&(t=10),t>0||"auto"===t){const n=this.countRenderableRows(),r=e.startRow,i=e.endRow;if("number"===typeof t)e.startRow=Math.max(r-t,0),e.endRow=Math.min(i+t,n-1);else if("auto"===t){const t=Math.max(1,Math.ceil(i/n*12));e.startRow=Math.max(r-t,0),e.endRow=Math.min(i+t,n-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:e=>{let t=this.settings.viewportColumnRenderingOffset;if("auto"===t&&this.settings.fixedColumnsStart&&(t=10),t>0||"auto"===t){const n=this.countRenderableColumns(),r=e.startColumn,i=e.endColumn;if("number"===typeof t&&(e.startColumn=Math.max(r-t,0),e.endColumn=Math.min(i+t,n-1)),"auto"===t){const t=Math.max(1,Math.ceil(i/n*6));e.startColumn=Math.max(r-t,0),e.endColumn=Math.min(i+t,n-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",e)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const e=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||e},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new vY(e),this.activeWt=this._wt;const t=this._wt.wtTable.spreader,{width:n,height:r}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,r),this.eventManager.addEventListener(t,"mousedown",e=>{e.target===t&&3===e.which&&e.stopPropagation()}),this.eventManager.addEventListener(t,"contextmenu",e=>{e.target===t&&3===e.which&&e.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){var t,n;if(Pz(e))return!0;const r=WB(e,this._wt.wtTable.spreader);if(!0===this.settings.fragmentSelection&&r)return!0;const i=null!==(t=null===(n=this.hot.getSelectedRangeActive())||void 0===n?void 0:n.isSingleCell())&&void 0!==t&&t;return!("cell"!==this.settings.fragmentSelection||!i||!r)||!(this.settings.fragmentSelection||!this.isCellEdited()||!i)}isMouseDown(){return kY(PY,this)}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const n=t.firstChild;if(!YB(n,"relative"))return ZB(t),void this.appendRowHeader(e,t);this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:r}=this.hot,i=n.createElement("div"),o=n.createElement("span");i.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,r),i.appendChild(o),t.appendChild(i)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const i=()=>{const t=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return t?t.split(" "):[]};if(t.firstChild){const o=t.firstChild;YB(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,n,r),o.className="",KB(o,["relative",...i()])):(ZB(t),this.appendColHeader(e,t,n,r))}else{const{rootDocument:o}=this.hot,a=o.createElement("div"),s=o.createElement("span"),l=i();a.classList.add("relative",...l),s.className="colHeader",this.settings.ariaTags&&(XB(a,"role","presentation"),XB(s,"role","presentation")),this.updateCellHeader(s,e,n,r),a.appendChild(s),t.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,t,r)}updateCellHeader(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(YB(e,"colHeader")?i=o.wtTable.columnFilter.sourceToRendered(t):YB(e,"rowHeader")&&(i=o.wtTable.rowFilter.sourceToRendered(t))),i>-1?tz(e,n(t,r)):(nz(e,String.fromCharCode(160)),KB(e,"cornerHeader"))}maximumVisibleElementWidth(e){const t=this._wt.wtViewport.getWorkspaceWidth()-e;return t>0?t:0}maximumVisibleElementHeight(e){const t=this._wt.wtViewport.getWorkspaceHeight()-e;return t>0?t:0}setLastSize(e,t){MY(FY,this,e),MY(HY,this,t)}getLastSize(){return{width:kY(FY,this),height:kY(HY,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(null!==t&&void 0!==t?t:0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(null!==t&&void 0!==t?t:this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(null!==t&&void 0!==t?t:0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(null!==t&&void 0!==t?t:this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return kY(_Y,this)}getRowHeadersCount(){return kY(OY,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var t;return(null!==(t=this._wt.wtOverlays.getParentOverlay(e))&&void 0!==t?t:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTotalTableWidth(){return this._wt.wtTable.getTotalWidth()}getTotalTableHeight(){return this._wt.wtTable.getTotalHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getTableScrollPosition(){return{left:this._wt.wtTable.holder.scrollLeft,top:this._wt.wtTable.holder.scrollTop}}setTableScrollPosition(e){this._wt.wtTable.holder.scrollLeft=e.left,this._wt.wtTable.holder.scrollTop=e.top}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}},qY="ABCDEFGHIJKLMNOPQRSTUVWXYZ",GY=qY.length;function YY(e){let t,n=e+1,r="";for(;n>0;)t=(n-1)%GY,r=String.fromCharCode(65+t)+r,n=parseInt((n-t)/GY,10);return r}function KY(e){let t=0;if(e)for(let n=0,r=e.length-1;n<e.length;n+=1,r-=1)t+=GY**r*(qY.indexOf(e[n])+1);return t-=1,t}function $Y(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const n=[];let r,i;for(r=0;r<e;r++){const e=[];for(i=0;i<t;i++)e.push(YY(i)+(r+1));n.push(e)}return n}function XY(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const n=[];let r,i;for(r=0;r<e;r++){const e={};for(i=0;i<t;i++)e["prop".concat(i)]=YY(i)+(r+1);n.push(e)}return n}function QY(e,t){const n=[];let r;for(let i=0;i<e;i++){r=[];for(let e=0;e<t;e++)r.push("");n.push(r)}return n}function JY(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e;const r=[];return Array.isArray(e)&&Array.isArray(e[0])||(n=[e]),n.forEach((e,n)=>{Array.isArray(e)?e.forEach((e,i)=>{r.push([n+t,i,e])}):Object.keys(e).forEach(i=>{r.push([n+t,i,e[i]])})}),r}function ZY(e){let t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&tB(e[0])&&(t=aB(e[0]))),t}function eK(e){return!!(Array.isArray(e)&&e.length&&e.every(e=>Array.isArray(e)))}function tK(e){return!!(Array.isArray(e)&&e.length&&e.every(e=>"object"===typeof e&&!Array.isArray(e)&&null!==e))}function nK(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const rK=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];nK(this,"hot",void 0),nK(this,"data",void 0),nK(this,"dataType","array"),nK(this,"colToProp",()=>{}),nK(this,"propToCol",()=>{}),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),void 0===t||Number.isInteger(t)?this.data[e]:t}getData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,e):this.data}setData(e){this.data=e}getAtColumn(e){const t=[];return WH(this.data,(n,r)=>{const i=this.getAtCell(r,e);t.push(i)}),t}getAtRow(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=void 0===t&&void 0===n,{dataDotNotation:o}=this.hot.getSettings();let a=null,s=null;if(a=this.modifyRowData(e),Array.isArray(a))s=[],i?a.forEach((t,n)=>{s[n]=this.getAtPhysicalCell(e,n,a)}):hV(t,n,n=>{s[n-t]=this.getAtPhysicalCell(e,n,a)});else if(tB(a)||Uz(a))if(s=r?[]:{},!i||r){const i=0,l=this.countFirstRowKeys()-1;hV(i,l,c=>{const u=this.colToProp(c);if(c>=(t||i)&&c<=(n||l)&&!Number.isInteger(u)){const t=this.getAtPhysicalCell(e,u,a);r?s.push(t):o?oB(s,u,t):s[u]=t}})}else rB(a,(t,n)=>{const r=this.getAtPhysicalCell(e,n,a);o?oB(s,n,r):s[n]=r});return s}setAtCell(e,t,n){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const r=sB(n);this.hot.runHooks("modifySourceData",e,t,r,"set"),r.isTouched()&&(n=r.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(t)?this.data[e][t]=n:oB(this.data[e],t,n))}}getAtPhysicalCell(e,t,n){let r=null;if(n)if("string"===typeof t){const{dataDotNotation:e}=this.hot.getSettings();r=e?iB(n,t):n[t]}else r="function"===typeof t?t(n):n[t];if(this.hot.hasHook("modifySourceData")){const n=sB(r);this.hot.runHooks("modifySourceData",e,t,n,"get"),n.isTouched()&&(r=n.value)}return r}getAtCell(e,t){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),n)}getByRange(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!1,i=null,o=null,a=null,s=null;null===e||null===t?(r=!0,i=0,a=this.countRows()-1):(i=Math.min(e.row,t.row),o=Math.min(e.col,t.col),a=Math.max(e.row,t.row),s=Math.max(e.col,t.col));const l=[];return hV(i,a,e=>{l.push(r?this.getAtRow(e,void 0,void 0,n):this.getAtRow(e,o,s,n))}),l}getCopyable(e,t){const n=this.propToCol(t);return this.hot.getCellMeta(e,n).copyable?this.getAtCell(this.hot.toPhysicalRow(e),n):""}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return ZY(this.data)}destroy(){this.data=null,this.hot=null}},iK={_localHooks:Object.create(null),addLocalHook(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},removeLocalHook(e,t){if(this._localHooks[e]){const n=this._localHooks[e].indexOf(t);n>-1&&this._localHooks[e].splice(n,1)}return this},runLocalHooks(e,t,n,r,i,o,a){if(this._localHooks[e]){const s=this._localHooks[e].length;for(let l=0;l<s;l++)Jz(this._localHooks[e][l],this,t,n,r,i,o,a)}},clearLocalHooks(){return this._localHooks={},this}};nB(iK,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});const oK=iK;function aK(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class sK{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;aK(this,"indexedValues",[]),aK(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Uz(this.initValueOrFn)?hV(e-1,e=>this.indexedValues.push(this.initValueOrFn(e))):hV(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}function lK(e,t,n){return[...e.slice(0,t),...n,...e.slice(t)]}function cK(e,t){return BH(e,e=>!1===t.includes(e))}function uK(e,t){return zH(e,e=>e-t.filter(t=>t<e).length)}function dK(e,t){const n=t[0],r=t.length;return zH(e,e=>e>=n?e+r:e)}ZL(sK,oK);class hK extends sK{constructor(){super(e=>e)}insert(e,t){const n=dK(this.indexedValues,t);this.indexedValues=lK(n,e,t),super.insert(e,t)}remove(e){const t=cK(this.indexedValues,e);this.indexedValues=uK(t,e),super.remove(e)}}function fK(e,t,n,r){const i=n.length?n[0]:void 0;return[...e.slice(0,i),...n.map((e,t)=>Uz(r)?r(e,t):r),...void 0===i?[]:e.slice(i)]}function mK(e,t){return BH(e,(e,n)=>!1===t.includes(n))}class pK extends sK{insert(e,t){this.indexedValues=fK(this.indexedValues,0,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=mK(this.indexedValues,e),super.remove(e)}}class gK extends pK{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getHiddenIndexes(){return LH(this.getValues(),(e,t,n)=>(t&&e.push(n),e),[])}}function vK(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class yK extends sK{constructor(){super(...arguments),vK(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length&&(this.indexedValues[e]=t,!1===this.orderOfIndexes.includes(e)&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0)}clearValue(e){this.orderOfIndexes=cK(this.orderOfIndexes,[e]),Uz(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=fK(this.indexedValues,0,t,this.initValueOrFn),this.orderOfIndexes=dK(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=mK(this.indexedValues,e),this.orderOfIndexes=cK(this.orderOfIndexes,e),this.orderOfIndexes=uK(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class bK extends pK{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getTrimmedIndexes(){return LH(this.getValues(),(e,t,n)=>(t&&e.push(n),e),[])}}const wK=new Map([["hiding",gK],["index",sK],["linkedPhysicalIndexToValue",yK],["physicalIndexToValue",pK],["trimming",bK]]);function xK(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let SK=0;class CK{constructor(){xK(this,"collection",new Map)}register(e,t){!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)),SK+=1)}unregister(e){const t=this.collection.get(e);nL(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),SK-=1)}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return rL(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(n=>{n.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}}function EK(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}ZL(CK,oK);class NK extends CK{constructor(e,t){super(),EK(this,"mergedValuesCache",[]),EK(this,"aggregationFunction",void 0),EK(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.mergedValuesCache;if(0===this.getLength())return[];const e=zH(this.get(),e=>e.getValues()),t=[],n=nL(e[0])&&e[0].length||0;for(let r=0;r<n;r+=1){const n=[];for(let t=0;t<this.getLength();t+=1)n.push(e[t][r]);t.push(n)}return zH(t,this.aggregationFunction)}getMergedValueAtIndex(e,t){const n=this.getMergedValues(t)[e];return nL(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function TK(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function AK(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var RK=new WeakMap;class kK{constructor(){TK(this,RK,[])}subscribe(e){var t,n;return this.addLocalHook("change",e),this._write((n=this,(t=RK).get(AK(t,n)))),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){!function(e,t,n){e.set(AK(e,t),n)}(RK,this,e)}}function MK(e,t){const n=[];let r=0,i=0;for(;r<e.length&&i<t.length;r++,i++)e[r]!==t[i]&&n.push({op:"replace",index:i,oldValue:e[r],newValue:t[i]});for(;r<t.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:t[r]});for(;i<e.length;i++)n.push({op:"remove",index:i,oldValue:e[i],newValue:void 0});return n}function DK(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function _K(e,t){return e.get(IK(e,t))}function OK(e,t,n){return e.set(IK(e,t),n),n}function IK(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ZL(kK,oK);var PK=new WeakMap,jK=new WeakMap,FK=new WeakMap,HK=new WeakMap,LK=new WeakMap;class BK{constructor(){let{initialIndexValue:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};DK(this,PK,new Set),DK(this,jK,[]),DK(this,FK,[]),DK(this,HK,!1),DK(this,LK,!1),OK(LK,this,null!==e&&void 0!==e&&e)}createObserver(){const e=new kK;return _K(PK,this).add(e),e.addLocalHook("unsubscribe",()=>{_K(PK,this).delete(e)}),e._writeInitialChanges(MK(_K(jK,this),_K(FK,this))),e}emit(e){let t=_K(FK,this);_K(HK,this)&&_K(jK,this).length===e.length||(0===e.length?e=new Array(t.length).fill(_K(LK,this)):OK(jK,this,new Array(e.length).fill(_K(LK,this))),_K(HK,this)||(OK(HK,this,!0),t=_K(jK,this)));const n=MK(t,e);_K(PK,this).forEach(e=>e._write(n)),OK(FK,this,e)}}function zK(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}new Set;class WK{constructor(){zK(this,"indexesSequence",new hK),zK(this,"trimmingMapsCollection",new NK(e=>e.some(e=>!0===e),!1)),zK(this,"hidingMapsCollection",new NK(e=>e.some(e=>!0===e),!1)),zK(this,"variousMapsCollection",new CK),zK(this,"hidingChangesObservable",new BK({initialIndexValue:!1})),zK(this,"notTrimmedIndexesCache",[]),zK(this,"notHiddenIndexesCache",[]),zK(this,"isBatched",!1),zK(this,"indexesSequenceChanged",!1),zK(this,"indexesChangeSource",void 0),zK(this,"trimmedIndexesChanged",!1),zK(this,"hiddenIndexesChanged",!1),zK(this,"renderablePhysicalIndexesCache",[]),zK(this,"fromPhysicalToVisualIndexesCache",new Map),zK(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if("hiding"!==e)throw new Error('Unsupported index map type "'.concat(e,'".'));return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,n){return this.registerMap(e,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!wK.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(wK.get(e))(t)}(t,n))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error('Map with name "'.concat(e,'" has been already registered.'));t instanceof bK?this.trimmingMapsCollection.register(e,t):t instanceof gK?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const n=this.getNumberOfIndexes();return n>0&&t.init(n),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return nL(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return nL(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return nL(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return nL(t)?t:null}getNearestNotHiddenIndex(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(e))return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const r=Array.from(this.fromVisualToRenderableIndexesCache.keys());let i=-1;return i=t>0?r.findIndex(t=>t>e):r.reverse().findIndex(t=>t<e),-1===i?n?this.getNearestNotHiddenIndex(e,-t,!1):null:r[i]}initToLength(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const t=[...Array(this.getNumberOfIndexes()-e).keys()].map(t=>t+e);this.removeIndexes(t)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notTrimmedIndexesCache;return this.getIndexesSequence().filter(e=>!1===this.isTrimmed(e))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notHiddenIndexesCache;return this.getIndexesSequence().filter(e=>!1===this.isHidden(e))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.renderablePhysicalIndexesCache;return this.getNotTrimmedIndexes().filter(e=>!1===this.isHidden(e))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){"number"===typeof e&&(e=[e]);const n=zH(e,e=>this.getPhysicalFromVisualIndex(e)),r=this.getNotTrimmedIndexesLength(),i=e.length,o=cK(this.getIndexesSequence(),n),a=o.filter(e=>!1===this.isTrimmed(e));let s=o.indexOf(a[a.length-1])+1;if(t+i<r){const e=a[t];s=o.indexOf(e)}this.indexesChangeSource="move",this.setIndexesSequence(lK(o,s,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"start";const r=this.getNotTrimmedIndexes()[e],i=nL(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),a=zH(new Array(t).fill(i),(e,t)=>e+t);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,a),this.indexesChangeSource=void 0;const s="end"===n?a.map(e=>e+1):a;this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===e||!1===this.isBatched&&!0===t)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const e=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(e,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const e=this.getPhysicalFromRenderableIndex(t),n=this.getVisualFromPhysicalIndex(e);this.fromVisualToRenderableIndexesCache.set(n,t)}}}var VK;function UK(e){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(e);return t?"".concat(t[1].toLowerCase(),"-").concat(t[2].toUpperCase()):e}function qK(e){nL(e)&&mW(ZH(VK||(VK=RH(['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'],['Language with code "','" was not found. You should register particular language\\x20\n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'])),e))}ZL(WK,oK);const{register:GK,getValues:YK}=PW("phraseFormatters");function KK(e,t){GK(e,t)}KK("pluralize",function(e,t){return Array.isArray(e)&&Number.isInteger(t)?e[t]:e}),KK("substitute",function e(t,n){return Array.isArray(t)?t.map(t=>e(t,n)):CL(t,n)});const $K="Common:",XK="".concat($K,"ok"),QK="".concat($K,"cancel"),JK="ContextMenu:items",ZK=JK,e$="".concat(ZK,".noItems"),t$="".concat(ZK,".insertRowAbove"),n$="".concat(ZK,".insertRowBelow"),r$="".concat(ZK,".insertColumnOnTheLeft"),i$="".concat(ZK,".insertColumnOnTheRight"),o$="".concat(ZK,".removeRow"),a$="".concat(ZK,".removeColumn"),s$="".concat(ZK,".undo"),l$="".concat(ZK,".redo"),c$="".concat(ZK,".readOnly"),u$="".concat(ZK,".clearColumn"),d$="".concat(ZK,".copy"),h$="".concat(ZK,".copyWithHeaders"),f$="".concat(ZK,".copyWithGroupHeaders"),m$="".concat(ZK,".copyHeadersOnly"),p$="".concat(ZK,".cut"),g$="".concat(ZK,".freezeColumn"),v$="".concat(ZK,".unfreezeColumn"),y$="".concat(ZK,".mergeCells"),b$="".concat(ZK,".unmergeCells"),w$="".concat(ZK,".addComment"),x$="".concat(ZK,".editComment"),S$="".concat(ZK,".removeComment"),C$="".concat(ZK,".readOnlyComment"),E$="".concat(ZK,".align"),N$="".concat(ZK,".align.left"),T$="".concat(ZK,".align.center"),A$="".concat(ZK,".align.right"),R$="".concat(ZK,".align.justify"),k$="".concat(ZK,".align.top"),M$="".concat(ZK,".align.middle"),D$="".concat(ZK,".align.bottom"),_$="".concat(ZK,".borders"),O$="".concat(ZK,".borders.top"),I$="".concat(ZK,".borders.right"),P$="".concat(ZK,".borders.bottom"),j$="".concat(ZK,".borders.left"),F$="".concat(ZK,".borders.remove"),H$="".concat(ZK,".nestedHeaders.insertChildRow"),L$="".concat(ZK,".nestedHeaders.detachFromParent"),B$="".concat(ZK,".hideColumn"),z$="".concat(ZK,".showColumn"),W$="".concat(ZK,".hideRow"),V$="".concat(ZK,".showRow"),U$="Filters:",q$="".concat(U$,"conditions"),G$="".concat(q$,".none"),Y$="".concat(q$,".isEmpty"),K$="".concat(q$,".isNotEmpty"),$$="".concat(q$,".isEqualTo"),X$="".concat(q$,".isNotEqualTo"),Q$="".concat(q$,".beginsWith"),J$="".concat(q$,".endsWith"),Z$="".concat(q$,".contains"),eX="".concat(q$,".doesNotContain"),tX="".concat(q$,".byValue"),nX="".concat(q$,".greaterThan"),rX="".concat(q$,".greaterThanOrEqualTo"),iX="".concat(q$,".lessThan"),oX="".concat(q$,".lessThanOrEqualTo"),aX="".concat(q$,".isBetween"),sX="".concat(q$,".isNotBetween"),lX="".concat(q$,".after"),cX="".concat(q$,".before"),uX="".concat(q$,".today"),dX="".concat(q$,".tomorrow"),hX="".concat(q$,".yesterday"),fX="".concat(U$,"labels.filterByCondition"),mX="".concat(U$,"labels.filterByValue"),pX="".concat(U$,"labels.conjunction"),gX="".concat(U$,"labels.disjunction"),vX="".concat(U$,"values.blankCells"),yX="".concat(U$,"buttons.selectAll"),bX="".concat(U$,"buttons.clear"),wX="".concat(U$,"buttons.ok"),xX="".concat(U$,"buttons.cancel"),SX="".concat(U$,"buttons.placeholder.search"),CX="".concat(U$,"buttons.placeholder.value"),EX="".concat(U$,"buttons.placeholder.secondValue"),NX="Pagination:",TX="".concat(NX,"section.pagination"),AX="".concat(NX,".pageSize.auto"),RX="".concat(NX,"section.pageSize"),kX="".concat(NX,"section.counter"),MX="".concat(NX,"section.navigation"),DX="".concat(NX,"firstPage"),_X="".concat(NX,"prevPage"),OX="".concat(NX,"nextPage"),IX="".concat(NX,"lastPage"),PX="CheckboxRenderer:",jX="".concat(PX,"checked"),FX="".concat(PX,"unchecked"),HX="Loading:",LX="".concat(HX,"title"),BX="EmptyDataState:",zX="".concat(BX,"title"),WX="".concat(BX,"description"),VX="".concat(BX,"title.filters"),UX="".concat(BX,"description.filters"),qX="".concat(BX,"buttons.filters.reset"),GX={languageCode:"en-US",[XK]:"OK",[QK]:"Cancel",[e$]:"No available options",[t$]:"Insert row above",[n$]:"Insert row below",[r$]:"Insert column left",[i$]:"Insert column right",[o$]:["Remove row","Remove rows"],[a$]:["Remove column","Remove columns"],[s$]:"Undo",[l$]:"Redo",[c$]:"Read only",[u$]:"Clear column",[E$]:"Alignment",[N$]:"Left",[T$]:"Center",[A$]:"Right",[R$]:"Justify",[k$]:"Top",[M$]:"Middle",[D$]:"Bottom",[g$]:"Freeze column",[v$]:"Unfreeze column",[_$]:"Borders",[O$]:"Top",[I$]:"Right",[P$]:"Bottom",[j$]:"Left",[F$]:"Remove border(s)",[w$]:"Add comment",[x$]:"Edit comment",[S$]:"Delete comment",[C$]:"Read-only comment",[y$]:"Merge cells",[b$]:"Unmerge cells",[d$]:"Copy",[h$]:["Copy with header","Copy with headers"],[f$]:["Copy with group header","Copy with group headers"],[m$]:["Copy header only","Copy headers only"],[p$]:"Cut",[H$]:"Insert child row",[L$]:"Detach from parent",[B$]:["Hide column","Hide columns"],[z$]:["Show column","Show columns"],[W$]:["Hide row","Hide rows"],[V$]:["Show row","Show rows"],[G$]:"None",[Y$]:"Is empty",[K$]:"Is not empty",[$$]:"Is equal to",[X$]:"Is not equal to",[Q$]:"Begins with",[J$]:"Ends with",[Z$]:"Contains",[eX]:"Does not contain",[nX]:"Greater than",[rX]:"Greater than or equal to",[iX]:"Less than",[oX]:"Less than or equal to",[aX]:"Is between",[sX]:"Is not between",[lX]:"After",[cX]:"Before",[uX]:"Today",[dX]:"Tomorrow",[hX]:"Yesterday",[vX]:"Blank cells",[fX]:"Filter by condition",[mX]:"Filter by value",[pX]:"And",[gX]:"Or",[yX]:"Select all",[bX]:"Clear",[wX]:"OK",[xX]:"Cancel",[SX]:"Search",[CX]:"Value",[EX]:"Second value",[TX]:"Pagination",[RX]:"Page size",[AX]:"Auto",[kX]:"[start] - [end] of [total]",[MX]:"Page [currentPage] of [totalPages]",[DX]:"Go to first page",[_X]:"Go to previous page",[OX]:"Go to next page",[IX]:"Go to last page",[jX]:"Checked",[FX]:"Unchecked",[LX]:"Loading...",[zX]:"No data available",[WX]:"There\u2019s nothing to display yet.",[VX]:"No results found",[UX]:"It looks like your current filters are hiding all results.",[qX]:"Reset filters"},YX=m,KX=GX.languageCode,{register:$X,getItem:XX,hasItem:QX,getValues:JX}=PW("languagesDictionaries");function ZX(e,t){let n=e,r=t;return tB(e)&&(r=e,n=r.languageCode),function(e,t){e!==KX&&(n=t,rB(XX(KX),(e,t)=>{rL(n[t])&&(n[t]=e)}));var n}(n,r),$X(n,QL(r)),QL(r)}function eQ(e){return tQ(e)?QL(XX(e)):null}function tQ(e){return QX(e)}function nQ(e,t,n){const r=eQ(e);if(null===r)return null;const i=r[t];if(rL(i))return null;const o=function(e,t){return YK().reduce((e,n)=>n(e,t),e)}(i,n);return Array.isArray(o)?o[0]:o}ZX(GX);const rQ="active-header",iQ="header",oQ="area",aQ="focus";class sQ{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return null===this.cellRange}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}}ZL(sQ,oK);const lQ=sQ;function cQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const uQ=class extends lQ{constructor(e,t){super(e,null),cQ(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:n}=e,r=this.getNearestNotHiddenCoords(t,1),i=this.getNearestNotHiddenCoords(n,-1);return null===r||null===i?null:((r.row>i.row||r.col>i.col)&&(r=t,i=n),this.settings.createCellRange(r,r,i))}getNearestNotHiddenCoords(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;const r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(null===r)return null;const i=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return null===i?null:this.settings.createCellCoords(r,i)}getNearestNotHiddenIndex(e,t,n){return t<0?t:e.getNearestNotHiddenIndex(t,n)}commit(){if(null===this.visualCellRange)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===e?null:this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.from.clone().normalize(),n="N-S"===e.getVerticalDirection()?1:-1,r="W-E"===e.getHorizontalDirection()?1:-1,i=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if(null!==i&&null!==i.col&&null!==i.row||(o=this.getNearestNotHiddenCoords(t,n,r)),null!==o&&e.overlaps(o)){const t=e.highlight.clone();if(t.row>=0&&(t.row=o.row),t.col>=0&&(t.col=o.col),null===this.cellRange){const e=this.settings.visualToRenderableCoords(t);this.cellRange=this.settings.createCellRange(e)}e.setHighlight(t)}return"focus"===this.settings.selectionType&&null!==i&&null===o&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const n=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(t);return null===n.row||null===n.col||null===r.row||null===r.col?null:this.settings.createCellRange(n,n,r)}},dQ=["activeHeaderClassName"];function hQ(e){let{activeHeaderClassName:t}=e,n=b(e,dQ);return new uQ(E(E({className:t},n),{},{selectionType:rQ}))}const fQ=["areaCornerVisible"];function mQ(e){let{areaCornerVisible:t}=e,n=b(e,fQ);return new uQ(E(E({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:t}},n),{},{selectionType:oQ}))}function pQ(e){if(null==e)throw new TypeError("Cannot destructure "+e)}function gQ(e){let t=Object.assign({},(pQ(e),e));return new uQ(E(E({className:"highlight"},t),{},{selectionType:oQ}))}const vQ=["columnClassName"];function yQ(e){let{columnClassName:t}=e,n=b(e,vQ);return new uQ(E(E({className:t},n),{},{selectionType:"column"}))}const bQ=["cellCornerVisible"];const wQ=["border","visualCellRange"];const xQ=["headerClassName"];function SQ(e){let{headerClassName:t}=e,n=b(e,xQ);return new uQ(E(E({className:t},n),{},{selectionType:iQ}))}const CQ=["rowClassName"];function EQ(e){let{rowClassName:t}=e,n=b(e,CQ);return new uQ(E(E({className:t},n),{},{selectionType:"row"}))}function NQ(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function TQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function AQ(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var RQ=new WeakSet;class kQ{constructor(e){NQ(this,RQ),TQ(this,"options",void 0),TQ(this,"layerLevel",0),TQ(this,"focus",void 0),TQ(this,"fill",void 0),TQ(this,"layeredAreas",new Map),TQ(this,"areas",new Map),TQ(this,"rowHeaders",new Map),TQ(this,"columnHeaders",new Map),TQ(this,"activeRowHeaders",new Map),TQ(this,"activeColumnHeaders",new Map),TQ(this,"activeCornerHeaders",new Map),TQ(this,"rowHighlights",new Map),TQ(this,"columnHighlights",new Map),TQ(this,"customSelections",[]),this.options=e,this.focus=function(e){let{cellCornerVisible:t}=e,n=b(e,bQ);return new uQ(E(E({className:"current",headerAttributes:[["aria-selected","true"]],border:{width:2,color:"#4b89ff",cornerVisible:t}},n),{},{selectionType:aQ}))}(e),this.fill=function(e){let t=Object.assign({},(pQ(e),e));return new uQ(E(E({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:"fill"}))}(e)}isEnabledFor(e,t){let n=e;e===aQ&&(n="current");let r=this.options.disabledCellSelection(t.row,t.col);return"string"===typeof r&&(r=[r]),!1===r||Array.isArray(r)&&!r.includes(n)}useLayerLevel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return AQ(RQ,this,MQ).call(this,this.layeredAreas,mQ)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return AQ(RQ,this,MQ).call(this,this.areas,gQ)}getAreas(){return[...this.areas.values()]}createRowHeader(){return AQ(RQ,this,MQ).call(this,this.rowHeaders,SQ)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return AQ(RQ,this,MQ).call(this,this.columnHeaders,SQ)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return AQ(RQ,this,MQ).call(this,this.activeRowHeaders,hQ)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return AQ(RQ,this,MQ).call(this,this.activeColumnHeaders,hQ)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return AQ(RQ,this,MQ).call(this,this.activeCornerHeaders,hQ)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return AQ(RQ,this,MQ).call(this,this.rowHighlights,EQ)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return AQ(RQ,this,MQ).call(this,this.columnHighlights,yQ)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(function(e){let{border:t,visualCellRange:n}=e,r=b(e,wQ);return new uQ(E(E(E({},t),r),{},{selectionType:"custom-selection"}),n)}(E(E({},this.options),e)))}clear(){this.focus.clear(),this.fill.clear(),WH(this.areas.values(),e=>{e.clear()}),WH(this.layeredAreas.values(),e=>{e.clear()}),WH(this.rowHeaders.values(),e=>{e.clear()}),WH(this.columnHeaders.values(),e=>{e.clear()}),WH(this.activeRowHeaders.values(),e=>{e.clear()}),WH(this.activeColumnHeaders.values(),e=>{e.clear()}),WH(this.activeCornerHeaders.values(),e=>{e.clear()}),WH(this.rowHighlights.values(),e=>{e.clear()}),WH(this.columnHighlights.values(),e=>{e.clear()})}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function MQ(e,t){const n=this.layerLevel;if(e.has(n))return e.get(n);const r=t(E({layerLevel:n},this.options));return e.set(n,r),r}const DQ=kQ;function _Q(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class OQ{constructor(e){_Q(this,"ranges",[]),_Q(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return 0===this.size()}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}push(e){return this.ranges.push(e),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>!0;return this.ranges.some((n,r)=>n.includes(e)&&t(n,r))}findAll(e){const t=[];return this.ranges.forEach((n,r)=>{n.isEqual(e)&&t.push({range:n,layer:r})}),t}remove(e){return this.ranges=this.ranges.filter(t=>!e.some(e=>e.isEqual(t))),this}removeLayers(e){return this.ranges=this.ranges.filter((t,n)=>!e.includes(n)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new OQ(this.createCellRange);return e.ranges=this.ranges.map(e=>e.clone()),e}map(e){return this.ranges=this.ranges.map((t,n)=>e(t,n)),this}peekByIndex(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t>=0&&t<this.size()&&(e=this.ranges[t]),e}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}const IQ=OQ;function PQ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jQ(e,t,n){FQ(e,t),t.set(e,n)}function FQ(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function HQ(e,t){return e.get(BQ(e,t))}function LQ(e,t,n){return e.set(BQ(e,t),n),n}function BQ(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var zQ=new WeakMap,WQ=new WeakMap,VQ=new WeakMap,UQ=new WeakSet;class qQ{constructor(e,t){!function(e,t){FQ(e,t),t.add(e)}(this,UQ),jQ(this,zQ,void 0),jQ(this,WQ,0),jQ(this,VQ,{x:0,y:0}),PQ(this,"tableApi",void 0),LQ(zQ,this,e),this.tableApi=t}setActiveLayerIndex(e){LQ(WQ,this,e)}getCurrentSelection(){return HQ(zQ,this).peekByIndex(HQ(WQ,this))}transformStart(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];LQ(VQ,this,this.calculateOffset());const r=this.tableApi.createCellCoords(e,t);let i=this.getCurrentSelection().highlight;const o=this.tableApi.visualToRenderableCoords(i);let a=0,s=0;if(this.runLocalHooks("beforeTransformStart",r),null!==o.row&&null!==o.col){let{width:e,height:t}=BQ(UQ,this,$Q).call(this);const{row:o,col:l}=BQ(UQ,this,ZQ).call(this,i),c=this.tableApi.fixedRowsBottom(),u=this.tableApi.minSpareRows(),d=this.tableApi.minSpareCols(),h=this.tableApi.autoWrapRow(),f=this.tableApi.autoWrapCol(),m=this.tableApi.createCellCoords(o+r.row,l+r.col);if(m.row>=t){const r=sB(n&&u>0&&0===c),i=m.col+1,o=i>=e,a=this.tableApi.createCellCoords(m.row-t,o?i-e:i);if(this.runLocalHooks("beforeColumnWrap",r,BQ(UQ,this,eJ).call(this,a),o),r.value)this.runLocalHooks("insertRowRequire",this.countRenderableRows());else if(f){if(this.shouldSwitchSelectionLayer()&&o&&HQ(zQ,this).size()>1){BQ(UQ,this,GQ).call(this);const e=BQ(UQ,this,XQ).call(this,"forward");null!==e&&a.assign(e)}m.assign(a)}}else if(m.row<0){const n=sB(f),r=m.col-1,i=r<0,o=this.tableApi.createCellCoords(t+m.row,i?e+r:r);if(this.runLocalHooks("beforeColumnWrap",n,BQ(UQ,this,eJ).call(this,o),i),f){if(this.shouldSwitchSelectionLayer()&&i&&HQ(zQ,this).size()>1){BQ(UQ,this,YQ).call(this);const e=BQ(UQ,this,XQ).call(this,"backward");null!==e&&o.assign(e)}m.assign(o)}}if(({width:e,height:t}=BQ(UQ,this,$Q).call(this)),m.col>=e){const r=sB(n&&d>0),i=m.row+1,o=i>=t,a=this.tableApi.createCellCoords(o?i-t:i,m.col-e);if(this.runLocalHooks("beforeRowWrap",r,BQ(UQ,this,eJ).call(this,a),o),r.value)this.runLocalHooks("insertColRequire",this.countRenderableColumns());else if(h){if(this.shouldSwitchSelectionLayer()&&o&&HQ(zQ,this).size()>1){BQ(UQ,this,GQ).call(this);const e=BQ(UQ,this,XQ).call(this,"forward");null!==e&&a.assign(e)}m.assign(a)}}else if(m.col<0){const n=sB(h),r=m.row-1,i=r<0,o=this.tableApi.createCellCoords(i?t+r:r,e+m.col);if(this.runLocalHooks("beforeRowWrap",n,BQ(UQ,this,eJ).call(this,o),i),h){if(this.shouldSwitchSelectionLayer()&&i&&HQ(zQ,this).size()>1){BQ(UQ,this,YQ).call(this);const e=BQ(UQ,this,XQ).call(this,"backward");null!==e&&o.assign(e)}m.assign(o)}}const{rowDir:p,colDir:g}=BQ(UQ,this,KQ).call(this,m);a=p,s=g,i=BQ(UQ,this,eJ).call(this,m)}return this.runLocalHooks("afterTransformStart",i,a,s),{selectionLayer:HQ(WQ,this),visualCoords:i}}transformEnd(e,t){LQ(VQ,this,this.calculateOffset());const n=this.tableApi.createCellCoords(e,t),r=this.getCurrentSelection(),i=this.tableApi.visualToRenderableCoords(r.highlight),o=BQ(UQ,this,QQ).call(this,r.to.row,r.from.row),a=BQ(UQ,this,JQ).call(this,r.to.col,r.from.col),s=r.to.clone();let l=0,c=0;if(this.runLocalHooks("beforeTransformEnd",n),null!==i.row&&null!==i.col&&null!==o&&null!==a){const{row:e,col:t}=BQ(UQ,this,ZQ).call(this,r.highlight),i=this.tableApi.createCellCoords(o+n.row,a+n.col),u=r.getTopStartCorner(),d=r.getTopEndCorner(),h=r.getBottomEndCorner();if(n.col<0&&a>=t&&i.col<t){const e=i.col-t;i.col=BQ(UQ,this,JQ).call(this,u.col,d.col)+e}else if(n.col>0&&a<=t&&i.col>t){const e=BQ(UQ,this,JQ).call(this,d.col,u.col),t=Math.max(i.col-e,1);i.col=e+t}if(n.row<0&&o>=e&&i.row<e){const t=i.row-e;i.row=BQ(UQ,this,QQ).call(this,u.row,h.row)+t}else if(n.row>0&&o<=e&&i.row>e){const e=BQ(UQ,this,QQ).call(this,h.row,u.row),t=Math.max(i.row-e,1);i.row=e+t}const{rowDir:f,colDir:m}=BQ(UQ,this,KQ).call(this,i);l=f,c=m;const p=BQ(UQ,this,eJ).call(this,i);0===n.row&&0!==n.col?s.col=p.col:0!==n.row&&0===n.col?s.row=p.row:(s.row=p.row,s.col=p.col)}return this.runLocalHooks("afterTransformEnd",s,l,c),{selectionLayer:HQ(WQ,this),visualCoords:s}}calculateOffset(){throw new Error("`calculateOffset` is not implemented")}countRenderableRows(){throw new Error("`countRenderableRows` is not implemented")}countRenderableColumns(){throw new Error("`countRenderableColumns` is not implemented")}shouldSwitchSelectionLayer(){throw new Error("`shouldSwitchSelectionLayer` is not implemented")}}function GQ(){const e=HQ(WQ,this)+1;this.setActiveLayerIndex(e>=HQ(zQ,this).size()?0:e),LQ(VQ,this,this.calculateOffset())}function YQ(){const e=HQ(WQ,this)-1;this.setActiveLayerIndex(e<0?HQ(zQ,this).size()-1:e),LQ(VQ,this,this.calculateOffset())}function KQ(e){const{width:t,height:n}=BQ(UQ,this,$Q).call(this);let r=0,i=0;return e.row<0?(r=-1,e.row=0):e.row>0&&e.row>=n&&(r=1,e.row=n-1),e.col<0?(i=-1,e.col=0):e.col>0&&e.col>=t&&(i=1,e.col=t-1),{rowDir:r,colDir:i}}function $Q(){return{width:HQ(VQ,this).x+this.countRenderableColumns(),height:HQ(VQ,this).y+this.countRenderableRows()}}function XQ(e){if(!["forward","backward"].includes(e))return null;const t=this.getCurrentSelection().getTopStartCorner(),n=this.getCurrentSelection().getBottomEndCorner(),[r,i,o,a]="forward"===e?[t.row,n.row,t.col,n.col]:[n.row,t.row,n.col,t.col],s=BQ(UQ,this,QQ).call(this,r,i),l=BQ(UQ,this,JQ).call(this,o,a);return null===s||null===l?null:this.tableApi.createCellCoords(s,l)}function QQ(e,t){const n=this.tableApi.findFirstNonHiddenRenderableRow(e,t);return null===n?null:HQ(VQ,this).y+n}function JQ(e,t){const n=this.tableApi.findFirstNonHiddenRenderableColumn(e,t);return null===n?null:HQ(VQ,this).x+n}function ZQ(e){const{row:t,col:n}=this.tableApi.visualToRenderableCoords(e);if(null===t||null===n)throw new Error("Renderable coords are not visible.");return this.tableApi.createCellCoords(HQ(VQ,this).y+t,HQ(VQ,this).x+n)}function eJ(e){const t=e.clone();return t.col=e.col-HQ(VQ,this).x,t.row=e.row-HQ(VQ,this).y,this.tableApi.renderableToVisualCoords(t)}ZL(qQ,oK);class tJ extends qQ{calculateOffset(){return{x:this.tableApi.navigableHeaders()?this.tableApi.countRowHeaders():0,y:this.tableApi.navigableHeaders()?this.tableApi.countColHeaders():0}}countRenderableRows(){return this.tableApi.countRenderableRows()}countRenderableColumns(){return this.tableApi.countRenderableColumns()}shouldSwitchSelectionLayer(){return!1}}class nJ extends qQ{calculateOffset(){const e=this.getCurrentSelection(),{row:t,col:n}=e.getOuterTopStartCorner(),r=this.tableApi.countRenderableColumnsInRange(0,n-1),i=this.tableApi.countRenderableRowsInRange(0,t-1),o=e.highlight.isHeader(),a=o?Math.abs(n):0,s=o?Math.abs(t):0;return{x:n<0?a:-r,y:t<0?s:-i}}countRenderableRows(){const e=this.getCurrentSelection();return this.tableApi.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)}countRenderableColumns(){const e=this.getCurrentSelection();return this.tableApi.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)}transformEnd(){throw new Error("`transformEnd` is not valid for focus selection use `transformStart` instead")}shouldSwitchSelectionLayer(){return!0}}const rJ=[3,2],iJ=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],oJ=Symbol("root"),aJ=Symbol("child");function sJ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oJ;if(t!==oJ&&t!==aJ)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(e),r=t===oJ;let i=0;if(n){const t=e[0];if(0===e.length)i=1;else if(r&&t instanceof kq)i=3;else if(r&&Array.isArray(t))i=sJ(t,aJ);else if(e.length>=2&&e.length<=4){const t=!e.some((e,t)=>!iJ[t].includes(typeof e));t&&(i=2)}}return i}function lJ(e){let{createCellCoords:t,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!rJ.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const a=3===e;let s=a?o.from.row:o[0],l=a?o.from.col:o[1],c=a?o.to.row:o[2],u=a?o.to.col:o[3];if("function"===typeof i&&("string"===typeof l&&(l=i(l)),"string"===typeof u&&(u=i(u))),rL(c)&&(c=s),rL(u)&&(u=l),!r){const e=s,t=l,n=c,r=u;s=Math.min(e,n),l=Math.min(t,r),c=Math.max(e,n),u=Math.max(t,r)}const d=a?o.highlight.clone():t(s,l),h=t(s,l),f=t(c,u);return n(d,h,f)}}var cJ;function uJ(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function dJ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hJ(e,t){return e.get(mJ(e,t))}function fJ(e,t,n){return e.set(mJ(e,t),n),n}function mJ(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var pJ=new WeakMap,gJ=new WeakMap,vJ=new WeakMap,yJ=new WeakMap,bJ=new WeakMap,wJ=new WeakMap,xJ=new WeakMap;class SJ{constructor(e,t){var n=this;dJ(this,"settings",void 0),dJ(this,"tableProps",void 0),dJ(this,"inProgress",!1),dJ(this,"selectedRange",new IQ((e,t,n)=>this.tableProps.createCellRange(e,t,n))),dJ(this,"highlight",void 0),uJ(this,pJ,void 0),uJ(this,gJ,void 0),dJ(this,"selectedByRowHeader",new Set),dJ(this,"selectedByColumnHeader",new Set),uJ(this,vJ,!1),uJ(this,yJ,!1),uJ(this,bJ,"unknown"),uJ(this,wJ,-1),uJ(this,xJ,0),this.settings=e,this.tableProps=t,this.highlight=new DQ({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[["aria-selected","true"]],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(e,t)=>this.tableProps.isDisabledCellSelection(e,t),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),createCellRange:(e,t,n)=>this.tableProps.createCellRange(e,t,n)}),fJ(pJ,this,new tJ(this.selectedRange,E(E({},this.tableProps),{},{navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}))),fJ(gJ,this,new nJ(this.selectedRange,E(E({},this.tableProps),{},{navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0}))),hJ(pJ,this).addLocalHook("beforeTransformStart",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeModifyTransformStart",...t)}),hJ(pJ,this).addLocalHook("afterTransformStart",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("afterModifyTransformStart",...t)}),hJ(pJ,this).addLocalHook("beforeTransformEnd",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeModifyTransformEnd",...t)}),hJ(pJ,this).addLocalHook("afterTransformEnd",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("afterModifyTransformEnd",...t)}),hJ(pJ,this).addLocalHook("insertRowRequire",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("insertRowRequire",...t)}),hJ(pJ,this).addLocalHook("insertColRequire",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("insertColRequire",...t)}),hJ(pJ,this).addLocalHook("beforeRowWrap",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeRowWrap",...t)}),hJ(pJ,this).addLocalHook("beforeColumnWrap",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeColumnWrap",...t)}),hJ(gJ,this).addLocalHook("beforeTransformStart",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeModifyTransformFocus",...t)}),hJ(gJ,this).addLocalHook("afterTransformStart",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("afterModifyTransformFocus",...t)})}getSelectedRange(){return this.selectedRange}getActiveSelectedRange(){return this.selectedRange.peekByIndex(hJ(xJ,this))}getActiveSelectionLayerIndex(){return hJ(xJ,this)}setActiveSelectionLayerIndex(e){fJ(xJ,this,e)}markSource(e){fJ(bJ,this,e)}markEndSource(){fJ(bJ,this,"unknown")}getSelectionSource(){return hJ(bJ,this)}setExpectedLayers(e){fJ(wJ,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,fJ(wJ,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e;const i="multiple"===this.settings.selectionMode,o=rL(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,a=e.clone();fJ(yJ,this,!1),fJ(vJ,this,!1),this.runLocalHooks("beforeSetRangeStart".concat(n?"Only":""),a),(!i||i&&!o&&rL(t))&&(this.selectedRange.clear(),WH(this.highlight.getAreas(),e=>{e.clear()}),WH(this.highlight.getLayeredAreas(),e=>{e.clear()}),WH(this.highlight.getRowHeaders(),e=>{e.clear()}),WH(this.highlight.getColumnHeaders(),e=>{e.clear()}),WH(this.highlight.getActiveRowHeaders(),e=>{e.clear()}),WH(this.highlight.getActiveColumnHeaders(),e=>{e.clear()}),WH(this.highlight.getActiveCornerHeaders(),e=>{e.clear()}),WH(this.highlight.getRowHighlights(),e=>{e.clear()}),WH(this.highlight.getColumnHighlights(),e=>{e.clear()})),this.selectedRange.add(a).current().setHighlight(r.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;this.setRangeStart(e,t,!0,n)}setRangeEnd(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(t);const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.getActiveSelectedRange().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(0===r&&n.col<0&&!o||0===i&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const a=this.getActiveSelectedRange();if(this.settings.navigableHeaders||a.highlight.normalize(),"single"===this.settings.selectionMode)a.setFrom(a.highlight),a.setTo(a.highlight);else{const e=a.getHorizontalDirection(),t=a.getVerticalDirection(),r=this.isMultiple();a.setTo(n),r&&(e!==a.getHorizontalDirection()||1===a.getWidth()&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),r&&(t!==a.getVerticalDirection()||1===a.getHeight()&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.getActiveSelectedRange().highlight,t),this.applyAndCommit(this.getActiveSelectedRange(),t);const s=-1===hJ(wJ,this)||this.selectedRange.size()===hJ(wJ,this);this.runLocalHooks("afterSetRangeEnd",e,s)}applyAndCommit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getActiveSelectedRange(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),r=this.tableProps.countCols();this.highlight.useLayerLevel(t);const i=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),s=this.highlight.createColumnHeader(),l=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),u=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),h=this.highlight.createColumnHighlight();if(i.clear(),o.clear(),a.clear(),s.clear(),l.clear(),c.clear(),u.clear(),d.clear(),h.clear(),this.highlight.isEnabledFor(oQ,e.highlight)&&(this.isMultiple()||t>=1)&&(i.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),1===t)){const e=this.selectedRange.peekByIndex(t-1);this.highlight.useLayerLevel(t-1),this.highlight.createArea().add(e.from).commit().syncWith(e),this.highlight.createLayeredArea().add(e.from).commit().syncWith(e),this.highlight.useLayerLevel(t)}if(this.highlight.isEnabledFor(iQ,e.highlight)){if(!e.isSingleHeader()){const t=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),n=this.tableProps.createCellCoords(e.to.row,-1),r=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),i=this.tableProps.createCellCoords(-1,e.to.col);"single"===this.settings.selectionMode?(a.add(t).commit(),s.add(r).commit(),d.add(t).commit(),h.add(r).commit()):(a.add(t).add(n).commit(),s.add(r).add(i).commit(),d.add(t).add(n).commit(),h.add(r).add(i).commit())}const t=!hJ(yJ,this)&&this.isEntireRowSelected()&&(r>0&&r===e.getWidth()||0===r&&this.isSelectedByRowHeader()),i=!hJ(yJ,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||0===n&&this.isSelectedByColumnHeader());t&&l.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),i&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),t&&i&&u.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(t),hJ(pJ,this).setActiveLayerIndex(t),hJ(gJ,this).setActiveLayerIndex(t);const n=this.getActiveSelectedRange();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(aQ,n.highlight)&&r.add(n.highlight).commit().syncWith(n),this.inProgress||(fJ(vJ,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{visualCoords:r}=hJ(pJ,this).transformStart(e,t,n);this.setRangeStart(r)}transformEnd(e,t){const{visualCoords:n,selectionLayer:r}=hJ(pJ,this).transformEnd(e,t);this.setRangeEnd(n,r)}transformFocus(e,t){const{selectionLayer:n,visualCoords:r}=hJ(gJ,this).transformStart(e,t);this.setRangeFocus(r.normalize(),n)}shiftRows(e,t){if(!this.isSelected())return;const n=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:r,to:i,highlight:o}=n,a=this.tableProps.countRows(),s=this.isSelectedByRowHeader(),l=this.isSelectedByColumnHeader(),c=l?-1:0,u=l?0:t;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(pV(r.row+u,c,a-1),r.col),h=this.tableProps.createCellCoords(pV(i.row+t,c,a-1),i.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(pV(o.row+t,0,a-1),o.col)):this.setRangeStartOnly(d,!0),s&&this.selectedByRowHeader.add(this.getLayerLevel()),l&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(h),this.markEndSource()}}shiftColumns(e,t){if(!this.isSelected())return;const n=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:r,to:i,highlight:o}=n,a=this.tableProps.countCols(),s=this.isSelectedByRowHeader(),l=this.isSelectedByColumnHeader(),c=s?-1:0,u=s?0:t;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(r.row,pV(r.col+u,c,a-1)),h=this.tableProps.createCellCoords(i.row,pV(i.col+t,c,a-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(o.row,pV(o.col+t,0,a-1))):this.setRangeStartOnly(d,!0),s&&this.selectedByRowHeader.add(this.getLayerLevel()),l&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(h),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getActiveSelectedRange();if(!this.isSelected())return!1;const t=sB(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}isFocusSelectionChanged(){return this.isSelected()&&hJ(vJ,this)}isSelectedByRowHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(-1===e?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const t=e=>{const{col:t}=e.getOuterTopStartCorner(),n=this.tableProps.countRowHeaders(),r=this.tableProps.countCols();return(n>0&&t<0||0===n)&&e.getWidth()===r};if(-1===e)return Array.from(this.selectedRange).some(e=>t(e));const n=this.selectedRange.peekByIndex(e);return!!n&&t(n)}isSelectedByColumnHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===e?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const t=e=>{const{row:t}=e.getOuterTopStartCorner(),n=this.tableProps.countColHeaders(),r=this.tableProps.countRows();return(n>0&&t<0||0===n)&&e.getHeight()===r};if(-1===e)return Array.from(this.selectedRange).some(e=>t(e));const n=this.selectedRange.peekByIndex(e);return!!n&&t(n)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const t=this.tableProps.visualToRenderableCoords(e);return null!==t.row&&null!==t.col}isAreaCornerVisible(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const i=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),s=this.tableProps.countColHeaders(),l=n?-s:0,c=t?-a:0;if(0===l&&0===c&&(0===i||0===o))return;let u=null===(e=this.getActiveSelectedRange())||void 0===e?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:h}=r;d&&Number.isInteger(null===d||void 0===d?void 0:d.row)&&Number.isInteger(null===d||void 0===d?void 0:d.col)&&(u=this.tableProps.createCellCoords(pV(d.row,l,i-1),pV(d.col,c,o-1)));const f=this.tableProps.createCellCoords(l,c),m=this.tableProps.createCellCoords(i-1,o-1);this.clear(),this.runLocalHooks("beforeSelectAll",f,m,u),this.setRangeStartOnly(f,void 0,u),fJ(yJ,this,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),l<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(m),this.runLocalHooks("afterSelectAll",f,m,u),this.finish()}selectCells(e){var t=this;const n=sJ(e);if(1===n)return!1;if(0===n)throw new Error(ZH(cJ||(cJ=RH(["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, \n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."],["Unsupported format of the selection ranges was passed. To select cells pass\\x20\n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20\n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."]))));const r=lJ(n,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:e=>this.tableProps.propToCol(e),keepDirection:!0}),i=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:i?this.tableProps.countRowHeaders():0,countColHeaders:i?this.tableProps.countColHeaders():0},a=!e.some(e=>{const t=r(e),n=t.isValid(o);return!(n&&!t.containsHeaders()||n&&t.containsHeaders()&&t.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),WH(e,e=>{const{from:t,to:n}=r(e);this.setRangeStartOnly(t.clone(),!1),this.setRangeEnd(n.clone())}),this.finish()),a}selectColumns(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r="string"===typeof e?this.tableProps.propToCol(e):e,i="string"===typeof t?this.tableProps.propToCol(t):t,o=this.tableProps.countRows(),a=this.tableProps.countCols(),s=this.tableProps.countColHeaders(),l=0===s?0:-s,c=this.tableProps.createCellCoords(l,r),u=this.tableProps.createCellCoords(o-1,i),d=this.tableProps.createCellRange(c,c,u).isValid({countRows:o,countCols:a,countRowHeaders:0,countColHeaders:s});if(d){let e=0,t=0;Number.isInteger(null===n||void 0===n?void 0:n.row)&&Number.isInteger(null===n||void 0===n?void 0:n.col)?(e=pV(n.row,l,o-1),t=pV(n.col,Math.min(r,i),Math.max(r,i))):(e=pV(n,l,o-1),t=r);const a=this.tableProps.createCellCoords(e,t),c=0===s?0:pV(a.row,l,-1),u=o-1,d=this.tableProps.createCellCoords(c,r),h=this.tableProps.createCellCoords(u,i);this.runLocalHooks("beforeSelectColumns",d,h,a),this.setRangeStartOnly(d,void 0,a),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(h),this.runLocalHooks("afterSelectColumns",d,h,a),this.finish()}return d}selectRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),a=0===o?0:-o,s=this.tableProps.createCellCoords(e,a),l=this.tableProps.createCellCoords(t,i-1),c=this.tableProps.createCellRange(s,s,l).isValid({countRows:r,countCols:i,countRowHeaders:o,countColHeaders:0});if(c){let r=0,s=0;Number.isInteger(null===n||void 0===n?void 0:n.row)&&Number.isInteger(null===n||void 0===n?void 0:n.col)?(r=pV(n.row,Math.min(e,t),Math.max(e,t)),s=pV(n.col,a,i-1)):(r=e,s=pV(n,a,i-1));const l=this.tableProps.createCellCoords(r,s),c=0===o?0:pV(l.col,a,-1),u=i-1,d=this.tableProps.createCellCoords(e,c),h=this.tableProps.createCellCoords(t,u);this.runLocalHooks("beforeSelectRows",d,h,l),this.setRangeStartOnly(d,void 0,l),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(h),this.runLocalHooks("afterSelectRows",d,h,l),this.finish()}return c}importSelection(e){let{ranges:t,activeRange:n,activeSelectionLayer:r,selectedByRowHeader:i,selectedByColumnHeader:o,disableHeadersHighlight:a}=e;0!==t.length&&(this.selectedRange.clear(),this.highlight.clear(),this.inProgress=!1,fJ(yJ,this,a),this.selectedByRowHeader=new Set(i),this.selectedByColumnHeader=new Set(o),this.setActiveSelectionLayerIndex(0),t.forEach((e,t)=>{this.selectedRange.push(e),this.applyAndCommit(e,t)}),this.setRangeFocus(n.highlight,r),fJ(yJ,this,!1),this.inProgress=!1)}exportSelection(){return{ranges:Array.from(this.selectedRange).map(e=>e.clone()),activeRange:this.getActiveSelectedRange(),activeSelectionLayer:this.getActiveSelectionLayerIndex(),selectedByRowHeader:Array.from(this.selectedByRowHeader),selectedByColumnHeader:Array.from(this.selectedByColumnHeader),disableHeadersHighlight:hJ(yJ,this)}}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),t=this.tableProps.countCols();if(0===e||0===t)return void this.deselect();const n=this.selectedRange.ranges.map(e=>e.clone());this.markSource("refresh");const r=new Set(this.selectedByRowHeader),i=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(n.length),n.forEach(n=>{const{from:r,to:i,highlight:o}=n,a=e-1,s=t-1;o.assign({row:pV(o.row,this.settings.navigableHeaders?-1/0:0,a),col:pV(o.col,this.settings.navigableHeaders?-1/0:0,s)}),r.assign({row:pV(r.row,-1/0,a),col:pV(r.col,-1/0,s)}),i.assign({row:pV(i.row,-1/0,a),col:pV(i.col,-1/0,s)}),this.setRangeStartOnly(r,!0,o),this.setRangeEnd(i)}),this.selectedByRowHeader=r,this.selectedByColumnHeader=i,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(e=>{e.commit()}),!this.isSelected())return;const e=this.getLayerLevel(),t=this.getActiveSelectedRange();this.highlight.isEnabledFor(aQ,t.highlight)&&this.highlight.getFocus().commit().syncWith(t);for(let n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);const e=this.highlight.createArea(),t=this.highlight.createLayeredArea(),r=this.highlight.createRowHeader(),i=this.highlight.createColumnHeader(),o=this.highlight.createActiveRowHeader(),a=this.highlight.createActiveColumnHeader(),s=this.highlight.createActiveCornerHeader(),l=this.highlight.createRowHighlight(),c=this.highlight.createColumnHighlight();e.commit(),t.commit(),r.commit(),i.commit(),o.commit(),a.commit(),s.commit(),l.commit(),c.commit()}this.highlight.useLayerLevel(e)}}ZL(SJ,oK);const CJ=SJ,{register:EJ,getItem:NJ,hasItem:TJ,getNames:AJ,getValues:RJ}=PW("cellTypes");function kJ(e){if(!TJ(e))throw Error('You declared cell type "'.concat(e,'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method'));return NJ(e)}function MJ(e,t){"string"!==typeof e&&(e=(t=e).CELL_TYPE);const{editor:n,renderer:r,validator:i}=t;n&&GW(e,n),r&&HV(e,r),i&&qV(e,i),EJ(e,t)}function DJ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const r="string"===typeof t.type?kJ(t.type):t.type;if(e._automaticallyAssignedMetaProps&&rB(t,(t,n)=>{e._automaticallyAssignedMetaProps.delete(n)}),!tB(r))return;n!==e||e._automaticallyAssignedMetaProps||(e._automaticallyAssignedMetaProps=new Set);const i={};rB(r,(t,r)=>{var o;(function(e,t){var n;return"CELL_TYPE"!==e&&((null===(n=t._automaticallyAssignedMetaProps)||void 0===n?void 0:n.has(e))||!lB(t,e))})(r,n)&&(i[r]=t,null===(o=e._automaticallyAssignedMetaProps)||void 0===o||o.add(r))}),$L(e,i)}function _J(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function OJ(e){return null===e||void 0===e}const IJ=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dialog:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,emptyDataState:!1,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,initialState:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(e){let t,n,r;for(t=0,n=this.countRows();t<n;t++)if(r=this.getDataAtCell(t,e),!1===iL(r))return!1;return!0},isEmptyRow(e){let t,n,r,i;for(t=0,n=this.countCols();t<n;t++)if(r=this.getDataAtCell(e,t),!1===iL(r))return"object"===typeof r&&(i=this.getCellMeta(e,t),eB(this.getSchema()[i.prop],r));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",loading:!1,manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRowHeights:void 0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,pagination:void 0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,valueGetter:void 0,valueSetter:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function PJ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class jJ{constructor(e){PJ(this,"metaCtor",class{}),PJ(this,"meta",void 0),this.meta=this.metaCtor.prototype,$L(this.meta,IJ()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;$L(this.meta,e),DJ(this.meta,E(E({},e),{},{type:null!==(t=e.type)&&void 0!==t?t:this.meta.type}),e)}}function FJ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class HJ{constructor(e){FJ(this,"meta",void 0);const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){$L(this.meta,e),DJ(this.meta,e,e)}}function LJ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class BJ{constructor(e){LJ(this,"valueFactory",void 0),LJ(this,"data",[]),LJ(this,"index",[]),LJ(this,"holes",new Set),this.valueFactory=e}obtain(e){_J(()=>vV(e),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let n;if(t>=0)n=this.data[t],void 0===n&&(n=this.valueFactory(e),this.data[t]=n);else if(n=this.valueFactory(e),this.holes.size>0){const t=this.holes.values().next().value;this.holes.delete(t),this.data[t]=n,this.index[e]=t}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;_J(()=>vV(e)||OJ(e),"Expecting an unsigned number or null/undefined argument.");const n=[],r=this.data.length;for(let o=0;o<t;o++)n.push(r+o),this.data.push(void 0);const i=OJ(e)?this.index.length:e;this.index=[...this.index.slice(0,i),...n,...this.index.slice(i)]}remove(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;_J(()=>vV(e)||OJ(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(OJ(e)?this.index.length-t:e,t);for(let r=0;r<n.length;r++){const e=n[r];"number"===typeof e&&this.holes.add(e)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,t)=>void 0!==e&&!this.holes.has(t))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const t=this._getKeyByStorageIndex(n);-1!==t&&void 0!==this.data[n]&&e.push([t,this.data[n]])}let t=0;return{next:()=>{if(t<e.length){const n=e[t];return t+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function zJ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const WJ=["data","width"];class VJ{constructor(e){zJ(this,"globalMeta",void 0),zJ(this,"metas",new BJ(()=>this._createMeta())),this.globalMeta=e,this.metas=new BJ(()=>this._createMeta())}updateMeta(e,t){const n=this.getMeta(e);$L(n,t),DJ(n,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(){}KL(n,e);for(let r=0;r<t.length;r++)n.prototype[t[r]]=void 0;return n}(this.globalMeta.getMetaConstructor(),WJ).prototype}}function UJ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class qJ{constructor(e){UJ(this,"columnMeta",void 0),UJ(this,"metas",new BJ(()=>this._createRow())),this.columnMeta=e}updateMeta(e,t,n){const r=this.getMeta(e,t);$L(r,n),DJ(r,n)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,t)}getMeta(e,t,n){const r=this.metas.obtain(e).obtain(t);return void 0===n?r:r[n]}setMeta(e,t,n,r){var i;const o=this.metas.obtain(e).obtain(t);null===(i=o._automaticallyAssignedMetaProps)||void 0===i||i.delete(n),o[n]=r}removeMeta(e,t,n){delete this.metas.obtain(e).obtain(t)[n]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let n=0;n<t.length;n++)nL(t[n])&&e.push(...t[n].values());return e}getMetasAtRow(e){_J(()=>vV(e),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new BJ(e=>this._createMeta(e))}_createMeta(e){return new(this.columnMeta.getMetaConstructor(e))}}class GJ{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=e,this.globalMeta=new jJ(e),this.tableMeta=new HJ(this.globalMeta),this.columnMeta=new VJ(this.globalMeta),this.cellMeta=new qJ(this.columnMeta),n.forEach(e=>new e(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,n){const r=this.cellMeta.getMeta(e,t);return r.visualRow=n.visualRow,r.visualCol=n.visualColumn,r.row=e,r.col=t,n.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",r),r}getCellMetaKeyValue(e,t,n){if("string"!==typeof n)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,n)}setCellMeta(e,t,n,r){this.cellMeta.setMeta(e,t,n,r)}updateCellMeta(e,t,n){this.cellMeta.updateMeta(e,t,n)}removeCellMeta(e,t,n){this.cellMeta.removeMeta(e,t,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}function YJ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}ZL(GJ,oK);class KJ{constructor(e){var t=this;YJ(this,"metaManager",void 0),YJ(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return t.extendCellMeta(...arguments)}),_W.getSingleton().add("beforeRender",e=>{e&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;const{row:n,col:r}=e;if(null!==(t=this.metaSyncMemo.get(n))&&void 0!==t&&t.has(r))return;const{visualRow:i,visualCol:o}=e,a=this.metaManager.hot,s=a.colToProp(o);e.prop=s,a.runHooks("beforeGetCellMeta",i,o,e);const l=lB(e,"type")?e.type:null;let c=Uz(e.cells)?e.cells(n,r,s):null;var u;l&&(c?c.type=null!==(u=c.type)&&void 0!==u?u:l:c={type:l});c&&this.metaManager.updateCellMeta(n,r,c),a.runHooks("afterGetCellMeta",i,o,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(r)}}function $J(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function XJ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function QJ(e,t){return e.get(function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(e,t))}var JJ=new WeakMap;class ZJ{constructor(e){XJ(this,"metaManager",void 0),XJ(this,"usageTracker",new Set),XJ(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(e){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===e)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),$J(this,JJ,(e,t,n)=>{if(!n)throw new Error("The `".concat(e,"` option can not be updated after the Handsontable is initialized."))}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{const{initOnly:n,target:r,onChange:i}=e,o="string"===typeof r,a=o?r:t,s="_".concat(a);this.metaManager.globalMeta.meta[s]=this.metaManager.globalMeta.meta[a],i?(this.installPropWatcher(t,s,i),o&&this.installPropWatcher(r,s,i)):n&&(this.installPropWatcher(t,s,QJ(JJ,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(t))})}installPropWatcher(e,t,n){const r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(i){const o=!r.usageTracker.has(e);r.usageTracker.add(e),n.call(r,e,i,o),this[t]=i},enumerable:!0,configurable:!0})}}const eZ=/^(\r\n|\n\r|\r|\n)/,tZ=/^[^\t\r\n]+/,nZ=/^\t/;function rZ(e){let t,n,r,i,o,a="";for(t=0,n=e.length;t<n;t+=1){for(i=e[t].length,r=0;r<i;r+=1)r>0&&(a+="\t"),o=e[t][r],"string"===typeof o?o.indexOf("\n")>-1?a+='"'.concat(o.replace(/"/g,'""'),'"'):a+=o:a+=null===o||void 0===o?"":o;t!==n-1&&(a+="\n")}return a}function iZ(e,t){const{instance:n,visualRow:r,visualCol:i,valueSetter:o}=t;return Uz(o)?o.call(n,e,r,i,t):e}function oZ(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class aZ{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,n){oZ(this,"hot",void 0),oZ(this,"metaManager",void 0),oZ(this,"tableMeta",void 0),oZ(this,"dataSource",void 0),oZ(this,"duckSchema",void 0),oZ(this,"colToPropCache",void 0),oZ(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=t,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if("undefined"===typeof e)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,t){let r=0,i=0,o=!1;if("function"===typeof t){const t=aB(e);r=t>0?t:this.countFirstRowKeys(),o=!0}else{const e=this.tableMeta.maxCols;r=Math.min(e,t.length)}for(n=0;n<r;n++){const e=o?t(n):t[n];if(tB(e)){if("undefined"!==typeof e.data){const t=o?i:n;this.colToPropCache[t]=e.data,this.propToColCache.set(e.data,t)}i+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return ZY(this.dataSource)}recursiveDuckColumns(e,t,n){let r,i=t,o=n;return"undefined"===typeof i&&(i=0,o=""),"object"!==typeof e||Array.isArray(e)||rB(e,(e,t)=>{null===e?(r=o+t,this.colToPropCache.push(r),this.propToColCache.set(r,i),i+=1):i=this.recursiveDuckColumns(e,i,"".concat(t,"."))}),i}colToProp(e){if(!1===Number.isInteger(e))return e;const t=this.hot.toPhysicalColumn(e);return null===t?e:this.colToPropCache&&nL(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(nL(t))return this.hot.toVisualColumn(t);const n=this.hot.toVisualColumn(e);return null===n?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?"function"===typeof e?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?YL(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:n,mode:r="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.hot.countSourceRows();let o=i,a=0,s=e;("number"!==typeof s||s>=i)&&(s=i),s<this.hot.countRows()&&(o=this.hot.toPhysicalRow(s));if(!1===this.hot.runHooks("beforeCreateRow",s,t,n)||null===o)return{delta:0};const l=this.tableMeta.maxRows,c=this.getSchema().length,u=[];for(;a<t&&i+a<l;){let e=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?e=QL(this.getSchema()):(e=[],hV(c-1,()=>e.push(null))):"function"===this.hot.dataType?e=this.tableMeta.dataSchema(s+a):(e={},XL(e,this.getSchema())),u.push(e),a+=1}this.hot.rowIndexMapper.insertIndexes(s,a),"below"===r&&(o=Math.min(o+1,i)),this.spliceData(o,0,u);const d=this.hot.toVisualRow(o);return this.hot.countSourceRows()===u.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(void 0===e||null===e?this.metaManager.createRow(null,a):"auto"!==n&&this.metaManager.createRow(o,t)),this.hot.runHooks("afterCreateRow",d,a,n),{delta:a,startPhysicalIndex:o}}createCol(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:n,mode:r="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const i=this.dataSource,o=this.tableMeta.maxCols,a=this.hot.countSourceCols(),s=this.hot.countCols(),l=this.hot.countSourceRows(),c="number"===typeof e&&e<=a?e:s;if(!1===this.hot.runHooks("beforeCreateCol",c,t,n))return{delta:0};const u=c<s?this.hot.toPhysicalColumn(c):a,d="end"===r?Math.min(u+1,a):u;let h=0;for(let f=d;h<t&&s+h<o;f++){if("number"!==typeof c||c>=s+h)if(l>0)for(let e=0;e<l;e+=1)"undefined"===typeof i[e]&&(i[e]=[]),i[e].push(null);else i.push([null]);else for(let e=0;e<l;e++)i[e].splice(f,0,null);h+=1}return h>0&&(void 0===e||null===e?this.metaManager.createColumn(null,h):"auto"!==n&&this.metaManager.createColumn(d,t)),this.hot.columnIndexMapper.insertIndexes(c,h,r),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(d),h,n),this.refreshDuckSchema(),{delta:h,startPhysicalIndex:d}}removeRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(e)?e:-t;const i=this.visualRowsToPhysical(r,t),o=this.hot.countSourceRows();r=(o+r)%o;if(!1===this.hot.runHooks("beforeRemoveRow",r,i.length,i,n))return!1;const a=i.length;if(this.filterData(r,a,i),r<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(i);const e=nL(this.tableMeta.columns)||nL(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;0!==this.hot.rowIndexMapper.getNotTrimmedIndexesLength()||e||this.hot.columnIndexMapper.setIndexesSequence([])}return i.slice(0).sort((e,t)=>t-e).forEach(e=>{this.metaManager.removeRow(e,1)}),this.hot.runHooks("afterRemoveRow",r,a,i,n),!0}removeCol(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let r="number"!==typeof e?-t:e;r=(this.hot.countCols()+r)%this.hot.countCols();const i=this.visualColumnsToPhysical(r,t),o=i.slice(0).sort((e,t)=>t-e);if(!1===this.hot.runHooks("beforeRemoveCol",r,t,i,n))return!1;let a=!0;const s=o.length,l=this.dataSource;for(let c=0;c<s;c++)a&&i[0]!==i[c]-c&&(a=!1);if(a)for(let c=0,u=this.hot.countSourceRows();c<u;c++)l[c].splice(i[0],t),0===c&&this.metaManager.removeColumn(i[0],t);else for(let c=0,u=this.hot.countSourceRows();c<u;c++)for(let e=0;e<s;e++)l[c].splice(o[e],1),0===c&&this.metaManager.removeColumn(o[e],1);return r<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(i),this.tableMeta.rowHeaders||0!==this.hot.columnIndexMapper.getNotTrimmedIndexesLength()||this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",r,t,i,n),this.refreshDuckSchema(),!0}spliceCol(e,t,n){const r=this.hot.getDataAtCol(e),i=r.slice(t,t+n),o=r.slice(t+n);for(var a=arguments.length,s=new Array(a>3?a-3:0),l=3;l<a;l++)s[l-3]=arguments[l];FH(s,o);let c=0;for(;c<n;)s.push(null),c+=1;return jH(s),this.hot.populateFromArray(t,e,s,null,null,"spliceCol"),i}spliceRow(e,t,n){const r=this.hot.getSourceDataAtRow(e),i=r.slice(t,t+n),o=r.slice(t+n);for(var a=arguments.length,s=new Array(a>3?a-3:0),l=3;l<a;l++)s[l-3]=arguments[l];FH(s,o);let c=0;for(;c<n;)s.push(null),c+=1;return this.hot.populateFromArray(e,t,[s],null,null,"spliceRow"),i}spliceData(e,t,n){if(!1!==this.hot.runHooks("beforeDataSplice",e,t,n)){const t=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,t.forEach(e=>this.dataSource.push(e))}}filterData(e,t,n){let r=this.hot.runHooks("filterData",e,t,n);!1===Array.isArray(r)&&(r=this.dataSource.filter((e,t)=>-1===n.indexOf(t))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(e,t){const n=this.hot.toPhysicalRow(e);let r=this.dataSource[n];const i=this.hot.runHooks("modifyRowData",n);r=isNaN(i)?i:r;const{dataDotNotation:o}=this.hot.getSettings();let a=null;if(r&&r.hasOwnProperty&&lB(r,t))a=r[t];else if(o&&"string"===typeof t&&t.indexOf(".")>-1){let e=r;if(!e)return null;const n=t.split(".");for(let t=0,r=n.length;t<r;t++)if(e=e[n[t]],"undefined"===typeof e)return null;a=e}else"function"===typeof t&&(a=t(this.dataSource.slice(n,n+1)[0]));const s=this.propToCol(t),l=this.hot.toPhysicalColumn(s);if(vV(n)&&vV(l)&&(a=function(e,t){const{instance:n,visualRow:r,visualCol:i,valueGetter:o}=t;return Uz(o)?o.call(n,e,r,i,t):e}(a,this.metaManager.getCellMeta(n,l,{visualRow:e,visualColumn:s,skipMetaExtension:!0}))),this.hot.hasHook("modifyData")){const t=sB(a);this.hot.runHooks("modifyData",e,s,t,"get"),t.isTouched()&&(a=t.value)}return a}getCopyable(e,t){return this.hot.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,n){const r=this.hot.toPhysicalRow(e);let i=n,o=this.dataSource[r];const a=this.hot.runHooks("modifyRowData",r);if(o=isNaN(a)?a:o,this.hot.hasHook("modifyData")){const n=sB(i);this.hot.runHooks("modifyData",e,this.propToCol(t),n,"set"),n.isTouched()&&(i=n.value)}const{dataDotNotation:s}=this.hot.getSettings();if(o&&o.hasOwnProperty&&lB(o,t))o[t]=i;else if(s&&"string"===typeof t&&t.indexOf(".")>-1){let e,n=o,r=0;const a=t.split(".");for(r=0,e=a.length-1;r<e;r++){if("__proto__"===a[r]||"constructor"===a[r]||"prototype"===a[r])return;"undefined"===typeof n[a[r]]&&(n[a[r]]={}),n=n[a[r]]}n[a[r]]=i}else if("function"===typeof t)t(this.dataSource.slice(r,r+1)[0],i);else{if("__proto__"===t||"constructor"===t||"prototype"===t)return;o[t]=i}}visualRowsToPhysical(e,t){const n=this.hot.countSourceRows(),r=[];let i,o=(n+e)%n,a=t;for(;o<n&&a;)i=this.hot.toPhysicalRow(o),r.push(i),a-=1,o+=1;return r}visualColumnsToPhysical(e,t){const n=this.hot.countCols(),r=[];let i=(n+e)%n,o=t;for(;i<n&&o;){const e=this.hot.toPhysicalColumn(i);r.push(e),o-=1,i+=1}return r}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let t=0;t<this.hot.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;t=e<0||0===e?0:e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-t.row!==0||this.hot.countSourceRows()?this.getRange(e,t,aZ.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,n){const r=[];let i,o,a;const s=this.tableMeta.maxRows,l=this.tableMeta.maxCols;if(0===s||0===l)return[];const c=n===aZ.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,u=Math.min(Math.max(s-1,0),Math.max(e.row,t.row)),d=Math.min(Math.max(l-1,0),Math.max(e.col,t.col));for(i=Math.min(e.row,t.row);i<=u;i++){a=[];const n=i>=0?this.hot.toPhysicalRow(i):i;for(o=Math.min(e.col,t.col);o<=d&&null!==n;o++)a.push(c.call(this,i,this.colToProp(o)));null!==n&&r.push(a)}return r}getText(e,t){return rZ(this.getRange(e,t,aZ.DESTINATION_RENDERER))}getCopyableText(e,t){return rZ(this.getRange(e,t,aZ.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const sZ=aZ;function lZ(e,t,n,r){const{hotInstance:i,dataMap:o,dataSource:a,internalSource:s,source:l,metaManager:c,firstRun:u}=r,d=yL(s),h=i.getSettings();Array.isArray(h.dataSchema)?i.dataType="array":Uz(h.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),e=i.runHooks("before".concat(d),e,u,l);const f=new sZ(i,e,c);if(t(f),"object"===typeof e&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error("".concat(s," only accepts array of objects or array of arrays (").concat(typeof e," given)"));{const t=f.getSchema();let n;e=[];let r=0,o=0;for(r=0,o=h.startRows;r<o;r++)if("object"!==i.dataType&&"function"!==i.dataType||!h.dataSchema)if("array"===i.dataType)n=QL(t[0]),e.push(n);else{n=[];for(let e=0,t=h.startCols;e<t;e++)n.push(null);e.push(n)}else n=QL(t),e.push(n)}}Array.isArray(e[0])&&(i.dataType="array"),h.data=e,f.dataSource=e,a.data=e,a.dataType=i.dataType,a.colToProp=f.colToProp.bind(f),a.propToCol=f.propToCol.bind(f),a.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks("after".concat(d),e,u,l),u||(i.runHooks("afterChange",null,s),i.view.adjustElementsSize(),i.render()),i.getSettings().ariaTags&&XB(i.rootElement,[LL(-1),BL(i.countCols()+(i.view?i.countRowHeaders():0))])}function cZ(e,t,n){uZ(e,t),t.set(e,n)}function uZ(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dZ(e,t){return e.get(fZ(e,t))}function hZ(e,t,n){return e.set(fZ(e,t),n),n}function fZ(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var mZ=new WeakMap,pZ=new WeakMap,gZ=new WeakSet;class vZ{constructor(e){let{rowIndexMapper:t,columnIndexMapper:n}=e;!function(e,t){uZ(e,t),t.add(e)}(this,gZ),cZ(this,mZ,void 0),cZ(this,pZ,void 0),hZ(mZ,this,t),hZ(pZ,this,n)}toRenderable(e){const t="N-S"===e.getVerticalDirection()?1:-1,n="W-E"===e.getHorizontalDirection()?1:-1,r=fZ(gZ,this,yZ).call(this,e.from,t,n);if(null===r)return null;const i=fZ(gZ,this,yZ).call(this,e.to,-t,-n);if(null===i)return null;const o=e.clone();return o.from=r,o.to=i,o.includes(e.highlight)||(o.highlight=r),o}}function yZ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;const r=fZ(gZ,this,bZ).call(this,dZ(mZ,this),e.row,t);if(null===r)return null;const i=fZ(gZ,this,bZ).call(this,dZ(pZ,this),e.col,n);return null===i?null:e.clone().assign({row:r,col:i})}function bZ(e,t,n){return t<0?t:e.getNearestNotHiddenIndex(t,n)}function wZ(e){Vz(e)&&e.scrollIntoView({block:"nearest",inline:"nearest"})}function xZ(e){const{selection:t,view:n}=e,r=e.getSelectedRangeActive(),i=t.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),a=n.getLastFullyVisibleColumn(),s=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,c=s<=o,u=l>=a,d=n.getFirstFullyVisibleRow(),h=n.getLastFullyVisibleRow(),f=r.getTopStartCorner().row,m=r.getBottomEndCorner().row,p=f<=d,g=m>=h;return{getComputedColumnTarget:e=>"mouse"===i||"keyboard"===i?e.col:c&&u?r.highlight.col:c?s:u?l:e.col,getComputedRowTarget:e=>"mouse"===i||"keyboard"===i?e.row:p&&g?r.highlight.row:p?f:g?m:e.row}}function SZ(e){const{selection:t}=e;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r)return void(n=!1);let a;t.isFocusSelectionChanged()?a=function(e){return t=>{e.scrollViewportTo(t.toObject(),()=>{const t=e.getSelectedRangeActive();if(!t)return;const{row:n,col:r}=t.highlight;wZ(e.getCell(n,r,!0))})}}(e):t.isSelectedByCorner()?a=()=>{}:t.isSelectedByRowHeader()?a=function(e){return t=>{const n=xZ(e).getComputedRowTarget(t);e.scrollViewportTo({row:n},()=>{const t=!!e.getSettings().rowHeaders;wZ(e.getCell(n,t?-1:0,!0))})}}(e):t.isSelectedByColumnHeader()?a=function(e){return t=>{const n=xZ(e).getComputedColumnTarget(t);e.scrollViewportTo({col:n},()=>{const t=!!e.getSettings().colHeaders;wZ(e.getCell(t?-1:0,n,!0))})}}(e):1===t.getSelectedRange().size()&&t.isMultiple()?a=function(e){return t=>{const n=xZ(e),r={row:n.getComputedRowTarget(t),col:n.getComputedColumnTarget(t)};e.scrollViewportTo(r,()=>{const{row:t,col:n}=r;wZ(e.getCell(t,n,!0))})}}(e):1!==t.getSelectedRange().size()||t.isMultiple()?t.getSelectedRange().size()>1&&(a=function(e){return t=>{const n=xZ(e),r={row:n.getComputedRowTarget(t),col:n.getComputedColumnTarget(t)};e.scrollViewportTo(r,()=>{const{row:t,col:n}=r;wZ(e.getCell(t,n,!0))})}}(e)):a=function(e){return t=>{const n=e.selection.getSelectionSource(),{row:r,col:i}=t,o=()=>{wZ(e.getCell(r,i,!0))};if(r<0&&i>=0)e.scrollViewportTo({col:i},o);else if(i<0&&r>=0)e.scrollViewportTo({row:r},o);else{if("mouse"===n&&(i===e.view.getLastPartiallyVisibleColumn()||r===e.view.getLastPartiallyVisibleRow()))return;e.scrollViewportTo({row:r,col:i},o)}}}(e),null===(o=a)||void 0===o||o(i)}}}function CZ(e,t,n){EZ(e,t),t.set(e,n)}function EZ(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function NZ(e,t){return e.get(AZ(e,t))}function TZ(e,t,n){return e.set(AZ(e,t),n),n}function AZ(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const RZ=Object.freeze({CELL:"cell",MIXED:"mixed"});var kZ=new WeakMap,MZ=new WeakMap,DZ=new WeakMap,_Z=new WeakMap,OZ=new WeakMap,IZ=new WeakMap,PZ=new WeakSet;class jZ{constructor(e){!function(e,t){EZ(e,t),t.add(e)}(this,PZ),CZ(this,kZ,void 0),CZ(this,MZ,void 0),CZ(this,DZ,1),CZ(this,_Z,null),CZ(this,OZ,new Map),CZ(this,IZ,!1),TZ(kZ,this,e)}init(){var e=this;const t=NZ(kZ,this).getSettings();TZ(MZ,this,t.imeFastEdit?RZ.MIXED:RZ.CELL),NZ(kZ,this).addHook("afterUpdateSettings",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return AZ(PZ,e,WZ).call(e,...n)}),NZ(kZ,this).addHook("afterSelection",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return AZ(PZ,e,BZ).call(e,...n)}),NZ(kZ,this).addHook("afterSelectionFocusSet",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return AZ(PZ,e,BZ).call(e,...n)}),NZ(kZ,this).addHook("afterSelectionEnd",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return AZ(PZ,e,LZ).call(e,...n)}),NZ(kZ,this).addHook("afterRender",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return AZ(PZ,e,zZ).call(e,...n)})}getFocusMode(){return NZ(MZ,this)}setFocusMode(e){Object.values(RZ).includes(e)?TZ(MZ,this,e):hW('"'.concat(e,'" is not a valid focus mode.'))}getRefocusDelay(){return NZ(DZ,this)}setRefocusDelay(e){TZ(DZ,this,e)}setRefocusElementGetter(e){TZ(_Z,this,e)}getRefocusElement(){var e;return"function"===typeof NZ(_Z,this)?NZ(_Z,this).call(this):null===(e=NZ(kZ,this).getActiveEditor())||void 0===e?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const t=e=>{var t,n;const r=null===(t=NZ(kZ,this).getSelectedRangeActive())||void 0===t?void 0:t.highlight;if(!r)return;let i=NZ(kZ,this).runHooks("modifyFocusedElement",r.row,r.col,e);Vz(i)||(i=e),!i||null!==(n=NZ(kZ,this).getActiveEditor())&&void 0!==n&&n.isOpened()||i.focus({preventScroll:!0})};e?t(e):AZ(PZ,this,FZ).call(this,e=>t(e))}refocusToEditorTextarea(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:NZ(DZ,this);var n,r;!NZ(kZ,this).getSettings().imeFastEdit||null!==(e=NZ(kZ,this).getActiveEditor())&&void 0!==e&&e.isOpened()||(null===(n=NZ(kZ,this).getActiveEditor())||void 0===n||null===(r=n.refreshValue)||void 0===r||r.call(n),NZ(OZ,this).has(t)||NZ(OZ,this).set(t,Yz(()=>{var e;NZ(kZ,this).isDestroyed||(null===(e=this.getRefocusElement())||void 0===e||e.select())},t)),NZ(OZ,this).get(t)())}}function FZ(e){var t;const n=null===(t=NZ(kZ,this).getSelectedRangeActive())||void 0===t?void 0:t.highlight;if(!n||!NZ(kZ,this).selection.isCellVisible(n))return void e(null);const r=NZ(kZ,this).getCell(n.row,n.col,!0);null===r?NZ(kZ,this).addHookOnce("afterScroll",()=>{e(NZ(kZ,this).getCell(n.row,n.col,!0))}):e(r)}function HZ(){AZ(PZ,this,FZ).call(this,e=>{const{activeElement:t}=NZ(kZ,this).rootDocument;t&&jz(t)&&t.blur(),this.focusOnHighlightedCell(e)})}function LZ(){AZ(PZ,this,FZ).call(this,e=>{this.getFocusMode()===RZ.MIXED&&"TD"===(null===e||void 0===e?void 0:e.nodeName)&&this.refocusToEditorTextarea()})}function BZ(){TZ(IZ,this,!0)}function zZ(){NZ(IZ,this)&&(TZ(IZ,this,!1),AZ(PZ,this,HZ).call(this))}function WZ(e){"boolean"===typeof e.imeFastEdit&&this.setFocusMode(e.imeFastEdit?RZ.MIXED:RZ.CELL)}const VZ=Object.freeze({INLINE:"inline",MODAL:"modal"}),UZ=Object.freeze({UNKNOWN:"unknown",CLICK:"click",TAB_FROM_ABOVE:"tab_from_above",TAB_FROM_BELOW:"tab_from_below"});function qZ(e,t){const n=e.rootDocument.createElement("input");return n.type="text",n.name="htFocusCatcher",n.classList.add("htFocusCatcher"),n.dataset.htFocusSource=t,e.getSettings().ariaTags&&XB(n,[IL("Focus catcher")]),n}function GZ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=E({shortcutsContextName:"grid",type:VZ.INLINE,contains:e=>e===t||t.contains(e),runOnlyIf:()=>!0},n),i=function(e,t){const n=qZ(e,UZ.TAB_FROM_ABOVE),r=qZ(e,UZ.TAB_FROM_BELOW);return t.prepend(n),t.append(r),{activate(){n.tabIndex=0,r.tabIndex=0},deactivate(){n.tabIndex=-1,r.tabIndex=-1},destroy(){n.remove(),r.remove()}}}(e,t);return{getType:()=>r.type,hasContainerDetached:()=>!e.rootWrapperElement.contains(t),getShortcutsContextName:()=>r.shortcutsContextName,runOnlyIf:()=>r.runOnlyIf(),contains:e=>r.contains(e),activate:function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:UZ.UNKNOWN;null===(e=r.onActivate)||void 0===e||e.call(r,t)},deactivate:()=>{var e;null===(e=r.onDeactivate)||void 0===e||e.call(r)},activateFocusCatchers:()=>{null===i||void 0===i||i.activate()},deactivateFocusCatchers:()=>{null===i||void 0===i||i.deactivate()},enable:()=>{t.removeAttribute("inert")},disable:()=>{t.setAttribute("inert","true")},destroy:()=>{null===i||void 0===i||i.destroy()}}}function YZ(e){const t=CV({errorIdExists:e=>'The "'.concat(e,'" focus scope is already registered.')}),n=e.getShortcutManager();let r=null;function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:UZ.UNKNOWN;r!==e&&(null!==r&&o(r),r=e,r.activate(t),n.setActiveContextName(e.getShortcutsContextName()))}function o(e){a(),r===e&&(r=null,e.deactivate())}function a(){const n=t.getValues(),i=n.filter(e=>e.runOnlyIf()&&"modal"===e.getType());n.forEach(t=>{i.length>0&&i.includes(t)||0===i.length||t.hasContainerDetached()?t.enable():t.disable(),t===r?t.contains(e.rootDocument.activeElement)?t.deactivateFocusCatchers():t.activateFocusCatchers():t.runOnlyIf()?t.activateFocusCatchers():t.deactivateFocusCatchers()})}function s(n,a){if(!n.isConnected||!rz(n))return;const s=t.getValues().filter(e=>e.runOnlyIf());let l=!1;s.forEach(t=>{!l&&t.contains(n)&&(l=!0,a!==UZ.UNKNOWN&&e.listen(),i(t,a))}),!l&&r&&(o(r),e.unlisten())}const l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!1;function r(e){var r;n||null===(r=t.onFocus)||void 0===r||r.call(t,e)}function i(e){var n;null===(n=t.onClick)||void 0===n||n.call(t,e)}function o(e){var n;"Tab"===e.key&&(null===(n=t.onTabKeyDown)||void 0===n||n.call(t,e))}function a(){n=!0}function s(){n=!1}return{mount:()=>{let t=e;for(;t;){const{documentElement:e}=t.document;e.addEventListener("focusin",r),e.addEventListener("click",i),e.addEventListener("keydown",o),e.addEventListener("mousedown",a),e.addEventListener("mouseup",s),t=FB(t)}},unmount:()=>{let t=e;for(;t;){const{documentElement:e}=t.document;e.removeEventListener("focusin",r),e.removeEventListener("click",i),e.removeEventListener("keydown",o),e.removeEventListener("mousedown",a),e.removeEventListener("mouseup",s),t=FB(t)}}}}(e.rootWindow,{onFocus:e=>{var t;s(e.target,null!==(t=e.target.dataset.htFocusSource)&&void 0!==t?t:UZ.UNKNOWN)},onClick:e=>{s(e.target,UZ.CLICK)},onTabKeyDown:()=>{a()}});return l.mount(),{getActiveScopeId:function(){return r?t.getId(r):null},registerScope:function(r,i){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t.hasItem(r))throw new Error('Scope with id "'.concat(r,'" already registered'));const a=GZ(e,i,o);t.addItem(r,a),n.getOrCreateContext(a.getShortcutsContextName())},unregisterScope:function(e){if(!t.hasItem(e))throw new Error('Scope with id "'.concat(e,'" not found'));t.getItem(e).destroy(),t.removeItem(e)},activateScope:e=>function(e){if(!t.hasItem(e))throw new Error('Scope with id "'.concat(e,'" not found'));i(t.getItem(e))}(e),deactivateScope:e=>function(e){if(!t.hasItem(e))throw new Error('Scope with id "'.concat(e,'" not found'));o(t.getItem(e))}(e),destroy:()=>l.unmount()}}function KZ(e){const{rowIndexMapper:t,columnIndexMapper:n}=e,{navigableHeaders:r}=e.getSettings();let i=r&&e.countColHeaders()>0?-e.countColHeaders():0,o=r&&e.countRowHeaders()>0?-e.countRowHeaders():0;return 0===i&&(i=t.getVisualFromRenderableIndex(i)),0===o&&(o=n.getVisualFromRenderableIndex(o)),null===i||null===o?null:e._createCellCoords(i,o)}function $Z(e){var t,n;const{rowIndexMapper:r,columnIndexMapper:i}=e,{navigableHeaders:o}=e.getSettings();let a=r.getRenderableIndexesLength()-1,s=i.getRenderableIndexesLength()-1;if(a<0){if(!o||0===e.countColHeaders())return null;a=-1}if(s<0){if(!o||0===e.countColHeaders())return null;s=-1}return e._createCellCoords(null!==(t=r.getVisualFromRenderableIndex(a))&&void 0!==t?t:a,null!==(n=i.getVisualFromRenderableIndex(s))&&void 0!==n?n:s)}const XZ="gridDefault",QZ="grid",JZ="grid.tabNavigation",ZZ="editorManager.handlingEditor";function e0(e){var t;const n=function(e){return t=>{if(!t)return null;const{rowIndexMapper:n,columnIndexMapper:r}=e;if(n.isHidden(t.row)||r.isHidden(t.col))return null;const i=KZ(e),o=$Z(e);return null===i||null===o?null:(t.row=pV(t.row,i.row,o.row),t.col=pV(t.col,i.col,o.col),t)}}(e),r={wrapped:!1,flipped:!1};let i,o=!0,a=!1;e.addHook("afterSelection",()=>{var t;o&&(i=null===(t=e.getSelectedRangeActive())||void 0===t?void 0:t.highlight)}),e.addHook("beforeRowWrap",(e,t,n)=>{r.wrapped=!0,r.flipped=n}),e.addHook("beforeEmptyDataStateShow",()=>{a=!0}),e.addHook("beforeEmptyDataStateHide",()=>{a=!1});e.getShortcutManager().getContext(QZ).addShortcuts([{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:XZ,group:JZ,position:"before",callback(){const{tabNavigation:t}=e.getSettings();e.getSelectedRangeActive()&&!t&&(o=!1)}},{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:XZ,group:JZ,callback(t){const{tabNavigation:n,autoWrapRow:a}=e.getSettings();o=!0,(!n||!e.selection.isSelected()||a&&r.wrapped&&r.flipped||!a&&r.wrapped)&&(a&&r.wrapped&&r.flipped&&(i=t.shiftKey?KZ(e):$Z(e)),r.wrapped=!1,r.flipped=!1)},position:"after"}]);const s=null!==(t=e.rootGridElement)&&void 0!==t?t:e.rootElement;e.getFocusScopeManager().registerScope("grid",s,{contains:t=>!(s!==t&&!s.contains(t))||null===t.closest(".htMenu")&&e.rootPortalElement.contains(t),runOnlyIf:()=>{const{navigableHeaders:t}=e.getSettings();return!((a||!t)&&0===e.countRenderedRows()&&0===e.countRenderedCols()&&e.countRowHeaders()>0&&e.countColHeaders()>0)&&(!t&&e.countRenderedRows()>0&&e.countRenderedCols()>0||t&&(e.countRowHeaders()>0||e.countColHeaders()>0))},onActivate:t=>{if("tab_from_above"===t){var r;const t=null!==(r=n(i))&&void 0!==r?r:KZ(e);if(t){!1!==e.runHooks("modifyFocusOnTabNavigation","from_above",t)&&e.selectCell(t.row,t.col)}}else if("tab_from_below"===t){var o;const t=null!==(o=n(i))&&void 0!==o?o:$Z(e);if(t){!1!==e.runHooks("modifyFocusOnTabNavigation","from_below",t)&&e.selectCell(t.row,t.col)}}}})}const t0=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),n0=e=>e.map(e=>{const t=e.toLowerCase();return t0.has(t)?t0.get(t):t}).sort().join("+"),r0=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),i0=e=>{let{which:t,key:n}=e;if(r0.has(t))return r0.get(t);const r=String.fromCharCode(t).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()};var o0;const a0=Symbol("shortcut-context");function s0(e){return tB(e)&&e.__kindOf===a0}const l0=["meta","alt","shift","control"],c0=function(){const e=new Set;return{press(t){e.add(t)},release(t){e.delete(t)},releaseAll(){e.clear()},isPressed:t=>e.has(t)}}(),u0=[];let d0=0;var h0;const f0=e=>{let{ownerWindow:t,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=e;const o=CV({errorIdExists:e=>'The "'.concat(e,'" context name is already registered.')});let a="grid";const s=function(e){const t=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"table";const n=CV({errorIdExists:t=>'The "'.concat(t,'" shortcut is already registered in the "').concat(e,'" context.')}),r=function(){let{keys:e,callback:t,group:r,runOnlyIf:i=()=>!0,captureCtrl:o=!1,preventDefault:a=!0,stopPropagation:s=!1,relativeToGroup:l,position:c,forwardToContext:u}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(rL(r))throw new Error("You need to define the shortcut's group.");if(!1===Uz(t))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(e))throw new Error(ZH(o0||(o0=RH(["Pass the shortcut's keys as an array of arrays, \n      using the KeyboardEvent.key properties: \n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."],["Pass the shortcut\\'s keys as an array of arrays,\\x20\n      using the KeyboardEvent.key properties:\\x20\n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."]))));const d={callback:t,group:r,runOnlyIf:i,captureCtrl:o,preventDefault:a,stopPropagation:s};nL(l)&&(d.relativeToGroup=l,d.position=c),s0(u)&&(d.forwardToContext=u),e.forEach(e=>{const t=n0(e);if(n.hasItem(t)){const e=n.getItem(t);let r=e.findIndex(e=>e.group===l);-1!==r?"before"===c?r-=1:r+=1:r=e.length,e.splice(r,0,d)}else n.addItem(t,[d])})},i=e=>{const t=n0(e);n.removeItem(t)};return{__kindOf:a0,scope:t,addShortcut:r,addShortcuts:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach(e=>{rB(t,(n,r)=>{!1===Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=t[r])}),r(e)})},getShortcuts:e=>{const t=n0(e),r=n.getItem(t);return nL(r)?r.slice():[]},hasShortcut:e=>{const t=n0(e);return n.hasItem(t)},removeShortcutsByKeys:i,removeShortcutsByGroup:e=>{n.getItems().forEach(t=>{let[n,r]=t;const o=r.filter(t=>t.group!==e);0===o.length?i((e=>e.split("+"))(n)):(r.length=0,r.push(...o))})}}}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"table");return o.addItem(e,t),t},l=()=>a,c=e=>o.getItem(e);let u=!1;const d=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l();const r=s0(n)?n:c(n);let i=!1;if(!r.hasShortcut(t))return i;const o=r.getShortcuts(t);for(let a=0;a<o.length;a++){const{callback:n,runOnlyIf:r,preventDefault:s,stopPropagation:l,captureCtrl:c,forwardToContext:h}=o[a];if(!0===r(e)){if(u=c,i=!1===n(e,t),u=!1,s&&e.preventDefault(),l&&(aW(e),e.stopPropagation()),i)break;h&&d(e,t,h)}}return i},h=function(e,t,n,r,i){const o=e=>l0.includes(e),a=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=[];return e.altKey&&n.push("alt"),t&&(e.ctrlKey||e.metaKey)?n.push("control/meta"):(e.ctrlKey&&n.push("control"),e.metaKey&&n.push("meta")),e.shiftKey&&n.push("shift"),n},s=e=>{if(!1===t(e))return;if(!1===n(e)||229===e.keyCode||"string"!==typeof e.key||sW(e))return;const s=i0(e);let l=[];o(s)||(l=a(e));const c=[s].concat(l);!i(e,c)&&(_B()&&l.includes("meta")||!_B()&&l.includes("control"))&&i(e,[s].concat(a(e,!0))),r(e)},l=e=>{if("string"===typeof e.key){const t=i0(e);o(t)&&c0.press(t)}},c=e=>{if("string"===typeof e.key){const t=i0(e);o(t)&&c0.release(t)}},u=()=>{c0.releaseAll()};return{mount:()=>{let t=e;for(d0+=1;t;)1===d0&&(t.document.documentElement.addEventListener("keydown",l),u0.push({event:"keydown",listener:l}),t.document.documentElement.addEventListener("keyup",c),u0.push({event:"keyup",listener:c})),t.document.documentElement.addEventListener("keydown",s),t.document.documentElement.addEventListener("blur",u),t=FB(t)},unmount:()=>{let t=e;for(d0-=1;t;){if(0===d0){for(let e=0;e<u0.length;e++){const{event:n,listener:r}=u0[e];t.document.documentElement.removeEventListener(n,r)}u0.length=0}t.document.documentElement.removeEventListener("keydown",s),t.document.documentElement.removeEventListener("blur",u),t=FB(t)}},isPressed:e=>c0.isPressed(e),releasePressedKeys:()=>c0.releaseAll()}}(t,e=>{const t=l(),r=s0(t)?t:c(t);return n(e,r.scope)},r,i,d);return h.mount(),{addContext:s,getActiveContextName:l,getContext:c,getOrCreateContext:function(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"table";return null!==(t=c(e))&&void 0!==t?t:s(e,n)},setActiveContextName:e=>{if(!o.hasItem(e))throw new Error(ZH(h0||(h0=RH(["You've tried to activate the \"",'" shortcut context \n        that does not exist. Before activation, register the context using the "addContext" method.'],["You've tried to activate the \"",'" shortcut context\\x20\n        that does not exist. Before activation, register the context using the "addContext" method.'])),e));a=e},isCtrlPressed:()=>!u&&(h.isPressed("control")||h.isPressed("meta")),releasePressedKeys:()=>h.releasePressedKeys(),destroy:()=>h.unmount()}},m0={name:"editorCloseAndSave",callback(e){e._getEditorManager().closeEditorAndSaveChanges()}},p0={_hooksStorage:Object.create(null),addHook(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey(e){WH(this._hooksStorage[e]||[],t=>{this.hot.removeHook(e,t)})},clearHooks(){rB(this._hooksStorage,(e,t)=>this.removeHooksByKey(t)),this._hooksStorage={}}};nB(p0,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});const g0=p0;function v0(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const y0=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class b0{static get EDITOR_TYPE(){return"base"}constructor(e){v0(this,"hot",void 0),v0(this,"state",y0.VIRGIN),v0(this,"_opened",!1),v0(this,"_fullEditMode",!1),v0(this,"_closeCallback",null),v0(this,"TD",null),v0(this,"row",null),v0(this,"col",null),v0(this,"prop",null),v0(this,"originalValue",null),v0(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,n,r,i,o){this.TD=r,this.row=e,this.col=t,this.prop=n,this.originalValue=i,this.cellProperties=o,this.state=this.isOpened()?this.state:y0.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let n,r,i,o;if(t){const e=this.hot.getSelectedRangeActive(),t=e.getTopStartCorner(),a=e.getBottomEndCorner();n=t.row,r=t.col,i=a.row,o=a.col}else[n,r,i,o]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",n,r,!1,"meta");Array.isArray(a)&&([n,r]=a),this.hot.populateFromArray(n,r,e,i,o,"edit")}beginEditing(e,t){if(this.state!==y0.VIRGIN)return;const n=this.hot,r=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),o=()=>{if(this.state=y0.EDITING,this.isInFullEditMode()){const t=this.cellProperties.valueGetter?this.cellProperties.valueGetter(this.originalValue):this.originalValue,n="string"===typeof e?e:tL(t);this.setValue(n)}this.open(t),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",o);n.view.scrollViewport(n._createCellCoords(r,i))||(this.hot.removeHook("afterScroll",o),o()),this.addHook("beforeDialogShow",()=>this.cancelChanges())}finishEditing(e,t,n){let r;if(n){const e=this._closeCallback;this._closeCallback=t=>{e&&e(t),n(t),this.hot.view.render()}}if(!this.isWaiting())if(this.state!==y0.VIRGIN){if(this.state===y0.EDITING){if(e)return this.cancelChanges(),void this.hot.view.render();const n=this.getValue();r=this.cellProperties.trimWhitespace?[["string"===typeof n?String.prototype.trim.call(n||""):n]]:[[n]],this.state=y0.WAITING,this.saveValue(r,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",e=>{this.state=y0.FINISHED,this.discardEditor(e)}):(this.state=y0.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout(()=>{this._fireCallbacks(!0)})}cancelChanges(){this.state=y0.FINISHED,this.discardEditor()}discardEditor(e){if(this.state===y0.FINISHED)if(!1===e&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=y0.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=y0.VIRGIN,this._fireCallbacks(!0);this.hot.getShortcutManager().setActiveContextName("grid")}}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===y0.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:n,wtViewport:r}=this.hot.view._wt,i=this.hot.rootWindow,o=oz(t),a=gz(t),s=oz(this.hot.rootElement),l=gz(this.hot.rootElement),c=n.topOverlay.holder,u=n.inlineStartOverlay.holder,d=c!==i?c.scrollTop:0,h=u!==i?u.scrollLeft:0,f=i.innerWidth-s.left-l,{wtTable:m}=null!==(e=n.getParentOverlay(t))&&void 0!==e?e:this.hot.view._wt,p=m.name,g=["master","inline_start"].includes(p)?d:0,v=["master","top","bottom"].includes(p)?h:0,y=o.top===s.top?0:1;let b=o.top-s.top-y-g,w=0;w=this.hot.isRtl()?i.innerWidth-o.left-a-f-1+v:o.left-s.left-1-v,["top","top_inline_start_corner"].includes(p)&&(b+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(p)&&(w+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const x=this.hot.hasColHeaders(),S=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),C=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),E=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(x&&S<=0||S===E)&&(b+=1),C<=0&&(w+=1);const N=r.rowsRenderCalculator.startPosition,T=r.columnsRenderCalculator.startPosition,A=Math.abs(n.inlineStartOverlay.getScrollPosition()),R=n.topOverlay.getScrollPosition(),k=kz(this.hot.rootDocument);let M=t.offsetTop;if(["inline_start","master"].includes(p)&&(M+=N-R),["bottom","bottom_inline_start_corner"].includes(p)){const{wtViewport:e,wtTable:t}=n.bottomOverlay.clone;M+=e.getWorkspaceHeight()-t.getHeight()-k}let D=t.offsetLeft;this.hot.isRtl()?(D=D>=0?m.getWidth()-t.offsetLeft:Math.abs(D),D+=T-A-a):["top","master","bottom"].includes(p)&&(D+=T-A);const _=i.getComputedStyle(this.TD),O=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",I=parseInt(_[O],10)>0?0:1,P=parseInt(_.borderTopWidth,10)>0?0:1,j=gz(t)+I,F=vz(t)+P,H=Mz(c)?k:0,L=Dz(u)?k:0,B=this.hot.view.maximumVisibleElementWidth(D)-H+I;return{top:b,start:w,height:F,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(M)-L+P,this.hot.stylesHandler.getDefaultRowHeight()),width:j,maxWidth:B}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?t=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?t=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}ZL(b0,g0);const w0={name:"editorCloseAndSaveByArrowKeys",callback(e,t,n){const r=e._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===y0.EDITING||(r.closeEditorAndSaveChanges(),e.getSelected()&&(n.includes("arrowdown")?e.selection.transformStart(1,0):n.includes("arrowup")?e.selection.transformStart(-1,0):n.includes("arrowleft")?e.selection.transformStart(0,-1*e.getDirectionFactor()):n.includes("arrowright")&&e.selection.transformStart(0,e.getDirectionFactor())),t.preventDefault())}},x0={name:"editorCloseAndSaveByEnter",callback(e,t){const n=e._getEditorManager();n.closeEditorAndSaveChanges(t.ctrlKey||t.metaKey),n.moveSelectionAfterEnter(t)}},S0={name:"editorCloseWithoutSaving",callback(e){const t=e._getEditorManager();t.closeEditorAndRestoreOriginalValue(e.getShortcutManager().isCtrlPressed()),t.activeEditor.focus()}},C0={name:"editorFastOpen",callback(e,t){const{highlight:n}=e.getSelectedRangeActive();n.isHeader()||e._getEditorManager().openEditor(null,t,!0)}},E0={name:"editorOpen",callback(e,t,n){const{selection:r}=e,i=e._getEditorManager(),o=e.getSelectedRange(),a=e.getSelectedRangeActive(),{highlight:s}=a;if((o.some(e=>r.isMultiple(e))||o.length>1)&&!a.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0){const i=e.getSettings(),o="function"===typeof i.enterMoves?i.enterMoves(t):i.enterMoves;return void(n.includes("shift")?r.transformFocus(-o.row,-o.col):r.transformFocus(o.row,o.col))}s.isHeader()||(e.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(t):i.openEditor(null,t,!0):i.moveSelectionAfterEnter(t),aW(t))}};const N0={name:"extendCellsSelectionDown",callback(e){const{selection:t}=e,{highlight:n}=e.getSelectedRangeActive();t.isSelectedByColumnHeader()||t.isSelectedByCorner()||!(n.isCell()||n.isHeader()&&t.isSelectedByRowHeader())||(t.markSource("keyboard"),t.transformEnd(1,0),t.markEndSource())}},T0={name:"extendCellsSelectionDownByViewportHeight",callback(e){const{selection:t,rowIndexMapper:n}=e,{to:r}=e.getSelectedRangeActive(),i=Math.min(r.row+e.countVisibleRows(),e.countRows()-1),o=n.getNearestNotHiddenIndex(i,-1);if(null!==o){const n=e._createCellCoords(o,r.col),i=r.row-e.getFirstFullyVisibleRow(),a=Math.min(n.row-i,e.countRows()-1);t.markSource("keyboard"),t.setRangeEnd(n,e.getActiveSelectionLayerIndex()),t.markEndSource(),e.scrollViewportTo({row:a,verticalSnap:"top",horizontalSnap:"start"})}}},A0={name:"extendCellsSelectionLeft",callback(e){const{selection:t}=e,{highlight:n}=e.getSelectedRangeActive();t.isSelectedByRowHeader()||t.isSelectedByCorner()||!(n.isCell()||n.isHeader()&&t.isSelectedByColumnHeader())||(t.markSource("keyboard"),t.transformEnd(0,-1*e.getDirectionFactor()),t.markEndSource())}},R0={name:"extendCellsSelectionRight",callback(e){const{selection:t}=e,{highlight:n}=e.getSelectedRangeActive();t.isSelectedByRowHeader()||t.isSelectedByCorner()||!(n.isCell()||n.isHeader()&&t.isSelectedByColumnHeader())||(t.markSource("keyboard"),t.transformEnd(0,e.getDirectionFactor()),t.markEndSource())}},k0={name:"extendCellsSelectionToColumns",callback(e){const{selection:t}=e,{highlight:n,from:r,to:i}=e.getSelectedRangeActive();t.markSource("keyboard"),t.isSelectedByRowHeader()?t.selectAll(!0,!0):e.selectColumns(r.col,i.col,n),t.markEndSource()}},M0={name:"extendCellsSelectionToMostBottom",callback(e){const{selection:t,rowIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeActive(),a=r.isHeader()&&t.isSelectedByRowHeader();if(r.isCell()||a){const s=n.getNearestNotHiddenIndex(e.countRows()-1,-1),l=i.clone();l.row=r.row,t.markSource("keyboard"),t.setRangeStart(l,void 0,!1,r.clone()),a&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(s,o.col)),t.markEndSource()}}},D0={name:"extendCellsSelectionToMostInlineEnd",callback(e){const{selection:t,columnIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeActive();if(!t.isSelectedByRowHeader()&&!t.isSelectedByCorner()&&r.isCell()){const a=n.getNearestNotHiddenIndex(e.countCols()-1,-1),s=i.clone();s.col=r.col,t.markSource("keyboard"),t.setRangeStart(s,void 0,!1,r.clone()),t.setRangeEnd(e._createCellCoords(o.row,a)),t.markEndSource()}}},_0={name:"extendCellsSelectionToMostInlineStart",callback(e){const{selection:t,columnIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeActive();if(!t.isSelectedByRowHeader()&&!t.isSelectedByCorner()&&r.isCell()){const a=parseInt(e.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(a,1),l=i.clone();l.col=r.col,t.markSource("keyboard"),t.setRangeStart(l,void 0,!1,r.clone()),t.setRangeEnd(e._createCellCoords(o.row,s)),t.markEndSource()}}},O0={name:"extendCellsSelectionToMostLeft",callback(e){const{selection:t,columnIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeActive(),a=r.isHeader()&&t.isSelectedByColumnHeader();if(r.isCell()||a){const s=n.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,t.markSource("keyboard"),t.setRangeStart(l,void 0,!1,r.clone()),a&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(o.row,s)),t.markEndSource()}}},I0={name:"extendCellsSelectionToMostRight",callback(e){const{selection:t,columnIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeActive(),a=r.isHeader()&&t.isSelectedByColumnHeader();if(r.isCell()||a){const s=n.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]),l=i.clone();l.col=r.col,t.markSource("keyboard"),t.setRangeStart(l,void 0,!1,r.clone()),a&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(o.row,s)),t.markEndSource()}}},P0={name:"extendCellsSelectionToMostTop",callback(e){const{selection:t,rowIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeActive(),a=r.isHeader()&&t.isSelectedByRowHeader();if(r.isCell()||a){const s=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,t.markSource("keyboard"),t.setRangeStart(l,void 0,!1,r.clone()),a&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(s,o.col)),t.markEndSource()}}},j0={name:"extendCellsSelectionToRows",callback(e){const{selection:t}=e,{highlight:n,from:r,to:i}=e.getSelectedRangeActive();t.markSource("keyboard"),t.isSelectedByColumnHeader()?t.selectAll(!0,!0):e.selectRows(r.row,i.row,n),t.markEndSource()}},F0={name:"extendCellsSelectionUp",callback(e){const{selection:t}=e,{highlight:n}=e.getSelectedRangeActive();t.isSelectedByColumnHeader()||t.isSelectedByCorner()||!(n.isCell()||n.isHeader()&&t.isSelectedByRowHeader())||(t.markSource("keyboard"),t.transformEnd(-1,0),t.markEndSource())}},H0={name:"extendCellsSelectionUpByViewportHeight",callback(e){const{selection:t,rowIndexMapper:n}=e,{to:r}=e.getSelectedRangeActive(),i=Math.max(r.row-e.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(i,1);if(null!==o){const n=e._createCellCoords(o,r.col),i=r.row-e.getFirstFullyVisibleRow(),a=Math.max(n.row-i,0);t.markSource("keyboard"),t.setRangeEnd(n,e.getActiveSelectionLayerIndex()),t.markEndSource(),e.scrollViewportTo({row:a,verticalSnap:"top",horizontalSnap:"start"})}}};const L0={name:"moveCellSelectionDown",callback(e){let{selection:t}=e;t.markSource("keyboard"),t.transformStart(1,0),t.markEndSource()}},B0={name:"moveCellSelectionDownByViewportHeight",callback(e){const{selection:t}=e,{navigableHeaders:n}=e.getSettings(),r=n?e.countColHeaders():0,{row:i}=e.getSelectedRangeActive().highlight;let o=e.countVisibleRows()+r;o=0===o?1:o,i===e.countRows()-1?o=1:i+o>e.countRows()&&(o=e.countRows()-i-1),t.markSource("keyboard"),t.transformStart(o,0),t.markEndSource(),e.getSelectedRangeActive().highlight.row<0&&e.scrollViewportTo({row:0})}},z0={name:"moveCellSelectionInlineEnd",callback(e,t){const{selection:n}=e,r=e.getSettings(),i=e.getSelectedRange(),o=e.getSelectedRangeActive(),a="function"===typeof r.tabMoves?r.tabMoves(t):r.tabMoves;n.markSource("keyboard"),(i.some(e=>n.isMultiple(e))||i.length>1)&&!o.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0?n.transformFocus(-a.row,-a.col):n.transformStart(-a.row,-a.col),n.markEndSource()}},W0={name:"moveCellSelectionInlineStart",callback(e,t){const{selection:n}=e,r=e.getSettings(),i=e.getSelectedRange(),o=e.getSelectedRangeActive(),a="function"===typeof r.tabMoves?r.tabMoves(t):r.tabMoves;n.markSource("keyboard"),(i.some(e=>n.isMultiple(e))||i.length>1)&&!o.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0?n.transformFocus(a.row,a.col):n.transformStart(a.row,a.col),n.markEndSource()}},V0={name:"moveCellSelectionLeft",callback(e){const{selection:t}=e;t.markSource("keyboard"),t.transformStart(0,-1*e.getDirectionFactor()),t.markEndSource()}},U0={name:"moveCellSelectionRight",callback(e){const{selection:t}=e;t.markSource("keyboard"),t.transformStart(0,e.getDirectionFactor()),t.markEndSource()}},q0={name:"moveCellSelectionToMostBottom",callback(e){const{selection:t}=e,{col:n}=e.getSelectedRangeActive().highlight;let r=e.rowIndexMapper.getNearestNotHiddenIndex(e.countRows()-1,-1);null===r&&(r=-1),t.setRangeStart(e._createCellCoords(r,n))}},G0={name:"moveCellSelectionToMostBottomInlineEnd",callback(e){const{selection:t,rowIndexMapper:n,columnIndexMapper:r}=e,i=parseInt(e.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(e.countRows()-i-1,-1),a=r.getNearestNotHiddenIndex(e.countCols()-1,-1);t.markSource("keyboard"),t.setRangeStart(e._createCellCoords(o,a)),t.markEndSource()}},Y0={name:"moveCellSelectionToMostInlineEnd",callback(e){const{selection:t,columnIndexMapper:n}=e;t.markSource("keyboard"),t.setRangeStart(e._createCellCoords(e.getSelectedRangeActive().highlight.row,n.getNearestNotHiddenIndex(e.countCols()-1,-1))),t.markEndSource()}},K0={name:"moveCellSelectionToMostInlineStart",callback(e){const{selection:t,columnIndexMapper:n}=e,r=parseInt(e.getSettings().fixedColumnsStart,10),i=e.getSelectedRangeActive().highlight.row,o=n.getNearestNotHiddenIndex(r,1);t.markSource("keyboard"),t.setRangeStart(e._createCellCoords(i,o)),t.markEndSource()}},$0={name:"moveCellSelectionToMostLeft",callback(e){const{selection:t,columnIndexMapper:n}=e,r=e.getSelectedRangeActive().highlight.row;let i=n.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]);null===i&&(i=e.isRtl()?-1:-e.countRowHeaders()),t.markSource("keyboard"),t.setRangeStart(e._createCellCoords(r,i)),t.markEndSource()}},X0={name:"moveCellSelectionToMostRight",callback(e){const{selection:t,columnIndexMapper:n}=e,{row:r}=e.getSelectedRangeActive().highlight;let i=n.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]);null===i&&(i=e.isRtl()?-e.countRowHeaders():-1),t.markSource("keyboard"),t.setRangeStart(e._createCellCoords(r,i)),t.markEndSource()}},Q0={name:"moveCellSelectionToMostTop",callback(e){const{selection:t}=e,{col:n}=e.getSelectedRangeActive().highlight;let r=e.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===r&&(r=-e.countColHeaders()),t.markSource("keyboard"),t.setRangeStart(e._createCellCoords(r,n)),t.markEndSource()}},J0={name:"moveCellSelectionToMostTopInlineStart",callback(e){const{selection:t,rowIndexMapper:n,columnIndexMapper:r}=e,i=parseInt(e.getSettings().fixedRowsTop,10),o=parseInt(e.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(i,1),s=r.getNearestNotHiddenIndex(o,1);t.markSource("keyboard"),t.setRangeStart(e._createCellCoords(a,s)),t.markEndSource()}},Z0={name:"moveCellSelectionUp",callback(e){let{selection:t}=e;t.markSource("keyboard"),t.transformStart(-1,0),t.markEndSource()}},e1={name:"moveCellSelectionUpByViewportHight",callback(e){const{selection:t}=e,{navigableHeaders:n}=e.getSettings(),r=n?e.countColHeaders():0,{row:i}=e.getSelectedRangeActive().highlight;let o=e.countVisibleRows()+r;o=0===o?-1:-o,i===-r?o=-1:i+o<r&&(o=-(i+r)),t.markSource("keyboard"),t.transformStart(o,0),t.markEndSource(),e.getSelectedRangeActive().highlight.row<0&&e.scrollViewportTo({row:0})}};const t1={name:"emptySelectedCells",callback(e){e.emptySelectedCells(),e._getEditorManager().prepareEditor()}},n1={name:"scrollToFocusedCell",callback(e){const{highlight:t}=e.getSelectedRangeActive(),n=e.getFirstFullyVisibleRow()-1,r=e.getFirstFullyVisibleColumn()-1,i=e.getLastFullyVisibleRow()+1,o=e.getLastFullyVisibleColumn()+1,a=e._createCellCoords(n,r),s=e._createCellCoords(i,o);if(!e._createCellRange(a,a,s).includes(t)&&(t.row>=0||t.col>=0)){const n={};if(t.col>=0){const r=Math.floor(e.countVisibleCols()/2);n.col=Math.max(t.col-r,0)}if(t.row>=0){const r=Math.floor(e.countVisibleRows()/2);n.row=Math.max(t.row-r,0)}e.scrollViewportTo(E(E({},n),{},{verticalSnap:"top",horizontalSnap:"start"}))}}},r1={name:"selectAllCells",callback(e){let{selection:t}=e;t.markSource("keyboard"),t.selectAll(!0,!0,{disableHeadersHighlight:!0}),t.markEndSource()}},i1={name:"selectAllCellsAndHeaders",callback(e){let{selection:t}=e;t.markSource("keyboard"),t.selectAll(!0,!0,{disableHeadersHighlight:!1}),t.markEndSource()}},o1={name:"populateSelectedCellsData",callback(e){const t=e.getSelectedRange(),{row:n,col:r}=t[t.length-1].highlight.normalize(),i=e.getDataAtCell(n,r),o=new Map;for(let a=0;a<t.length;a++)t[a].forAll((t,a)=>{if(t>=0&&a>=0&&(t!==n||a!==r)){const{readOnly:n}=e.getCellMeta(t,a);n||o.set("".concat(t,"x").concat(a),[t,a,i])}});e.setDataAtCell(Array.from(o.values()))}},a1=[m0,w0,x0,S0,C0,E0,N0,T0,A0,R0,k0,M0,D0,_0,O0,I0,P0,j0,F0,H0,L0,B0,z0,W0,V0,U0,q0,G0,Y0,K0,$0,X0,Q0,J0,Z0,e1,t1,n1,r1,i1,o1,{name:"tabNavigation",callback(e){const t={wrapped:!1,flipped:!1};let n=!1,r=!1;return e.addHook("afterSelection",(e,i,o,a,s)=>{n&&(t.wrapped&&t.flipped||r)&&(r=!1,s.value=!0)}),e.addHook("beforeRowWrap",(e,n,r)=>{t.wrapped=!0,t.flipped=r}),{before(){const{tabNavigation:t}=e.getSettings();n=!0,t||(r=!0)},after(r){const{tabNavigation:i,autoWrapRow:o}=e.getSettings();if(n=!1,!i||!e.selection.isSelected()||o&&t.wrapped&&t.flipped||!o&&t.wrapped)return t.wrapped=!1,t.flipped=!1,e.deselectCell(),!1;r.preventDefault()}}}}];function s1(e){const t={};return a1.forEach(n=>{let{name:r,callback:i}=n;t[r]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return i(e,...n)}}),t}function l1(e){const t=e.getShortcutManager().addContext("editor"),n=s1(e),r={group:ZZ};t.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(e,t)=>n.editorCloseAndSaveByEnter(e,t)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(e,t)=>n.editorCloseAndSaveByEnter(e,t)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:e.getShortcutManager().getContext(QZ),callback:(e,t)=>n.editorCloseAndSave(e,t)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(e,t)=>n.editorCloseAndSaveByArrowKeys(e,t)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function c1(e){const t=e.getShortcutManager().addContext(QZ),n=s1(e),r={runOnlyIf:()=>{const{navigableHeaders:t}=e.getSettings();return nL(e.getSelected())&&(t||!t&&e.countRenderedRows()>0&&e.countRenderedCols()>0)},group:XZ};t.addShortcuts([{keys:[["F2"]],callback:e=>n.editorFastOpen(e)},{keys:[["Enter"],["Enter","Shift"]],callback:(e,t)=>n.editorOpen(e,t)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:ZZ,runOnlyIf:()=>nL(e.getSelected())}),t.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var t;return!(null!==(t=e.getSelectedRangeActive())&&void 0!==t&&t.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var t;return null===(t=e.getSelectedRangeActive())||void 0===t?void 0:t.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var t,n;return!(null!==(t=e.getSelectedRangeActive())&&void 0!==t&&t.highlight.isHeader())&&(null===(n=e.getSelectedRangeActive())||void 0===n?void 0:n.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:e=>n.moveCellSelectionInlineStart(e)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:e=>n.moveCellSelectionInlineEnd(e)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r);const i=n.tabNavigation();t.addShortcuts([{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:XZ,group:JZ,position:"before",callback:e=>i.before(e)},{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:XZ,group:JZ,callback:e=>i.after(e),position:"after"}])}function u1(e){const{classNames:t}=zB(e,/ht-theme-[a-zA-Z0-9_-]+/);return t.pop()}function d1(e,t,n){h1(e,t),t.set(e,n)}function h1(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function f1(e,t){return e.get(p1(e,t))}function m1(e,t,n){return e.set(p1(e,t),n),n}function p1(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var g1=new WeakMap,v1=new WeakMap,y1=new WeakMap,b1=new WeakMap,w1=new WeakMap,x1=new WeakMap,S1=new WeakMap,C1=new WeakMap,E1=new WeakMap,N1=new WeakSet;class T1{constructor(e){let{hot:t,rootElement:n,rootDocument:r,onThemeChange:i=()=>{}}=e;!function(e,t){h1(e,t),t.add(e)}(this,N1),d1(this,g1,void 0),d1(this,v1,void 0),d1(this,y1,void 0),d1(this,b1,void 0),d1(this,w1,void 0),d1(this,x1,!0),d1(this,S1,{}),d1(this,C1,{}),d1(this,E1,void 0),m1(g1,this,t),m1(y1,this,n),m1(w1,this,r),m1(E1,this,i)}isClassicTheme(){return f1(x1,this)}getCSSVariableValue(e){var t;if(f1(x1,this))return null;if(f1(S1,this)["--ht-".concat(e)])return f1(S1,this)["--ht-".concat(e)];const n=null!==(t=p1(N1,this,M1).call(this,"--ht-".concat(e)))&&void 0!==t?t:p1(N1,this,D1).call(this,"--ht-".concat(e));return null!==n?(f1(S1,this)["--ht-".concat(e)]=n,n):void 0}getStyleForTD(e){var t;return null===(t=f1(C1,this))||void 0===t?void 0:t.td[e]}getDefaultRowHeight(e){if(f1(x1,this))return 23;const t=p1(N1,this,A1).call(this);return t?void 0!==e&&e===f1(g1,this).view.getFirstRenderedVisibleRow()?t+1:t:23}areCellsBorderBox(){return"border-box"===this.getStyleForTD("box-sizing")}useTheme(e){if(!e)return m1(v1,this,void 0),m1(x1,this,!0),f1(E1,this).call(this,f1(v1,this)),void p1(N1,this,R1).call(this);if(e&&e!==f1(v1,this)){if(!/ht-theme-.*/.test(e))return hW("Invalid theme name: ".concat(e,". Please provide a valid theme name.")),m1(v1,this,void 0),m1(x1,this,!1),f1(E1,this).call(this,f1(v1,this)),void p1(N1,this,R1).call(this);f1(v1,this)&&p1(N1,this,_1).call(this),m1(v1,this,e),m1(x1,this,!1),f1(E1,this).call(this,f1(v1,this)),p1(N1,this,R1).call(this)}}getThemeName(){return f1(v1,this)}}function A1(){const e=this.getCSSVariableValue("line-height"),t=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return null===e||null===t||isNaN(n)?null:e+2*t+n}function R1(){this.isClassicTheme()||m1(b1,this,getComputedStyle(f1(y1,this)));const e=p1(N1,this,k1).call(this,["box-sizing","border-bottom-width"]);f1(C1,this).td=E(E({},f1(C1,this).td),{"box-sizing":e["box-sizing"],"border-bottom-width":e["border-bottom-width"]})}function k1(e){const t=f1(w1,this),n=f1(y1,this),r=t.createElement("table"),i=t.createElement("tbody"),o=t.createElement("tr"),a=t.createElement("tr"),s=t.createElement("td");a.appendChild(s),i.appendChild(o),i.appendChild(a),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(s),c={};return e.forEach(e=>{c[e]=l.getPropertyValue(e)}),n.removeChild(r),c}function M1(e){const t=Math.ceil(parseFloat(p1(N1,this,D1).call(this,e)));return Number.isNaN(t)?null:t}function D1(e){const t=f1(b1,this).getPropertyValue(e);return""===t?null:t}function _1(){m1(C1,this,{}),m1(S1,this,{}),m1(x1,this,!0)}let O1=null,I1=0;let P1=null;const j1=new WeakSet,F1=new Map;new Set;function H1(e,t){var n,r,i=this;let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this;const s=new $W(a);let l,c,u,d,h,f,m=!0;const p=E(E({},t.initialState),t);var g;EY(o)&&(g=this,SY.set(g,!0)),this.rootContainer=e,this.rootWrapperElement=void 0,this.rootGridElement=void 0,this.rootPortalElement=void 0,this.rootElement=NY(this)?e.ownerDocument.createElement("div"):e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,NY(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootGridElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),KB(this.rootElement,["ht-wrapper","handsontable"]),KB(this.rootWrapperElement,"ht-root-wrapper"),KB(this.rootGridElement,"ht-grid"),this.rootGridElement.appendChild(this.rootElement),this.rootWrapperElement.appendChild(this.rootGridElement),this.rootContainer.appendChild(this.rootWrapperElement),KB(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const v=null!==(n=null===p||void 0===p?void 0:p.layoutDirection)&&void 0!==n?n:"inherit",y=["rtl","ltr"].includes(v)?v:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",y),null===(r=this.rootWrapperElement)||void 0===r||r.setAttribute("dir",y),this.isRtl=function(){return"rtl"===y},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},this.stylesHandler=new T1({hot:a,rootElement:a.rootElement,rootDocument:a.rootDocument,onThemeChange:e=>{NY(this)&&($B(this.rootWrapperElement,/ht-theme-.*/g),$B(this.rootPortalElement,/ht-theme-.*/g),e&&(KB(this.rootWrapperElement,e),KB(this.rootPortalElement,e),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||hW('The "'.concat(e,'" theme is enabled, but its stylesheets are missing or not imported correctly.               Import the correct CSS files in order to use that theme.'))))}}),p.language=function(e){let t=UK(e);return tQ(t)||(t=KX,qK(e)),t}(p.language);const b=Object.fromEntries(Object.entries(p).filter(e=>{let[t]=e;return!(_W.getSingleton().isRegistered(t)||_W.getSingleton().isDeprecated(t))})),w=new GJ(a,b,[KJ,ZJ]),x=w.getTableMeta(),S=w.getGlobalMeta(),C=CV();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),this.guid="ht_".concat(wL()),F1.set(this.guid,this),this.columnIndexMapper=new WK,this.rowIndexMapper=new WK,this.columnIndexMapper.addLocalHook("indexesSequenceChange",e=>{a.runHooks("afterColumnSequenceChange",e)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",e=>{a.runHooks("afterRowSequenceChange",e)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",e=>{a.runHooks("beforeCompositionStart",e)}),c=new rK(a);const N=PW(this.guid);N.register("cellRangeMapper",new vZ({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);let T=new CJ(x,{rowIndexMapper:a.rowIndexMapper,columnIndexMapper:a.columnIndexMapper,countCols:()=>a.countCols(),countRows:()=>a.countRows(),propToCol:e=>l.propToCol(e),isEditorOpened:()=>!!a.getActiveEditor()&&a.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>a.getShortcutManager(),createCellCoords:(e,t)=>a._createCellCoords(e,t),createCellRange:(e,t,n)=>a._createCellRange(e,t,n),visualToRenderableCoords:e=>{const{row:t,col:n}=e;return a._createCellCoords(t>=0?a.rowIndexMapper.getRenderableFromVisualIndex(t):t,n>=0?a.columnIndexMapper.getRenderableFromVisualIndex(n):n)},renderableToVisualCoords:e=>{const{row:t,col:n}=e;return a._createCellCoords(t>=0?a.rowIndexMapper.getVisualFromRenderableIndex(t):t,n>=0?a.columnIndexMapper.getVisualFromRenderableIndex(n):n)},findFirstNonHiddenRenderableRow:(e,t)=>{const n=t>e?1:-1,r=Math.min(e,t),i=Math.max(e,t),o=a.rowIndexMapper.getNearestNotHiddenIndex(e,n);return null===o||1===n&&o>i||-1===n&&o<r?null:o>=0?a.rowIndexMapper.getRenderableFromVisualIndex(o):o},findFirstNonHiddenRenderableColumn:(e,t)=>{const n=t>e?1:-1,r=Math.min(e,t),i=Math.max(e,t),o=a.columnIndexMapper.getNearestNotHiddenIndex(e,n);return null===o||1===n&&o>i||-1===n&&o<r?null:o>=0?a.columnIndexMapper.getRenderableFromVisualIndex(o):o},isDisabledCellSelection:(e,t)=>e<0||t<0?a.getSettings().disableVisualSelection:a.getCellMeta(e,t).disableVisualSelection});this.selection=T;const A=e=>{let{hiddenIndexesChanged:t}=e;this.forceFullRender=!0,t&&this.selection.commit()};function R(e,t){const n="className"===e?a.rootElement:a.table;if(m)KB(n,t);else{let r=[],i=[];S[e]&&(r=Array.isArray(S[e])?S[e]:JH(S[e])),t&&(i=Array.isArray(t)?t:JH(t));const o=$H(r,i),a=$H(i,r);o.length&&$B(n,o),a.length&&KB(n,a)}S[e]=t}function k(){let e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function M(e,t,n){if(!e.length)return void n();const r=a.getActiveEditor(),i=new k;let o=!0;i.onQueueEmpty=()=>{r&&o&&r.cancelChanges(),n()};for(let s=e.length-1;s>=0;s--){const[n,r,,c]=e[s],u=l.propToCol(r);let d;d=Number.isInteger(u)?a.getCellMeta(n,u):E(E({},Object.getPrototypeOf(x)),x),a.getCellValidator(d)&&(i.addValidatorToQueue(),a.validateCell(c,d,function(t,n){return function(r){if("boolean"!==typeof r)throw new Error("Validation error: result is not boolean");!1===r&&!1===n.allowInvalid&&(o=!1,e.splice(t,1),n.valid=!0),i.removeValidatorFormQueue()}}(s,d),t))}i.checkIfQueueIsEmpty()}function D(e,t){for(let n=e.length-1;n>=0;n--){let t=!1;if(null!==e[n]){if(null!==e[n][2]&&void 0!==e[n][2]||null!==e[n][3]&&void 0!==e[n][3]){if(x.allowInsertRow)for(;e[n][0]>a.countRows()-1;){const{delta:e}=l.createRow(void 0,void 0,{source:"auto"});if(0===e){t=!0;break}}if("array"===a.dataType&&(!x.columns||0===x.columns.length)&&x.allowInsertColumn)for(;l.propToCol(e[n][1])>a.countCols()-1;){const{delta:e}=l.createCol(void 0,void 0,{source:"auto"});if(0===e){t=!0;break}}t||l.set(e[n][0],e[n][1],e[n][3])}}else e.splice(n,1)}if(e.length>0){u.adjustRowsAndCols(),a.runHooks("beforeChangeRender",e,t),d.closeEditor(),a.view.adjustElementsSize(),a.render(),d.prepareEditor(),a.runHooks("afterChange",e,t||"edit");const n=a.getActiveEditor();n&&nL(n.refreshValue)&&n.refreshValue()}else a.render()}function _(e,t,n){return Array.isArray(e)?e:[[e,t,n]]}function O(e,t){const n=a.runHooks("beforeChange",e,t||"edit"),r=e.filter(e=>null!==e);var i;if(!1===n||0===r.length)return null===(i=a.getActiveEditor())||void 0===i||i.cancelChanges(),[];for(let o=r.length-1;o>=0;o--){const[e,t,,n]=r[o],i=l.propToCol(t);let s;s=Number.isInteger(i)?a.getCellMeta(e,i):E(E({},Object.getPrototypeOf(x)),x),r[o][3]=iZ(n,s)}return r}this.columnIndexMapper.addLocalHook("cacheUpdated",e=>{A(e),this.runHooks("afterColumnSequenceCacheUpdate",e)}),this.rowIndexMapper.addLocalHook("cacheUpdated",e=>{A(e),this.runHooks("afterRowSequenceCacheUpdate",e)}),this.selection.addLocalHook("afterSetRangeEnd",(e,t)=>{const n=sB(!1),r=this.selection.getSelectedRange(),{from:i,to:o}=r.current(),s=r.size()-1;this.runHooks("afterSelection",i.row,i.col,o.row,o.col,n,s),this.runHooks("afterSelectionByProp",i.row,a.colToProp(i.col),o.row,a.colToProp(o.col),n,s),t&&(!n.isTouched()||n.isTouched()&&!n.value)&&f.scrollTo(e);const l=T.isSelectedByRowHeader(),c=T.isSelectedByColumnHeader();l&&c?KB(this.rootElement,["ht__selection--rows","ht__selection--columns"]):l?($B(this.rootElement,"ht__selection--columns"),KB(this.rootElement,"ht__selection--rows")):c?($B(this.rootElement,"ht__selection--rows"),KB(this.rootElement,"ht__selection--columns")):$B(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(T.getSelectionSource())||d.closeEditor(null),"refresh"!==T.getSelectionSource()&&(a.view.render(),d.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",e=>{this.runHooks("beforeSelectionFocusSet",e.row,e.col)}),this.selection.addLocalHook("afterSetFocus",e=>{const t=sB(!1);this.runHooks("afterSelectionFocusSet",e.row,e.col,t),(!t.isTouched()||t.isTouched()&&!t.value)&&f.scrollTo(e),d.closeEditor(),a.view.render(),d.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",e=>{const t=e.length-1,{from:n,to:r}=e[t];this.runHooks("afterSelectionEnd",n.row,n.col,r.row,r.col,t),this.runHooks("afterSelectionEndByProp",n.row,a.colToProp(n.col),r.row,a.colToProp(r.col),t),"refresh"===T.getSelectionSource()&&(a.view.render(),d.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",e=>{const t=this.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)}),this.selection.addLocalHook("afterDeselect",()=>{d.closeEditor(),a.view.render(),$B(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runHooks("beforeSetRangeStart",...t)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runHooks("beforeSetRangeStartOnly",...t)}).addLocalHook("beforeSetRangeEnd",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runHooks("beforeSetRangeEnd",...t)}).addLocalHook("beforeSelectColumns",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runHooks("beforeSelectColumns",...t)}).addLocalHook("afterSelectColumns",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runHooks("afterSelectColumns",...t)}).addLocalHook("beforeSelectRows",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runHooks("beforeSelectRows",...t)}).addLocalHook("afterSelectRows",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runHooks("afterSelectRows",...t)}).addLocalHook("beforeSelectAll",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runHooks("beforeSelectAll",...t)}).addLocalHook("afterSelectAll",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runHooks("afterSelectAll",...t)}).addLocalHook("beforeModifyTransformStart",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runHooks("modifyTransformStart",...t)}).addLocalHook("afterModifyTransformStart",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runHooks("afterModifyTransformStart",...t)}).addLocalHook("beforeModifyTransformFocus",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runHooks("modifyTransformFocus",...t)}).addLocalHook("afterModifyTransformFocus",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runHooks("afterModifyTransformFocus",...t)}).addLocalHook("beforeModifyTransformEnd",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runHooks("modifyTransformEnd",...t)}).addLocalHook("afterModifyTransformEnd",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runHooks("afterModifyTransformEnd",...t)}).addLocalHook("beforeRowWrap",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runHooks("beforeRowWrap",...t)}).addLocalHook("beforeColumnWrap",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runHooks("beforeColumnWrap",...t)}).addLocalHook("insertRowRequire",e=>this.alter("insert_row_above",e,1,"auto")).addLocalHook("insertColRequire",e=>this.alter("insert_col_start",e,1,"auto")),u={alter(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;const o=e=>{if(0===e.length)return[];const t=[...e];t.sort((e,t)=>{let[n]=e,[r]=t;return n===r?0:n>r?1:-1});return LH(t,(e,t)=>{let[n,r]=t;const i=e[e.length-1],[o,a]=i,s=o+a;if(n<=s){const e=Math.max(r-(s-n),0);i[1]+=e}else e.push([n,r]);return e},[t[0]])};switch(e){case"insert_row_below":case"insert_row_above":const i=a.countSourceRows();if(x.maxRows===i)return;const s="insert_row_below"===e?"below":"above";t=null!==t&&void 0!==t?t:"below"===s?i:0;const{delta:c,startPhysicalIndex:u}=l.createRow(t,n,{source:r,mode:s});T.shiftRows(a.toVisualRow(u),c);break;case"insert_col_start":case"insert_col_end":const h="insert_col_end"===e?"end":"start";t=null!==t&&void 0!==t?t:"end"===h?a.countSourceCols():0;const{delta:f,startPhysicalIndex:m}=l.createCol(t,n,{source:r,mode:h});if(f){if(Array.isArray(x.colHeaders)){const e=[a.toVisualColumn(m),0];e.length+=f,Array.prototype.splice.apply(x.colHeaders,e)}T.shiftColumns(a.toVisualColumn(m),f)}break;case"remove_row":const p=e=>{let t=0;WH(e,e=>{let[n,i]=e;const o=iL(n)?a.countRows()-1:Math.max(n-t,0);Number.isInteger(n)&&(n=Math.max(n-t,0));if(!l.removeRow(n,i,r))return;if(T.isSelected()){const{row:e}=a.getSelectedRangeActive().highlight;e>=n&&e<=n+i-1&&d.closeEditor(!0)}const s=a.countRows(),c=x.fixedRowsTop;c>=o+1&&(x.fixedRowsTop-=Math.min(i,c-o));const u=x.fixedRowsBottom;if(u&&o>=s-u&&(x.fixedRowsBottom-=Math.min(i,u)),0===s)T.deselect();else if("ContextMenu.removeRow"===r){const e=T.getSelectedRange(),t=e.pop();e.clear().set(t.from).current().setTo(t.to),T.refresh()}else T.shiftRows(n,-i);t+=i})};Array.isArray(t)?p(o(t)):p([[t,n]]);break;case"remove_col":const g=e=>{let t=0;WH(e,e=>{let[n,i]=e;const o=iL(n)?a.countCols()-1:Math.max(n-t,0);let s=a.toPhysicalColumn(o);Number.isInteger(n)&&(n=Math.max(n-t,0));if(!l.removeCol(n,i,r))return;if(T.isSelected()){const{col:e}=a.getSelectedRangeActive().highlight;e>=n&&e<=n+i-1&&d.closeEditor(!0)}if(0===a.countCols())T.deselect();else if("ContextMenu.removeColumn"===r){const e=T.getSelectedRange(),t=e.pop();e.clear().set(t.from).current().setTo(t.to),T.refresh()}else T.shiftColumns(n,-i);const c=x.fixedColumnsStart;c>=o+1&&(x.fixedColumnsStart-=Math.min(i,c-o)),Array.isArray(x.colHeaders)&&("undefined"===typeof s&&(s=-1),x.colHeaders.splice(s,i)),t+=i})};Array.isArray(t)?g(o(t)):g([[t,n]]);break;default:throw new Error('There is no such action "'.concat(e,'"'))}i||u.adjustRowsAndCols(),a.view.adjustElementsSize(),a.view.render()},adjustRowsAndCols(){const e=x.minRows,t=x.minSpareRows,n=x.minCols,r=x.minSpareCols;if(e){const t=a.countRows();t<e&&l.createRow(t,e-t,{source:"auto"})}if(t){const e=a.countEmptyRows(!0);if(e<t){const n=t-e,r=Math.min(n,x.maxRows-a.countSourceRows());l.createRow(a.countRows(),r,{source:"auto"})}}{let e;(n||r)&&(e=a.countEmptyCols(!0));let t=a.countCols();if(n&&!x.columns&&t<n){const r=n-t;e+=r,l.createCol(t,r,{source:"auto"})}if(r&&!x.columns&&"array"===a.dataType&&e<r){t=a.countCols();const n=r-e,i=Math.min(n,x.maxCols-t);l.createCol(t,i,{source:"auto"})}}},populateFromArray(e,t,n,r,i){let o,s,l,c;const u=[],d={},h=[],f=e.row,m=e.col;if(s=t.length,0===s)return!1;let p=0,g=0;switch(tB(n)&&(p=n.col-m+1,g=n.row-f+1),i){case"shift_down":const i=HH(t),y=i.length,b=Math.max(y,p),w=a.getData().slice(f),S=HH(w).slice(m,m+b);for(l=0;l<b;l+=1)if(l<y){for(o=0,s=i[l].length;o<g-s;o+=1)i[l].push(i[l][o%s]);l<S.length?h.push(i[l].concat(S[l])):h.push(i[l].concat(new Array(w.length).fill(null)))}else h.push(i[l%y].concat(S[l]));a.populateFromArray(f,m,HH(h));break;case"shift_right":const C=t.length,E=Math.max(C,g),N=a.getData().slice(f).map(e=>e.slice(m));for(o=0;o<E;o+=1)if(o<C){for(l=0,c=t[o].length;l<p-c;l+=1)t[o].push(t[o][l%c]);if(o<N.length)for(let e=0;e<N[o].length;e+=1)t[o].push(N[o][e]);else t[o].push(...new Array(N[0].length).fill(null))}else t.push(t[o%s].slice(0,E).concat(N[o]));a.populateFromArray(f,m,t);break;default:d.row=e.row,d.col=e.col;let T,A=0,R=0,k=!0;const M=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const r=t[e%t.length];return null!==n?r[n%r.length]:r},D=t.length,_=n?n.row-e.row+1:0;for(s=n?_:Math.max(D,_),o=0;o<s&&!(n&&d.row>n.row&&_>D||!x.allowInsertRow&&d.row>a.countRows()-1||d.row>=x.maxRows);o++){const t=o-A,i=M(t).length,h=n?n.col-e.col+1:0;if(c=n?h:Math.max(i,h),d.col=e.col,T=a.getCellMeta(d.row,d.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!T.skipRowOnPaste){for(R=0,l=0;l<c;l++){var v;if(n&&d.col>n.col&&h>i||!x.allowInsertColumn&&d.col>a.countCols()-1||d.col>=x.maxCols)break;if(T=a.getCellMeta(d.row,d.col),("CopyPaste.paste"===r||"Autofill.fill"===r)&&T.skipColumnOnPaste){R+=1,d.col+=1,c+=1;continue}if(T.readOnly&&"UndoRedo.undo"!==r){d.col+=1;continue}const e=l-R,o=!!T.valueSetter;let s=M(t,e),f=null!==(v=a.getSourceDataAtCell(d.row,d.col))&&void 0!==v?v:null;if(null!==s&&"object"===typeof s)if(Array.isArray(s)&&null===f&&(f=[]),o||"object"===typeof f&&null!==f){if(null!==f){const e=YL(Array.isArray(f)?f:f[0]||f),t=YL(Array.isArray(s)?s:s[0]||s);o||eB(e,t)||Array.isArray(e)&&Array.isArray(t)?s=QL(s):k=!1}}else k=!1;else o||null===f||"object"!==typeof f||(k=!1);k&&u.push([d.row,d.col,s]),k=!0,d.col+=1}d.row+=1}else A+=1,d.row+=1,s+=1}a.setDataAtCell(u,null,null,r||"populateFromArray")}}},this.init=function(){c.setData(x.data),a.runHooks("beforeInit"),(RB()||MB())&&KB(a.rootElement,"mobile"),this.updateSettings(p,!0),this.view=new UY(this),d=iV.getInstance(a,x,T),f=SZ(a),h.init(),NY(this)&&(!function(e){const t=e.ownerDocument;if(!O1){O1=t.createElement("div"),O1.setAttribute("role","status"),O1.setAttribute("aria-live","assertive"),O1.setAttribute("aria-atomic","true");const n=O1.style;n.position="absolute",n.width="1px",n.height="1px",n.margin="-1px",n.overflow="hidden",n.clipPath="rect(0 0 0 0)",n.whiteSpace="nowrap",e.appendChild(O1)}I1+=1}(a.rootPortalElement),vL(p.licenseKey,this.rootWrapperElement)),a.runHooks("init"),this.render(),m&&null===a.rootElement.offsetParent&&Lz(a.rootElement,()=>{a.view._wt.wtOverlays.updateLastSpreaderSize(),a.view.adjustElementsSize(),a.render()}),"object"===typeof m&&(a.runHooks("afterChange",m[0],m[1]),m=!1),a.runHooks("afterInit")},this._createCellCoords=function(e,t){return a.view._wt.createCellCoords(e,t)},this._createCellRange=function(e,t,n){return a.view._wt.createCellRange(e,t,n)},this.validateCell=function(e,t,n,r){let i=a.getCellValidator(t);function o(e){if(!(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])||!0===t.hidden)return void n(e);const r=t.visualCol,i=t.visualRow,o=a.getCell(i,r,!0);if(o&&"TH"!==o.nodeName){const e=a.rowIndexMapper.getRenderableFromVisualIndex(i),t=a.columnIndexMapper.getRenderableFromVisualIndex(r);a.view._wt.getSetting("cellRenderer",e,t,o)}n(e)}var s;oL(i)&&(s=i,i=function(e,t){t(s.test(e))}),Uz(i)?(e=a.runHooks("beforeValidate",e,t.visualRow,t.prop,r),a._registerImmediate(()=>{i.call(t,e,n=>{a&&(n=a.runHooks("afterValidate",n,e,t.visualRow,t.prop,r),t.valid=n,o(n),a.runHooks("postAfterValidate",n,e,t.visualRow,t.prop,r))})})):a._registerImmediate(()=>{t.valid=!0,o(t.valid,!1)})},this.setDataAtCell=function(e,t,n,r){const i=_(e,t,n),o=[];let s,u,d,h=r;for(s=0,u=i.length;s<u;s++){const[e,t,n]=i[s];if("object"!==typeof i[s])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!==typeof t)throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");d=t>=this.countCols()?t:l.colToProp(t),o.push([e,d,c.getAtCell(this.toPhysicalRow(e),t),n])}h||"object"!==typeof e||(h=t);const f=O(o,h);a.runHooks("afterSetDataAtCell",f,h),M(f,h,()=>{D(f,h)})},this.setDataAtRowProp=function(e,t,n,r){const i=_(e,t,n),o=[];let s,l,u=r;for(s=0,l=i.length;s<l;s++){const[e,t,n]=i[s];o.push([e,t,c.getAtCell(this.toPhysicalRow(e),t),n])}u||"object"!==typeof e||(u=t);const d=O(o,r);a.runHooks("afterSetDataAtRowProp",d,u),M(d,u,()=>{D(d,u)})},this.listen=function(){a&&!a.isListening()&&(F1.forEach(e=>{a!==e&&e.unlisten()}),P1=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(P1=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return P1===a.guid},this.destroyEditor=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];d.closeEditor(e),a.view.render(),t&&T.isSelected()&&d.prepareEditor()},this.populateFromArray=function(e,t,n,r,i,o,s){if("object"!==typeof n||"object"!==typeof n[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");const l="number"===typeof r?a._createCellCoords(r,i):null;return u.populateFromArray(a._createCellCoords(e,t),n,l,o,s)},this.spliceCol=function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];return l.spliceCol(e,t,n,...i)},this.spliceRow=function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];return l.spliceRow(e,t,n,...i)},this.getSelected=function(){if(T.isSelected())return zH(T.getSelectedRange(),e=>{let{from:t,to:n}=e;return[t.row,t.col,n.row,n.col]})},this.getSelectedLast=function(){const e=this.getSelected();let t;return e&&e.length>0&&(t=e[e.length-1]),t},this.getSelectedActive=function(){const e=this.getSelectedRangeActive();if(!e)return;const{from:t,to:n}=e;return[t.row,t.col,n.row,n.col]},this.getSelectedRange=function(){if(T.isSelected())return Array.from(T.getSelectedRange())},this.getSelectedRangeLast=function(){const e=this.getSelectedRange();let t;return e&&e.length>0&&(t=e[e.length-1]),t},this.getSelectedRangeActive=function(){return T.getActiveSelectedRange()},this.getActiveSelectionLayerIndex=function(){return T.getActiveSelectionLayerIndex()},this.emptySelectedCells=function(e){if(!T.isSelected()||0===this.countRows()||0===this.countCols())return;const t=[];WH(T.getSelectedRange(),e=>{if(e.isSingleHeader())return;const n=e.getTopStartCorner(),r=e.getBottomEndCorner();hV(n.row,r.row,e=>{hV(n.col,r.col,n=>{this.getCellMeta(e,n).readOnly||t.push([e,n,null])})})}),t.length>0&&this.setDataAtCell(t,e)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||a.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||a.view.render())},this.batchRender=function(e){this.suspendRender();const t=e();return this.resumeRender(),t},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();const n=e();return this.resumeExecution(t),n},this.batch=function(e){this.suspendRender(),this.suspendExecution();const t=e();return this.resumeExecution(),this.resumeRender(),t},this.refreshDimensions=function(){if(!a.view)return;const e=a.view,{width:t,height:n}=e.getLastSize(),{width:r,height:i}=a.rootElement.getBoundingClientRect(),o=r!==t||i!==n;!1===a.runHooks("beforeRefreshDimensions",{width:t,height:n},{width:r,height:i},o)||((o||e._wt.wtOverlays.scrollableElement===a.rootWindow)&&(e.setLastSize(r,i),e.adjustElementsSize(),a.render()),a.runHooks("afterRefreshDimensions",{width:t,height:n},{width:r,height:i},o))},this.updateData=function(e,t){lZ(e,e=>{l=e},e=>{l=e,a.columnIndexMapper.fitToLength(this.getInitialColumnCount()),a.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),T.refresh()},{hotInstance:a,dataMap:l,dataSource:c,internalSource:"updateData",source:t,metaManager:w,firstRun:m})},this.loadData=function(e,t){lZ(e,e=>{l=e},()=>{w.clearCellsCache(),a.initIndexMappers(),u.adjustRowsAndCols(),T.refresh(),m&&(m=[null,"loadData"])},{hotInstance:a,dataMap:l,dataSource:c,internalSource:"loadData",source:t,metaManager:w,firstRun:m})},this.getInitialColumnCount=function(){const e=x.columns;let t=0;if(Array.isArray(e))t=e.length;else if(Uz(e))if("array"===a.dataType){const n=this.countSourceCols();for(let r=0;r<n;r+=1)e(r)&&(t+=1)}else"object"!==a.dataType&&"function"!==a.dataType||(t=l.colToPropCache.length);else if(nL(x.dataSchema)){const e=l.getSchema();t=Array.isArray(e)?e.length:aB(e)}else t=this.countSourceCols();return t},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,n,r){return rL(e)?l.getAll():l.getRange(a._createCellCoords(e,t),a._createCellCoords(n,r),l.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,n,r){return l.getCopyableText(a._createCellCoords(e,t),a._createCellCoords(n,r))},this.getCopyableData=function(e,t){return l.getCopyable(e,l.colToProp(t))},this.getCopyableSourceData=function(e,t){return c.getCopyable(e,l.colToProp(t))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(m?a.loadData:a.updateData).bind(this);let r,i,o=!1;if(nL(e.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(nL(e.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(nL(e.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(r in nL(e.rowHeights)&&nL(e.minRowHeights)&&hW("Both `rowHeights` and `minRowHeights` are defined in your configuration. As one is the alias of the other, only one of them can be used at a time. `rowHeights` will be used as the row height configuration."),e)if("data"===r||"language"===r);else if("className"===r)R("className",e.className);else if("tableClassName"===r&&a.table)R("tableClassName",e.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames();else if(_W.getSingleton().isRegistered(r)||_W.getSingleton().isDeprecated(r)){const t=e[r];Uz(t)?(_W.getSingleton().addAsFixed(r,t,a),x[r]=t):Array.isArray(t)&&(_W.getSingleton().add(r,t,a),x[r]=t)}else!t&&lB(e,r)&&(S[r]=e[r]);if(t)a.useTheme(x.themeName||u1(a.rootContainer));else{const t=a.getCurrentThemeName();lB(e,"themeName")&&t!==e.themeName&&a.useTheme(e.themeName)}j1.has(a)&&void 0!==a.stylesHandler.getThemeName()&&j1.delete(a),NY(a)&&!j1.has(a)&&a.stylesHandler.isClassicTheme()&&(fW("The stylesheet you are using is deprecated and will be removed in version 17.0. Please update your theme configuration to ensure compatibility with future releases."),j1.add(a)),void 0===e.data&&void 0===x.data?n(null,"updateSettings"):void 0!==e.data?n(e.data,"updateSettings"):void 0!==e.columns&&(l.createMap(),a.initIndexMappers()),!m&&e.language&&function(e){const t=UK(e);tQ(t)?(a.runHooks("beforeLanguageChange",t),S.language=t,a.runHooks("afterLanguageChange",t)):qK(e)}(e.language);const s=a.countCols(),c=x.columns;if(c&&Uz(c)&&(o=!0),void 0===e.cell&&void 0===e.cells&&void 0===e.columns||w.clearCache(),s>0)for(r=0,i=0;r<s;r++){if(c){const e=o?c(r):c[i];e&&w.updateColumnMeta(i,e)}i+=1}nL(e.cell)&&rB(e.cell,e=>{a.setCellMetaObject(e.row,e.col,e)}),a.runHooks("afterCellMetaReset");let d=a.rootElement.style.height;if(""!==d&&(d=parseInt(a.rootElement.style.height,10)),t){a.rootElement.getAttribute("style")&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"))}let h=e.height;if("undefined"!==typeof e.height)if(Uz(h)&&(h=h()),h=a.runHooks("beforeHeightChange",h),null===h){const e=a.rootElement.getAttribute("data-initialstyle");e&&(e.indexOf("height")>-1||e.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",e):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else void 0!==h&&(a.rootElement.style.height=isNaN(h)?"".concat(h):"".concat(h,"px"),a.rootElement.style.overflow="hidden");if("undefined"!==typeof e.width){let t=e.width;Uz(t)&&(t=t()),t=a.runHooks("beforeWidthChange",t),a.rootElement.style.width=isNaN(t)?"".concat(t):"".concat(t,"px")}t||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",e)),u.adjustRowsAndCols(),a.view&&!m&&(a.render(),a.view._wt.wtOverlays.adjustElementsSize()),t||!a.view||""!==d&&""!==h&&void 0!==h||d===h||a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const e=a.getSelectedRangeActive();if(x.getValue){if(Uz(x.getValue))return x.getValue.call(a);if(e)return a.getData()[e.highlight.row][x.getValue]}else if(e)return a.getDataAtCell(e.highlight.row,e.highlight.col);return null},this.getSettings=function(){return x},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,n,r,i){u.alter(e,t,n,r,i)},this.getCell=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t,i=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;i=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===i||null===r||void 0===i||void 0===r?null:a.view.getCellAtCoords(a._createCellCoords(i,r),n)},this.getCoords=function(e){const t=this.view._wt.wtTable.getCoords(e);if(null===t)return null;const{row:n,col:r}=t;let i=n,o=r;return n>=0&&(i=this.rowIndexMapper.getVisualFromRenderableIndex(n)),r>=0&&(o=this.columnIndexMapper.getVisualFromRenderableIndex(r)),a._createCellCoords(i,o)},this.colToProp=function(e){return l.colToProp(e)},this.propToCol=function(e){return l.propToCol(e)},this.toVisualRow=e=>this.rowIndexMapper.getVisualFromPhysicalIndex(e),this.toVisualColumn=e=>this.columnIndexMapper.getVisualFromPhysicalIndex(e),this.toPhysicalRow=e=>this.rowIndexMapper.getPhysicalFromVisualIndex(e),this.toPhysicalColumn=e=>this.columnIndexMapper.getPhysicalFromVisualIndex(e),this.getDataAtCell=function(e,t){return l.get(e,l.colToProp(t))},this.getDataAtRowProp=function(e,t){return l.get(e,t)},this.getDataAtCol=function(e){const t=[],n=l.getRange(a._createCellCoords(0,e),a._createCellCoords(x.data.length-1,e),l.DESTINATION_RENDERER);for(let r=0;r<n.length;r+=1)for(let e=0;e<n[r].length;e+=1)t.push(n[r][e]);return t},this.getDataAtProp=function(e){const t=[],n=l.getRange(a._createCellCoords(0,l.propToCol(e)),a._createCellCoords(x.data.length-1,l.propToCol(e)),l.DESTINATION_RENDERER);for(let r=0;r<n.length;r+=1)for(let e=0;e<n[r].length;e+=1)t.push(n[r][e]);return t},this.getSourceData=function(e,t,n,r){let i;return i=void 0===e?c.getData():c.getByRange(a._createCellCoords(e,t),a._createCellCoords(n,r)),i},this.getSourceDataArray=function(e,t,n,r){let i;return i=void 0===e?c.getData(!0):c.getByRange(a._createCellCoords(e,t),a._createCellCoords(n,r),!0),i},this.getSourceDataAtCol=function(e){return c.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,n,r){const i=_(e,t,n),o=this.hasHook("afterSetSourceDataAtCell"),s=[],l=(e,t)=>{const n=this.toVisualRow(e),r=this.toVisualColumn(t);return Number.isInteger(r)?this.getCellMeta(n,r):E(E({},Object.getPrototypeOf(x)),x)};o&&WH(i,e=>{let[t,n,r]=e;const i=iZ(r,l(t,n));s.push([t,n,c.getAtCell(t,n),i])}),WH(i,e=>{let[t,n,r]=e;const i=iZ(r,l(t,n));c.setAtCell(t,n,i)}),o&&this.runHooks("afterSetSourceDataAtCell",s,r),this.render();const u=a.getActiveEditor();u&&nL(u.refreshValue)&&u.refreshValue()},this.getSourceDataAtRow=function(e){return c.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return c.getAtCell(e,t)},this.getDataAtRow=function(e){return l.getRange(a._createCellCoords(e,0),a._createCellCoords(e,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,n,r){const i=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,n,r],[o,a]=i;let[,,s,l]=i,c=null,u=null;void 0===s&&(s=o),void 0===l&&(l=a);let d="mixed";return hV(Math.max(Math.min(o,s),0),Math.max(o,s),e=>{let t=!0;return hV(Math.max(Math.min(a,l),0),Math.max(a,l),n=>{const r=this.getCellMeta(e,n);return u=r.type,c?t=c===u:c=u,t}),d=t?u:"mixed",t}),d},this.removeCellMeta=function(e,t,n){const[r,i]=[this.toPhysicalRow(e),this.toPhysicalColumn(t)];let o=w.getCellMetaKeyValue(r,i,n);!1!==a.runHooks("beforeRemoveCellMeta",e,t,n,o)&&(w.removeCellMeta(r,i,n),a.runHooks("afterRemoveCellMeta",e,t,n,o)),o=null},this.spliceCellsMeta=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(r.length>0&&!Array.isArray(r[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");t>0&&w.removeRow(this.toPhysicalRow(e),t),r.length>0&&WH(r.reverse(),t=>{w.createRow(this.toPhysicalRow(e)),WH(t,(t,n)=>this.setCellMetaObject(e,n,t))}),a.render()},this.setCellMetaObject=function(e,t,n){"object"===typeof n&&rB(n,(n,r)=>{this.setCellMeta(e,t,r,n)})},this.setCellMeta=function(e,t,n,r){if(!1===a.runHooks("beforeSetCellMeta",e,t,n,r))return;let i=e,o=t;e<this.countRows()&&(i=this.toPhysicalRow(e)),t<this.countCols()&&(o=this.toPhysicalColumn(t)),w.setCellMeta(i,o,n,r),a.runHooks("afterSetCellMeta",e,t,n,r)},this.getCellsMeta=function(){return w.getCellsMeta()},this.getCellMeta=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipMetaExtension:!1},r=this.toPhysicalRow(e),i=this.toPhysicalColumn(t);return null===r&&(r=e),null===i&&(i=t),w.getCellMeta(r,i,E({visualRow:e,visualColumn:t},n))},this.getColumnMeta=function(e){return w.getColumnMeta(this.toPhysicalColumn(e))},this.getCellMetaAtRow=function(e){return w.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===a.dataType||x.columns)},this.getCellRenderer=function(e,t){const n="number"===typeof e?a.getCellMeta(e,t).renderer:e.renderer;return"string"===typeof n?FV(n):rL(n)?FV("text"):n},this.getCellEditor=function(e,t){const n="number"===typeof e?a.getCellMeta(e,t).editor:e.editor;return"string"===typeof n?qW(n):rL(n)?qW("text"):n},this.getCellValidator=function(e,t){const n="number"===typeof e?a.getCellMeta(e,t).validator:e.validator;return"string"===typeof n?UV(n):n},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,n){const r=new k;e&&(r.onQueueEmpty=e);let i=a.countRows()-1;for(;i>=0;){if(void 0!==t&&-1===t.indexOf(i)){i-=1;continue}let e=a.countCols()-1;for(;e>=0;)void 0===n||-1!==n.indexOf(e)?(r.addValidatorToQueue(),a.validateCell(a.getDataAtCell(i,e),a.getCellMeta(i,e),e=>{if("boolean"!==typeof e)throw new Error("Validation error: result is not boolean");!1===e&&(r.valid=!1),r.removeValidatorFormQueue()},"validateCells"),e-=1):e-=1;i-=1}r.checkIfQueueIsEmpty()},this.getRowHeader=function(e){let t=x.rowHeaders,n=e;return void 0!==n&&(n=a.runHooks("modifyRowHeader",n)),void 0===n?(t=[],hV(a.countRows()-1,e=>{t.push(a.getRowHeader(e))})):Array.isArray(t)&&void 0!==t[n]?t=t[n]:Uz(t)?t=t(n):t&&"string"!==typeof t&&"number"!==typeof t&&(t=n+1),t},this.hasRowHeaders=function(){return!!x.rowHeaders},this.hasColHeaders=function(){if(void 0!==x.colHeaders&&null!==x.colHeaders)return!!x.colHeaders;for(let e=0,t=a.countCols();e<t;e++)if(a.getColHeader(e))return!0;return!1},this.getColHeader=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=a.runHooks("modifyColHeader",e);if(void 0===n){const e=[],t=a.countCols();for(let n=0;n<t;n++)e.push(a.getColHeader(n));return e}let r=x.colHeaders;const i=a.toPhysicalColumn(n),o=function(e){const t=[],n=a.countCols();let r=0;for(;r<n;r++)Uz(x.columns)&&x.columns(r)&&t.push(r);return t[e]}(i);return!1===x.colHeaders?r=null:x.columns&&Uz(x.columns)&&x.columns(o)&&x.columns(o).title?r=x.columns(o).title:x.columns&&x.columns[i]&&x.columns[i].title?r=x.columns[i].title:Array.isArray(x.colHeaders)&&void 0!==x.colHeaders[i]?r=x.colHeaders[i]:Uz(x.colHeaders)?r=x.colHeaders(i):x.colHeaders&&"string"!==typeof x.colHeaders&&"number"!==typeof x.colHeaders&&(r=YY(n)),r=a.runHooks("modifyColumnHeaderValue",r,e,t),r},this._getColWidthFromSettings=function(e){let t;if(e>=0){t=a.getCellMeta(0,e).width}if(void 0!==t&&t!==x.width||(t=x.colWidths),void 0!==t&&null!==t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"===typeof t&&(t=Number.parseInt(t,10))}return t},this.getColWidth=function(e,t){let n=a._getColWidthFromSettings(e);return n=a.runHooks("modifyColWidth",n,e,t),void 0===n&&(n=BG),n},this._getRowHeightFromSettings=function(e){var t;const n=a.stylesHandler.getDefaultRowHeight(e);let r=null!==(t=x.rowHeights)&&void 0!==t?t:x.minRowHeights;if(void 0!==r&&null!==r){switch(typeof r){case"object":r=r[e];break;case"function":r=r(e)}"string"===typeof r&&(r=Number.parseInt(r,10))}return void 0!==r&&null!==r&&r<n?n:r},this.getRowHeight=function(e,t){let n=a._getRowHeightFromSettings(e);return n=a.runHooks("modifyRowHeight",n,e,t),n},this.countSourceRows=function(){return c.countRows()},this.countSourceCols=function(){return c.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const e=x.maxCols,t=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return fV(a.countRows()-1,n=>{if(a.isEmptyRow(n))t+=1;else if(!0===e)return!1}),t},this.countEmptyCols=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return fV(a.countCols()-1,n=>{if(a.isEmptyCol(n))t+=1;else if(!0===e)return!1}),t},this.isEmptyRow=function(e){return x.isEmptyRow.call(a,e)},this.isEmptyCol=function(e){return x.isEmptyCol.call(a,e)},this.selectCell=function(e,t,n,r){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!rL(e)&&!rL(t)&&this.selectCells([[e,t,n,r]],i,o)},this.selectCells=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&f.suspend();const n=T.selectCells(e);return n&&t&&a.listen(),f.resume(),n},this.selectColumns=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2?arguments[2]:void 0;return T.selectColumns(e,t,n)},this.selectRows=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2?arguments[2]:void 0;return T.selectRows(e,t,n)},this.deselectCell=function(){T.deselect()},this.selectAll=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2?arguments[2]:void 0;f.skipNextScrollCycle(),T.selectAll(e,t,n)};const I=(e,t)=>e.getNearestNotHiddenIndex(t,1,!0);this.scrollViewportTo=function(e,t){var n;"number"===typeof e&&(e={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:null===(n=arguments[4])||void 0===n||n});const{row:r,col:i,considerHiddenIndexes:o}=null!==e&&void 0!==e?e:{};let s=r,l=i;if(Uz(t)&&this.addHookOnce("afterScroll",t),void 0===o||o){const e=Number.isInteger(r)&&r>=0,t=Number.isInteger(i)&&i>=0,n=e?I(this.rowIndexMapper,r):void 0,o=t?I(this.columnIndexMapper,i):void 0;if(null===n||null===o)return!1;s=e?a.rowIndexMapper.getRenderableFromVisualIndex(n):r,l=t?a.columnIndexMapper.getRenderableFromVisualIndex(o):i}const c=Number.isInteger(s),u=Number.isInteger(l);let d=!1;return c&&s>=0&&u&&l>=0?d=a.view.scrollViewport(a._createCellCoords(s,l),e.horizontalSnap,e.verticalSnap):c&&s>=0&&(u&&l<0||!u)?d=a.view.scrollViewportVertically(s,e.verticalSnap):u&&l>=0&&(c&&s<0||!c)&&(d=a.view.scrollViewportHorizontally(l,e.horizontalSnap)),Uz(t)&&(d?this.view.render():(this.removeHook("afterScroll",t),this._registerMicrotask(()=>t()))),d},this.scrollToFocusedCell=function(e){if(!this.selection.isSelected())return!1;Uz(e)&&this.addHookOnce("afterScroll",e);const{highlight:t}=this.getSelectedRangeActive(),n=this.scrollViewportTo(t.toObject());return n?this.view.render():Uz(e)&&(this.removeHook("afterScroll",e),this._registerMicrotask(()=>e())),n},this.destroy=function(){a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),c&&c.destroy(),c=null,NY(this)&&(0!==I1&&(1===I1&&(O1.remove(),O1=null),I1-=1),this.getFocusScopeManager().destroy()),this.getShortcutManager().destroy(),N.clear(),w.clearCache(),F1.delete(this.guid),s.destroy(),d&&d.destroy(),a.rootContainer&&ZB(a.rootContainer),a.rootPortalElement&&a.rootPortalElement.remove(),a.batchExecution(()=>{a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),C.getItems().forEach(e=>{let[,t]=e;t.destroy()}),C.clear(),a.runHooks("afterDestroy")},!0),_W.getSingleton().destroy(a),rB(a,(e,t,n)=>{var r;Uz(e)?n[t]=(r=t,()=>{throw new Error('The "'.concat(r,'" method cannot be called because this Handsontable instance has been destroyed'))}):"guid"!==t&&(n[t]=null)}),a.isDestroyed=!0,l&&l.destroy(),l=null,u=null,T=null,d=null,a=null},this.getActiveEditor=function(){return d.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return a.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return a.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return a.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return a.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return a.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return a.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return a.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return a.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return a.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return a.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return a.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return a.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(e){return C.getItem(yL(e))},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:C.getId(e)},this.getInstance=function(){return a},this.addHook=function(e,t,n){_W.getSingleton().add(e,t,a,n)},this.hasHook=function(e){return _W.getSingleton().has(e,a)||_W.getSingleton().has(e)},this.addHookOnce=function(e,t,n){_W.getSingleton().once(e,t,a,n)},this.removeHook=function(e,t){_W.getSingleton().remove(e,t,a)},this.runHooks=function(e,t,n,r,i,o,s){return _W.getSingleton().run(a,e,t,n,r,i,o,s)},this.getTranslatedPhrase=function(e,t){return nQ(x.language,e,t)},this.toHTML=()=>sV(this),this.toTableElement=()=>{const e=this.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",sV(this)),e.firstElementChild},this.timeouts=[],this.useTheme=e=>{const t=!!m;this.stylesHandler.useTheme(e);const n=this.stylesHandler.getThemeName();t||(a.render(),a.scrollViewportTo(0,0),u1(this.rootContainer)&&($B(this.rootContainer,/ht-theme-.*/g),n&&KB(this.rootContainer,n))),this.runHooks("afterSetTheme",n,t)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(e){let t=e;"function"===typeof t&&(t=setTimeout(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)),this.timeouts.push(t)},this._clearTimeouts=function(){WH(this.timeouts,e=>{clearTimeout(e)})},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){WH(this.immediates,e=>{clearImmediate(e)})},this._registerMicrotask=function(e){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||e()})},this._getEditorManager=function(){return d};const P=f0({handleEvent:()=>a.isListening(),beforeKeyDown:e=>this.runHooks("beforeKeyDown",e),afterKeyDown:e=>{this.isDestroyed||a.runHooks("afterDocumentKeyDown",e)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",e=>{!1===e.ctrlKey&&!1===e.metaKey&&P.releasePressedKeys()}),this.getShortcutManager=function(){return P},h=new jZ(a);const j=NY(this)?YZ(a):null;var F;this.getFocusManager=function(){return h},this.getFocusScopeManager=function(){if(!NY(a))throw new Error("The FocusScopeManager is only available for the main Handsontable instance.");return j},kV().forEach(e=>{const t=MV(e);C.addItem(e,new t(this))}),F=a,[c1,l1].forEach(e=>e(F)),NY(this)&&function(e){[e0].forEach(t=>t(e))}(a),P.setActiveContextName("grid"),_W.getSingleton().run(a,"construct")}function L1(e,t,n){e.addEventListener(t,n,!1)}function B1(e,t,n){e.removeEventListener(t,n,!1)}function z1(e){return e.ownerDocument.defaultView.getComputedStyle(e)}function W1(e){const t=E({minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:e=>e.value},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),n=e.body,r=e.createTextNode(""),i=e.createElement("span");let o;function a(){var e,a;r.textContent=t.textContent(o),i.style.position="absolute",i.style.fontSize=z1(o).fontSize,i.style.fontFamily=z1(o).fontFamily,i.style.whiteSpace="pre",n.appendChild(i);const s=parseInt((null===(e=z1(o))||void 0===e?void 0:e.paddingInlineStart)||0,10),l=parseInt((null===(a=z1(o))||void 0===a?void 0:a.paddingInlineEnd)||0,10),c=i.clientWidth+s+l+1;n.removeChild(i);const u=o.style;u.height="".concat(t.minHeight,"px"),t.minWidth>c?u.width="".concat(t.minWidth,"px"):c>t.maxWidth?u.width="".concat(t.maxWidth,"px"):u.width="".concat(c,"px");const d=o.scrollHeight?o.scrollHeight-1:0;t.minHeight>d?u.height="".concat(t.minHeight,"px"):t.maxHeight<d?(u.height="".concat(t.maxHeight,"px"),u.overflowY="visible"):u.height="".concat(d,"px")}function s(){e.defaultView.setTimeout(a,0)}return{init:function(e,n){let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];o=e,function(e){if(e&&e.minHeight)if("inherit"===e.minHeight)t.minHeight=o.clientHeight;else{const n=parseInt(e.minHeight,10);isNaN(n)||(t.minHeight=n)}if(e&&e.maxHeight)if("inherit"===e.maxHeight)t.maxHeight=o.clientHeight;else{const n=parseInt(e.maxHeight,10);isNaN(n)||(t.maxHeight=n)}if(e&&e.minWidth)if("inherit"===e.minWidth)t.minWidth=o.clientWidth;else{const n=parseInt(e.minWidth,10);isNaN(n)||(t.minWidth=n)}if(e&&e.maxWidth)if("inherit"===e.maxWidth)t.maxWidth=o.clientWidth;else{const n=parseInt(e.maxWidth,10);isNaN(n)||(t.maxWidth=n)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))}(n),"TEXTAREA"===o.nodeName&&(o.style.resize="none",o.style.height="".concat(t.minHeight,"px"),o.style.minWidth="".concat(t.minWidth,"px"),o.style.maxWidth="".concat(t.maxWidth,"px"),o.style.overflowY="hidden"),l&&(L1(o,"input",a),L1(o,"keydown",s)),a()},resize:a,unObserve(){B1(o,"input",a),B1(o,"keydown",s)}}}function V1(e,t){const n=Sz(t),r=t.value.split("\n");let i=n,o=0;for(let a=0;a<r.length;a++){const t=r[a];0!==a&&(o+=r[a-1].length+1);const s=o+t.length;if("home"===e?i=o:"end"===e&&(i=s),n<=s)break}Tz(t,i)}function U1(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const q1="ht_editor_hidden",G1="textEditor";class Y1 extends b0{static get EDITOR_TYPE(){return"text"}constructor(e){super(e),U1(this,"eventManager",new $W(this)),U1(this,"autoResize",W1(this.hot.rootDocument)),U1(this,"TEXTAREA",void 0),U1(this,"textareaStyle",void 0),U1(this,"TEXTAREA_PARENT",void 0),U1(this,"textareaParentStyle",void 0),U1(this,"layerClass",void 0),this.eventManager=new $W(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),PB(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,n,r,i,o){const a=this.state;if(super.prepare(e,t,n,r,i,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:e}=o;e&&!this.isOpened()&&(this.TEXTAREA.value=""),a===y0.FINISHED||this.isOpened()||this.hideEditableElement()}}beginEditing(e,t){this.state===y0.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),Tz(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),XB(this.TEXTAREA,[["data-hot-input",""],TL(-1)]),KB(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),KB(this.TEXTAREA_PARENT,"handsontableInputHolder"),YB(this.TEXTAREA_PARENT,this.layerClass)&&$B(this.TEXTAREA_PARENT,this.layerClass),KB(this.TEXTAREA_PARENT,q1),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){TB()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",$B(this.TEXTAREA_PARENT,this.layerClass),KB(this.TEXTAREA_PARENT,q1)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;hV(e.length-1,n=>{if(YB(e[n],"handsontableEditor"))return t=!0,!1}),YB(this.TEXTAREA_PARENT,q1)&&$B(this.TEXTAREA_PARENT,q1),t?(this.layerClass="ht_editor_visible",KB(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),KB(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==y0.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD)return void(e||this.close());const{top:t,start:n,width:r,maxWidth:i,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top="".concat(t,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(n,"px"),this.showEditableElement();const s=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=s.fontSize,this.TEXTAREA.style.fontFamily=s.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(r,i),minHeight:Math.min(o,a),maxWidth:i,maxHeight:a},!0)}bindEvents(){kB()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===y0.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===y0.EDITING&&this.focus()})}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("editor"),t={runOnlyIf:()=>nL(this.hot.getSelected()),group:G1},n=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(n(),!1),runOnlyIf:e=>!this.hot.selection.isMultiple()&&!e.altKey},{keys:[["Meta","Enter"]],callback:()=>(n(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(n(),!1)},{keys:[["Home"]],callback:(e,t)=>{let[n]=t;V1(n,this.TEXTAREA)}},{keys:[["End"]],callback:(e,t)=>{let[n]=t;V1(n,this.TEXTAREA)}}],t)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(G1)}}function K1(e,t,n,r,i,o,a){const s=a.ariaTags,l=[],c=[],u=[],d=[];a.className&&KB(t,a.className),a.readOnly?(l.push(a.readOnlyCellClassName),s&&d.push(["aria-readonly","true"])):s&&u.push("aria-readonly"),!1===a.valid&&a.invalidCellClassName?(l.push(a.invalidCellClassName),s&&d.push(["aria-invalid","true"])):(c.push(a.invalidCellClassName),s&&u.push("aria-invalid")),!1===a.wordWrap&&a.noWordWrapClassName&&l.push(a.noWordWrapClassName),!o&&a.placeholder&&l.push(a.placeholderCellClassName),a.textEllipsis&&l.push("htTextEllipsis"),$B(t,c),KB(t,l),QB(t,u),XB(t,d)}K1.RENDERER_TYPE="base";function $1(e,t,n,r,i,o,a){K1.apply(this,[e,t,n,r,i,o,a]);let s=o;!s&&a.placeholder&&(s=a.placeholder),s=tL(s),a.trimWhitespace&&(s=s.trim()),nz(t,s)}$1.RENDERER_TYPE="text";const X1={CELL_TYPE:"text",editor:Y1,renderer:$1};function Q1(e,t){const n=new H1(e,t||{},CY);return n.init(),n}MJ(X1),Q1.editors={BaseEditor:b0},Q1.Core=function(e){return new H1(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},CY)},Q1.DefaultSettings=IJ(),Q1.hooks=_W.getSingleton(),Q1.CellCoords=Sq,Q1.CellRange=kq,Q1.packageName="handsontable",Q1.buildDate="20/11/2025 13:26:54",Q1.version="16.2.0",Q1.languages={dictionaryKeys:YX,getLanguageDictionary:eQ,getLanguagesDictionaries:function(){return JX()},registerLanguageDictionary:ZX,getTranslatedPhrase:nQ};const J1=Q1;function Z1(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function e2(e,t,n){return t=o2(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,s2()?Reflect.construct(t,n||[],o2(e).constructor):t.apply(e,n))}function t2(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n2(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d2(r.key),r)}}function r2(e,t,n){return t&&n2(e.prototype,t),n&&n2(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function i2(e,t,n){return(t=d2(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o2(e){return o2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},o2(e)}function a2(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c2(e,t)}function s2(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(s2=function(){return!!e})()}function l2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function c2(e,t){return c2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c2(e,t)}function u2(e){return function(e){if(Array.isArray(e))return Z1(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Z1(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z1(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d2(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}var h2=null,f2="global";function m2(e,t){var n=g.Children.toArray(e),r=g.Children.count(e),i=null;return 0!==r&&(i=1===r&&n[0].props[t]?n[0]:n.find(function(e){return void 0!==e.props[t]})),i||null}function p2(e){return e?e.type.WrappedComponent?e.type.WrappedComponent:e.type:null}function g2(e,t){if("undefined"===typeof e||null===t)return null;var n=b2(t.props,!1);return n.className="".concat("hot-wrapper-editor-container"," ").concat(n.className),Wn.createPortal(g.createElement("div",Object.assign({},n),t),e.body)}function v2(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f2,r=m2(e,"hot-editor"),i=p2(r);return r?g.cloneElement(r,{emitEditorInstance:function(e,n){t.get(i)||t.set(i,new Map),t.get(i).set(null!==n&&void 0!==n?n:f2,e)},editorColumnScope:n,isEditor:!0}):null}function y2(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;n||(n=document),h2||(h2=n.createDocumentFragment());var o=null!==i&&void 0!==i?i:n.createElement("DIV");h2.appendChild(o);var a=g.cloneElement(e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l2(Object(n),!0).forEach(function(t){i2(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l2(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({key:"".concat(t.row,"-").concat(t.col)},t));return{portal:Wn.createPortal(a,o,r),portalContainer:o}}function b2(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{id:e.id||(t?"hot-"+Math.random().toString(36).substring(5):void 0),className:e.className||"",style:e.style||{}}}var w2=function(){return r2(function e(){t2(this,e)},null,[{key:"getSettings",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.prevProps,r=void 0===n?{}:n,i=t.isInit,o=void 0!==i&&i,a=t.initOnlySettingKeys,s=void 0===a?[]:a,l=function(t){return!(o||!s.includes(t))&&r[t]===e[t]},c={};if(e.settings){var u=e.settings;for(var d in u)u.hasOwnProperty(d)&&!l(d)&&(c[d]=u[d])}for(var h in e)"settings"!==h&&"children"!==h&&!l(h)&&e.hasOwnProperty(h)&&(c[h]=e[h]);return c}}])}(),x2=function(e){function t(){return t2(this,t),e2(this,t,arguments)}return a2(t,e),r2(t,[{key:"getSettingsProps",value:function(){var e=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(t){return!e.internalProps.includes(t)}).reduce(function(t,n){return t[n]=e.props[n],t},{})}},{key:"getLocalEditorElement",value:function(){return v2(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var e=this.props._getChildElementByType(this.props.children,"hot-renderer"),t=this.getLocalEditorElement();this.columnSettings=w2.getSettings(this.getSettingsProps()),null!==e&&(this.columnSettings.renderer=this.props._getRendererWrapper(e),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),null!==t&&(this.columnSettings.editor=this.props._getEditorClass(t,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var e=g2(this.props._getOwnerDocument(),this.getLocalEditorElement());return g.createElement(g.Fragment,null,e)}}])}(g.Component),S2=function(e){function t(){var e;return t2(this,t),(e=e2(this,t,arguments)).state={portals:[]},e}return a2(t,e),r2(t,[{key:"render",value:function(){return g.createElement(g.Fragment,null,this.state.portals)}}])}(g.Component);function C2(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var E2={exports:{}};var N2,T2,A2,R2;function k2(){if(T2)return N2;T2=1;return N2="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}E2.exports=function(){if(R2)return A2;R2=1;var e=k2();function t(){}function n(){}return n.resetWarningCache=t,A2=function(){function r(t,n,r,i,o,a){if(a!==e){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function i(){return r}r.isRequired=r;var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:i,element:r,elementType:r,instanceOf:i,node:r,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:n,resetWarningCache:t};return o.PropTypes=o,o}}()();var M2=C2(E2.exports),D2=function(e){function t(){var e;return t2(this,t),(e=e2(this,t,arguments)).id=null,e.__hotInstance=null,e.hotElementRef=null,e.columnSettings=[],e.renderersPortalManager=null,e.portalCache=new Map,e.portalContainerCache=new Map,e.renderedCellCache=new Map,e.editorCache=new Map,e.componentRendererColumns=new Map,e}return a2(t,e),r2(t,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn("The Handsontable instance bound to this component was destroyed and cannot be used properly."),null)},set:function(e){this.__hotInstance=e}},{key:"_isHotInstanceDestroyed",value:function(){return this.__hotInstance&&this.__hotInstance.isDestroyed}},{key:"getPortalContainerCache",value:function(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return"undefined"!==typeof window?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(e){this.hotElementRef=e}},{key:"getRendererWrapper",value:function(e){var t=this;return function(n,r,i,o,a,s,l){var c=t.getRenderedCellCache(),u=t.getPortalContainerCache(),d="".concat(i,"-").concat(o),h=n.guid,f="".concat(h,"-").concat(d),m="".concat(d,"-").concat(h);if(c.has(d)&&(r.innerHTML=c.get(d).innerHTML),r&&!r.getAttribute("ghost-table")){for(var p=t.portalCache.get(m),g=u.get(f);r.firstChild;)r.removeChild(r.firstChild);if(p&&g)r.appendChild(g);else{var v=y2(e,{TD:r,row:i,col:o,prop:a,value:s,cellProperties:l,isRenderer:!0},r.ownerDocument,m,g),y=v.portal,b=v.portalContainer;u.set(f,b),r.appendChild(b),t.portalCache.set(m,y)}}return c.set(d,r),r}}},{key:"getEditorClass",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f2,r=p2(e),i=null===(t=this.getEditorCache().get(r))||void 0===t?void 0:t.get(n);return this.makeEditorClass(i)}},{key:"makeEditorClass",value:function(e){var t=function(t){function n(t){var r;return t2(this,n),r=e2(this,n,[t]),e.hotCustomEditorInstance=r,r.editorComponent=e,r}return a2(n,t),r2(n,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(J1.editors.BaseEditor);return Object.getOwnPropertyNames(J1.editors.BaseEditor.prototype).forEach(function(n){"constructor"!==n&&(t.prototype[n]=function(){for(var t,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(t=e[n]).call.apply(t,[e].concat(i))})}),t}},{key:"getGlobalRendererElement",value:function(){return m2(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return v2(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=this._isHotInstanceDestroyed()?[]:(null===(e=this.hotInstance)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e._initOnlySettings)||[],a=w2.getSettings(this.props,{prevProps:i,isInit:r,initOnlySettingKeys:o}),s=this.getGlobalRendererElement(),l=this.getGlobalEditorElement();(this.columnSettings.length&&(a.columns=this.columnSettings),l)?a.editor=this.getEditorClass(l,f2):this.props.editor||null!==(t=this.props.settings)&&void 0!==t&&t.editor?a.editor=this.props.editor||this.props.settings.editor:a.editor=qW("text");s?(a.renderer=this.getRendererWrapper(s),this.componentRendererColumns.set("global",!0)):this.props.renderer||null!==(n=this.props.settings)&&void 0!==n&&n.renderer?a.renderer=this.props.renderer||this.props.settings.renderer:a.renderer=FV("text");return a}},{key:"displayAutoSizeWarning",value:function(e){var t,n;this.hotInstance&&(null!==(t=this.hotInstance.getPlugin("autoRowSize"))&&void 0!==t&&t.enabled||null!==(n=this.hotInstance.getPlugin("autoColumnSize"))&&void 0!==n&&n.enabled)&&this.componentRendererColumns.size>0&&function(){var e;"undefined"!==typeof console&&(e=console).warn.apply(e,arguments)}("Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.")}},{key:"setHotColumnSettings",value:function(e,t){this.columnSettings[t]=e}},{key:"handsontableBeforeViewRender",value:function(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){this.renderersPortalManager.setState({portals:u2(this.portalCache.values())})}},{key:"updateHot",value:function(e){this.hotInstance&&this.hotInstance.updateSettings(e,!1)}},{key:"setRenderersPortalManagerRef",value:function(e){this.renderersPortalManager=e}},{key:"componentDidMount",value:function(){var e=this,t=this.createNewGlobalSettings(!0);this.hotInstance=new J1.Core(this.hotElementRef,t),this.hotInstance.addHook("beforeViewRender",function(){return e.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return e.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(t)}},{key:"componentDidUpdate",value:function(e){this.clearCache();var t=this.createNewGlobalSettings(!1,e);this.updateHot(t),this.displayAutoSizeWarning(t)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var e=this,t=g.Children.toArray(this.props.children).filter(function(e){return function(e){return e.type===x2}(e)}).map(function(t,n){return g.cloneElement(t,{_componentRendererColumns:e.componentRendererColumns,_emitColumnSettings:e.setHotColumnSettings.bind(e),_columnIndex:n,_getChildElementByType:m2.bind(e),_getRendererWrapper:e.getRendererWrapper.bind(e),_getEditorClass:e.getEditorClass.bind(e),_getOwnerDocument:e.getOwnerDocument.bind(e),_getEditorCache:e.getEditorCache.bind(e),children:t.props.children})}),n=b2(this.props),r=g2(this.getOwnerDocument(),this.getGlobalEditorElement());return g.createElement(g.Fragment,null,g.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},n),t),g.createElement(S2,{ref:this.setRenderersPortalManagerRef.bind(this)}),r)}}],[{key:"version",get:function(){return"16.2.0"}}])}(g.Component);D2.propTypes={style:M2.object,id:M2.string,className:M2.string};var _2=["children"],O2=g.forwardRef(function(e,t){var n,r=e.children,i=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,_2),o="function"===typeof g.useId?g.useId():void 0,a=null!==(n=i.id)&&void 0!==n?n:o;return g.createElement(D2,Object.assign({id:a},i,{ref:t}),r)});O2.version=D2.version;g.Component;function I2(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const P2="handsontableEditor";class j2 extends Y1{constructor(){super(...arguments),I2(this,"isFlippedVertically",!1),I2(this,"isFlippedHorizontally",!1)}static get EDITOR_TYPE(){return"handsontable"}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),"none"===e.display&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Tz(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getTargetDropdownWidth(),height:this.getTargetDropdownHeight()}),this.refreshDimensions(),this.flipDropdownVerticallyIfNeeded(),this.flipDropdownHorizontallyIfNeeded()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,n,r,i,o){super.prepare(e,t,n,r,i,o);const a=this,s={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(e,t){const n=this.getSourceData(t.row,t.col);void 0!==n&&a.setValue(n),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&$L(s,o.handsontable),this.htOptions=s}beginEditing(e,t){const n=this.hot.getSettings().onBeginEditing;n&&!1===n()||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedActive()){const e=this.htEditor.getValue();void 0!==e&&this.setValue(e)}super.finishEditing(e,t,n)}flipDropdownVerticallyIfNeeded(){const{view:e}=this.hot,t=this.getEditedCellRect();let n=t.top;if(e.isVerticallyScrollableByWindow()){const t=e.getTableOffset().top-this.hot.rootWindow.scrollY;n=Math.max(n+t,0)}const r=this.getDropdownHeight(),i=e.getWorkspaceHeight()-n-t.height,o=r>i&&n>i+t.height;return o?this.flipDropdownVertically():this.unflipDropdownVertically(),{isFlipped:o,spaceAbove:n,spaceBelow:i}}flipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="".concat(-this.getDropdownHeight(),"px"),this.isFlippedVertically=!0}unflipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.isFlippedVertically=!1}flipDropdownHorizontallyIfNeeded(){const{view:e}=this.hot,t=this.getEditedCellRect();let n=t.start+t.width;if(e.isHorizontallyScrollableByWindow()){const t=e.getTableOffset().left-this.hot.rootWindow.scrollX;n=Math.max(n+t,0)}const r=this.getDropdownWidth(),i=e.getWorkspaceWidth()-n+t.width,o=r>i&&n>i;return o?this.flipDropdownHorizontally():this.unflipDropdownHorizontally(),{isFlipped:o,spaceInlineStart:n,spaceInlineEnd:i}}flipDropdownHorizontally(){const e=this.htEditor.rootElement.style,{width:t}=this.getEditedCellRect();e.position="absolute",e[this.hot.isRtl()?"right":"left"]="".concat(-(this.getDropdownWidth()-t),"px"),this.isFlippedHorizontally=!0}unflipDropdownHorizontally(){const e=this.htEditor.rootElement.style;e.position="absolute",e[this.hot.isRtl()?"right":"left"]="",this.isFlippedHorizontally=!1}getDropdownHeight(){return this.htEditor.getTableHeight()}getDropdownWidth(){return this.htEditor.getTableWidth()}getTargetDropdownWidth(){return this.htEditor.view.getTableWidth()}getTargetDropdownHeight(){return this.htEditor.view.getTableHeight()+1}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;null===(e=this.htEditor)||void 0===e||e.destroy()}),this.hot.addHook("afterSetTheme",(e,t)=>{t||this.close()})}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const t={group:P2,relativeToGroup:ZZ,position:"before"},n=(e,t)=>{const n=this.htEditor;if(void 0!==e&&(e<0||this.isFlippedVertically&&e>n.countRows()-1?n.deselectCell():n.selectCell(e,0),n.getData().length))return t.preventDefault(),aW(t),this.hot.listen(),this.TEXTAREA.focus(),!1};e.addShortcuts([{keys:[["ArrowUp"]],callback:e=>{const t=this.htEditor;let r,i;return!t.getSelectedActive()&&this.isFlippedVertically?r=t.countRows()-1:t.getSelectedActive()&&(this.isFlippedVertically?(i=t.getSelectedActive()[0],r=Math.max(0,i-1)):(i=t.getSelectedActive()[0],r=i-1)),n(r,e)},preventDefault:!1},{keys:[["ArrowDown"]],callback:e=>{const t=this.htEditor;let r,i;if(t.getSelectedActive()||this.isFlippedVertically){if(t.getSelectedActive())if(this.isFlippedVertically)r=t.getSelectedActive()[0]+1;else if(!this.isFlippedVertically){const e=t.countRows()-1;i=t.getSelectedActive()[0],r=Math.min(e,i+1)}}else r=0;return n(r,e)},preventDefault:!1}],t)}unregisterShortcuts(){super.unregisterShortcuts();this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(P2)}}function F2(e,t,n){H2(e,t),t.set(e,n)}function H2(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function L2(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B2(e,t){return e.get(z2(e,t))}function z2(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var W2=new WeakMap,V2=new WeakMap,U2=new WeakSet;class q2 extends j2{constructor(){super(...arguments),function(e,t){H2(e,t),t.add(e)}(this,U2),L2(this,"query",null),L2(this,"strippedChoices",[]),L2(this,"rawChoices",[]),F2(this,W2,this.hot.guid.slice(0,9)),F2(this,V2,Yz(()=>{this.focus()},100))}static get EDITOR_TYPE(){return"autocomplete"}getValue(){const e=this.rawChoices.find(e=>{const t=this.stripValueIfNeeded(e);return(z2(U2,this,Y2).call(this,t)?t.value:t)===this.TEXTAREA.value});return nL(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),KB(this.htContainer,"autocompleteEditor"),KB(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll"),this.hot.getSettings().ariaTags&&XB(this.TEXTAREA,[["type","text"],["role","combobox"],HL("listbox"),["aria-autocomplete","list"]])}prepare(e,t,n,r,i,o){var a;super.prepare(e,t,n,r,i,o),this.hot.getSettings().ariaTags&&XB(this.TEXTAREA,[VL("false"),(a="".concat(B2(W2,this),"-listbox-").concat(e,"-").concat(t),["aria-controls",a])]),this.htOptions=E(E({},this.htOptions),{},{valueGetter:e=>z2(U2,this,Y2).call(this,e)?e.value:e})}open(){super.open();const e=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown,t=this.hot.getSettings().ariaTags,n=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,r=null===n||void 0===n?void 0:n.length,{row:i,col:o}=this;var a;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",e=>this.onBeforeKeyDown(e)),this.htEditor.addHook("afterScroll",B2(V2,this)),this.htEditor.updateSettings({colWidths:e?[gz(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(e,i,o,a,s,l,c)=>{$1(e,i,o,a,s,l,c);const{filteringCaseSensitive:u,allowHtml:d,locale:h}=this.cellProperties,f=this.query;let m,p,g=tL(l);var v;g&&!d&&(m=!0===u?g.indexOf(f):g.toLocaleLowerCase(h).indexOf(f.toLocaleLowerCase(h)),-1!==m&&(p=g.substr(m,f.length),g=g.replace(p,"<strong>".concat(p,"</strong>")))),t&&XB(i,[["role","option"],...n?[(v=r,["aria-setsize",v])]:[],...n?[GL(n.indexOf(l)+1)]:[],["id","".concat(this.htEditor.rootElement.id,"_").concat(o,"-").concat(a)]]),i.innerHTML=g},afterSelectionEnd:(e,n)=>{if(t){const t=e=>{var t;XB(e,[["aria-selected","true"]]),XB(this.TEXTAREA,...(t=e.id,["aria-activedescendant",t]))},r=this.htEditor.getCell(e,n,!0);null!==r?t(r):this.htEditor.addHookOnce("afterScrollVertically",()=>{const r=this.htEditor.getCell(e,n,!0);t(r)})}}}),t&&(XB(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,"role","presentation"),XB(this.htEditor.rootElement,[["role","listbox"],(a="polite",["aria-live",a]),qL("text"),["id","".concat(B2(W2,this),"-listbox-").concat(i,"-").concat(o)]]),XB(this.TEXTAREA,...VL("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&XB(this.TEXTAREA,[VL("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}finishEditing(e,t,n){if(this.isOpened()){const t=this.hot.getSelectedRangeActive();(rL(t)||nL(t)&&!t.includes(this.hot._createCellCoords(this.row,this.col)))&&(e=!0)}super.finishEditing(e,t,n)}queryChoices(e){const t=this.cellProperties.source;this.query=e,"function"===typeof t?t.call(this.cellProperties,e,e=>{this.rawChoices=e,this.updateChoicesList(this.stripValuesIfNeeded(e))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=Sz(this.TEXTAREA),n=Cz(this.TEXTAREA),r=this.cellProperties.sortByRelevance,i=this.cellProperties.filter,o=this.stripValueIfNeeded(this.getValue()),a=z2(U2,this,Y2).call(this,o)?o.value:o;let s=null,l=e;r||(l=l.toSorted());const c=[],u=this.cellProperties.locale,d=this.cellProperties.filteringCaseSensitive,h=d?a:a.toLocaleLowerCase(u);for(let f=0;f<l.length;f++){const e=z2(U2,this,Y2).call(this,l[f])?EL(tL(l[f].value)):EL(tL(l[f]));if(-1!==(d?e:e.toLocaleLowerCase(u)).indexOf(h)&&(c.push(f),!1===i))break}!1===i?o.length>0&&(s=c[0]):(l=c.map(e=>l[e]),s=l.indexOf(h)>-1?l.indexOf(h):0),this.strippedChoices=l,0===l.length?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(HH([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownVerticallyIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(s)),this.hot.listen(),Tz(this.TEXTAREA,t,t===n?void 0:n)}flipDropdownVerticallyIfNeeded(){const e=super.flipDropdownVerticallyIfNeeded(),{isFlipped:t,spaceAbove:n,spaceBelow:r}=e;return this.limitDropdownIfNeeded(t?n:r),e}limitDropdownIfNeeded(e){const t=this.getDropdownHeight();if(t>e){let n=0,r=0,i=null;do{r=this.htEditor.stylesHandler.getDefaultRowHeight(),n+=r}while(n<e);i=n-r,this.isFlippedVertically&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+t-i,"px")),this.setDropdownHeight(n-r)}}updateDropdownDimensions(){const e=Rz(),t=this.getTargetEditorWidth()+e,n=this.getTargetEditorHeight()+e;this.htEditor.updateSettings({width:t,height:n}),z2(U2,this,G2).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),z2(U2,this,G2).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){"number"===typeof e?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getTargetEditorHeight(){let e=0;if(!this.hot.getCurrentThemeName()){const t=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(t.borderTopWidth,10)+parseInt(t.borderBottomWidth,10)}const t=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length),n=Array.from({length:t},(e,t)=>t).reduce((e,t)=>e+(this.hot.stylesHandler.getDefaultRowHeight()+(0===t?1:0)),0);return n+e}getTargetEditorWidth(){let e=0;if(!this.hot.getCurrentThemeName()){const t=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(t.borderInlineStartWidth,10)+parseInt(t.borderInlineEndWidth,10)}return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,n=e=>tL(t?e:EL(e));return e.every(e=>z2(U2,this,Y2).call(this,e))?e.map(e=>({key:n(e.key),value:n(e.value)})):e.map(e=>n(e))}onBeforeKeyDown(e){if(tW(e.keyCode)||e.keyCode===Zz.BACKSPACE||e.keyCode===Zz.DELETE||e.keyCode===Zz.INSERT){let t=10;if(e.keyCode===Zz.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(t+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},t)}}}function G2(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getTargetEditorWidth()+kz(this.hot.rootDocument)})}function Y2(e){return tB(e)&&nL(e.key)&&nL(e.value)}class K2 extends b0{static get EDITOR_TYPE(){return"checkbox"}beginEditing(e,t){if(t&&"mouseup"===t.type&&"TD"===t.target.nodeName){const e=this.TD.querySelector('input[type="checkbox"]');YB(e,"htBadValue")||e.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}const $2=()=>window,X2=()=>window.document,Q2=(e,t)=>window.setTimeout(e,t),J2=function(e,t,n,r){e.addEventListener(t,n,!!r)},Z2=function(e,t,n,r){e.removeEventListener(t,n,!!r)},e3=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},t3=function(e,t){e3(e,t)||(e.className=""===e.className?t:e.className+" "+t)},n3=function(e,t){var n;e.className=(n=(" "+e.className+" ").replace(" "+t+" "," ")).trim?n.trim():n.replace(/^\s+|\s+$/g,"")},r3=function(e){return/Array/.test(Object.prototype.toString.call(e))},i3=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},o3=function(e){let t=e.getDay();return 0===t||6===t},a3=function(e){return e%4===0&&e%100!==0||e%400===0},s3=function(e,t){return[31,a3(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},l3=function(e){i3(e)&&e.setHours(0,0,0,0)},c3=function(e,t){return e.getTime()===t.getTime()},u3=function(e,t,n){let r,i;for(r in t)i=void 0!==e[r],i&&"object"===typeof t[r]&&null!==t[r]&&void 0===t[r].nodeName?i3(t[r])?n&&(e[r]=new Date(t[r].getTime())):r3(t[r])?n&&(e[r]=t[r].slice(0)):e[r]=u3({},t[r],n):!n&&i||(e[r]=t[r]);return e},d3=function(e,t,n){let r=X2().createEvent("HTMLEvents");r.initEvent(t,!0,!1),r=u3(r,n),e.dispatchEvent(r)},h3=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e},f3={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},m3=function(e,t,n){for(t+=e.firstDay;t>=7;)t-=7;return n?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},p3=function(e){let t=[],n="false";if(e.isEmpty){if(!e.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';t.push("is-outside-current-month"),e.enableSelectionDaysInNextAndPreviousMonths||t.push("is-selection-disabled")}return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),n="true"),e.hasEvent&&t.push("has-event"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"},g3=function(e,t,n,r,i){let o=new Date(r,n,t),a=e.hasMoment?e.moment(o).isoWeek():function(e,t){e.setHours(0,0,0,0);let n=e.getDate(),r=e.getDay(),i=t,o=i-1,a=function(e){return(e+7-1)%7};e.setDate(n+o-a(r));let s=new Date(e.getFullYear(),0,i),l=(e.getTime()-s.getTime())/864e5;return 1+Math.round((l-o+a(s.getDay()))/7)}(o,i);return'<td class="pika-week">'+a+"</td>"},v3=function(e,t,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(t?e.reverse():e).join("")+"</tr>"},y3=function(e,t,n,r,i,o){let a,s,l,c,u,d=e._o,h=n===d.minYear,f=n===d.maxYear,m='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',p=!0,g=!0;for(l=[],a=0;a<12;a++)l.push('<option value="'+(n===i?a-t:12+a-t)+'"'+(a===r?' selected="selected"':"")+(h&&a<d.minMonth||f&&a>d.maxMonth?' disabled="disabled"':"")+">"+d.i18n.months[a]+"</option>");for(c='<div class="pika-label">'+d.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",r3(d.yearRange)?(a=d.yearRange[0],s=d.yearRange[1]+1):(a=n-d.yearRange,s=1+n+d.yearRange),l=[];a<s&&a<=d.maxYear;a++)a>=d.minYear&&l.push('<option value="'+a+'"'+(a===n?' selected="selected"':"")+">"+a+"</option>");return u='<div class="pika-label">'+n+d.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",d.showMonthAfterYear?m+=u+c:m+=c+u,h&&(0===r||d.minMonth>=r)&&(p=!1),f&&(11===r||d.maxMonth<=r)&&(g=!1),0===t&&(m+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+d.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(m+='<button class="pika-next'+(g?"":" is-disabled")+'" type="button">'+d.i18n.nextMonth+"</button>"),m+"</div>"},b3=function(e,t,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+function(e){let t,n=[];for(e.showWeekNumber&&n.push("<th></th>"),t=0;t<7;t++)n.push('<th scope="col"><abbr title="'+m3(e,t)+'">'+m3(e,t,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?n.reverse():n).join("")+"</tr></thead>"}(e)+("<tbody>"+t.join("")+"</tbody></table>")};function w3(e){let t=this,n=t.config(e);t._onMouseDown=function(e){if(!t._v)return;let r=(e=e||$2().event).target||e.srcElement;if(r)if(e3(r,"is-disabled")||(!e3(r,"pika-button")||e3(r,"is-empty")||e3(r.parentNode,"is-disabled")?e3(r,"pika-prev")?t.prevMonth():e3(r,"pika-next")&&t.nextMonth():(t.setDate(new Date(r.getAttribute("data-pika-year"),r.getAttribute("data-pika-month"),r.getAttribute("data-pika-day"))),n.bound&&Q2(function(){t.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100))),e3(r,"pika-select"))t._c=!0;else{if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}},t._onChange=function(e){let n=(e=e||$2().event).target||e.srcElement;n&&(e3(n,"pika-select-month")?t.gotoMonth(n.value):e3(n,"pika-select-year")&&t.gotoYear(n.value))},t._onKeyChange=function(e){if(e=e||$2().event,t.isVisible())switch(e.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:t.adjustDate("subtract",1);break;case 38:t.adjustDate("subtract",7);break;case 39:t.adjustDate("add",1);break;case 40:t.adjustDate("add",7);break;case 8:case 46:t.setDate(null)}},t._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let e=this.moment(n.field.value,n.format,n.formatStrict);return e&&e.isValid()?e.toDate():null}return new Date(Date.parse(n.field.value))},t._onInputChange=function(e){let n;e.firedBy!==t&&(n=t._parseFieldValue(),i3(n)&&t.setDate(n),t._v||t.show())},t._onInputFocus=function(){t.show()},t._onInputClick=function(){t.show()},t._onInputBlur=function(){let e=X2().activeElement;do{if(e3(e,"pika-single"))return}while(e=e.parentNode);t._c||(t._b=Q2(function(){t.hide()},50)),t._c=!1},t._onClick=function(e){let r=(e=e||$2().event).target||e.srcElement,i=r;if(r){!hasEventListeners&&e3(r,"pika-select")&&(r.onchange||(r.setAttribute("onchange","return;"),J2(r,"change",t._onChange)));do{if(e3(i,"pika-single")||i===n.trigger)return}while(i=i.parentNode);t._v&&r!==n.trigger&&i!==n.trigger&&t.hide()}},t.el=X2().createElement("div"),t.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),J2(t.el,"mousedown",t._onMouseDown,!0),J2(t.el,"touchend",t._onMouseDown,!0),J2(t.el,"change",t._onChange),n.keyboardInput&&J2(X2(),"keydown",t._onKeyChange),n.field&&(n.container?n.container.appendChild(t.el):n.bound?X2().body.appendChild(t.el):n.field.parentNode.insertBefore(t.el,n.field.nextSibling),J2(n.field,"change",t._onInputChange),n.defaultDate||(n.defaultDate=t._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;i3(r)?n.setDefaultDate?t.setDate(r,!0):t.gotoDate(r):t.gotoDate(new Date),n.bound?(this.hide(),t.el.className+=" is-bound",J2(n.trigger,"click",t._onInputClick),J2(n.trigger,"focus",t._onInputFocus),J2(n.trigger,"blur",t._onInputBlur)):this.show()}function x3(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function S3(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C3(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}w3.prototype={config:function(e){this._o||(this._o=u3({},f3,!0));let t=u3(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme="string"===typeof t.theme&&t.theme?t.theme:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn="function"===typeof t.disableDayFn?t.disableDayFn:null;let n=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=n>4?4:n,i3(t.minDate)||(t.minDate=!1),i3(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),r3(t.yearRange)){let e=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||e,t.yearRange[1]=parseInt(t.yearRange[1],10)||e}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||f3.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(e){return e=e||this._o.format,i3(this._d)?this._o.toString?this._o.toString(this._d,e):this.hasMoment?this.moment(this._d).format(e):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(e,t){this.hasMoment&&this.moment.isMoment(e)&&this.setDate(e.toDate(),t)},useMoment:function(e){this.hasMoment=!0,this.moment=e},getDate:function(){return i3(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",d3(this._o.field,"change",{firedBy:this})),this.draw();if("string"===typeof e&&(e=new Date(Date.parse(e))),!i3(e))return;let n=this._o.minDate,r=this._o.maxDate;i3(n)&&e<n?e=n:i3(r)&&e>r&&(e=r),this._d=new Date(e.getTime()),l3(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),d3(this._o.field,"change",{firedBy:this})),t||"function"!==typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(e){let t=!0;if(i3(e)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=e.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),t=i<n.getTime()||r.getTime()<i}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(e,t){let n,r=this.getDate()||new Date,i=24*parseInt(t)*60*60*1e3;"add"===e?n=new Date(r.valueOf()+i):"subtract"===e&&(n=new Date(r.valueOf()-i)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=h3(this.calendars[0]);for(let e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=h3({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(l3(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=f3.minDate,this._o.minYear=f3.minYear,this._o.minMonth=f3.minMonth,this._o.startRange=f3.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(l3(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=f3.maxDate,this._o.maxYear=f3.maxYear,this._o.maxMonth=f3.maxMonth,this._o.endRange=f3.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(!this._v&&!e)return;let t,n=this._o,r=n.minYear,i=n.maxYear,o=n.minMonth,a=n.maxMonth,s="";this._y<=r&&(this._y=r,!isNaN(o)&&this._m<o&&(this._m=o)),this._y>=i&&(this._y=i,!isNaN(a)&&this._m>a&&(this._m=a));for(let l=0;l<n.numberOfMonths;l++)t="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+y3(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,t)+this.render(this.calendars[l].year,this.calendars[l].month,t)+"</div>";this.el.innerHTML=s,n.bound&&"hidden"!==n.field.type&&Q2(function(){n.trigger.focus()},1),"function"===typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label",n.ariaLabel)},adjustPosition:function(){let e,t,n,r,i,o,a,s,l,c,u;this._o.container||(this.el.style.position="absolute",e=this._o.trigger,t=this.el.offsetWidth,n=this.el.offsetHeight,r=$2().innerWidth||X2().documentElement.clientWidth,i=$2().innerHeight||X2().documentElement.clientHeight,o=X2().body.scrollTop||X2().documentElement.scrollTop,c=!0,u=!0,l=e.getBoundingClientRect(),a=l.left+$2().pageXOffset,s=l.bottom+$2().pageYOffset,(this._o.reposition&&a+t>r||this._o.position.indexOf("right")>-1&&a-t+e.offsetWidth>0)&&(a=a-t+e.offsetWidth,c=!1),(this._o.reposition&&s+n>i+o||this._o.position.indexOf("top")>-1&&s-n-e.offsetHeight>0)&&(s=s-n-e.offsetHeight,u=!1),a<0&&(a=0),s<0&&(s=0),this.el.style.left=a+"px",this.el.style.top=s+"px",t3(this.el,c?"left-aligned":"right-aligned"),t3(this.el,u?"bottom-aligned":"top-aligned"),n3(this.el,c?"right-aligned":"left-aligned"),n3(this.el,u?"top-aligned":"bottom-aligned"))},render:function(e,t,n){let r=this._o,i=new Date,o=s3(e,t),a=new Date(e,t,1).getDay(),s=[],l=[];l3(i),r.firstDay>0&&(a-=r.firstDay,a<0&&(a+=7));let c=0===t?11:t-1,u=11===t?0:t+1,d=0===t?e-1:e,h=11===t?e+1:e,f=s3(d,c),m=o+a,p=m;for(;p>7;)p-=7;m+=7-p;let g=!1;for(let v=0,y=0;v<m;v++){let n=new Date(e,t,v-a+1),m=!!i3(this._d)&&c3(n,this._d),p=c3(n,i),b=-1!==r.events.indexOf(n.toDateString()),w=v<a||v>=o+a,x=v-a+1,S=t,C=e,E=r.startRange&&c3(r.startRange,n),N=r.endRange&&c3(r.endRange,n),T=r.startRange&&r.endRange&&r.startRange<n&&n<r.endRange;w&&(v<a?(x=f+x,S=c,C=d):(x-=o,S=u,C=h));let A={day:x,month:S,year:C,hasEvent:b,isSelected:m,isToday:p,isDisabled:r.minDate&&n<r.minDate||r.maxDate&&n>r.maxDate||r.disableWeekends&&o3(n)||r.disableDayFn&&r.disableDayFn(n),isEmpty:w,isStartRange:E,isEndRange:N,isInRange:T,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&m&&(g=!0),l.push(p3(A)),7===++y&&(r.showWeekNumber&&l.unshift(g3(this,v-a,t,e,r.firstWeekOfYearMinDays)),s.push(v3(l,r.isRTL,r.pickWholeWeek,g)),l=[],y=0,g=!1)}return b3(r,s,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),n3(this.el,"is-hidden"),this._o.bound&&(J2(X2(),"click",this._onClick),this.adjustPosition()),"function"===typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){let e=this._v;!1!==e&&(this._o.bound&&Z2(X2(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),t3(this.el,"is-hidden"),this._v=!1,void 0!==e&&"function"===typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){let e=this._o;this.hide(),Z2(this.el,"mousedown",this._onMouseDown,!0),Z2(this.el,"touchend",this._onMouseDown,!0),Z2(this.el,"change",this._onChange),e.keyboardInput&&Z2(X2(),"keydown",this._onKeyChange),e.field&&(Z2(e.field,"change",this._onInputChange),e.bound&&(Z2(e.trigger,"click",this._onInputClick),Z2(e.trigger,"focus",this._onInputFocus),Z2(e.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};const E3="date",N3="dateEditor";var T3=new WeakSet;class A3 extends Y1{constructor(){super(...arguments),x3(this,T3),S3(this,"parentDestroyed",!1),S3(this,"$datePicker",null)}static get EDITOR_TYPE(){return E3}init(){if("function"!==typeof PH)throw new Error("You need to include moment.js to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,t)=>{t||this.close()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),KB(this.datePicker,"htDatepickerHolder"),this.hot.rootPortalElement.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{YB(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,n,r,i,o){super.prepare(e,t,n,r,i,o)}open(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),t.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:N3})}close(){var e;null!==(e=this.$datePicker)&&void 0!==e&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const e=this.hot._getEditorManager();e.closeEditor(),this.hot.view.render(),e.prepareEditor()});this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(N3),super.close()}finishEditing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.finishEditing(e,t)}showDatepicker(e){const t=C3(T3,this,R3).call(this),n=this.hot.view.isMouseDown(),r=!!e&&nW(e.keyCode);let i;this.datePicker.style.display="block",this.$datePicker=new w3(this.getDatePickerConfig()),"function"===typeof this.$datePicker.useMoment&&this.$datePicker.useMoment(PH),this.$datePicker._onInputFocus=function(){},this.originalValue?(i=this.originalValue,PH(i,t,!0).isValid()&&this.$datePicker.setMoment(PH(i,t),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),r||n||this.setValue("")):this.cellProperties.defaultDate?(i=this.cellProperties.defaultDate,PH(i,t,!0).isValid()&&this.$datePicker.setMoment(PH(i,t),!0),r||n||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const t=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&XL(n,this.cellProperties.datePickerConfig);const r=n.onSelect,i=n.onClose;return n.field=t,n.trigger=t,n.container=this.datePicker,n.bound=!1,n.keyboardInput=!1,n.format=null!==(e=n.format)&&void 0!==e?e:C3(T3,this,R3).call(this),n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=e=>{let t=e;isNaN(t.getTime())||(t=PH(t).format(C3(T3,this,R3).call(this))),this.setValue(t),r&&r(),RB()&&this.hideDatepicker()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},n}refreshDimensions(e){var t;if(super.refreshDimensions(e),this.state!==y0.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.hideDatepicker();const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{wtOverlays:i}=this.hot.view._wt,{wtTable:o}=null!==(t=i.getParentOverlay(this.TD))&&void 0!==t?t:this.hot.view._wt,a=n.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),s=n.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),c=r.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=s&&this.col>=l&&this.col<=c){const e=this.TD.getBoundingClientRect();this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+e.top+vz(this.TD),"px");let t=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?t+=e.right-gz(this.datePicker):t+=e.left,this.datePickerStyle.left="".concat(t,"px")}else this.hideDatepicker()}}function R3(){var e;return null!==(e=this.cellProperties.dateFormat)&&void 0!==e?e:"DD/MM/YYYY"}class k3 extends q2{static get EDITOR_TYPE(){return"dropdown"}prepare(e,t,n,r,i,o){o.filter=!1,o.strict=!0,super.prepare(e,t,n,r,i,o)}}class M3 extends Y1{static get EDITOR_TYPE(){return"numeric"}}function D3(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class _3 extends Y1{constructor(){super(...arguments),D3(this,"autoResize",W1(this.hot.rootDocument,{textContent:e=>"\u2022".repeat(e.value.length)}))}static get EDITOR_TYPE(){return"password"}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,ZB(this.TEXTAREA_PARENT),this.TEXTAREA.setAttribute(...TL(-1)),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const O3="ht_editor_visible",I3="selectEditor";class P3 extends b0{static get EDITOR_TYPE(){return"select"}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),t=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",t&&e.setAttribute(...jL()),e.appendChild(this.hot.rootDocument.createTextNode(String.fromCharCode(9660))),KB(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="";this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",YB(this.selectWrapper,O3)&&$B(this.selectWrapper,O3),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,n,r,i,o){super.prepare(e,t,n,r,i,o);const a=this.cellProperties.selectOptions;let s;s="function"===typeof a?this.prepareOptions(a(this.row,this.col,this.prop)):this.prepareOptions(a),ZB(this.select),rB(s,(e,t)=>{const n=this.hot.rootDocument.createElement("OPTION");n.value=t,tz(n,e),this.select.appendChild(n)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let n=0,r=e.length;n<r;n++)t[e[n]]=e[n];else"object"===typeof e&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==y0.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.close();const{top:e,start:t,width:n,height:r}=this.getEditedCellRect(),i=this.selectWrapper.style;i.height="".concat(r,"px"),i.width="".concat(n,"px"),i.top="".concat(e,"px"),i[this.hot.isRtl()?"right":"left"]="".concat(t,"px"),i.margin="0px",KB(this.selectWrapper,O3)}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("editor"),t={group:I3};this.isInFullEditMode()&&e.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const e=this.select.selectedIndex-1;e>=0&&(this.select[e].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const e=this.select.selectedIndex+1;e<=this.select.length-1&&(this.select[e].selected=!0)}}],t)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(I3)}}class j3 extends Y1{static get EDITOR_TYPE(){return"time"}prepare(e,t,n,r,i,o){super.prepare(e,t,n,r,i,o),this.TEXTAREA.dir="ltr"}}function F3(e,t,n,r,i,o,a){K1.apply(this,[e,t,n,r,i,o,a]),tz(t,null===o||void 0===o?"":o,!1)}F3.RENDERER_TYPE="html";function H3(e,t,n,r,i,o,a){const{rootDocument:s}=e,l=a.allowHtml?F3:$1,c=s.createElement("DIV"),u=e.getSettings().ariaTags;if(c.className="htAutocompleteArrow",u&&c.setAttribute(...jL()),c.appendChild(s.createTextNode(String.fromCharCode(9660))),l.apply(this,[e,t,n,r,i,o,a]),t.firstChild||t.appendChild(s.createTextNode(String.fromCharCode(160))),t.insertBefore(c,t.firstChild),KB(t,"htAutocomplete"),!e.acArrowListener){const i=new $W(e);e.acArrowListener=function(i){YB(i.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(n,r),t)},i.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",()=>{i.destroy()})}}H3.RENDERER_TYPE="autocomplete";function L3(e,t,n,r,i,o,a){H3.apply(this,[e,t,n,r,i,o,a])}L3.RENDERER_TYPE="dropdown";const B3=new WeakMap,z3=new WeakMap,W3="data-row",V3="data-col",U3="checkboxRenderer",q3="checkbox";function G3(e,t,n,r,i,o,a){const{rootDocument:s}=e,l=e.getSettings().ariaTags;K1.apply(this,[e,t,n,r,i,o,a]),function(e){let t=z3.get(e);if(!t){const{rootElement:n}=e;t=new $W(e),t.addEventListener(n,"click",t=>function(e,t){const{target:n}=e;if(!Y3(n))return;if(!n.hasAttribute(W3)||!n.hasAttribute(V3))return;const r=parseInt(n.getAttribute(W3),10),i=parseInt(n.getAttribute(V3),10),o=t.getCellMeta(r,i);o.readOnly&&e.preventDefault()}(t,e)),t.addEventListener(n,"mouseup",t=>function(e,t){const{target:n}=e;if(!Y3(n))return;if(!n.hasAttribute(W3)||!n.hasAttribute(V3))return;setTimeout(t.listen,10)}(t,e)),t.addEventListener(n,"change",t=>function(e,t){const{target:n}=e;if(!Y3(n))return;if(!n.hasAttribute(W3)||!n.hasAttribute(V3))return;const r=parseInt(n.getAttribute(W3),10),i=parseInt(n.getAttribute(V3),10),o=t.getCellMeta(r,i);if(!o.readOnly){let n=null;n=e.target.checked?void 0===o.uncheckedTemplate||o.checkedTemplate:void 0!==o.uncheckedTemplate&&o.uncheckedTemplate,t.setDataAtCell(r,i,n)}}(t,e)),z3.set(e,t)}}(e);let c=function(e){const t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("tabindex","-1"),t.cloneNode(!1)}(s);const u=a.label;let d=!1;if("undefined"===typeof a.checkedTemplate&&(a.checkedTemplate=!0),"undefined"===typeof a.uncheckedTemplate&&(a.uncheckedTemplate=!1),ZB(t),o===a.checkedTemplate||tL(o).toLocaleLowerCase(a.locale)===tL(a.checkedTemplate).toLocaleLowerCase(a.locale)?c.checked=!0:o===a.uncheckedTemplate||tL(o).toLocaleLowerCase(a.locale)===tL(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?c.checked=!1:iL(o)?KB(c,"noValue"):(c.style.display="none",KB(c,"htBadValue"),d=!0),XB(c,[[W3,n],[V3,r]]),l&&XB(c,[IL(c.checked?e.getTranslatedPhrase(jX):e.getTranslatedPhrase(FX)),UL(c.checked),["role","checkbox"]]),!d&&u){let a="";if(u.value)a="function"===typeof u.value?u.value.call(this,n,r,i,o):u.value;else if(u.property){const t=e.getDataAtRowProp(n,u.property);a=null!==t?t:""}const l=function(e,t,n){const r=e.createElement("label");r.className="htCheckboxRendererLabel ".concat(n?"fullWidth":"");const i=e.createTextNode(t);if(n){const t=e.createElement("span");t.appendChild(i),r.appendChild(t)}else r.appendChild(i);return r.cloneNode(!0)}(s,a,!0!==u.separated);"before"===u.position?u.separated?(t.appendChild(l),t.appendChild(c)):(l.appendChild(c),c=l):u.position&&"after"!==u.position||(u.separated?(t.appendChild(c),t.appendChild(l)):(l.insertBefore(c,l.firstChild),c=l))}function h(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const n=e.getSelectedRange(),r=[],i=new Map;let o=[],a=0;if(n){for(let s=0;s<n.length;s++){const{row:l,col:c}=n[s].getTopStartCorner(),{row:u,col:d}=n[s].getBottomEndCorner();for(let n=l;n<=u;n+=1)for(let s=c;s<=d;s+=1){const l=e.getCellMeta(n,s);if(l.hidden)continue;const c={checkedTemplate:l.checkedTemplate,uncheckedTemplate:l.uncheckedTemplate};if("checkbox"!==l.type){!0!==t||l.readOnly||(i.has(r.length)?i.set(r.length,[...i.get(r.length),[n,s,null]]):i.set(r.length,[[n,s,null]]));continue}if(!0===l.readOnly)continue;"undefined"===typeof l.checkedTemplate&&(l.checkedTemplate=!0),"undefined"===typeof l.uncheckedTemplate&&(l.uncheckedTemplate=!1);const u=e.getDataAtCell(n,s);!1===t?[l.checkedTemplate,l.checkedTemplate.toString()].includes(u)?o.push([n,s,l.uncheckedTemplate,c]):[l.uncheckedTemplate,l.uncheckedTemplate.toString(),null,void 0].includes(u)&&o.push([n,s,l.checkedTemplate,c]):o.push([n,s,l.uncheckedTemplate,c]),a+=1}r.push(a),a=0}o=o.every(e=>{let[,,t]=e;return t===o[0][2]})?o.map(e=>{let[t,n,r]=e;return[t,n,r]}):o.map(e=>{let[t,n,,r]=e;return[t,n,r.checkedTemplate]}),o.length>0&&r.forEach((t,n)=>{let r=o.splice(0,t);i.size&&i.has(n)&&(r=[...r,...i.get(n)]),e.setDataAtCell(r)})}}function f(){const t=e.getSelectedRange();if(t){for(let n=0;n<t.length;n++){const r=t[n].getTopStartCorner(),i=t[n].getBottomEndCorner();for(let t=r.row;t<=i.row;t++)for(let n=r.col;n<=i.col;n++){if(e.getCellMeta(t,n).readOnly)continue;const r=e.getCell(t,n);if(Vz(r)){if(r.querySelectorAll("input[type=checkbox]").length>0)return!0}}}return!1}}(!u||u&&!u.separated)&&t.appendChild(c),d&&t.appendChild(s.createTextNode("#bad-value#")),B3.has(e)||(B3.set(e,!0),function(){const t=e.getShortcutManager().getContext("grid"),n={group:U3,relativeToGroup:ZZ,position:"before"};t.addShortcuts([{keys:[["space"]],callback:()=>(h(),!f()),runOnlyIf:()=>{var t;return null===(t=e.getSelectedRangeActive())||void 0===t?void 0:t.highlight.isCell()}},{keys:[["enter"]],callback:()=>(h(),!f()),runOnlyIf:()=>{const t=e.getSelectedRangeActive();return e.getSettings().enterBeginsEditing&&(null===t||void 0===t?void 0:t.highlight.isCell())&&!e.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(h(!0),!f()),runOnlyIf:()=>{var t;return null===(t=e.getSelectedRangeActive())||void 0===t?void 0:t.highlight.isCell()}}],n)}())}function Y3(e){return"INPUT"===e.tagName&&"checkbox"===e.getAttribute("type")}_W.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,n){const{label:r,type:i,row:o,column:a,prop:s}=t;if(i!==q3||!r)return;const{value:l,property:c}=r;let u=n;if(l)u="function"===typeof l?l(o,a,s,n):l;else if(c){const e=this.getDataAtRowProp(o,c);u=null!==e?e:n}return"".concat(tL(u).length)}),G3.RENDERER_TYPE=q3;function K3(e,t,n,r,i,o,a){H3.apply(this,[e,t,n,r,i,o,a])}K3.RENDERER_TYPE="handsontable";var $3,X3,Q3,J3,Z3,e4,t4="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{};function n4(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function r4(){return X3||(X3=1,$3={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(e){let t=e%10;return 1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),$3}function i4(){if(J3)return Q3;J3=1;const e=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function t(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(r,i,o,a,s,l,c){if(!isNaN(+r))return+r;let u="",d=r.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(d!==r)return-1*n(d,i,o,a,s,l);for(let t=0;t<e.length;t++){let c=e[t];if(u=r.replace(RegExp("([0-9 ])(".concat(c.key,")$")),"$1"),u!==r)return n(u,i,o,a,s,l)*c.factor}if(u=r.replace("%",""),u!==r)return n(u,i,o,a,s,l)/100;let h=parseFloat(r);if(isNaN(h))return;let f=a(h);if(f&&"."!==f&&(u=r.replace(new RegExp("".concat(t(f),"$")),""),u!==r))return n(u,i,o,a,s,l);let m={};Object.keys(l).forEach(e=>{m[l[e]]=e});let p=Object.keys(m).sort().reverse(),g=p.length;for(let e=0;e<g;e++){let t=p[e],c=m[t];if(u=r.replace(t,""),u!==r){let e;switch(c){case"thousand":e=Math.pow(10,3);break;case"million":e=Math.pow(10,6);break;case"billion":e=Math.pow(10,9);break;case"trillion":e=Math.pow(10,12)}return n(u,i,o,a,s,l)*e}}}function r(e,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0;if(""===e)return;if(e===a)return 0;let l=function(e,n,r){let i=e.replace(r,"");return i=i.replace(new RegExp("([0-9])".concat(t(n.thousands),"([0-9])"),"g"),"$1$2"),i=i.replace(n.decimal,"."),i}(e,r,i);return n(l,r,i,o,a,s)}return Q3={unformat:function(e,t){const n=c4();let i,o=n.currentDelimiters(),a=n.currentCurrency().symbol,s=n.currentOrdinal(),l=n.getZeroFormat(),c=n.currentAbbreviations();if("string"===typeof e)i=function(e,t){if(!e.indexOf(":")||":"===t.thousands)return!1;let n=e.split(":");if(3!==n.length)return!1;let r=+n[0],i=+n[1],o=+n[2];return!isNaN(r)&&!isNaN(i)&&!isNaN(o)}(e,o)?function(e){let t=e.split(":"),n=+t[0],r=+t[1];return+t[2]+60*r+3600*n}(e):r(e,o,a,s,l,c);else{if("number"!==typeof e)return;i=e}if(void 0!==i)return i}},Q3}function o4(){if(e4)return Z3;e4=1;let e=i4();const t=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:(e,t)=>"byte"===t.output,message:"`base` must be provided only when the output is `byte`",mandatory:e=>"byte"===e.output},characteristic:{type:"number",restriction:e=>e>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",lowPrecision:{type:"boolean",restriction:(e,t)=>!0===t.average,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:e=>e>=0,message:"value must be positive"},{restriction:(e,t)=>!t.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:e=>e>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(e,t)=>"percent"===t.output,message:"`prefixSymbol` can be provided only when the output is `percent`"}},r={languageTag:{type:"string",mandatory:!0,restriction:e=>e.match(t),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function i(t){return void 0!==e.unformat(t)}function o(e,t,r){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Object.keys(e).map(i=>{if(!t[i])return console.error("".concat(r," Invalid key: ").concat(i)),!1;let a=e[i],s=t[i];if("string"===typeof s&&(s={type:s}),"format"===s.type){if(!o(a,n,"[Validate ".concat(i,"]"),!0))return!1}else if(typeof a!==s.type)return console.error("".concat(r," ").concat(i,' type mismatched: "').concat(s.type,'" expected, "').concat(typeof a,'" provided')),!1;if(s.restrictions&&s.restrictions.length){let t=s.restrictions.length;for(let n=0;n<t;n++){let{restriction:t,message:o}=s.restrictions[n];if(!t(a,e))return console.error("".concat(r," ").concat(i," invalid value: ").concat(o)),!1}}if(s.restriction&&!s.restriction(a,e))return console.error("".concat(r," ").concat(i," invalid value: ").concat(s.message)),!1;if(s.validValues&&-1===s.validValues.indexOf(a))return console.error("".concat(r," ").concat(i," invalid value: must be among ").concat(JSON.stringify(s.validValues),', "').concat(a,'" provided')),!1;if(s.children){if(!o(a,s.children,"[Validate ".concat(i,"]")))return!1}return!0});return i||a.push(...Object.keys(t).map(n=>{let i=t[n];if("string"===typeof i&&(i={type:i}),i.mandatory){let t=i.mandatory;if("function"===typeof t&&(t=t(e)),t&&void 0===e[n])return console.error("".concat(r,' Missing mandatory key "').concat(n,'"')),!1}return!0})),a.reduce((e,t)=>e&&t,!0)}function a(e){return o(e,n,"[Validate format]")}return Z3={validate:function(e,t){let n=i(e),r=a(t);return n&&r},validateFormat:a,validateInput:i,validateLanguage:function(e){return o(e,r,"[Validate language]")}},Z3}var a4,s4,l4={parseFormat:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"!==typeof e?e:(e=function(e,t){let n=e.match(/^{([^}]*)}/);return n?(t.prefix=n[1],e.slice(n[0].length)):e}(e,t),e=function(e,t){let n=e.match(/{([^}]*)}$/);return n?(t.postfix=n[1],e.slice(0,-n[0].length)):e}(e,t),function(e,t){if(-1===e.indexOf("$")){if(-1===e.indexOf("%"))return-1!==e.indexOf("bd")?(t.output="byte",void(t.base="general")):-1!==e.indexOf("b")?(t.output="byte",void(t.base="binary")):-1!==e.indexOf("d")?(t.output="byte",void(t.base="decimal")):void(-1===e.indexOf(":")?-1!==e.indexOf("o")&&(t.output="ordinal"):t.output="time");t.output="percent"}else t.output="currency"}(e,t),function(e,t){let n=e.match(/[1-9]+[0-9]*/);n&&(t.totalLength=+n[0])}(e,t),function(e,t){let n=e.split(".")[0].match(/0+/);n&&(t.characteristic=n[0].length)}(e,t),function(e,t){if(-1!==e.indexOf(".")){let n=e.split(".")[0];t.optionalCharacteristic=-1===n.indexOf("0")}}(e,t),function(e,t){-1!==e.indexOf("a")&&(t.average=!0)}(e,t),function(e,t){-1!==e.indexOf("K")?t.forceAverage="thousand":-1!==e.indexOf("M")?t.forceAverage="million":-1!==e.indexOf("B")?t.forceAverage="billion":-1!==e.indexOf("T")&&(t.forceAverage="trillion")}(e,t),function(e,t){let n=e.split(".")[1];if(n){let e=n.match(/0+/);e&&(t.mantissa=e[0].length)}}(e,t),function(e,t){e.match(/\[\.]/)?t.optionalMantissa=!0:e.match(/\./)&&(t.optionalMantissa=!1)}(e,t),function(e,t){const n=e.split(".")[1];n&&(t.trimMantissa=-1!==n.indexOf("["))}(e,t),function(e,t){-1!==e.indexOf(",")&&(t.thousandSeparated=!0)}(e,t),function(e,t){-1!==e.indexOf(" ")&&(t.spaceSeparated=!0,t.spaceSeparatedCurrency=!0,(t.average||t.forceAverage)&&(t.spaceSeparatedAbbreviation=!0))}(e,t),function(e,t){e.match(/^\+?\([^)]*\)$/)&&(t.negative="parenthesis"),e.match(/^\+?-/)&&(t.negative="sign")}(e,t),function(e,t){e.match(/^\+/)&&(t.forceSign=!0)}(e,t),t)}};function c4(){if(s4)return a4;s4=1;const e=r4(),t=o4(),n=l4;let r,i={},o={},a=null,s={};function l(e){r=e}function c(){return o[r]}return i.languages=()=>Object.assign({},o),i.currentLanguage=()=>r,i.currentBytes=()=>c().bytes||{},i.currentCurrency=()=>c().currency,i.currentAbbreviations=()=>c().abbreviations,i.currentDelimiters=()=>c().delimiters,i.currentOrdinal=()=>c().ordinal,i.currentDefaults=()=>Object.assign({},c().defaults,s),i.currentOrdinalDefaultFormat=()=>Object.assign({},i.currentDefaults(),c().ordinalFormat),i.currentByteDefaultFormat=()=>Object.assign({},i.currentDefaults(),c().byteFormat),i.currentPercentageDefaultFormat=()=>Object.assign({},i.currentDefaults(),c().percentageFormat),i.currentCurrencyDefaultFormat=()=>Object.assign({},i.currentDefaults(),c().currencyFormat),i.currentTimeDefaultFormat=()=>Object.assign({},i.currentDefaults(),c().timeFormat),i.setDefaults=e=>{e=n.parseFormat(e),t.validateFormat(e)&&(s=e)},i.getZeroFormat=()=>a,i.setZeroFormat=e=>a="string"===typeof e?e:null,i.hasZeroFormat=()=>null!==a,i.languageData=e=>{if(e){if(o[e])return o[e];throw new Error('Unknown tag "'.concat(e,'"'))}return c()},i.registerLanguage=function(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t.validateLanguage(e))throw new Error("Invalid language data");o[e.languageTag]=e,n&&l(e.languageTag)},i.setLanguage=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.languageTag;if(!o[t]){let e=t.split("-")[0],r=Object.keys(o).find(t=>t.split("-")[0]===e);return o[r]?void l(r):void l(n)}l(t)},i.registerLanguage(e),r=e.languageTag,a4=i}function u4(e,t){e.forEach(e=>{let n;try{n=function(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}("../languages/".concat(e))}catch(qb){console.error('Unable to load "'.concat(e,'". No matching language file found.'))}n&&t.registerLanguage(n)})}var d4,h4={exports:{}};d4=h4,function(e){var t,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,r=Math.ceil,i=Math.floor,o="[BigNumber Error] ",a=o+"Number primitive has more than 15 significant digits: ",s=1e14,l=14,c=9007199254740991,u=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,h=1e9;function f(e){var t=0|e;return e>0||e===t?t:t-1}function m(e){for(var t,n,r=1,i=e.length,o=e[0]+"";r<i;){for(t=e[r++]+"",n=l-t.length;n--;t="0"+t);o+=t}for(i=o.length;48===o.charCodeAt(--i););return o.slice(0,i+1||1)}function p(e,t){var n,r,i=e.c,o=t.c,a=e.s,s=t.s,l=e.e,c=t.e;if(!a||!s)return null;if(n=i&&!i[0],r=o&&!o[0],n||r)return n?r?0:-s:a;if(a!=s)return a;if(n=a<0,r=l==c,!i||!o)return r?0:!i^n?1:-1;if(!r)return l>c^n?1:-1;for(s=(l=i.length)<(c=o.length)?l:c,a=0;a<s;a++)if(i[a]!=o[a])return i[a]>o[a]^n?1:-1;return l==c?0:l>c^n?1:-1}function g(e,t,n,r){if(e<t||e>n||e!==i(e))throw Error(o+(r||"Argument")+("number"==typeof e?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function v(e){var t=e.c.length-1;return f(e.e/l)==t&&e.c[t]%2!=0}function y(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function b(e,t,n){var r,i;if(t<0){for(i=n+".";++t;i+=n);e=i+e}else if(++t>(r=e.length)){for(i=n,t-=r;--t;i+=n);e+=i}else t<r&&(e=e.slice(0,t)+"."+e.slice(t));return e}t=function e(t){var w,x,S,C=F.prototype={constructor:F,toString:null,valueOf:null},E=new F(1),N=20,T=4,A=-7,R=21,k=-1e7,M=1e7,D=!1,_=1,O=0,I={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xa0",suffix:""},P="0123456789abcdefghijklmnopqrstuvwxyz",j=!0;function F(e,t){var r,o,s,u,d,h,f,m,p=this;if(!(p instanceof F))return new F(e,t);if(null==t){if(e&&!0===e._isBigNumber)return p.s=e.s,void(!e.c||e.e>M?p.c=p.e=null:e.e<k?p.c=[p.e=0]:(p.e=e.e,p.c=e.c.slice()));if((h="number"==typeof e)&&0*e==0){if(p.s=1/e<0?(e=-e,-1):1,e===~~e){for(u=0,d=e;d>=10;d/=10,u++);return void(u>M?p.c=p.e=null:(p.e=u,p.c=[e]))}m=String(e)}else{if(!n.test(m=String(e)))return S(p,m,h);p.s=45==m.charCodeAt(0)?(m=m.slice(1),-1):1}(u=m.indexOf("."))>-1&&(m=m.replace(".","")),(d=m.search(/e/i))>0?(u<0&&(u=d),u+=+m.slice(d+1),m=m.substring(0,d)):u<0&&(u=m.length)}else{if(g(t,2,P.length,"Base"),10==t&&j)return z(p=new F(e),N+p.e+1,T);if(m=String(e),h="number"==typeof e){if(0*e!=0)return S(p,m,h,t);if(p.s=1/e<0?(m=m.slice(1),-1):1,F.DEBUG&&m.replace(/^0\.0*|\./,"").length>15)throw Error(a+e)}else p.s=45===m.charCodeAt(0)?(m=m.slice(1),-1):1;for(r=P.slice(0,t),u=d=0,f=m.length;d<f;d++)if(r.indexOf(o=m.charAt(d))<0){if("."==o){if(d>u){u=f;continue}}else if(!s&&(m==m.toUpperCase()&&(m=m.toLowerCase())||m==m.toLowerCase()&&(m=m.toUpperCase()))){s=!0,d=-1,u=0;continue}return S(p,String(e),h,t)}h=!1,(u=(m=x(m,t,10,p.s)).indexOf("."))>-1?m=m.replace(".",""):u=m.length}for(d=0;48===m.charCodeAt(d);d++);for(f=m.length;48===m.charCodeAt(--f););if(m=m.slice(d,++f)){if(f-=d,h&&F.DEBUG&&f>15&&(e>c||e!==i(e)))throw Error(a+p.s*e);if((u=u-d-1)>M)p.c=p.e=null;else if(u<k)p.c=[p.e=0];else{if(p.e=u,p.c=[],d=(u+1)%l,u<0&&(d+=l),d<f){for(d&&p.c.push(+m.slice(0,d)),f-=l;d<f;)p.c.push(+m.slice(d,d+=l));d=l-(m=m.slice(d)).length}else d-=f;for(;d--;m+="0");p.c.push(+m)}}else p.c=[p.e=0]}function H(e,t,n,r){var i,o,a,s,l;if(null==n?n=T:g(n,0,8),!e.c)return e.toString();if(i=e.c[0],a=e.e,null==t)l=m(e.c),l=1==r||2==r&&(a<=A||a>=R)?y(l,a):b(l,a,"0");else if(o=(e=z(new F(e),t,n)).e,s=(l=m(e.c)).length,1==r||2==r&&(t<=o||o<=A)){for(;s<t;l+="0",s++);l=y(l,o)}else if(t-=a,l=b(l,o,"0"),o+1>s){if(--t>0)for(l+=".";t--;l+="0");}else if((t+=o-s)>0)for(o+1==s&&(l+=".");t--;l+="0");return e.s<0&&i?"-"+l:l}function L(e,t){for(var n,r,i=1,o=new F(e[0]);i<e.length;i++)(!(r=new F(e[i])).s||(n=p(o,r))===t||0===n&&o.s===t)&&(o=r);return o}function B(e,t,n){for(var r=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,r++);return(n=r+n*l-1)>M?e.c=e.e=null:n<k?e.c=[e.e=0]:(e.e=n,e.c=t),e}function z(e,t,n,o){var a,c,d,h,f,m,p,g=e.c,v=u;if(g){e:{for(a=1,h=g[0];h>=10;h/=10,a++);if((c=t-a)<0)c+=l,d=t,f=g[m=0],p=i(f/v[a-d-1]%10);else if((m=r((c+1)/l))>=g.length){if(!o)break e;for(;g.length<=m;g.push(0));f=p=0,a=1,d=(c%=l)-l+1}else{for(f=h=g[m],a=1;h>=10;h/=10,a++);p=(d=(c%=l)-l+a)<0?0:i(f/v[a-d-1]%10)}if(o=o||t<0||null!=g[m+1]||(d<0?f:f%v[a-d-1]),o=n<4?(p||o)&&(0==n||n==(e.s<0?3:2)):p>5||5==p&&(4==n||o||6==n&&(c>0?d>0?f/v[a-d]:0:g[m-1])%10&1||n==(e.s<0?8:7)),t<1||!g[0])return g.length=0,o?(t-=e.e+1,g[0]=v[(l-t%l)%l],e.e=-t||0):g[0]=e.e=0,e;if(0==c?(g.length=m,h=1,m--):(g.length=m+1,h=v[l-c],g[m]=d>0?i(f/v[a-d]%v[d])*h:0),o)for(;;){if(0==m){for(c=1,d=g[0];d>=10;d/=10,c++);for(d=g[0]+=h,h=1;d>=10;d/=10,h++);c!=h&&(e.e++,g[0]==s&&(g[0]=1));break}if(g[m]+=h,g[m]!=s)break;g[m--]=0,h=1}for(c=g.length;0===g[--c];g.pop());}e.e>M?e.c=e.e=null:e.e<k&&(e.c=[e.e=0])}return e}function W(e){var t,n=e.e;return null===n?e.toString():(t=m(e.c),t=n<=A||n>=R?y(t,n):b(t,n,"0"),e.s<0?"-"+t:t)}return F.clone=e,F.ROUND_UP=0,F.ROUND_DOWN=1,F.ROUND_CEIL=2,F.ROUND_FLOOR=3,F.ROUND_HALF_UP=4,F.ROUND_HALF_DOWN=5,F.ROUND_HALF_EVEN=6,F.ROUND_HALF_CEIL=7,F.ROUND_HALF_FLOOR=8,F.EUCLID=9,F.config=F.set=function(e){var t,n;if(null!=e){if("object"!=typeof e)throw Error(o+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(g(n=e[t],0,h,t),N=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(g(n=e[t],0,8,t),T=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((n=e[t])&&n.pop?(g(n[0],-h,0,t),g(n[1],0,h,t),A=n[0],R=n[1]):(g(n,-h,h,t),A=-(R=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if((n=e[t])&&n.pop)g(n[0],-h,-1,t),g(n[1],1,h,t),k=n[0],M=n[1];else{if(g(n,-h,h,t),!n)throw Error(o+t+" cannot be zero: "+n);k=-(M=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error(o+t+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw D=!n,Error(o+"crypto unavailable");D=n}else D=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(g(n=e[t],0,9,t),_=n),e.hasOwnProperty(t="POW_PRECISION")&&(g(n=e[t],0,h,t),O=n),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(n=e[t]))throw Error(o+t+" not an object: "+n);I=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(n))throw Error(o+t+" invalid: "+n);j="0123456789"==n.slice(0,10),P=n}}return{DECIMAL_PLACES:N,ROUNDING_MODE:T,EXPONENTIAL_AT:[A,R],RANGE:[k,M],CRYPTO:D,MODULO_MODE:_,POW_PRECISION:O,FORMAT:I,ALPHABET:P}},F.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!F.DEBUG)return!0;var t,n,r=e.c,a=e.e,c=e.s;e:if("[object Array]"=={}.toString.call(r)){if((1===c||-1===c)&&a>=-h&&a<=h&&a===i(a)){if(0===r[0]){if(0===a&&1===r.length)return!0;break e}if((t=(a+1)%l)<1&&(t+=l),String(r[0]).length==t){for(t=0;t<r.length;t++)if((n=r[t])<0||n>=s||n!==i(n))break e;if(0!==n)return!0}}}else if(null===r&&null===a&&(null===c||1===c||-1===c))return!0;throw Error(o+"Invalid BigNumber: "+e)},F.maximum=F.max=function(){return L(arguments,-1)},F.minimum=F.min=function(){return L(arguments,1)},F.random=function(){var e=9007199254740992,t=Math.random()*e&2097151?function(){return i(Math.random()*e)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)};return function(e){var n,a,s,c,d,f=0,m=[],p=new F(E);if(null==e?e=N:g(e,0,h),c=r(e/l),D)if(crypto.getRandomValues){for(n=crypto.getRandomValues(new Uint32Array(c*=2));f<c;)(d=131072*n[f]+(n[f+1]>>>11))>=9e15?(a=crypto.getRandomValues(new Uint32Array(2)),n[f]=a[0],n[f+1]=a[1]):(m.push(d%1e14),f+=2);f=c/2}else{if(!crypto.randomBytes)throw D=!1,Error(o+"crypto unavailable");for(n=crypto.randomBytes(c*=7);f<c;)(d=281474976710656*(31&n[f])+1099511627776*n[f+1]+4294967296*n[f+2]+16777216*n[f+3]+(n[f+4]<<16)+(n[f+5]<<8)+n[f+6])>=9e15?crypto.randomBytes(7).copy(n,f):(m.push(d%1e14),f+=7);f=c/7}if(!D)for(;f<c;)(d=t())<9e15&&(m[f++]=d%1e14);for(c=m[--f],e%=l,c&&e&&(d=u[l-e],m[f]=i(c/d)*d);0===m[f];m.pop(),f--);if(f<0)m=[s=0];else{for(s=-1;0===m[0];m.splice(0,1),s-=l);for(f=1,d=m[0];d>=10;d/=10,f++);f<l&&(s-=l-f)}return p.e=s,p.c=m,p}}(),F.sum=function(){for(var e=1,t=arguments,n=new F(t[0]);e<t.length;)n=n.plus(t[e++]);return n},x=function(){var e="0123456789";function t(e,t,n,r){for(var i,o,a=[0],s=0,l=e.length;s<l;){for(o=a.length;o--;a[o]*=t);for(a[0]+=r.indexOf(e.charAt(s++)),i=0;i<a.length;i++)a[i]>n-1&&(null==a[i+1]&&(a[i+1]=0),a[i+1]+=a[i]/n|0,a[i]%=n)}return a.reverse()}return function(n,r,i,o,a){var s,l,c,u,d,h,f,p,g=n.indexOf("."),v=N,y=T;for(g>=0&&(u=O,O=0,n=n.replace(".",""),h=(p=new F(r)).pow(n.length-g),O=u,p.c=t(b(m(h.c),h.e,"0"),10,i,e),p.e=p.c.length),c=u=(f=t(n,r,i,a?(s=P,e):(s=e,P))).length;0==f[--u];f.pop());if(!f[0])return s.charAt(0);if(g<0?--c:(h.c=f,h.e=c,h.s=o,f=(h=w(h,p,v,y,i)).c,d=h.r,c=h.e),g=f[l=c+v+1],u=i/2,d=d||l<0||null!=f[l+1],d=y<4?(null!=g||d)&&(0==y||y==(h.s<0?3:2)):g>u||g==u&&(4==y||d||6==y&&1&f[l-1]||y==(h.s<0?8:7)),l<1||!f[0])n=d?b(s.charAt(1),-v,s.charAt(0)):s.charAt(0);else{if(f.length=l,d)for(--i;++f[--l]>i;)f[l]=0,l||(++c,f=[1].concat(f));for(u=f.length;!f[--u];);for(g=0,n="";g<=u;n+=s.charAt(f[g++]));n=b(n,c,s.charAt(0))}return n}}(),w=function(){function e(e,t,n){var r,i,o,a,s=0,l=e.length,c=t%d,u=t/d|0;for(e=e.slice();l--;)s=((i=c*(o=e[l]%d)+(r=u*o+(a=e[l]/d|0)*c)%d*d+s)/n|0)+(r/d|0)+u*a,e[l]=i%n;return s&&(e=[s].concat(e)),e}function t(e,t,n,r){var i,o;if(n!=r)o=n>r?1:-1;else for(i=o=0;i<n;i++)if(e[i]!=t[i]){o=e[i]>t[i]?1:-1;break}return o}function n(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(r,o,a,c,u){var d,h,m,p,g,v,y,b,w,x,S,C,E,N,T,A,R,k=r.s==o.s?1:-1,M=r.c,D=o.c;if(!M||!M[0]||!D||!D[0])return new F(r.s&&o.s&&(M?!D||M[0]!=D[0]:D)?M&&0==M[0]||!D?0*k:k/0:NaN);for(w=(b=new F(k)).c=[],k=a+(h=r.e-o.e)+1,u||(u=s,h=f(r.e/l)-f(o.e/l),k=k/l|0),m=0;D[m]==(M[m]||0);m++);if(D[m]>(M[m]||0)&&h--,k<0)w.push(1),p=!0;else{for(N=M.length,A=D.length,m=0,k+=2,(g=i(u/(D[0]+1)))>1&&(D=e(D,g,u),M=e(M,g,u),A=D.length,N=M.length),E=A,S=(x=M.slice(0,A)).length;S<A;x[S++]=0);R=D.slice(),R=[0].concat(R),T=D[0],D[1]>=u/2&&T++;do{if(g=0,(d=t(D,x,A,S))<0){if(C=x[0],A!=S&&(C=C*u+(x[1]||0)),(g=i(C/T))>1)for(g>=u&&(g=u-1),y=(v=e(D,g,u)).length,S=x.length;1==t(v,x,y,S);)g--,n(v,A<y?R:D,y,u),y=v.length,d=1;else 0==g&&(d=g=1),y=(v=D.slice()).length;if(y<S&&(v=[0].concat(v)),n(x,v,S,u),S=x.length,-1==d)for(;t(D,x,A,S)<1;)g++,n(x,A<S?R:D,S,u),S=x.length}else 0===d&&(g++,x=[0]);w[m++]=g,x[0]?x[S++]=M[E]||0:(x=[M[E]],S=1)}while((E++<N||null!=x[0])&&k--);p=null!=x[0],w[0]||w.splice(0,1)}if(u==s){for(m=1,k=w[0];k>=10;k/=10,m++);z(b,a+(b.e=m+h*l-1)+1,c,p)}else b.e=h,b.r=+p;return b}}(),S=function(){var e=/^(-?)0([xbo])(?=\w[\w.]*$)/i,t=/^([^.]+)\.$/,n=/^\.([^.]+)$/,r=/^-?(Infinity|NaN)$/,i=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(a,s,l,c){var u,d=l?s:s.replace(i,"");if(r.test(d))a.s=isNaN(d)?null:d<0?-1:1;else{if(!l&&(d=d.replace(e,function(e,t,n){return u="x"==(n=n.toLowerCase())?16:"b"==n?2:8,c&&c!=u?e:t}),c&&(u=c,d=d.replace(t,"$1").replace(n,"0.$1")),s!=d))return new F(d,u);if(F.DEBUG)throw Error(o+"Not a"+(c?" base "+c:"")+" number: "+s);a.s=null}a.c=a.e=null}}(),C.absoluteValue=C.abs=function(){var e=new F(this);return e.s<0&&(e.s=1),e},C.comparedTo=function(e,t){return p(this,new F(e,t))},C.decimalPlaces=C.dp=function(e,t){var n,r,i,o=this;if(null!=e)return g(e,0,h),null==t?t=T:g(t,0,8),z(new F(o),e+o.e+1,t);if(!(n=o.c))return null;if(r=((i=n.length-1)-f(this.e/l))*l,i=n[i])for(;i%10==0;i/=10,r--);return r<0&&(r=0),r},C.dividedBy=C.div=function(e,t){return w(this,new F(e,t),N,T)},C.dividedToIntegerBy=C.idiv=function(e,t){return w(this,new F(e,t),0,1)},C.exponentiatedBy=C.pow=function(e,t){var n,a,s,c,u,d,h,f,m=this;if((e=new F(e)).c&&!e.isInteger())throw Error(o+"Exponent not an integer: "+W(e));if(null!=t&&(t=new F(t)),u=e.e>14,!m.c||!m.c[0]||1==m.c[0]&&!m.e&&1==m.c.length||!e.c||!e.c[0])return f=new F(Math.pow(+W(m),u?e.s*(2-v(e)):+W(e))),t?f.mod(t):f;if(d=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new F(NaN);(a=!d&&m.isInteger()&&t.isInteger())&&(m=m.mod(t))}else{if(e.e>9&&(m.e>0||m.e<-1||(0==m.e?m.c[0]>1||u&&m.c[1]>=24e7:m.c[0]<8e13||u&&m.c[0]<=9999975e7)))return c=m.s<0&&v(e)?-0:0,m.e>-1&&(c=1/c),new F(d?1/c:c);O&&(c=r(O/l+2))}for(u?(n=new F(.5),d&&(e.s=1),h=v(e)):h=(s=Math.abs(+W(e)))%2,f=new F(E);;){if(h){if(!(f=f.times(m)).c)break;c?f.c.length>c&&(f.c.length=c):a&&(f=f.mod(t))}if(s){if(0===(s=i(s/2)))break;h=s%2}else if(z(e=e.times(n),e.e+1,1),e.e>14)h=v(e);else{if(0===(s=+W(e)))break;h=s%2}m=m.times(m),c?m.c&&m.c.length>c&&(m.c.length=c):a&&(m=m.mod(t))}return a?f:(d&&(f=E.div(f)),t?f.mod(t):c?z(f,O,T,void 0):f)},C.integerValue=function(e){var t=new F(this);return null==e?e=T:g(e,0,8),z(t,t.e+1,e)},C.isEqualTo=C.eq=function(e,t){return 0===p(this,new F(e,t))},C.isFinite=function(){return!!this.c},C.isGreaterThan=C.gt=function(e,t){return p(this,new F(e,t))>0},C.isGreaterThanOrEqualTo=C.gte=function(e,t){return 1===(t=p(this,new F(e,t)))||0===t},C.isInteger=function(){return!!this.c&&f(this.e/l)>this.c.length-2},C.isLessThan=C.lt=function(e,t){return p(this,new F(e,t))<0},C.isLessThanOrEqualTo=C.lte=function(e,t){return-1===(t=p(this,new F(e,t)))||0===t},C.isNaN=function(){return!this.s},C.isNegative=function(){return this.s<0},C.isPositive=function(){return this.s>0},C.isZero=function(){return!!this.c&&0==this.c[0]},C.minus=function(e,t){var n,r,i,o,a=this,c=a.s;if(t=(e=new F(e,t)).s,!c||!t)return new F(NaN);if(c!=t)return e.s=-t,a.plus(e);var u=a.e/l,d=e.e/l,h=a.c,m=e.c;if(!u||!d){if(!h||!m)return h?(e.s=-t,e):new F(m?a:NaN);if(!h[0]||!m[0])return m[0]?(e.s=-t,e):new F(h[0]?a:3==T?-0:0)}if(u=f(u),d=f(d),h=h.slice(),c=u-d){for((o=c<0)?(c=-c,i=h):(d=u,i=m),i.reverse(),t=c;t--;i.push(0));i.reverse()}else for(r=(o=(c=h.length)<(t=m.length))?c:t,c=t=0;t<r;t++)if(h[t]!=m[t]){o=h[t]<m[t];break}if(o&&(i=h,h=m,m=i,e.s=-e.s),(t=(r=m.length)-(n=h.length))>0)for(;t--;h[n++]=0);for(t=s-1;r>c;){if(h[--r]<m[r]){for(n=r;n&&!h[--n];h[n]=t);--h[n],h[r]+=s}h[r]-=m[r]}for(;0==h[0];h.splice(0,1),--d);return h[0]?B(e,h,d):(e.s=3==T?-1:1,e.c=[e.e=0],e)},C.modulo=C.mod=function(e,t){var n,r,i=this;return e=new F(e,t),!i.c||!e.s||e.c&&!e.c[0]?new F(NaN):!e.c||i.c&&!i.c[0]?new F(i):(9==_?(r=e.s,e.s=1,n=w(i,e,0,3),e.s=r,n.s*=r):n=w(i,e,0,_),(e=i.minus(n.times(e))).c[0]||1!=_||(e.s=i.s),e)},C.multipliedBy=C.times=function(e,t){var n,r,i,o,a,c,u,h,m,p,g,v,y,b,w,x=this,S=x.c,C=(e=new F(e,t)).c;if(!S||!C||!S[0]||!C[0])return!x.s||!e.s||S&&!S[0]&&!C||C&&!C[0]&&!S?e.c=e.e=e.s=null:(e.s*=x.s,S&&C?(e.c=[0],e.e=0):e.c=e.e=null),e;for(r=f(x.e/l)+f(e.e/l),e.s*=x.s,(u=S.length)<(p=C.length)&&(y=S,S=C,C=y,i=u,u=p,p=i),i=u+p,y=[];i--;y.push(0));for(b=s,w=d,i=p;--i>=0;){for(n=0,g=C[i]%w,v=C[i]/w|0,o=i+(a=u);o>i;)n=((h=g*(h=S[--a]%w)+(c=v*h+(m=S[a]/w|0)*g)%w*w+y[o]+n)/b|0)+(c/w|0)+v*m,y[o--]=h%b;y[o]=n}return n?++r:y.splice(0,1),B(e,y,r)},C.negated=function(){var e=new F(this);return e.s=-e.s||null,e},C.plus=function(e,t){var n,r=this,i=r.s;if(t=(e=new F(e,t)).s,!i||!t)return new F(NaN);if(i!=t)return e.s=-t,r.minus(e);var o=r.e/l,a=e.e/l,c=r.c,u=e.c;if(!o||!a){if(!c||!u)return new F(i/0);if(!c[0]||!u[0])return u[0]?e:new F(c[0]?r:0*i)}if(o=f(o),a=f(a),c=c.slice(),i=o-a){for(i>0?(a=o,n=u):(i=-i,n=c),n.reverse();i--;n.push(0));n.reverse()}for((i=c.length)-(t=u.length)<0&&(n=u,u=c,c=n,t=i),i=0;t;)i=(c[--t]=c[t]+u[t]+i)/s|0,c[t]=s===c[t]?0:c[t]%s;return i&&(c=[i].concat(c),++a),B(e,c,a)},C.precision=C.sd=function(e,t){var n,r,i,o=this;if(null!=e&&e!==!!e)return g(e,1,h),null==t?t=T:g(t,0,8),z(new F(o),e,t);if(!(n=o.c))return null;if(r=(i=n.length-1)*l+1,i=n[i]){for(;i%10==0;i/=10,r--);for(i=n[0];i>=10;i/=10,r++);}return e&&o.e+1>r&&(r=o.e+1),r},C.shiftedBy=function(e){return g(e,-9007199254740991,c),this.times("1e"+e)},C.squareRoot=C.sqrt=function(){var e,t,n,r,i,o=this,a=o.c,s=o.s,l=o.e,c=N+4,u=new F("0.5");if(1!==s||!a||!a[0])return new F(!s||s<0&&(!a||a[0])?NaN:a?o:1/0);if(0==(s=Math.sqrt(+W(o)))||s==1/0?(((t=m(a)).length+l)%2==0&&(t+="0"),s=Math.sqrt(+t),l=f((l+1)/2)-(l<0||l%2),n=new F(t=s==1/0?"5e"+l:(t=s.toExponential()).slice(0,t.indexOf("e")+1)+l)):n=new F(s+""),n.c[0])for((s=(l=n.e)+c)<3&&(s=0);;)if(i=n,n=u.times(i.plus(w(o,i,c,1))),m(i.c).slice(0,s)===(t=m(n.c)).slice(0,s)){if(n.e<l&&--s,"9999"!=(t=t.slice(s-3,s+1))&&(r||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(z(n,n.e+N+2,1),e=!n.times(n).eq(o));break}if(!r&&(z(i,i.e+N+2,0),i.times(i).eq(o))){n=i;break}c+=4,s+=4,r=1}return z(n,n.e+N+1,T,e)},C.toExponential=function(e,t){return null!=e&&(g(e,0,h),e++),H(this,e,t,1)},C.toFixed=function(e,t){return null!=e&&(g(e,0,h),e=e+this.e+1),H(this,e,t)},C.toFormat=function(e,t,n){var r,i=this;if(null==n)null!=e&&t&&"object"==typeof t?(n=t,t=null):e&&"object"==typeof e?(n=e,e=t=null):n=I;else if("object"!=typeof n)throw Error(o+"Argument not an object: "+n);if(r=i.toFixed(e,t),i.c){var a,s=r.split("."),l=+n.groupSize,c=+n.secondaryGroupSize,u=n.groupSeparator||"",d=s[0],h=s[1],f=i.s<0,m=f?d.slice(1):d,p=m.length;if(c&&(a=l,l=c,c=a,p-=a),l>0&&p>0){for(a=p%l||l,d=m.substr(0,a);a<p;a+=l)d+=u+m.substr(a,l);c>0&&(d+=u+m.slice(a)),f&&(d="-"+d)}r=h?d+(n.decimalSeparator||"")+((c=+n.fractionGroupSize)?h.replace(new RegExp("\\d{"+c+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):h):d}return(n.prefix||"")+r+(n.suffix||"")},C.toFraction=function(e){var t,n,r,i,a,s,c,d,h,f,p,g,v=this,y=v.c;if(null!=e&&(!(c=new F(e)).isInteger()&&(c.c||1!==c.s)||c.lt(E)))throw Error(o+"Argument "+(c.isInteger()?"out of range: ":"not an integer: ")+W(c));if(!y)return new F(v);for(t=new F(E),h=n=new F(E),r=d=new F(E),g=m(y),a=t.e=g.length-v.e-1,t.c[0]=u[(s=a%l)<0?l+s:s],e=!e||c.comparedTo(t)>0?a>0?t:h:c,s=M,M=1/0,c=new F(g),d.c[0]=0;f=w(c,t,0,1),1!=(i=n.plus(f.times(r))).comparedTo(e);)n=r,r=i,h=d.plus(f.times(i=h)),d=i,t=c.minus(f.times(i=t)),c=i;return i=w(e.minus(n),r,0,1),d=d.plus(i.times(h)),n=n.plus(i.times(r)),d.s=h.s=v.s,p=w(h,r,a*=2,T).minus(v).abs().comparedTo(w(d,n,a,T).minus(v).abs())<1?[h,r]:[d,n],M=s,p},C.toNumber=function(){return+W(this)},C.toPrecision=function(e,t){return null!=e&&g(e,1,h),H(this,e,t,2)},C.toString=function(e){var t,n=this,r=n.s,i=n.e;return null===i?r?(t="Infinity",r<0&&(t="-"+t)):t="NaN":(null==e?t=i<=A||i>=R?y(m(n.c),i):b(m(n.c),i,"0"):10===e&&j?t=b(m((n=z(new F(n),N+i+1,T)).c),n.e,"0"):(g(e,2,P.length,"Base"),t=x(b(m(n.c),i,"0"),10,e,r,!0)),r<0&&n.c[0]&&(t="-"+t)),t},C.valueOf=C.toJSON=function(){return W(this)},C._isBigNumber=!0,null!=t&&F.set(t),F}(),t.default=t.BigNumber=t,d4.exports?d4.exports=t:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=t)}(t4);var f4=h4.exports;const m4=c4(),p4=o4(),g4=l4,v4=f4,y4={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},b4={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:w4,decimalSuffixes:x4}=m4.currentBytes(),S4={general:{scale:1024,suffixes:x4,marker:"bd"},binary:{scale:1024,suffixes:w4,marker:"b"},decimal:{scale:1e3,suffixes:x4,marker:"d"}};function C4(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if("string"===typeof t&&(t=g4.parseFormat(t)),!p4.validateFormat(t))return"ERROR: invalid format";let r=t.prefix||"",i=t.postfix||"",o=function(e,t,n){switch(t.output){case"currency":return function(e,t,n){const r=n.currentCurrency();let i,o=Object.assign({},t),a=Object.assign({},b4,o),s="",l=!!a.totalLength||!!a.forceAverage||a.average,c=o.currencyPosition||r.position,u=o.currencySymbol||r.symbol;const d=void 0!==a.spaceSeparatedCurrency?a.spaceSeparatedCurrency:a.spaceSeparated;void 0===o.lowPrecision&&(o.lowPrecision=!1);d&&(s=" ");"infix"===c&&(i=s+u+s);let h=A4({instance:e,providedFormat:o,state:n,decimalSeparator:i});"prefix"===c&&(h=e._value<0&&"sign"===a.negative?"-".concat(s).concat(u).concat(h.slice(1)):e._value>0&&a.forceSign?"+".concat(s).concat(u).concat(h.slice(1)):u+s+h);c&&"postfix"!==c||(s=!a.spaceSeparatedAbbreviation&&l?"":s,h=h+s+u);return h}(e,t=R4(t,m4.currentCurrencyDefaultFormat()),m4);case"percent":return function(e,t,n,r){let i=t.prefixSymbol,o=A4({instance:r(100*e._value),providedFormat:t,state:n}),a=Object.assign({},b4,t);if(i)return"%".concat(a.spaceSeparated?" ":"").concat(o);return"".concat(o).concat(a.spaceSeparated?" ":"","%")}(e,t=R4(t,m4.currentPercentageDefaultFormat()),m4,n);case"byte":return function(e,t,n,r){let i=t.base||"binary",o=Object.assign({},b4,t);const{binarySuffixes:a,decimalSuffixes:s}=n.currentBytes();let l={general:{scale:1024,suffixes:s||x4,marker:"bd"},binary:{scale:1024,suffixes:a||w4,marker:"b"},decimal:{scale:1e3,suffixes:s||x4,marker:"d"}}[i],{value:c,suffix:u}=E4(e._value,l.suffixes,l.scale),d=A4({instance:r(c),providedFormat:t,state:n,defaults:n.currentByteDefaultFormat()});return"".concat(d).concat(o.spaceSeparated?" ":"").concat(u)}(e,t=R4(t,m4.currentByteDefaultFormat()),m4,n);case"time":return t=R4(t,m4.currentTimeDefaultFormat()),function(e){let t=Math.floor(e._value/60/60),n=Math.floor((e._value-60*t*60)/60),r=Math.round(e._value-60*t*60-60*n);return"".concat(t,":").concat(n<10?"0":"").concat(n,":").concat(r<10?"0":"").concat(r)}(e);case"ordinal":return function(e,t,n){let r=n.currentOrdinal(),i=Object.assign({},b4,t),o=A4({instance:e,providedFormat:t,state:n}),a=r(e._value);return"".concat(o).concat(i.spaceSeparated?" ":"").concat(a)}(e,t=R4(t,m4.currentOrdinalDefaultFormat()),m4);default:return A4({instance:e,providedFormat:t,numbro:n})}}(e,t,n);return o=function(e,t){return t+e}(o,r),o=function(e,t){return e+t}(o,i),o}function E4(e,t,n){let r=t[0],i=Math.abs(e);if(i>=n){for(let o=1;o<t.length;++o){let a=Math.pow(n,o),s=Math.pow(n,o+1);if(i>=a&&i<s){r=t[o],e/=a;break}}r===t[0]&&(e/=Math.pow(n,t.length-1),r=t[t.length-1])}return{value:e,suffix:r}}function N4(e){let t="";for(let n=0;n<e;n++)t+="0";return t}function T4(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Math.round;if(-1!==e.toString().indexOf("e"))return function(e,t){let n=e.toString(),[r,i]=n.split("e"),[o,a=""]=r.split(".");if(+i>0)n=o+a+N4(i-a.length);else{let e=".";e=+o<0?"-0".concat(e):"0".concat(e);let r=(N4(-i-1)+Math.abs(o)+a).substr(0,t);r.length<t&&(r+=N4(t-r.length)),n=e+r}return+i>0&&t>0&&(n+=".".concat(N4(t))),n}(e,t);return new v4(n(+"".concat(e,"e+").concat(t))/Math.pow(10,t)).toFixed(t)}function A4(e){let{instance:t,providedFormat:n,state:r=m4,decimalSeparator:i,defaults:o=r.currentDefaults()}=e,a=t._value;if(0===a&&r.hasZeroFormat())return r.getZeroFormat();if(!isFinite(a))return a.toString();let s=Object.assign({},b4,o,n),l=s.totalLength,c=l?0:s.characteristic,u=s.optionalCharacteristic,d=s.forceAverage,h=s.lowPrecision,f=!!l||!!d||s.average,m=l?-1:f&&void 0===n.mantissa?0:s.mantissa,p=!l&&(void 0===n.optionalMantissa?-1===m:s.optionalMantissa),g=s.trimMantissa,v=s.thousandSeparated,y=s.spaceSeparated,b=s.negative,w=s.forceSign,x=s.exponential,S=s.roundingFunction,C="";if(f){let e=function(e){let{value:t,forceAverage:n,lowPrecision:r=!0,abbreviations:i,spaceSeparated:o=!1,totalLength:a=0,roundingFunction:s=Math.round}=e,l="",c=Math.abs(t),u=-1;if(n&&i[n]&&y4[n]?(l=i[n],t/=y4[n]):c>=y4.trillion||r&&1===s(c/y4.trillion)?(l=i.trillion,t/=y4.trillion):c<y4.trillion&&c>=y4.billion||r&&1===s(c/y4.billion)?(l=i.billion,t/=y4.billion):c<y4.billion&&c>=y4.million||r&&1===s(c/y4.million)?(l=i.million,t/=y4.million):(c<y4.million&&c>=y4.thousand||r&&1===s(c/y4.thousand))&&(l=i.thousand,t/=y4.thousand),l&&(l=(o?" ":"")+l),a){let e=t<0,n=t.toString().split(".")[0],r=e?n.length-1:n.length;u=Math.max(a-r,0)}return{value:t,abbreviation:l,mantissaPrecision:u}}({value:a,forceAverage:d,lowPrecision:h,abbreviations:r.currentAbbreviations(),spaceSeparated:y,roundingFunction:S,totalLength:l});a=e.value,C+=e.abbreviation,l&&(m=e.mantissaPrecision)}if(x){let e=function(e){let{value:t,characteristicPrecision:n}=e,[r,i]=t.toExponential().split("e"),o=+r;return n?(1<n&&(o*=Math.pow(10,n-1),i=+i-(n-1),i=i>=0?"+".concat(i):i),{value:o,abbreviation:"e".concat(i)}):{value:o,abbreviation:"e".concat(i)}}({value:a,characteristicPrecision:c});a=e.value,C=e.abbreviation+C}let E=function(e,t,n,r,i,o){if(-1===r)return e;let a=T4(t,r,o),[s,l=""]=a.toString().split(".");if(l.match(/^0+$/)&&(n||i))return s;let c=l.match(/0+$/);return i&&c?"".concat(s,".").concat(l.toString().slice(0,c.index)):a.toString()}(a.toString(),a,p,m,g,S);return E=function(e,t,n,r){let i=e,[o,a]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return a?"".concat(o.replace("0",""),".").concat(a):o.replace("0","");const s=t<0&&0===o.indexOf("-");if(s&&(o=o.slice(1),i=i.slice(1)),o.length<r){let e=r-o.length;for(let t=0;t<e;t++)i="0".concat(i)}return s&&(i="-".concat(i)),i.toString()}(E,a,u,c),E=function(e,t,n,r,i){let o=r.currentDelimiters(),a=o.thousands;i=i||o.decimal;let s=o.thousandsSize||3,l=e.toString(),c=l.split(".")[0],u=l.split(".")[1];const d=t<0&&0===c.indexOf("-");if(n){d&&(c=c.slice(1));let e=function(e,t){let n=[],r=0;for(let i=e;i>0;i--)r===t&&(n.unshift(i),r=0),r++;return n}(c.length,s);e.forEach((e,t)=>{c=c.slice(0,e+t)+a+c.slice(e+t)}),d&&(c="-".concat(c))}return l=u?c+i+u:c,l}(E,a,v,r,i),(f||x)&&(E=function(e,t){return e+t}(E,C)),(w||a<0)&&(E=function(e,t,n){return 0===t?e:0===+e?e.replace("-",""):t>0?"+".concat(e):"sign"===n?e:"(".concat(e.replace("-",""),")")}(E,a,b)),E}function R4(e,t){if(!e)return t;let n=Object.keys(e);return 1===n.length&&"output"===n[0]?t:e}const k4=f4;function M4(e,t,n){let r=new k4(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new k4(i),e._value=r.minus(i).toNumber(),e}const D4=c4(),_4=o4(),O4=(e=>({loadLanguagesInNode:t=>u4(t,e)}))(B4),I4=i4();let P4=(e=>({format:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return C4(...n,e)},getByteUnit:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return function(e){let t=S4.general;return E4(e._value,t.suffixes,t.scale).suffix}(...n,e)},getBinaryByteUnit:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return function(e){let t=S4.binary;return E4(e._value,t.suffixes,t.scale).suffix}(...n,e)},getDecimalByteUnit:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return function(e){let t=S4.decimal;return E4(e._value,t.suffixes,t.scale).suffix}(...n,e)},formatOrDefault:R4}))(B4),j4=(e=>({add:(t,n)=>function(e,t,n){let r=new k4(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new k4(i),e._value=r.plus(i).toNumber(),e}(t,n,e),subtract:(t,n)=>M4(t,n,e),multiply:(t,n)=>function(e,t,n){let r=new k4(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new k4(i),e._value=r.times(i).toNumber(),e}(t,n,e),divide:(t,n)=>function(e,t,n){let r=new k4(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new k4(i),e._value=r.dividedBy(i).toNumber(),e}(t,n,e),set:(t,n)=>function(e,t,n){let r=t;return n.isNumbro(t)&&(r=t._value),e._value=r,e}(t,n,e),difference:(t,n)=>function(e,t,n){let r=n(e._value);return M4(r,t,n),Math.abs(r._value)}(t,n,e),BigNumber:k4}))(B4);const F4=l4;class H4{constructor(e){this._value=e}clone(){return B4(this._value)}format(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return P4.format(this,e)}formatCurrency(e){return"string"===typeof e&&(e=F4.parseFormat(e)),(e=P4.formatOrDefault(e,D4.currentCurrencyDefaultFormat())).output="currency",P4.format(this,e)}formatTime(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.output="time",P4.format(this,e)}binaryByteUnits(){return P4.getBinaryByteUnit(this)}decimalByteUnits(){return P4.getDecimalByteUnit(this)}byteUnits(){return P4.getByteUnit(this)}difference(e){return j4.difference(this,e)}add(e){return j4.add(this,e)}subtract(e){return j4.subtract(this,e)}multiply(e){return j4.multiply(this,e)}divide(e){return j4.divide(this,e)}set(e){return j4.set(this,L4(e))}value(){return this._value}valueOf(){return this._value}}function L4(e){let t=e;return B4.isNumbro(e)?t=e._value:"string"===typeof e?t=B4.unformat(e):isNaN(e)&&(t=NaN),t}function B4(e){return new H4(L4(e))}B4.version="2.5.0",B4.isNumbro=function(e){return e instanceof H4},B4.language=D4.currentLanguage,B4.registerLanguage=D4.registerLanguage,B4.setLanguage=D4.setLanguage,B4.languages=D4.languages,B4.languageData=D4.languageData,B4.zeroFormat=D4.setZeroFormat,B4.defaultFormat=D4.currentDefaults,B4.setDefaults=D4.setDefaults,B4.defaultCurrencyFormat=D4.currentCurrencyDefaultFormat,B4.validate=_4.validate,B4.loadLanguagesInNode=O4.loadLanguagesInNode,B4.unformat=I4.unformat,B4.BigNumber=j4.BigNumber;var z4=n4(B4);function W4(e,t){if(uV(e)){const n=t.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if("undefined"!==typeof r&&!z4.languages()[r]){const e=r.replace("-",""),t=z4.allLanguages?z4.allLanguages[r]:z4[e];t&&z4.registerLanguage(t)}z4.setLanguage(r),e=z4(e).format(i||"0")}return e}function V4(e,t,n,r,i,o,a){let s=o;if(uV(s)){let e=[];if(Array.isArray(a.className))e=a.className;else{var l;const t=null!==(l=a.className)&&void 0!==l?l:"";t.length&&(e=t.split(" "))}s=W4(s,a),e.indexOf("htLeft")<0&&e.indexOf("htCenter")<0&&e.indexOf("htRight")<0&&e.indexOf("htJustify")<0&&e.push("htRight"),e.indexOf("htNumeric")<0&&e.push("htNumeric"),a.className=e.join(" "),t.dir="ltr"}$1(e,t,n,r,i,s,a)}V4.RENDERER_TYPE="numeric";function U4(e,t,n,r,i,o,a){$1.apply(this,[e,t,n,r,i,o,a]);const s=a.hashLength||t.innerHTML.length,l=a.hashSymbol||"*";let c="";hV(s-1,()=>{c+=l}),tz(t,c)}U4.RENDERER_TYPE="password";function q4(e,t,n,r,i,o,a){$1.apply(this,[e,t,n,r,i,o,a])}q4.RENDERER_TYPE="select";function G4(e,t,n,r,i,o,a){$1.apply(this,[e,t,n,r,i,o,a]),t.dir="ltr"}G4.RENDERER_TYPE="time";function Y4(e,t){let n=e;null!==n&&void 0!==n||(n=""),this.allowEmpty&&""===n?t(!0):this.strict&&this.source?"function"===typeof this.source?this.source(n,K4(n,t)):K4(n,t)(this.source):t(!0)}function K4(e,t){const n=e;return function(e){let r=!1;for(let t=0,i=e.length;t<i;t++)if(eB(n,e[t])){r=!0;break}t(r)}}function $4(e){const t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+6e4*t.getTimezoneOffset())}Y4.VALIDATOR_TYPE="autocomplete";function X4(e,t){const n=UW(E3,this.instance);let r=e,i=!0;null!==r&&void 0!==r||(r="");let o=PH(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),a=PH(new Date(r)).isValid()||o;if(this.allowEmpty&&""===r&&(a=!0,o=!0),a||(i=!1),!a&&o&&(i=!0),a&&!o)if(!0===this.correctFormat){const e=function(e,t){const n=PH($4(e)),r=PH(e,t),i=e.search(/[A-Za-z]/g)>-1;let o;o=n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?n:r;return o.format(t)}(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,e,"dateValidator"),i=!0}else i=!1;t(i)}X4.VALIDATOR_TYPE="date";function Q4(e,t){Y4.apply(this,[e,t])}Q4.VALIDATOR_TYPE="dropdown";function J4(e,t){let n=e;null!==n&&void 0!==n||(n=""),this.allowEmpty&&""===n?t(!0):t(""!==n&&uV(e))}J4.VALIDATOR_TYPE="numeric";const Z4=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function e5(e,t){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=e;null===i&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const a=PH(i,Z4,!0).isValid()?PH(i):PH(i,n);let s=a.isValid(),l=PH(i,n,!0).isValid()&&!o;if(this.allowEmpty&&""===i&&(s=!0,l=!0),s||(r=!1),!s&&l&&(r=!0),s&&!l)if(!0===this.correctFormat){const e=a.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,e,"timeValidator"),r=!0}else r=!1;t(r)}function t5(e){return tB(e)&&void 0!==e.value?e.value:e}function n5(e,t,n){const r=e=>tB(e)&&nL(e.key)&&nL(e.value);return r(this.getSourceDataAtCell(this.toPhysicalRow(t),this.toPhysicalColumn(n)))?r(e)?e:{key:e,value:e}:e}e5.VALIDATOR_TYPE="time";const r5={CELL_TYPE:"autocomplete",editor:q2,renderer:H3,validator:Y4,valueGetter:t5,valueSetter:n5};const i5={CELL_TYPE:"checkbox",editor:K2,renderer:G3,valueSetter:function(e,t,n){const{checkedTemplate:r,uncheckedTemplate:i}=this.getCellMeta(t,n),o=tL(e),a=o===tL(r),s=o===tL(i);return a||s?a?r:i:e}};function o5(e,t,n,r,i,o,a){H3.apply(this,[e,t,n,r,i,o,a])}o5.RENDERER_TYPE="date";const a5={CELL_TYPE:"date",editor:A3,renderer:o5,validator:X4};const s5={CELL_TYPE:"dropdown",editor:k3,renderer:L3,validator:Q4,filter:!1,strict:!0,valueGetter:function(e){return t5.call(this,e)},valueSetter:function(e,t,n,r){return n5.call(this,e,t,n,r)}},l5={CELL_TYPE:"handsontable",editor:j2,renderer:K3};const c5={CELL_TYPE:"numeric",editor:M3,renderer:V4,validator:J4,dataType:"number",valueSetter:function(e){if("string"===typeof e&&dV(e)){const t=gV(e);return OJ(t)?e:t}return e}},u5={CELL_TYPE:"password",editor:_3,renderer:U4,copyable:!1},d5={CELL_TYPE:"select",editor:P3,renderer:q4},h5={CELL_TYPE:"time",editor:j3,renderer:G4,validator:e5};function f5(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m5(e,t,n){p5(e,t),t.set(e,n)}function p5(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function g5(e,t,n){return e.set(y5(e,t),n),n}function v5(e,t){return e.get(y5(e,t))}function y5(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const b5=new Map([["plugin",function(e){return!!MV(e)}],["cell-type",TJ],["editor",BW],["renderer",IV],["validator",zV]]),w5=Symbol("mainSetting"),x5=[];let S5=null;var C5=new WeakMap,E5=new WeakMap,N5=new WeakSet;class T5{static get PLUGIN_KEY(){return"base"}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}static get SETTINGS_VALIDATORS(){return null}constructor(e){!function(e,t){p5(e,t),t.add(e)}(this,N5),m5(this,C5,null),f5(this,"eventManager",new $W(this)),f5(this,"pluginName",null),f5(this,"pluginsInitializedCallbacks",[]),f5(this,"isPluginsReady",!1),f5(this,"enabled",!1),f5(this,"initialized",!1),m5(this,E5,{}),nB(this,"hot",e,{writable:!1}),S5=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",e=>this.onUpdateSettings(e)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this),this.updatePluginSettings(this.hot.getSettings()[this.constructor.PLUGIN_KEY]);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const e=[];if(t.forEach(t=>{const[n,r]=t.split(":");if(!b5.has(n))throw new Error('Unknown plugin dependency type "'.concat(n,'" was found.'));b5.get(n)(r)||e.push(" - ".concat(r," (").concat(n,")"))}),e.length>0){const t=["The ".concat(this.pluginName," plugin requires the following modules:\n"),"".concat(e.join("\n"),"\n")].join("");x5.push(t)}}S5||(S5=kV()),S5.indexOf(this.pluginName)>=0&&S5.splice(S5.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()});if(0===S5.length){if(x5.length>0){const e=["".concat(x5.join("\n"),"\n"),"You have to import and register them manually."].join("");throw x5.length=0,new Error(e)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;null===(e=this.eventManager)||void 0===e||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){var t=this;const n=this.constructor.DEFAULT_SETTINGS,r=this.constructor.SETTINGS_VALIDATORS;if(void 0===e)return tB(v5(C5,this))?cB(v5(C5,this),n):v5(C5,this);let i;var o;if((Array.isArray(v5(C5,this))||tB(v5(C5,this)))&&n[w5]===e)i=Array.isArray(v5(C5,this))?v5(C5,this):null!==(o=v5(C5,this)[e])&&void 0!==o?o:n[e];else if(e.includes(".")){const t=iB(v5(C5,this),e),r=iB(n,e);i=tB(t)?cB(t,r):void 0!==t?t:r}else i=tB(v5(C5,this))?cB(v5(C5,this),n)[e]:n[e];if("function"===typeof i&&r&&"object"===typeof r){const n=r[e];if(n&&"function"===typeof n)return function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];const s=i(...o);if(!1===n(s)){const n=o.map(e=>"string"===typeof e?'"'.concat(e,'"'):"").join(", "),r=o.length>0?n:"";return void hW("".concat(t.pluginName,' Plugin: "').concat(e,'" function (').concat(r,") result                is not valid and will be ignored."))}return s}}return i}updatePluginSettings(e){const t=this.constructor.SETTINGS_VALIDATORS;if(t&&"function"===typeof t&&"object"!==typeof e){return!1===t(e)?void hW("".concat(this.pluginName," Plugin: option is not valid and it will be ignored.")):(g5(C5,this,e),v5(C5,this))}return t&&"object"===typeof t&&"object"===typeof e?(null!==v5(C5,this)&&"object"===typeof v5(C5,this)||g5(C5,this,E({},this.constructor.DEFAULT_SETTINGS)),Object.keys(t).forEach(n=>{if(!(n in e))return;const r=t[n];!1!==(!r||r(e[n]))?v5(C5,this)[n]=e[n]:hW("".concat(this.pluginName,' Plugin: "').concat(n,'" option is not valid and it will be ignored.'))}),v5(C5,this)):(g5(C5,this,e),e)}addHook(e,t,n){v5(E5,this)[e]=v5(E5,this)[e]||[];const r=v5(E5,this)[e];this.hot.addHook(e,t,n),r.push(t),v5(E5,this)[e]=r}removeHooks(e){WH(v5(E5,this)[e]||[],t=>{this.hot.removeHook(e,t)})}clearHooks(){const e=v5(E5,this);rB(e,(e,t)=>this.removeHooks(t)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){WH(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=y5(N5,this,A5).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&(this.updatePluginSettings(e[this.constructor.PLUGIN_KEY]),this.updatePlugin(e)))}updatePlugin(){}destroy(){var e;g5(C5,this,null),null===(e=this.eventManager)||void 0===e||e.destroy(),this.clearHooks(),rB(this,(e,t)=>{"hot"!==t&&(this[t]=null)}),delete this.t,delete this.hot}}function A5(e){if(!e)return!1;const t=this.constructor.SETTING_KEYS;if("boolean"===typeof t)return t;for(let n=0;n<t.length;n++)if(void 0!==e[t[n]])return!0;return!1}function R5(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const k5=class{constructor(e){R5(this,"hot",null),R5(this,"container",null),R5(this,"injected",!1),R5(this,"rows",[]),R5(this,"columns",[]),R5(this,"samples",null),R5(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(null!==t&&void 0!==t){const t={row:-1};this.rows.push(t),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),t.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(e)&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),WH(this.rows,t=>{const{height:n}=t.table.getBoundingClientRect();e(t.row,Math.ceil(n))})}getWidths(e){this.injected||this.injectTable(),WH(this.columns,t=>{const{width:n}=t.table.getBoundingClientRect();e(t.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{WH(n.strings,n=>{t.appendChild(this.createColElement(n.col,e))})}),t}createRow(e){const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),r=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,r),n.appendChild(r)),this.samples.forEach(r=>{WH(r.strings,r=>{const i=r.col,o=this.hot.getCellMeta(e,i),a=this.hot.getCellRenderer(o),s=t.createElement("td");s.setAttribute("ghost-table",1),a(this.hot,s,e,i,this.hot.colToProp(i),r.value,o),n.appendChild(s)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const r=e.createElement("th");n.push([-1,r]),t.appendChild(r)}this.samples.forEach(r=>{WH(r.strings,r=>{const i=r.col,o=e.createElement("th");n.push([i,o]),t.appendChild(o)})}),this.table.tHead.appendChild(t),WH(n,e=>{const[t,n]=e;this.hot.view.appendColHeader(t,n)})}createCol(e){const{rootDocument:t}=this.hot,n=t.createDocumentFragment();return this.samples.forEach(r=>{WH(r.strings,r=>{const i=r.row,o=this.hot.getCellMeta(i,e),a=this.hot.getCellRenderer(o),s=t.createElement("td"),l=t.createElement("tr");s.setAttribute("ghost-table",1),a(this.hot,s,i,e,this.hot.colToProp(e),r.value,o),l.appendChild(s),n.appendChild(l)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,t){const n=this.hot.rootDocument.createElement("col");let r=0;t>=0&&e>=0&&(r=this.hot.getCellMeta(t,e).colspan);let i=this.hot.getColWidth(e);if(r>1)for(let o=e+1;o<e+r;o++)i+=this.hot.getColWidth(o);return n.style.width="".concat(i,"px"),n}createTable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),r=t.createElement("table"),i=t.createElement("thead"),o=t.createElement("tbody"),a=t.createElement("colgroup"),s=t.createElement("tr"),l=t.createElement("th");return this.isVertical()&&r.appendChild(a),this.isHorizontal()&&(s.appendChild(l),i.appendChild(s),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(i),this.isVertical()&&o.appendChild(s),r.appendChild(o),KB(r,e),n.appendChild(r),{fragment:n,table:r,tHead:i,tBody:o,colGroup:a,tr:s,th:l}}createContainer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),r=t.createElement("div");return KB(r,"htGhostTable htAutoSize ".concat(e.trim())),n.appendChild(r),{fragment:n,container:r}}isVertical(){return!(!this.rows.length||this.columns.length)}isHorizontal(){return!(!this.columns.length||this.rows.length)}};function M5(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class D5{static get SAMPLE_COUNT(){return 3}constructor(e){M5(this,"samples",null),M5(this,"dataFactory",null),M5(this,"customSampleCount",null),M5(this,"allowDuplicates",!1),M5(this,"includeHidden",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:D5.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}setIncludeHidden(e){this.includeHidden=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,n){const r=new Map,{from:i,to:o}="number"===typeof n?{from:n,to:n}:n;return hV(i,o,n=>{const i=this.generateSample(e,t,n);r.set(n,i)}),r}generateSample(e,t,n){if("row"!==e&&"col"!==e)throw new Error("Unsupported sample type");const r=new Map,i="row"===e?"col":"row",o=[];return hV(t.from,t.to,t=>{const a="row"===e?this.dataFactory(n,t,this):this.dataFactory(t,n,this);if(!1===a)return;const{value:s,bundleSeed:l}=a,c="string"===typeof l&&l.length>0;let u;u=c?l:tB(s)?"".concat(Object.keys(s).length):Array.isArray(s)?"".concat(s.length):"".concat(tL(s).length),r.has(u)||r.set(u,{needed:this.getSampleCount(),strings:[]});const d=r.get(u);if(d.needed){(!(o.indexOf(s)>-1)||this.allowDuplicates||c)&&(d.strings.push({value:s,[i]:t}),o.push(s),d.needed-=1)}}),r}}const _5=D5;function O5(e,t,n){I5(e,t),t.set(e,n)}function I5(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function P5(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j5(e,t){return e.get(H5(e,t))}function F5(e,t,n){return e.set(H5(e,t),n),n}function H5(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}_W.getSingleton().register("modifyAutoColumnSizeSeed");const L5="autoColumnSize";var B5=new WeakMap,z5=new WeakMap,W5=new WeakMap,V5=new WeakSet;class U5 extends T5{static get PLUGIN_KEY(){return L5}static get PLUGIN_PRIORITY(){return 10}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),function(e,t){I5(e,t),t.add(e)}(this,V5),P5(this,"ghostTable",new k5(this.hot)),P5(this,"samplesGenerator",new _5((e,t)=>{const n=this.hot.toPhysicalRow(e),r=this.hot.toPhysicalColumn(t);if(this.hot.rowIndexMapper.isHidden(n)||this.hot.columnIndexMapper.isHidden(r))return!1;const i=this.hot.getCellMeta(e,t);let o="";i.spanned||(o=this.hot.getDataAtCell(e,t));let a="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(a=this.hot.runHooks("modifyAutoColumnSizeSeed",a,i,o)),{value:o,bundleSeed:a}})),P5(this,"inProgress",!1),P5(this,"measuredColumns",0),P5(this,"columnWidthsMap",new pK),O5(this,B5,!1),O5(this,z5,[]),O5(this,W5,[]),this.hot.columnIndexMapper.registerMap("autoColumnSize",this.columnWidthsMap),this.addHook("beforeColumnResize",(e,t,n)=>H5(V5,this,Q5).call(this,e,t,n))}isEnabled(){return!1!==this.hot.getSettings()[L5]&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const t=this.getSetting("samplingRatio");t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),this.addHook("afterLoadData",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return H5(V5,e,$5).call(e,...n)}),this.addHook("beforeChangeRender",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return H5(V5,e,X5).call(e,...n)}),this.addHook("afterFormulasValuesUpdate",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return H5(V5,e,Z5).call(e,...n)}),this.addHook("beforeRender",()=>H5(V5,this,K5).call(this)),this.addHook("modifyColWidth",(e,t)=>this.getColumnWidth(t,e)),this.addHook("init",()=>H5(V5,this,J5).call(this)),super.enablePlugin()}updatePlugin(){F5(W5,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,n)=>H5(V5,this,Q5).call(this,e,t,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),t=this.getLastVisibleColumn();if(-1===e||-1===t)return;const n=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:t},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r="number"===typeof e?{from:e,to:e}:e,i="number"===typeof t?{from:t,to:t}:t;hV(r.from,r.to,e=>{let t=this.hot.toPhysicalColumn(e);null===t&&(t=e),(n||null===this.columnWidthsMap.getValueAtIndex(t)&&!this.hot._getColWidthFromSettings(t))&&H5(V5,this,G5).call(this,e,i)}),this.ghostTable.columns.length&&(H5(V5,this,Y5).call(this),this.measuredColumns=r.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=0;const r=this.hot.countCols()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot)return dB(i),void(this.inProgress=!1);this.calculateColumnsWidth({from:n,to:Math.min(n+U5.CALCULATION_STEP,r)},e,t),n=n+U5.CALCULATION_STEP+1,n<r?i=uB(o):(dB(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,t),n=a+1),n<r?o():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[L5];let t=U5.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return tB(e)&&(t=e.syncLimit,SL(t)?t=mV(n,t):t>>=0),Math.min(t,n)}getColumnWidth(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t;return void 0===r&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&"number"===typeof r&&(r=Math.max(r,BG))),r}getFirstVisibleColumn(){var e;return null!==(e=this.hot.getFirstRenderedVisibleColumn())&&void 0!==e?e:-1}getLastVisibleColumn(){var e;return null!==(e=this.hot.getLastRenderedVisibleColumn())&&void 0!==e?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((e,t,n)=>{const r=j5(z5,this).length;return(r-1<n||j5(z5,this)[n]!==t)&&e.push(this.hot.toVisualColumn(n)),r-1<n?j5(z5,this).push(t):j5(z5,this)[n]=t,e},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(e=>{this.columnWidthsMap.setValueAtIndex(e,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>null===e).length}destroy(){this.ghostTable.clean(),super.destroy()}}function q5(e){const t={from:0,to:this.hot.countRows()-1};e.forEach(e=>{const n=this.hot.toPhysicalColumn(e);null!==n&&(this.hot._getColWidthFromSettings(n)||H5(V5,this,G5).call(this,e,t))}),this.ghostTable.columns.length&&(H5(V5,this,Y5).call(this),this.ghostTable.clean())}function G5(e,t){this.samplesGenerator.generateColumnSamples(e,t).forEach((e,t)=>this.ghostTable.addColumn(t,e))}function Y5(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((e,t)=>{const n=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(n,t)})},!0)}function K5(){this.calculateVisibleColumnsWidth(),this.inProgress||(H5(V5,this,q5).call(this,j5(W5,this)),F5(W5,this,[]))}function $5(e,t){t||this.recalculateAllColumnsWidth()}function X5(e){const t=e.reduce((e,t)=>{let[,n]=t;const r=this.hot.propToCol(n);return Number.isInteger(r)&&-1===e.indexOf(r)&&e.push(r),e},[]);j5(W5,this).push(...t)}function Q5(e,t,n){let r=e;return n&&(this.calculateColumnsWidth(t,void 0,!0),r=this.getColumnWidth(t,void 0,!1)),r}function J5(){F5(z5,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),F5(B5,this,!0)}function Z5(e){if(!j5(B5,this))return;const t=e.reduce((e,t)=>{var n;const r=null===(n=t.address)||void 0===n?void 0:n.col;if(Number.isInteger(r)){const t=this.hot.toVisualColumn(r);-1===e.indexOf(t)&&e.push(t)}return e},[]);j5(W5,this).push(...t)}const e6={horizontal:"horizontal",vertical:"vertical"};function t6(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function n6(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r6(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}_W.getSingleton().register("modifyAutofillRange"),_W.getSingleton().register("beforeAutofill"),_W.getSingleton().register("afterAutofill");const i6="autofill",o6=["fillHandle"];var a6=new WeakSet;class s6 extends T5{constructor(){super(...arguments),t6(this,a6),n6(this,"addingStarted",!1),n6(this,"mouseDownOnCellCorner",!1),n6(this,"mouseDragOutside",!1),n6(this,"handleDraggedCells",0),n6(this,"directions",[]),n6(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return i6}static get PLUGIN_PRIORITY(){return 20}static get SETTING_KEYS(){return[i6,...o6]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>r6(a6,this,u6).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>r6(a6,this,c6).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,t)=>r6(a6,this,d6).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.hot.getSelectedRangeLast(),{row:n,col:r}=t.getTopStartCorner(),{row:i,col:o}=t.getBottomEndCorner(),a=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),s=[],l=[],c=[];return WH(a,e=>{for(let t=e.startRow;t<=e.endRow;t+=1)-1===s.indexOf(t)&&s.push(t);for(let t=e.startCol;t<=e.endCol;t+=1)-1===l.indexOf(t)&&l.push(t)}),WH(s,t=>{const n=[];WH(l,r=>{const i=e?this.hot.getSourceDataAtCell(t,r):null;e&&tB(i)?n.push(this.hot.getCopyableSourceData(t,r)):n.push(this.hot.getCopyableData(t,r))}),c.push(n)}),c}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,n,r]=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.getSelectedRangeLast(),o=i.getTopStartCorner(),a=i.getBottomEndCorner();this.resetSelectionOfDraggedArea();const s=[o.row,o.col,a.row,a.col],l=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,t),Math.max(a.row,n),Math.max(a.col,r)],s),{directionOfDrag:c,startOfDragCoords:u,endOfDragCoords:d}=function(e,t,n){let r,i,o;return t[0]===e[0]&&t[1]<e[1]?(o="left",r=n(t[0],t[1]),i=n(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(o="right",r=n(t[0],e[3]+1),i=n(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(o="up",r=n(t[0],t[1]),i=n(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(o="down",r=n(e[2]+1,t[1]),i=n(t[2],t[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}(s,l,(e,t)=>this.hot._createCellCoords(e,t));if(u&&u.row>-1&&u.col>-1){const e=this.getSelectionData(),t=this.getSelectionData(!0),n=i.clone(),r=this.hot._createCellRange(u,u,d),o=this.hot.runHooks("beforeAutofill",e,n,r,c);if(!1===o)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let a=o;const s=o;if(["up","left"].indexOf(c)>-1&&(1!==s.length||0!==s[0].length))if(a=[],"up"===c){const e=d.row-u.row+1,t=e%s.length;for(let n=0;n<e;n++)a.push(s[(n+(s.length-t))%s.length])}else{const e=d.col-u.col+1,t=e%s[0].length;for(let n=0;n<s.length;n++){a.push([]);for(let r=0;r<e;r++)a[n].push(s[n][(r+(s[n].length-t))%s[n].length])}}if(t.some(e=>e.some(e=>tB(e)))){const e=r6(a6,this,l6).call(this,a,t,u,d,c);e.length&&(a=e)}this.hot.populateFromArray(u.row,u.col,a,d.row,d.col,"".concat(this.pluginName,".fill"),null),this.setSelection(l),this.hot.runHooks("afterAutofill",a,n,r,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),n=t.getBottomEndCorner();let r=e;if(this.directions.includes(e6.vertical)&&this.directions.includes(e6.horizontal)){const i=t.getTopStartCorner();(n.col<=e.col||i.col>=e.col)&&(r=this.hot._createCellCoords(n.row,e.col)),(n.row<e.row||i.row>e.row)&&(r=this.hot._createCellCoords(e.row,n.col))}else if(this.directions.includes(e6.vertical))r=this.hot._createCellCoords(e.row,n.col);else{if(!this.directions.includes(e6.horizontal))return;r=this.hot._createCellCoords(n.row,e.col)}return this.reduceSelectionAreaIfNeeded(r)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter("insert_row_below",void 0,1,"".concat(this.pluginName,".fill")),this.addingStarted=!1},200)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();e[2]<n-1&&t[2]===n-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),n=this.hot.countRows();let r;for(let i=e[2]+1;i<n;i++){for(let r=e[1];r<=e[3];r++){if(!iL(t[i][r]))return-1}const n=t[i][e[1]-1],o=t[i][e[3]+1];iL(n)&&iL(o)||(r=i)}return r}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...zH(e,e=>Math.max(e,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return-1!==t&&void 0!==t&&(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,n=oz(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+vz(this.hot.table),r=oz(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+gz(this.hot.table);return e.clientY>n&&e.clientX<=r}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>r6(a6,this,h6).call(this)),this.eventManager.addEventListener(e,"mousemove",e=>r6(a6,this,f6).call(this,e))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=function(e){const t={};return!0===e?(t.directions=Object.keys(e6),t.autoInsertRow=!0):tB(e)?(nL(e.autoInsertRow)?e.direction===e6.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,nL(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(e6)):"string"===typeof e?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function l6(e,t,n,r){const i=[];for(let o=Math.min(n.row,r.row);o<=Math.max(n.row,r.row);o+=1){i.push([]);for(let a=Math.min(n.col,r.col);a<=Math.max(n.col,r.col);a+=1){const s=this.hot.getSourceDataAtCell(o,a),l=o-Math.min(n.row,r.row),c=a-Math.min(n.col,r.col),u=l%t.length,d=c%t[0].length;tB(s)?i[l][c]=t[u][d]:i[l][c]=e[u][d]}}return i}function c6(){this.selectAdjacent()&&this.fillIn()}function u6(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function d6(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}function h6(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function f6(e){const t=this.getIfMouseWasDraggedOutside(e);!1===this.addingStarted&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function m6(e,t,n){p6(e,t),t.set(e,n)}function p6(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function g6(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v6(e,t,n){return e.set(b6(e,t),n),n}function y6(e,t){return e.get(b6(e,t))}function b6(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const w6="autoRowSize",x6="htFirstDatasetColumnNotRendered",S6="htAutoRowSize";var C6=new WeakMap,E6=new WeakMap,N6=new WeakSet;class T6 extends T5{static get PLUGIN_KEY(){return w6}static get PLUGIN_PRIORITY(){return 40}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),function(e,t){p6(e,t),t.add(e)}(this,N6),g6(this,"headerHeight",null),g6(this,"ghostTable",new k5(this.hot)),g6(this,"samplesGenerator",new _5((e,t)=>{const n=this.hot.toPhysicalColumn(t);if(this.hot.columnIndexMapper.isHidden(n))return!1;if(e>=0&&t>=0){if(this.hot.getCellMeta(e,t).hidden)return!1}let r;return e>=0?r=this.hot.getDataAtCell(e,t):-1===e&&(r=this.hot.getColHeader(t)),{value:r}})),g6(this,"inProgress",!1),g6(this,"measuredRows",0),g6(this,"rowHeightsMap",new pK),m6(this,C6,[]),m6(this,E6,!1),this.hot.rowIndexMapper.registerMap("autoRowSize",this.rowHeightsMap),this.addHook("beforeRowResize",(e,t,n)=>b6(N6,this,D6).call(this,e,t,n))}isEnabled(){const e=this.hot.getSettings()[w6];return!0===e||tB(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const t=this.getSetting("samplingRatio");t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),this.addHook("afterLoadData",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return b6(N6,e,_6).call(e,...n)}),this.addHook("beforeChangeRender",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return b6(N6,e,O6).call(e,...n)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return b6(N6,e,P6).call(e,...n)}),this.addHook("beforeViewRender",()=>b6(N6,this,k6).call(this)),this.addHook("beforeRender",()=>b6(N6,this,M6).call(this)),this.addHook("modifyRowHeight",(e,t)=>this.getRowHeight(t,e)),this.addHook("init",()=>b6(N6,this,I6).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),KB(this.hot.rootElement,S6),super.enablePlugin()}disablePlugin(){this.headerHeight=null,$B(this.hot.rootElement,S6),super.disablePlugin(),b6(N6,this,R6).call(this,!1),this.addHook("beforeRowResize",(e,t,n)=>b6(N6,this,D6).call(this,e,t,n))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),t=this.getLastVisibleRow();if(-1===e||-1===t)return;const n=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:t},void 0,n)}calculateRowsHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r="number"===typeof e?{from:e,to:e}:e,i="number"===typeof t?{from:t,to:t}:t;if(null!==this.hot.getColHeader(0)){const e=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(e.get(-1))}hV(r.from,r.to,e=>{let t=this.hot.toPhysicalRow(e);if(null===t&&(t=e),n||null===this.rowHeightsMap.getValueAtIndex(t)){this.samplesGenerator.generateRowSamples(e,i).forEach((e,t)=>this.ghostTable.addRow(t,e))}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((e,t)=>{e<0?this.headerHeight=t:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(e),t)})},!0),this.measuredRows=r.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=0;const r=this.hot.countRows()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot)return dB(i),void(this.inProgress=!1);this.calculateRowsHeight({from:n,to:Math.min(n+T6.CALCULATION_STEP,r)},e,t),n=n+T6.CALCULATION_STEP+1,n<r?i=uB(o):(dB(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,t),n=a+1),n<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[w6];let t=T6.SYNC_CALCULATION_LIMIT;const n=this.hot.countRows()-1;return tB(e)&&(t=e.syncLimit,SL(t)?t=mV(n,t):t>>=0),Math.min(t,n)}getRowHeight(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.stylesHandler.getDefaultRowHeight(e);var n;if(e<0)return null!==(n=this.headerHeight)&&void 0!==n?n:t;const r=this.hot.toPhysicalRow(e);if(this.hot.rowIndexMapper.isHidden(r))return t;const i=this.rowHeightsMap.getValueAtIndex(r);let o=t;return null!==i&&i>t&&(o=i,this.hot.stylesHandler.isClassicTheme()||e!==this.hot.view.getFirstRenderedVisibleRow()||(o+=1)),o}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return null!==(e=this.hot.getFirstRenderedVisibleRow())&&void 0!==e?e:-1}getLastVisibleRow(){var e;return null!==(e=this.hot.getLastRenderedVisibleRow())&&void 0!==e?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(e=>{this.rowHeightsMap.setValueAtIndex(e,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:t,to:n}="number"===typeof e?{from:e,to:e}:e;this.hot.batchExecution(()=>{hV(Math.min(t,n),Math.max(t,n),e=>{this.rowHeightsMap.setValueAtIndex(e,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>null===e).length}destroy(){this.ghostTable.clean(),super.destroy()}}function A6(e){const t={from:0,to:this.hot.countCols()-1};e.forEach(e=>{this.samplesGenerator.generateRowSamples(e,t).forEach((e,t)=>this.ghostTable.addRow(t,e))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((e,t)=>{const n=this.hot.toPhysicalRow(e);this.rowHeightsMap.setValueAtIndex(n,t)})},!0),this.ghostTable.clean())}function R6(e){const t=this.hot.getFirstRenderedVisibleColumn(),n=this.hot.columnIndexMapper.getPhysicalFromVisualIndex(t);!1===e||n===this.hot.columnIndexMapper.getPhysicalFromRenderableIndex(0)?$B(this.hot.rootElement,x6):KB(this.hot.rootElement,x6)}function k6(){b6(N6,this,R6).call(this)}function M6(){this.calculateVisibleRowsHeight(),this.inProgress||(b6(N6,this,A6).call(this,y6(C6,this)),v6(C6,this,[]))}function D6(e,t,n){let r=e;return n&&(this.calculateRowsHeight(t,void 0,!0),r=this.getRowHeight(t)),r}function _6(e,t){t||this.recalculateAllRowsHeight()}function O6(e){const t=e.reduce((e,t)=>{let[n]=t;return-1===e.indexOf(n)&&e.push(n),e},[]);y6(C6,this).push(...t)}function I6(){this.recalculateAllRowsHeight(),v6(E6,this,!0)}function P6(e){if(!y6(E6,this))return;const t=e.reduce((e,t)=>{var n;const r=null===(n=t.address)||void 0===n?void 0:n.row;if(Number.isInteger(r)){const t=this.hot.toVisualRow(r);-1===e.indexOf(t)&&e.push(t)}return e},[]);y6(C6,this).push(...t)}const j6=new Map([["indexesSequence",{getListWithInsertedItems:lK,getListWithRemovedItems:cK}],["physicallyIndexed",{getListWithInsertedItems:fK,getListWithRemovedItems:mK}]]),F6=e=>{if(!1===j6.has(e))throw new Error("Alter strategy with ID '".concat(e,"' does not exist."));return j6.get(e)},{getListWithInsertedItems:H6,getListWithRemovedItems:L6}=F6("physicallyIndexed");const B6=class extends sK{constructor(){super(e=>e)}insert(e,t){const n=dK(this.indexedValues,t);this.indexedValues=H6(n,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=L6(this.indexedValues,e);this.indexedValues=uK(t,e),super.remove(e)}},{getListWithInsertedItems:z6,getListWithRemovedItems:W6}=F6("physicallyIndexed");const V6=class extends sK{constructor(){super(e=>e)}insert(e,t){this.indexedValues=z6(this.indexedValues,e,t,(e,t)=>this.getNextValue(t)),super.insert(e,t)}remove(e){this.indexedValues=W6(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}};function U6(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function q6(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const G6="bindRowsWithHeaders",Y6=new Map([["loose",B6],["strict",V6]]);var K6=new WeakSet;class $6 extends T5{constructor(){super(...arguments),U6(this,K6),q6(this,"headerIndexes",null)}static get PLUGIN_KEY(){return G6}static get PLUGIN_PRIORITY(){return 210}isEnabled(){return!!this.hot.getSettings()[G6]}enablePlugin(){var e;if(this.enabled)return;const t=null!==(e=Y6.get(this.getSetting()))&&void 0!==e?e:Y6.get("loose");this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",e=>function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(K6,this,X6).call(this,e)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function X6(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}function Q6(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function J6(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Z6(e,t){return e.get(t8(e,t))}function e8(e,t,n){return e.set(t8(e,t),n),n}function t8(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const n8="collapsibleColumns",r8=["nestedHeaders"],i8="collapsibleIndicator",o8=n8,a8=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var s8=new WeakMap,l8=new WeakSet;class c8 extends T5{constructor(){super(...arguments),function(e,t){Q6(e,t),t.add(e)}(this,l8),J6(this,"nestedHeadersPlugin",null),J6(this,"headerStateManager",null),function(e,t,n){Q6(e,t),t.set(e,n)}(this,s8,null)}static get PLUGIN_KEY(){return n8}static get PLUGIN_PRIORITY(){return 290}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[n8,...r8]}isEnabled(){return!!this.hot.getSettings()[n8]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||hW("You need to configure the Nested Headers plugin in order to use collapsible headers."),e8(s8,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>t8(l8,this,h8).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return t8(l8,e,f8).call(e,...n)}),this.addHook("afterGetColHeader",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return t8(l8,e,u8).call(e,...n)}),this.addHook("beforeOnCellMouseDown",(e,t,n)=>t8(l8,this,d8).call(this,e,t,n)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();"boolean"===typeof e?this.headerStateManager.mapState(e=>({collapsible:e.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),e8(s8,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:t,col:n}=this.hot.getSelectedRangeActive().highlight,{collapsible:r,isCollapsed:i,columnIndex:o}=null!==(e=this.headerStateManager.getHeaderTreeNodeData(t,n))&&void 0!==e?e:{};if(r)return i?this.expandSection({row:t,col:o}):this.collapseSection({row:t,col:o}),!1},runOnlyIf:()=>{var e,t;return(null===(e=this.hot.getSelectedRangeActive())||void 0===e?void 0:e.isSingle())&&(null===(t=this.hot.getSelectedRangeActive())||void 0===t?void 0:t.highlight.isHeader())},group:o8,relativeToGroup:ZZ,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(o8)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=function(e){e&&e.parentNode.removeChild(e)};hV(0,e-1,e=>{const o=t.childNodes[e],a=n.childNodes[e],s=r?r.childNodes[e]:null;hV(0,o.childNodes.length-1,e=>{let t=o.childNodes[e].querySelector(".".concat(i8));i(t),a&&a.childNodes[e]&&(t=a.childNodes[e].querySelector(".".concat(i8)),i(t)),r&&s&&s.childNodes[e]&&(t=s.childNodes[e].querySelector(".".concat(i8)),i(t))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes(t=>{const{collapsible:n,origColspan:r,headerLevel:i,columnIndex:o,isCollapsed:a}=t;if(!0===n&&r>1&&(a&&"expand"===e||!a&&"collapse"===e))return{row:this.headerStateManager.levelToRowCoords(i),col:o}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!a8.has(t))throw new Error("Unsupported action is passed (".concat(t,")."));if(!Array.isArray(e))return;const n=BH(e,e=>{let{row:t}=e;return t<0});let r=n.length>0;WH(n,e=>{var n;let{row:i,col:o}=e;const{collapsible:a,isCollapsed:s}=null!==(n=this.headerStateManager.getHeaderSettings(i,o))&&void 0!==n?n:{};if(!a||s&&"collapse"===t||!s&&"expand"===t)return r=!1,!1});const i=[],o=[];r&&WH(n,e=>{let{row:n,col:r}=e;const{colspanCompensation:a,affectedColumns:s,rollbackModification:l}=this.headerStateManager.triggerNodeModification(t,n,r);a>0&&(o.push(...s),i.push(l))});const a=this.getCollapsedColumns();let s=[];"collapse"===t?s=KH([...a,...o]):"expand"===t&&(s=BH(a,e=>!o.includes(e)));const l=a8.get(t);if(!1===this.hot.runHooks(l.beforeHook,a,s,r))return void WH(i,e=>{e()});this.hot.batchExecution(()=>{WH(o,e=>{Z6(s8,this).setValueAtIndex(this.hot.toPhysicalColumn(e),l.hideColumn)})},!0);const c=this.getCollapsedColumns().length!==a.length,u=this.hot.getSelectedRangeActive();if("collapse"===t&&c&&u){const{row:e,col:t}=u.highlight;if((this.hot.rowIndexMapper.isHidden(e)||this.hot.columnIndexMapper.isHidden(t))&&o.includes(t)){const n=e>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(e,1,!0):e,r=t>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(t,1,!0):t;null!==n&&null!==r&&this.hot.selectCell(n,r)}}this.hot.runHooks(l.afterHook,a,s,r,c),this.hot.view.adjustElementsSize(),this.hot.render()}getCollapsedColumns(){return Z6(s8,this).getHiddenIndexes()}destroy(){e8(s8,this,null),super.destroy()}}function u8(e,t,n){var r;const{collapsible:i,origColspan:o,isCollapsed:a}=null!==(r=this.headerStateManager.getHeaderSettings(n,e))&&void 0!==r?r:{},s=i&&o>1&&e>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let c=t.querySelector(".".concat(i8));var u;(QB(t,[VL("")[0]]),s)?(c||(c=this.hot.rootDocument.createElement("div"),KB(c,i8),t.querySelector("div:first-child").appendChild(c)),$B(c,["collapsed","expanded"]),a?(KB(c,"collapsed"),nz(c,"+"),l&&XB(t,...VL(!1))):(KB(c,"expanded"),nz(c,"-"),l&&XB(t,...VL(!0))),l&&XB(c,...jL())):null===(u=c)||void 0===u||u.remove()}function d8(e,t){YB(e.target,i8)&&(YB(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):YB(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),aW(e))}function h8(){this.updatePlugin()}function f8(e,t){t||this.updatePlugin()}function m8(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const p8=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"];class g8{constructor(e,t){m8(this,"hot",void 0),m8(this,"sortingStates",new yK),m8(this,"sortEmptyCells",false),m8(this,"indicator",true),m8(this,"headerAction",true),m8(this,"compareFunctionFactory",void 0),m8(this,"mapName",void 0),this.hot=e,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){tB(e)&&rB(e,(e,t)=>{p8.includes(t)&&(this[t]=e)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"===typeof this.compareFunctionFactory&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return null===(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))||void 0===t?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[n]=t;return n===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(e){return tB(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){if(null===this.sortingStates)return[];return this.sortingStates.getEntries().map(e=>{let[t,n]=e;return E({column:this.hot.toVisualColumn(t)},n)})}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(nL(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function v8(e,t,n){const r=t.locale;return function(t,i){const{sortEmptyCells:o}=n;return"string"===typeof t&&(t=t.toLocaleLowerCase(r)),"string"===typeof i&&(i=i.toLocaleLowerCase(r)),t===i?N8:iL(t)?iL(i)?N8:o&&"asc"===e?T8:A8:iL(i)?o&&"asc"===e?A8:T8:isNaN(t)&&!isNaN(i)?"asc"===e?A8:T8:!isNaN(t)&&isNaN(i)?"asc"===e?T8:A8:(isNaN(t)||isNaN(i)||(t=parseFloat(t),i=parseFloat(i)),t<i?"asc"===e?T8:A8:t>i?"asc"===e?A8:T8:N8)}}const y8="default";const{register:b8,getItem:w8,hasItem:x8}=PW("sorting.compareFunctionFactory"),{register:S8,getItem:C8}=PW("sorting.mainSortComparator");function E8(e){return x8(e)?w8(e):w8(y8)}b8("checkbox",function(e,t,n){const r=t.checkedTemplate,i=t.uncheckedTemplate,{sortEmptyCells:o}=n;return function(a,s){const l=iL(a),c=iL(s),u=l?i:a,d=c?i:s,h=u===i||u===r,f=d===i||d===r;if(!1===o){if(l&&!1===c)return A8;if(!1===l&&c)return T8}return!1===h&&f?"asc"===e?T8:A8:h&&!1===f?"asc"===e?A8:T8:!1===h&&!1===f?v8(e,t,n)(a,s):u===i&&d===r?"asc"===e?T8:A8:u===r&&d===i?"asc"===e?A8:T8:N8}}),b8("date",function(e,t,n){return F8(e,t.dateFormat,n)}),b8(y8,v8),b8("numeric",function(e,t,n){return function(t,r){const i=parseFloat(t),o=parseFloat(r),{sortEmptyCells:a}=n;if(i===o||isNaN(i)&&isNaN(o))return N8;if(a){if(iL(t))return"asc"===e?T8:A8;if(iL(r))return"asc"===e?A8:T8}return isNaN(i)?A8:isNaN(o)?T8:i<o?"asc"===e?T8:A8:i>o?"asc"===e?A8:T8:N8}}),b8("time",function(e,t,n){return F8(e,t.timeFormat,n)});const N8=0,T8=-1,A8=1;var R8;const k8="asc",M8="desc",D8="colHeader";function _8(e){if(e.some(e=>!1===function(e){if(!1===tB(e))return!1;const{column:t,sortOrder:n}=e;return Number.isInteger(t)&&[k8,M8].includes(n)}(e)))return!1;const t=e.map(e=>{let{column:t}=e;return t});return new Set(t).size===t.length}function O8(e){if(e!==M8)return e===k8?M8:k8}function I8(e){return e.querySelector(".".concat(D8))}function P8(e,t){if(e<0||!t.parentNode)return!1;const n=t.parentNode.parentNode.childNodes;return-1===Array.from(n).indexOf(t.parentNode)-n.length}function j8(e,t,n){return-1===e&&t>=0&&!1===lW(n)}function F8(e,t,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return N8;if(iL(r))return iL(i)?N8:o&&"asc"===e?T8:A8;if(iL(i))return o&&"asc"===e?A8:T8;const a=PH(r,t),s=PH(i,t);return a.isValid()?s.isValid()?s.isAfter(a)?"asc"===e?T8:A8:s.isBefore(a)?"asc"===e?A8:T8:N8:T8:A8}}const H8="indicatorDisabled",L8="columnSorting",B8="sortAction",z8=new Map([[k8,"ascending"],[M8,"descending"]]);const W8=["column"],V8=["column"];function U8(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function q8(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G8(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const Y8="columnSorting",K8="append",$8=Y8;S8(Y8,function(e,t){return function(n,r){const[,...i]=n,[,...o]=r;return function(n){const r=e[n],a=t[n],s=i[n],l=o[n],c=a.columnSorting;return(c.compareFunctionFactory?c.compareFunctionFactory:E8(a.type))(r,a,c)(s,l)}(0)}}),_W.getSingleton().register("beforeColumnSort"),_W.getSingleton().register("afterColumnSort");const X8=new WeakMap;var Q8=new WeakSet;class J8 extends T5{constructor(){super(...arguments),U8(this,Q8),q8(this,"columnStatesManager",null),q8(this,"columnMetaCache",null),q8(this,"pluginKey",Y8),q8(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Y8}static get PLUGIN_PRIORITY(){return 50}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e,t,n=this;if(X8.has(this.hot)&&X8.get(this.hot)!==this.pluginKey)return this.hot.updateSettings({[this.pluginKey]:!1}),e=X8.get(this.hot),t=this.pluginKey,void hW(ZH(R8||(R8=RH(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `","` will work. The `","` plugin will remain disabled."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously.\\x20\n    Only \\`","\\` will work. The \\`","\\` plugin will remain disabled."])),e,t));this.enabled||(X8.set(this.hot,this.pluginKey),this.columnStatesManager=new g8(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new pK(e=>{let t=this.hot.toVisualColumn(e);return null===t&&(t=e),this.getMergedPluginSettings(t)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",(e,t)=>G8(Q8,this,e7).call(this,e,t)),this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return G8(Q8,n,n7).call(n,...t)}),this.addHook("afterOnCellMouseDown",(e,t)=>this.onAfterOnCellMouseDown(e,t)),this.addHook("afterInit",()=>G8(Q8,this,Z8).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return G8(Q8,n,t7).call(n,...t)}),this.hot.view&&G8(Q8,this,Z8).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(e,t)=>{const n=I8(t);!1!==P8(e,t)&&null!==n&&this.updateHeaderClasses(n)};X8.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,t;const n=null===(e=this.hot.getSelectedRangeActive())||void 0===e?void 0:e.highlight;return n&&(null===(t=this.hot.getSelectedRangeActive())||void 0===t?void 0:t.isSingle())&&this.hot.selection.isCellVisible(n)&&-1===n.row&&n.col>=0},relativeToGroup:ZZ,position:"before",group:$8})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup($8)}sort(e){const t=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(n);!1!==this.hot.runHooks("beforeColumnSort",t,n,r)&&(0===t.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new hK),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",t,r?n:t,r),r&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return nL(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return _8(e)&&e.every(e=>{let{column:n}=e;return n<=t&&n>=0})}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties();t.initialConfig=zH(e,e=>{let{column:t}=e,n=b(e,W8);return E({column:this.hot.toPhysicalColumn(t)},n)}),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,n=e=>{let{column:t}=e,n=b(e,V8);return E({column:this.hot.toVisualColumn(t)},n)};return nL(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=zH(t.initialConfig,n)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(nL(t)){const n=O8(t);return nL(n)?{column:e,sortOrder:n}:void 0}const n=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<n)return{column:e,sortOrder:O8()}}getNextSortConfig(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:K8;const n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=-1!==n,i=this.getSortConfig(),o=this.getColumnNextConfig(e);if(r){if(rL(o))return[...i.slice(0,n),...i.slice(n+1)];if(t===K8)return[...i.slice(0,n),...i.slice(n+1),o];if("replace"===t)return[...i.slice(0,n),o,...i.slice(n+1)]}return nL(o)?i.concat(o):i}getPluginColumnConfig(e){if(tB(e)){const t=e[this.pluginKey];if(tB(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,e),i=Object.getPrototypeOf(r);return Array.isArray(i.columns)?Object.assign(n,t,this.getPluginColumnConfig(i.columns[e])):Uz(i.columns)?Object.assign(n,t,this.getPluginColumnConfig(i.columns(e))):Object.assign(n,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),n=Object.create(t);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),n}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),0===e.length)return;const t=[],n=this.hot.countRows(),r=t=>zH(e,e=>this.hot.getDataAtCell(t,e.column));for(let l=0;l<this.getNumberOfRowsToSort(n);l+=1)t.push([this.hot.toPhysicalRow(l)].concat(r(l)));const i=zH(t,e=>e[0]);!function(e,t){const n=C8(t);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];e.sort(n(...i))}(t,this.pluginKey,zH(e,e=>e.sortOrder),zH(e,e=>this.getFirstCellSettings(e.column)));for(let l=t.length;l<n;l+=1)t.push([l].concat(r(l)));const o=zH(t,e=>e[0]),a=new Map(zH(i,(e,t)=>[e,o[t]])),s=zH(this.hot.rowIndexMapper.getIndexesSequence(),e=>a.has(e)?a.get(e):e);this.hot.rowIndexMapper.setIndexesSequence(s)}sortBySettings(e){if(tB(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||tB(t))&&this.sort(t)}else this.hot.render()}updateHeaderClasses(e){if($B(e,Array.from(z8.values()).concat(B8,H8,L8)),!1!==this.enabled){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];KB(e,function(e,t,n,r){const i=[L8];if(r&&i.push(B8),!1===n)return i.push(H8),i;const o=e.getSortOrderOfColumn(t);return nL(o)&&i.push(z8.get(o)),i}(...n))}}onUpdateSettings(e){super.onUpdateSettings(e),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),nL(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&YB(e.target,D8)}onAfterOnCellMouseDown(e,t){if(!1!==j8(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col));const e=this.hot.getActiveEditor(),n=this.getColumnNextConfig(t.col);null!==e&&void 0!==e&&e.isOpened()&&this.hot.getCellValidator(e.row,e.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(n)}):this.sort(n)}}destroy(){var e;null===(e=this.columnStatesManager)||void 0===e||e.destroy(),super.destroy()}}function Z8(){const e=this.getAllSavedSortSettings();if(tB(e))this.sortBySettings(e);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function e7(e,t){const n=I8(t);if(!1===P8(e,t)||null===n)return;const r=this.getFirstCellSettings(e)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,e,i,o),this.hot.getSettings().ariaTags){const n=this.columnStatesManager.getSortOrderOfColumn(e);XB(t,...(a=n?"".concat(n,"ending"):"none",["aria-sort",a]))}var a}function t7(e){!0===e&&this.hot.view&&G8(Q8,this,Z8).call(this)}function n7(e,t,n,r){!1!==j8(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function r7(e){return null===e||void 0===e||isNaN(e)}function i7(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const o7=class{constructor(e,t){i7(this,"plugin",void 0),i7(this,"hot",void 0),i7(this,"endpoints",[]),i7(this,"settings",void 0),i7(this,"settingsType","array"),i7(this,"currentEndpoint",null),i7(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=t}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let n=e;if(n||"function"!==typeof this.settings)return n||(n=this.settings),WH(n,e=>{const n={};this.assignSetting(e,n,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(e,n,"reversedRowCoords",!1),this.assignSetting(e,n,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(e,n,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(e,n,"sourceColumn",e.destinationColumn),this.assignSetting(e,n,"type","sum"),this.assignSetting(e,n,"forceNumeric",!1),this.assignSetting(e,n,"suppressDataTypeErrors",!0),this.assignSetting(e,n,"customFunction",null),this.assignSetting(e,n,"readOnly",!0),this.assignSetting(e,n,"roundFloat",!1),t.push(n)}),t;this.settingsType="function"}assignSetting(e,t,n,r){if("ranges"!==n||void 0!==e[n]){if("ranges"!==n||0!==e[n].length)if(void 0===e[n]){if(r instanceof Error)throw r;t[n]=r}else"destinationRow"===n&&t.reversedRowCoords?t[n]=this.hot.countRows()-e[n]-1:t[n]=e[n]}else t[n]=r}resetSetupBeforeStructureAlteration(e,t,n){if("function"!==this.settingsType)return;const r=e.indexOf("row")>-1?"row":"col",i=this.getAllEndpoints();WH(i,i=>{"row"===r&&i.destinationRow>=t&&("insert_row"===e?i.alterRowOffset=n:"remove_row"===e&&(i.alterRowOffset=-1*n)),"col"===r&&i.destinationColumn>=t&&("insert_col"===e?i.alterColumnOffset=n:"remove_col"===e&&(i.alterColumnOffset=-1*n))}),this.resetAllEndpoints(i,!1)}resetSetupAfterStructureAlteration(e,t,n,r,i){let o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("auto"===i)return;if("function"===this.settingsType){const e=()=>(this.hot.removeHook("beforeViewRender",e),this.refreshAllEndpoints());return void this.hot.addHookOnce("beforeViewRender",e)}const a=e.indexOf("row")>-1?"row":"col",s=e.indexOf("remove")>-1?-1:1,l=this.getAllEndpoints(),c=0===e.indexOf("move_row"),u=t;WH(l,e=>{"row"===a&&e.destinationRow>=u&&(e.alterRowOffset=s*n),"col"===a&&e.destinationColumn>=u&&(e.alterColumnOffset=s*n)}),this.resetAllEndpoints(l,!c),WH(l,c?e=>{this.extendEndpointRanges(e,u,r[0],r.length),this.recreatePhysicalRanges(e),this.clearOffsetInformation(e)}:e=>{this.shiftEndpointCoordinates(e,u)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,n,r){WH(e.ranges,e=>{e[1]&&(t>=e[0]&&t<=e[1]?n>e[1]?e[1]+=r:n<e[0]&&(e[0]-=r):n>=e[0]&&n<=e[1]&&(e[1]-=r,t<=e[0]&&(e[0]+=1,e[1]+=1)))})}recreatePhysicalRanges(e){const t=e.ranges,n=[],r=[];WH(t,e=>{const t=[];if(e[1])for(let n=e[0];n<=e[1];n++)t.push(this.hot.toPhysicalRow(n));else t.push(this.hot.toPhysicalRow(e[0]));r.push(t)}),WH(r,e=>{let t=[];WH(e,(r,i)=>{0===i?t.push(r):e[i]!==e[i-1]+1&&(t.push(e[i-1]),n.push(t),t=[],t.push(r)),i===e.length-1&&(t.push(r),n.push(t))})}),e.ranges=n}shiftEndpointCoordinates(e,t){e.alterRowOffset&&0!==e.alterRowOffset?(e.destinationRow+=e.alterRowOffset||0,WH(e.ranges,n=>{WH(n,(r,i)=>{r>=t&&(n[i]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&0!==e.alterColumnOffset&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.some(e=>{const t=e.alterRowOffset||0,n=e.alterColumnOffset||0;return e.destinationRow+t>=this.hot.countRows()||e.destinationColumn+n>=this.hot.countCols()})||(this.cellsToSetCache=[],WH(e,e=>{this.resetEndpointValue(e,t)}),this.cellsToSetCache.length&&this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],WH(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.cellsToSetCache.length&&this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],WH(e,(e,n,r)=>{"".concat(e[2]||"")!=="".concat(e[3])&&WH(this.getAllEndpoints(),(e,i)=>{this.hot.propToCol(r[n][1])===e.sourceColumn&&-1===t.indexOf(i)&&t.push(i)})}),WH(t,e=>{this.refreshEndpoint(this.getEndpoint(e))}),this.cellsToSetCache.length&&this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const t=this.hot.toVisualRow(e.destinationRow);if(null!==t){const n=this.hot.getCellMeta(t,e.destinationColumn);n.readOnly=e.readOnly,n.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=e.alterRowOffset||0,r=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?n:0)),this.hot.toVisualColumn(e.destinationColumn+(t?r:0)),""])}setEndpointValue(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols())return void this.throwOutOfBoundsWarning();const i=this.hot.toVisualRow(e.destinationRow);if(null!==i){const n=this.hot.getCellMeta(i,e.destinationColumn);"init"!==t&&n.readOnly===e.readOnly||(n.readOnly=e.readOnly,n.className="columnSummaryResult")}e.result=function(e,t){if("number"!==typeof e)return e;const n=e=>e.toString();switch(typeof t){case"number":return n(e.toFixed(Math.min(Math.max(0,t),100)));case"boolean":return t?n(Math.round(e)):e;case"string":if("auto"===t){const t=Math.round(e).toString().length;return n(e.toFixed(8-t))}return e;default:return e}}(e.result,e.roundFloat),n?this.hot.setDataAtCell(r,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){hW("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}};var a7;function s7(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function l7(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c7(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const u7="columnSummary";var d7=new WeakSet;class h7 extends T5{constructor(){super(...arguments),s7(this,d7),l7(this,"endpoints",null)}static get PLUGIN_KEY(){return u7}static get PLUGIN_PRIORITY(){return 220}isEnabled(){return!!this.hot.getSettings()[u7]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[u7],this.endpoints=new o7(this,this.settings),this.addHook("afterInit",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return c7(d7,e,f7).call(e,...n)}),this.addHook("afterChange",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return c7(d7,e,p7).call(e,...n)}),this.addHook("afterUpdateSettings",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return c7(d7,e,m7).call(e,...n)}),this.addHook("afterLoadData",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return c7(d7,e,g7).call(e,...n)}),this.addHook("afterUpdateData",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return c7(d7,e,v7).call(e,...n)}),this.addHook("beforeCreateRow",(e,t,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",e,t,null,n)),this.addHook("beforeCreateCol",(e,t,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",e,t,null,n)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...n)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...n)}),this.addHook("afterCreateRow",(e,t,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",e,t,null,n)),this.addHook("afterCreateCol",(e,t,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",e,t,null,n)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...n)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...n)}),this.addHook("afterRowMove",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return c7(d7,e,y7).call(e,...n)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e)}}calculateSum(e){let t=0;return rB(e.ranges,n=>{t+=this.getPartialSum(n,e.sourceColumn)}),t}getPartialSum(e,t){let n=0,r=e[1]||e[0],i=null,o=0;do{if(i=this.getCellValue(r,t),i=r7(i)?null:i,null!==i){const e=("".concat(i).split(".")[1]||[]).length||1;e>o&&(o=e)}n+=i||0,r-=1}while(r>=e[0]);return Math.round(n*10**o)/10**o}calculateMinMax(e,t){let n=null;return rB(e.ranges,r=>{const i=this.getPartialMinMax(r,e.sourceColumn,t);if(null===n&&null!==i&&(n=i),null!==i)switch(t){case"min":n=Math.min(n,i);break;case"max":n=Math.max(n,i)}}),null===n?"Not enough data":n}getPartialMinMax(e,t,n){let r,i=null,o=e[1]||e[0];do{if(r=this.getCellValue(o,t),r=r7(r)?null:r,null===i)i=r;else if(null!==r)switch(n){case"min":i=Math.min(i,r);break;case"max":i=Math.max(i,r)}o-=1}while(o>=e[0]);return i}countEmpty(e,t){let n,r=0,i=e[1]||e[0];do{n=this.getCellValue(i,t),n=r7(n)?null:n,null===n&&(r+=1),i-=1}while(i>=e[0]);return r}countEntries(e){let t=0;return rB(e.ranges,n=>{const r=void 0===n[1]?1:n[1]-n[0]+1,i=this.countEmpty(n,e.sourceColumn);t+=r,t-=i}),t}calculateAverage(e){return this.calculateSum(e)/this.countEntries(e)}getCellValue(e,t){const n=this.hot.toVisualRow(e),r=this.hot.toVisualColumn(t);let i=this.hot.getSourceDataAtCell(e,t),o="";if(null!==n&&null!==r&&(o=this.hot.getCellMeta(n,r).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"===typeof i&&(i=i.replace(/,/,".")),i=parseFloat(i)),isNaN(i)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ZH(a7||(a7=RH(["ColumnSummary plugin: cell at (",", ",") is not in a \n          numeric format. Cannot do the calculation."],["ColumnSummary plugin: cell at (",", ",") is not in a\\x20\n          numeric format. Cannot do the calculation."])),e,t));return i}}function f7(){this.endpoints.initEndpoints()}function m7(e){void 0!==e.columns&&this.endpoints.refreshCellMetas()}function p7(e,t){e&&"ColumnSummary.reset"!==t&&"ColumnSummary.set"!==t&&"loadData"!==t&&this.endpoints.refreshChangedEndpoints(e)}function g7(e,t){t||this.endpoints.refreshAllEndpoints()}function v7(e,t){t||this.endpoints.refreshAllEndpoints()}function y7(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}function b7(e,t,n){w7(e,t),t.set(e,n)}function w7(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function x7(e,t){return e.get(C7(e,t))}function S7(e,t,n){return e.set(C7(e,t),n),n}function C7(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var E7=new WeakMap,N7=new WeakMap,T7=new WeakMap,A7=new WeakSet;class R7{constructor(){!function(e,t){w7(e,t),t.add(e)}(this,A7),b7(this,E7,!0),b7(this,N7,null),b7(this,T7,new ResizeObserver(e=>C7(A7,this,k7).call(this,e)))}setObservedElement(e){S7(N7,this,e)}unobserve(){x7(T7,this).unobserve(x7(N7,this))}observe(){S7(E7,this,!0),x7(T7,this).observe(x7(N7,this))}destroy(){x7(T7,this).disconnect()}}function k7(e){!x7(E7,this)&&Array.isArray(e)&&e.length?e.forEach(e=>{let{borderBoxSize:t}=e;const{inlineSize:n,blockSize:r}=t[0];this.runLocalHooks("resize",n,r)}):S7(E7,this,!1)}function M7(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function D7(e,t){return e.get(O7(e,t))}function _7(e,t,n){return e.set(O7(e,t),n),n}function O7(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ZL(R7,oK);var I7=new WeakMap,P7=new WeakMap,j7=new WeakMap,F7=new WeakMap,H7=new WeakMap,L7=new WeakMap,B7=new WeakMap,z7=new WeakMap;class W7{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t,n){var r=this;M7(this,I7,void 0),M7(this,P7,void 0),M7(this,j7,!1),M7(this,F7,null),M7(this,H7,void 0),M7(this,L7,void 0),M7(this,B7,!0),M7(this,z7,new R7),_7(I7,this,e),_7(P7,this,n),_7(j7,this,t),_7(H7,this,this.createEditor()),_7(L7,this,D7(H7,this).style),D7(z7,this).setObservedElement(this.getInputElement()),D7(z7,this).addLocalHook("resize",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("resize",...t)}),this.hide()}setPosition(e,t){D7(L7,this).left="".concat(e,"px"),D7(L7,this).top="".concat(t,"px")}setSize(e,t){if(e&&t){const n=this.getInputElement();n.style.width="".concat(e,"px"),n.style.height="".concat(t,"px")}}getSize(){return{width:gz(this.getInputElement()),height:vz(this.getInputElement())}}observeSize(){D7(z7,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){this.getInputElement().readOnly=e}show(){D7(L7,this).display="block",_7(B7,this,!1)}hide(){D7(z7,this).unobserve(),D7(B7,this)||(D7(L7,this).display="none"),_7(B7,this,!0)}isVisible(){return"block"===D7(L7,this).display}setValue(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||"";this.getInputElement().value=e}getValue(){return this.getInputElement().value}isFocused(){return D7(I7,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=D7(I7,this).createElement("div"),t=D7(I7,this).createElement("textarea");return e.style.display="none",_7(F7,this,D7(I7,this).createElement("div")),D7(F7,this).setAttribute("dir",D7(j7,this)?"rtl":"ltr"),KB(D7(F7,this),W7.CLASS_EDITOR_CONTAINER),D7(P7,this).appendChild(D7(F7,this)),KB(e,W7.CLASS_EDITOR),KB(t,W7.CLASS_INPUT),t.setAttribute("data-hot-input",!0),e.appendChild(t),D7(F7,this).appendChild(e),e}getInputElement(){return D7(H7,this).querySelector(".".concat(W7.CLASS_INPUT))}getEditorElement(){return D7(H7,this)}destroy(){const e=D7(F7,this)?D7(F7,this).parentNode:null;D7(H7,this).parentNode.removeChild(D7(H7,this)),_7(H7,this,null),_7(L7,this,null),D7(z7,this).destroy(),e&&e.removeChild(D7(F7,this))}}ZL(W7,oK);const V7=W7;function U7(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class q7{constructor(e){U7(this,"wasLastActionShow",!0),U7(this,"showDebounced",null),U7(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")},250)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=Yz(e=>{this.wasLastActionShow&&this.runLocalHooks("show",e.from.row,e.from.col)},e)}destroy(){this.clearLocalHooks()}}ZL(q7,oK);const G7=q7,Y7="---------";function K7(e,t){const n={};return WH(e,e=>{e.forAll((e,r)=>{e>=0&&r>=0&&(n[e]||(n[e]=[]),n[e][r]=t(e,r))})}),n}function $7(e,t,n,r,i){WH(e,e=>{e.forAll((e,o)=>{e>=0&&o>=0&&function(e,t,n,r,i,o){const a=i(e,t);let s=r;a.className&&(s="vertical"===n?function(e,t){if(-1!==e.indexOf(t))return e;const n=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(n," ").concat(t)}(a.className,r):function(e,t){if(-1!==e.indexOf(t))return e;const n=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(n," ").concat(t)}(a.className,r));o(e,t,"className",s)}(e,o,t,n,r,i)})})}function X7(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function Q7(e,t){let n=!1;return Array.isArray(e)&&WH(e,e=>(e.forAll((e,r)=>{if(e>=0&&r>=0&&t(e,r))return n=!0,!1}),n)),n}function J7(e,t){const n={top:0,left:0};if(t!==e.ownerDocument){const{frameElement:e}=t.defaultView,{top:r,left:i}=e.getBoundingClientRect();n.top=r,n.left=i}return n}function Z7(e,t,n){e9(e,t),t.set(e,n)}function e9(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function t9(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n9(e,t,n){return e.set(i9(e,t),n),n}function r9(e,t){return e.get(i9(e,t))}function i9(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const o9="comments",a9="comment",s9="value",l9="style",c9="readOnly",u9=o9,d9="plugin:".concat(o9);var h9=new WeakMap,f9=new WeakMap,m9=new WeakMap,p9=new WeakMap,g9=new WeakMap,v9=new WeakMap,y9=new WeakMap,b9=new WeakSet;class w9 extends T5{constructor(){super(...arguments),function(e,t){e9(e,t),t.add(e)}(this,b9),t9(this,"range",{}),Z7(this,h9,null),Z7(this,f9,null),Z7(this,m9,!1),Z7(this,p9,!1),Z7(this,g9,!1),Z7(this,v9,null),Z7(this,y9,"")}static get PLUGIN_KEY(){return o9}static get PLUGIN_PRIORITY(){return 60}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[o9]}enablePlugin(){var e=this;this.enabled||(r9(h9,this)||(n9(h9,this,new V7(this.hot.rootDocument,this.hot.isRtl(),this.hot.rootPortalElement)),r9(h9,this).addLocalHook("resize",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return i9(b9,e,R9).call(e,...n)}),this.hot.addHook("afterSetTheme",(e,t)=>{t||this.hide()})),r9(f9,this)||n9(f9,this,new G7(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,t,n,r,i,o)=>i9(b9,this,N9).call(this,e,o)),this.addHook("afterScroll",()=>i9(b9,this,M9).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>i9(b9,this,k9).call(this,e)),this.addHook("beforeCompositionStart",e=>i9(b9,this,k9).call(this,e)),r9(f9,this).addLocalHook("hide",()=>this.hide()),r9(f9,this).addLocalHook("show",(e,t)=>this.showAtCell(e,t)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){r9(f9,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),t=e.getContext("grid"),n=e.addContext(d9);t.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const t=this.hot.getSelectedRangeActive();n9(p9,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(t),this.show(),this.focusEditor(),e.setActiveContextName(d9),this.hot._registerTimeout(()=>{n9(p9,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var e;return null===(e=this.hot.getSelectedRangeActive())||void 0===e?void 0:e.highlight.isCell()},group:u9}),n.addShortcut({keys:[["Escape"]],callback:()=>{r9(h9,this).setValue(r9(y9,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>r9(h9,this).isVisible()&&r9(h9,this).isFocused(),group:u9}),n.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>r9(h9,this).isVisible()&&r9(h9,this).isFocused(),group:u9}),n.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{n9(g9,this,!0),r9(h9,this).setValue(r9(h9,this).getValue()),this.setComment(),this.hide(),e.setActiveContextName("grid")},group:u9})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(u9)}registerListeners(){const{rootDocument:e}=this.hot,t=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",e=>i9(b9,this,C9).call(this,e)),this.eventManager.addEventListener(e,"mousedown",e=>i9(b9,this,x9).call(this,e)),this.eventManager.addEventListener(e,"mouseup",()=>i9(b9,this,E9).call(this)),this.eventManager.addEventListener(t,"focus",()=>i9(b9,this,A9).call(this)),this.eventManager.addEventListener(t,"blur",()=>i9(b9,this,T9).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",e=>i9(b9,this,S9).call(this,e))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=LB(e.target,"TD","TBODY");return!!(t&&YB(t,"htCommentCell")&&LB(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=r9(h9,this).getValue();let n="";null!==e&&void 0!==e?n=e:null!==t&&void 0!==t&&(n=t);const{row:r,col:i}=i9(b9,this,D9).call(this);this.updateCommentMeta(r,i,{[s9]:n}),this.hot.render()}setCommentAtCell(e,t,n){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(n)}removeComment(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{row:t,col:n}=i9(b9,this,D9).call(this);this.hot.setCellMeta(t,n,a9),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(n)}getComment(){const{row:e,col:t}=i9(b9,this,D9).call(this);return this.getCommentMeta(e,t,s9)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,s9)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{row:t,col:n}=i9(b9,this,D9).call(this);if(t<0||t>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;const r=this.hot.getCellMeta(t,n);return r9(f9,this).cancelHiding(),r9(h9,this).setValue(null!==(e=r[a9]?r[a9][s9]:null)&&void 0!==e?e:""),r9(h9,this).show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){r9(h9,this).hide()}refreshEditor(){if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&(!this.range.from||!r9(h9,this).isVisible()))return;const{rowIndexMapper:e,columnIndexMapper:t}=this.hot,{row:n,col:r}=i9(b9,this,D9).call(this);let i=e.getRenderableFromVisualIndex(n),o=t.getRenderableFromVisualIndex(r);const a=null===i;r9(h9,this).setPosition(0,0),null===i&&(i=e.getRenderableFromVisualIndex(e.getNearestNotHiddenIndex(n,-1))),null===o&&(o=t.getRenderableFromVisualIndex(t.getNearestNotHiddenIndex(r,-1)));const s=null===i,l=null===o;i=null!==i&&void 0!==i?i:0,o=null!==o&&void 0!==o?o:0;const{rootWindow:c,view:{_wt:u}}=this.hot,{wtTable:d}=u,h=u.getCell({row:i,col:o},!0),f=this.getCommentMeta(n,r,l9);f?r9(h9,this).setSize(f.width,f.height):r9(h9,this).resetSize();const m=l?0:d.getColumnWidth(o),p=a&&!s?vz(h):0,{left:g,top:v,width:y,height:b}=h.getBoundingClientRect(),{width:w,height:x}=r9(h9,this).getSize(),{innerWidth:S,innerHeight:C}=this.hot.rootWindow,E=this.hot.rootDocument.documentElement,N=kz(this.hot.rootDocument),T=Mz(this.hot.rootWindow)?N:0,A=Dz(this.hot.rootWindow)?N:0;let R=g+c.scrollX+m,k=v+c.scrollY+p;this.hot.isRtl()&&(R-=w+m),this.hot.isLtr()&&g+y+w>S-T?R=g+c.scrollX-w-1:this.hot.isRtl()&&R<-(E.scrollWidth-E.clientWidth)&&(R=g+c.scrollX+m+1),v+x>C-A&&(k-=x-b+1),r9(h9,this).setPosition(R,k),r9(h9,this).setReadOnlyState(this.getCommentMeta(n,r,c9)),r9(h9,this).observeSize()}focusEditor(){r9(h9,this).focus()}updateCommentMeta(e,t,n){const r=this.hot.getCellMeta(e,t)[a9];let i;r?(i=QL(r),XL(i,n)):i=n,this.hot.setCellMeta(e,t,a9,i)}getCommentMeta(e,t,n){const r=this.hot.getCellMeta(e,t);if(r[a9])return r[a9][n]}addToContextMenu(e){var t;e.items.push({name:Y7},(t=this,{key:"commentsAddEdit",name(){var e;const n=null===(e=this.getSelectedRangeActive())||void 0===e?void 0:e.highlight;return null!==n&&void 0!==n&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(x$):this.getTranslatedPhrase(w$)},callback(){const e=this.getSelectedRangeActive();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}),function(e){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(S$)},callback(){this.getSelectedRangeActive().forAll((t,n)=>{t>=0&&n>=0&&e.removeCommentAtCell(t,n,!1)}),this.render()},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this),function(e){return{key:"commentsReadOnly",name(){const t=this.getTranslatedPhrase(C$),n=Q7(this.getSelectedRange(),(t,n)=>e.getCommentMeta(t,n,c9));return n?X7(t):t},callback(){this.getSelectedRangeActive().forAll((t,n)=>{if(t>=0&&n>=0){const r=!!e.getCommentMeta(t,n,c9);e.updateCommentMeta(t,n,{[c9]:!r})}})},disabled(){const t=this.getSelectedRangeActive();return!!(!t||t.highlight.isHeader()||!e.getCommentAtCell(t.highlight.row,t.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this))}getEditorInputElement(){return r9(h9,this).getInputElement()}destroy(){var e,t;null===(e=r9(h9,this))||void 0===e||e.destroy(),null===(t=r9(f9,this))||void 0===t||t.destroy(),super.destroy()}}function x9(e){if(this.hot.view&&this.hot.view._wt&&!r9(m9,this)&&!this.targetIsCommentTextArea(e)){const t=LB(e.target,"TD","TBODY");let n=null;t&&(n=this.hot.getCoords(t)),(!t||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function S9(e){e.stopPropagation()}function C9(e){const{rootDocument:t}=this.hot;if(!(r9(m9,this)||r9(h9,this).isFocused()||YB(e.target,"wtBorder")||r9(v9,this)===e.target)&&r9(h9,this))if(n9(v9,this,t.elementFromPoint(e.clientX,e.clientY)),this.targetIsCellWithComment(e)){const t=this.hot._createCellRange(this.hot.getCoords(e.target));r9(f9,this).show(t)}else WB(e.target,t)&&!this.targetIsCommentTextArea(e)&&r9(f9,this).hide()}function E9(){n9(m9,this,!1)}function N9(e,t){t[a9]&&t[a9][s9]&&KB(e,t.commentedCellClassName)}function T9(){r9(g9,this)?n9(g9,this,!1):(n9(y9,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment())}function A9(){n9(y9,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(d9)}function R9(e,t){const{row:n,col:r}=i9(b9,this,D9).call(this);this.updateCommentMeta(n,r,{[l9]:{width:e,height:t}})}function k9(e){r9(h9,this).isFocused()&&aW(e)}function M9(){r9(p9,this)||this.hide()}function D9(){return this.range instanceof kq?this.range.highlight:this.hot._createCellCoords(this.range.from.row,this.range.from.col)}function _9(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class O9{constructor(e){_9(this,"hot",void 0),_9(this,"commands",{}),_9(this,"commonCallback",null),this.hot=e}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=e.split(":"),o=i[0],a=2===i.length?i[1]:null;let s=this.commands[o];if(!s)throw new Error("Menu command '".concat(o,"' not exists."));if(a&&s.submenu&&(s=function(e,t){let n;return WH(t,t=>{const r=t.key?t.key.split(":"):null;if(Array.isArray(r)&&r[1]===e)return n=t,!1}),n}(a,s.submenu.items)),!0===s.disabled)return;if("function"===typeof s.disabled&&!0===s.disabled.call(this.hot))return;if(lB(s,"submenu"))return;const l=[];"function"===typeof s.callback&&l.push(s.callback),"function"===typeof this.commonCallback&&l.push(this.commonCallback),n.unshift(i.join(":")),WH(l,e=>e.apply(this.hot,n))}}const I9="alignment";const P9="clear_column";const j9="col_left";const F9="col_right";const H9="make_read_only";const L9="redo";const B9="remove_col";const z9="remove_row";const W9="row_above";const V9="row_below";const U9="no_items";const q9="undo";const G9=[W9,V9,j9,F9,P9,z9,B9,q9,L9,H9,I9,Y7,U9],Y9={[Y7]:function(){return{name:Y7}},[U9]:function(){return{key:U9,name(){return this.getTranslatedPhrase(e$)},disabled:!0,isCommand:!1}},[W9]:function(){return{key:W9,name(){return this.getTranslatedPhrase(t$)},callback(){const e=this.getSelectedRangeActive().getTopLeftCorner();this.alter("insert_row_above",e.row,1,"ContextMenu.rowAbove")},disabled(){const e=this.getSelectedRangeActive();return!!(!e||this.selection.isSelectedByColumnHeader()||e.isSingleHeader()&&e.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)||!!this.selection.isSelectedByCorner()&&0===this.countRows()},hidden(){return!this.getSettings().allowInsertRow}}},[V9]:function(){return{key:V9,name(){return this.getTranslatedPhrase(n$)},callback(){const e=this.getSelectedRangeActive().getBottomRightCorner();this.alter("insert_row_below",e.row,1,"ContextMenu.rowBelow")},disabled(){const e=this.getSelectedRangeActive();return!!(!e||this.selection.isSelectedByColumnHeader()||e.isSingleHeader()&&e.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}},[j9]:function(){return{key:j9,name(){return this.getTranslatedPhrase(r$)},callback(){const e=this.getSelectedRangeActive().getTopLeftCorner(),t=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(t,e.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const e=this.getSelectedRangeActive();return!!(!e||this.selection.isSelectedByRowHeader()||e.isSingleHeader()&&e.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)||!!this.selection.isSelectedByCorner()&&0===this.countCols()},hidden(){return!this.getSettings().allowInsertColumn}}},[F9]:function(){return{key:F9,name(){return this.getTranslatedPhrase(i$)},callback(){const e=this.getSelectedRangeActive().getTopRightCorner(),t=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(t,e.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const e=this.getSelectedRangeActive();return!!(!e||this.selection.isSelectedByRowHeader()||e.isSingleHeader()&&e.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}},[P9]:function(){return{key:P9,name(){return this.getTranslatedPhrase(u$)},callback(e,t){const n=t[0].start.col,r=t[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(t[0].start.row,t[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader()&&e.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let t=!1;return e.forAll((e,n)=>{if(e<0||n<0)return!0;const{readOnly:r}=this.getCellMeta(e,n);return!!r||(t=!0,!1)}),!t}}},[z9]:function(){return{key:z9,name(){const e=this.getSelected();let t=0;if(e)if(e.length>1)t=1;else{const[n,,r]=e[0];n-r!==0&&(t=1)}return this.getTranslatedPhrase(o$,t)},callback(){this.alter("remove_row",function(e){const t=sJ(e.getSelected());if(0===t||1===t)return[];const n=lJ(t,{createCellCoords:e._createCellCoords.bind(e),createCellRange:e._createCellRange.bind(e)}),r=new Set;WH(e.getSelected(),e=>{const{from:t,to:i}=n(e),o=Math.max(t.row,0),a=i.row-o+1;WH(Array.from(new Array(a),(e,t)=>o+t),e=>{r.has(e)||r.add(e)})});const i=LH(Array.from(r).sort((e,t)=>e-t),(e,t,n,r)=>(0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e),[]);return i}(this),1,"ContextMenu.removeRow")},disabled(){const e=this.getSelectedRangeActive();if(!e)return!0;if(e.isSingleHeader()&&e.highlight.row<0)return!0;const t=this.countRows();return this.selection.isSelectedByCorner()?0===t:this.selection.isSelectedByColumnHeader()||0===t},hidden(){return!this.getSettings().allowRemoveRow}}},[B9]:function(){return{key:B9,name(){const e=this.getSelected();let t=0;if(e)if(e.length>1)t=1;else{const[,n,,r]=e[0];n-r!==0&&(t=1)}return this.getTranslatedPhrase(a$,t)},callback(){this.alter("remove_col",function(e){const t=sJ(e.getSelected());if(0===t||1===t)return[];const n=lJ(t,{createCellCoords:e._createCellCoords.bind(e),createCellRange:e._createCellRange.bind(e)}),r=new Set;WH(e.getSelected(),e=>{const{from:t,to:i}=n(e),o=Math.max(t.col,0),a=i.col-o+1;WH(Array.from(new Array(a),(e,t)=>o+t),e=>{r.has(e)||r.add(e)})});const i=LH(Array.from(r).sort((e,t)=>e-t),(e,t,n,r)=>(0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e),[]);return i}(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const e=this.getSelectedRangeActive();if(!e)return!0;if(e.isSingleHeader()&&e.highlight.col<0)return!0;const t=this.countCols();return this.selection.isSelectedByCorner()?0===t:this.selection.isSelectedByRowHeader()||0===t},hidden(){return!this.getSettings().allowRemoveColumn}}},[q9]:function(){return{key:q9,name(){return this.getTranslatedPhrase(s$)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}},[L9]:function(){return{key:L9,name(){return this.getTranslatedPhrase(l$)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}},[H9]:function(){return{key:H9,checkable:!0,ariaChecked(){const e=Q7(this.getSelectedRange(),(e,t)=>this.getCellMeta(e,t).readOnly);return e},ariaLabel(){return this.getTranslatedPhrase(c$)},name(){let e=this.getTranslatedPhrase(c$);const t=Q7(this.getSelectedRange(),(e,t)=>this.getCellMeta(e,t).readOnly);return t&&(e=X7(e)),e},callback(){const e=this.getSelectedRange(),t=Q7(e,(e,t)=>this.getCellMeta(e,t).readOnly);WH(e,e=>{e.forAll((e,n)=>{e>=0&&n>=0&&this.setCellMeta(e,n,"readOnly",!t)})}),this.render()},disabled(){const e=this.getSelectedRangeActive();return!e||(!!e.isSingleHeader()||(!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))))}}},[I9]:function(){return{key:I9,name(){return this.getTranslatedPhrase(E$)},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const e=this.getSelectedRangeActive();return!e||(!!e.isSingleHeader()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner()))},submenu:{items:[{key:"".concat(I9,":left"),name(){return this.getTranslatedPhrase(N$)},callback(){const e=this.getSelectedRange(),t=K7(e,(e,t)=>this.getCellMeta(e,t).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",t,e,n,r),$7(e,n,r,(e,t)=>this.getCellMeta(e,t),(e,t,n,r)=>this.setCellMeta(e,t,n,r)),this.render()},disabled:!1},{key:"".concat(I9,":center"),name(){return this.getTranslatedPhrase(T$)},callback(){const e=this.getSelectedRange(),t=K7(e,(e,t)=>this.getCellMeta(e,t).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",t,e,n,r),$7(e,n,r,(e,t)=>this.getCellMeta(e,t),(e,t,n,r)=>this.setCellMeta(e,t,n,r)),this.render()},disabled:!1},{key:"".concat(I9,":right"),name(){return this.getTranslatedPhrase(A$)},callback(){const e=this.getSelectedRange(),t=K7(e,(e,t)=>this.getCellMeta(e,t).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",t,e,n,r),$7(e,n,r,(e,t)=>this.getCellMeta(e,t),(e,t,n,r)=>this.setCellMeta(e,t,n,r)),this.render()},disabled:!1},{key:"".concat(I9,":justify"),name(){return this.getTranslatedPhrase(R$)},callback(){const e=this.getSelectedRange(),t=K7(e,(e,t)=>this.getCellMeta(e,t).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",t,e,n,r),$7(e,n,r,(e,t)=>this.getCellMeta(e,t),(e,t,n,r)=>this.setCellMeta(e,t,n,r)),this.render()},disabled:!1},{name:Y7},{key:"".concat(I9,":top"),name(){return this.getTranslatedPhrase(k$)},callback(){const e=this.getSelectedRange(),t=K7(e,(e,t)=>this.getCellMeta(e,t).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",t,e,n,r),$7(e,n,r,(e,t)=>this.getCellMeta(e,t),(e,t,n,r)=>this.setCellMeta(e,t,n,r)),this.render()},disabled:!1},{key:"".concat(I9,":middle"),name(){return this.getTranslatedPhrase(M$)},callback(){const e=this.getSelectedRange(),t=K7(e,(e,t)=>this.getCellMeta(e,t).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",t,e,n,r),$7(e,n,r,(e,t)=>this.getCellMeta(e,t),(e,t,n,r)=>this.setCellMeta(e,t,n,r)),this.render()},disabled:!1},{key:"".concat(I9,":bottom"),name(){return this.getTranslatedPhrase(D$)},callback(){const e=this.getSelectedRange(),t=K7(e,(e,t)=>this.getCellMeta(e,t).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",t,e,n,r),$7(e,n,r,(e,t)=>this.getCellMeta(e,t),(e,t,n,r)=>this.setCellMeta(e,t,n,r)),this.render()},disabled:!1}]}}}};function K9(){const e={};return rB(Y9,(t,n)=>{e[n]=t()}),e}function $9(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class X9{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;$9(this,"hot",void 0),$9(this,"predefinedItems",K9()),$9(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,rB(e,(e,n)=>{let r="";e.name===Y7?(t[Y7]=e,r=Y7):isNaN(parseInt(n,10))?(e.key=void 0===e.key?n:e.key,t[n]=e,r=e.key):(t[e.key]=e,r=e.key),this.defaultOrderPattern.push(r)}),this.predefinedItems=t}getItems(){return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=[];let i=e;i&&i.items?i=i.items:Array.isArray(i)||(i=t);tB(i)?rB(i,(e,t)=>{let i=n["string"===typeof e?e:t];i||(i=e),tB(e)?$L(i,e):"string"===typeof i&&(i={name:i}),void 0===i.key&&(i.key=t),r.push(i)}):WH(i,(e,t)=>{let i=n[e];!i&&G9.indexOf(e)>=0||(i||(i={name:e,key:"".concat(t)}),tB(e)&&$L(i,e),void 0===i.key&&(i.key=t),r.push(i))});return r}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,this.defaultOrderPattern,this.predefinedItems)}}function Q9(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class J9{constructor(e,t){Q9(this,"top",void 0),Q9(this,"topRelative",void 0),Q9(this,"left",void 0),Q9(this,"leftRelative",void 0),Q9(this,"scrollTop",void 0),Q9(this,"scrollLeft",void 0),Q9(this,"cellHeight",void 0),Q9(this,"cellWidth",void 0);const n=t.scrollY,r=t.scrollX;let i,o,a,s,l,c;this.rootWindow=t,this.type=this.getSourceType(e),"literal"===this.type?(i=parseInt(e.top,10),a=parseInt(e.left,10),l=e.height||0,c=e.width||0,o=i,s=a,i+=n,a+=r):"event"===this.type&&(i=parseInt(e.pageY,10),a=parseInt(e.pageX,10),l=e.target.clientHeight,c=e.target.clientWidth,o=i-n,s=a-r),this.top=i,this.topRelative=o,this.left=a,this.leftRelative=s,this.scrollTop=n,this.scrollLeft=r,this.cellHeight=l,this.cellWidth=c}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.document.documentElement.clientWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Z9(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function eee(e,t){return e.get(nee(e,t))}function tee(e,t,n){return e.set(nee(e,t),n),n}function nee(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var ree=new WeakMap,iee=new WeakMap,oee=new WeakMap,aee=new WeakMap,see=new WeakMap;class lee{constructor(e){Z9(this,ree,void 0),Z9(this,iee,void 0),Z9(this,oee,void 0),Z9(this,aee,!1),Z9(this,see,{above:0,below:0,left:0,right:0}),tee(aee,this,e)}setOffset(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return eee(see,this)[e]=t,this}setElement(e){return tee(ree,this,e),this}setParentElement(e){return tee(iee,this,e),this}updatePosition(e){tee(oee,this,new J9(e,eee(ree,this).ownerDocument.defaultView)),eee(aee,this)?(eee(oee,this).fitsBelow(eee(ree,this))?this.setPositionBelowCursor():eee(oee,this).fitsAbove(eee(ree,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===eee(ree,this).dir?eee(oee,this).fitsOnLeft(eee(ree,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():eee(oee,this).fitsOnRight(eee(ree,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=eee(see,this).above+eee(oee,this).top-eee(ree,this).offsetHeight;if(eee(iee,this)){const t=eee(iee,this).ownerDocument.defaultView.getComputedStyle(eee(iee,this).querySelector(".ht_master")),n=Number.parseInt(t.paddingTop,10),r=Number.parseInt(t.borderTop,10);e=eee(oee,this).top+eee(oee,this).cellHeight-eee(ree,this).scrollHeight+n+r}eee(ree,this).style.top="".concat(e,"px")}setPositionBelowCursor(){let e=eee(see,this).below+eee(oee,this).top+1;if(eee(iee,this)){const t=eee(iee,this).ownerDocument.defaultView.getComputedStyle(eee(iee,this).querySelector(".ht_master")),n=Number.parseInt(t.paddingTop,10),r=Number.parseInt(t.borderTop,10);e=eee(oee,this).top-n-r}eee(ree,this).style.top="".concat(e,"px")}setPositionOnRightOfCursor(){let e=eee(oee,this).left;if(eee(iee,this)){const t=eee(iee,this).ownerDocument.defaultView,n=Number.parseInt(t.getComputedStyle(eee(iee,this).querySelector(".htCore")).borderRightWidth,10);e+=eee(oee,this).cellWidth+n}else e+=eee(see,this).right;eee(ree,this).style.left="".concat(e,"px")}setPositionOnLeftOfCursor(){let e=eee(see,this).left+eee(oee,this).left-eee(ree,this).offsetWidth;if(eee(iee,this)){const t=eee(iee,this).ownerDocument.defaultView;e-=Number.parseInt(t.getComputedStyle(eee(iee,this).querySelector(".htCore")).borderLeftWidth,10)}eee(ree,this).style.left="".concat(e,"px")}}function cee(e){let{initialPage:t=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=e;const o=new Set;let a=pV(t,-1,l()-1);function s(e,t){const n=l()-1;if(e<0&&(e=n),e>n&&(e=0),o.has(e))return-1;o.add(e);return!1===r(e,!1)&&(e=s(1===t?++e:--e,t)),e}function l(){return Math.max(n(),0)}return{setCurrentPage:function(e){e>-1&&e<l()&&!1!==r(e,!0)&&(a=e)},setPageCursorAt:function(e){e>-1&&e<l()&&(a=e)},getCurrentPage:function(){return a},toFirstItem:function(){l()>0&&(o.clear(),a=s(0,1))},toLastItem:function(){l()>0&&(o.clear(),a=s(l()-1,-1))},toNextItem:function(){l()>0&&(o.clear(),a=s(++a,1))},toPreviousItem:function(){l()>0&&(o.clear(),a=s(--a,-1))},getSize:l,clear:function(){o.clear(),a=t,i()}}}function uee(e){return lB(e,"submenu")}function dee(e){return new RegExp(Y7,"i").test(e.name)}function hee(e,t){return!0===e.disabled||"function"===typeof e.disabled&&!0===e.disabled.call(t)}function fee(e){return lB(e,"disableSelection")}function mee(e,t){const n=e.slice(0);for(let r=0;r<n.length&&n[r].name===t;)n.shift();return n}function pee(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Y7,n=e.slice(0);return n=mee(n,t),n=function(e,t){let n=e.slice(0);return n.reverse(),n=mee(n,t),n.reverse(),n}(n,t),n=function(e){const t=[];return WH(e,(e,n)=>{n>0?t[t.length-1].name!==e.name&&t.push(e):t.push(e)}),t}(n),n}function gee(e){return cee({size:()=>e.countRows(),onItemSelect(t,n){const r=e.getCell(t,0);if(!r||function(e){return YB(e,"htSeparator")}(r)||function(e){return YB(e,"htDisabled")}(r)||function(e){return YB(e,"htSelectionDisabled")}(r))return!1;e.selectCell(t,0,...n?[t,0,!1,!1]:[])},onClear(){e.deselectCell()}})}const vee="menu",yee=vee;function bee(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function wee(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xee(e,t,n){return e.set(Cee(e,t),n),n}function See(e,t){return e.get(Cee(e,t))}function Cee(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Eee=new WeakMap,Nee=new WeakMap,Tee=new WeakMap;class Aee{get tableBorderWidth(){return void 0===See(Tee,this)&&this.hotMenu&&xee(Tee,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),See(Tee,this)}constructor(e,t){var n=this;wee(this,"hot",void 0),wee(this,"options",void 0),wee(this,"eventManager",new $W(this)),wee(this,"container",void 0),wee(this,"positioner",void 0),wee(this,"hotMenu",null),wee(this,"hotSubMenus",{}),wee(this,"parentMenu",void 0),wee(this,"menuItems",null),wee(this,"origOutsideClickDeselects",null),bee(this,Eee,void 0),bee(this,Nee,void 0),bee(this,Tee,void 0),this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new lee(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.parentMenu.runLocalHooks("afterSelectionChange",...t)}),this.hot.addHook("afterSetTheme",(e,t)=>{this.options.container!==this.hot.rootPortalElement&&($B(this.options.container,/ht-theme-.*/g),KB(this.options.container,e)),t||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",e=>this.onDocumentMouseDown(e)),this.eventManager.addEventListener(e.document,"touchstart",e=>this.onDocumentMouseDown(e)),this.eventManager.addEventListener(e.document,"contextmenu",e=>this.onDocumentContextMenu(e)),e=FB(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return See(Eee,this)}getKeyboardShortcutsCtrl(){return See(Nee,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedActive()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedActive())}isSubMenu(){return null!==this.parentMenu}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Yz(e=>this.openSubMenu(e),300),t=this.options.minWidth||215;let n=!1,r=BH(this.menuItems,e=>(e.key===U9&&(n=!0),function(e,t){return!e.hidden||!("function"===typeof e.hidden&&e.hidden.call(t))}(e,this.hot)));if(r.length<1&&!n)r.push(K9()[U9]);else if(0===r.length)return;r=pee(r,Y7);let i=!1;const o={data:r,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:e=>nL(e)&&e<t?t:e,autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:(a=this.hot,(e,t,n,r,i,o)=>{const s=e.getSourceDataAtRow(n),l=a.rootDocument.createElement("div"),c="function"===typeof o?o.call(a):o,u="function"===typeof s.ariaLabel?s.ariaLabel.call(a):s.ariaLabel,d="function"===typeof s.ariaChecked?s.ariaChecked.call(a):s.ariaChecked;if(ZB(t),KB(l,"htItemWrapper"),a.getSettings().ariaTags){const e=!hee(s,a)&&!fee(s)&&!dee(s);XB(t,[...(h=s,!0===h.checkable?[["role","menuitemcheckbox"],IL(u),UL(d)]:[["role","menuitem"],IL(c)]),...e?[TL(-1)]:[],...hee(s,a)?[FL()]:[],...uee(s)?[VL(!1)]:[]])}var h;t.className="",t.appendChild(l),dee(s)?KB(t,"htSeparator"):"function"===typeof s.renderer?(KB(t,"htCustomMenuRenderer"),t.appendChild(s.renderer(e,l,n,r,i,c))):tz(l,c),hee(s,a)?KB(t,"htDisabled"):fee(s)?KB(t,"htSelectionDisabled"):uee(s)&&KB(t,"htSubmenu")})}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(e,t)=>{this.hotMenu.stylesHandler.isClassicTheme()?See(Eee,this).setCurrentPage(t.row):See(Eee,this).setPageCursorAt(t.row)},afterOnCellMouseOver:(t,n)=>{this.isAllSubMenusClosed()?e(n.row):this.openSubMenu(n.row)},afterOnCellContextMenu:e=>{e.preventDefault(),DB()&&i&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(e,t,n,r,i)=>{this.hotMenu.view.isMouseDown()&&(i.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:e=>{this.hasSelectedItem()&&(i=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(e))},afterOnCellMouseUp:e=>{DB()&&lW(e)||!i||!this.hasSelectedItem()||(RB()||MB()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};var a;this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),xee(Eee,this,gee(this.hotMenu)),xee(Nee,this,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=[];function r(e,t){a(t).addShortcuts(e,{group:vee})}function i(e,t){const i=a(t);e.forEach(e=>{let{keys:t}=e;t.forEach(e=>i.removeShortcutsByKeys(e))}),n.push({shortcuts:e,contextName:t}),r(e,t)}function o(e){return e?"".concat(yee,":").concat(e):yee}function a(t){var n;const r=e.hotMenu.getShortcutManager(),i=o(t);return null!==(n=r.getContext(i))&&void 0!==n?n:r.addContext(i)}return r(function(e){const{hot:t,hotMenu:n}=e;return[{keys:[["Control/Meta","A"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:()=>e.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,r)=>{const i=t.getSettings(),o="function"===typeof i.tabMoves?i.tabMoves(n):i.tabMoves;r.includes("shift")?t.selection.transformStart(-o.row,-o.col):t.selection.transformStart(o.row,o.col),e.close(!0)}},{keys:[["Escape"]],callback:()=>e.close()},{keys:[["ArrowDown"]],callback:()=>e.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>e.getNavigator().toPreviousItem()},{keys:[[t.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const t=n.getSelectedActive();if(t){const n=e.openSubMenu(t[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[[t.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedActive()&&e.isSubMenu()&&(e.close(),e.isSubMenu()&&e.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>e.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>e.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:t=>{const r=n.getSelectedActive();r&&(n.getSourceDataAtRow(r[0]).submenu?e.openSubMenu(r[0]).getNavigator().toFirstItem():(e.executeCommand(t),e.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedActive()?n.selection.transformStart(-n.countVisibleRows(),0):e.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedActive()?n.selection.transformStart(n.countVisibleRows(),0):e.getNavigator().toLastItem()}}]}(e)),t.forEach(e=>{let{shortcuts:t,contextName:n}=e;i(t,n)}),{addCustomShortcuts:i,getCustomShortcuts:function(){return[...n]},getContext:a,listen:function(t){e.hotMenu.getShortcutManager().setActiveContextName(o(t))}}}(this)),See(Nee,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened())if(e&&this.isSubMenu())this.parentMenu.close();else if(See(Eee,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const e=this.parentMenu.hotMenu.getSelectedActive();if(e){XB(this.parentMenu.hotMenu.getCell(e[0],0),[VL(!1)])}}this.parentMenu.hotMenu.listen()}}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!function(e){return YB(e,"htSubmenu")}(t))return!1;const n=this.hotMenu.getSourceDataAtRow(e),r=new Aee(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return r.setMenuItems(n.submenu.items),r.open(),r.setPosition(t.getBoundingClientRect()),this.hotSubMenus[n.key]=r,this.hot.getSettings().ariaTags&&XB(t,[VL(!0)]),r}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[t.key];if(n){n.destroy(),delete this.hotSubMenus[t.key];const r=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&XB(r,[VL(!1)])}}closeAllSubMenus(){WH(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const n=this.hot.getSelectedRange(),r=n?function(e){return zH(e,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}(n):[];this.runLocalHooks("executeCommand",t.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,r,e)}isCommandPassive(e){return!1===e.isCommand||dee(e)||hee(e,this.hot)||uee(e)}setOffset(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.positioner.setOffset(e,t)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,t=this.hotMenu.getSettings().data,n=e.hider.style,r=e.holder.style,i=parseInt(n.width,10),o=LH(t,(e,t,n)=>{const r=this.hotMenu.getCell(n,0)?vz(this.hotMenu.getCell(n,0)):0;return e+(t.name===Y7?1:r)},0);this.hotMenu.stylesHandler.isClassicTheme()?(r.width="".concat(i+3,"px"),r.height="".concat(o+3,"px")):(r.width="".concat(i,"px"),r.height="".concat(o,"px")),n.height=r.height}createContainer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=this.options.container.ownerDocument;let n,r=e;return r&&(Uz(r)&&(r=r.call(this.hot),r=null===r||rL(r)?"":r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r="".concat(this.options.className,"Sub_").concat(r),n=t.querySelector(".".concat(this.options.className,".").concat(r))),n||(n=t.createElement("div"),KB(n,"htMenu handsontable ".concat(this.options.className)),r&&KB(n,r),this.options.container.appendChild(n)),n}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&XB(this.hotMenu.rootElement,[["role","menu"],TL(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!WB(e.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||WB(e.target,".htMenu")||this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&YB(e.target,"htCore")&&WB(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}function Ree(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function kee(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Mee(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ZL(Aee,oK);const Dee="contextMenu",_ee=Dee;_W.getSingleton().register("afterContextMenuDefaultOptions"),_W.getSingleton().register("beforeContextMenuShow"),_W.getSingleton().register("afterContextMenuShow"),_W.getSingleton().register("afterContextMenuHide"),_W.getSingleton().register("afterContextMenuExecute");var Oee=new WeakSet;class Iee extends T5{constructor(){super(...arguments),Ree(this,Oee),kee(this,"commandExecutor",new O9(this.hot)),kee(this,"itemsFactory",null),kee(this,"menu",null)}static get PLUGIN_KEY(){return Dee}static get PLUGIN_PRIORITY(){return 70}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[W9,V9,Y7,j9,F9,Y7,z9,B9,Y7,q9,L9,Y7,H9,Y7,I9]}isEnabled(){return!!this.hot.getSettings()[Dee]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Dee];"function"===typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new Aee(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>Mee(Oee,this,jee).call(this)),this.menu.addLocalHook("afterOpen",()=>Mee(Oee,this,Fee).call(this)),this.menu.addLocalHook("afterClose",()=>Mee(Oee,this,Hee).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.executeCommand.call(e,...n)}),this.addHook("afterOnCellContextMenu",e=>Mee(Oee,this,Pee).call(this,e)),this.addHook("beforeDialogShow",()=>this.close()),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();this.hot.scrollToFocusedCell();const t=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=J7(this.menu.container,this.hot.rootDocument);this.open({left:t.left+n.left,top:t.top+n.top-1+t.height},{left:t.width,above:-t.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const t=null===(e=this.hot.getSelectedRangeActive())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&!this.menu.isOpened()},group:_ee})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(_ee)}open(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(t=this.menu)&&void 0!==t&&t.isOpened()||(this.prepareMenuItems(),this.menu.open(),rB(n,(e,t)=>{this.menu.setOffset(t,e)}),this.menu.setPosition(e))}close(){var e;null===(e=this.menu)||void 0===e||e.close(),this.itemsFactory=null}executeCommand(e){null===this.itemsFactory&&this.prepareMenuItems();for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new X9(this.hot,Iee.DEFAULT_ITEMS);const e=this.hot.getSettings()[Dee],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),WH(n,e=>this.commandExecutor.registerCommand(e.key,e))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Pee(e){const t=this.hot.getSettings(),n=t.rowHeaders,r=t.colHeaders;const i=e.target;if(this.close(),YB(i,"handsontableInput"))return;if(e.preventDefault(),e.stopPropagation(),!n&&!r&&!function(e){return"TD"===e.nodeName||"TD"===e.parentNode.nodeName}(i)&&(!YB(i,"current")||!YB(i,"wtBorder")))return;const o=J7(this.menu.container,this.hot.rootDocument);this.open({top:e.clientY+o.top,left:e.clientX+o.left})}function jee(){this.hot.runHooks("beforeContextMenuShow",this)}function Fee(){this.hot.runHooks("afterContextMenuShow",this)}function Hee(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Iee.SEPARATOR={name:Y7};class Lee{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class Bee{constructor(){this.clipboardData=new Lee}preventDefault(){}composedPath(){return[]}}function zee(e,t,n){Wee(e,t),t.set(e,n)}function Wee(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vee(e,t){return e.get(qee(e,t))}function Uee(e,t,n){return e.set(qee(e,t),n),n}function qee(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Gee=new WeakMap,Yee=new WeakMap,Kee=new WeakMap,$ee=new WeakMap,Xee=new WeakMap,Qee=new WeakMap,Jee=new WeakSet;class Zee{constructor(e){let{countRows:t,countColumns:n,rowsLimit:r,columnsLimit:i,countColumnHeaders:o}=e;!function(e,t){Wee(e,t),t.add(e)}(this,Jee),zee(this,Gee,void 0),zee(this,Yee,void 0),zee(this,Kee,void 0),zee(this,$ee,void 0),zee(this,Xee,void 0),zee(this,Qee,void 0),Uee(Yee,this,t),Uee(Kee,this,n),Uee($ee,this,r),Uee(Xee,this,i),Uee(Qee,this,o)}setSelectedRange(e){Uee(Gee,this,e)}getCellsRange(){if(0===Vee(Yee,this).call(this)||0===Vee(Kee,this).call(this))return null;const{row:e,col:t}=Vee(Gee,this).getTopStartCorner(),{row:n,col:r}=Vee(Gee,this).getBottomEndCorner(),i=qee(Jee,this,tte).call(this,e,n),o=qee(Jee,this,ete).call(this,t,r);return{isRangeTrimmed:n!==i||r!==o,startRow:e,startCol:t,endRow:i,endCol:o}}getMostBottomColumnHeadersRange(){if(0===Vee(Kee,this).call(this)||0===Vee(Qee,this).call(this))return null;const{col:e}=Vee(Gee,this).getTopStartCorner(),{col:t}=Vee(Gee,this).getBottomEndCorner(),n=qee(Jee,this,ete).call(this,e,t);return{isRangeTrimmed:t!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(0===Vee(Kee,this).call(this)||0===Vee(Qee,this).call(this))return null;const{col:e}=Vee(Gee,this).getTopStartCorner(),{col:t}=Vee(Gee,this).getBottomEndCorner(),n=qee(Jee,this,ete).call(this,e,t);return{isRangeTrimmed:t!==n,startRow:-Vee(Qee,this).call(this),startCol:e,endRow:-1,endCol:n}}}function ete(e,t){return Math.min(t,Math.max(e+Vee(Xee,this).call(this)-1,e))}function tte(e,t){return Math.min(t,Math.max(e+Vee($ee,this).call(this)-1,e))}function nte(e){const t=[],n=[];return WH(e,e=>{hV(Math.min(e.startRow,e.endRow),Math.max(e.startRow,e.endRow),e=>{-1===t.indexOf(e)&&t.push(e)});hV(Math.min(e.startCol,e.endCol),Math.max(e.startCol,e.endCol),e=>{-1===n.indexOf(e)&&n.push(e)})}),{rows:t,columns:n}}function rte(e,t,n){ite(e,t),t.set(e,n)}function ite(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ote(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ate(e,t){return e.get(lte(e,t))}function ste(e,t,n){return e.set(lte(e,t),n),n}function lte(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}_W.getSingleton().register("afterCopyLimit"),_W.getSingleton().register("modifyCopyableRange"),_W.getSingleton().register("beforeCut"),_W.getSingleton().register("afterCut"),_W.getSingleton().register("beforePaste"),_W.getSingleton().register("afterPaste"),_W.getSingleton().register("beforeCopy"),_W.getSingleton().register("afterCopy");const cte="copyPaste",ute=["fragmentSelection"],dte="application/ht-source-data-json-html",hte=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var fte=new WeakMap,mte=new WeakMap,pte=new WeakMap,gte=new WeakMap,vte=new WeakMap,yte=new WeakMap,bte=new WeakMap,wte=new WeakMap,xte=new WeakSet;class Ste extends T5{constructor(){super(...arguments),function(e,t){ite(e,t),t.add(e)}(this,xte),ote(this,"columnsLimit",1/0),ote(this,"rowsLimit",1/0),ote(this,"pasteMode","overwrite"),ote(this,"uiContainer",this.hot.rootDocument.body),rte(this,fte,!1),rte(this,mte,!1),rte(this,pte,!1),rte(this,gte,"cells-only"),rte(this,vte,!1),rte(this,yte,!1),rte(this,bte,new Zee({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),rte(this,wte,!1),ote(this,"copyableRanges",[])}static get PLUGIN_KEY(){return cte}static get SETTING_KEYS(){return[cte,...ute]}static get PLUGIN_PRIORITY(){return 80}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[cte]}enablePlugin(){var e,t,n=this;this.enabled||(this.pasteMode=null!==(e=this.getSetting("pasteMode"))&&void 0!==e?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),ste(fte,this,this.getSetting("copyColumnHeaders")),ste(mte,this,this.getSetting("copyColumnGroupHeaders")),ste(pte,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=null!==(t=this.getSetting("uiContainer"))&&void 0!==t?t:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",e=>lte(xte,this,Rte).call(this,e)),this.addHook("afterSelection",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return lte(xte,n,kte).call(n,...t)}),this.addHook("afterSelectionEnd",()=>lte(xte,this,Mte).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return n.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return n.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return n.onPaste(...arguments)}),NB()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return lte(xte,n,Dte).call(n,...t)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return lte(xte,n,_te).call(n,...t)}),this.addHook("afterSelection",()=>lte(xte,this,Ote).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){ste(gte,this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only"),ste(vte,this,!0),lte(xte,this,Cte).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){ste(yte,this,!0),lte(xte,this,Cte).call(this,"cut")}getRangedCopyableData(e){return rZ(this.getRangedData(e))}getRangedData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=[],{rows:r,columns:i}=nte(e);return WH(r,e=>{const r=[];WH(i,n=>{if(e<0)r.push(this.hot.getColHeader(n,e));else{let i=t?this.hot.getCopyableSourceData(e,n):this.hot.getCopyableData(e,n);t&&tB(i)&&(i=JSON.stringify(i)),r.push(i)}}),n.push(r)}),n}paste(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(!e&&!t)return;const n=new Bee;e&&n.clipboardData.setData("text/plain",e),t&&n.clipboardData.setData("text/html",t),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeActive();if(!e)return;if(e.isSingleHeader())return void(this.copyableRanges=[]);ate(bte,this).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);"column-headers-only"===ate(gte,this)?t.set("headers",ate(bte,this).getMostBottomColumnHeadersRange()):("with-column-headers"===ate(gte,this)?t.set("headers",ate(bte,this).getMostBottomColumnHeadersRange()):"with-column-group-headers"===ate(gte,this)&&t.set("headers",ate(bte,this).getAllColumnHeadersRange()),t.set("cells",ate(bte,this).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(e=>null!==e).map(e=>{let{startRow:t,startCol:n,endRow:r,endCol:i}=e;return{startRow:t,startCol:n,endRow:r,endCol:i}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=t.get("cells");if(null!==n&&n.isRangeTrimmed){const{startRow:e,startCol:t,endRow:r,endCol:i}=n;this.hot.runHooks("afterCopyLimit",r-e+1,i-t+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return null===(e=this.hot.getActiveEditor())||void 0===e?void 0:e.isOpened()}populateValues(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getSelectedRangeActive();if(!e.length)return[null,null,null,null];const r=e.length,i=e[0].length,o=[],{row:a,col:s}=n.getTopStartCorner(),{row:l,col:c}=n.getBottomEndCorner();let u=a,d=s,h=a,f=s;for(;o.length<r||u<=l;){const{skipRowOnPaste:n,visualRow:a}=this.hot.getCellMeta(u,s);if(u=a+1,!0===n)continue;h=a,d=s;const l=[],p=o.length%r;for(;l.length<i||d<=c;){var m;const{skipColumnOnPaste:n,visualCol:r}=this.hot.getCellMeta(a,d),o=this.hot.getSourceDataAtCell(a,d),s=l.length%i;if(d=r+1,!0===n)continue;f=r;const c=null===t||void 0===t||null===(m=t[p])||void 0===m?void 0:m[s];let u=e[p][s];if(t&&xL(c)){const e=JSON.parse(c);(tB(o)||null===o)&&(u=e)}l.push(u)}o.push(l)}return ste(wte,this,!0),this.hot.populateFromArray(a,s,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,s,h,f]}onCopy(e){const t=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),r=null===t||void 0===t?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!ate(vte,this)||this.isEditorOpened()||Vz(t)&&(r&&t!==n||!r&&t!==this.hot.rootDocument.body&&!PB(t,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),ste(vte,this,!1);const i=this.getRangedData(this.copyableRanges),o=this.getRangedData(this.copyableRanges,!0),a=lte(xte,this,Ete).call(this,this.copyableRanges);!!this.hot.runHooks("beforeCopy",i,this.copyableRanges,a)&&(lte(xte,this,Ate).call(this,e,i,o),this.hot.runHooks("afterCopy",i,this.copyableRanges,a)),ste(gte,this,"cells-only")}onCut(e){const t=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),r=null===t||void 0===t?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!ate(yte,this)||this.isEditorOpened()||Vz(t)&&(r&&t!==n||!r&&t!==this.hot.rootDocument.body&&!PB(t,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),ste(yte,this,!1);const i=this.getRangedData(this.copyableRanges),o=this.getRangedData(this.copyableRanges,!0);!!this.hot.runHooks("beforeCut",i,this.copyableRanges)&&(lte(xte,this,Ate).call(this,e,i,o),this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",i,this.copyableRanges))}onPaste(e){const t=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),r=null===t||void 0===t?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||Vz(t)&&(r&&t!==n||!r&&t!==this.hot.rootDocument.body&&!PB(t,this.hot.rootElement)))return;let i,o;if(e.preventDefault(),e&&"undefined"!==typeof e.clipboardData){const t=e.clipboardData.getData(dte);if(t){o=cV(t,this.hot.rootDocument).data}const n=NL(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(n&&/(<table)|(<TABLE)/g.test(n)){i=cV(n,this.hot.rootDocument).data}else i=e.clipboardData.getData("text/plain")}else"undefined"===typeof ClipboardEvent&&"undefined"!==typeof this.hot.rootWindow.clipboardData&&(i=this.hot.rootWindow.clipboardData.getData("Text"));if("string"===typeof i&&(i=function(e){const t=[[""]];if(0===e.length)return t;let n,r=0,i=0;for(;e.length>0&&n!==e.length;)if(n=e.length,e.match(nZ))e=e.replace(nZ,""),r+=1,t[i][r]="";else if(e.match(eZ))e=e.replace(eZ,""),r=0,i+=1,t[i]=[""];else{let n="";if(e.startsWith('"')){let t=0,r=!0;for(;r;){const i=e.slice(0,1);'"'===i&&(t+=1),n+=i,(0===(e=e.slice(1)).length||e.match(/^[\t\r\n]/)&&t%2===0)&&(r=!1)}n=n.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,e=>new Array(Math.floor(e.length/2)).fill('"').join(""))}else{const t=e.match(tZ);n=t?t[0]:"",e=e.slice(n.length)}t[i][r]=n}return t}(i)),void 0===i||i&&0===i.length)return;if(!1===this.hot.runHooks("beforePaste",i,this.copyableRanges))return;const[a,s,l,c]=this.populateValues(i,o);null!==a&&null!==s&&this.hot.selectCell(a,s,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,c)),this.hot.runHooks("afterPaste",i,this.copyableRanges)}destroy(){super.destroy()}}function Cte(e){if(NB()){const t=this.hot.getSelectedRangeActive();if(t){const{row:n,col:r}=t.highlight,i=this.hot.getCell(n,r,!0);i&&Wz(i,()=>{this.hot.rootDocument.execCommand(e)})}}else this.hot.rootDocument.execCommand(e)}function Ete(e){const{rows:t}=nte(e);let n=0;for(let r=0;r<t.length&&!(t[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function Nte(){if(this.hot.isListening()){const e=this.hot.getSelectedRangeActive();if(e){const{row:t,col:n}=e.highlight,r=this.hot.getCell(t,n,!0);r&&Bz(r)}}}function Tte(){if(this.hot.isListening()){const e=this.hot.getSelectedRangeActive();if(e){const{row:t,col:n}=e.highlight,r=this.hot.getCell(t,n,!0);null!==r&&void 0!==r&&r.hasAttribute("contenteditable")&&zz(r)}}}function Ate(e,t,n){const r=rZ(t);if(e&&e.clipboardData){const i=lV(t),o=lV(n);e.clipboardData.setData("text/plain",r),e.clipboardData.setData("text/html",[hte,i].join("")),e.clipboardData.setData(dte,[hte,o].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r)}function Rte(e){var t;e.items.push({name:"---------"},(t=this,{key:"copy",name(){return this.getTranslatedPhrase(d$)},callback(){t.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const e=this.getSelectedRangeActive();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1})),ate(fte,this)&&e.items.push(function(e){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeActive(),t=e?pV(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(h$,t)},callback(){e.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),ate(mte,this)&&e.items.push(function(e){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeActive(),t=e?pV(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(f$,t)},callback(){e.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeActive();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),ate(pte,this)&&e.items.push(function(e){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeActive(),t=e?pV(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(m$,t)},callback(){e.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),e.items.push(function(e){return{key:"cut",name(){return this.getTranslatedPhrase(p$)},callback(){e.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const e=this.getSelectedRangeActive();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this))}function kte(e,t,n,r,i){ate(wte,this)&&(i.value=!0),ste(wte,this,!1)}function Mte(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function Dte(){lte(xte,this,Tte).call(this)}function _te(){lte(xte,this,Nte).call(this)}function Ote(){lte(xte,this,Tte).call(this)}function Ite(e,t){return"border_row".concat(e,"col").concat(t)}function Pte(e){var t,n;(nL(e.start)||nL(e.left))&&(e.start=null!==(t=e.start)&&void 0!==t?t:e.left);(nL(e.end)||nL(e.right))&&(e.end=null!==(n=e.end)&&void 0!==n?n:e.right);return delete e.left,delete e.right,e}function jte(e){return nL(e.start)&&(e.left=e.start),nL(e.end)&&(e.right=e.end),e}function Fte(e,t){return{id:Ite(e,t),border:{width:1,color:"#000",cornerVisible:!1},row:e,col:t,top:{hide:!0},bottom:{hide:!0},start:{hide:!0},end:{hide:!0}}}function Hte(e,t){let n=!1;return WH(e.getSelectedRange(),r=>{r.forAll((r,i)=>{if(r<0||i<0)return;const o=e.getCellMeta(r,i).borders;if(o){if(!t)return n=!0,!1;if(!lB(o[t],"hide")||!1===o[t].hide)return n=!0,!1}})}),n}function Lte(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}const Bte=new Map([["left","start"],["right","end"]]);function zte(e){const t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let e=this.getTranslatedPhrase(I$);return Hte(this,t)&&(e=Lte(e)),e},callback(n,r){const i=Hte(this,t);e.prepareBorder(r,t,i)}}}function Wte(e){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(P$);return Hte(this,"bottom")&&(e=Lte(e)),e},callback(t,n){const r=Hte(this,"bottom");e.prepareBorder(n,"bottom",r)}}}function Vte(e){const t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let e=this.getTranslatedPhrase(j$);return Hte(this,t)&&(e=Lte(e)),e},callback(n,r){const i=Hte(this,t);e.prepareBorder(r,t,i)}}}function Ute(e){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(F$)},callback(t,n){e.prepareBorder(n,"noBorders")},disabled(){return!Hte(this)}}}function qte(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Gte(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Yte(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const Kte="customBorders",$te=["dashed","dotted","solid"];var Xte=new WeakSet;class Qte extends T5{constructor(){super(...arguments),qte(this,Xte),Gte(this,"savedBorders",[])}static get PLUGIN_KEY(){return Kte}static get PLUGIN_PRIORITY(){return 90}isEnabled(){return!!this.hot.getSettings()[Kte]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Yte(Xte,this,Zte).call(this,e)),this.addHook("init",()=>Yte(Xte,this,ene).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let n=["top","bottom","start","end"],r=null;t&&(this.checkSettingsCohesion([t]),n=Object.keys(t),r=Pte(t));const i=lJ(sJ(e),{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});WH(e,e=>{i(e).forAll((e,t)=>{WH(n,n=>{this.prepareBorderFromCustomAdded(e,t,r,function(e){var t;return null!==(t=Bte.get(e))&&void 0!==t?t:e}(n))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=lJ(sJ(e),{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),n=[];return WH(e,e=>{t(e).forAll((e,t)=>{WH(this.savedBorders,r=>{r.row===e&&r.col===t&&n.push(jte(r))})})}),n}clearBorders(e){e?this.setBorders(e):(WH(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange(),this.hot.removeCellMeta(e.row,e.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const n=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,n,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:n})}prepareBorderFromCustomAdded(e,t,n,r){const i=this.hot.countRows(),o=this.hot.countCols();if(e>=i||t>=o)return;let a=Fte(e,t);var s,l;n&&(s=a,lB(l=n,"border")&&l.border&&(s.border=l.border),lB(l,"top")&&nL(l.top)&&(l.top?(tB(l.top)||(l.top={width:1,color:"#000"}),s.top=l.top):(l.top={hide:!0},s.top=l.top)),lB(l,"bottom")&&nL(l.bottom)&&(l.bottom?(tB(l.bottom)||(l.bottom={width:1,color:"#000"}),s.bottom=l.bottom):(l.bottom={hide:!0},s.bottom=l.bottom)),lB(l,"start")&&nL(l.start)&&(l.start?(tB(l.start)||(l.start={width:1,color:"#000"}),s.start=l.start):(l.start={hide:!0},s.start=l.start)),lB(l,"end")&&nL(l.end)&&(l.end?(tB(l.end)||(l.end={width:1,color:"#000"}),s.end=l.end):(l.end={hide:!0},s.end=l.end)),a=s,WH(this.hot.selection.highlight.customSelections,e=>{if(a.id===e.settings.id)return Object.assign(e.settings,n),a.id=e.settings.id,a.top=e.settings.top,a.bottom=e.settings.bottom,a.start=e.settings.start,a.end=e.settings.end,!1})),this.hot.setCellMeta(e,t,"borders",jte(a)),this.insertBorderIntoSettings(a,r)}prepareBorderFromCustomAddedRange(e,t){const n=Math.min(e.to.row,this.hot.countRows()-1),r=Math.min(e.to.col,this.hot.countCols()-1);hV(e.from.row,n,n=>{hV(e.from.col,r,r=>{const i=Fte(n,r);let o=0;n===e.from.row&&lB(t,"top")&&(o+=1,i.top=t.top),n===e.to.row&&lB(t,"bottom")&&(o+=1,i.bottom=t.bottom),r===e.from.col&&lB(t,"start")&&(o+=1,i.start=t.start),r===e.to.col&&lB(t,"end")&&(o+=1,i.end=t.end),o>0&&(this.hot.setCellMeta(n,r,"borders",jte(i)),this.insertBorderIntoSettings(i))})})}removeAllBorders(e,t){const n=Ite(e,t);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,n,r){let i=this.hot.getCellMeta(e,t).borders;if(i=i&&void 0!==i.border?Pte(i):Fte(e,t),r){i[n]={hide:!0};if(4===this.countHide(i))this.removeAllBorders(e,t);else{this.checkCustomSelectionsFromContextMenu(i,n,r)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,t,"borders",jte(i))}}else{i[n]={width:1,color:"#000"};this.checkCustomSelectionsFromContextMenu(i,n,r)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,t,"borders",jte(i))}}prepareBorder(e,t,n){WH(e,e=>{let{start:r,end:i}=e;if(r.row===i.row&&r.col===i.col)"noBorders"===t?this.removeAllBorders(r.row,r.col):this.setBorder(r.row,r.col,t,n);else switch(t){case"noBorders":hV(r.col,i.col,e=>{hV(r.row,i.row,t=>{this.removeAllBorders(t,e)})});break;case"top":hV(r.col,i.col,e=>{this.setBorder(r.row,e,t,n)});break;case"bottom":hV(r.col,i.col,e=>{this.setBorder(i.row,e,t,n)});break;case"start":hV(r.row,i.row,e=>{this.setBorder(e,r.col,t,n)});break;case"end":hV(r.row,i.row,e=>{this.setBorder(e,i.col,t,n)})}})}createCustomBorders(e){WH(e,e=>{const t=Pte(e);e.range?this.prepareBorderFromCustomAddedRange(e.range,t):this.prepareBorderFromCustomAdded(e.row,e.col,t)})}countHide(e){const{top:t,bottom:n,start:r,end:i}=e;return LH([t,n,r,i],(e,t)=>{let n=e;return t&&t.hide&&(n+=1),n},0)}clearBordersFromSelectionSettings(e){const t=zH(this.hot.selection.highlight.customSelections,e=>e.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){WH(this.hot.selection.highlight.customSelections,(e,t)=>{if(null===e.cellRange)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){WH(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const t=zH(this.savedBorders,e=>e.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return 4===this.countHide(e)?(this.spliceBorder(e.id),t=!0):WH(this.savedBorders,(n,r)=>{if(e.id===n.id)return this.savedBorders[r]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,n){let r=!1;return WH(this.hot.selection.highlight.customSelections,i=>{if(e.id===i.settings.id){return WH(this.hot.view._wt.selectionManager.getBorderInstances(i),e=>{e.toggleHiddenClass(t,n)}),r=!0,!1}}),r}checkCustomSelections(e,t,n){const r=this.countHide(e);let i=!1;return 4===r?(this.removeAllBorders(e.row,e.col),i=!0):WH(this.hot.selection.highlight.customSelections,r=>{if(e.id===r.settings.id){if(r.visualCellRange=t,r.commit(),n){WH(this.hot.view._wt.selectionManager.getBorderInstances(r),t=>{t.changeBorderStyle(n,e)})}return i=!0,!1}}),i}changeBorderSettings(){const e=this.hot.getSettings()[Kte];if(Array.isArray(e)){const t=QL(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else void 0!==e&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=e.some(e=>nL(e.left)||nL(e.right));const n=function(e){return e.some(e=>nL(e.start)||nL(e.end))}(e);if(t&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".');Yte(Xte,this,Jte).call(this,e)}destroy(){super.destroy()}}function Jte(e){e.forEach(e=>{Object.keys(e).forEach(t=>{const n=e[t].style;nL(n)&&!$te.includes(n)?(hW('The "'.concat(n,'" border style is not supported. Please use one of the following styles: ').concat($te.join(", "),".\nThe border style will be ignored.")),delete e[t].style):nL(n)&&"solid"===n&&delete e[t].style})})}function Zte(e){var t;this.hot.getSettings()[Kte]&&e.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(_$)},disabled(){const e=this.getSelectedRangeActive();return!e||(!!e.isSingleHeader()||this.selection.isSelectedByCorner())},submenu:{items:[(t=this,{key:"borders:top",name(){let e=this.getTranslatedPhrase(O$);return Hte(this,"top")&&(e=Lte(e)),e},callback(e,n){const r=Hte(this,"top");t.prepareBorder(n,"top",r)}}),zte(this),Wte(this),Vte(this),Ute(this)]}})}function ene(){this.changeBorderSettings()}function tne(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function nne(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rne(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const ine="dragToScroll";var one=new WeakSet;class ane extends T5{constructor(){super(...arguments),tne(this,one),nne(this,"boundaries",null),nne(this,"callback",null),nne(this,"listening",!1)}static get PLUGIN_KEY(){return ine}static get PLUGIN_PRIORITY(){return 100}isEnabled(){return!!this.hot.getSettings()[ine]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>rne(one,this,sne).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>rne(one,this,sne).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let n=0,r=0;t<this.boundaries.top?r=t-this.boundaries.top:t>this.boundaries.bottom&&(r=t-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,r)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",e=>this.onMouseMove(e)),t=FB(t)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function sne(e){if(lW(e))return;const t=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(t!==this.hot.rootWindow?t.getBoundingClientRect():void 0),this.setCallback((e,n)=>{var r,i;const o=null!==(r=t.scrollLeft)&&void 0!==r?r:t.scrollX,a=null!==(i=t.scrollTop)&&void 0!==i?i:t.scrollY;t.scroll(o+50*Math.sign(e),a+20*Math.sign(n))}),this.listen()}function lne(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cne(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function une(e,t,n){return e.set(dne(e,t),n),n}function dne(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}_W.getSingleton().register("afterDropdownMenuDefaultOptions"),_W.getSingleton().register("beforeDropdownMenuShow"),_W.getSingleton().register("afterDropdownMenuShow"),_W.getSingleton().register("afterDropdownMenuHide"),_W.getSingleton().register("afterDropdownMenuExecute");const hne="dropdownMenu",fne="changeType",mne=hne;var pne=new WeakMap,gne=new WeakSet;class vne extends T5{static get PLUGIN_KEY(){return hne}static get PLUGIN_PRIORITY(){return 230}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[j9,F9,Y7,B9,Y7,P9,Y7,H9,Y7,I9]}constructor(e){super(e),function(e,t){lne(e,t),t.add(e)}(this,gne),cne(this,"commandExecutor",new O9(this.hot)),cne(this,"itemsFactory",null),cne(this,"menu",null),function(e,t,n){lne(e,t),t.set(e,n)}(this,pne,!1),this.hot.addHook("afterGetColHeader",(e,t)=>dne(gne,this,wne).call(this,e,t))}isEnabled(){return this.hot.getSettings()[hne]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new X9(this.hot,vne.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return dne(gne,e,Tne).call(e,...n)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return dne(gne,e,Nne).call(e,...n)}),this.addHook("beforeDialogShow",()=>this.close());const t=this.hot.getSettings()[hne],n={items:this.itemsFactory.getItems(t)};this.registerEvents(),"function"===typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new Aee(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootPortalElement}),this.hot.runHooks("beforeDropdownMenuSetItems",r),this.menu.setMenuItems(r),this.menu.addLocalHook("beforeOpen",()=>dne(gne,this,xne).call(this)),this.menu.addLocalHook("afterOpen",()=>dne(gne,this,Sne).call(this)),this.menu.addLocalHook("afterSubmenuOpen",e=>dne(gne,this,Cne).call(this,e)),this.menu.addLocalHook("afterClose",()=>dne(gne,this,Ene).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.executeCommand.call(e,...n)}),WH(r,e=>this.commandExecutor.registerCommand(e.key,e))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=()=>{const{highlight:e}=this.hot.getSelectedRangeActive();if((e.isHeader()&&-1===e.row||e.isCell())&&e.col>=0){this.hot.selectColumns(e.col,e.col,-1);const{from:t}=this.hot.getSelectedRangeActive(),n=J7(this.menu.container,this.hot.rootDocument),r=this.hot.getCell(-1,t.col,!0).querySelector(".".concat(fne)),i=r.getBoundingClientRect();this.open({left:i.left+n.left,top:i.top+r.offsetHeight+n.top},{left:i.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};this.hot.getShortcutManager().getContext("grid").addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:e,runOnlyIf:()=>{var e;const t=null===(e=this.hot.getSelectedRangeActive())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&t.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:mne},{keys:[["Shift","Alt","ArrowDown"]],callback:e,runOnlyIf:()=>{var e;const t=null===(e=this.hot.getSelectedRangeActive())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&t.isCell()&&!this.menu.isOpened()},group:mne}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(mne)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>dne(gne,this,bne).call(this,e))}open(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(t=this.menu)&&void 0!==t&&t.isOpened()||(this.menu.open(),rB(n,(e,t)=>{this.menu.setOffset(t,e)}),this.menu.setPosition(e))}close(){var e;null===(e=this.menu)||void 0===e||e.close()}executeCommand(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.commandExecutor.execute(e,...n)}setListening(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function yne(e){e.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function bne(e){if(YB(e.target,fne)){const t=J7(this.menu.container,this.hot.rootDocument),n=e.target.getBoundingClientRect();e.stopPropagation(),une(pne,this,!1),this.open({left:n.left+t.left,top:n.top+e.target.offsetHeight+t.top},{left:n.width,right:0,above:0,below:3})}}function wne(e,t){const n=t.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(e<0||i!==r.length-1)return;const o=t.querySelector(".".concat(fne));if(this.enabled&&o)return;if(!this.enabled)return void(o&&o.parentNode.removeChild(o));const a=this.hot.rootDocument.createElement("button");a.className=fne,a.type="button",a.tabIndex=-1,this.hot.getSettings().ariaTags&&(XB(a,[jL(),IL(" ")]),XB(t,[HL("menu")])),a.onclick=function(){return!1},t.firstChild.insertBefore(a,t.firstChild.firstChild)}function xne(){this.hot.runHooks("beforeDropdownMenuShow",this)}function Sne(){this.hot.runHooks("afterDropdownMenuShow",this),dne(gne,this,yne).call(this,this.menu)}function Cne(e){dne(gne,this,yne).call(this,e)}function Ene(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function Nne(e){return n=this,(t=pne).get(dne(t,n))?null:e;var t,n}function Tne(e){YB(e.target,fne)&&une(pne,this,!0)}function Ane(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}vne.SEPARATOR={name:Y7};const Rne=class{constructor(e){Ane(this,"hot",void 0),Ane(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:n,endCol:r}=this._getDataRange(),i=this.options,o=[];return hV(e,n,e=>{const n=[];!i.exportHiddenRows&&this._isHiddenRow(e)||(hV(t,r,t=>{!i.exportHiddenColumns&&this._isHiddenColumn(t)||n.push(this.hot.getDataAtCell(e,t))}),o.push(n))}),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:n}=this._getDataRange(),r=this.hot.getRowHeader();hV(t,n,t=>{!this.options.exportHiddenRows&&this._isHiddenRow(t)||e.push(r[t])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:n}=this._getDataRange(),r=this.hot.getColHeader();hV(t,n,t=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(t)||e.push(r[t])})}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[n=0,r=0,i=t,o=e]=this.options.range;return n=Math.max(n,0),r=Math.max(r,0),i=Math.min(i,t),o=Math.min(o,e),{startRow:n,startCol:r,endRow:i,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}};function kne(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Mne{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){kne(this,"dataProvider",void 0),kne(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=JL(this.constructor.DEFAULT_OPTIONS);const n=new Date;return t=$L(JL(Mne.DEFAULT_OPTIONS),t),t=$L(t,e),t.filename=CL(t.filename,{YYYY:n.getFullYear(),MM:"".concat(n.getMonth()+1).padStart(2,"0"),DD:"".concat(n.getDate()).padStart(2,"0")}),t}}const Dne=Mne;function _ne(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function One(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const Ine=String.fromCharCode(13),Pne=String.fromCharCode(34),jne=String.fromCharCode(10),Fne=String.fromCharCode(61),Hne=String.fromCharCode(43),Lne=String.fromCharCode(45),Bne=String.fromCharCode(64),zne=String.fromCharCode(9);var Wne=new WeakSet;function Vne(e){return e.startsWith(Fne)||e.startsWith(Hne)||e.startsWith(Lne)||e.startsWith(Bne)||e.startsWith(zne)||e.startsWith(Ine)?"'".concat(e):e}function Une(e,t){return t.test(e)?"'".concat(e):e}const qne=class extends Dne{constructor(){super(...arguments),_ne(this,Wne)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n",sanitizeValues:!1}}export(){const e=this.options,t=this.dataProvider.getData();let n=this.dataProvider.getColumnHeaders();const r=n.length>0,i=this.dataProvider.getRowHeaders(),o=i.length>0;let a=e.bom?String.fromCharCode(65279):"";return r&&(n=zH(n,t=>this._escapeCell(t,{force:!0,sanitizeValue:e.sanitizeValues})),o&&(a+=e.columnDelimiter),a+=n.join(e.columnDelimiter),a+=e.rowDelimiter),WH(t,(t,n)=>{n>0&&(a+=e.rowDelimiter),o&&(a+=this._escapeCell(i[n],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const r=t.map(t=>this._escapeCell(t,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=r}),a}_escapeCell(e){let{force:t=!1,sanitizeValue:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=tL(e);return""===r||(n&&(t=!0),n instanceof RegExp?r=One(Wne,this,Une).call(this,r,n):"function"===typeof n?r=n(r):n&&(r=One(Wne,this,Vne).call(this,r)),(t||r.indexOf(Ine)>=0||r.indexOf(Pne)>=0||r.indexOf(jne)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r='"'.concat(r,'"'))),r}},Gne="csv",Yne={[Gne]:qne};class Kne extends T5{static get PLUGIN_KEY(){return"exportFile"}static get PLUGIN_PRIORITY(){return 240}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{rootDocument:n,rootWindow:r}=this.hot,i=this._createTypeFormatter(e,t),o=this._createBlob(i),a=r.URL||r.webkitURL,s=n.createElement("a"),l="".concat(i.options.filename,".").concat(i.options.fileExtension);if(void 0!==s.download){const e=a.createObjectURL(o);s.style.display="none",s.setAttribute("href",e),s.setAttribute("download",l),n.body.appendChild(s),s.dispatchEvent(new MouseEvent("click")),n.body.removeChild(s),setTimeout(()=>{a.revokeObjectURL(e)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,l)}_createTypeFormatter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Yne[e])throw new Error('Export format type "'.concat(e,'" is not supported.'));return function(e,t,n){return"function"===typeof Yne[e]?new Yne[e](t,n):null}(e,new Rne(this.hot),t)}_createBlob(e){let t=null;return"undefined"!==typeof Blob&&(t=new Blob([e.export()],{type:"".concat(e.options.mimeType,";charset=").concat(e.options.encoding)})),t}}function $ne(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Xne{constructor(e,t){let{id:n,stateless:r=!0}=t;$ne(this,"hot",void 0),$ne(this,"id",void 0),$ne(this,"elements",[]),$ne(this,"hidden",!1),$ne(this,"stateId",""),$ne(this,"state",void 0),this.hot=e,this.id=n,this.stateId="Filters.component.".concat(this.id),this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new yK)}getElements(){return this.elements}reset(){WH(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),WH(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}ZL(Xne,oK);const Qne={};function Jne(e,t){if(!Qne[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));const{condition:n,descriptor:r}=Qne[e];let i=t;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(e){return n.apply(e.meta.instance,[].concat([e],[i]))}}function Zne(e){if(!Qne[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return Qne[e].descriptor}function ere(e,t,n){n.key=e,Qne[e]={condition:t,descriptor:n}}const tre="none";ere(tre,function(){return!0},{name:G$,inputsCount:0,showOperators:!1});const nre="empty";ere(nre,function(e){return iL(e.value)},{name:Y$,inputsCount:0,showOperators:!0});const rre="not_empty";ere(rre,function(e,t){return!Jne(nre,t)(e)},{name:K$,inputsCount:0,showOperators:!0});const ire="eq";ere(ire,function(e,t){let[n]=t;return tL(e.value).toLocaleLowerCase(e.meta.locale)===tL(n)},{name:$$,inputsCount:1,showOperators:!0});const ore="neq";ere(ore,function(e,t){return!Jne(ire,t)(e)},{name:X$,inputsCount:1,showOperators:!0});ere("gt",function(e,t){let[n]=t,r=n;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value>r},{name:nX,inputsCount:1,showOperators:!0});ere("gte",function(e,t){let[n]=t,r=n;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value>=r},{name:rX,inputsCount:1,showOperators:!0});ere("lt",function(e,t){let[n]=t,r=n;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value<r},{name:iX,inputsCount:1,showOperators:!0});ere("lte",function(e,t){let[n]=t,r=n;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value<=r},{name:oX,inputsCount:1,showOperators:!0});const are="date_after";ere(are,function(e,t){let[n]=t;const r=PH(e.value,e.meta.dateFormat),i=PH(n,e.meta.dateFormat);return!(!r.isValid()||!i.isValid())&&r.diff(i)>=0},{name:lX,inputsCount:1,showOperators:!0});const sre="date_before";ere(sre,function(e,t){let[n]=t;const r=PH(e.value,e.meta.dateFormat),i=PH(n,e.meta.dateFormat);return!(!r.isValid()||!i.isValid())&&r.diff(i)<=0},{name:cX,inputsCount:1,showOperators:!0});const lre="between";ere(lre,function(e,t){let[n,r]=t,i=n,o=r;if("numeric"===e.meta.type){const e=parseFloat(i,10),t=parseFloat(o,10);i=Math.min(e,t),o=Math.max(e,t)}else if("date"===e.meta.type){const t=Jne(sre,[o]),n=Jne(are,[i]);return t(e)&&n(e)}return e.value>=i&&e.value<=o},{name:aX,inputsCount:2,showOperators:!0});const cre="not_between";ere(cre,function(e,t){return!Jne(lre,t)(e)},{name:sX,inputsCount:2,showOperators:!0});const ure="begins_with";ere(ure,function(e,t){let[n]=t;return tL(e.value).toLocaleLowerCase(e.meta.locale).startsWith(tL(n))},{name:Q$,inputsCount:1,showOperators:!0});const dre="ends_with";ere(dre,function(e,t){let[n]=t;return tL(e.value).toLocaleLowerCase(e.meta.locale).endsWith(tL(n))},{name:J$,inputsCount:1,showOperators:!0});const hre="contains";ere(hre,function(e,t){let[n]=t;return tL(e.value).toLocaleLowerCase(e.meta.locale).indexOf(tL(n))>=0},{name:Z$,inputsCount:1,showOperators:!0});const fre="not_contains";ere(fre,function(e,t){return!Jne(hre,t)(e)},{name:eX,inputsCount:1,showOperators:!0});const mre="date_tomorrow";ere(mre,function(e){const t=PH(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(PH().subtract(-1,"days").startOf("day"),"d")},{name:dX,inputsCount:0});const pre="date_today";ere(pre,function(e){const t=PH(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(PH().startOf("day"),"d")},{name:uX,inputsCount:0});const gre="date_yesterday";ere(gre,function(e){const t=PH(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(PH().subtract(1,"days").startOf("day"),"d")},{name:hX,inputsCount:0});const vre="numeric",yre="text",bre="date",wre={[vre]:[tre,Y7,nre,rre,Y7,ire,ore,Y7,"gt","gte","lt","lte",lre,cre],[yre]:[tre,Y7,nre,rre,Y7,ire,ore,Y7,ure,dre,Y7,hre,fre],[bre]:[tre,Y7,nre,rre,Y7,ire,ore,Y7,sre,are,lre,Y7,mre,pre,gre]};function xre(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Sre="built",Cre="building",Ere=["click","input","keydown","keypress","keyup","focus","blur","change"];class Nre{static get DEFAULTS(){return JL({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){xre(this,"hot",void 0),xre(this,"eventManager",new $W(this)),xre(this,"options",void 0),xre(this,"_element",void 0),xre(this,"buildState",void 0),this.hot=e,this.options=$L(Nre.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Cre?this._element:this.buildState===Sre?(this.update(),this._element):(this.buildState=Cre,this.build(),this.buildState=Sre,this._element)}isBuilt(){return this.buildState===Sre}translateIfPossible(e){return"string"===typeof e&&e.startsWith(U$)?this.hot.getTranslatedPhrase(e):e}build(){const e=(e,t)=>{this.eventManager.addEventListener(e,t,e=>this.runLocalHooks(t,e,this))};if(this.buildState||(this.buildState=Cre),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&KB(this._element,this.options.className),this.options.children.length)WH(this.options.children,e=>this._element.appendChild(e.element));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);t.setAttribute("data-hot-input",!0),rB(this.options,(e,n)=>{void 0!==t[n]&&"className"!==n&&"tagName"!==n&&"children"!==n&&(t[n]=this.translateIfPossible(e))}),this._element.appendChild(t),WH(Ere,n=>e(t,n))}else WH(Ere,t=>e(this._element,t))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}function Tre(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Are(e,t){return e.get(Rre(e,t))}function Rre(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ZL(Nre,oK);var kre=new WeakMap,Mre=new WeakSet;class Dre extends Nre{static get DEFAULTS(){return JL({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,t){super(e,$L(Dre.DEFAULTS,t)),function(e,t){Tre(e,t),t.add(e)}(this,Mre),function(e,t,n){Tre(e,t),t.set(e,n)}(this,kre,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>Rre(Mre,this,_re).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");!function(e,t,n){e.set(Rre(e,t),n)}(kre,this,this._element.firstChild),KB(this._element,"htUIInput"),KB(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Are(kre,this).type=this.options.type,Are(kre,this).placeholder=this.translateIfPossible(this.options.placeholder),Are(kre,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Are(kre,this).focus()}}function _re(e){this.options.value=e.target.value}function Ore(e,t,n){Ire(e,t),t.set(e,n)}function Ire(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pre(e,t,n){return e.set(Fre(e,t),n),n}function jre(e,t){return e.get(Fre(e,t))}function Fre(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Hre=new WeakMap,Lre=new WeakMap,Bre=new WeakMap,zre=new WeakMap,Wre=new WeakMap,Vre=new WeakSet;class Ure extends Nre{static get DEFAULTS(){return JL({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,t){super(e,$L(Ure.DEFAULTS,t)),function(e,t){Ire(e,t),t.add(e)}(this,Vre),Ore(this,Hre,null),Ore(this,Lre,[]),Ore(this,Bre,void 0),Ore(this,zre,void 0),Ore(this,Wre,void 0),this.registerHooks()}getMenu(){return jre(Hre,this)}registerHooks(){this.addLocalHook("click",()=>Fre(Vre,this,Yre).call(this))}setItems(e){Pre(Lre,this,this.translateNames(e)),jre(Hre,this)&&jre(Hre,this).setMenuItems(jre(Lre,this))}translateNames(e){return WH(e,e=>{e.name=this.translateIfPossible(e.name)}),e}build(){super.build(),Pre(Hre,this,new Aee(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),jre(Hre,this).setMenuItems(jre(Lre,this));const e=new Nre(this.hot,{className:"htUISelectCaption"}),t=new Nre(this.hot,{className:"htUISelectDropdown"});Pre(Bre,this,e),Pre(zre,this,e.element),Pre(Wre,this,t),this.hot.getSettings().ariaTags&&(XB(t.element,[jL()]),XB(this._element,[["role","listbox"]])),WH([e,t],e=>this._element.appendChild(e.element)),jre(Hre,this).addLocalHook("select",e=>Fre(Vre,this,qre).call(this,e)),jre(Hre,this).addLocalHook("afterClose",()=>Fre(Vre,this,Gre).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;e=this.options.value?this.options.value.name:jre(Hre,this).hot.getTranslatedPhrase(G$),jre(zre,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();jre(Hre,this)&&(jre(Hre,this).open(),jre(Hre,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),jre(Hre,this).getNavigator().toFirstItem(),jre(Hre,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{this.closeOptions(),this.runLocalHooks("tabKeydown",e)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){jre(Hre,this)&&jre(Hre,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){jre(Hre,this)&&(jre(Hre,this).destroy(),Pre(Hre,this,null)),jre(Bre,this)&&jre(Bre,this).destroy(),jre(Wre,this)&&jre(Wre,this).destroy(),super.destroy()}}function qre(e){e.name!==Y7&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}function Gre(){this.runLocalHooks("afterClose")}function Yre(){this.openOptions()}function Kre(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function $re(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xre(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Qre=new WeakSet;class Jre extends Xne{constructor(e,t){super(e,{id:t.id,stateless:!1}),Kre(this,Qre),$re(this,"name",""),$re(this,"addSeparator",!1),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new Ure(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new Dre(this.hot,{placeholder:CX})),this.elements.push(new Dre(this.hot,{placeholder:EX})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>Xre(Qre,this,Zre).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),WH(this.getInputElements(),e=>{e.addLocalHook("keydown",e=>Xre(Qre,this,eie).call(this,e))})}setState(e){if(this.reset(),!e)return;const t=JL(e.command);t.name.startsWith(q$)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),WH(e.args,(e,n)=>{if(n>t.inputsCount-1)return!1;const r=this.getInputElement(n);r.setValue(e),r[t.inputsCount>n?"show":"hide"](),n||this.hot._registerTimeout(()=>r.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Zne(tre),t=[];return WH(this.getInputElements(),(n,r)=>{e.inputsCount>r&&t.push(n.getValue())}),{command:e,args:t}}updateState(e,t){const n=Zne(e?e.name:tre);this.state.setValueAtIndex(t,{command:n,args:e?e.args:[]}),e||WH(this.getInputElements(),e=>e.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Ure)[0]}getInputElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Dre)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,n,r,i,o)=>{KB(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&KB(t.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return KB(a,"htFiltersMenuLabel"),a.textContent=o,t.appendChild(a),t.parentElement.hasAttribute("ghost-table")||WH(this.elements,e=>t.appendChild(e.element)),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[Zne(tre)];if(null!==e){const{visualIndex:n}=e;t=function(e){const t=[];let n=e;return wre[n]||(n=yre),WH(wre[n],e=>{let n;n=e===Y7?{name:Y7}:JL(Zne(e)),t.push(n)}),t}(this.hot.getDataType(0,n,this.hot.countRows(),n))}WH(this.getInputElements(),e=>e.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}}function Zre(e){WH(this.getInputElements(),(t,n)=>{t[e.inputsCount>n?"show":"hide"](),0===n&&this.hot._registerTimeout(()=>t.focus(),10)}),this.runLocalHooks("change",e)}function eie(e){oW(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),aW(e))}const tie={};function nie(e,t,n){tie[e]={name:t,func:n}}const rie="conjunction";nie(rie,pX,function(e,t){return e.every(e=>e.func(t))});const iie="disjunction";nie(iie,gX,function(e,t){return e.some(e=>e.func(t))});const oie="disjunctionWithExtraCondition";function aie(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function sie(e,t){return e.get(cie(e,t))}function lie(e,t,n){return e.set(cie(e,t),n),n}function cie(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}nie(oie,gX,function(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(e=>e.func(t))&&e[e.length-1].func(t)});var uie,die=new WeakMap,hie=new WeakMap;class fie extends Nre{static get DEFAULTS(){return JL({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,$L(fie.DEFAULTS,t)),aie(this,die,void 0),aie(this,hie,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),lie(hie,this,e),lie(die,this,this._element.firstChild),sie(die,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(sie(hie,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return!!this.isBuilt()&&sie(die,this).checked}setChecked(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isBuilt()&&(sie(die,this).checked=e)}focus(){this.isBuilt()&&sie(die,this).focus()}}function mie(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function pie(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var gie=new WeakSet;class vie extends Xne{constructor(e,t){super(e,{id:t.id,stateless:!1}),mie(this,gie),pie(this,"name",""),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(KB(t.parentNode,"htFiltersMenuOperators"),WH(this.elements,e=>t.appendChild(e.element)),t)}}buildOperatorsElement(){const e=[rie,iie];WH(e,t=>{const n=new fie(this.hot,{name:"operator",label:{htmlFor:t,textContent:(r=t,tie[r].name)},value:t,checked:t===e[0],id:t});var r;n.addLocalHook("change",e=>function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(gie,this,yie).call(this,e)),this.elements.push(n)})}setChecked(e){if(this.elements.length<e)throw Error(ZH(uie||(uie=RH(["Radio button with index "," doesn't exist."])),e));WH(this.elements,(t,n)=>{t.setChecked(n===e)})}getActiveOperationId(){const e=this.elements.find(e=>e instanceof fie&&e.isChecked());return e?e.getValue():rie}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&WH(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let e=arguments.length>1?arguments[1]:void 0,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rie;t===oie&&(t=iie),this.state.setValueAtIndex(e,t)}reset(){this.setChecked(0)}}function yie(e){this.setState(e.target.value)}pB();function bie(e,t){let n=e;return""===n&&(n="(".concat(t,")")),n}function wie(e){const t=new Set(e);return function(e){return t.has(e)}}function xie(e){return null===e||void 0===e?"":e}function Sie(e){return Array.from(new Set(e)).map(e=>xie(e)).sort((e,t)=>"number"===typeof e&&"number"===typeof t?e-t:e===t?0:e>t?1:-1)}function Cie(e,t,n,r){const i=[],o=e===t;let a;return o||(a=wie(t)),e.forEach(e=>{let t=!1;(o||a(e))&&(t=!0);const s={checked:t,value:e,visualValue:bie(e,n)};r&&r(s),i.push(s)}),i}function Eie(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function Nie(e,t){return e.get(Tie(e,t))}function Tie(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Aie=new WeakMap;class Rie extends Nre{static get DEFAULTS(){return JL({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,t){super(e,$L(Rie.DEFAULTS,t)),Eie(this,Aie,void 0)}build(){super.build(),function(e,t,n){e.set(Tie(e,t),n)}(Aie,this,this._element.firstChild)}update(){this.isBuilt()&&(Nie(Aie,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Nie(Aie,this).focus()}activate(){Nie(Aie,this).click()}}function kie(e,t,n){Mie(e,t),t.set(e,n)}function Mie(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Die(e,t){return e.get(Oie(e,t))}function _ie(e,t,n){return e.set(Oie(e,t),n),n}function Oie(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const Iie="multipleSelect.itemBox";var Pie=new WeakMap,jie=new WeakMap,Fie=new WeakMap,Hie=new WeakMap,Lie=new WeakMap,Bie=new WeakMap,zie=new WeakSet;class Wie extends Nre{static get DEFAULTS(){return JL({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,$L(Wie.DEFAULTS,t)),function(e,t){Mie(e,t),t.add(e)}(this,zie),kie(this,Pie,[]),kie(this,jie,void 0),kie(this,Fie,void 0),kie(this,Hie,void 0),kie(this,Lie,void 0),kie(this,Bie,void 0),_ie(Hie,this,new Dre(this.hot,{placeholder:SX,className:"htUIMultipleSelectSearch"})),_ie(Lie,this,new Rie(this.hot,{textContent:yX,className:"htUISelectAll"})),_ie(Bie,this,new Rie(this.hot,{textContent:bX,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Die(jie,this)}registerHooks(){Die(Hie,this).addLocalHook("keydown",e=>Oie(zie,this,Uie).call(this,e)),Die(Hie,this).addLocalHook("input",e=>Oie(zie,this,Vie).call(this,e)),Die(Lie,this).addLocalHook("click",e=>Oie(zie,this,qie).call(this,e)),Die(Bie,this).addLocalHook("click",e=>Oie(zie,this,Gie).call(this,e))}setItems(e){var t;_ie(Pie,this,e),null===(t=Die(jie,this))||void 0===t||t.loadData(Die(Pie,this))}setLocale(e){_ie(Fie,this,e)}getLocale(){return Die(Fie,this)}getItems(){return[...Die(Pie,this)]}getValue(){return function(e){const t=[];return e.forEach(e=>{e.checked&&t.push(e.value)}),t}(Die(Pie,this))}getSearchInputElement(){return Die(Hie,this)}getSelectAllElement(){return Die(Lie,this)}getClearAllElement(){return Die(Bie,this)}isSelectedAllValues(){return Die(Pie,this).length===this.getValue().length}build(){var e;super.build();const{rootDocument:t}=this.hot,n=t.createElement("div"),r=new Nre(this.hot,{className:"htUISelectionControls",children:[Die(Lie,this),Die(Bie,this)]});this._element.appendChild(Die(Hie,this).element),this._element.appendChild(r.element),this._element.appendChild(n),null===(e=Die(jie,this))||void 0===e||e.destroy(),KB(n,"htUIMultipleSelectHot"),_ie(jie,this,new this.hot.constructor(n,{data:[[]],columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(e,t,n,r,i,o)=>{e.title=o.instance.getDataAtRowProp(t,o.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Die(jie,this).listen()},modifyColWidth:e=>{const n=Die(jie,this).container.scrollWidth-kz(t);return void 0!==e&&e<n?n:e},autoColumnSize:!0,autoRowSize:!1,hiddenRows:!0,maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Die(jie,this).init();const i=Die(jie,this).getShortcutManager().getContext("grid");i.removeShortcutsByKeys(["Tab"]),i.removeShortcutsByKeys(["Shift","Tab"]),i.addShortcut({keys:[["Escape"]],callback:e=>{this.runLocalHooks("keydown",e,this)},group:Iie}),i.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:e=>{Die(jie,this).deselectCell(),this.runLocalHooks("keydown",e,this),this.runLocalHooks("listTabKeydown",e,this)},group:Iie})}focus(){this.isBuilt()&&Die(jie,this).listen()}reset(){Die(Hie,this).reset(),Die(Lie,this).reset(),Die(Bie,this).reset()}update(){this.isBuilt()&&0!==Die(jie,this).rootElement.offsetHeight&&(Die(jie,this).updateSettings({data:Yie(Die(Pie,this),this.options.value)}),super.update())}destroy(){var e;null===(e=Die(jie,this))||void 0===e||e.destroy(),Die(Hie,this).destroy(),Die(Bie,this).destroy(),Die(Lie,this).destroy(),_ie(Hie,this,null),_ie(Bie,this,null),_ie(Lie,this,null),_ie(jie,this,null),_ie(Pie,this,null),super.destroy()}}function Vie(e){const t=e.target.value.toLocaleLowerCase(this.getLocale());if("apply"===this.options.searchMode){const e=Die(jie,this).getPlugin("hiddenRows");e.showRows(e.getHiddenRows()),Die(Pie,this).forEach((n,r)=>{n.checked="".concat(n.value).toLocaleLowerCase(this.getLocale()).indexOf(t)>=0,n.checked||e.hideRow(r)}),Die(jie,this).view.adjustElementsSize(),Die(jie,this).render()}else{let e;e=""===t?[...Die(Pie,this)]:Die(Pie,this).filter(e=>"".concat(e.value).toLocaleLowerCase(this.getLocale()).indexOf(t)>=0),Die(jie,this).loadData(e)}}function Uie(e){this.runLocalHooks("keydown",e,this);$z(oW,e.keyCode)("ARROW_DOWN")&&(e.preventDefault(),aW(e),Die(jie,this).listen(),Die(jie,this).selectCell(0,0))}function qie(e){const t=[];e.preventDefault(),Die(jie,this).getSourceData().forEach((e,n)=>{e.checked=!0,t.push(JY(e,n)[0])}),Die(jie,this).setSourceDataAtCell(t)}function Gie(e){const t=[];e.preventDefault(),Die(jie,this).getSourceData().forEach((e,n)=>{e.checked=!1,t.push(JY(e,n)[0])}),Die(jie,this).setSourceDataAtCell(t)}function Yie(e,t){const n=wie(t);return e.map(e=>(e.checked=n(e.value),e))}const Kie="by_value";function $ie(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Xie(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qie(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ere(Kie,function(e,t){let[n]=t;return n(e.value)},{name:"By value",inputsCount:0,inputValuesDecorator(e){let[t]=e;return[wie(t)]},showOperators:!1});var Jie,Zie=new WeakSet;class eoe extends Xne{constructor(e,t){super(e,{id:t.id,stateless:!1}),$ie(this,Zie),Xie(this,"name",""),Xie(this,"searchMode",void 0),this.name=t.name,this.searchMode=t.searchMode,this.elements.push(new Wie(this.hot,{searchMode:this.searchMode})),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Qie(Zie,this,toe).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,t)=>Qie(Zie,this,roe).call(this,e,t))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Kie){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?tre:Kie},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(t,n,r,i,o)=>{const[a]=BH(n,e=>e.name===Kie),s={},l=this.hot.getTranslatedPhrase(vX);if(a){const n=i(t,o),c=zH(n,e=>e.value),u=new Map(n.map(e=>[e.value,this.hot.getCellMeta(e.meta.visualRow,e.meta.visualCol)])),d=Sie(c);r&&(a.args[0]=r);const h=[],f=Cie(d,a.args[0],l,e=>{e.checked&&h.push(e.value),Qie(Zie,this,noe).call(this,e,u)}),m=e.editedConditionStack.column;s.locale=this.hot.getCellMeta(0,m).locale,s.args=[h],s.command=Zne(Kie),s.itemsSnapshot=f}else s.args=[],s.command=Zne(tre);this.state.setValueAtIndex(t,s)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Wie)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,n,r,i,o)=>{KB(t.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return KB(a,"htFiltersMenuLabel"),a.textContent=o,t.appendChild(a),t.parentElement.hasAttribute("ghost-table")||WH(this.elements,e=>t.appendChild(e.element)),t}}}reset(){const e=this.hot.getTranslatedPhrase(vX),t=this._getColumnVisibleValues(),n=t.map(e=>e.value),r=new Map(t.map(e=>[e.value,e.meta])),i=Sie(n),o=Cie(i,i,e,e=>{Qie(Zie,this,noe).call(this,e,r)});this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(i);const a=this.hot.getPlugin("filters").getSelectedColumn();null!==a&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return null===e?[]:zH(this.hot.getDataAtCol(e.visualIndex),(t,n)=>({value:xie(t),meta:this.hot.getCellMeta(n,e.visualIndex)}))}}function toe(e){oW(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),aW(e)),oW(e.keyCode,"ENTER")&&("apply"===this.searchMode&&this.runLocalHooks("accept"),aW(e))}function noe(e,t){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(e.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",e.visualValue,t.get(e.value)))}function roe(e,t){return"numeric"===t.type?W4(e,t):e}function ioe(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function ooe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var aoe,soe,loe=new WeakSet;class coe extends Xne{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),ioe(this,loe),ooe(this,"name",""),this.name=t.name,this.elements.push(new Dre(this.hot,{type:"button",value:wX,className:"htUIButton htUIButtonOK",identifier:coe.BUTTON_OK})),this.elements.push(new Dre(this.hot,{type:"button",value:xX,className:"htUIButton htUIButtonCancel",identifier:coe.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){WH(this.elements,e=>{e.addLocalHook("click",(e,t)=>function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(loe,this,uoe).call(this,e,t))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(KB(t.parentNode,"htFiltersMenuActionBar"),WH(this.elements,e=>t.appendChild(e.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function uoe(e,t){t.options.identifier===Jie.BUTTON_OK?this.accept():this.cancel()}function doe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Jie=coe;const hoe="ConditionCollection.filteringStates";class foe{constructor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];doe(this,"hot",void 0),doe(this,"isMapRegistrable",void 0),doe(this,"filteringStates",new yK),this.hot=e,this.isMapRegistrable=t,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(hoe,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(e,t){var n;const r=this.filteringStates.getValueAtIndex(t),i=null!==(n=null===r||void 0===r?void 0:r.conditions)&&void 0!==n?n:[],o=null===r||void 0===r?void 0:r.operation;return this.isMatchInConditions(i,e,o)}isMatchInConditions(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rie;return!e.length||function(e){if(!tie[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));const t=tie[e].func;return function(e,n){return t(e,n)}}(n)(e,t)}addCondition(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rie,r=arguments.length>3?arguments[3]:void 0;const i=this.hot.getCellMeta(0,e).locale,o=t.args.map(e=>"string"===typeof e?e.toLocaleLowerCase(i):e),a=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);const s=this.getOperation(e);if(s){if(s!==n)throw Error(ZH(aoe||(aoe=RH(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),e,s))}else if(rL(tie[n]))throw new Error(ZH(soe||(soe=RH(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),n));const l=this.getConditions(e);0===l.length?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:a,args:o,func:Jne(a,o)}]},r):l.push({name:a,args:o,func:Jne(a,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,n;return null!==(t=null===(n=this.filteringStates.getValueAtIndex(e))||void 0===n?void 0:n.conditions)&&void 0!==t?t:[]}getOperation(e){var t;return null===(t=this.filteringStates.getValueAtIndex(e))||void 0===t?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,t)=>{let[n,{operation:r,conditions:i}]=t;return e.push({column:n,operation:r,conditions:i.map(e=>{let{name:t,args:n}=e;return{name:t,args:[...n]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(e=>{e.conditions.forEach(t=>this.addCondition(e.column,t))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const n=this.getConditions(e);return t?n.some(e=>e.name===t):n.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(hoe),this.filteringStates=null,this.clearLocalHooks()}}ZL(foe,oK);const moe=foe;function poe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const goe=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];poe(this,"conditionCollection",void 0),poe(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return WH(this.conditionCollection.getFilteredColumns(),(t,n)=>{let r=this.columnDataFactory(t);n&&(r=this._getIntersectData(r,e)),e=this.filterByColumn(t,r)}),e}filterByColumn(e){const t=[];return WH(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=>{void 0!==n&&this.conditionCollection.isMatch(n,e)&&t.push(n)}),t}_getIntersectData(e,t){const n=[];return WH(t,t=>{const r=t.meta.visualRow;void 0!==e[r]&&(n[r]=e[r])}),n}};function voe(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function yoe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function boe(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var woe=new WeakSet;class xoe{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];voe(this,woe),yoe(this,"hot",void 0),yoe(this,"conditionCollection",void 0),yoe(this,"columnDataFactory",void 0),yoe(this,"changes",[]),yoe(this,"grouping",!1),yoe(this,"latestEditedColumnPosition",-1),yoe(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=t,this.columnDataFactory=n,this.conditionCollection.addLocalHook("beforeRemove",e=>boe(woe,this,Soe).call(this,e)),this.conditionCollection.addLocalHook("afterRemove",e=>this.updateStatesAtColumn(e)),this.conditionCollection.addLocalHook("afterAdd",e=>this.updateStatesAtColumn(e)),this.conditionCollection.addLocalHook("beforeClean",()=>boe(woe,this,Coe).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>boe(woe,this,Eoe).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,WH(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,t){var n=this;if(this.grouping)return void(-1===this.changes.indexOf(e)&&this.changes.push(e));const r=this.conditionCollection.exportAllConditions();let i=this.conditionCollection.getColumnStackPosition(e);-1===i&&(i=this.latestEditedColumnPosition);const o=r.slice(0,i),a=r.slice(i);a.length&&a[0].column===e&&a.shift();const s=Xz(function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i=new moe(n.hot,!1),o=[].concat(e,r);i.importAllConditions(o);const a=n.columnDataFactory(t);let s;s=i.isEmpty()?a:new goe(i,e=>n.columnDataFactory(e)).filter(),s=zH(s,e=>e.meta.visualRow);const l=wie(s);return i.destroy(),BH(a,e=>l(e.meta.visualRow))})(o),l=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:l},dependentConditionStacks:a,filteredRowsFactory:s,conditionArgsChange:t})}destroy(){this.clearLocalHooks(),rB(this,(e,t)=>{this[t]=null})}}function Soe(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}function Coe(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Eoe(){WH(this.latestOrderStack,e=>{this.updateStatesAtColumn(e)})}ZL(xoe,oK);const Noe=xoe;const Toe="filters";function Aoe(e,t){let n,r=-1;const i=(o=t,cee({initialPage:0,size:()=>o.length,onItemSelect:(e,t)=>{const n=o[e];return n instanceof Wie?t:!(n.element&&!rz(n.element))&&void n.focus()}}));var o;const a=e=>()=>{n.isOpened()&&n.getKeyboardShortcutsCtrl().listen(Toe),i.setCurrentPage(t.indexOf(e))};function s(e){const o=n.getKeyboardShortcutsCtrl(),a=e.getKeyboardShortcutsCtrl();i.clear(),a.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:o.getContext(Toe),callback:()=>{e.isSubMenu()&&e.close(),o.listen(Toe)}}]),e.isSubMenu()||o.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{const t=n.getNavigator();t.getCurrentPage()>-1&&(r=t.getCurrentPage()),t.clear(),e.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{n.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:e=>{const n=t[i.getCurrentPage()];n instanceof Ure&&(n.openOptions(),e.preventDefault()),n instanceof Rie&&(n.activate(),e.preventDefault()),n instanceof Nre||e.preventDefault()}}],Toe)}function l(e){e.addLocalHook("afterSelectionChange",e=>{e.key.startsWith("filter_")||i.clear()}),e.addLocalHook("afterSubmenuOpen",s),e.addLocalHook("afterOpen",s),n=e}return t.forEach(e=>{e instanceof Nre&&(e.addLocalHook("click",a(e)),e.addLocalHook("focus",a(e)),e.addLocalHook("afterClose",a(e)))}),l(e),E(E({},i),{},{listen:function(){n.focus(),n.getKeyboardShortcutsCtrl().listen(Toe)},setMenu:l,getMenu:function(){return n},getLastMenuPage:function(){return r}})}var Roe;function koe(e,t,n){Moe(e,t),t.set(e,n)}function Moe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Doe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _oe(e,t,n){return e.set(Ioe(e,t),n),n}function Ooe(e,t){return e.get(Ioe(e,t))}function Ioe(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const Poe="filters",joe=Poe;var Foe=new WeakMap,Hoe=new WeakMap,Loe=new WeakMap,Boe=new WeakSet;class zoe extends T5{static get PLUGIN_KEY(){return Poe}static get PLUGIN_PRIORITY(){return 250}static get DEFAULT_SETTINGS(){return{searchMode:"show"}}static get SETTINGS_VALIDATORS(){return{searchMode:e=>"string"===typeof e&&["show","apply"].includes(e)}}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var t;super(e),t=this,function(e,t){Moe(e,t),t.add(e)}(this,Boe),Doe(this,"dropdownMenuPlugin",null),Doe(this,"conditionCollection",null),Doe(this,"conditionUpdateObserver",null),Doe(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Doe(this,"filtersRowsMap",null),koe(this,Foe,void 0),koe(this,Hoe,new WeakSet),koe(this,Loe,[]),this.hot.addHook("afterGetColHeader",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Ioe(Boe,t,Xoe).call(t,...n)})}isEnabled(){return!!this.hot.getSettings()[Poe]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new bK),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const t=this.hot.getSettings().dropdownMenu,n=t&&t.uiContainer||this.hot.rootPortalElement,r=e=>(e.addLocalHook("accept",()=>Ioe(Boe,this,Yoe).call(this,"accept")),e.addLocalHook("cancel",()=>Ioe(Boe,this,Yoe).call(this,"cancel")),e.addLocalHook("change",t=>Ioe(Boe,this,Koe).call(this,e,t)),e),i=()=>"".concat(this.hot.getTranslatedPhrase(fX),":"),o=()=>"".concat(this.hot.getTranslatedPhrase(mX),":");if(!this.components.get("filter_by_condition")){const e=new Jre(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:n});e.addLocalHook("afterClose",()=>Ioe(Boe,this,$oe).call(this)),this.components.set("filter_by_condition",r(e))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new vie(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const e=new Jre(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});e.addLocalHook("afterClose",()=>Ioe(Boe,this,$oe).call(this)),this.components.set("filter_by_condition2",r(e))}if(!this.components.get("filter_by_value")){const e=this.getSetting("searchMode");this.components.set("filter_by_value",r(new eoe(this.hot,{id:"filter_by_value",name:o,searchMode:e})))}if(this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new coe(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new moe(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new Noe(this.hot,this.conditionCollection,e=>this.getDataMapAtColumn(e)),this.conditionUpdateObserver.addLocalHook("update",e=>Ioe(Boe,this,Qoe).call(this,e))),this.components.forEach(e=>e.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Ioe(Boe,e,Goe).call(e,...n)}),this.addHook("beforeDropdownMenuShow",()=>Ioe(Boe,this,qoe).call(this)),this.addHook("afterDropdownMenuShow",()=>Ioe(Boe,this,Voe).call(this)),this.addHook("afterDropdownMenuHide",()=>Ioe(Boe,this,Uoe).call(this)),this.addHook("afterChange",e=>Ioe(Boe,this,Woe).call(this,e)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Ooe(Foe,this)&&this.dropdownMenuPlugin.enabled){const e=[{focus:()=>{const e=Ooe(Foe,this).getMenu(),t=e.getNavigator(),n=Ooe(Foe,this).getLastMenuPage();e.focus(),n>0?t.setCurrentPage(n):t.toFirstItem()}},...Array.from(this.components).map(e=>{let[,t]=e;return t.getElements()}).flat()];_oe(Foe,this,Aoe(this.dropdownMenuPlugin.menu,e));const t=e=>{Ooe(Foe,this).listen(),e.preventDefault(),oW(e.keyCode,"TAB")&&(e.shiftKey?Ooe(Foe,this).toPreviousItem():Ooe(Foe,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",t),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",t)}this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){var e;this.enabled&&(null!==(e=this.dropdownMenuPlugin)&&void 0!==e&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((e,t)=>{e.destroy(),this.components.set(t,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName));this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:joe})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(joe)}addCondition(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:rie;const i=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(i,{command:{key:t},args:n},r)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(void 0===e)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),t=this._createDataFilter(),n=!this.conditionCollection.isEmpty();let r=[];const i=this.exportConditions(),o=this.hot.runHooks("beforeFilter",i,Ooe(Loe,this));if(!1!==o&&n){const n=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),r=zH(t.filter(),e=>e.meta.visualRow);const e=wie(r);hV(this.hot.countSourceRows()-1,t=>{e(t)||n.push(t)}),WH(n,e=>{this.filtersRowsMap.setValueAtIndex(e,!0)})},!0),e||r.length||this.hot.deselectCell(),_oe(Loe,this,this.exportConditions())}else!1===o||n?this.importConditions(Ooe(Loe,this)):(_oe(Loe,this,this.exportConditions()),this.filtersRowsMap.clear());this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeActive().highlight.col),!1!==o&&(this.hot.runHooks("afterFilter",i),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const t=null===(e=this.hot.getSelectedRangeActive())||void 0===e?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),n=[];return WH(this.hot.getSourceDataAtCol(t),(e,r)=>{var i;const{row:o,col:a,visualCol:s,visualRow:l,type:c,instance:u,dateFormat:d,locale:h}=this.hot.getCellMeta(r,t),f=null!==(i=this.hot.getDataAtCell(this.hot.toVisualRow(r),t))&&void 0!==i?i:e;n.push({meta:{row:o,col:a,visualCol:s,visualRow:l,type:c,instance:u,dateFormat:d,locale:h},value:xie(f)})}),n}updateValueComponentCondition(e){const t=Sie(this.hot.getDataAtCol(e));this.conditionUpdateObserver.updateStatesAtColumn(e,t)}restoreComponents(e){var t;const n=null===(t=this.getSelectedColumn())||void 0===t?void 0:t.physicalIndex;e.forEach(e=>{e.isHidden()||e.restoreState(n)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,t,n,r){let i=e;return i===iie&&t.command.key!==tre&&n.command.key!==tre&&r.command.key!==tre?i=oie:r.command.key!==tre&&(t.command.key!==tre&&n.command.key!==tre||(i=rie)),i}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),n=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...n):this.hideComponents(...n)}_createDataFilter(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new goe(e,e=>this.getDataMapAtColumn(e))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return WH(r,n=>{WH(t.menuItems,(t,r)=>{t.key===n.getMenuItemDescriptor().key&&e.push(r)})}),e}changeComponentsVisibility(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.dropdownMenuPlugin)return;const t=this.dropdownMenuPlugin.menu.hotMenu,n=t.getPlugin("hiddenRows");for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];const a=this.getIndexesOfComponents(...i);e?n.showRows(a):n.hideRows(a),t.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{null!==e&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Woe(e){e&&WH(e,e=>{const[,t]=e,n=this.hot.propToCol(t);this.conditionCollection.hasConditions(n)&&this.updateValueComponentCondition(n)})}function Voe(){const e=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),e.updateMenuDimensions()}function Uoe(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function qoe(){const e=this.dropdownMenuPlugin.menu;Ooe(Hoe,this).has(e)||Ooe(Foe,this).setMenu(e),Ooe(Hoe,this).add(e)}function Goe(e){e.items.push({name:Y7}),this.components.forEach(t=>{e.items.push(t.getMenuItemDescriptor())})}function Yoe(e){var t;if("accept"===e){const e=this.getSelectedColumn();var n;if(null===e)return void(null===(n=this.dropdownMenuPlugin)||void 0===n||n.close());const{physicalIndex:t}=e,r=this.components.get("filter_by_condition").getState(),i=this.components.get("filter_by_condition2").getState(),o=this.components.get("filter_by_value").getState(),a=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),r,i,o);this.conditionUpdateObserver.groupChanges();let s=this.conditionCollection.getColumnStackPosition(t);-1===s&&(s=void 0),this.conditionCollection.removeConditions(t),r.command.key!==tre&&(this.conditionCollection.addCondition(t,r,a,s),i.command.key!==tre&&this.conditionCollection.addCondition(t,i,a,s)),o.command.key!==tre&&this.conditionCollection.addCondition(t,o,a,s),this.conditionUpdateObserver.flush(),this.components.forEach(e=>e.saveState(t)),this.filter()}null===(t=this.dropdownMenuPlugin)||void 0===t||t.close()}function Koe(e,t){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),e.constructor!==Jre||t.inputsCount||this.setListeningDropdownMenu(),n.updateMenuDimensions()}function $oe(){this.setListeningDropdownMenu()}function Xoe(e,t,n){const r=this.hot.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?KB(t,"htFiltersActive"):$B(t,"htFiltersActive")}function Qoe(e){var t;if(null===(t=this.dropdownMenuPlugin)||void 0===t||!t.enabled)return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=e;Array.isArray(i)&&_oe(Loe,this,Ooe(Loe,this).map(e=>(e.column===r&&n.length>0&&e.conditions.forEach(e=>{"by_value"===e.name&&(e.args=[[...i]])}),e)));const o=n.filter(e=>e.name===Kie),a=n.filter(e=>e.name!==Kie);if(o.length>=2||a.length>=3)hW(ZH(Roe||(Roe=RH(["The filter conditions have been applied properly, but couldn\u2019t be displayed visually. \n        The overall amount of conditions exceed the capability of the dropdown menu. \n        For more details see the documentation."],["The filter conditions have been applied properly, but couldn\u2019t be displayed visually.\\x20\n        The overall amount of conditions exceed the capability of the dropdown menu.\\x20\n        For more details see the documentation."]))));else{const t=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(a[0],r),this.components.get("filter_by_condition2").updateState(a[1],r),this.components.get("filter_operators").updateState(t,r),this.components.get("filter_by_value").updateState(e)}}const Joe="internal-use-in-handsontable",Zoe={licenseKey:Joe,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function eae(e){var t;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:null===(t=e[qae])||void 0===t||null===(t=t.language)||void 0===t?void 0:t.langCode}}function tae(e){return Object.keys(e).reduce((t,n)=>("hyperformula"!==n&&(t[n]=e[n]),t),{})}var nae;function rae(){const e="engine_relationship",t=PW(qae);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function iae(){const e="shared_engine_usage",t=PW(qae);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function oae(e){const t=e.getSettings(),n=t[qae],r=null===n||void 0===n?void 0:n.engine;if(!0===n)return null;if(rL(r))return null;var i;if("function"===typeof r.hyperformula||"function"===typeof r)return function(e,t,n){const r=t[qae],i=function(e){var t;const n=e[qae],r=tae(null!==n&&void 0!==n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),i=eae(e);return E(E(E({},Zoe),r),i)}(t),o=rae(),a=iae();(function(e,t){t&&t.forEach(t=>{const{name:n,plugin:r,translations:i}=t;try{e.registerFunction(n,r,i)}catch(qb){hW(qb.message)}})})(e,r.functions),function(e,t){if(t){const{langCode:n}=t;try{e.registerLanguage(n,t)}catch(qb){hW(qb.message)}}}(e,r.language);const s=e.buildEmpty(i);return o.set(s,[n]),a.set(s,[n.guid]),function(e,t){t&&(e.suspendEvaluation(),t.forEach(t=>{const{name:n,expression:r,scope:i,options:o}=t;try{e.addNamedExpression(n,r,i,o)}catch(qb){hW(qb.message)}}),e.resumeEvaluation())}(s,r.namedExpressions),s.on("sheetAdded",()=>{s.rebuildAndRecalculate()}),s.on("sheetRemoved",()=>{s.rebuildAndRecalculate()}),s}(null!==(i=r.hyperformula)&&void 0!==i?i:r,t,e);if("object"===typeof r&&rL(r.hyperformula)){const t=rae(),n=iae().get(r);return t.has(r)||t.set(r,[]),t.get(r).push(e),n&&n.push(e.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:Joe}),r.getConfig().leapYear1900===Zoe.leapYear1900&&!1!==eB(r.getConfig().nullDate,Zoe.nullDate)||hW(ZH(nae||(nae=RH(["If you use HyperFormula with Handsontable, keep the default `leapYear1900` and `nullDate` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."],["If you use HyperFormula with Handsontable, keep the default \\`leapYear1900\\` and \\`nullDate\\` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."])))),r}return null}function aae(e){var t;const n=rae(),r=0===n.size?[]:Array.from(null!==(t=n.get(e))&&void 0!==t?t:[]);return new Map(r.map(e=>[e.getPlugin("formulas").sheetId,e]))}function sae(e,t){if(e){const n=rae(),r=n.get(e),i=iae(),o=i.get(e);r&&r.includes(t)&&(r.splice(r.indexOf(t),1),0===r.length&&n.delete(e)),o&&o.includes(t.guid)&&(o.splice(o.indexOf(t.guid),1),0===o.length&&(i.delete(e),e.destroy()))}}const lae="DD/MM/YYYY";function cae(e,t){return"string"===typeof e&&"date"===t}function uae(e,t){return PH(e,t,!0).isValid()}function dae(e,t){return PH(e,t,!0).format(lae)}function hae(e,t){return PH(e,lae,!0).format(t)}function fae(e,t){const n=new Date(Date.UTC(0,0,e+-1));return PH(n).format(t)}function mae(e,t,n){const r=function(e,t){const n=[];return e.forEach(e=>{const r={from:e,to:t};n.forEach(e=>{const t=e.from>e.to,n=e.to<=r.from;e.from>r.from&&n&&t&&(r.from+=1)}),r.from>=t&&(t+=1),n.push(r)}),n}(e,function(e,t,n){const r=Array.from(Array(n).keys()).filter(t=>!1===e.includes(t));var i;return 0===t?null!==(i=r[t])&&void 0!==i?i:0:r[t-1]+1}(e,t,n));return function(e){return e.forEach((t,n)=>{e.slice(n+1).forEach(e=>{const n=e.from<e.to;e.from>t.from&&n&&(e.from-=1)})}),e}(r)}function pae(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function gae(e,t){return e.get(yae(e,t))}function vae(e,t,n){return e.set(yae(e,t),n),n}function yae(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var bae=new WeakMap,wae=new WeakMap,xae=new WeakMap,Sae=new WeakMap,Cae=new WeakMap,Eae=new WeakMap,Nae=new WeakMap;const Tae=class{constructor(e,t,n){pae(this,bae,void 0),pae(this,wae,void 0),pae(this,xae,void 0),pae(this,Sae,[]),pae(this,Cae,[]),pae(this,Eae,void 0),pae(this,Nae,[]),vae(bae,this,e),vae(wae,this,t),vae(xae,this,n)}setRemovedHfIndexes(e){return vae(Nae,this,e.map(e=>{const t=gae(wae,this).getVisualFromPhysicalIndex(e);return this.getHfIndexFromVisualIndex(t)})),gae(Nae,this)}getRemovedHfIndexes(){return gae(Nae,this)}getHfIndexFromVisualIndex(e){const t=gae(wae,this).getIndexesSequence(),n=gae(wae,this).getNotTrimmedIndexes();return t.indexOf(n[e],e)}syncMoves(e){const t="move".concat(yL(gae(bae,this)),"s");gae(xae,this).getEngine().batch(()=>{e.forEach(e=>{const n=e.from!==e.to,r=e.from+1!==e.to;n&&r&&gae(xae,this).getEngine()[t](gae(xae,this).getSheetId(),e.from,1,e.to)})})}storeMovesInformation(e,t,n){!1!==n&&(vae(Cae,this,e.map(e=>this.getHfIndexFromVisualIndex(e))),vae(Eae,this,this.getHfIndexFromVisualIndex(t)))}calculateAndSyncMoves(e,t){if(gae(xae,this).isPerformingUndoRedo())return;if(!1===e||!1===t)return;const n=mae(gae(Cae,this),gae(Eae,this),gae(wae,this).getNumberOfIndexes());null===gae(xae,this).getSheetId()?gae(xae,this).getPostponeAction(()=>this.syncMoves(n)):this.syncMoves(n)}getIndexesChangeSyncMethod(){const e="set".concat(yL(gae(bae,this)),"Order");return t=>{if(gae(xae,this).isPerformingUndoRedo())return;const n=gae(wae,this).getIndexesSequence();if("update"===t&&n.length>0){const t=gae(Sae,this).map(e=>n.indexOf(e)),r=gae(xae,this).getEngine().getSheetDimensions(gae(xae,this).getSheetId());let i;i="row"===gae(bae,this)?r.height:r.width;for(let e=t.length;e<i;e+=1)t.push(e);gae(xae,this).getEngine()[e](gae(xae,this).getSheetId(),t)}vae(Sae,this,n)}}init(){vae(Sae,this,gae(wae,this).getIndexesSequence())}};function Aae(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function Rae(e,t){return e.get(Mae(e,t))}function kae(e,t,n){return e.set(Mae(e,t),n),n}function Mae(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Dae=new WeakMap,_ae=new WeakMap,Oae=new WeakMap,Iae=new WeakMap,Pae=new WeakMap,jae=new WeakMap,Fae=new WeakMap;const Hae=class{constructor(e,t,n){Aae(this,Dae,void 0),Aae(this,_ae,void 0),Aae(this,Oae,void 0),Aae(this,Iae,!1),Aae(this,Pae,!1),Aae(this,jae,null),Aae(this,Fae,null),kae(Dae,this,new Tae("row",e,this)),kae(_ae,this,new Tae("column",t,this)),kae(Oae,this,n)}getForAxis(e){return Rae("row"===e?Dae:_ae,this)}setPerformUndo(e){kae(Iae,this,e)}setPerformRedo(e){kae(Pae,this,e)}isPerformingUndoRedo(){return Rae(Iae,this)||Rae(Pae,this)}getSheetId(){return Rae(Fae,this)}getEngine(){return Rae(jae,this)}getPostponeAction(){return Rae(Oae,this)}setupSyncEndpoint(e,t){kae(jae,this,e),kae(Fae,this,t),Rae(Dae,this).init(),Rae(_ae,this).init()}};function Lae(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bae(e,t,n){zae(e,t),t.set(e,n)}function zae(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wae(e,t,n){return e.set(Uae(e,t),n),n}function Vae(e,t){return e.get(Uae(e,t))}function Uae(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const qae="formulas",Gae=["maxRows","maxColumns","language"];_W.getSingleton().register("afterNamedExpressionAdded"),_W.getSingleton().register("afterNamedExpressionRemoved"),_W.getSingleton().register("afterSheetAdded"),_W.getSingleton().register("afterSheetRemoved"),_W.getSingleton().register("afterSheetRenamed"),_W.getSingleton().register("afterFormulasValuesUpdate");const Yae=e=>"UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e;var Kae=new WeakMap,$ae=new WeakMap,Xae=new WeakMap,Qae=new WeakSet;class Jae extends T5{constructor(){var e;super(...arguments),e=this,function(e,t){zae(e,t),t.add(e)}(this,Qae),Bae(this,Kae,!1),Bae(this,$ae,!1),Bae(this,Xae,[["valuesUpdated",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Uae(Qae,e,wse).call(e,...n)}],["namedExpressionAdded",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Uae(Qae,e,xse).call(e,...n)}],["namedExpressionRemoved",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Uae(Qae,e,Sse).call(e,...n)}],["sheetAdded",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Uae(Qae,e,Cse).call(e,...n)}],["sheetRenamed",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Uae(Qae,e,Ese).call(e,...n)}],["sheetRemoved",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Uae(Qae,e,Nse).call(e,...n)}]]),Lae(this,"staticRegister",PW("formulas")),Lae(this,"engine",null),Lae(this,"sheetId",null),Lae(this,"sheetName",null),Lae(this,"indexSyncer",null),Lae(this,"rowAxisSyncer",null),Lae(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return qae}static get PLUGIN_PRIORITY(){return 260}static get SETTING_KEYS(){return[qae,...Gae]}isEnabled(){return!!this.hot.getSettings()[qae]}enablePlugin(){var e,t=this;if(!this.enabled)if(this.engine=null!==(e=oae(this.hot))&&void 0!==e?e:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){const e=this.addSheet(this.sheetName,Uae(Qae,this,tse).call(this));!1!==e&&Uae(Qae,this,Zae).call(this,e)}this.addHook("beforeLoadData",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Uae(Qae,t,ise).call(t,...n)}),this.addHook("afterLoadData",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Uae(Qae,t,ase).call(t,...n)}),this.addHook("beforeUpdateData",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Uae(Qae,t,ise).call(t,...n)}),this.addHook("afterUpdateData",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Uae(Qae,t,ase).call(t,...n)}),this.addHook("modifyData",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Uae(Qae,t,sse).call(t,...n)}),this.addHook("modifySourceData",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Uae(Qae,t,lse).call(t,...n)}),this.addHook("beforeValidate",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Uae(Qae,t,nse).call(t,...n)}),this.addHook("afterSetSourceDataAtCell",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Uae(Qae,t,use).call(t,...n)}),this.addHook("afterSetDataAtCell",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Uae(Qae,t,cse).call(t,...n)}),this.addHook("afterSetDataAtRowProp",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Uae(Qae,t,cse).call(t,...n)}),this.addHook("beforeCreateRow",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Uae(Qae,t,dse).call(t,...n)}),this.addHook("beforeCreateCol",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Uae(Qae,t,hse).call(t,...n)}),this.addHook("afterCreateRow",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Uae(Qae,t,pse).call(t,...n)}),this.addHook("afterCreateCol",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Uae(Qae,t,gse).call(t,...n)}),this.addHook("beforeRemoveRow",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Uae(Qae,t,fse).call(t,...n)}),this.addHook("beforeRemoveCol",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Uae(Qae,t,mse).call(t,...n)}),this.addHook("afterRemoveRow",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Uae(Qae,t,vse).call(t,...n)}),this.addHook("afterRemoveCol",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Uae(Qae,t,yse).call(t,...n)}),this.indexSyncer=new Hae(this.hot.rowIndexMapper,this.hot.columnIndexMapper,e=>{this.hot.addHookOnce("init",()=>{e()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(e,t,n,r)=>{this.rowAxisSyncer.storeMovesInformation(e,t,r)}),this.hot.addHook("beforeColumnMove",(e,t,n,r)=>{this.columnAxisSyncer.storeMovesInformation(e,t,r)}),this.hot.addHook("afterRowMove",(e,t,n,r,i)=>{this.rowAxisSyncer.calculateAndSyncMoves(r,i)}),this.hot.addHook("afterColumnMove",(e,t,n,r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,i)}),this.hot.addHook("beforeColumnFreeze",(e,t)=>{this.columnAxisSyncer.storeMovesInformation([e],this.hot.getSettings().fixedColumnsStart,t)}),this.hot.addHook("afterColumnFreeze",(e,t)=>{this.columnAxisSyncer.calculateAndSyncMoves(t,t)}),this.hot.addHook("beforeColumnUnfreeze",(e,t)=>{this.columnAxisSyncer.storeMovesInformation([e],this.hot.getSettings().fixedColumnsStart-1,t)}),this.hot.addHook("afterColumnUnfreeze",(e,t)=>{this.columnAxisSyncer.calculateAndSyncMoves(t,t)}),this.addHook("afterCellMetaReset",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Uae(Qae,t,ose).call(t,...n)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Uae(Qae,t,bse).call(t,...n)}),this.addHook("beforeAutofill",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Uae(Qae,t,rse).call(t,...n)}),Vae(Xae,this).forEach(e=>{let[t,n]=e;return this.engine.on(t,n)}),super.enablePlugin()}else hW("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}disablePlugin(){Vae(Xae,this).forEach(e=>{let[t,n]=e;return this.engine.off(t,n)}),sae(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=function(e){var t;const n=e[qae],r=tae(null!==n&&void 0!==n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),i=eae(e);return E(E({},r),i)}(this.hot.getSettings());(function(e,t){return Object.keys(t).some(n=>void 0!==t[n]&&t[n]!==e[n])})(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const n=this.hot.getSettings()[qae];if(nL(n)&&nL(n.sheetName)&&n.sheetName!==this.sheetName&&this.switchSheet(n.sheetName),!e.data&&null===this.sheetName){const e=this.hot.getSettings()[qae].sheetName;if(e&&this.engine.doesSheetExist(e))this.switchSheet(this.sheetName);else{const t=this.addSheet(null!==e&&void 0!==e?e:void 0,Uae(Qae,this,tse).call(this));Uae(Qae,this,Zae).call(this,t)}}super.updatePlugin(e)}destroy(){Vae(Xae,this).forEach(e=>{var t;let[n,r]=e;return null===(t=this.engine)||void 0===t?void 0:t.off(n,r)}),Wae(Xae,this,null),sae(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(nL(t)&&!eK(t))return hW("The provided data should be an array of arrays."),!1;if(void 0!==e&&null!==e&&this.engine.doesSheetExist(e))return hW("Sheet with the provided name already exists."),!1;try{const n=this.engine.addSheet(null!==e&&void 0!==e?e:void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(n),t),n}catch(qb){return hW(qb.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e))return void mW("The sheet named `".concat(e,"` does not exist, switch aborted."));Uae(Qae,this,Zae).call(this,e);const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,"".concat(yL(qae),".switchSheet"))}getCellType(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;const r=this.hot.toPhysicalRow(e),i=this.hot.toPhysicalColumn(t);return null!==r&&null!==i?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=new Set;e.forEach(e=>{var t;const r=null===e||void 0===e||null===(t=e.address)||void 0===t?void 0:t.sheet;void 0!==r&&(n.has(r)||n.add(r))}),aae(this.engine).forEach((e,r)=>{var i;(t||r!==this.sheetId)&&n.has(r)&&(e.render(),null===(i=e.view)||void 0===i||i.adjustElementsSize())})}validateDependentCells(e){const t=e=>{var t;const{row:n,col:r,sheet:i}=null!==(t=null===e||void 0===e?void 0:e.address)&&void 0!==t?t:{};return nL(i)?"".concat(i,":").concat(n,"x").concat(r):""},n=new Set((arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map(e=>t(e)));e.forEach(e=>{var r,i;const{row:o,col:a}=null!==(r=e.address)&&void 0!==r?r:{};if(!1===nL(o)||!1===nL(a)||o>=this.hot.countRows()||a>=this.hot.countCols())return;const s=null===e||void 0===e||null===(i=e.address)||void 0===i?void 0:i.sheet,l=t(e);if(void 0!==s&&!n.has(l)){const e=aae(this.engine).get(s);if(!e)return;e.validateCell(e.getDataAtCell(o,a),e.getCellMeta(o,a),()=>{})}})}syncChangeWithEngine(e,t,n){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(r))return void hW("Not possible to set cell data at ".concat(JSON.stringify(r)));const i=this.hot.getCellMeta(e,t);var o;return cae(n,i.type)&&(uae(n,i.dateFormat)?n=dae(n,i.dateFormat):!1===("string"===typeof(o=n)&&o.startsWith("="))&&(n="'".concat(n))),this.engine.setCellContents(r,n)}}function Zae(e){this.sheetName=e,this.sheetId=this.engine.getSheetId(this.sheetName)}function ese(e,t,n){if(tB(n)&&null!==n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(t),o=this.hot.getCellMeta(r,i).valueGetter;return o?o.call(this.hot,n):n.toString()}return n}function tse(e,t,n,r){return this.hot.getSourceDataArray(e,t,n,r).map((e,t)=>e.map((e,n)=>Uae(Qae,this,ese).call(this,t,n,e)))}function nse(e,t,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(t,r)){const e={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},n=this.hot.getCellMeta(t,r);let i=this.engine.getCellValue(e);return"date"===n.type&&uV(i)&&(i=fae(i,n.dateFormat)),"object"===typeof i&&null!==i?i.value:i}return e}function rse(e,t,n){const{row:r,col:i}=t.getTopStartCorner(),{row:o,col:a}=t.getBottomEndCorner(),{row:s,col:l}=n.getTopStartCorner(),{row:c,col:u}=n.getBottomEndCorner(),d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId}},h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(h))return!1;const f=this.engine.getFillRangeData(d,h),{row:m,col:p}=d.start,{row:g,col:v}=d.end,y=g-m+1,b=v-p+1;for(let w=0;w<f.length;w+=1)for(let e=0;e<f[w].length;e+=1){const t=f[w][e],n=m+w%y,r=p+e%b,i=this.hot.getCellMeta(n,r);cae(t,i.type)&&(t.startsWith("'")?f[w][e]=t.slice(1):!1===this.isFormulaCellType(n,r,this.sheetId)&&(f[w][e]=hae(t,i.dateFormat)))}return f}function ise(e,t){(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(yL(qae))||Wae($ae,this,rL(this.hot.getSettings().data))}function ose(){if(Vae($ae,this))return void this.switchSheet(this.sheetName);const e=Uae(Qae,this,tse).call(this);e.forEach((t,n)=>{t.forEach((t,r)=>{const i=this.hot.getCellMeta(n,r,{skipMetaExtension:!0}),o=i.dateFormat;cae(t,i.type)&&(uae(t,o)?e[n][r]=dae(t,o):t.startsWith("=")||(e[n][r]="'".concat(t)))})}),Wae(Kae,this,!0);const t=this.engine.setSheetContent(this.sheetId,e);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(t),Wae(Kae,this,!1)}function ase(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(n.includes(yL(qae)))return;const r=function(e,t){return!rL(t)&&e.doesSheetExist(t)||(t=e.addSheet(t)),t}(this.engine,this.hot.getSettings()[qae].sheetName);if(Uae(Qae,this,Zae).call(this,r),"updateSettings"!==n)if(Vae($ae,this))this.switchSheet(this.sheetName);else{const e=Uae(Qae,this,tse).call(this);if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,e)){Wae(Kae,this,!0);const t=this.engine.setSheetContent(this.sheetId,e);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(t),Wae(Kae,this,!1)}}}function sse(e,t,n,r){if("get"!==r||Vae(Kae,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;if(null===e||null===t)return;const i=this.getCellType(e,t);if("VALUE"===i||"EMPTY"===i)return void(n.value=(o=n.value,function(e){return"string"===typeof e&&"'"===e.charAt(0)&&"="===e.charAt(1)}(o)?o.substr(1):o));var o;const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};let s=this.engine.getCellValue(a);const l=this.hot.getCellMeta(e,t,{skipMetaExtension:!0});"date"===l.type&&uV(s)&&(s=fae(s,l.dateFormat)),n.value="object"===typeof s&&null!==s?s.value:s}function lse(e,t,n,r){if("get"!==r||Vae(Kae,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(e),o=this.hot.propToCol(t);if(null===i||null===o)return;const a=this.getCellType(i,o);if("VALUE"===a||"EMPTY"===a)return;const s=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===s.width&&0===s.height)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function cse(e,t){if(Yae(t))return;const n=[],r=[],i=this.engine.batch(()=>{e.forEach(e=>{let[t,i,,o]=e;const a=this.hot.propToCol(i),s=this.hot.toPhysicalRow(t),l=this.hot.toPhysicalColumn(a),c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId};o=Uae(Qae,this,ese).call(this,s,l,o),null!==s&&null!==l?this.syncChangeWithEngine(t,a,o):n.push([t,a,o]),r.push({address:c})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const e=this.engine.batch(()=>{n.forEach(e=>{let[t,n,r]=e;this.syncChangeWithEngine(t,n,r)})});this.renderDependentSheets(e,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function use(e,t){if(Yae(t))return;const n=[],r=[];e.forEach(e=>{let[t,i,,o]=e;const a=this.hot.propToCol(i);if(!uV(a))return;const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId};this.engine.isItPossibleToSetCellContents(s)?(r.push({address:s}),n.push(...this.engine.setCellContents(s,o))):hW("Not possible to set source cell data at ".concat(JSON.stringify(s)))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function dse(e,t){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countRows()&&(n=e),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,t]))return!1}function hse(e,t){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countCols()&&(n=e),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,t]))return!1}function fse(e,t,n){return!1!==this.rowAxisSyncer.setRemovedHfIndexes(n).every(e=>this.engine.isItPossibleToRemoveRows(this.sheetId,[e,1]))&&void 0}function mse(e,t,n){return!1!==this.columnAxisSyncer.setRemovedHfIndexes(n).every(e=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[e,1]))&&void 0}function pse(e,t,n){if(Yae(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(r)}function gse(e,t,n){if(Yae(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(r)}function vse(e,t,n,r){if(Yae(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((e,t)=>t-e),o=this.engine.batch(()=>{i.forEach(e=>{this.engine.removeRows(this.sheetId,[e,1])})});this.renderDependentSheets(o)}function yse(e,t,n,r){if(Yae(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((e,t)=>t-e),o=this.engine.batch(()=>{i.forEach(e=>{this.engine.removeColumns(this.sheetId,[e,1])})});this.renderDependentSheets(o)}function bse(e,t,n){var r;Wae(Kae,this,!0);const i=Uae(Qae,this,tse).call(this,n,0,n+((null===(r=t.__children)||void 0===r?void 0:r.length)||0),this.hot.countSourceCols());Wae(Kae,this,!1),i.forEach((e,t)=>{e.forEach((e,r)=>{this.engine.setCellContents({col:r,row:n+t,sheet:this.sheetId},[[e]])})})}function wse(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}function xse(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}function Sse(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}function Cse(e){this.hot.runHooks("afterSheetAdded",e)}function Ese(e,t){Uae(Qae,this,Zae).call(this,t),this.hot.runHooks("afterSheetRenamed",e,t)}function Nse(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}function Tse(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ase(e,t){return e.get(kse(e,t))}function Rse(e,t,n){return e.set(kse(e,t),n),n}function kse(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}_W.getSingleton().register("beforeHideColumns"),_W.getSingleton().register("afterHideColumns"),_W.getSingleton().register("beforeUnhideColumns"),_W.getSingleton().register("afterUnhideColumns");const Mse="hiddenColumns";var Dse=new WeakMap,_se=new WeakSet;class Ose extends T5{constructor(){super(...arguments),function(e,t){Tse(e,t),t.add(e)}(this,_se),function(e,t,n){Tse(e,t),t.set(e,n)}(this,Dse,null)}static get PLUGIN_KEY(){return Mse}static get PLUGIN_PRIORITY(){return 310}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[Mse]}enablePlugin(){var e=this;this.enabled||(Rse(Dse,this,new gK),Ase(Dse,this).addLocalHook("init",()=>kse(_se,this,Lse).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Ase(Dse,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return kse(_se,e,Hse).call(e,...n)}),this.addHook("afterGetCellMeta",(e,t,n)=>kse(_se,this,Pse).call(this,e,t,n)),this.addHook("modifyColWidth",(e,t)=>kse(_se,this,Ise).call(this,e,t),2),this.addHook("afterGetColHeader",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return kse(_se,e,Fse).call(e,...n)}),this.addHook("modifyCopyableRange",e=>kse(_se,this,jse).call(this,e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),n=this.isValidConfig(e);let r=t;const i=Ase(Dse,this).getValues().slice(),o=e.length>0;if(n&&o){WH(e.map(e=>this.hot.toPhysicalColumn(e)),e=>{i[e]=!1}),r=LH(i,(e,t,n)=>(t&&e.push(this.hot.toVisualColumn(n)),e),[])}!1!==this.hot.runHooks("beforeUnhideColumns",t,r,n&&o)&&(n&&o&&Ase(Dse,this).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,r,n&&o,n&&r.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),n=this.isValidConfig(e);let r=t;n&&(r=Array.from(new Set(t.concat(e))));!1!==this.hot.runHooks("beforeHideColumns",t,r,n)&&(n&&this.hot.batchExecution(()=>{WH(e,e=>{Ase(Dse,this).setValueAtIndex(this.hot.toPhysicalColumn(e),!0)})},!0),this.hot.runHooks("afterHideColumns",t,r,n,n&&r.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideColumns(t)}getHiddenColumns(){return zH(Ase(Dse,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Ase(Dse,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return!!(Array.isArray(e)&&e.length>0)&&e.every(e=>Number.isInteger(e)&&e>=0&&e<t)}resetCellsMeta(){WH(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){Rse(Dse,this,null),super.destroy()}}function Ise(e,t){return this.isHidden(t)?0:this.getSetting("indicators")&&(this.isHidden(t+1)||this.isHidden(t-1))&&"number"===typeof e&&this.hot.hasColHeaders()?e+15:void 0}function Pse(e,t,n){if(!1===this.getSetting("copyPasteEnabled")&&this.isHidden(t)&&(n.skipColumnOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");else if(n.className){const e=n.className.split(" ");if(e.length>0){const t=e.indexOf("afterHiddenColumn");t>-1&&e.splice(t,1),n.className=e.join(" ")}}}function jse(e){if(this.getSetting("copyPasteEnabled"))return e;const t=[],n=(e,n,r,i)=>{t.push({startRow:e,endRow:n,startCol:r,endCol:i})};return WH(e,e=>{let t=!0,r=0;hV(e.startCol,e.endCol,i=>{this.isHidden(i)?(t||n(e.startRow,e.endRow,r,i-1),t=!0):(t&&(r=i),i===e.endCol&&n(e.startRow,e.endRow,r,i),t=!1)})}),t}function Fse(e,t){if(!this.getSetting("indicators")||e<0)return;const n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&n.push("beforeHiddenColumn"),KB(t,n)}function Hse(e){var t;e.items.push({name:Y7},(t=this,{key:"hidden_columns_hide",name(){const e=this.getSelectedActive();let t=0;if(Array.isArray(e)){const[,n,,r]=e;n-r!==0&&(t=1)}return this.getTranslatedPhrase(B$,t)},callback(){const{from:e,to:n}=this.getSelectedRangeActive(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let t=r;t<=i;t+=1)o.push(t);t.hideColumns(o);const a=o[o.length-1],s=this.columnIndexMapper.getNearestNotHiddenIndex(a,1,!0);Number.isInteger(s)&&s>=0?this.selectColumns(s):this.deselectCell(),this.view.adjustElementsSize(),this.render()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}),function(e){const t=[];return{key:"hidden_columns_show",name(){const e=t.length>1?1:0;return this.getTranslatedPhrase(z$,e)},callback(){var n,r;if(0===t.length)return;let i=t[0],o=t[t.length-1];i=null!==(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==n?n:0,o=null!==(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))&&void 0!==r?r:this.countCols()-1,e.showColumns(t),this.view.adjustElementsSize(),this.render(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=zH(e.getHiddenColumns(),e=>this.toPhysicalColumn(e));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||n.length<1)return!0;t.length=0;const r=this.getSelectedRangeActive(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,a=this.columnIndexMapper,s=a.getRenderableFromVisualIndex(i),l=a.getRenderableFromVisualIndex(o),c=a.getNotTrimmedIndexes(),u=[];if(i!==o){if(o-i+1>l-s+1){const e=c.slice(i,o+1);u.push(...e.filter(e=>n.includes(e)))}}else if(0===s&&s<i)u.push(...c.slice(0,i));else if(null===s)u.push(...c.slice(0,this.countCols()));else{const e=this.countCols()-1;l===a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(e,-1))&&e>o&&u.push(...c.slice(o+1))}return WH(u,e=>{t.push(this.toVisualColumn(e))}),0===t.length}}}(this))}function Lse(){const e=this.getSetting("columns");Array.isArray(e)&&this.hideColumns(e)}function Bse(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zse(e,t){return e.get(Vse(e,t))}function Wse(e,t,n){return e.set(Vse(e,t),n),n}function Vse(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}_W.getSingleton().register("beforeHideRows"),_W.getSingleton().register("afterHideRows"),_W.getSingleton().register("beforeUnhideRows"),_W.getSingleton().register("afterUnhideRows");const Use="hiddenRows";var qse=new WeakMap,Gse=new WeakSet;class Yse extends T5{constructor(){super(...arguments),function(e,t){Bse(e,t),t.add(e)}(this,Gse),function(e,t,n){Bse(e,t),t.set(e,n)}(this,qse,null)}static get PLUGIN_KEY(){return Use}static get PLUGIN_PRIORITY(){return 320}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[Use]}enablePlugin(){var e=this;this.enabled||(Wse(qse,this,new gK),zse(qse,this).addLocalHook("init",()=>Vse(Gse,this,Zse).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,zse(qse,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Vse(Gse,e,Jse).call(e,...n)}),this.addHook("afterGetCellMeta",(e,t,n)=>Vse(Gse,this,$se).call(this,e,t,n)),this.addHook("modifyRowHeight",(e,t)=>Vse(Gse,this,Kse).call(this,e,t)),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Vse(Gse,e,Qse).call(e,...n)}),this.addHook("modifyCopyableRange",e=>Vse(Gse,this,Xse).call(this,e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),n=this.isValidConfig(e);let r=t;const i=zse(qse,this).getValues().slice(),o=e.length>0;if(n&&o){WH(e.map(e=>this.hot.toPhysicalRow(e)),e=>{i[e]=!1}),r=LH(i,(e,t,n)=>(t&&e.push(this.hot.toVisualRow(n)),e),[])}!1!==this.hot.runHooks("beforeUnhideRows",t,r,n&&o)&&(n&&o&&zse(qse,this).setValues(i),this.hot.runHooks("afterUnhideRows",t,r,n&&o,n&&r.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),n=this.isValidConfig(e);let r=t;n&&(r=Array.from(new Set(t.concat(e))));!1!==this.hot.runHooks("beforeHideRows",t,r,n)&&(n&&this.hot.batchExecution(()=>{WH(e,e=>{zse(qse,this).setValueAtIndex(this.hot.toPhysicalRow(e),!0)})},!0),this.hot.runHooks("afterHideRows",t,r,n,n&&r.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideRows(t)}getHiddenRows(){return zH(zse(qse,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return zse(qse,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return!!(Array.isArray(e)&&e.length>0)&&e.every(e=>Number.isInteger(e)&&e>=0&&e<t)}resetCellsMeta(){WH(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){Wse(qse,this,null),super.destroy()}}function Kse(e,t){return this.isHidden(t)?0:e}function $se(e,t,n){if(!1===this.getSetting("copyPasteEnabled")&&this.isHidden(e)&&(n.skipRowOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");else if(n.className){const e=n.className.split(" ");if(e.length>0){const t=e.indexOf("afterHiddenRow");t>-1&&e.splice(t,1),n.className=e.join(" ")}}}function Xse(e){if(this.getSetting("copyPasteEnabled"))return e;const t=[],n=(e,n,r,i)=>{t.push({startRow:e,endRow:n,startCol:r,endCol:i})};return WH(e,e=>{let t=!0,r=0;hV(e.startRow,e.endRow,i=>{this.isHidden(i)?(t||n(r,i-1,e.startCol,e.endCol),t=!0):(t&&(r=i),i===e.endRow&&n(r,i,e.startCol,e.endCol),t=!1)})}),t}function Qse(e,t){if(!this.getSetting("indicators")||e<0)return;const n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&n.push("beforeHiddenRow"),KB(t,n)}function Jse(e){var t;e.items.push({name:Y7},(t=this,{key:"hidden_rows_hide",name(){const e=this.getSelectedActive();let t=0;if(Array.isArray(e)){const[n,,r]=e;n-r!==0&&(t=1)}return this.getTranslatedPhrase(W$,t)},callback(){const{from:e,to:n}=this.getSelectedRangeActive(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let t=r;t<=i;t+=1)o.push(t);t.hideRows(o);const a=o[o.length-1],s=this.rowIndexMapper.getNearestNotHiddenIndex(a,1,!0);Number.isInteger(s)&&s>=0?this.selectRows(s):this.deselectCell(),this.view.adjustElementsSize(),this.render()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}),function(e){const t=[];return{key:"hidden_rows_show",name(){const e=t.length>1?1:0;return this.getTranslatedPhrase(V$,e)},callback(){var n,r;if(0===t.length)return;let i=t[0],o=t[t.length-1];i=null!==(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==n?n:0,o=null!==(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))&&void 0!==r?r:this.countRows()-1,e.showRows(t),this.view.adjustElementsSize(),this.render(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=zH(e.getHiddenRows(),e=>this.toPhysicalRow(e));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||n.length<1)return!0;t.length=0;const r=this.getSelectedRangeActive(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,a=this.rowIndexMapper,s=a.getRenderableFromVisualIndex(i),l=a.getRenderableFromVisualIndex(o),c=a.getNotTrimmedIndexes(),u=[];if(i!==o){if(o-i+1>l-s+1){const e=c.slice(i,o+1);u.push(...e.filter(e=>n.includes(e)))}}else if(0===s&&s<i)u.push(...c.slice(0,i));else if(null===s)u.push(...c.slice(0,this.countRows()));else{const e=this.countRows()-1;l===a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(e,-1))&&e>o&&u.push(...c.slice(o+1))}return WH(u,e=>{t.push(this.toVisualRow(e))}),0===t.length}}}(this))}function Zse(){const e=this.getSetting("rows");Array.isArray(e)&&this.hideRows(e)}function ele(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tle(e,t){return e.get(rle(e,t))}function nle(e,t,n){return e.set(rle(e,t),n),n}function rle(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}_W.getSingleton().register("beforeColumnFreeze"),_W.getSingleton().register("afterColumnFreeze"),_W.getSingleton().register("beforeColumnUnfreeze"),_W.getSingleton().register("afterColumnUnfreeze");const ile="manualColumnFreeze";var ole=new WeakMap,ale=new WeakSet;class sle extends T5{constructor(){super(...arguments),function(e,t){ele(e,t),t.add(e)}(this,ale),function(e,t,n){ele(e,t),t.set(e,n)}(this,ole,!1)}static get PLUGIN_KEY(){return ile}static get PLUGIN_PRIORITY(){return 110}isEnabled(){return!!this.hot.getSettings()[ile]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>rle(ale,this,lle).call(this,e)),this.addHook("beforeColumnMove",(e,t)=>rle(ale,this,cle).call(this,e,t)),super.enablePlugin())}disablePlugin(){nle(ole,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=this.hot.getSettings(),n=t.fixedColumnsStart<this.hot.countCols()&&e>t.fixedColumnsStart-1;tle(ole,this)||nle(ole,this,!0);!1!==this.hot.runHooks("beforeColumnFreeze",e,n)&&(n&&(this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart),t._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,n))}unfreezeColumn(e){const t=this.hot.getSettings(),n=t.fixedColumnsStart>0&&e<=t.fixedColumnsStart-1;tle(ole,this)||nle(ole,this,!0);!1!==this.hot.runHooks("beforeColumnUnfreeze",e,n)&&(n&&(t._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,n))}}function lle(e){var t;e.items.push({name:"---------"},(t=this,{key:"freeze_column",name(){return this.getTranslatedPhrase(g$)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.view.adjustElementsSize(),this.render()},hidden(){const e=this.getSelectedRange();let t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}),function(e){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(v$)},callback(t,n){const[{start:{col:r}}]=n;e.unfreezeColumn(r),this.view.adjustElementsSize(),this.render()},hidden(){const e=this.getSelectedRange();let t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}(this))}function cle(e,t){if(tle(ole,this)){const n=this.hot.getSettings().fixedColumnsStart;if(t<n)return!1;if(e.some(e=>e<n))return!1}}function ule(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const dle="px";const hle=class{constructor(e){ule(this,"hot",void 0),ule(this,"_element",null),ule(this,"state",0),ule(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(e,t){uV(e)&&(this._element.style.top=e+dle),uV(t)&&(this._element.style[this.inlineProperty]=t+dle)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){uV(e)&&(this._element.style.width=e+dle),uV(t)&&(this._element.style.height=t+dle)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){uV(e)&&(this._element.style.marginTop=e+dle),uV(t)&&(this._element.style["margin".concat(yL(this.inlineProperty))]=t+dle)}getOffset(){const e=this._element.style,t="margin".concat(yL(this.inlineProperty));return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}};const fle=class extends hle{build(){super.build(),KB(this._element,"ht__manualColumnMove--backlight")}};const mle=class extends hle{build(){super.build(),KB(this._element,"ht__manualColumnMove--guideline")}};function ple(e,t,n){gle(e,t),t.set(e,n)}function gle(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vle(e,t,n){return e.set(ble(e,t),n),n}function yle(e,t){return e.get(ble(e,t))}function ble(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}_W.getSingleton().register("beforeColumnMove"),_W.getSingleton().register("afterColumnMove");const wle="manualColumnMove",xle="ht__manualColumnMove",Sle="show-ui",Cle="on-moving--columns",Ele="after-selection--columns";var Nle=new WeakMap,Tle=new WeakMap,Ale=new WeakMap,Rle=new WeakMap,kle=new WeakMap,Mle=new WeakMap,Dle=new WeakMap,_le=new WeakMap,Ole=new WeakMap,Ile=new WeakMap,Ple=new WeakMap,jle=new WeakSet;class Fle extends T5{constructor(){super(...arguments),function(e,t){gle(e,t),t.add(e)}(this,jle),ple(this,Nle,new fle(this.hot)),ple(this,Tle,new mle(this.hot)),ple(this,Ale,[]),ple(this,Rle,0),ple(this,kle,!1),ple(this,Mle,{}),ple(this,Dle,void 0),ple(this,_le,void 0),ple(this,Ole,void 0),ple(this,Ile,void 0),ple(this,Ple,void 0)}static get PLUGIN_KEY(){return wle}static get PLUGIN_PRIORITY(){return 120}isEnabled(){return!!this.hot.getSettings()[wle]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ble(jle,e,Hle).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ble(jle,e,Ble).call(e,...n)}),this.addHook("afterScrollVertically",()=>ble(jle,this,Wle).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ble(jle,e,Vle).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),KB(this.hot.rootElement,xle),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){$B(this.hot.rootElement,xle),this.unregisterEvents(),yle(Nle,this).destroy(),yle(Tle,this).destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const n=yle(Dle,this),r=this.isMovePossible(e,t),i=this.hot.runHooks("beforeColumnMove",e,t,n,r);if(vle(Dle,this,void 0),!1===i)return;r&&this.hot.columnIndexMapper.moveIndexes(e,t);const o=r&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,n,r,o),o}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const n=this.countFinalIndex(e,t);return vle(Dle,this,t),this.moveColumns(e,n)}isMovePossible(e,t){const n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=e.length+t>n,i=t<0,o=e.some(e=>e<0),a=e.some(e=>e>=n);return!(r||i||o||a)}isColumnOrderChanged(e,t){return e.some((e,n)=>e-n!==t)}countFinalIndex(e,t){const n=LH(e,(e,n)=>(n<t&&(e+=1),e),0);return t-n}getColumnsWidth(e,t){const n=this.hot.columnIndexMapper;let r=0;for(let i=e;i<=t;i+=1){const e=n.getRenderableFromVisualIndex(i);i<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==e&&(r+=this.hot.view._wt.wtTable.getColumnWidth(e)||0)}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[wle];if(Array.isArray(e))this.moveColumns(e,0);else if(void 0!==e){const e=this.persistentStateLoad();e.length&&this.moveColumns(e,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const n=[];return hV(e,t,e=>{n.push(e)}),n}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(yle(_le,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const t=this.hot.view._wt.wtTable,n=this.hot.view._wt.wtOverlays.scrollableElement,r="number"===typeof n.scrollX?n.scrollX:n.scrollLeft;let i=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,yle(_le,this)-1);const o=t.hider.offsetWidth,a=t.TBODY.offsetLeft,s=yle(Nle,this).getOffset().start,l=yle(Nle,this).getSize().width;let c=0,u=0;if(this.hot.isRtl()){const e=this.hot.rootWindow,t=gz(this.hot.rootElement),i=e.innerWidth-yle(Ole,this)-t;u=e.innerWidth-yle(Mle,this).eventPageX-i-(void 0===n.scrollX?r:0)}else u=yle(Mle,this).eventPageX-(yle(Ole,this)-(void 0===n.scrollX?r:0));if(yle(Ile,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(yle(_le,this))&&(i+=r),i+=c,yle(_le,this)<0)yle(Ple,this)>0?yle(Mle,this).col=0:yle(Mle,this).col=e>0?e-1:e;else if(yle(Mle,this).TD.offsetWidth/2+i<=u){const e=yle(_le,this)>=yle(Rle,this)?yle(Rle,this)-1:yle(_le,this);yle(Mle,this).col=e+1,i+=yle(Mle,this).TD.offsetWidth}else yle(Mle,this).col=yle(_le,this);let d=u,h=i;u+l+s>=o?d=o-l-s:u+s<a+c&&(d=a+c+Math.abs(s)),i>=o-1?h=o-1:0===h?h=1:void 0!==n.scrollX&&yle(_le,this)<yle(Ple,this)&&(h-=yle(Ole,this)<=n.scrollX?yle(Ole,this):0),yle(Nle,this).setPosition(null,d),yle(Tle,this).setPosition(null,h)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",e=>ble(jle,this,Lle).call(this,e)),this.eventManager.addEventListener(e,"mouseup",()=>ble(jle,this,zle).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){yle(Nle,this).build(),yle(Tle,this).build()}destroy(){yle(Nle,this).destroy(),yle(Tle,this).destroy(),super.destroy()}}function Hle(e,t,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeActive(),s=YB(e.target,"sortAction");if(!a||!o||yle(kle,this)||0!==e.button||s)return vle(kle,this,!1),yle(Ale,this).length=0,void $B(this.hot.rootElement,[Cle,Sle]);const l=yle(Tle,this).isBuilt()&&!yle(Tle,this).isAppended(),c=yle(Nle,this).isBuilt()&&!yle(Nle,this).isAppended();l&&c&&(yle(Tle,this).appendTo(i.hider),yle(Nle,this).appendTo(i.hider));const{from:u,to:d}=a,h=Math.min(u.col,d.col),f=Math.max(u.col,d.col);if(t.row<0&&t.col>=h&&t.col<=f){r.column=!0,vle(kle,this,!0);const o=n.firstChild?dW(e,n.firstChild).x:e.offsetX;yle(Mle,this).eventPageX=e.pageX,vle(_le,this,t.col),yle(Mle,this).TD=n,yle(Mle,this).col=t.col,vle(Ale,this,this.prepareColumnsToMoving(h,f)),vle(Ile,this,!!this.hot.getSettings().rowHeaders),vle(Rle,this,this.hot.countCols()),vle(Ple,this,this.hot.getSettings().fixedColumnsStart),vle(Ole,this,oz(this.hot.rootElement).left);const a=yle(Ile,this)?-1:0,s=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,l=t.col<yle(Ple,this),c=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),u=Math.abs(o-(this.hot.isRtl()?n.offsetWidth:0)),d=this.getColumnsWidth(h,t.col-1)+u,m=this.getColumnsWidth(a,h-1)+(l?c:0)+d;yle(Nle,this).setPosition(s,m),yle(Nle,this).setSize(this.getColumnsWidth(h,f),i.hider.offsetHeight-s),yle(Nle,this).setOffset(null,-d),KB(this.hot.rootElement,Cle)}else $B(this.hot.rootElement,Ele),vle(kle,this,!1),yle(Ale,this).length=0}function Lle(e){yle(kle,this)&&(yle(Mle,this).eventPageX=e.pageX,this.refreshPositions())}function Ble(e,t,n,r){this.hot.getSelectedRangeActive()&&yle(kle,this)&&(yle(Ale,this).indexOf(t.col)>-1?$B(this.hot.rootElement,Sle):KB(this.hot.rootElement,Sle),r.row=!0,r.column=!0,r.cell=!0,vle(_le,this,t.col),yle(Mle,this).TD=n)}function zle(){const e=yle(Mle,this).col,t=yle(Ale,this).length;if(vle(_le,this,void 0),vle(kle,this,!1),$B(this.hot.rootElement,[Cle,Sle,Ele]),this.hot.selection.isSelectedByColumnHeader()&&KB(this.hot.rootElement,Ele),t<1||void 0===e)return;const n=yle(Ale,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(yle(Ale,this),e);if(yle(Ale,this).length=0,!0===i){this.persistentStateSave(),this.hot.view.adjustElementsSize(),this.hot.render();const e=this.hot.toVisualColumn(r),n=e+t-1;this.hot.selectColumns(e,n)}}function Wle(){const e=this.hot.view._wt.wtTable,t=e.getColumnHeaderHeight(0)+1+e.holder.scrollTop;yle(Nle,this).setPosition(t),yle(Nle,this).setSize(null,e.hider.offsetHeight-t)}function Vle(){this.moveBySettingsOrLoad()}function Ule(e,t,n){qle(e,t),t.set(e,n)}function qle(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gle(e,t,n){return e.set(Kle(e,t),n),n}function Yle(e,t){return e.get(Kle(e,t))}function Kle(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const $le="manualColumnResize",Xle="manualColumnWidths";var Qle=new WeakMap,Jle=new WeakMap,Zle=new WeakMap,ece=new WeakMap,tce=new WeakMap,nce=new WeakMap,rce=new WeakMap,ice=new WeakMap,oce=new WeakMap,ace=new WeakMap,sce=new WeakMap,lce=new WeakMap,cce=new WeakMap,uce=new WeakMap,dce=new WeakMap,hce=new WeakMap,fce=new WeakSet;class mce extends T5{static get PLUGIN_KEY(){return $le}static get PLUGIN_PRIORITY(){return 130}constructor(e){super(e),function(e,t){qle(e,t),t.add(e)}(this,fce),Ule(this,Qle,null),Ule(this,Jle,null),Ule(this,Zle,[]),Ule(this,ece,null),Ule(this,tce,null),Ule(this,nce,null),Ule(this,rce,null),Ule(this,ice,null),Ule(this,oce,this.hot.rootDocument.createElement("DIV")),Ule(this,ace,this.hot.rootDocument.createElement("DIV")),Ule(this,sce,null),Ule(this,lce,!1),Ule(this,cce,0),Ule(this,uce,null),Ule(this,dce,void 0),Ule(this,hce,void 0),KB(Yle(oce,this),"manualColumnResizer"),KB(Yle(ace,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[$le]}enablePlugin(){var e=this;this.enabled||(Gle(dce,this,new pK),Yle(dce,this).addLocalHook("init",()=>Kle(fce,this,pce).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Yle(dce,this)),this.addHook("modifyColWidth",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Kle(fce,e,xce).call(e,...n)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Kle(fce,e,Sce).call(e,...n)},1),this.addHook("beforeColumnResize",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Kle(fce,e,Cce).call(e,...n)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Gle(hce,this,Yle(dce,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",Xle,Yle(dce,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",Xle,e),e.value}setManualSize(e,t){const n=Math.max(t,20),r=this.hot.toPhysicalColumn(e);return Yle(dce,this).setValueAtIndex(r,n),n}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);Yle(dce,this).setValueAtIndex(t,null)}setupHandlePosition(e){if(!e.parentNode||Yle(cce,this)>1)return;Gle(Qle,this,e);const{_wt:t}=this.hot.view,n=t.wtTable.getCoords(Yle(Qle,this)),r=n.col;if(r<0)return;const i=vz(Yle(Qle,this)),o=Yle(Qle,this).getBoundingClientRect();let a;r<t.getSetting("fixedColumnsStart")&&(a=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Yle(Qle,this),n.row,n.col)),a||(a=t.wtOverlays.topOverlay.getRelativeCellPosition(Yle(Qle,this),n.row,n.col)),Gle(Jle,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)),Gle(Zle,this,[]);const s=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&s){WH(this.hot.getSelectedRange(),e=>{hV(e.getTopStartCorner().col,e.getBottomEndCorner().col,e=>{Yle(Zle,this).includes(e)||Yle(Zle,this).push(e)})})}Yle(Zle,this).includes(Yle(Jle,this))||Gle(Zle,this,[Yle(Jle,this)]),Gle(ice,this,a.start-6),Gle(rce,this,parseInt(o.width,10)),Yle(oce,this).style.top="".concat(a.top,"px"),Yle(oce,this).style[this.inlineDir]="".concat(Yle(ice,this)+Yle(rce,this),"px"),Yle(oce,this).style.height="".concat(i,"px"),this.hot.rootElement.appendChild(Yle(oce,this))}refreshHandlePosition(){Yle(oce,this).style[this.inlineDir]="".concat(Yle(ice,this)+Yle(ece,this),"px")}setupGuidePosition(){const e=parseInt(vz(Yle(oce,this)),10),t=parseInt(Yle(oce,this).style.top,10)+e,n=this.hot.view.getTableHeight();KB(Yle(oce,this),"active"),KB(Yle(ace,this),"active"),Yle(ace,this).style.top="".concat(t,"px"),this.refreshGuidePosition(),Yle(ace,this).style.height="".concat(n-e,"px"),this.hot.rootElement.appendChild(Yle(ace,this))}refreshGuidePosition(){Yle(ace,this).style[this.inlineDir]=Yle(oce,this).style[this.inlineDir]}hideHandleAndGuide(){$B(Yle(oce,this),"active"),$B(Yle(ace,this),"active")}checkIfColumnHeader(e){const t=LB(e,["THEAD"],this.hot.rootElement),{topOverlay:n,topInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.THEAD,r.clone.wtTable.THEAD].includes(t)}getClosestTHParent(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},t=(t,n)=>{const r=this.hot.runHooks("beforeColumnResize",Yle(tce,this),t,!0);void 0!==r&&Gle(tce,this,r),this.setManualSize(t,Yle(tce,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Yle(tce,this),t,!0),n&&e()};if(Yle(cce,this)>=2){Yle(Zle,this).length>1?(WH(Yle(Zle,this),e=>{t(e)}),e()):WH(Yle(Zle,this),e=>{t(e,!0)})}Gle(cce,this,0),Gle(uce,this,null)}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",e=>Kle(fce,this,gce).call(this,e)),this.eventManager.addEventListener(t,"mousedown",e=>Kle(fce,this,vce).call(this,e)),this.eventManager.addEventListener(e,"mousemove",e=>Kle(fce,this,yce).call(this,e)),this.eventManager.addEventListener(e,"mouseup",()=>Kle(fce,this,bce).call(this)),this.eventManager.addEventListener(Yle(oce,this),"contextmenu",()=>Kle(fce,this,wce).call(this))}destroy(){super.destroy()}}function pce(){const e=this.hot.getSettings()[$le],t=this.loadManualColumnWidths();"undefined"!==typeof t?this.hot.batchExecution(()=>{t.forEach((e,t)=>{Yle(dce,this).setValueAtIndex(t,e)})},!0):Array.isArray(e)?(this.hot.batchExecution(()=>{e.forEach((e,t)=>{Yle(dce,this).setValueAtIndex(t,e)})},!0),Gle(hce,this,e)):!0===e&&Array.isArray(Yle(hce,this))&&this.hot.batchExecution(()=>{Yle(hce,this).forEach((e,t)=>{Yle(dce,this).setValueAtIndex(t,e)})},!0)}function gce(e){if(!Hz(e.target)&&!0!==Yle(lce,this)&&this.checkIfColumnHeader(e.target)){const t=this.getClosestTHParent(e.target);if(!t)return;const n=t.getAttribute("colspan");!t||null!==n&&"1"!==n||Yle(sce,this)||this.setupHandlePosition(t)}}function vce(e){e.target.parentNode===this.hot.rootElement&&YB(e.target,"manualColumnResizer")&&(this.setupHandlePosition(Yle(Qle,this)),this.setupGuidePosition(),Gle(sce,this,!0),null===Yle(uce,this)&&(Gle(uce,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Yle(uce,this))),Gle(cce,this,Yle(cce,this)+1),this.startX=e.pageX,Gle(tce,this,Yle(rce,this)))}function yce(e){if(Yle(sce,this)){const t=(e.pageX-this.startX)*this.hot.getDirectionFactor();Gle(ece,this,Yle(rce,this)+t),WH(Yle(Zle,this),e=>{Gle(tce,this,this.setManualSize(e,Yle(ece,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function bce(){const e=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},t=(t,n)=>{this.hot.runHooks("beforeColumnResize",Yle(tce,this),t,!1),n&&e(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Yle(tce,this),t,!1)};if(Yle(sce,this)){if(this.hideHandleAndGuide(),Gle(sce,this,!1),Yle(tce,this)!==Yle(rce,this)){Yle(Zle,this).length>1?(WH(Yle(Zle,this),e=>{t(e)}),e()):WH(Yle(Zle,this),e=>{t(e,!0)})}this.setupHandlePosition(Yle(Qle,this))}}function wce(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Yle(oce,this)),this.hot.rootElement.removeChild(Yle(ace,this)),Gle(sce,this,!1),Gle(lce,this,!0),this.hot._registerImmediate(()=>{Gle(lce,this,!1)})}function xce(e,t){let n=e;if(this.enabled){const e=this.hot.toPhysicalColumn(t),r=Yle(dce,this).getValueAtIndex(e);this.hot.getSettings()[$le]&&r&&(n=r)}return n}function Sce(e,t){const n=Yle(dce,this).getValueAtIndex(this.hot.toPhysicalColumn(t));return"number"===typeof n?n:e}function Cce(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function Ece(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Nce="px";const Tce=class{constructor(e){Ece(this,"hot",void 0),Ece(this,"_element",null),Ece(this,"state",0),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(e,t){void 0!==e&&(this._element.style.top=e+Nce),void 0!==t&&(this._element.style.left=t+Nce)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+Nce),t&&(this._element.style.height=t+Nce)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+Nce),t&&(this._element.style.marginLeft=t+Nce)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Ace=class extends Tce{build(){super.build(),KB(this._element,"ht__manualRowMove--backlight")}};const Rce=class extends Tce{build(){super.build(),KB(this._element,"ht__manualRowMove--guideline")}};function kce(e,t,n){Mce(e,t),t.set(e,n)}function Mce(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dce(e,t,n){return e.set(Oce(e,t),n),n}function _ce(e,t){return e.get(Oce(e,t))}function Oce(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}_W.getSingleton().register("beforeRowMove"),_W.getSingleton().register("afterRowMove");const Ice="manualRowMove",Pce="ht__manualRowMove",jce="show-ui",Fce="on-moving--rows",Hce="after-selection--rows";var Lce=new WeakMap,Bce=new WeakMap,zce=new WeakMap,Wce=new WeakMap,Vce=new WeakMap,Uce=new WeakMap,qce=new WeakSet;class Gce extends T5{constructor(){super(...arguments),function(e,t){Mce(e,t),t.add(e)}(this,qce),kce(this,Lce,new Ace(this.hot)),kce(this,Bce,new Rce(this.hot)),kce(this,zce,[]),kce(this,Wce,void 0),kce(this,Vce,{}),kce(this,Uce,void 0)}static get PLUGIN_KEY(){return Ice}static get PLUGIN_PRIORITY(){return 140}isEnabled(){return!!this.hot.getSettings()[Ice]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Oce(qce,e,Yce).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Oce(qce,e,$ce).call(e,...n)}),this.addHook("afterScrollHorizontally",()=>Oce(qce,this,Qce).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Oce(qce,e,Jce).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),KB(this.hot.rootElement,Pce),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){$B(this.hot.rootElement,Pce),this.unregisterEvents(),_ce(Lce,this).destroy(),_ce(Bce,this).destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const n=_ce(Uce,this),r=this.isMovePossible(e,t),i=this.hot.runHooks("beforeRowMove",e,t,n,r);if(Dce(Uce,this,void 0),!1===i)return;r&&this.hot.rowIndexMapper.moveIndexes(e,t);const o=r&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,n,r,o),o}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const n=this.countFinalIndex(e,t);return Dce(Uce,this,t),this.moveRows(e,n)}isMovePossible(e,t){const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=e.length+t>n,i=t<0,o=e.some(e=>e<0),a=e.some(e=>e>=n);return!(r||i||o||a)}isRowOrderChanged(e,t){return e.some((e,n)=>e-n!==t)}countFinalIndex(e,t){const n=LH(e,(e,n)=>(n<t&&(e+=1),e),0);return t-n}getRowsHeight(e,t){const n=this.hot.rowIndexMapper;let r=0;for(let i=e;i<=t;i++){const e=n.getRenderableFromVisualIndex(i);null!==e&&(r+=this.hot.view._wt.wtTable.getRowHeight(e)||this.hot.stylesHandler.getDefaultRowHeight())}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Ice];if(Array.isArray(e))this.moveRows(e,0);else if(void 0!==e){const e=this.persistentStateLoad();e.length&&this.moveRows(e,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeActive(),t=[];if(!e)return t;const{from:n,to:r}=e;return hV(Math.min(n.row,r.row),Math.max(n.row,r.row),e=>{t.push(e)}),t}refreshPositions(){const e=_ce(Vce,this).coords,t=this.hot.getFirstFullyVisibleRow(),n=this.hot.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(e.row)&&t>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1)),this.isFixedRowBottom(e.row)&&n<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n+1,1),void 0,!0);const i=this.hot.view._wt.wtTable,o=_ce(Vce,this).TD,a=this.hot.rootElement,s=oz(a),l=fz(a),c=i.holder.scrollTop,u=this.hot.rootWindow!==l?l.scrollTop:0,d=s.top-u,h=_ce(Vce,this).eventPageY-d+c,f=i.hider.offsetHeight,m=i.TBODY.offsetTop,p=_ce(Lce,this).getOffset().top,g=_ce(Lce,this).getSize().height,v=o.offsetHeight/2,y=o.offsetHeight;let b=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const w=h>=b+v;this.isFixedRowTop(e.row)&&(b+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?_ce(Vce,this).row=t>0?t-1:t:w?(_ce(Vce,this).row=e.row+1,b+=0===e.row?y-1:y):_ce(Vce,this).row=e.row;let x=h,S=b;h+g+p>=f?x=f-g-p:h+p<m&&(x=m+Math.abs(p)),b>=f-1&&(S=f-1),_ce(Lce,this).setPosition(x),_ce(Bce,this).setPosition(S)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",e=>Oce(qce,this,Kce).call(this,e)),this.eventManager.addEventListener(e,"mouseup",()=>Oce(qce,this,Xce).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){_ce(Lce,this).build(),_ce(Bce,this).build()}destroy(){_ce(Lce,this).destroy(),_ce(Bce,this).destroy(),super.destroy()}}function Yce(e,t,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,a=this.hot.selection.isSelectedByRowHeader(),s=this.hot.getSelectedRangeActive();if(!s||!a||_ce(Wce,this)||0!==e.button)return Dce(Wce,this,!1),_ce(zce,this).length=0,void $B(this.hot.rootElement,[Fce,jce]);const l=_ce(Bce,this).isBuilt()&&!_ce(Bce,this).isAppended(),c=_ce(Lce,this).isBuilt()&&!_ce(Lce,this).isAppended();l&&c&&(_ce(Bce,this).appendTo(i.hider),_ce(Lce,this).appendTo(i.hider));const{from:u,to:d}=s,h=Math.min(u.row,d.row),f=Math.max(u.row,d.row);if(t.col<0&&t.row>=h&&t.row<=f){r.row=!0,Dce(Wce,this,!0),_ce(Vce,this).eventPageY=e.pageY,_ce(Vce,this).coords=t,_ce(Vce,this).TD=n,Dce(zce,this,this.prepareRowsToMoving());const a=i.holder.scrollLeft+o.getRowHeaderWidth(),s=this.getRowsHeight(h,t.row-1)+(e.clientY-n.getBoundingClientRect().top);_ce(Lce,this).setPosition(null,a),_ce(Lce,this).setSize(i.hider.offsetWidth-a,this.getRowsHeight(h,f)),_ce(Lce,this).setOffset(-s,null),KB(this.hot.rootElement,Fce),this.refreshPositions()}else $B(this.hot.rootElement,Hce),Dce(Wce,this,!1),_ce(zce,this).length=0}function Kce(e){_ce(Wce,this)&&(_ce(Vce,this).eventPageY=e.pageY,this.refreshPositions())}function $ce(e,t,n,r){this.hot.getSelectedRangeActive()&&_ce(Wce,this)&&(_ce(zce,this).indexOf(t.row)>-1?$B(this.hot.rootElement,jce):KB(this.hot.rootElement,jce),r.row=!0,r.column=!0,r.cell=!0,_ce(Vce,this).coords=t,_ce(Vce,this).TD=n)}function Xce(){const e=_ce(Vce,this).row,t=_ce(zce,this).length;if(Dce(Wce,this,!1),$B(this.hot.rootElement,[Fce,jce,Hce]),this.hot.selection.isSelectedByRowHeader()&&KB(this.hot.rootElement,Hce),t<1||void 0===e)return;const n=_ce(zce,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(_ce(zce,this),e);if(_ce(zce,this).length=0,!0===i){this.persistentStateSave(),this.hot.view.adjustElementsSize(),this.hot.render();const e=this.hot.toVisualRow(r),n=e+t-1;this.hot.selectRows(e,n)}}function Qce(){const e=this.hot.view._wt.wtTable,t=this.hot.view._wt.wtViewport.getRowHeaderWidth()+e.holder.scrollLeft;_ce(Lce,this).setPosition(null,t),_ce(Lce,this).setSize(e.hider.offsetWidth-t)}function Jce(){this.moveBySettingsOrLoad()}function Zce(e,t,n){eue(e,t),t.set(e,n)}function eue(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tue(e,t,n){return e.set(rue(e,t),n),n}function nue(e,t){return e.get(rue(e,t))}function rue(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const iue="manualRowResize",oue="manualRowHeights";var aue=new WeakMap,sue=new WeakMap,lue=new WeakMap,cue=new WeakMap,uue=new WeakMap,due=new WeakMap,hue=new WeakMap,fue=new WeakMap,mue=new WeakMap,pue=new WeakMap,gue=new WeakMap,vue=new WeakMap,yue=new WeakMap,bue=new WeakMap,wue=new WeakMap,xue=new WeakMap,Sue=new WeakSet;class Cue extends T5{static get PLUGIN_KEY(){return iue}static get PLUGIN_PRIORITY(){return 30}constructor(e){super(e),function(e,t){eue(e,t),t.add(e)}(this,Sue),Zce(this,aue,null),Zce(this,sue,null),Zce(this,lue,[]),Zce(this,cue,null),Zce(this,uue,null),Zce(this,due,null),Zce(this,hue,null),Zce(this,fue,null),Zce(this,mue,this.hot.rootDocument.createElement("DIV")),Zce(this,pue,this.hot.rootDocument.createElement("DIV")),Zce(this,gue,!1),Zce(this,vue,!1),Zce(this,yue,0),Zce(this,bue,null),Zce(this,wue,void 0),Zce(this,xue,void 0),KB(nue(mue,this),"manualRowResizer"),KB(nue(pue,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[iue]}enablePlugin(){this.enabled||(tue(wue,this,new pK),nue(wue,this).addLocalHook("init",()=>rue(Sue,this,Mue).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,nue(wue,this)),this.addHook("modifyRowHeight",(e,t)=>rue(Sue,this,kue).call(this,e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){tue(xue,this,nue(wue,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",oue,nue(wue,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",oue,e),e.value}setManualSize(e,t){const n=this.hot.toPhysicalRow(e),r=Math.max(t,this.hot.stylesHandler.getDefaultRowHeight());return nue(wue,this).setValueAtIndex(n,r),r}getLastDesiredRowHeight(){return nue(cue,this)}setupHandlePosition(e){if(nue(yue,this)>1)return;tue(aue,this,e);const{view:t}=this.hot,{_wt:n}=t,r=n.wtTable.getCoords(nue(aue,this)),i=r.row;if(i<0)return;const o=gz(nue(aue,this)),a=nue(aue,this).getBoundingClientRect(),s=i<n.getSetting("fixedRowsTop"),l=i>=t.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");let c;s?c=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(nue(aue,this),r.row,r.col):l&&(c=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(nue(aue,this),r.row,r.col)),c||(c=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(nue(aue,this),r.row,r.col)),tue(sue,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(i)),tue(lue,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&u){WH(this.hot.getSelectedRange(),e=>{hV(e.getTopStartCorner().row,e.getBottomStartCorner().row,e=>{nue(lue,this).includes(e)||nue(lue,this).push(e)})})}nue(lue,this).includes(nue(sue,this))||tue(lue,this,[nue(sue,this)]),tue(fue,this,c.top-6),tue(hue,this,parseInt(a.height,10)),nue(mue,this).style.top="".concat(nue(fue,this)+nue(hue,this),"px"),nue(mue,this).style[this.inlineDir]="".concat(c.start,"px"),nue(mue,this).style.width="".concat(o,"px"),this.hot.rootElement.appendChild(nue(mue,this))}refreshHandlePosition(){nue(mue,this).style.top="".concat(nue(fue,this)+nue(cue,this),"px")}setupGuidePosition(){const e=parseInt(gz(nue(mue,this)),10),t=parseInt(nue(mue,this).style[this.inlineDir],10)+e,n=this.hot.view.getTableWidth();KB(nue(mue,this),"active"),KB(nue(pue,this),"active"),nue(pue,this).style.top=nue(mue,this).style.top,nue(pue,this).style[this.inlineDir]="".concat(t,"px"),nue(pue,this).style.width="".concat(n-e,"px"),this.hot.rootElement.appendChild(nue(pue,this))}refreshGuidePosition(){nue(pue,this).style.top=nue(mue,this).style.top}hideHandleAndGuide(){$B(nue(mue,this),"active"),$B(nue(pue,this),"active")}checkIfRowHeader(e){const t=LB(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.TBODY,r.clone.wtTable.TBODY,i.clone.wtTable.TBODY].includes(t)}getClosestTHParent(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return void 0!==t&&nue(uue,this)<t?t:nue(uue,this)}afterMouseDownTimeout(){const e=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},t=(t,n)=>{const r=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!0);void 0!==r&&tue(uue,this,r),this.setManualSize(t,nue(uue,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!0),n&&e()};if(nue(yue,this)>=2){nue(lue,this).length>1?(WH(nue(lue,this),e=>{t(e)}),e()):WH(nue(lue,this),e=>{t(e,!0)})}tue(yue,this,0),tue(bue,this,null)}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",e=>rue(Sue,this,Eue).call(this,e)),this.eventManager.addEventListener(e,"mousedown",e=>rue(Sue,this,Nue).call(this,e)),this.eventManager.addEventListener(t,"mousemove",e=>rue(Sue,this,Tue).call(this,e)),this.eventManager.addEventListener(t,"mouseup",()=>rue(Sue,this,Aue).call(this)),this.eventManager.addEventListener(nue(mue,this),"contextmenu",()=>rue(Sue,this,Rue).call(this))}destroy(){super.destroy()}}function Eue(e){if(!Hz(e.target)&&!0!==nue(vue,this)&&this.checkIfRowHeader(e.target)){const t=this.getClosestTHParent(e.target);t&&(nue(gue,this)||this.setupHandlePosition(t))}}function Nue(e){YB(e.target,"manualRowResizer")&&(this.setupHandlePosition(nue(aue,this)),this.setupGuidePosition(),tue(gue,this,!0),null===nue(bue,this)&&(tue(bue,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(nue(bue,this))),tue(yue,this,nue(yue,this)+1),tue(due,this,e.pageY),tue(uue,this,nue(hue,this)))}function Tue(e){nue(gue,this)&&(tue(cue,this,nue(hue,this)+(e.pageY-nue(due,this))),WH(nue(lue,this),e=>{tue(uue,this,this.setManualSize(e,nue(cue,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Aue(){const e=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},t=(t,n)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!1),n&&e(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!1)};if(nue(gue,this)){if(this.hideHandleAndGuide(),tue(gue,this,!1),nue(uue,this)!==nue(hue,this)){nue(lue,this).length>1?(WH(nue(lue,this),e=>{t(e)}),e()):WH(nue(lue,this),e=>{t(e,!0)})}this.setupHandlePosition(nue(aue,this))}}function Rue(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(nue(mue,this)),this.hot.rootElement.removeChild(nue(pue,this)),tue(gue,this,!1),tue(vue,this,!0),this.hot._registerImmediate(()=>{tue(vue,this,!1)})}function kue(e,t){let n=e;if(this.enabled){const e=this.hot.toPhysicalRow(t),i=nue(wue,this).getValueAtIndex(e);var r;if(this.hot.getSettings()[iue]&&i)n=null!==(r=this.hot.getPlugin("autoRowSize"))&&void 0!==r&&r.isEnabled()?Math.max(i,null!==n&&void 0!==n?n:0):i}return n}function Mue(){const e=this.hot.getSettings()[iue],t=this.loadManualRowHeights();this.hot.batchExecution(()=>{"undefined"!==typeof t?t.forEach((e,t)=>{nue(wue,this).setValueAtIndex(t,e)}):Array.isArray(e)?(e.forEach((e,t)=>{nue(wue,this).setValueAtIndex(t,e)}),tue(xue,this,e)):!0===e&&Array.isArray(nue(xue,this))&&nue(xue,this).forEach((e,t)=>{nue(wue,this).setValueAtIndex(t,e)})},!0)}var Due,_ue,Oue,Iue;n(9494);function Pue(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function jue(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fue(e,t){return e.get(Lue(e,t))}function Hue(e,t,n){return e.set(Lue(e,t),n),n}function Lue(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Bue=new WeakMap;const zue=class{constructor(e,t,n,r,i,o){jue(this,"row",void 0),jue(this,"col",void 0),jue(this,"rowspan",void 0),jue(this,"colspan",void 0),jue(this,"removed",!1),jue(this,"cellCoordsFactory",void 0),jue(this,"cellRangeFactory",void 0),Pue(this,Bue,null),this.row=e,this.col=t,this.rowspan=n,this.colspan=r,this.cellCoordsFactory=i,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:t,col:n,rowspan:r,colspan:i}=e;return ZH(Due||(Due=RH(["The merged cell declared with {row: ",", col: ",", \n      rowspan: ",", colspan: ","} contains negative values, which is \n      not supported. It will not be added to the collection."],["The merged cell declared with {row: ",", col: ",",\\x20\n      rowspan: ",", colspan: ","} contains negative values, which is\\x20\n      not supported. It will not be added to the collection."])),t,n,r,i)}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:t,col:n}=e;return ZH(_ue||(_ue=RH(["The merged cell declared at [",", ","] is positioned \n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."],["The merged cell declared at [",", ","] is positioned\\x20\n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."])),t,n)}static IS_SINGLE_CELL(e){let{row:t,col:n}=e;return ZH(Oue||(Oue=RH(["The merged cell declared at [",", ",'] has both "rowspan" \n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has both "rowspan"\\x20\n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'])),t,n)}static ZERO_SPAN_WARNING(e){let{row:t,col:n}=e;return ZH(Iue||(Iue=RH(["The merged cell declared at [",", ",'] has "rowspan" \n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has "rowspan"\\x20\n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.'])),t,n)}static containsNegativeValues(e){let{row:t,col:n,rowspan:r,colspan:i}=e;return t<0||n<0||r<0||i<0}static isSingleCell(e){let{rowspan:t,colspan:n}=e;return 1===n&&1===t}static containsZeroSpan(e){let{rowspan:t,colspan:n}=e;return 0===n||0===t}static isOutOfBounds(e,t,n){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=n||e.col+e.colspan-1>=n}normalize(e){const t=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col),Hue(Bue,this,null)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const n=e[0]||e[1],r=t+Math.abs(e[0]||e[1])-1,i=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",a=Math.min(t,r),s=Math.max(t,r),l=this[o],c=this[o]+this[i]-1;if(l>=t&&(this[o]+=n),n>0)t<=c&&t>l&&(this[i]+=n);else if(n<0){if(a<=l&&s>=c)return this.removed=!0,Hue(Bue,this,null),!1;if(l>=a&&l<=s){const e=s-l+1,t=Math.abs(n)-e;this[o]-=t+n,this[i]-=e}else if(l<=a&&c>=s)this[i]+=n;else if(l<=a&&c>=a&&c<s){const e=c-a+1;this[i]-=e}}return Hue(Bue,this,null),!0}isFarther(e,t){return!e||("down"===t?e.row+e.rowspan-1<this.row+this.rowspan-1:"up"===t?e.row>this.row:"right"===t?e.col+e.colspan-1<this.col+this.colspan-1:"left"===t?e.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return Fue(Bue,this)||Hue(Bue,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),Fue(Bue,this)}};var Wue;function Vue(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Uue(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function que(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Gue=new WeakSet;class Yue{constructor(e){Vue(this,Gue),Uue(this,"plugin",void 0),Uue(this,"mergedCells",[]),Uue(this,"mergedCellsMatrix",new Map),Uue(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:t,col:n}=e;return ZH(Wue||(Wue=RH(["The merged cell declared at [",", ","], overlaps \n      with the other declared merged cell. The overlapping merged cell was not added to the table, please \n      fix your setup."],["The merged cell declared at [",", ","], overlaps\\x20\n      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20\n      fix your setup."])),t,n)}get(e,t){var n;return!!this.mergedCellsMatrix.has(e)&&(null!==(n=this.mergedCellsMatrix.get(e).get(t))&&void 0!==n&&n)}getByRange(e){const{row:t,col:n}=e.getTopStartCorner(),{row:r,col:i}=e.getBottomEndCorner(),o=this.mergedCells.length;let a=!1;for(let s=0;s<o;s++){const e=this.mergedCells[s],{row:o,col:l,rowspan:c,colspan:u}=e;if(o>=t&&o+c-1<=r&&l>=n&&l+u-1<=i){a=e;break}}return a}filterOverlappingMergeCells(e){const t=new Set;this.mergedCells.forEach(e=>{const{row:n,col:r,colspan:i,rowspan:o}=e;for(let a=n;a<n+o;a++)for(let e=r;e<r+i;e++)t.add("r".concat(a,",c").concat(e))});const n=e.filter(e=>{const{row:n,col:r,colspan:i,rowspan:o}=e,a=new Set;let s=!1;for(let l=n;l<n+o;l++){for(let n=r;n<r+i;n++){const r="r".concat(l,",c").concat(n);if(t.has(r)){hW(Yue.IS_OVERLAPPING_WARNING(e)),s=!0;break}a.add(r)}if(s)break}return s||t.add(...a),!s});return n}getWithinRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),a=[];for(let s=n;s<=i;s++)for(let e=r;e<=o;e++){const n=this.get(s,e);n&&(t||!t&&n.row===s&&n.col===e)&&a.push(n)}return a}add(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.row,r=e.col,i=e.rowspan,o=e.colspan,a=new zue(n,r,i,o,this.hot._createCellCoords,this.hot._createCellRange),s=this.get(n,r),l=!t&&this.isOverlapping(a);return s||l?(l&&hW(Yue.IS_OVERLAPPING_WARNING(a)),!1):(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),que(Gue,this,$ue).call(this,a),a)}remove(e,t){const n=this.get(e,t),r=n?this.mergedCells.indexOf(n):-1;return!(!n||-1===r)&&(this.mergedCells.splice(r,1),que(Gue,this,Xue).call(this,n),n)}clear(){WH(this.mergedCells,e=>{let{row:t,col:n,rowspan:r,colspan:i}=e;hV(t,t+r,e=>{hV(n,n+i,t=>{const n=this.hot.getCell(e,t);n&&(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const t=e.getRange();for(let n=0;n<this.mergedCells.length;n++){if(this.mergedCells[n].getRange().overlaps(t))return!0}return!1}isFirstRenderableMergedCell(e,t){const n=this.get(e,t);if(!n)return!1;const{row:r,col:i,rowspan:o,colspan:a}=n,s=this.hot.view.getActiveOverlayName(),l=["top","top_inline_start_corner"].includes(s)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(s)?0:this.hot.getFirstRenderedVisibleColumn(),u=pV(l,r,r+o-1),d=pV(c,i,i+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(u,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===t}getFirstRenderableCoords(e,t){const n=this.get(e,t);if(!n||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),i=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(r,i)}getStartMostColumnIndex(e,t){const n=que(Gue,this,Kue).call(this,e,"col",-1);let r=t;for(let i=0;i<n.length;i++)if(n[i]<=t){r=n[i];break}return r}getEndMostColumnIndex(e,t){const n=que(Gue,this,Kue).call(this,e,"col",1);let r=t;for(let i=0;i<n.length;i++)if(n[i]>=t){r=n[i];break}return r}getTopMostRowIndex(e,t){const n=que(Gue,this,Kue).call(this,e,"row",-1);let r=t;for(let i=0;i<n.length;i++)if(n[i]<=t){r=n[i];break}return r}getBottomMostRowIndex(e,t){const n=que(Gue,this,Kue).call(this,e,"row",1);let r=t;for(let i=0;i<n.length;i++)if(n[i]>=t){r=n[i];break}return r}shiftCollections(e,t,n){const r=[0,0];switch(e){case"right":r[0]+=n;break;case"left":r[0]-=n;break;case"down":r[1]+=n;break;case"up":r[1]-=n}const i=[];this.mergedCells.forEach(e=>{e.shift(r,t),e.removed&&i.push(e)}),i.forEach(e=>{this.mergedCells.splice(this.mergedCells.indexOf(e),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(e=>{que(Gue,this,$ue).call(this,e)})}}function Kue(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const r=new Map,i=1===n?e.getTopStartCorner():e.getBottomEndCorner(),o=1===n?e.getBottomEndCorner():e.getTopStartCorner();for(let a=i.row;1===n?a<=o.row:a>=o.row;a+=n)for(let e=i.col;1===n?e<=o.col:e>=o.col;e+=n){const i="row"===t?a:e,o=this.get(a,e);let s=i;o&&(s=1===n?o[t]+o["".concat(t,"span")]-1:o[t]),r.has(i)||r.set(i,new Set),r.get(i).add(s)}return Array.from(new Set(Array.from(r.entries()).filter(e=>{let[,t]=e;return 1===t.size}).flatMap(e=>{let[,t]=e;return Array.from(t)})))}function $ue(e){for(let t=e.row;t<e.row+e.rowspan;t++)for(let n=e.col;n<e.col+e.colspan;n++)this.mergedCellsMatrix.has(t)||this.mergedCellsMatrix.set(t,new Map),this.mergedCellsMatrix.get(t).set(n,e)}function Xue(e){for(let t=e.row;t<e.row+e.rowspan;t++)for(let n=e.col;n<e.col+e.colspan;n++)this.mergedCellsMatrix.get(t).delete(n)}const Que=Yue;function Jue(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Zue=class{constructor(e){Jue(this,"plugin",void 0),Jue(this,"mergedCellsCollection",void 0),Jue(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,t){let n=null;return n=t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?"down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?"up":t[1]===e[1]&&t[2]===e[2]?"right":"left",n}snapDragArea(e,t,n,r){const i=t.slice(0),o=this.getAutofillSize(e,t,n),[a,s,l,c]=e,u=["up","down"].indexOf(n)>-1?l-a+1:c-s+1,d=o-Math.floor(o/u)*u,h=this.getFarthestCollection(e,t,n,r);if(h)if("down"===n){const e=h.row+h.rowspan-a-d;i[2]+e>=this.plugin.hot.countRows()?i[2]-=d:i[2]+=d?e:0}else if("right"===n){const e=h.col+h.colspan-s-d;i[3]+e>=this.plugin.hot.countCols()?i[3]-=d:i[3]+=d?e:0}else if("up"===n){const e=l-d-h.row+1;i[0]+e<0?i[0]+=d:i[0]-=d?e:0}else if("left"===n){const e=c-d-h.col+1;i[1]+e<0?i[1]+=d:i[1]-=d?e:0}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:r,fillSize:o,dragArea:i,cycleLength:u}),i}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),$L(this.currentFillData,e)}getAutofillSize(e,t,n){const[r,i,o,a]=e,[s,l,c,u]=t;switch(n){case"up":return r-s;case"down":return c-o;case"left":return i-l;case"right":return u-a;default:return null}}getDragArea(e,t,n){const[r,i,o,a]=e,[s,l,c,u]=t;switch(n){case"up":return[s,l,r-1,a];case"down":{const e=this.mergedCellsCollection.get(c,a);return[o+1,i,c+(e?e.rowspan-1:0),a]}case"left":return[s,l,o,i-1];case"right":{const e=this.mergedCellsCollection.get(c,a);return[r,a+(e?e.colspan-1:0),c,u]}default:return null}}getFarthestCollection(e,t,n,r){const[i,o,a,s]=e,l=["up","down"].indexOf(n)>-1,c=l?a:s,u=l?i:o,d=this.getAutofillSize(e,t,n),h=l?a-i+1:s-o+1,f=d-Math.floor(d/h)*h;let m=null,p=null,g=null;switch(n){case"up":m="includesVertically",g=c-f+1;break;case"left":m="includesHorizontally",g=c-f+1;break;case"down":m="includesVertically",g=u+f-1;break;case"right":m="includesHorizontally",g=u+f-1}return WH(r,e=>{e[m](g)&&e.isFarther(p,n)&&(p=e)}),p}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,i=(e,n)=>{switch(r){case"up":return e.row-n>=t.from.row;case"down":return e.row+e.rowspan-1+n<=t.to.row;case"left":return e.col-n>=t.from.column;case"right":return e.col+e.colspan-1+n<=t.to.column;default:return null}};let o=0,a=null,s=1;do{for(let e=0;e<n.length;e+=1){if(a=n[e],o=s*this.currentFillData.cycleLength,i(a,o))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:a.row-o,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+o,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-o,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+o,colspan:a.colspan},!0)}e===n.length-1&&(s+=1)}}while(i(a,o));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},n={min:null,max:null};return WH(e,e=>{const r=e[0],i=this.plugin.hot.propToCol(e[1]);(null===t.min||r<t.min)&&(t.min=r),(null===t.max||r>t.max)&&(t.max=r),(null===n.min||i<n.min)&&(n.min=i),(null===n.max||i>n.max)&&(n.max=i)}),{from:{row:t.min,column:n.min},to:{row:t.max,column:n.max}}}dragAreaOverlapsCollections(e,t,n){const r=this.getDragArea(e,t,n),[i,o,a,s]=r,l=this.plugin.hot._createCellCoords(i,o),c=this.plugin.hot._createCellCoords(a,s),u=this.plugin.hot._createCellRange(l,l,c);if(0===this.mergedCellsCollection.getWithinRange(u,!0).length)return!1;const d=this.mergedCellsCollection.getWithinRange(u,!1);return 0===d.length||("up"===n||"down"===n?!d.every(e=>{let{colspan:t}=e;return t===u.getWidth()}):!d.every(e=>{let{rowspan:t}=e;return t===u.getHeight()}))}};function ede(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const tde=class{constructor(e){ede(this,"plugin",void 0),ede(this,"hot",void 0),ede(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,t,n,r){const i=Math.min(n[0],n[2]),o=Math.min(n[1],n[3]),a=Math.max(n[0],n[2]),s=Math.max(n[1],n[3]);if(void 0===r)return;if(!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const l=this.plugin.mergedCellsCollection.get(e,t);if(!l)return;const c=l.getLastRow(),u=l.getLastColumn();return i<=l.row&&o<=l.col&&a>=c&&s>=u?"".concat(this.fullySelectedMergedCellClassName,"-").concat(r):this.isMergeCellFullySelected(l,this.plugin.hot.getSelectedRange())?"".concat(this.fullySelectedMergedCellClassName,"-multiple"):void 0}isMergeCellFullySelected(e,t){const n=[];if(!t||!e)return!1;for(let r=0;r<e.rowspan;r+=1)for(let t=0;t<e.colspan;t+=1)n.push(this.hot._createCellCoords(e.row+r,e.col+t));for(let r=0;r<n.length;r+=1){const e=[];for(let i=0;i<t.length;i+=1)e[i]=t[i].includes(n[r]);if(!e.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(t));return e.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),e}};function nde(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class rde{constructor(e){nde(this,"data",void 0),nde(this,"next",null),nde(this,"prev",null),this.data=e}}const ide=class{constructor(){nde(this,"first",null),nde(this,"last",null)}push(e){const t=new rde(e);if(null===this.first)this.first=t,this.last=t;else{const e=this.last;this.last=t,t.prev=e,e.next=t}return t}unshift(e){const t=new rde(e);if(null===this.first)this.first=t,this.last=t;else{const e=this.first;this.first=t,t.next=e,e.prev=t}}inorder(e){let t=this.first;for(;t;){const n=e(t);if(t===this.last||!0===n)break;t=t.next}}remove(e){if(null===this.first)return!1;let t,n,r=this.first;for(;r;){if(r.data===e)return t=r.next,n=r.prev,t&&(t.prev=n),n&&(n.next=t),r===this.first&&(this.first=t),r===this.last&&(this.last=n),!0;r=r.next}return!1}hasCycle(){let e=this.first,t=this.first;for(;;){if(null===e)return!1;if(e=e.next,null===e)return!1;if(e=e.next,t=t.next,e===t)return!0}}pop(){if(null===this.last)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(null===this.first)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){if(!this.first)return;!function e(t,n){n&&(e(n,n.next),n.next=t)}(this.first,this.first.next),this.first.next=null;const e=this.first;this.first=this.last,this.last=e}reverse(){if(!this.first||!this.first.next)return;let e,t=this.first.next,n=this.first;for(;t;)e=t.next,t.next=n,n.prev=t,n=t,t=e;this.first.next=null,this.last.prev=null,e=this.first,this.first=n,this.last=e}};function ode(e,t,n){ade(e,t),t.set(e,n)}function ade(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sde(e,t){return e.get(cde(e,t))}function lde(e,t,n){return e.set(cde(e,t),n),n}function cde(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var ude=new WeakMap,dde=new WeakMap,hde=new WeakMap,fde=new WeakMap,mde=new WeakMap,pde=new WeakMap,gde=new WeakMap,vde=new WeakSet;class yde{constructor(e){let{mergedCellsGetter:t,rowIndexMapper:n,columnIndexMapper:r}=e;!function(e,t){ade(e,t),t.add(e)}(this,vde),ode(this,ude,new ide),ode(this,dde,new ide),ode(this,hde,null),ode(this,fde,null),ode(this,mde,null),ode(this,pde,null),ode(this,gde,null),lde(mde,this,t),lde(pde,this,n),lde(gde,this,r)}getCurrentVerticalNode(){return sde(fde,this).data}getFirstVerticalNode(){return sde(dde,this).first.data}getNextVerticalNode(){return sde(fde,this).next.data}getPrevVerticalNode(){return sde(fde,this).prev.data}getCurrentHorizontalNode(){return sde(hde,this).data}getFirstHorizontalNode(){return sde(ude,this).first.data}getNextHorizontalNode(){return sde(hde,this).next.data}getPrevHorizontalNode(){return sde(hde,this).prev.data}setPrevNodeAsActive(){lde(fde,this,sde(fde,this).prev),lde(hde,this,sde(hde,this).prev)}setNextNodeAsActive(){lde(fde,this,sde(fde,this).next),lde(hde,this,sde(hde,this).next)}buildFocusOrder(e){lde(ude,this,new ide),e.forEach((e,t)=>{const n=new WeakSet,r=e.getTopStartCorner(),i=e.getBottomEndCorner();for(let o=r.row;o<=i.row;o++)if(!sde(pde,this).isHidden(o))for(let a=r.col;a<=i.col;a++){if(sde(gde,this).isHidden(a))continue;const r=cde(vde,this,bde).call(this,{selectedRange:e,selectionLayer:t,listOrder:sde(ude,this),mergeCellsVisitor:n,row:o,column:a});r&&lde(hde,this,r)}}),sde(ude,this).first&&(sde(ude,this).first.prev=sde(ude,this).last,sde(ude,this).last.next=sde(ude,this).first),lde(dde,this,new ide),e.forEach((e,t)=>{const n=new WeakSet,r=e.getTopStartCorner(),i=e.getBottomEndCorner();for(let o=r.col;o<=i.col;o++)if(!sde(gde,this).isHidden(o))for(let a=r.row;a<=i.row;a++){if(sde(pde,this).isHidden(a))continue;const r=cde(vde,this,bde).call(this,{selectedRange:e,selectionLayer:t,listOrder:sde(dde,this),mergeCellsVisitor:n,row:a,column:o});r&&lde(fde,this,r)}}),sde(dde,this).first&&(sde(dde,this).first.prev=sde(dde,this).last,sde(dde,this).last.next=sde(dde,this).first)}setActiveNode(e,t,n){return sde(ude,this).inorder(r=>{const{selectionLayer:i,rowStart:o,rowEnd:a,colStart:s,colEnd:l}=r.data;if(i===n&&e>=o&&e<=a&&t>=s&&t<=l)return lde(hde,this,r),!0}),sde(dde,this).inorder(r=>{const{selectionLayer:i,rowStart:o,rowEnd:a,colStart:s,colEnd:l}=r.data;if(i===n&&e>=o&&e<=a&&t>=s&&t<=l)return lde(fde,this,r),!0}),this}}function bde(e){let{selectedRange:t,selectionLayer:n,listOrder:r,mergeCellsVisitor:i,row:o,column:a}=e;const s=t.getTopStartCorner(),l=t.getBottomEndCorner(),c=t.highlight.clone().normalize(),u=sde(mde,this).call(this,o,a);if(u&&i.has(u))return null;const d={selectionLayer:n,colStart:a,colEnd:a,rowStart:o,rowEnd:o};if(u){if(i.add(u),u.row<s.row||u.row+u.rowspan-1>l.row||u.col<s.col||u.col+u.colspan-1>l.col)return null;d.colStart=u.col,d.colEnd=u.col+u.colspan-1,d.rowStart=u.row,d.rowEnd=u.row+u.rowspan-1}const h=r.push(d);return o===c.row&&a===c.col||u&&c.row>=u.row&&c.row<=u.row+u.rowspan-1&&c.col>=u.col&&c.col<=u.col+u.colspan-1?h:null}function wde(e,t,n){const{rowIndexMapper:r,stylesHandler:i}=e;let o=0;for(let s=t;s<t+n;s++){var a;if(!r.isHidden(s))o+=null!==(a=e.getRowHeight(s))&&void 0!==a?a:i.getDefaultRowHeight(s)}return o}function xde(e,t,n){Sde(e,t),t.set(e,n)}function Sde(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cde(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ede(e,t,n){return e.set(Tde(e,t),n),n}function Nde(e,t){return e.get(Tde(e,t))}function Tde(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}_W.getSingleton().register("beforeMergeCells"),_W.getSingleton().register("afterMergeCells"),_W.getSingleton().register("beforeUnmergeCells"),_W.getSingleton().register("afterUnmergeCells");const Ade="mergeCells",Rde=Ade;var kde=new WeakMap,Mde=new WeakMap,Dde=new WeakMap,_de=new WeakMap,Ode=new WeakSet;class Ide extends T5{constructor(){super(...arguments),function(e,t){Sde(e,t),t.add(e)}(this,Ode),Cde(this,"mergedCellsCollection",null),Cde(this,"autofillCalculations",null),Cde(this,"selectionCalculations",null),xde(this,kde,null),xde(this,Mde,{row:0,col:0}),xde(this,Dde,new yde({mergedCellsGetter:(e,t)=>this.mergedCellsCollection.get(e,t),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),xde(this,_de,function(e){const{hot:t}=e,{rowIndexMapper:n,columnIndexMapper:r}=t,i=new Map;return{before:function(){},after:function(o,a,s){const l=e.mergedCellsCollection.get(a,s);if(!tB(l))return o.removeAttribute("rowspan"),o.removeAttribute("colspan"),i.has(a)&&!t.getSettings().rowHeaders&&(o.style.height="".concat(i.get(a),"px"),i.delete(a)),void(o.style.display="");const{row:c,col:u,colspan:d,rowspan:h}=l,[f,m]=e.translateMergedCellToRenderable(c,h,u,d),p=e.getSetting("virtualized");if(0===u&&!t.getSettings().rowHeaders){const e=t._getRowHeightFromSettings(a);if(void 0!==e){const n=t.stylesHandler.areCellsBorderBox()?0:1;i.set(a,e-n)}else if(NB()){const e=wde(t,c,h);i.set(a,e/h)}}const g=f-n.getRenderableFromVisualIndex(a)+1,v=m-r.getRenderableFromVisualIndex(s)+1;let y=n.getNearestNotHiddenIndex(c,1),b=r.getNearestNotHiddenIndex(u,1);if(p){const e=t.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(e)||(y=Math.max(y,t.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(e)||(b=Math.max(b,t.getFirstRenderedVisibleColumn()))}const w=Math.min(h,g),x=Math.min(d,v);y===a&&b===s?(o.setAttribute("rowspan",w),o.setAttribute("colspan",x)):(o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="none")}}}(this))}static get PLUGIN_KEY(){return Ade}static get PLUGIN_PRIORITY(){return 150}static get DEFAULT_SETTINGS(){return{[w5]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[Ade]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Que(this),this.autofillCalculations=new Zue(this),this.selectionCalculations=new tde(this),this.addHook("afterInit",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,Pde).call(e,...n)}),this.addHook("modifyTransformFocus",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,Fde).call(e,...n)}),this.addHook("modifyTransformStart",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,Hde).call(e,...n)}),this.addHook("modifyTransformEnd",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,Lde).call(e,...n)}),this.addHook("beforeSelectionHighlightSet",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,Bde).call(e,...n)}),this.addHook("beforeSetRangeStart",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,Vde).call(e,...n)}),this.addHook("beforeSetRangeStartOnly",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,Vde).call(e,...n)}),this.addHook("beforeSelectionFocusSet",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,Ude).call(e,...n)}),this.addHook("afterSelectionFocusSet",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,qde).call(e,...n)}),this.addHook("afterSelectionEnd",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,Gde).call(e,...n)}),this.addHook("modifyGetCellCoords",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,zde).call(e,...n)}),this.addHook("modifyGetCoordsElement",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,zde).call(e,...n)}),this.addHook("afterIsMultipleSelection",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,jde).call(e,...n)}),this.addHook("afterRenderer",function(){return Nde(_de,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,Wde).call(e,...n)}),this.addHook("afterGetCellMeta",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,Yde).call(e,...n)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,Kde).call(e,...n)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,$de).call(e,...n)}),this.addHook("modifyAutofillRange",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,Xde).call(e,...n)}),this.addHook("afterCreateCol",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,Qde).call(e,...n)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,Jde).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,Zde).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,ehe).call(e,...n)}),this.addHook("afterChange",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,the).call(e,...n)}),this.addHook("beforeDrawBorders",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,nhe).call(e,...n)}),this.addHook("afterDrawSelection",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,rhe).call(e,...n)}),this.addHook("beforeRemoveCellClassNames",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,ihe).call(e,...n)}),this.addHook("beforeBeginEditing",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,ohe).call(e,...n)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Tde(Ode,e,ahe).call(e,...n)}),this.addHook("beforeUndoStackChange",(e,t)=>{if("MergeCells"===t)return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!xB())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach(e=>{const{row:n,rowspan:r}=e;for(let i=n+1;i<n+r;i++)t.push(i)}),t=[...new Set(t)],t.forEach(t=>{const n=this.hot.rowIndexMapper.getRenderableFromVisualIndex(t);this.hot.view._wt.wtOverlays.getOverlays(!0).map(e=>"master"===(null===e||void 0===e?void 0:e.name)?e:e.clone.wtTable).forEach(t=>{const r=t.getRow(n);r&&(r.style.background=mz(r,"backgroundColor").replace(")",", 0.99)"),e.push(r))})}),this.hot._registerTimeout(()=>{e.forEach(e=>{var t;e.style.background=null===(t=mz(e,"backgroundColor"))||void 0===t?void 0:t.replace(", 0.99)",")")})},1)}validateSetting(e){return!!e&&(zue.containsNegativeValues(e)?(hW(zue.NEGATIVE_VALUES_WARNING(e)),!1):zue.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(hW(zue.IS_OUT_OF_BOUNDS_WARNING(e)),!1):zue.isSingleCell(e)?(hW(zue.IS_SINGLE_CELL(e)),!1):!zue.containsZeroSpan(e)||(hW(zue.ZERO_SPAN_WARNING(e)),!1))}generateFromSettings(){const e=this.getSetting("cells").filter(e=>this.validateSetting(e)),t=this.mergedCellsCollection.filterOverlappingMergeCells(e),n=[];t.forEach(e=>{const{row:t,col:r,rowspan:i,colspan:o}=e,a=this.hot._createCellCoords(t,r),s=this.hot._createCellCoords(t+i-1,r+o-1),l=this.hot._createCellRange(a,a,s);this.mergeRange(l,!0,!0);for(let c=t;c<t+i;c++)for(let e=r;e<r+o;e++)c===t&&e===r||n.push([c,e,null])}),0!==n.length&&this.hot.setDataAtCell(n,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return!!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeActive();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:n}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}unmergeSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeActive();if(!e)return;const{from:t,to:n}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}mergeRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=e.getTopStartCorner(),i=e.getBottomEndCorner(),o={row:r.row,col:r.col,rowspan:i.row-r.row+1,colspan:i.col-r.col+1},a=[];let s=null;if(!this.canMergeRange(o,t))return!1;this.hot.runHooks("beforeMergeCells",e,t),hV(0,o.rowspan-1,e=>{hV(0,o.colspan-1,t=>{let n=null;a[e]||(a[e]=[]),0===e&&0===t?n=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+e,o.col+t,"hidden",!0),a[e][t]=n})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0);return!this.mergedCellsCollection.add(o,t)||(n?s=[o.row,o.col,a]:this.hot.populateFromArray(o.row,o.col,a,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,t),s)}unmergeRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.mergedCellsCollection.getWithinRange(e);0!==n.length&&(this.hot.runHooks("beforeUnmergeCells",e,t),WH(n,e=>{this.mergedCellsCollection.remove(e.row,e.col),hV(0,e.rowspan-1,t=>{hV(0,e.colspan-1,n=>{this.hot.removeCellMeta(e.row+t,e.col+n,"hidden"),this.hot.removeCellMeta(e.row+t,e.col+n,"copyable")})}),this.hot.removeCellMeta(e.row,e.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const{from:t,to:n}=e.clone().normalize(),r=this.mergedCellsCollection.get(t.row,t.col);r.row===t.row&&r.col===t.col&&r.row+r.rowspan-1===n.row&&r.col+r.colspan-1===n.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,n,r){const i=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(n,r);this.mergeRange(this.hot._createCellRange(i,i,o))}unmerge(e,t,n,r){const i=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(n,r);this.unmergeRange(this.hot._createCellRange(i,i,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const e=this.hot.getSelectedRangeActive();e&&!e.isSingleHeader()&&(this.toggleMerge(e),this.hot.render())},runOnlyIf:e=>!e.altKey,group:Rde})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Rde)}modifyViewportRowStart(e,t){const n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(e.startRow);for(let i=0;i<t;i+=1){const o=this.mergedCellsCollection.get(r,i);if(tB(o)){const r=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.row,1));if(r<e.startRow)return e.startRow=r,void this.modifyViewportRowStart(e,t)}}}modifyViewportRowEnd(e,t){const n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(e.endRow);for(let i=0;i<t;i+=1){const o=this.mergedCellsCollection.get(r,i);if(tB(o)){const r=o.row+o.rowspan-1,i=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1));if(i>e.endRow)return e.endRow=i,void this.modifyViewportRowEnd(e,t)}}}modifyViewportColumnStart(e,t){const n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(e.startColumn);for(let i=0;i<t;i+=1){const o=this.mergedCellsCollection.get(i,r);if(tB(o)){const r=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.col,1));if(r<e.startColumn)return e.startColumn=r,void this.modifyViewportColumnStart(e,t)}}}modifyViewportColumnEnd(e,t){const n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(e.endColumn);for(let i=0;i<t;i+=1){const o=this.mergedCellsCollection.get(i,r);if(tB(o)){const r=o.col+o.colspan-1,i=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1));if(i>e.endColumn)return e.endColumn=i,void this.modifyViewportColumnEnd(e,t)}}}translateMergedCellToRenderable(e,t,n,r){const{rowIndexMapper:i,columnIndexMapper:o}=this.hot;let a,s;a=0===t?i.getNearestNotHiddenIndex(e,1):i.getNearestNotHiddenIndex(e+t-1,-1),s=0===r?o.getNearestNotHiddenIndex(n,1):o.getNearestNotHiddenIndex(n+r-1,-1);return[e>=0?i.getRenderableFromVisualIndex(a):e,n>=0?o.getRenderableFromVisualIndex(s):n]}}function Pde(){this.generateFromSettings(),this.hot.render()}function jde(e){if(e){const e=this.mergedCellsCollection.mergedCells,t=this.hot.getSelectedRangeActive(),n=t.getTopStartCorner(),r=t.getBottomEndCorner();for(let i=0;i<e.length;i+=1)if(n.row===e[i].row&&n.col===e[i].col&&r.row===e[i].row+e[i].rowspan-1&&r.col===e[i].col+e[i].colspan-1)return!1}return e}function Fde(e){Nde(Mde,this).row=e.row,Nde(Mde,this).col=e.col}function Hde(e){const t=this.hot.getSelectedRangeActive(),{highlight:n}=t,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;Nde(kde,this)&&(null!==i.getRenderableFromVisualIndex(Nde(kde,this).row)&&(n.row=Nde(kde,this).row),null!==r.getRenderableFromVisualIndex(Nde(kde,this).col)&&(n.col=Nde(kde,this).col),Ede(kde,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const a=o.col,s=o.col+o.colspan-1;if(e.col<0){const t=n.col>=a&&n.col<=s?a-1:s,i=r.getNearestNotHiddenIndex(t,-1);e.col=null===i?-this.hot.view.countRenderableColumnsInRange(0,n.col):-Math.max(this.hot.view.countRenderableColumnsInRange(i,n.col)-1,1)}else if(e.col>0){const t=n.col>=a&&n.col<=s?s+1:a,i=r.getNearestNotHiddenIndex(t,1);e.col=null===i?this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(n.col,i)-1,1)}const l=o.row,c=o.row+o.rowspan-1;if(e.row<0){const t=n.row>=l&&n.row<=c?l-1:c,r=i.getNearestNotHiddenIndex(t,-1);e.row=null===r?-this.hot.view.countRenderableRowsInRange(0,n.row):-Math.max(this.hot.view.countRenderableRowsInRange(r,n.row)-1,1)}else if(e.row>0){const t=n.row>=l&&n.row<=c?c+1:l,r=i.getNearestNotHiddenIndex(t,1);e.row=null===r?this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):Math.max(this.hot.view.countRenderableRowsInRange(n.row,r)-1,1)}}function Lde(e){const t=this.hot.getSelectedRangeActive(),n=t.clone(),{to:r}=t,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,a=(e,t)=>{n.expand(this.hot._createCellCoords(e,t));for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange())};if(e.col<0){let o=this.mergedCellsCollection.getStartMostColumnIndex(t,r.col)+e.col;a(r.row,o),"E-W"===t.getHorizontalDirection()&&"E-W"===n.getHorizontalDirection()&&(o=n.getTopStartCorner().col);const s=i.getNearestNotHiddenIndex(o,1);null!==s&&(e.col=-Math.max(this.hot.view.countRenderableColumnsInRange(s,r.col)-1,1))}else if(e.col>0){let o=this.mergedCellsCollection.getEndMostColumnIndex(t,r.col)+e.col;a(r.row,o),"W-E"===t.getHorizontalDirection()&&"W-E"===n.getHorizontalDirection()&&(o=n.getBottomEndCorner().col);const s=i.getNearestNotHiddenIndex(o,-1);null!==s&&(e.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,s)-1,1))}if(e.row<0){let i=this.mergedCellsCollection.getTopMostRowIndex(t,r.row)+e.row;a(i,r.col),"S-N"===t.getVerticalDirection()&&"S-N"===n.getVerticalDirection()&&(i=n.getTopStartCorner().row);const s=o.getNearestNotHiddenIndex(i,1);null!==s&&(e.row=-Math.max(this.hot.view.countRenderableRowsInRange(s,r.row)-1,1))}else if(e.row>0){let i=this.mergedCellsCollection.getBottomMostRowIndex(t,r.row)+e.row;a(i,r.col),"N-S"===t.getVerticalDirection()&&"N-S"===n.getVerticalDirection()&&(i=n.getBottomStartCorner().row);const s=o.getNearestNotHiddenIndex(i,-1);null!==s&&(e.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,s)-1,1))}}function Bde(){const e=this.hot.getSelectedRangeLast(),{highlight:t}=e;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader())return void Ede(kde,this,t.clone());for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)e.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)e.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(t.row,t.col);Ede(kde,this,t.clone()),n&&t.assign(n)}function zde(e,t,n,r){if(e<0||t<0)return;const i=this.mergedCellsCollection.get(e,t);if(!i)return;const{row:o,col:a,colspan:s,rowspan:l}=i,c=o,u=a,d=o+l-1,h=a+s-1;if("render"===r&&this.getSetting("virtualized")){const e=this.hot.view.getActiveOverlayName(),t=["top","top_inline_start_corner"].includes(e)?0:this.hot.getFirstRenderedVisibleRow(),n=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(e)?0:this.hot.getFirstRenderedVisibleColumn();return[pV(t,c,d),pV(n,u,h),pV(this.hot.getLastRenderedVisibleRow(),c,d),pV(this.hot.getLastRenderedVisibleColumn(),u,h)]}return[c,u,d,h]}function Wde(e){var t;e.items.push({name:"---------"},(t=this,{key:"mergeCells",name(){const e=this.getSelectedActive();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(b$)}return this.getTranslatedPhrase(y$)},callback(){const e=this.getSelectedRangeActive();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedActive();return!e||zue.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}))}function Vde(){Ede(kde,this,null)}function Ude(){if(Nde(kde,this).isCell())return;const e=this.hot.getSelectedRangeActive(),t=e.getVerticalDirection(),n=e.getHorizontalDirection(),r=Nde(kde,this).clone().normalize();Nde(Dde,this).setActiveNode(r.row,r.col),Nde(Mde,this).row>0||Nde(Mde,this).col>0?Nde(Dde,this).setPrevNodeAsActive():("E-W"===n&&Nde(Mde,this).col<0||"S-N"===t&&Nde(Mde,this).row<0)&&Nde(Dde,this).setNextNodeAsActive()}function qde(e,t){const{columnIndexMapper:n,rowIndexMapper:r}=this.hot;let i=this.hot.getActiveSelectionLayerIndex(),o=null,a=null;if(Nde(Mde,this).col<0){const{rowEnd:e,colEnd:t,selectionLayer:s}=Nde(Dde,this).getPrevHorizontalNode();a=n.getNearestNotHiddenIndex(t,-1),o=r.getNearestNotHiddenIndex(e,-1),i=s}else if(Nde(Mde,this).col>0){const{rowStart:e,colStart:t,selectionLayer:s}=Nde(Dde,this).getNextHorizontalNode();a=n.getNearestNotHiddenIndex(t,1),o=r.getNearestNotHiddenIndex(e,1),i=s}else if(Nde(Mde,this).row<0){const{rowEnd:e,colEnd:t,selectionLayer:s}=Nde(Dde,this).getPrevVerticalNode();a=n.getNearestNotHiddenIndex(t,-1),o=r.getNearestNotHiddenIndex(e,-1),i=s}else if(Nde(Mde,this).row>0){const{rowStart:e,colStart:t,selectionLayer:s}=Nde(Dde,this).getNextVerticalNode();a=n.getNearestNotHiddenIndex(t,1),o=r.getNearestNotHiddenIndex(e,1),i=s}if(null!==o||null!==a){this.hot.selection.setActiveSelectionLayerIndex(i);const n=this.hot.getSelectedRangeActive(),r=this.hot._createCellCoords(o,a),s=this.mergedCellsCollection.get(r.row,r.col),l=this.hot.selection.highlight.getFocus();e=r.row,t=r.col,s?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(s.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(s.col,1)}):n.highlight.assign(r),l.clear(),l.add(r).commit()}Nde(Dde,this).setActiveNode(e,t,i),Ede(Mde,this,{row:0,col:0})}function Gde(){Nde(Dde,this).buildFocusOrder(this.hot.getSelectedRange())}function Yde(e,t,n){const r=this.mergedCellsCollection.get(e,t);r&&(r.row!==e||r.col!==t?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function Kde(e){if(this.getSetting("virtualized"))return;const t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}function $de(e){if(this.getSetting("virtualized"))return;const t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}function Xde(e,t){const n=this.autofillCalculations.getDirection(t,e);if(this.autofillCalculations.dragAreaOverlapsCollections(t,e,n))return t;const r=this.hot._createCellCoords(t[0],t[1]),i=this.hot._createCellCoords(t[2],t[3]),o=this.hot._createCellRange(r,r,i),a=this.mergedCellsCollection.getWithinRange(o);return 0===a.length?e:this.autofillCalculations.snapDragArea(t,e,n,a)}function Qde(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}function Jde(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}function Zde(e,t,n){"auto"!==n&&this.mergedCellsCollection.shiftCollections("down",e,t)}function ehe(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}function the(e,t){"Autofill.fill"===t&&this.autofillCalculations.recreateAfterDataPopulation(e)}function nhe(e,t){if(t&&"area"===t){const t=this.hot.getSelectedRangeActive();WH(this.mergedCellsCollection.getWithinRange(t),n=>{t.getBottomEndCorner().row===n.getLastRow()&&t.getBottomEndCorner().col===n.getLastColumn()&&(e[2]=n.row,e[3]=n.col)})}}function rhe(e,t,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,n,r)}function ihe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function ohe(e,t,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeActive(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const a=this.hot._createCellCoords(o.row,o.col),s=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return 0===this.hot.selection.getLayerLevel()&&i.isEqual(this.hot._createCellRange(a,a,s))}function ahe(e,t,n){if(this.hot.getSettings().rowHeaders||"bottom"===n||"bottom_inline_start_corner"===n)return e;let r,i;if("master"===n)r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const e=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(t,r))return e;const o=this.hot._createCellCoords(t,r),a=this.hot._createCellCoords(t,i),s=this.hot._createCellRange(o,o,a),l=this.mergedCellsCollection.getWithinRange(s,!0),c=l.reduce((e,t)=>{let{rowspan:n}=t;return Math.max(e,n)},1);let u=0;return l.length>1&&l[0].rowspan<c&&(u=c-l[0].rowspan),l.forEach(r=>{let{rowspan:i}=r,o=0;o="top"===n||"top_inline_start_corner"===n?Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-t):i-u,e=Math.max(null!==e&&void 0!==e?e:0,wde(this.hot,t,o))}),e}const she="sort";function lhe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const che="multiColumnSorting",uhe=che;S8(che,function(e,t){return function(n,r){const[,...i]=n,[,...o]=r;return function n(r){const a=e[r],s=t[r],l=i[r],c=o[r],u=s.multiColumnSorting,d=(u.compareFunctionFactory?u.compareFunctionFactory:E8(s.type))(a,s,u)(l,c);if(d===N8){const e=r+1;if("undefined"!==typeof t[e])return n(e)}return d}(0)}});class dhe extends J8{constructor(){super(...arguments),lhe(this,"pluginKey",che)}static get PLUGIN_KEY(){return che}static get PLUGIN_PRIORITY(){return 170}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();return-1===e.row&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,K8)),!1},runOnlyIf:()=>{var e,t;const n=null===(e=this.hot.getSelectedRangeActive())||void 0===e?void 0:e.highlight;return n&&(null===(t=this.hot.getSelectedRangeActive())||void 0===t?void 0:t.isSingle())&&this.hot.selection.isCellVisible(n)&&n.isHeader()},relativeToGroup:ZZ,position:"before",group:uhe})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(uhe)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];super.updateHeaderClasses(e,...n),$B(e,function(e){const t=e.className.split(" "),n=new RegExp("^".concat(she,"-[0-9]{1,2}$"));return t.filter(e=>n.test(e))}(e)),!1!==this.enabled&&KB(e,function(e,t,n){const r=[];return!1===n||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&r.push("".concat(she,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),r}(...n))}onAfterOnCellMouseDown(e,t){!1!==j8(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,K8))):this.sort(this.getColumnNextConfig(t.col)))}}function hhe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class fhe extends T5{constructor(){super(...arguments),hhe(this,"dragged",[]),hhe(this,"lastSetCell",null)}static get PLUGIN_KEY(){return"multipleSelectionHandles"}static get PLUGIN_PRIORITY(){return 160}isEnabled(){return RB()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function n(t){if(1===e.dragged.length)return e.dragged.splice(0,e.dragged.length),!0;const n=e.dragged.indexOf(t);if(-1===n)return!1;0===n?e.dragged=e.dragged.slice(0,1):1===n&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",t=>{let n;return YB(t.target,"topSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeActive(),e.dragged.push("top"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):YB(t.target,"bottomSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeActive(),e.dragged.push("bottom"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):void 0}),this.eventManager.addEventListener(t,"touchend",t=>YB(t.target,"topSelectionHandle-HitArea")?(n.call(e,"top"),e.touchStartRange=void 0,t.preventDefault(),!1):YB(t.target,"bottomSelectionHandle-HitArea")?(n.call(e,"bottom"),e.touchStartRange=void 0,t.preventDefault(),!1):void 0),this.eventManager.addEventListener(t,"touchmove",t=>{const{rootDocument:n}=this.hot;let r,i,o,a,s,l;if(0===e.dragged.length)return;const c=n.elementFromPoint(t.touches[0].clientX,t.touches[0].clientY);c&&c!==e.lastSetCell&&("TD"!==c.nodeName&&"TH"!==c.nodeName||(r=e.hot.getCoords(c),-1===r.col&&(r.col=0),i=e.hot.getSelectedRangeActive(),o=i.getWidth(),a=i.getHeight(),s=i.getDirection(),1===o&&1===a&&e.hot.selection.setRangeEnd(r),l=e.getCurrentRangeCoords(i,r,e.touchStartRange.direction,s,e.dragged[0]),null!==l.start&&e.hot.selection.setRangeStart(l.start),e.hot.selection.setRangeEnd(l.end),e.lastSetCell=c),t.preventDefault())})}getCurrentRangeCoords(e,t,n,r,i){const o=e.getTopStartCorner(),a=e.getBottomEndCorner(),s=e.getBottomStartCorner(),l=e.getTopEndCorner();let c={start:null,end:null};switch(n){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":c="top"===i?{start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(s.row,t.col)}:{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,o.col)};break;case"SE-NW":"bottom"===i&&(c={start:this.hot._createCellCoords(a.row,t.col),end:this.hot._createCellCoords(t.row,o.col)})}break;case"NW-SE":switch(r){case"NE-SW":"top"===i?c={start:t,end:s}:c.end=t;break;case"NW-SE":"top"===i?c={start:t,end:a}:c.end=t;break;case"SE-NW":"top"===i?c={start:t,end:o}:c.end=t;break;case"SW-NE":"top"===i?c={start:t,end:l}:c.end=t}break;case"SW-NE":switch(r){case"NW-SE":c="bottom"===i?{start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(s.row,t.col)}:{start:this.hot._createCellCoords(o.row,t.col),end:this.hot._createCellCoords(t.row,a.col)};break;case"SW-NE":c="top"===i?{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,a.col)}:{start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(o.row,t.col)};break;case"SE-NW":"bottom"===i?c={start:this.hot._createCellCoords(t.row,l.col),end:this.hot._createCellCoords(o.row,t.col)}:"top"===i&&(c={start:s,end:t})}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":"top"===i&&(c.end=t);break;case"SE-NW":"top"===i?c.end=t:c={start:t,end:o}}}return c}isDragged(){return this.dragged.length>0}}function mhe(){let{label:e="",colspan:t=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:a=!1,isRoot:s=!1,isPlaceholder:l=!1,headerClassNames:c=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:e,colspan:t,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:a,isRoot:s,isPlaceholder:l,headerClassNames:c}}function phe(){return{label:"",isPlaceholder:!0}}const ghe=["row","col"];function vhe(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function yhe(e,t){return e.get(whe(e,t))}function bhe(e,t,n){return e.set(whe(e,t),n),n}function whe(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const xhe=["label","collapsible"];var She=new WeakMap,Che=new WeakMap,Ehe=new WeakMap;class Nhe{constructor(){vhe(this,She,[]),vhe(this,Che,0),vhe(this,Ehe,1/0)}setColumnsLimit(e){bhe(Ehe,this,e)}setData(){bhe(She,this,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;const n=[];if(0===t)return n;WH(e,e=>{const r=[];let i=0;n.push(r),WH(e,e=>{const n=mhe();if(tB(e)){const{label:t,colspan:r,headerClassName:i}=e;n.label=tL(t),"number"===typeof r&&r>1&&(n.colspan=r,n.origColspan=r),"string"===typeof i&&(n.headerClassNames=[...i.split(" ")])}else n.label=tL(e);i+=n.origColspan;let o=!1;if(i>=t&&(n.colspan=n.origColspan-(i-t),n.origColspan=n.colspan,o=!0),r.push(n),n.colspan>1)for(let t=0;t<n.colspan-1;t++)r.push(phe());return!o})});const r=Math.max(...zH(n,e=>e.length));return WH(n,e=>{if(e.length<r){const t=zH(new Array(r-e.length),()=>mhe());e.splice(e.length,0,...t)}}),n}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],yhe(Ehe,this))),bhe(Che,this,yhe(She,this).length)}getData(){return yhe(She,this)}mergeWith(e){WH(e,e=>{let{row:t,col:n}=e,r=b(e,ghe);const i=this.getHeaderSettings(t,n);null!==i&&$L(i,r,xhe)})}map(e){WH(yhe(She,this),t=>{WH(t,t=>{const n=e(E({},t));tB(n)&&$L(t,n,xhe)})})}getHeaderSettings(e,t){var n;if(e>=yhe(Che,this)||e<0)return null;const r=yhe(She,this)[e];return!1===Array.isArray(r)||t>=r.length?null:null!==(n=r[t])&&void 0!==n?n:null}getHeadersSettings(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const r=[];if(e>=yhe(Che,this)||e<0)return r;const i=yhe(She,this)[e];let o=0;for(let a=t;a<i.length;a++){const e=i[a];if(e.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=e.colspan,r.push(e),e.colspan>1&&(a+=e.colspan-1),o===n)break;if(o>n)throw new Error("The last column settings cannot overlap the other header layers")}return r}getLayersCount(){return yhe(Che,this)}getColumnsCount(){return yhe(Che,this)>0?yhe(She,this)[0].length:0}clear(){bhe(She,this,[]),bhe(Che,this,0)}}function The(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ahe="DF-pre-order";const Rhe=new Map([[Ahe,function e(t,n){let r=t.call(n,this);for(let i=0;i<this.childs.length;i++){if(!1===r)return!1;r=e.call(this.childs[i],t,n)}return r}],["DF-post-order",function e(t,n){for(let r=0;r<this.childs.length;r++){if(!1===e.call(this.childs[r],t,n))return!1}return t.call(n,this)}],["BF",function(e,t){const n=[this];!function r(){if(0===n.length)return;const i=n.shift();n.push(...i.childs),!1!==e.call(t,i)&&r()}()}]]);class khe{constructor(e){The(this,"data",{}),The(this,"parent",null),The(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;const t=new khe(E({},e.data));for(let n=0;n<e.childs.length;n++)t.addChild(this.cloneTree(e.childs[n]));return t}replaceTreeWith(e){this.data=E({},e.data),this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"BF";if(!Rhe.has(t))throw new Error('Traversal strategy "'.concat(t,'" does not exist'));Rhe.get(t).call(this,e,this)}walkUp(e){const t=this,n=r=>{!1!==e.call(t,r)&&null!==r.parent&&n(r.parent)};n(this)}}function Mhe(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function Dhe(e,t){return e.get(_he(e,t))}function _he(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Ohe,Ihe,Phe=new WeakMap,jhe=new WeakMap,Fhe=new WeakMap;class Hhe{constructor(e){Mhe(this,Phe,new Map),Mhe(this,jhe,new Map),Mhe(this,Fhe,null),function(e,t,n){e.set(_he(e,t),n)}(Fhe,this,e)}getRoots(){return Array.from(Dhe(Phe,this).values())}getRootByColumn(e){let t;return Dhe(jhe,this).has(e)&&(t=Dhe(Phe,this).get(Dhe(jhe,this).get(e))),t}getNode(e,t){const n=this.getRootByColumn(t);if(!n)return;const r=t-Dhe(jhe,this).get(t);let i,o=0;return n.walkDown(n=>{const{data:{origColspan:a,headerLevel:s}}=n;if(e===s){if(r>=o&&r<=o+a-1)return i=n,i.data.isRoot=t===i.data.columnIndex,!1;o+=a}}),i}rebuildTreeIndex(){let e=0;Dhe(jhe,this).clear(),WH(Dhe(Phe,this),t=>{let[,{data:{colspan:n}}]=t;for(let r=e;r<e+n;r++)Dhe(jhe,this).set(r,e);e+=n})}buildTree(){this.clear();const e=Dhe(Fhe,this).getColumnsCount();let t=0;for(;t<e;){const e=Dhe(Fhe,this).getHeaderSettings(0,t),n=new khe;Dhe(Phe,this).set(t,n),this.buildLeaves(n,t,0,e.origColspan),t+=e.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const i=Dhe(Fhe,this).getHeadersSettings(n,t,r);n+=1,WH(i,r=>{const i=E(E({},r),{},{headerLevel:n-1,columnIndex:t});let o;1===n?(e.data=i,o=e):(o=new khe(i),e.addChild(o)),n<Dhe(Fhe,this).getLayersCount()&&this.buildLeaves(o,t,n,r.origColspan),t+=r.origColspan})}clear(){Dhe(Phe,this).clear(),Dhe(jhe,this).clear()}}function Lhe(e,t){e.walkDown(e=>{let{data:n,childs:r}=e;if(!n.isHidden&&(t(n.columnIndex),0===r.length))for(let i=1;i<n.colspan;i++)t(n.columnIndex+i)})}function Bhe(e,t){let{childs:n}=e;if(0!==n.length)return n[0].data[t]}function zhe(e){return Bhe(e,"origColspan")===e.data.origColspan}function Whe(e){const{data:t,childs:n}=e;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(zhe(e))return Whe(n[0]);t.isCollapsed=!1;const r=n.slice(1),i=new Set;let o=0;if(r.length>0)WH(r,e=>{e.replaceTreeWith(e.data.clonedTree),e.data.clonedTree=null;const t=e.data;o+=t.colspan,Lhe(e,e=>{i.add(e)})});else{const{colspan:e,origColspan:n,columnIndex:r}=t;o=n-e;for(let t=1;t<n;t++)i.add(r+t)}return e.walkUp(e=>{const{data:t}=e;t.colspan+=o,t.colspan>=t.origColspan?(t.colspan=t.origColspan,t.isCollapsed=!1):zhe(e)&&(t.isCollapsed=Bhe(e,"isCollapsed"))}),{rollbackModification:()=>Vhe(e),affectedColumns:Array.from(i),colspanCompensation:o}}function Vhe(e){var t;const{data:n,childs:r}=e;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(zhe(e))return Vhe(r[0]);n.isCollapsed=!0;const i=r.slice(1),o=new Set;if(i.length>0)WH(i,e=>{Lhe(e,e=>{o.add(e)}),e.data.clonedTree=e.cloneTree(),e.walkDown(e=>{let{data:t}=e;t.isHidden=!0})});else{const{origColspan:e,columnIndex:t}=n;for(let n=1;n<e;n++){const e=t+n;o.add(e)}}const a=n.colspan-(null!==(t=Bhe(e,"colspan"))&&void 0!==t?t:1);return e.walkUp(e=>{const{data:t}=e;t.colspan-=a,t.colspan<=1?(t.colspan=1,t.isCollapsed=!0):zhe(e)&&(t.isCollapsed=Bhe(e,"isCollapsed"))}),{rollbackModification:()=>Whe(e),affectedColumns:Array.from(o),colspanCompensation:a}}const Uhe=new Map([["collapse",Vhe],["expand",Whe],["hide-column",function(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(ZH(Ohe||(Ohe=RH(["The passed node is not the last node on the tree. Only for \nthe last node, the hide column modification can be applied."],["The passed node is not the last node on the tree. Only for\\x20\nthe last node, the hide column modification can be applied."]))));const{crossHiddenColumns:n}=e.data;if(n.includes(t))return;let r=!1;e.walkUp(e=>{const{data:{collapsible:t}}=e;if(t)return r=!0,!1}),r||e.walkUp(e=>{const{data:n}=e;n.crossHiddenColumns.push(t),n.colspan>1?n.colspan-=1:n.isHidden=!0})}],["show-column",function(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(ZH(Ihe||(Ihe=RH(["The passed node is not the last node on the tree. Only for \nthe last node, the show column modification can be applied."],["The passed node is not the last node on the tree. Only for\\x20\nthe last node, the show column modification can be applied."]))));const{crossHiddenColumns:n}=e.data;if(!n.includes(t))return;let r=!1;e.walkUp(e=>{const{data:{collapsible:t}}=e;if(t)return r=!0,!1}),r||e.walkUp(e=>{const{data:n}=e;n.crossHiddenColumns.splice(n.crossHiddenColumns.indexOf(t),1),!n.isHidden&&n.colspan<n.origColspan&&(n.colspan+=1),n.isHidden=!1})}]]);const qhe=["crossHiddenColumns"];function Ghe(e){const t=[];return WH(e,e=>{e.walkDown(e=>{const n=e.data,{origColspan:r,columnIndex:i,headerLevel:o,crossHiddenColumns:a}=n,s=function(e,t){let n;Array.isArray(e[t])?n=e[t]:(n=[],e[t]=n);return n}(t,o);let l=!1;for(let t=i;t<i+r;t++){if(a.includes(t)||l)s.push(phe());else{const e=Yhe(n);e.isRoot=!0,s.push(e),l=!0}}})}),t}function Yhe(e){const t=mhe(e),{crossHiddenColumns:n}=t;return b(t,qhe)}const Khe=["row"];function $he(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function Xhe(e,t,n){return e.set(Jhe(e,t),n),n}function Qhe(e,t){return e.get(Jhe(e,t))}function Jhe(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Zhe=new WeakMap,efe=new WeakMap,tfe=new WeakMap;class nfe{constructor(){$he(this,Zhe,new Nhe),$he(this,efe,new Hhe(Qhe(Zhe,this))),$he(this,tfe,[[]])}setState(e){Qhe(Zhe,this).setData(e);let t=!1;try{Qhe(efe,this).buildTree()}catch(n){Qhe(efe,this).clear(),Qhe(Zhe,this).clear(),t=!0}return Xhe(tfe,this,Ghe(Qhe(efe,this).getRoots())),t}setColumnsLimit(e){Qhe(Zhe,this).setColumnsLimit(e)}mergeStateWith(e){const t=zH(e,e=>{let{row:t}=e,n=b(e,Khe);return E({row:t<0?this.rowCoordsToLevel(t):t},n)});Qhe(Zhe,this).mergeWith(t),Qhe(efe,this).buildTree(),Xhe(tfe,this,Ghe(Qhe(efe,this).getRoots()))}mapState(e){Qhe(Zhe,this).map(e),Qhe(efe,this).buildTree(),Xhe(tfe,this,Ghe(Qhe(efe,this).getRoots()))}mapNodes(e){return LH(Qhe(efe,this).getRoots(),(t,n)=>(n.walkDown(n=>{const r=e(n.data);void 0!==r&&t.push(r)}),t),[])}triggerNodeModification(e,t,n){t<0&&(t=this.rowCoordsToLevel(t));const r=Qhe(efe,this).getNode(t,n);let i;return r&&(i=function(e,t,n){if(!Uhe.has(e))throw new Error('The node modifier action ("'.concat(e,'") does not exist.'));return Uhe.get(e)(t,n)}(e,r,n),Xhe(tfe,this,Ghe(Qhe(efe,this).getRoots()))),i}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var n,r;return e<0&&(e=this.rowCoordsToLevel(e)),null===e||e>=this.getLayersCount()?null:null!==(n=null===(r=Qhe(tfe,this)[e])||void 0===r?void 0:r[t])&&void 0!==n?n:null}getHeaderTreeNodeData(e,t){const n=this.getHeaderTreeNode(e,t);return n?E({},n.data):null}getHeaderTreeNode(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),null===e||e>=this.getLayersCount())return null;const n=Qhe(efe,this).getNode(e,t);return n||null}findTopMostEntireHeaderLevel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;const n=t-e+1;let r=!1,i=null;for(let o=e;o<=t;o++){const a=Qhe(efe,this).getRootByColumn(o);if(!a)break;r=!0,a.walkDown(r=>{const{columnIndex:o,headerLevel:a,origColspan:s,isHidden:l}=r.data;l||s<=n&&o>=e&&o+s-1<=t&&(null===i||a<i)&&(i=a)},Ahe)}return r&&null===i?-1:this.levelToRowCoords(null!==i&&void 0!==i?i:0)}findLeftMostColumnIndex(e,t){var n;const{isRoot:r}=null!==(n=this.getHeaderSettings(e,t))&&void 0!==n?n:{isRoot:!0};if(r)return t;let i=t-1;for(;i>=0;){var o;const{isRoot:t}=null!==(o=this.getHeaderSettings(e,i))&&void 0!==o?o:{isRoot:!0};if(t)break;i-=1}return i}findRightMostColumnIndex(e,t){var n;const{isRoot:r,origColspan:i}=null!==(n=this.getHeaderSettings(e,t))&&void 0!==n?n:{isRoot:!0,origColspan:1};if(r)return t+i-1;let o=t+1;for(;o<this.getColumnsCount();){var a;const{isRoot:t}=null!==(a=this.getHeaderSettings(e,o))&&void 0!==a?a:{isRoot:!0};if(t)break;o+=1}return o-1}getLayersCount(){return Qhe(Zhe,this).getLayersCount()}getColumnsCount(){return Qhe(Zhe,this).getColumnsCount()}clear(){Xhe(tfe,this,[]),Qhe(Zhe,this).clear(),Qhe(efe,this).clear()}}function rfe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ife=class{constructor(e,t){rfe(this,"hot",void 0),rfe(this,"nestedHeaderSettingsGetter",void 0),rfe(this,"layersCount",0),rfe(this,"container",void 0),rfe(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const t=this.container.querySelectorAll("tr:last-of-type th"),n=t.length;this.widthsMap.clear();for(let r=0;r<n;r++){const e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),n=this.hot.toPhysicalColumn(e);this.widthsMap.setValueAtIndex(n,t[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:n}=this.hot,r=t.createDocumentFragment(),i=t.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,a=n.getRenderableIndexesLength();for(let s=0;s<this.layersCount;s++){const e=t.createElement("tr");for(let r=0;r<a;r++){let i=n.getVisualFromRenderableIndex(r);null===i&&(i=r);const a=t.createElement("th"),l=this.nestedHeaderSettingsGetter(s,i);if(l&&(!l.isPlaceholder||l.isHidden)){let t=l.label;o&&(t+='<button class="changeType"></button>'),tz(a,t),a.colSpan=l.colspan,e.appendChild(a)}}i.appendChild(e)}r.appendChild(i),e.appendChild(r)}clear(){this.widthsMap.clear(),this.container=null}};var ofe,afe;function sfe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lfe(e,t,n){cfe(e,t),t.set(e,n)}function cfe(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ufe(e,t,n){return e.set(hfe(e,t),n),n}function dfe(e,t){return e.get(hfe(e,t))}function hfe(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const ffe="nestedHeaders";var mfe=new WeakMap,pfe=new WeakMap,gfe=new WeakMap,vfe=new WeakMap,yfe=new WeakMap,bfe=new WeakMap,wfe=new WeakSet;class xfe extends T5{constructor(){super(...arguments),function(e,t){cfe(e,t),t.add(e)}(this,wfe),lfe(this,mfe,new nfe),lfe(this,pfe,null),lfe(this,gfe,null),lfe(this,vfe,!1),lfe(this,yfe,null),sfe(this,"ghostTable",new ife(this.hot,(e,t)=>this.getHeaderSettings(e,t))),sfe(this,"detectedOverlappedHeaders",!1),lfe(this,bfe,()=>{var e;const t=null===(e=this.hot)||void 0===e?void 0:e.getSelectedRangeActive();if(!t)return;const{highlight:n}=t;if(n.isHeader()&&n.col>=0){const e=dfe(mfe,this).findLeftMostColumnIndex(n.row,n.col),t=this.hot.selection.highlight.getFocus();t.visualCellRange.highlight.col=e,t.visualCellRange.from.col=e,t.visualCellRange.to.col=e,t.commit()}})}static get PLUGIN_KEY(){return ffe}static get PLUGIN_PRIORITY(){return 280}isEnabled(){return!!this.hot.getSettings()[ffe]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();Array.isArray(t)&&Array.isArray(t[0])||hW(ZH(ofe||(ofe=RH(["Your Nested Headers plugin configuration is invalid. The settings has to be \n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]"],["Your Nested Headers plugin configuration is invalid. The settings has to be\\x20\n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]"])))),this.addHook("init",()=>hfe(wfe,this,Ffe).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hfe(wfe,e,Hfe).call(e,...n)}),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hfe(wfe,e,Nfe).call(e,...n)}),this.addHook("afterOnCellMouseDown",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hfe(wfe,e,Tfe).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hfe(wfe,e,Afe).call(e,...n)}),this.addHook("beforeOnCellMouseUp",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hfe(wfe,e,Rfe).call(e,...n)}),this.addHook("beforeSelectionHighlightSet",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hfe(wfe,e,kfe).call(e,...n)}),this.addHook("modifyTransformStart",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hfe(wfe,e,Mfe).call(e,...n)}),this.addHook("afterSelection",()=>dfe(bfe,this).call(this)),this.addHook("afterSelectionFocusSet",()=>dfe(bfe,this).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hfe(wfe,e,Sfe).call(e,...n)}),this.addHook("afterGetColumnHeaderRenderers",e=>hfe(wfe,this,_fe).call(this,e)),this.addHook("modifyColWidth",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hfe(wfe,e,Ife).call(e,...n)}),this.addHook("modifyColumnHeaderValue",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hfe(wfe,e,Pfe).call(e,...n)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hfe(wfe,e,Cfe).call(e,...n)}),this.addHook("beforeCopy",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hfe(wfe,e,Efe).call(e,...n)}),this.addHook("beforeSelectColumns",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hfe(wfe,e,Dfe).call(e,...n)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hfe(wfe,e,Ofe).call(e,...n)}),this.addHook("modifyFocusedElement",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hfe(wfe,e,jfe).call(e,...n)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",dfe(bfe,this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",dfe(bfe,this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();dfe(mfe,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=dfe(mfe,this).setState(e)),this.detectedOverlappedHeaders&&hW(ZH(afe||(afe=RH(["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration \n                        is currently not supported."],["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20\n                        is currently not supported."])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((e,t)=>{const n=!0===e?"hide-column":"show-column";dfe(mfe,this).triggerColumnModification(n,t)}),!dfe(pfe,this)&&this.enabled&&ufe(pfe,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(e=>{e.forEach(e=>{let{op:t,index:n,newValue:r}=e;if("replace"===t){const e=!0===r?"hide-column":"show-column";dfe(mfe,this).triggerColumnModification(e,n)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.removeLocalHook("cacheUpdated",dfe(bfe,this)),this.hot.columnIndexMapper.removeLocalHook("cacheUpdated",dfe(bfe,this)),this.clearColspans(),dfe(mfe,this).clear(),dfe(pfe,this).unsubscribe(),ufe(pfe,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return dfe(mfe,this)}getLayersCount(){return dfe(mfe,this).getLayersCount()}getHeaderSettings(e,t){return dfe(mfe,this).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,i=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<t;o++){const e=n.childNodes[o];if(!e)break;const t=r.childNodes[o],a=i?i.childNodes[o]:null;for(let n=0,r=e.childNodes.length;n<r;n++)e.childNodes[n].removeAttribute("colspan"),$B(e.childNodes[n],"hiddenHeader"),t&&t.childNodes[n]&&(t.childNodes[n].removeAttribute("colspan"),$B(t.childNodes[n],"hiddenHeader")),i&&a&&a.childNodes[n]&&(a.childNodes[n].removeAttribute("colspan"),$B(a.childNodes[n],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const n=this.hot.view._wt.getSetting("fixedColumnsStart");return(r,i)=>{var o;const{columnIndexMapper:a,view:s}=this.hot;let l=a.getVisualFromRenderableIndex(r);null===l&&(l=r),i.removeAttribute("colspan"),$B(i,"hiddenHeader"),$B(i,"hiddenHeaderText");const{colspan:c,isHidden:u,isPlaceholder:d,headerClassNames:h}=null!==(o=dfe(mfe,this).getHeaderSettings(e,l))&&void 0!==o?o:{label:""};if(d||u)KB(i,"hiddenHeader");else if(c>1){var f,m,p;const{wtOverlays:e}=s._wt,t=null===(f=e.topInlineStartCornerOverlay)||void 0===f?void 0:f.clone.wtTable.THEAD.contains(i),o=null===(m=e.inlineStartOverlay)||void 0===m?void 0:m.clone.wtTable.THEAD.contains(i);(null===(p=e.topOverlay)||void 0===p?void 0:p.clone.wtTable.THEAD.contains(i))&&l<n&&KB(i,"hiddenHeaderText");const a=t||o?Math.min(c,n-r):c;a>1&&i.setAttribute("colspan",a)}if(this.hot.view.appendColHeader(l,i,function(){return t.getColumnHeaderValue(...arguments)},e),!d&&!u){const e=i.querySelector("div.relative");e&&h&&h.length>0&&($B(e,this.hot.getColumnMeta(l).headerClassName),KB(e,h))}}}getColumnHeaderValue(e,t){var n;const{isHidden:r,isPlaceholder:i}=null!==(n=dfe(mfe,this).getHeaderSettings(t,e))&&void 0!==n?n:{};return i||r?"":this.hot.getColHeader(e,t)}destroy(){ufe(mfe,this,null),null!==dfe(pfe,this)&&(dfe(pfe,this).unsubscribe(),ufe(pfe,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return dfe(mfe,this).getHeaderTreeNodeData(e.row,e.col)}}function Sfe(e,t){var n;const r=this.hot.getSelectedRangeActive();if(!r)return e;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),a=this.hot.selection.isSelectedByColumnHeader(),s=o?i.row:null===(n=dfe(yfe,this))||void 0===n?void 0:n.row,l=a?e:i.col,c=s<0&&l>=0;if(ufe(yfe,this,null),!c)return e;const u=this.hot.getFirstFullyVisibleColumn(),d=this.hot.getLastFullyVisibleColumn(),h=d-u+1,f=dfe(mfe,this).findLeftMostColumnIndex(s,l),m=dfe(mfe,this).findRightMostColumnIndex(s,l),p=m-f+1;if(f<u&&m>d)return f;if(a){let e=null;return f>=u&&m>d?p>h?(t.value="start",e=f):(t.value="end",e=m):f<u&&m<=d&&(p>h?(t.value="end",e=m):(t.value="start",e=f)),e}return f<=u?f:m}function Cfe(e,t,n){const r=dfe(mfe,this).getHeaderTreeNodeData(t,e);if(!r)return e;const{columnCursor:i,selectionType:o,selectionWidth:a}=n,{isRoot:s,colspan:l}=dfe(mfe,this).getHeaderSettings(t,e);if(o===iQ){if(!s)return r.columnIndex}else if(o===rQ&&(l>a-i||!s))return null;return e}function Efe(e,t,n){let{columnHeadersCount:r}=n;if(0!==r)for(let o=0;o<t.length;o++){const{startRow:n,startCol:r,endRow:a,endCol:s}=t[o],l=a-n+1;if(n>=0||1===r-s+1)break;for(let t=r;t<=s;t++)for(let o=n;o<=a;o++){var i;const n=l+o,a=t-r;if(0===a)continue;!1===(null===(i=dfe(mfe,this).getHeaderTreeNodeData(o,t))||void 0===i?void 0:i.isRoot)&&(e[n][a]="")}}}function Nfe(e,t,n,r){this._getHeaderTreeNodeDataByCoords(t)&&(r.column=!0)}function Tfe(e,t){const n=this._getHeaderTreeNodeDataByCoords(t);if(!n)return;ufe(gfe,this,t.clone()),ufe(vfe,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:a,origColspan:s}=n,l=!r.inInSelection(t);e.shiftKey&&i?t.col<i.from.col?o.push(i.getTopEndCorner().col,a,t.row):t.col>i.from.col?o.push(i.getTopStartCorner().col,a+s-1,t.row):o.push(a,a+s-1,t.row):(cW(e)||lW(e)&&l||uW(e))&&o.push(a,a+s-1,t.row),r.selectColumns(...o)}function Afe(e,t,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(t);if(!i)return;const{columnIndex:o,origColspan:a}=i,s=this.hot.getSelectedRangeActive(),l=s.getTopStartCorner(),c=s.getBottomEndCorner(),{from:u}=s;r.column=!0,r.cell=!0;const d=[],h=pV(t.row,-1/0,-1);t.col<u.col?d.push(c.col,o,h):t.col>u.col?d.push(l.col,o+a-1,h):d.push(o,o+a-1,h),this.hot.selection.selectColumns(...d)}function Rfe(){ufe(vfe,this,!1)}function kfe(){const{navigableHeaders:e}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!dfe(vfe,this)||!e)return;const t=this.hot.getSelectedRangeLast(),n=t.getTopStartCorner().col,r=t.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=dfe(mfe,this).getHeaderTreeNodeData(dfe(gfe,this).row,dfe(gfe,this).col);if(t.setHighlight(dfe(gfe,this)),o>t.getWidth()||i<n||i+o-1>r){const e=dfe(mfe,this).findTopMostEntireHeaderLevel(pV(n,i,i+o-1),pV(r,i,i+o-1));t.highlight.row=e,t.highlight.col=t.from.col}}function Mfe(e){const{highlight:t}=this.hot.getSelectedRangeActive(),n=this.hot._createCellCoords(t.row+e.row,t.col+e.col);if(!(n.isHeader()&&n.col>=0))return;const r=dfe(mfe,this).findLeftMostColumnIndex(n.row,n.col),i=dfe(mfe,this).findRightMostColumnIndex(n.row,n.col);if(e.col<0){const n=t.col>=r&&t.col<=i?r-1:i,o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n,-1);e.col=null===o?-this.hot.view.countRenderableColumnsInRange(0,t.col):-Math.max(this.hot.view.countRenderableColumnsInRange(o,t.col)-1,1)}else if(e.col>0){const n=t.col>=r&&t.col<=i?i+1:r,o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n,1);e.col=null===o?this.hot.view.countRenderableColumnsInRange(t.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(t.col,o)-1,1)}}function Dfe(e,t,n){const r=e.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col});ufe(yfe,this,n.clone()),t.col<e.col?(i&&(e.col=i.columnIndex+i.origColspan-1),o&&(t.col=o.columnIndex)):t.col>=e.col&&(i&&(e.col=i.columnIndex),o&&(t.col=o.columnIndex+o.origColspan-1))}function _fe(e){if(dfe(mfe,this).getLayersCount()>0){e.length=0;for(let t=0;t<dfe(mfe,this).getLayersCount();t++)e.push(this.headerRendererFactory(t))}}function Ofe(e){const t=dfe(mfe,this).getLayersCount();let n=e.startColumn,r=!!t;for(let i=0;i<t;i++){const t=dfe(mfe,this).findLeftMostColumnIndex(i,e.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(t);if(t>=0&&(r=!1),uV(o)&&o<e.startColumn){n=o;break}}e.startColumn=r?dfe(mfe,this).getHeaderTreeNodeData(0,n).columnIndex:n}function Ife(e,t){const n=this.ghostTable.getWidth(t);return e>n?e:n}function Pfe(e,t,n){var r;const{label:i}=null!==(r=dfe(mfe,this).getHeaderTreeNodeData(n,t))&&void 0!==r?r:{label:""};return i}function jfe(e,t){if(e<0)return this.hot.getCell(e,dfe(mfe,this).findLeftMostColumnIndex(e,t),!0)}function Ffe(){this.updatePlugin()}function Hfe(e,t){t||this.updatePlugin()}function Lfe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Bfe=class{constructor(e,t){Lfe(this,"hot",void 0),Lfe(this,"data",null),Lfe(this,"plugin",void 0),Lfe(this,"parentReference",new WeakMap),Lfe(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=t,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},hV(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,n){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&WH(e.__children,n=>{this.cacheNode(n,t+1,e)})}getDataObject(e){return null===e||void 0===e?null:this.cache.rows[e]}readTreeNodes(e,t,n,r){let i=!1,o=t;if(isNaN(o)&&o.end)return o;let a=e;return a||(a={__children:this.data},i=!0,o-=1),null!==n&&void 0!==n&&o===n?{result:a,end:!0}:null!==r&&void 0!==r&&a===r?{result:o,end:!0}:(o+=1,a.__children&&WH(a.__children,e=>{if(this.parentReference.set(e,i?null:a),o=this.readTreeNodes(e,o,n,r),isNaN(o)&&o.end)return!1}),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return rB(this.data[0],(t,n)=>{e[n]=null}),e}getRowIndex(e){return null===e||void 0===e?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;t=isNaN(e)?e:this.getDataObject(e);const n=this.getRowParent(e);return null===n||void 0===n?this.data.indexOf(t):n.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&n.__children?(WH(n.__children,e=>{t+=1,e.__children&&(t+=this.countChildren(e))}),t):0}getRowParent(e){let t;return t=isNaN(e)?e:this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return e&&"object"===typeof e?this.cache.nodeInfo.get(e).parent:null}getRowLevel(e){let t=null;return t=isNaN(e)?e:this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return null===e||void 0===e?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!(!t.__children||!t.__children.length)}isChild(e){return null!==this.getRowParent(e)}getChild(e,t){var n;return(null===(n=e.__children)||void 0===n?void 0:n[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&0!==(null===(t=n.__children)||void 0===t?void 0:t.length)}addChild(e,t){let n=t;this.hot.runHooks("beforeAddChild",e,n);let r=null;e&&(r=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1);let i=e;e||(i=this.mockParent()),i.__children||(i.__children=[]),n||(n=this.mockNode()),i.__children.push(n),this.rewriteCache();const o=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,n)}addChildAtIndex(e,t,n){let r,i=n;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,t),e){const n=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",n,1),e.__children.splice(t,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(n,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",n,1),r=n}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),r=this.getRowIndex(this.data[t]);i=this.getDataObject(r),this.hot.runHooks("afterAddChild",e,i,t)}addSibling(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below";const n=this.translateTrimmedRow(e),r=this.getRowParent(n),i=this.getRowIndexWithinParent(n);switch(t){case"below":this.addChildAtIndex(r,i+1,null);break;case"above":this.addChildAtIndex(r,i,null)}}detachFromParent(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=null;const r=[];Array.isArray(e)?(hV(e[0],e[2],e=>{const t=this.translateTrimmedRow(e);r.push(this.getDataObject(t))}),hV(0,r.length-2,e=>{this.detachFromParent(r[e],!1)}),n=r[r.length-1]):n=e;const i=this.getRowIndex(n),o=this.countChildren(n),a=this.getRowIndexWithinParent(n),s=this.getRowParent(n),l=this.getRowParent(s),c=this.getRowIndex(l);let u=null;if(this.hot.runHooks("beforeDetachChild",s,n),null!==a&&void 0!==a){const e=Array.from(new Array(i+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",i,o+1,e,this.plugin.pluginName),s.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,o+1,e,this.plugin.pluginName),l){u=c+this.countChildren(l);const e=this.getChild(l,this.countChildren(l)-1),t=this.getRowIndex(e);this.hot.runHooks("beforeCreateRow",t+1,o+1,this.plugin.pluginName),l.__children.push(n)}else u=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",u-2,o+1,this.plugin.pluginName),this.data.push(n)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",u-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",s,n,this.getRowIndex(n)),t&&this.hot.render()}filterData(e,t,n){const r=[];WH(n,e=>{r.push(this.getDataObject(e))}),WH(r,e=>{const t=this.getRowIndexWithinParent(e),n=this.getRowParent(e);null===n?this.data.splice(t,1):n.__children.splice(t,1)}),this.rewriteCache()}spliceData(e,t,n){const r=this.getDataObject(e-1);let i=null,o=e;r&&r.__children&&0===r.__children.length?(i=r,o=0):e<this.countAllRows()&&(i=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),i?n?i.__children.splice(o,t,...n):i.__children.splice(o,t):n?this.data.splice(o,t,...n):this.data.splice(o,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,n=t;do{n=this.getRowParent(n),null!==n&&(t=n)}while(null!==n);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,n,r){const i=t===this.hot.countRows(),o=this.getRowParent(e),a=this.getRowIndexWithinParent(e),s=o.__children.slice(a,a+1),l=e>t;let c=i?this.getRowParent(t-1):this.getRowParent(t);null!==c&&void 0!==c||(c=this.getRowParent(t-1)),null!==c&&void 0!==c||(c=this.getDataObject(t-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(t),c.__children=[]);const u=i||n||r?c.__children.length:this.getRowIndexWithinParent(t),d=o===c;c.__children.splice(u,0,s[0]),o.__children.splice(a+(l&&d?1:0),1),this.syncRowWithRawSource(o),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}};function zfe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Wfe=class{constructor(e,t){zfe(this,"hot",void 0),zfe(this,"plugin",void 0),this.hot=t,this.plugin=e}};class Vfe extends Wfe{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const n=this.hot.toPhysicalRow(e),r=this.dataManager.getDataObject(n);if(!r)return;const i=this.dataManager.getRowLevel(n),o=t.getElementsByTagName("DIV")[0],a=o.querySelector("span.rowHeader"),s=o.querySelectorAll('[class^="ht_nesting"]'),l=this.hot.getSettings().ariaTags;if(WH(s,e=>{e&&o.removeChild(e)}),KB(t,Vfe.CSS_CLASSES.indicatorContainer),i){const{rootDocument:e}=this.hot,t=a.cloneNode(!0);o.innerHTML="",hV(0,i-1,()=>{const t=e.createElement("SPAN");KB(t,Vfe.CSS_CLASSES.emptyIndicator),o.appendChild(t)}),o.appendChild(t)}if(this.dataManager.hasChildren(r)){const e=this.hot.rootDocument.createElement("DIV");l&&XB(e,[jL()]),KB(t,Vfe.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?(KB(e,"".concat(Vfe.CSS_CLASSES.button," ").concat(Vfe.CSS_CLASSES.expandButton)),l&&XB(t,[VL(!1)])):(KB(e,"".concat(Vfe.CSS_CLASSES.button," ").concat(Vfe.CSS_CLASSES.collapseButton)),l&&XB(t,[VL(!0)])),o.appendChild(e)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount);let n=11;if(!this.hot.stylesHandler.isClassicTheme()){n=2*this.hot.stylesHandler.getCSSVariableValue("cell-horizontal-padding")}this.rowHeaderWidthCache=Math.max(50,n+10*t+25),this.hot.render()}}const Ufe=Vfe;const qfe=class extends Wfe{constructor(e,t){var n;super(e,t),n=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,e)},shiftStash:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null!==t&&void 0!==t||(t=1/0),WH(n.lastCollapsedRows,(i,o)=>{i>=e&&i<t&&(n.lastCollapsedRows[o]=i+r)})},applyStash:function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.collapseMultipleChildren(n.lastCollapsedRows,e),n.lastCollapsedRows=void 0},trimStash:(e,t)=>{hV(e,e+t-1,e=>{const t=this.lastCollapsedRows.indexOf(e);t>-1&&this.lastCollapsedRows.splice(t,1)})}}}collapseChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=[];let i=null,o=null,a=null;return isNaN(e)?(i=e,o=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(i)&&WH(i.__children,e=>{r.push(this.dataManager.getRowIndex(e))}),a=this.collapseRows(r,!0,!1),n&&this.trimRows(a),t&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(o)&&this.collapsedRows.push(o),a}collapseMultipleChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=[];WH(e,e=>{r.push(...this.collapseChildren(e,!1,!1))}),n&&this.trimRows(r),t&&this.renderAndAdjust()}collapseRow(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([e],t)}collapseRows(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=[];return WH(e,e=>{r.push(e),t&&this.collapseChildRows(e,r)}),n&&this.trimRows(r),r}collapseChildRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){WH(this.dataManager.getDataObject(e).__children,e=>{const n=this.dataManager.getRowIndex(e);t.push(n),this.collapseChildRows(n,t)})}n&&this.trimRows(t)}expandRow(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([e],t)}expandRows(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=[];return WH(e,e=>{r.push(e),t&&this.expandChildRows(e,r)}),n&&this.untrimRows(r),r}expandChildRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){WH(this.dataManager.getDataObject(e).__children,e=>{if(!this.isAnyParentCollapsed(e)){const n=this.dataManager.getRowIndex(e);t.push(n),this.expandChildRows(n,t)}})}n&&this.untrimRows(t)}expandChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=[];let i=null,o=null,a=null;return isNaN(e)?(i=e,o=this.dataManager.getRowIndex(e)):(i=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(i)&&WH(i.__children,e=>{const t=this.dataManager.getRowIndex(e);r.push(t)}),a=this.expandRows(r,!0,!1),n&&this.untrimRows(a),t&&this.renderAndAdjust(),a}expandMultipleChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=[];WH(e,e=>{r.push(...this.expandChildren(e,!1,!1))}),n&&this.untrimRows(r),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];WH(e,e=>{this.dataManager.hasChildren(e)&&t.push(e)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];WH(e,e=>{this.dataManager.hasChildren(e)&&t.push(e)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{WH(e,e=>{this.plugin.collapsedRowsMap.setValueAtIndex(e,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{WH(e,e=>{this.plugin.collapsedRowsMap.setValueAtIndex(e,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),n=!0;return null===t&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&WH(t.__children,e=>{const t=this.dataManager.getRowIndex(e);if(!this.plugin.collapsedRowsMap.getValueAtIndex(t))return n=!1,!1}),n}isAnyParentCollapsed(e){let t=e;for(;null!==t;){t=this.dataManager.getRowParent(t);const e=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(e)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const n=this.translateTrimmedRow(t.row);YB(e.target,Ufe.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),aW(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.view.adjustElementsSize(),this.hot.render()}};function Gfe(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function Yfe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Kfe(e,t){return e.get(function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(e,t))}var $fe=new WeakMap;const Xfe=class extends Wfe{constructor(){super(...arguments),Yfe(this,"dataManager",this.plugin.dataManager),Gfe(this,$fe,{row_above:(e,t)=>{const n=t[t.length-1];this.dataManager.addSibling(n.start.row,"above")},row_below:(e,t)=>{const n=t[t.length-1];this.dataManager.addSibling(n.start.row,"below")}})}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(H$)},callback:()=>{const e=this.dataManager.translateTrimmedRow(this.hot.getSelectedActive()[0]),t=this.dataManager.getDataObject(e);this.dataManager.addChild(t)},disabled:()=>{const e=this.hot.getSelectedActive();return!e||e[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(L$)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedActive())},disabled:()=>{const e=this.hot.getSelectedActive(),t=this.dataManager.translateTrimmedRow(e[0]);return!this.dataManager.getRowParent(t)||!e||e[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return hV(0,e.items.length-1,n=>{if(0===n)return WH(t,(t,r)=>{e.items.splice(n+r,0,t)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return hV(0,e.items.length-1,t=>{const n=Kfe($fe,this)[e.items[t].key];null!==n&&void 0!==n&&(e.items[t].callback=n)}),e}};var Qfe;function Jfe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Zfe{constructor(e){Jfe(this,"plugin",void 0),Jfe(this,"hot",void 0),Jfe(this,"dataManager",void 0),Jfe(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,n,r){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:n,movePossible:r}))return!1;this.movedToCollapsed=!1;const i=n===this.hot.countRows(),o=i?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n);let a=!0;const s=e.map(e=>{if(!a)return!1;const t=this.dataManager.translateTrimmedRow(e);return a=this.shouldAllowMoving(t,o),t}),l=-1===s.indexOf(o);if(!a||!l)return!1;const c=this.getBaseParent(s),u=this.getTargetParent(i,o),d=c===u;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(u),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(s,o,d),this.moveRows(s,o,u),this.dataManager.rewriteCache(),this.moveCellsMeta(s,o),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,n,r,r&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,n),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:n,dropIndex:r,movePossible:i}=e;let o=!1;return rL(r)&&(hW(ZH(Qfe||(Qfe=RH(["Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows \n      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead."],["Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20\n      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead."])))),this.hot.runHooks("afterRowMove",t,n,r,i,!1),o=!0),o}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||0===t)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let n=this.dataManager.getRowParent(e?t-1:t);return null!==n&&void 0!==n||(n=this.dataManager.getRowParent(t-1)),n}shiftCollapsibleParentsLocations(e,t,n){n||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,n){const r=t===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender(()=>{e.forEach(e=>{this.dataManager.moveRow(e,t,this.movedToCollapsed,r)})})}moveCellsMeta(e,t){const n=[],r=Math.max(...e)<t;e.forEach(e=>{n.push(this.hot.getCellMetaAtRow(e))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(r?n.length:0),0,...n)}selectCells(e,t){const n=e.length;let r=0,i=0;if(this.movedToCollapsed){let o=null;o=e[n-1]<t?this.dataManager.translateTrimmedRow(t-n):this.dataManager.translateTrimmedRow(t);const a=this.dataManager.getRowParent(null===o?this.hot.countSourceRows()-1:o-1),s=this.dataManager.getRowIndex(a);r=this.dataManager.untranslateTrimmedRow(s),i=r}else e[n-1]<t?(i=t-1,r=i-n+1):(r=t,i=r+n-1);this.hot.selectCells([[r,0,i,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,t){return e.some((e,n)=>e-n!==t)}}function eme(e,t,n){tme(e,t),t.set(e,n)}function tme(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nme(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rme(e,t){return e.get(ome(e,t))}function ime(e,t,n){return e.set(ome(e,t),n),n}function ome(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const ame="nestedRows",sme=ame;var lme,cme=new WeakMap,ume=new WeakMap,dme=new WeakSet;class hme extends T5{constructor(){super(...arguments),function(e,t){tme(e,t),t.add(e)}(this,dme),nme(this,"dataManager",null),nme(this,"headersUI",null),nme(this,"collapsedRowsMap",null),eme(this,cme,!1),eme(this,ume,!1)}static get PLUGIN_KEY(){return ame}static get PLUGIN_PRIORITY(){return 300}isEnabled(){return!!this.hot.getSettings()[ame]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new bK),this.dataManager=new Bfe(this,this.hot),this.collapsingUI=new qfe(this,this.hot),this.headersUI=new Ufe(this,this.hot),this.contextMenuUI=new Xfe(this,this.hot),this.rowMoveController=new Zfe(this),this.addHook("afterInit",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ome(dme,e,Tme).call(e,...n)}),this.addHook("beforeViewRender",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ome(dme,e,Ame).call(e,...n)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ome(dme,e,pme).call(e,...n)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ome(dme,e,gme).call(e,...n)}),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ome(dme,e,vme).call(e,...n)}),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ome(dme,e,mme).call(e,...n)}),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ome(dme,e,wme).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ome(dme,e,bme).call(e,...n)}),this.addHook("beforeAddChild",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ome(dme,e,xme).call(e,...n)}),this.addHook("afterAddChild",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ome(dme,e,Sme).call(e,...n)}),this.addHook("beforeDetachChild",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ome(dme,e,Cme).call(e,...n)}),this.addHook("afterDetachChild",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ome(dme,e,Eme).call(e,...n)}),this.addHook("modifyRowHeaderWidth",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ome(dme,e,yme).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ome(dme,e,Nme).call(e,...n)}),this.addHook("beforeRowMove",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ome(dme,e,fme).call(e,...n)}),this.addHook("beforeLoadData",e=>ome(dme,this,Rme).call(this,e)),this.addHook("beforeUpdateData",e=>ome(dme,this,Rme).call(this,e)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive(),t=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(t)?this.collapsingUI.expandChildren(t):this.collapsingUI.collapseChildren(t),!1},runOnlyIf:()=>{var e,t;const n=null===(e=this.hot.getSelectedRangeActive())||void 0===e?void 0:e.highlight;return n&&(null===(t=this.hot.getSelectedRangeActive())||void 0===t?void 0:t.isSingle())&&this.hot.selection.isCellVisible(n)&&-1===n.col&&n.row>=0},group:sme,relativeToGroup:ZZ,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(sme)}disableCoreAPIModifiers(){ime(ume,this,!0)}enableCoreAPIModifiers(){ime(ume,this,!1)}onModifyRowData(e){if(!rme(ume,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!rme(ume,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,n){return!(!rme(ume,this)&&!this.dataManager.isRowHighestLevel(e))||(this.dataManager.spliceData(e,t,n),!1)}destroy(){super.destroy()}}function fme(e,t,n,r){return this.rowMoveController.onBeforeRowMove(e,t,n,r)}function mme(e,t,n){this.collapsingUI.toggleState(e,t,n)}function pme(e,t,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*t),this.dataManager.filterData(e,t,n),ime(cme,this,!0),this.dataManager.getData().slice()}function gme(e){return this.contextMenuUI.appendOptions(e)}function vme(e,t){this.headersUI.appendLevelIndicators(e,t)}function yme(e){return Math.max(this.headersUI.rowHeaderWidthCache,e)}function bme(e,t,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{ime(cme,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function wme(e,t,n){const r=Array.from(n.reduce((e,t)=>{if(this.dataManager.isParent(t)){const n=this.dataManager.getDataObject(t).__children;return e.add(t),Array.isArray(n)&&n.forEach(t=>e.add(this.dataManager.getRowIndex(t))),e}return e.add(t)},new Set));n.length=0,n.push(...r)}function xme(){this.collapsingUI.collapsedRowsStash.stash()}function Sme(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Cme(){this.collapsingUI.collapsedRowsStash.stash()}function Eme(e,t,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Nme(){this.dataManager.rewriteCache()}function Tme(){this.headersUI.updateRowHeaderWidth()}function Ame(e,t){rme(cme,this)&&(t.skipRender=!0)}function Rme(e){if(!tK(e))return mW("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),this.hot.getSettings()[ame]=!1,void this.disablePlugin();this.dataManager.setData(e),this.dataManager.rewriteCache()}function kme(e,t,n){Mme(e,t),t.set(e,n)}function Mme(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dme(e,t){return e.get(Ome(e,t))}function _me(e,t,n){return e.set(Ome(e,t),n),n}function Ome(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Ime,Pme=new WeakMap,jme=new WeakMap,Fme=new WeakMap,Hme=new WeakMap,Lme=new WeakMap,Bme=new WeakMap,zme=new WeakMap,Wme=new WeakMap,Vme=new WeakSet;class Ume{constructor(e){let{rootElement:t,uiContainer:n,isRtl:r,themeName:i,phraseTranslator:o,shouldHaveBorder:a,a11yAnnouncer:s}=e;!function(e,t){Mme(e,t),t.add(e)}(this,Vme),kme(this,Pme,void 0),kme(this,jme,void 0),kme(this,Fme,!1),kme(this,Hme,void 0),kme(this,Lme,void 0),kme(this,Bme,void 0),kme(this,zme,void 0),kme(this,Wme,void 0),_me(Pme,this,t),_me(jme,this,n),_me(Fme,this,r),_me(Lme,this,i),_me(Bme,this,o),_me(zme,this,a),_me(Wme,this,s),this.install()}install(){var e;if(null!==(e=Dme(Hme,this))&&void 0!==e&&e.container)return;const t=eL(lme||(lme=RH(["",""])),'\n<div data-ref="container" class="ht-pagination handsontable">\n  <div class="ht-pagination__inner">\n    <div data-ref="pageSizeSection" class="ht-page-size-section">\n      <span data-ref="pageSizeLabel" class="ht-page-size-section__label"></span>\n      <div class="ht-page-size-section__select-wrapper">\n        <select data-ref="pageSizeSelect" name="pageSize" data-hot-input></select>\n      </div>\n    </div>\n    <div data-ref="pageCounterSection" class="ht-page-counter-section"></div>\n    <nav data-ref="pageNavSection" class="ht-page-navigation-section">\n      <button data-ref="first" class="ht-page-navigation-section__button ht-page-first"></button>\n      <button data-ref="prev" class="ht-page-navigation-section__button ht-page-prev"></button>\n      <span data-ref="pageNavLabel" class="ht-page-navigation-section__label"></span>\n      <button data-ref="next" class="ht-page-navigation-section__button ht-page-next"></button>\n      <button data-ref="last" class="ht-page-navigation-section__button ht-page-last"></button>\n    </nav>\n  </div>\n</div>\n'),{container:n,first:r,prev:i,next:o,last:a,pageSizeSelect:s}=t.refs;_me(Hme,this,t.refs),n.setAttribute("dir",Dme(Fme,this)?"rtl":"ltr"),n.tabIndex=-1;const l=(e,t,n)=>{t.addEventListener(e,e=>{(e=>e.currentTarget.disabled)(e)||n()})};l("click",r,()=>this.runLocalHooks("firstPageClick")),l("click",i,()=>this.runLocalHooks("prevPageClick")),l("click",o,()=>this.runLocalHooks("nextPageClick")),l("click",a,()=>this.runLocalHooks("lastPageClick")),s.addEventListener("change",()=>{const e="auto"===s.value?"auto":Number.parseInt(s.value,10);this.runLocalHooks("pageSizeChange",e)}),this.setCounterSectionVisibility(!1),this.setNavigationSectionVisibility(!1),this.setPageSizeSectionVisibility(!1),Dme(jme,this)?(Dme(jme,this).appendChild(t.fragment),KB(n,[Dme(Lme,this),"handsontable"])):Dme(Pme,this).after(t.fragment)}getContainer(){return Dme(Hme,this).container}getFocusableElements(){const{first:e,prev:t,next:n,last:r,pageSizeSelect:i}=Dme(Hme,this);return[i,e,t,n,r].filter(e=>!e.disabled)}updateWidth(e){return Dme(Hme,this).container.style.width="".concat(e,"px"),this}updateTheme(e){if(_me(Lme,this,e),Dme(jme,this)){const{container:e}=Dme(Hme,this);$B(e,/ht-theme-.*/g),Dme(Lme,this)&&KB(e,Dme(Lme,this))}return this}getHeight(){return Dme(Hme,this).container.offsetHeight}refreshBorderState(){const{container:e}=Dme(Hme,this);return Dme(jme,this)||Dme(zme,this).call(this)?KB(e,"ht-pagination--bordered"):$B(e,"ht-pagination--bordered"),this}updateState(e){let{currentPage:t,totalPages:n,firstVisibleRowIndex:r,lastVisibleRowIndex:i,totalRenderedRows:o,pageSizeList:a,pageSize:s,autoPageSize:l}=e;const{first:c,prev:u,next:d,last:h,pageCounterSection:f,pageNavSection:m,pageNavLabel:p,pageSizeSelect:g,pageSizeLabel:v}=Dme(Hme,this),y=Dme(Bme,this).call(this,kX,{start:r+1,end:i+1,total:o}),b=Dme(Bme,this).call(this,MX,{currentPage:t,totalPages:n}),w=Dme(Bme,this).call(this,RX);f.textContent=y,p.textContent=b,g.textContent="",v.textContent="".concat(w,":"),XB(m,[IL(Dme(Bme,this).call(this,TX))]),XB(g,[IL(Dme(Bme,this).call(this,RX))]),Dme(Wme,this).call(this,b),this.refreshBorderState(),a.forEach(e=>{const t="auto"===e?Dme(Bme,this).call(this,AX):e,n=new Option(t,e);(l&&"auto"===e||!l&&e===s)&&(n.selected=!0),g.add(n)});const x=1===t,S=t===n;if("none"!==m.style.display){const e=Dme(Pme,this).ownerDocument.activeElement;x?(KB(c,"ht-page-navigation-section__button--disabled"),KB(u,"ht-page-navigation-section__button--disabled"),c.disabled=!0,u.disabled=!0):($B(c,"ht-page-navigation-section__button--disabled"),$B(u,"ht-page-navigation-section__button--disabled"),c.disabled=!1,u.disabled=!1),S?(KB(d,"ht-page-navigation-section__button--disabled"),KB(h,"ht-page-navigation-section__button--disabled"),d.disabled=!0,h.disabled=!0):($B(d,"ht-page-navigation-section__button--disabled"),$B(h,"ht-page-navigation-section__button--disabled"),d.disabled=!1,h.disabled=!1),[c,u,d,h].includes(e)&&(u.disabled?d.focus():d.disabled&&u.focus())}return XB(c,[IL(Dme(Bme,this).call(this,DX)),FL(x)]),XB(u,[IL(Dme(Bme,this).call(this,_X)),FL(x)]),XB(d,[IL(Dme(Bme,this).call(this,OX)),FL(S)]),XB(h,[IL(Dme(Bme,this).call(this,IX)),FL(S)]),this}setPageSizeSectionVisibility(e){const{pageSizeSection:t,pageSizeSelect:n}=Dme(Hme,this);return t.style.display=e?"":"none",n.disabled=!e,Ome(Vme,this,qme).call(this),this}setCounterSectionVisibility(e){return Dme(Hme,this).pageCounterSection.style.display=e?"":"none",Ome(Vme,this,qme).call(this),this}setNavigationSectionVisibility(e){const{pageNavSection:t,first:n,prev:r,next:i,last:o}=Dme(Hme,this);return t.style.display=e?"":"none",n.disabled=!e,r.disabled=!e,i.disabled=!e,o.disabled=!e,Ome(Vme,this,qme).call(this),this}destroy(){var e;null===(e=Dme(Hme,this))||void 0===e||e.container.remove(),_me(Hme,this,null)}}function qme(){const{container:e,pageSizeSection:t,pageCounterSection:n,pageNavSection:r}=Dme(Hme,this),i="none"!==t.style.display||"none"!==n.style.display||"none"!==r.style.display;Dme(jme,this)||(i?KB(Dme(Pme,this).querySelector(".ht-wrapper"),"htPagination"):$B(Dme(Pme,this).querySelector(".ht-wrapper"),"htPagination")),e.style.display=i?"":"none"}ZL(Ume,oK);const Gme=["nestedRows","mergeCells","fixedRowsTop","fixedRowsBottom"];function Yme(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Kme(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const $me=new Map([["fixed",class{constructor(){Yme(this,"pageSize",1),Yme(this,"totalItems",0),Yme(this,"totalPages",0)}calculate(e){let{pageSize:t,totalItems:n}=e;this.pageSize=Math.max(t,1),this.totalItems=n,this.totalPages=Math.max(1,Math.ceil(this.totalItems/this.pageSize))}getTotalPages(){return this.totalPages}getState(e){if((e-=1)<0||e>=this.getTotalPages())return;const t=e*this.pageSize;return{startIndex:t,endIndex:Math.max(0,Math.min(t+this.pageSize-1,this.totalItems-1)),pageSize:this.pageSize}}}],["auto",class{constructor(){Kme(this,"pages",[])}calculate(e){let{itemsSizeProvider:t,viewportSizeProvider:n}=e;const r=t(),i=n(),o=[];let a=0,s=0,l=0;for(let c=0;c<r.length;c++){const e=r[c];l>0&&s+e>=i&&(o.push({startIndex:a,endIndex:c-1,pageSize:l}),a=c,s=0,l=0),s+=e,l+=1}o.push({startIndex:a,endIndex:Math.max(0,r.length-1),pageSize:l}),this.pages=o}getTotalPages(){return this.pages.length}getState(e){if(!((e-=1)<0||e>=this.getTotalPages()))return this.pages[e]}}]]);function Xme(e){if(!$me.has(e))throw new Error("Unknown pagination strategy type: ".concat(e));return new($me.get(e))}var Qme;function Jme(e,t,n){Zme(e,t),t.set(e,n)}function Zme(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function epe(e,t){return e.get(npe(e,t))}function tpe(e,t,n){return e.set(npe(e,t),n),n}function npe(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const rpe="pagination",ipe="plugin:".concat(rpe),ope=ZH(Qme||(Qme=RH(["The `auto` page size setting requires the `autoRowSize` \n  plugin to be enabled. Set the `autoRowSize: true` in the configuration to ensure correct behavior."],["The \\`auto\\` page size setting requires the \\`autoRowSize\\`\\x20\n  plugin to be enabled. Set the \\`autoRowSize: true\\` in the configuration to ensure correct behavior."])));var ape=new WeakMap,spe=new WeakMap,lpe=new WeakMap,cpe=new WeakMap,upe=new WeakMap,dpe=new WeakMap,hpe=new WeakMap,fpe=new WeakSet,mpe=new WeakMap;class ppe extends T5{constructor(){super(...arguments),function(e,t){Zme(e,t),t.add(e)}(this,fpe),Jme(this,ape,null),Jme(this,spe,1),Jme(this,lpe,10),Jme(this,cpe,null),Jme(this,upe,null),Jme(this,dpe,!1),Jme(this,hpe,!1),Jme(this,mpe,()=>{var e;!epe(dpe,this)&&null!==(e=this.hot)&&void 0!==e&&e.view&&npe(fpe,this,vpe).call(this)})}static get PLUGIN_KEY(){return rpe}static get PLUGIN_PRIORITY(){return 900}static get DEFAULT_SETTINGS(){return{pageSize:10,pageSizeList:["auto",5,10,20,50,100],initialPage:1,showPageSize:!0,showCounter:!0,showNavigation:!0,uiContainer:null}}isEnabled(){return!!this.hot.getSettings()[rpe]}enablePlugin(){var e,t=this;if(function(e){return Gme.some(t=>{const n=!!e[t];return n&&hW(ZH(Ime||(Ime=RH(["The `pagination` plugin cannot be used with the `","` option. \n                        This combination is not supported. The plugin will remain disabled."],["The \\`pagination\\` plugin cannot be used with the \\`","\\` option.\\x20\n                        This combination is not supported. The plugin will remain disabled."])),t)),n})}(this.hot.getSettings()))return void(this.hot.getSettings()[rpe]=!1);if(this.enabled)return;const n=this.hot.getSettings()[rpe];void 0!==(null===n||void 0===n?void 0:n.initialPage)&&tpe(spe,this,this.getSetting("initialPage")),void 0!==(null===n||void 0===n?void 0:n.pageSize)&&tpe(lpe,this,this.getSetting("pageSize")),tpe(ape,this,this.hot.rowIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding",!1)),"auto"!==epe(lpe,this)||null!==(e=this.hot.getPlugin("autoRowSize"))&&void 0!==e&&e.enabled||hW(ope),tpe(upe,this,Xme("auto"===epe(lpe,this)?"auto":"fixed")),epe(cpe,this)||(tpe(cpe,this,new Ume({rootElement:this.hot.rootGridElement,uiContainer:this.getSetting("uiContainer"),isRtl:this.hot.isRtl(),themeName:this.hot.getSettings().themeName,phraseTranslator:function(){return t.hot.getTranslatedPhrase(...arguments)},shouldHaveBorder:()=>npe(fpe,this,ype).call(this),a11yAnnouncer:e=>function(e){O1&&(O1.textContent="",setTimeout(()=>{O1&&(O1.textContent=e)},100))}(e)})),npe(fpe,this,gpe).call(this),epe(cpe,this).addLocalHook("firstPageClick",()=>this.firstPage()).addLocalHook("prevPageClick",()=>this.prevPage()).addLocalHook("nextPageClick",()=>this.nextPage()).addLocalHook("lastPageClick",()=>this.lastPage()).addLocalHook("pageSizeChange",e=>this.setPageSize(e))),this.addHook("init",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return npe(fpe,t,Rpe).call(t,...n)},-1),this.addHook("beforeSelectAll",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return npe(fpe,t,xpe).call(t,...n)}),this.addHook("beforeSelectColumns",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return npe(fpe,t,xpe).call(t,...n)}),this.addHook("beforeSetRangeEnd",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return npe(fpe,t,Spe).call(t,...n)}),this.addHook("beforeSelectionHighlightSet",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return npe(fpe,t,Cpe).call(t,...n)}),this.addHook("beforePaste",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return npe(fpe,t,Epe).call(t,...n)}),this.addHook("afterViewRender",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return npe(fpe,t,Npe).call(t,...n)}),this.addHook("afterRender",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return npe(fpe,t,Tpe).call(t,...n)}),this.addHook("afterScrollVertically",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return npe(fpe,t,kpe).call(t,...n)}),this.addHook("afterLanguageChange",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return npe(fpe,t,Mpe).call(t,...n)}),this.addHook("beforeHeightChange",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return npe(fpe,t,Ape).call(t,...n)}),this.addHook("afterSetTheme",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return npe(fpe,t,Dpe).call(t,...n)}),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",epe(mpe,this)),npe(fpe,this,bpe).call(this),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),npe(fpe,this,vpe).call(this),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.removeLocalHook("cacheUpdated",epe(mpe,this)).unregisterMap(this.pluginName),npe(fpe,this,wpe).call(this),epe(cpe,this).destroy(),tpe(cpe,this,null),super.disablePlugin()}getPaginationData(){const e=epe(upe,this).getTotalPages();let t=-1,n=-1;const{pageSize:r,startIndex:i}=epe(upe,this).getState(epe(spe,this)),o=this.hot.countRows();let a=0;for(let s=i;a<r&&!(s>=o);s++)this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(s))||(-1===t&&(t=s),n=s,a+=1);return{currentPage:epe(spe,this),totalPages:e,pageSize:r,pageSizeList:[...this.getSetting("pageSizeList")],autoPageSize:"auto"===epe(lpe,this),numberOfRenderedRows:this.hot.rowIndexMapper.getRenderableIndexesLength(),firstVisibleRowIndex:t,lastVisibleRowIndex:n}}setPage(e){const t=epe(spe,this);!1!==this.hot.runHooks("beforePageChange",t,e)&&(tpe(spe,this,e),npe(fpe,this,vpe).call(this),this.hot.scrollViewportTo({row:0}),this.hot.runHooks("afterPageChange",t,epe(spe,this)),this.hot.view.adjustElementsSize(),this.hot.render())}resetPage(){this.setPage(this.getSetting("initialPage"))}setPageSize(e){var t;const n=epe(lpe,this);!1!==this.hot.runHooks("beforePageSizeChange",n,e)&&("auto"!==e||null!==(t=this.hot.getPlugin("autoRowSize"))&&void 0!==t&&t.enabled||hW(ope),tpe(upe,this,Xme("auto"===e?"auto":"fixed")),tpe(lpe,this,e),npe(fpe,this,vpe).call(this),this.hot.runHooks("afterPageSizeChange",n,epe(lpe,this)),this.hot.view.adjustElementsSize(),this.hot.render())}resetPageSize(){this.setPageSize(this.getSetting("pageSize"))}resetPagination(){this.resetPage(),this.resetPageSize(),npe(fpe,this,gpe).call(this)}nextPage(){this.setPage(epe(spe,this)+1)}prevPage(){this.setPage(epe(spe,this)-1)}firstPage(){this.setPage(1)}lastPage(){this.setPage(epe(upe,this).getTotalPages())}hasPreviousPage(){return epe(spe,this)>1}hasNextPage(){return epe(spe,this)<epe(upe,this).getTotalPages()}getCurrentPageData(){const{firstVisibleRowIndex:e,lastVisibleRowIndex:t}=this.getPaginationData();return-1===e||-1===t?[]:this.hot.getData(e,0,t,this.hot.countCols()-1)}showPageSizeSection(){epe(cpe,this).setPageSizeSectionVisibility(!0),this.hot.runHooks("afterPageSizeVisibilityChange",!0)}hidePageSizeSection(){epe(cpe,this).setPageSizeSectionVisibility(!1),this.hot.runHooks("afterPageSizeVisibilityChange",!1)}showPageCounterSection(){epe(cpe,this).setCounterSectionVisibility(!0),this.hot.runHooks("afterPageCounterVisibilityChange",!0)}hidePageCounterSection(){epe(cpe,this).setCounterSectionVisibility(!1),this.hot.runHooks("afterPageCounterVisibilityChange",!1)}showPageNavigationSection(){epe(cpe,this).setNavigationSectionVisibility(!0),this.hot.runHooks("afterPageNavigationVisibilityChange",!0)}hidePageNavigationSection(){epe(cpe,this).setNavigationSectionVisibility(!1),this.hot.runHooks("afterPageNavigationVisibilityChange",!1)}destroy(){var e;tpe(ape,this,null),tpe(upe,this,null),null===(e=epe(cpe,this))||void 0===e||e.destroy(),tpe(cpe,this,null),super.destroy()}}function gpe(){this.getSetting("showPageSize")?this.showPageSizeSection():this.hidePageSizeSection(),this.getSetting("showCounter")?this.showPageCounterSection():this.hidePageCounterSection(),this.getSetting("showNavigation")?this.showPageNavigationSection():this.hidePageNavigationSection()}function vpe(){tpe(dpe,this,!0),epe(ape,this).clear();const e=this.hot.rowIndexMapper.getRenderableIndexes(),t=e.length,{stylesHandler:n}=this.hot;epe(upe,this).calculate({pageSize:epe(lpe,this),totalItems:t,viewportSizeProvider:()=>{const{view:e}=this.hot;if(e.isVerticallyScrollableByWindow()){const t=getComputedStyle(this.hot.rootDocument.body),n=Number.parseInt(t.marginTop,10)+Number.parseInt(t.marginBottom,10),r=this.hot.hasColHeaders()?e._wt.wtTable.getColumnHeaderHeight():0,i=epe(cpe,this).getHeight();return e.getWorkspaceHeight()-i-r-n}const t=e.hasHorizontalScroll()?kz():0;return e.getViewportHeight()-t},itemsSizeProvider:()=>this.hot.rowIndexMapper.getRenderableIndexes().map(e=>{var t;const r=this.hot.toVisualRow(e);return null!==(t=this.hot.getRowHeight(r))&&void 0!==t?t:n.getDefaultRowHeight(r)})});const r=epe(upe,this).getTotalPages();if(tpe(spe,this,pV(epe(spe,this),1,r)),e.length>0){const{startIndex:t,pageSize:n}=epe(upe,this).getState(epe(spe,this));e.splice(t,n)}e.length>0?this.hot.batchExecution(()=>{e.forEach(e=>epe(ape,this).setValueAtIndex(e,!0))},!0):this.hot.rowIndexMapper.updateCache(!0),tpe(dpe,this,!1);const i=this.getPaginationData();epe(cpe,this).updateState(E(E({},i),{},{totalRenderedRows:t}))}function ype(){if(!this.hot.view)return!0;const{view:e}=this.hot;if(e.isVerticallyScrollableByWindow())return!1;if(e.hasHorizontalScroll()||e.getTableHeight()<e.getWorkspaceHeight())return!0;const{lastVisibleRowIndex:t}=this.getPaginationData();return e.getLastFullyVisibleRow()!==t}function bpe(){this.hot.getFocusScopeManager().registerScope(rpe,epe(cpe,this).getContainer(),{shortcutsContextName:ipe,runOnlyIf:()=>this.getSetting("showPageSize")||this.getSetting("showNavigation"),onActivate:e=>{const t=epe(cpe,this).getFocusableElements();t.length>0&&("tab_from_above"===e?t.at(0).focus():"tab_from_below"===e&&t.at(-1).focus())}})}function wpe(){this.hot.getFocusScopeManager().unregisterScope(rpe)}function xpe(e,t){const{firstVisibleRowIndex:n,lastVisibleRowIndex:r}=this.getPaginationData();(epe(spe,this)>1||e.row>=0)&&(e.row=n),t.row=r}function Spe(e){if(this.hot.selection.isSelectedByColumnHeader()){const{lastVisibleRowIndex:t}=this.getPaginationData();e.row=t}}function Cpe(){if(!this.hot.getSettings().navigableHeaders)return;const e=this.hot.getSelectedRangeLast();if(!e.isSingle()){const{highlight:t}=e;t.row=pV(t.row,e.getTopStartCorner().row,e.getBottomEndCorner().row)}}function Epe(e,t){const{firstVisibleRowIndex:n,lastVisibleRowIndex:r}=this.getPaginationData();if(-1===n||-1===r)return!1;t.forEach(t=>{let{startRow:n}=t;if(0===e.length)return;const i=Math.min(e.length-(r-n+1),e.length);e.splice(0,i)})}function Npe(){"auto"!==epe(lpe,this)||epe(hpe,this)?tpe(hpe,this,!1):(npe(fpe,this,vpe).call(this),tpe(hpe,this,!0),this.hot.view.adjustElementsSize(),this.hot.render())}function Tpe(){const{view:e}=this.hot,t=e.isHorizontallyScrollableByWindow()?e.getTotalTableWidth():e.getWorkspaceWidth();epe(cpe,this).updateWidth(t).refreshBorderState()}function Ape(e){if(this.getSetting("uiContainer"))return e;if(!("number"===typeof e||"string"===typeof e&&/^\d+$/.test(e)||"string"===typeof e&&e.endsWith("px")))return e;const t="string"===typeof e&&e.endsWith("px")?e:"".concat(e,"px");return"calc(".concat(t," - ").concat(epe(cpe,this).getHeight(),"px)")}function Rpe(){"auto"!==epe(lpe,this)&&npe(fpe,this,vpe).call(this)}function kpe(){epe(cpe,this).refreshBorderState()}function Mpe(){npe(fpe,this,vpe).call(this)}function Dpe(e){epe(cpe,this).updateTheme(e)}function _pe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ope=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;_pe(this,"rootWindow",void 0),_pe(this,"prefix",void 0),_pe(this,"savedKeys",[]),this.rootWindow=t,this.prefix=e,this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(e),JSON.stringify(t)),-1===this.savedKeys.indexOf(e)&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const n="undefined"===typeof e?t:e,r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(n));return null===r?void 0:JSON.parse(r)}reset(e){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(e))}resetAll(){WH(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(this.savedKeys[t]))}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),t="string"===typeof e?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}};function Ipe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}_W.getSingleton().register("persistentStateSave"),_W.getSingleton().register("persistentStateLoad"),_W.getSingleton().register("persistentStateReset");const Ppe="persistentState",jpe=new WeakSet;class Fpe extends T5{constructor(){super(...arguments),Ipe(this,"storage",void 0)}static get PLUGIN_KEY(){return Ppe}static get PLUGIN_PRIORITY(){return 0}isEnabled(){return!!this.hot.getSettings()[Ppe]}enablePlugin(){this.enabled||(jpe.has(this.hot)||(jpe.add(this.hot),fW("The PersistentState plugin is deprecated and will be removed in version 17.0. Please update your settings to ensure compatibility with future versions.")),this.storage||(this.storage=new Ope(this.hot.rootContainer.id||this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){"undefined"===typeof e?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Hpe(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Lpe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bpe(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const zpe="search",Wpe=function(e,t,n,r,i){e.getCellMeta(t,n).isSearchResult=i},Vpe=function(e,t,n){return!(rL(e)||null===e||!e.toLocaleLowerCase||0===e.length)&&(!rL(t)&&null!==t&&-1!==t.toString().toLocaleLowerCase(n.locale).indexOf(e.toLocaleLowerCase(n.locale)))};var Upe=new WeakSet;class qpe extends T5{constructor(){super(...arguments),Hpe(this,Upe),Lpe(this,"callback",Wpe),Lpe(this,"queryMethod",Vpe),Lpe(this,"searchResultClass","htSearchResult")}static get PLUGIN_KEY(){return zpe}static get PLUGIN_PRIORITY(){return 190}isEnabled(){return this.hot.getSettings()[zpe]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[zpe];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Bpe(Upe,e,Gpe).call(e,...n)}),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Bpe(Upe,e,Gpe).call(e,...n)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod();const r=this.hot.countRows(),i=this.hot.countCols(),o=[],a=this.hot;return hV(0,r-1,r=>{hV(0,i-1,i=>{const s=this.hot.getDataAtCell(r,i),l=this.hot.getCellMeta(r,i),c=l.search.callback||t,u=(l.search.queryMethod||n)(e,s,l);if(u){const e={row:r,col:i,data:s};o.push(e)}c&&c(a,r,i,s,u)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){tB(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function Gpe(e,t,n,r,i,o){const a=o.className||[];let s=[];"string"===typeof a?s=a.split(" "):s.push(...a),this.isEnabled()&&o.isSearchResult?s.includes(this.searchResultClass)||s.push("".concat(this.searchResultClass)):s.includes(this.searchResultClass)&&s.splice(s.indexOf(this.searchResultClass),1),o.className=s.join(" ")}function Ype(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Kpe{constructor(e){Ype(this,"viewportWidth",void 0),Ype(this,"overwriteColumnWidthFn",void 0),Ype(this,"baseWidths",new Map),Ype(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:t}=e;this.viewportWidth=t,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,t){this.baseWidths.set(e,t)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class $pe extends Kpe{calculate(){const e=Array.from(this.baseWidths).reduce((e,t)=>{let[,n]=t;return e+n},0);if(this.viewportWidth-e<0)return void this.stretchedWidths.clear();const t=this.viewportWidth/e,n=[],r=[];let i=this.viewportWidth,o=0;if(this.baseWidths.forEach((e,a)=>{const s=Math.round(e*t),l=this.overwriteColumnWidthFn(s,a);s===l&&s>=BG?(n.push([a,l]),o+=l):s!==l&&(n.push([a,l]),r.push(a),i-=l)}),i<=BG)return void this.stretchedWidths.clear();const a=i/o;let s=-1,l=0;n.forEach((e,t)=>{let[i,o]=e,c=o;r.includes(i)||(c=Math.round(o*a)),this.stretchedWidths.set(i,c),s=i,t<n.length-1&&(l+=c)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(s,Math.round(this.viewportWidth-l))}}function Xpe(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function Qpe(e,t){return e.get(Zpe(e,t))}function Jpe(e,t,n){return e.set(Zpe(e,t),n),n}function Zpe(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var ege=new WeakMap,tge=new WeakMap;class nge extends Kpe{constructor(){super(...arguments),Xpe(this,ege,0),Xpe(this,tge,-1)}prepare(e){super.prepare(e),Jpe(ege,this,0),Jpe(tge,this,-1)}setColumnBaseWidth(e,t){super.setColumnBaseWidth(e,t),Jpe(tge,this,e),Jpe(ege,this,t)}calculate(){if(-1===Qpe(tge,this))return;const e=Array.from(this.baseWidths).reduce((e,t)=>{let[,n]=t;return e+n},0),t=Math.max(this.viewportWidth-e+Qpe(ege,this),0);this.stretchedWidths.set(Qpe(tge,this),t)}}function rge(e,t,n){ige(e,t),t.set(e,n)}function ige(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oge(e,t){return e.get(sge(e,t))}function age(e,t,n){return e.set(sge(e,t),n),n}function sge(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var lge=new WeakMap,cge=new WeakMap,uge=new WeakMap,dge=new WeakMap,hge=new WeakSet;class fge{constructor(e){!function(e,t){ige(e,t),t.add(e)}(this,hge),rge(this,lge,void 0),rge(this,cge,void 0),rge(this,uge,new Map([["all",new $pe(sge(hge,this,gge).bind(this))],["last",new nge(sge(hge,this,gge).bind(this))]])),rge(this,dge,"none"),age(lge,this,e),age(cge,this,oge(lge,this).columnIndexMapper.createAndRegisterIndexMap("stretchColumns","physicalIndexToValue"))}useStrategy(e){age(dge,this,oge(uge,this).has(e)?e:"none")}refreshStretching(){"none"!==oge(dge,this)?oge(lge,this).batchExecution(()=>{oge(cge,this).clear();const e=oge(uge,this).get(oge(dge,this));let t=oge(lge,this).view.getViewportWidth();sge(hge,this,mge).call(this)&&(t-=kz(oge(lge,this).rootDocument)),e.prepare({viewportWidth:t});for(let n=0;n<oge(lge,this).countCols();n++)oge(lge,this).columnIndexMapper.isHidden(oge(lge,this).toPhysicalColumn(n))||e.setColumnBaseWidth(n,sge(hge,this,pge).call(this,n));e.calculate(),e.getWidths().forEach(e=>{let[t,n]=e;oge(cge,this).setValueAtIndex(oge(lge,this).toPhysicalColumn(t),n)})},!0):oge(cge,this).clear()}getStretchedWidth(e){return oge(cge,this).getValueAtIndex(oge(lge,this).toPhysicalColumn(e))}}function mge(){const{view:e,stylesHandler:t}=oge(lge,this);if(e.isVerticallyScrollableByWindow())return!1;const n=e.getViewportHeight(),r=oge(lge,this).countRows(),i=t.getDefaultRowHeight(),o=t.isClassicTheme(),a=e=>o&&0===e?1:0;let s=0,l=!1;for(let u=0;u<r;u++){var c;if(!oge(lge,this).rowIndexMapper.isHidden(oge(lge,this).toPhysicalRow(u))&&(s+=(null!==(c=oge(lge,this).getRowHeight(u))&&void 0!==c?c:i)+a(u),s>n)){l=!0;break}}return l}function pge(e){var t;return null!==(t=oge(lge,this).getColWidth(e,"StretchColumns"))&&void 0!==t?t:BG}function gge(e,t){return oge(lge,this).runHooks("beforeStretchingColumnWidth",e,t)}function vge(e,t,n){yge(e,t),t.set(e,n)}function yge(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bge(e,t,n){return e.set(xge(e,t),n),n}function wge(e,t){return e.get(xge(e,t))}function xge(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Sge=new WeakMap,Cge=new WeakMap,Ege=new WeakMap,Nge=new WeakSet;class Tge extends T5{constructor(){super(...arguments),function(e,t){yge(e,t),t.add(e)}(this,Nge),vge(this,Sge,new fge(this.hot)),vge(this,Cge,null),vge(this,Ege,new ResizeObserver(e=>{requestAnimationFrame(()=>{var t;null!==(t=this.hot)&&void 0!==t&&t.view.isHorizontallyScrollableByWindow()&&e.forEach(e=>{let{contentRect:t}=e;null!==wge(Cge,this)&&wge(Cge,this)!==t.width&&(this.hot.view.adjustElementsSize(),this.hot.refreshDimensions()),bge(Cge,this,t.width)})})}))}static get PLUGIN_KEY(){return"stretchColumns"}static get PLUGIN_PRIORITY(){return 155}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(wge(Sge,this).useStrategy(this.hot.getSettings().stretchH),wge(Ege,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return xge(Nge,e,Rge).call(e,...n)}),this.addHook("modifyColWidth",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return xge(Nge,e,Age).call(e,...n)},10),super.enablePlugin())}updatePlugin(){wge(Sge,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),wge(Ege,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return wge(Sge,this).getStretchedWidth(e)}destroy(){wge(Ege,this).disconnect(),bge(Ege,this,null),bge(Sge,this,null),super.destroy()}}function Age(e,t,n){if(n===this.pluginName)return;const r=this.getColumnWidth(t);return"number"===typeof r?r:e}function Rge(e){e&&wge(Sge,this).refreshStretching()}function kge(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Mge(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dge(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var _ge=new WeakSet;class Oge extends T5{constructor(){super(...arguments),kge(this,_ge),Mge(this,"scrollbars",[]),Mge(this,"clones",[]),Mge(this,"lockedCollection",!1),Mge(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return"touchScroll"}static get PLUGIN_PRIORITY(){return 200}static get SETTING_KEYS(){return!0}isEnabled(){return hB()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>Dge(_ge,this,Ige).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>Dge(_ge,this,Pge).call(this)),this.addHook("afterMomentumScroll",()=>Dge(_ge,this,jge).call(this))}}function Ige(){if(this.lockedCollection)return;const{topOverlay:e,bottomOverlay:t,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),t.clone&&this.scrollbars.push(t),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function Pge(){this.freezeOverlays=!0,WH(this.clones,e=>{KB(e,"hide-tween")})}function jge(){this.freezeOverlays=!1,WH(this.clones,e=>{$B(e,"hide-tween"),KB(e,"show-tween")}),this.hot._registerTimeout(()=>{WH(this.clones,e=>{$B(e,"show-tween")})},400),WH(this.scrollbars,e=>{e.refresh(),e.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Fge(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Hge(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Lge="trimRows";var Bge,zge=new WeakSet;class Wge extends T5{constructor(){super(...arguments),Fge(this,zge),Hge(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Lge}static get PLUGIN_PRIORITY(){return 330}isEnabled(){return!!this.hot.getSettings()[Lge]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new bK),this.trimmedRowsMap.addLocalHook("init",()=>function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(zge,this,Vge).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Lge];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),WH(e,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),n=this.isValidConfig(e);let r=t;n&&(r=Array.from(new Set(t.concat(e))));!1!==this.hot.runHooks("beforeTrimRow",t,r,n)&&(n&&this.hot.batchExecution(()=>{WH(e,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0),this.hot.runHooks("afterTrimRow",t,r,n,n&&r.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),n=this.isValidConfig(e);let r=t;const i=this.trimmedRowsMap.getValues().slice(),o=e.length>0;n&&o&&(WH(e,e=>{i[e]=!1}),r=LH(i,(e,t,n)=>(t&&e.push(n),e),[]));!1!==this.hot.runHooks("beforeUntrimRow",t,r,n&&o)&&(n&&o&&this.trimmedRowsMap.setValues(i),this.hot.runHooks("afterUntrimRow",t,r,n&&o,n&&r.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(e=>Number.isInteger(e)&&e>=0&&e<t)}destroy(){super.destroy()}}function Vge(){const e=this.hot.getSettings()[Lge];Array.isArray(e)&&this.hot.batchExecution(()=>{WH(e,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function Uge(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class qge{constructor(e){Uge(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Gge(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Yge extends qge{constructor(e){let{stateBefore:t,range:n,type:r,alignment:i}=e;super("cell_alignment"),Gge(this,"stateBefore",void 0),Gge(this,"range",void 0),Gge(this,"type",void 0),Gge(this,"alignment",void 0),this.stateBefore=t,this.range=n,this.type=r,this.alignment=i}static startRegisteringEvents(e,t){e.addHook("beforeCellAlignment",(e,n,r,i)=>{t.done(()=>new Yge({stateBefore:e,range:n,type:r,alignment:i}))})}undo(e,t){WH(this.range,t=>{t.forAll((t,n)=>{t>=0&&n>=0&&e.setCellMeta(t,n,"className",this.stateBefore[t][n]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()}redo(e,t){$7(this.range,this.type,this.alignment,(t,n)=>e.getCellMeta(t,n),(t,n,r,i)=>e.setCellMeta(t,n,r,i)),e.addHookOnce("afterViewRender",t),e.render()}}function Kge(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class $ge extends qge{constructor(e){let{columns:t,finalIndex:n}=e;super("col_move"),Kge(this,"columns",void 0),Kge(this,"finalColumnIndex",void 0),this.columns=t.slice(),this.finalColumnIndex=n}static startRegisteringEvents(e,t){e.addHook("beforeColumnMove",(e,n)=>{!1!==e&&t.done(()=>new $ge({columns:e,finalIndex:n}))})}undo(e,t){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t);mae(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(e=>{let{from:t,to:r}=e;t<r&&(r-=1),n.moveColumn(r,t)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,t){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t),n.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function Xge(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Qge extends qge{constructor(e){let{currentSortState:t,newSortState:n}=e;super("col_sort"),Xge(this,"previousSortState",void 0),Xge(this,"nextSortState",void 0),this.previousSortState=t,this.nextSortState=n}static startRegisteringEvents(e,t){e.addHook("beforeColumnSort",(e,n,r)=>{r&&t.done(()=>new Qge({currentSortState:e,newSortState:n}))})}undo(e,t){const n=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting"),i=r.isEnabled()?r:n;this.previousSortState.length?i.sort(this.previousSortState):i.clearSort(),t()}redo(e,t){const n=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting");(r.isEnabled()?r:n).sort(this.nextSortState),t()}}function Jge(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Zge extends qge{constructor(e){let{index:t,amount:n}=e;super("insert_col"),Jge(this,"index",void 0),Jge(this,"amount",void 0),this.index=t,this.amount=n}static startRegisteringEvents(e,t){e.addHook("afterCreateCol",(e,n,r)=>{t.done(()=>new Zge({index:e,amount:n}),r)})}undo(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function eve(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class tve extends qge{constructor(e){let{index:t,amount:n}=e;super("insert_row"),eve(this,"index",void 0),eve(this,"amount",void 0),this.index=t,this.amount=n}static startRegisteringEvents(e,t){e.addHook("afterCreateRow",(e,n,r)=>{t.done(()=>new tve({index:e,amount:n}),r)})}undo(e,t){const n=e.countRows(),r=e.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function nve(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class rve extends qge{constructor(e){let{changes:t,selected:n,countCols:r,countRows:i}=e;super("change"),nve(this,"changes",void 0),nve(this,"selected",void 0),nve(this,"countCols",void 0),nve(this,"countRows",void 0),this.changes=t,this.selected=n,this.countCols=r,this.countRows=i}static startRegisteringEvents(e,t){e.addHook("beforeChange",function(n,r){const i=n&&n.length;if(!i)return;if(!n.find(e=>{const[,,t,n]=e;return t!==n}))return;t.done(()=>{const t=n.reduce((e,t)=>(e.push([...t]),e),[]);t.forEach(t=>{t[1]=e.propToCol(t[1])});const r=i>1?this.getSelected():[[t[0][0],t[0][1]]];return new rve({changes:t,selected:r,countCols:e.countCols(),countRows:e.countRows()})},r)})}undo(e,t){const n=QL(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(3,1);e.addHookOnce("afterChange",()=>{const n=e.countRows()-this.countRows;n>0&&e.alter("remove_row",null,n,"UndoRedo.undo");const r=e.countCols()-this.countCols;r>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,r,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1),t()}),e.setDataAtCell(n,null,null,"UndoRedo.undo")}redo(e,t){const n=QL(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(2,1);e.addHookOnce("afterChange",()=>{e.selectCells(this.selected,!1,!1),t()}),e.setDataAtCell(n,null,null,"UndoRedo.redo")}}function ive(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ove extends qge{constructor(e){let{conditionsStack:t,previousConditionsStack:n}=e;super("filter"),ive(this,"conditionsStack",void 0),ive(this,"previousConditionsStack",void 0),this.conditionsStack=t,this.previousConditionsStack=n}static startRegisteringEvents(e,t){e.addHook("beforeFilter",(e,n)=>{t.done(()=>new ove({conditionsStack:e,previousConditionsStack:n}))})}undo(e,t){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),n.importConditions(this.previousConditionsStack),n.filter()}redo(e,t){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),n.importConditions(this.conditionsStack),n.filter()}}function ave(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class sve extends qge{constructor(e){let{data:t,cellRange:n}=e;super("merge_cells"),ave(this,"cellRange",void 0),this.cellRange=n,this.data=t}static startRegisteringEvents(e,t){e.addHook("beforeMergeCells",(n,r)=>{if(r)return;const i=n.getTopStartCorner(),o=n.getBottomEndCorner(),a=e.getData(i.row,i.col,o.row,o.col);t.done(()=>new sve({data:a,cellRange:n}))})}undo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0);const r=this.cellRange.getTopStartCorner();e.populateFromArray(r.row,r.col,this.data,void 0,void 0,"MergeCells")}redo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange)}}function lve(e,t,n,r,i){const o=["visualRow","visualCol","row","col","prop"],a=o.length,s=[];return hV(r,i,r=>{hV(t,n,t=>{const n=e.getCellMeta(t,r);if(Object.keys(n).length!==a){const e=Object.fromEntries(Object.entries(n).filter(e=>{let[t]=e;return!1===o.includes(t)}));s.push([n.visualRow,n.visualCol,e])}})}),s}function cve(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class uve extends qge{constructor(e){let{index:t,indexes:n,data:r,amount:i,headers:o,columnPositions:a,rowPositions:s,fixedColumnsStart:l,removedCellMetas:c}=e;super("remove_col"),cve(this,"index",void 0),cve(this,"indexes",void 0),cve(this,"data",void 0),cve(this,"amount",void 0),cve(this,"headers",void 0),cve(this,"columnPositions",void 0),cve(this,"rowPositions",void 0),cve(this,"fixedColumnsStart",void 0),cve(this,"removedCellMetas",void 0),this.index=t,this.indexes=n,this.data=r,this.amount=i,this.headers=o,this.columnPositions=a.slice(0),this.rowPositions=s.slice(0),this.fixedColumnsStart=l,this.removedCellMetas=c}static startRegisteringEvents(e,t){e.addHook("beforeRemoveCol",(n,r,i,o)=>{t.done(()=>{const t=e.getSourceDataArray(),i=(e.countCols()+n)%e.countCols(),o=i+r-1,a=[],s=[],l=[];return hV(t.length-1,n=>{const r=[],s=t[n];hV(i,o,t=>{r.push(s[e.toPhysicalColumn(t)])}),a.push(r)}),hV(r-1,t=>{l.push(e.toPhysicalColumn(i+t))}),Array.isArray(e.getSettings().colHeaders)&&hV(r-1,t=>{s.push(e.getSettings().colHeaders[e.toPhysicalColumn(i+t)]||null)}),new uve({index:i,indexes:l,data:a,amount:r,headers:s,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:lve(e,0,e.countRows(),i,o)})},o)})}undo(e,t){e.getSettings().fixedColumnsStart=this.fixedColumnsStart;const n=this.indexes.slice(0).sort(),r=(e,t,r)=>r[this.indexes.indexOf(n[t])],i=this.data.length,o=[];for(let l=0;l<i;l++)o.push(zH(this.data[l],r));const a=zH(this.headers,r),s=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),WH(e.getSourceDataArray(),(e,t)=>{WH(n,(n,r)=>{e[n]=o[t][r],s.push([t,n,e[n]])})}),"undefined"!==typeof this.headers&&WH(a,(t,r)=>{e.getSettings().colHeaders[n[r]]=t}),this.removedCellMetas.forEach(t=>{let[n,r,i]=t;e.setCellMetaObject(n,r,i)}),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(s,null,null,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function dve(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class hve extends qge{constructor(e){let{index:t,data:n,fixedRowsBottom:r,fixedRowsTop:i,rowIndexesSequence:o,removedCellMetas:a}=e;super("remove_row"),dve(this,"index",void 0),dve(this,"data",void 0),dve(this,"fixedRowsBottom",void 0),dve(this,"fixedRowsTop",void 0),dve(this,"rowIndexesSequence",void 0),dve(this,"removedCellMetas",void 0),this.index=t,this.data=n,this.fixedRowsBottom=r,this.fixedRowsTop=i,this.rowIndexesSequence=o,this.removedCellMetas=a}static startRegisteringEvents(e,t){e.addHook("beforeRemoveRow",(n,r,i,o)=>{t.done(()=>{const t=e.toPhysicalRow(n),i=t+r-1,o=QL(e.getSourceData(t,0,t+r-1,e.countSourceCols()-1));return new hve({index:t,data:o,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:lve(e,t,i,0,e.countCols()-1)})},o)})}undo(e,t){const n=e.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((e,t)=>{Object.keys(e).forEach(n=>{const i=parseInt(n,10);r.push([this.index+t,isNaN(i)?n:i,e[n]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(t=>{let[n,r,i]=t;e.setCellMetaObject(n,r,i)}),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(r,null,null,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function fve(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class mve extends qge{constructor(e){let{rows:t,finalIndex:n}=e;super("row_move"),fve(this,"rows",void 0),fve(this,"finalRowIndex",void 0),this.rows=t.slice(),this.finalRowIndex=n}static startRegisteringEvents(e,t){e.addHook("beforeRowMove",(e,n)=>{!1!==e&&t.done(()=>new mve({rows:e,finalIndex:n}))})}undo(e,t){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t);mae(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(e=>{let{from:t,to:r}=e;t<r&&(r-=1),n.moveRow(r,t)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,t){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),n.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function pve(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class gve extends qge{constructor(e){let{cellRange:t}=e;super("unmerge_cells"),pve(this,"cellRange",void 0),this.cellRange=t}static startRegisteringEvents(e,t){e.addHook("afterUnmergeCells",(e,n)=>{n||t.done(()=>new gve({cellRange:e}))})}undo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange,!0)}redo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0),e.render()}}function vve(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function yve(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bve(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const wve="undoRedo";_W.getSingleton().register("beforeUndo"),_W.getSingleton().register("afterUndo"),_W.getSingleton().register("beforeRedo"),_W.getSingleton().register("afterRedo");const xve=new Set;var Sve=new WeakSet;class Cve extends T5{static get PLUGIN_KEY(){return"undoRedo"}static get PLUGIN_PRIORITY(){return 1e3}static get SETTING_KEYS(){return!0}constructor(e){var t,n;super(e),vve(this,Sve),yve(this,"doneActions",[]),yve(this,"undoneActions",[]),yve(this,"ignoreNewActions",!1),t=e,n=this,[Yge,$ge,Qge,Zge,tve,rve,ove,sve,uve,hve,mve,gve].forEach(e=>e.startRegisteringEvents(t,n))}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return bve(Sve,e,Eve).call(e,...n)}),this.registerShortcuts(),bve(Sve,this,Nve).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),bve(Sve,this,Tve).call(this)}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),t={runOnlyIf:e=>!e.altKey,group:wve};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],t)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(wve)}done(e,t){if(this.ignoreNewActions)return;if("UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t)return;const n=this.doneActions.slice();if(!1===this.hot.runHooks("beforeUndoStackChange",n,t))return;const r=e(),i=this.undoneActions.slice();this.doneActions.push(r),this.hot.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",i),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",i,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const t=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const n=QL(t);if(!1===this.hot.runHooks("beforeUndo",n))return;this.ignoreNewActions=!0;const r=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",r),t.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(t)}),this.hot.runHooks("afterRedoStackChange",r,this.undoneActions.slice()),this.hot.runHooks("afterUndo",n)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const t=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const n=QL(t);if(!1===this.hot.runHooks("beforeRedo",n))return;this.ignoreNewActions=!0;const r=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",r),t.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(t)}),this.hot.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.hot.runHooks("afterRedo",n)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function Eve(e,t){"loadData"===t&&this.clear()}function Nve(){const e=e=>{xve.has(e)||(hW(ZH(Bge||(Bge=RH(['The "','" method is deprecated and it will be removed \n          from the Core API in the future. Please use the method from the UndoRedo plugin \n          (e.g. `hotInstance.getPlugin("undoRedo").',"()`)."],['The "','" method is deprecated and it will be removed\\x20\n          from the Core API in the future. Please use the method from the UndoRedo plugin\\x20\n          (e.g. \\`hotInstance.getPlugin("undoRedo").',"()\\`)."])),e,e)),xve.add(e))};this.hot.undo=()=>{e("undo"),this.undo()},this.hot.redo=()=>{e("redo"),this.redo()},this.hot.isUndoAvailable=()=>(e("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(e("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{e("clear"),this.clear()},this.hot.undoRedo=this}function Tve(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}const Ave="ht-dialog";var Rve,kve;const Mve=new Map([["base",function(){let e=null;const t={};return{TEMPLATE_NAME:"base",dialogA11YOptions:()=>({role:"dialog"}),compile:function(){const n=eL(Rve||(Rve=RH(["",""])),'\n      <div data-ref="contentElement" class="'.concat(Ave,'__content"></div>\n    '));return Object.assign(t,n.refs),e=n.fragment,n},focusableElements:function(){if(null===e)throw new Error("Compile the template first.");return[]}}}],["confirm",function(e){let{id:t="",title:n="",description:r="",buttons:i=[]}=e,o=null;const a={};return{TEMPLATE_NAME:"confirm",dialogA11YOptions:()=>({role:"alertdialog",ariaLabelledby:"".concat(t,"-dialog-confirm-title"),ariaDescribedby:r?"".concat(t,"-dialog-confirm-description"):void 0}),compile:function(){const e=eL(kve||(kve=RH(["",""])),'\n      <div tabindex="-1" data-ref="contentElement" class="'.concat(Ave,'__content-wrapper-inner">\n        <div class="').concat(Ave,'__content">\n          <h2\n            id="').concat(t,'-dialog-confirm-title"\n            class="').concat(Ave,'__title">').concat(EL(n),'</h2>\n          <p\n            id="').concat(t,'-dialog-confirm-description"\n            class="').concat(Ave,'__description">').concat(EL(r),"</p>\n        </div>\n        ").concat(i.length>0?'\n          <div data-ref="buttonsContainer" class="'.concat(Ave,'__buttons">\n            ').concat(i.map(e=>'\n              <button class="ht-button ht-button--'.concat(e.type,'">').concat(EL(e.text),"</button>\n            ")).join(""),"\n          </div>\n        "):"","\n      </div>\n    "));return Object.assign(a,e.refs),o=e.fragment,e},focusableElements:function(){if(null===o)throw new Error("Compile the template first.");const{contentElement:e,buttonsContainer:t}=a,n=[];return t?n.push(...Array.from(t.children)):n.push(e),n}}}]]);var Dve,_ve;function Ove(e,t,n){Ive(e,t),t.set(e,n)}function Ive(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pve(e,t){return e.get(Fve(e,t))}function jve(e,t,n){return e.set(Fve(e,t),n),n}function Fve(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const Hve='\n<div data-ref="dialogElement" class="'.concat(Ave,'">\n  <div data-ref="dialogWrapperElement" class="').concat(Ave,'__content-wrapper">\n</div>\n');var Lve=new WeakMap,Bve=new WeakMap,zve=new WeakMap,Wve=new WeakMap,Vve=new WeakMap,Uve=new WeakMap,qve=new WeakSet;class Gve{constructor(e){let{rootElement:t,isRtl:n}=e;!function(e,t){Ive(e,t),t.add(e)}(this,qve),Ove(this,Lve,void 0),Ove(this,Bve,void 0),Ove(this,zve,!1),Ove(this,Wve,!1),Ove(this,Vve,Mve.get("base")),Ove(this,Uve,[]),jve(Lve,this,t),jve(zve,this,n),this.install()}useTemplate(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Mve.has(e)||"base"===e){const t=Array.from(Mve.keys()).filter(e=>"base"!==e).join(", ");throw new Error(ZH(Dve||(Dve=RH(["Invalid template: ",". \n        Valid templates are: ","."],["Invalid template: ",".\\x20\n        Valid templates are: ","."])),e,t))}jve(Vve,this,Mve.get(e)(n)),jve(Uve,this,(null!==(t=n.buttons)&&void 0!==t?t:[]).map(e=>e.callback))}useDefaultTemplate(){jve(Vve,this,Mve.get("base")()),jve(Uve,this,[])}install(){var e;if(null!==(e=Pve(Bve,this))&&void 0!==e&&e.dialogElement)return;const t=eL(_ve||(_ve=RH(["",""])),Hve);jve(Bve,this,t.refs);const{dialogElement:n}=Pve(Bve,this);XB(n,[["aria-modal","true"],["dir",Pve(zve,this)?"rtl":"ltr"]]),n.addEventListener("transitionstart",()=>Fve(qve,this,Kve).call(this)),n.addEventListener("transitionend",()=>Fve(qve,this,Yve).call(this)),Pve(Lve,this).after(t.fragment)}getContainer(){return Pve(Bve,this).dialogElement}getFocusableElements(){return Pve(Vve,this).focusableElements()}updateDialog(e){let{isVisible:t,content:n,customClassName:r,background:i,contentBackground:o,animation:a,a11y:s}=e;const l=Pve(Vve,this).compile(),{dialogElement:c,dialogWrapperElement:u}=Pve(Bve,this);u.innerHTML="",u.appendChild(l.fragment),Object.assign(Pve(Bve,this),l.refs);const{contentElement:d,buttonsContainer:h}=Pve(Bve,this);"base"!==Pve(Vve,this).TEMPLATE_NAME&&Object.assign(s,Pve(Vve,this).dialogA11YOptions());const f=r?" ".concat(r):"",m=i?" ".concat(Ave,"--background-").concat(i):"",p=a?" ".concat(Ave,"--animation"):"",g=t?" ".concat(Ave,"--show"):"";var v;c.className=[Ave,"".concat(Ave,"--").concat(Pve(Vve,this).TEMPLATE_NAME),"handsontable",f,m,p,g].join(" "),XB(c,["base"===Pve(Vve,this).TEMPLATE_NAME?TL(-1):void 0]),XB(c,["alertdialog"===s.role?["role","alertdialog"]:["role","dialog"]]),s.ariaLabel&&!s.ariaLabelledby?XB(c,[s.ariaLabel?IL(s.ariaLabel):void 0]):QB(c,"aria-label"),s.ariaLabelledby?XB(c,[(v=s.ariaLabelledby,["aria-labelledby",v])]):QB(c,"aria-labelledby"),s.ariaDescribedby?XB(c,[PL(s.ariaDescribedby)]):QB(c,"aria-describedby");const y=o?" ".concat(Ave,"__content--background"):"";return KB(d,"".concat(Ave,"__content").concat(y)),"base"===Pve(Vve,this).TEMPLATE_NAME?(d.innerHTML="","string"===typeof n?tz(d,n):(n instanceof HTMLElement||n instanceof DocumentFragment)&&d.appendChild(n)):h&&Array.from(h.children).forEach((e,t)=>{const n=Pve(Uve,this)[t];n&&e.addEventListener("click",n)}),this}showDialog(e){const{dialogElement:t}=Pve(Bve,this);return t.style.display="block",e&&t.offsetHeight,KB(t,"".concat(Ave,"--show")),jve(Wve,this,!1),this}hideDialog(e){const{dialogElement:t}=Pve(Bve,this);return $B(t,"".concat(Ave,"--show")),(e&&!Pve(Wve,this)||!e)&&(t.style.display="none"),jve(Wve,this,!1),this}focusDialog(){Pve(Bve,this).dialogElement.focus()}updateWidth(e){return Pve(Bve,this).dialogElement.style.width="".concat(e,"px"),this}updateHeight(e){return Pve(Bve,this).dialogElement.style.height="calc(100% - ".concat(e,"px)"),this}destroyDialog(){var e;null===(e=Pve(Bve,this))||void 0===e||e.dialogElement.remove(),jve(Bve,this,null)}}function Yve(){const{dialogElement:e}=Pve(Bve,this);YB(e,"".concat(Ave,"--show"))||(e.style.display="none")}function Kve(){jve(Wve,this,!0)}function $ve(e,t,n){Xve(e,t),t.set(e,n)}function Xve(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qve(e,t,n){return e.set(Zve(e,t),n),n}function Jve(e,t){return e.get(Zve(e,t))}function Zve(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ZL(Gve,oK);const eye="dialog",tye=eye,nye="plugin:".concat(eye);var rye=new WeakMap,iye=new WeakMap,oye=new WeakMap,aye=new WeakSet;class sye extends T5{constructor(){super(...arguments),function(e,t){Xve(e,t),t.add(e)}(this,aye),$ve(this,rye,null),$ve(this,iye,!1),$ve(this,oye,null)}static get PLUGIN_KEY(){return eye}static get PLUGIN_PRIORITY(){return 360}static get DEFAULT_SETTINGS(){return{template:null,content:"",customClassName:"",background:"solid",contentBackground:!1,animation:!0,closable:!1,a11y:{role:"dialog",ariaLabel:"Dialog",ariaLabelledby:"",ariaDescribedby:""}}}static get SETTINGS_VALIDATORS(){return{template:e=>tB(e)&&typeof["alert","confirm"].includes(e.type)&&"string"===typeof e.title&&("undefined"===typeof(null===e||void 0===e?void 0:e.description)||"string"===typeof(null===e||void 0===e?void 0:e.description))&&("undefined"===typeof(null===e||void 0===e?void 0:e.buttons)||Array.isArray(null===e||void 0===e?void 0:e.buttons)&&e.buttons.every(e=>"object"===typeof e&&"string"===typeof e.text&&["primary","secondary"].includes(e.type)&&("undefined"===typeof e.callback||"function"===typeof e.callback))),content:e=>"string"===typeof e||"undefined"!==typeof HTMLElement&&e instanceof HTMLElement||"undefined"!==typeof DocumentFragment&&e instanceof DocumentFragment,customClassName:e=>"string"===typeof e,background:e=>["solid","semi-transparent"].includes(e),contentBackground:e=>"boolean"===typeof e,animation:e=>"boolean"===typeof e,closable:e=>"boolean"===typeof e,a11y:e=>tB(e)&&("undefined"===typeof(null===e||void 0===e?void 0:e.role)||["dialog","alertdialog"].includes(null===e||void 0===e?void 0:e.role))&&("undefined"===typeof(null===e||void 0===e?void 0:e.ariaLabel)||"string"===typeof(null===e||void 0===e?void 0:e.ariaLabel))&&("undefined"===typeof(null===e||void 0===e?void 0:e.ariaLabelledby)||"string"===typeof(null===e||void 0===e?void 0:e.ariaLabelledby))&&("undefined"===typeof(null===e||void 0===e?void 0:e.ariaDescribedby)||"string"===typeof(null===e||void 0===e?void 0:e.ariaDescribedby))}}isEnabled(){return!!this.hot.getSettings()[eye]}enablePlugin(){this.enabled||(Jve(rye,this)||Qve(rye,this,new Gve({rootElement:this.hot.rootGridElement,isRtl:this.hot.isRtl()})),Zve(aye,this,lye).call(this),Zve(aye,this,uye).call(this),this.addHook("afterViewRender",()=>Zve(aye,this,hye).call(this)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hide(),Zve(aye,this,cye).call(this),Zve(aye,this,dye).call(this),super.disablePlugin()}isVisible(){return Jve(iye,this)}show(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.enabled&&(this.isVisible()?this.update(e):(this.hot.runHooks("beforeDialogShow"),this.update(e),Jve(rye,this).showDialog(this.getSetting("animation")),Qve(iye,this,!0),this.hot.getFocusScopeManager().activateScope(eye),Qve(oye,this,this.hot.selection.exportSelection()),this.hot.deselectCell(),this.hot.runHooks("afterDialogShow")))}hide(){var e;this.isVisible()&&(this.hot.runHooks("beforeDialogHide"),Jve(rye,this).hideDialog(this.getSetting("animation")),Qve(iye,this,!1),this.hot.getFocusScopeManager().deactivateScope(eye),(null===(e=Jve(oye,this))||void 0===e?void 0:e.ranges.length)>0?(this.hot.selection.importSelection(Jve(oye,this)),this.hot.view.render(),Qve(oye,this,null)):this.hot.selectCell(0,0),this.hot.runHooks("afterDialogHide"))}update(e){if(!this.enabled)return;this.updatePluginSettings(e);const t=this.getSetting("template");if(t!==sye.DEFAULT_SETTINGS.template&&this.getSetting("content")!==sye.DEFAULT_SETTINGS.content)throw new Error("The `template` option cannot be used together with the `content` option.");t?Jve(rye,this).useTemplate(t.type,E({id:this.hot.guid},t)):Jve(rye,this).useDefaultTemplate(),Jve(rye,this).updateDialog({isVisible:this.isVisible(),content:this.getSetting("content"),customClassName:this.getSetting("customClassName"),background:this.getSetting("background"),contentBackground:this.getSetting("contentBackground"),animation:this.getSetting("animation"),a11y:this.getSetting("a11y")})}showAlert(e,t){const{title:n="Alert",description:r}=tB(e)?e:{title:e};this.show({template:{type:"confirm",title:n,description:r,buttons:[{text:this.hot.getTranslatedPhrase(XK),type:"primary",callback:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return null===t||void 0===t?void 0:t(...n)}}]},contentBackground:!1,background:"solid",animation:!0,closable:!1})}showConfirm(e,t,n){const{title:r="Confirm",description:i}=tB(e)?e:{title:e};this.show({template:{type:"confirm",title:r,description:i,buttons:[{text:this.hot.getTranslatedPhrase(QK),type:"secondary",callback:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return null===n||void 0===n?void 0:n(...t)}},{text:this.hot.getTranslatedPhrase(XK),type:"primary",callback:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return null===t||void 0===t?void 0:t(...n)}}]},contentBackground:!0,background:"semi-transparent",animation:!0,closable:!1})}focus(){Jve(rye,this).focusDialog()}destroy(){var e;null===(e=Jve(rye,this))||void 0===e||e.destroyDialog(),Qve(rye,this,null),Qve(iye,this,!1),Qve(oye,this,null),super.destroy()}}function lye(){var e;const t=this.hot.getShortcutManager(),n=null!==(e=t.getContext(nye))&&void 0!==e?e:t.addContext(nye);n.addShortcut({keys:[["Escape"]],callback:()=>{this.hide()},runOnlyIf:()=>Jve(iye,this)&&this.getSetting("closable"),group:tye}),n.addShortcut({keys:[["Shift","Tab"],["Tab"]],preventDefault:!1,callback:e=>{this.hot._registerTimeout(()=>{e.shiftKey?this.hot.runHooks("dialogFocusPreviousElement"):this.hot.runHooks("dialogFocusNextElement")})},group:tye})}function cye(){this.hot.getShortcutManager().getContext(nye).removeShortcutsByGroup(tye)}function uye(){this.hot.getFocusScopeManager().registerScope(eye,Jve(rye,this).getContainer(),{shortcutsContextName:nye,type:"modal",runOnlyIf:()=>this.isVisible(),onActivate:e=>{const t=this.hot.isListening(),n=Jve(rye,this).getFocusableElements();n.length>0?"tab_from_above"===e?n.at(0).focus():"tab_from_below"===e&&n.at(-1).focus():"tab_from_above"!==e&&"tab_from_below"!==e&&t&&!Jve(rye,this).getContainer().contains(this.hot.rootDocument.activeElement)&&Jve(rye,this).getContainer().focus(),t&&this.hot.runHooks("afterDialogFocus","unknown"===e?"show":e)}})}function dye(){this.hot.getFocusScopeManager().unregisterScope(eye)}function hye(){const{view:e,rootWrapperElement:t,rootWindow:n}=this.hot,r=e.isHorizontallyScrollableByWindow()?e.getTotalTableWidth():e.getWorkspaceWidth();Jve(rye,this).updateWidth(r);const i=t.querySelector(".hot-display-license-info");if(i){const e=i.offsetHeight,t=Number.parseFloat(n.getComputedStyle(i).marginTop);Jve(rye,this).updateHeight(e+t)}}function fye(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mye(e,t,n){return e.set(gye(e,t),n),n}function pye(e,t){return e.get(gye(e,t))}function gye(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const vye="loading",yye="ht-".concat(vye);var bye,wye,xye=new WeakMap,Sye=new WeakSet;class Cye extends T5{constructor(){super(...arguments),function(e,t){fye(e,t),t.add(e)}(this,Sye),function(e,t,n){fye(e,t),t.set(e,n)}(this,xye,null)}static get PLUGIN_KEY(){return vye}static get PLUGIN_PRIORITY(){return 350}static get DEFAULT_SETTINGS(){return{icon:'<svg class="'.concat(yye,'__icon-svg" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path stroke="currentColor" stroke-width="2" d="M15 8a7 7 0 1 1-3.5-6.062"></path></svg>'),title:void 0,description:""}}static get SETTINGS_VALIDATORS(){return{icon:e=>"string"===typeof e,title:e=>"string"===typeof e,description:e=>"string"===typeof e}}isEnabled(){return!!this.hot.getSettings()[vye]}enablePlugin(){if(!this.enabled){var e;if(null===pye(xye,this))mye(xye,this,this.hot.getPlugin("dialog")),null!==(e=pye(xye,this))&&void 0!==e&&e.isEnabled()||(this.hot.getSettings().dialog=!0),this.hot.addHook("afterDialogFocus",()=>gye(Sye,this,Eye).call(this));super.enablePlugin()}}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hide(),super.disablePlugin()}isVisible(){var e,t;return null!==(e=null===(t=pye(xye,this))||void 0===t?void 0:t.isVisible())&&void 0!==e&&e}show(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.isEnabled()||!pye(xye,this)||null===(e=pye(xye,this))||void 0===e||!e.isEnabled())return;if(this.isVisible())return void this.update(t);!1!==this.hot.runHooks("beforeLoadingShow")&&(this.update(t),pye(xye,this).show(),this.hot.runHooks("afterLoadingShow"))}hide(){var e;if(!pye(xye,this)||null===(e=pye(xye,this))||void 0===e||!e.isEnabled()||!this.isVisible())return;!1!==this.hot.runHooks("beforeLoadingHide")&&(pye(xye,this).hide(),this.hot.runHooks("afterLoadingHide"))}update(e){var t,n;if(!this.isEnabled()||!pye(xye,this)||null===(t=pye(xye,this))||void 0===t||!t.isEnabled())return;this.updatePluginSettings(e);const r=this.hot.guid,i=this.getSetting("icon"),o=null!==(n=this.getSetting("title"))&&void 0!==n?n:this.hot.getTranslatedPhrase(LX),a=this.getSetting("description"),s=function(e){let{id:t,icon:n,title:r,description:i}=e;return'\n    <div class="'.concat(yye,'__content">\n      <i class="').concat(yye,'__icon">').concat(n,'</i>\n      <div class="').concat(yye,'__text">\n        <h2 id="').concat(t,"-").concat(vye,'-title" class="').concat(yye,'__title">').concat(r,"</h2>\n        ").concat(i?'<p id="'.concat(t,"-").concat(vye,'-description" class="').concat(yye,'__description">').concat(i,"</p>"):"","\n      </div>\n    </div>\n  ")}({id:r,icon:i,title:o,description:a});pye(xye,this).update({content:s,customClassName:yye,background:0===this.hot.countSourceRows()?"solid":"semi-transparent",a11y:{role:"alertdialog",ariaLabelledby:"".concat(r,"-").concat(vye,"-title"),ariaDescribedby:a?"".concat(r,"-").concat(vye,"-description"):void 0}})}destroy(){mye(xye,this,null),super.destroy()}}function Eye(){pye(xye,this).focus()}function Nye(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function Tye(e,t){return e.get(Rye(e,t))}function Aye(e,t,n){return e.set(Rye(e,t),n),n}function Rye(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const kye="ht-empty-data-state",Mye='<div data-ref="emptyDataStateElement" class="'.concat(kye,' handsontable">\n  <div class="').concat(kye,'__content-wrapper">\n    <div data-ref="emptyDataStateInner" class="').concat(kye,'__content-wrapper-inner"></div>\n  </div>\n</div>');var Dye=new WeakMap,_ye=new WeakMap,Oye=new WeakMap,Iye=new WeakMap;class Pye{constructor(e){let{rootElement:t,rootDocument:n}=e;Nye(this,Dye,void 0),Nye(this,_ye,void 0),Nye(this,Oye,void 0),Nye(this,Iye,void 0),Aye(Dye,this,t),Aye(_ye,this,n),this.install()}install(){var e;if(null!==(e=Tye(Oye,this))&&void 0!==e&&e.emptyDataStateElement)return;const t=eL(bye||(bye=RH(["",""])),Mye);Aye(Oye,this,t.refs);const{emptyDataStateInner:n,emptyDataStateElement:r}=Tye(Oye,this);XB(n,[TL(-1)]),XB(r,[TL(-1)]),Tye(Dye,this).after(t.fragment)}getElement(){var e;return null===(e=Tye(Oye,this))||void 0===e?void 0:e.emptyDataStateElement}getFocusableElements(){const{emptyDataStateButtons:e,emptyDataStateInner:t}=Tye(Oye,this),n=Array.from(null===e||void 0===e?void 0:e.children);return 0===n.length?[t]:n}show(){var e;null!==(e=Tye(Oye,this))&&void 0!==e&&e.emptyDataStateElement&&(Tye(Oye,this).emptyDataStateElement.style.display="block")}hide(){var e,t;null!==(e=Tye(Oye,this))&&void 0!==e&&e.emptyDataStateElement&&(null===(t=Tye(Iye,this))||void 0===t||t.remove(),Aye(Iye,this,null),Tye(Oye,this).emptyDataStateElement.style.display="none")}updateContent(e){var t;const{emptyDataStateInner:n}=Tye(Oye,this);let r="";r="string"===typeof e?{title:e}:{title:null===e||void 0===e?void 0:e.title,description:null===e||void 0===e?void 0:e.description,buttons:null===e||void 0===e?void 0:e.buttons};const i=eL(wye||(wye=RH(["",""])),(e=>{let{title:t,description:n,buttons:r}=e;return'\n  <div class="'.concat(kye,'__content">\n    ').concat(t?'<h2 class="'.concat(kye,'__title">').concat(EL(t),"</h2>"):"","\n    ").concat(n?'<p class="'.concat(kye,'__description">').concat(EL(n),"</p>"):"",'\n  </div>\n  <div\n    data-ref="emptyDataStateButtons"\n    class="').concat(kye,"__buttons").concat((null===r||void 0===r?void 0:r.length)>0?" ".concat(kye,"__buttons--has-buttons"):"",'"\n  >').concat((null===r||void 0===r?void 0:r.length)>0?r.map(e=>'<button class="ht-button ht-button--'.concat(e.type,'">').concat(EL(e.text),"</button>")).join(""):"","</div>")})(r));Aye(Oye,this,E(E({},Tye(Oye,this)),i.refs)),n.innerHTML="",n.appendChild(i.fragment),(null===(t=r.buttons)||void 0===t?void 0:t.length)>0&&Array.from(Tye(Oye,this).emptyDataStateButtons.children).forEach((e,t)=>{e.addEventListener("click",r.buttons[t].callback)})}updateClassNames(e){const{emptyDataStateElement:t}=Tye(Oye,this);e.countRenderableColumns()>0&&e.getColumnHeadersCount()>0?KB(t,"".concat(kye,"--disable-top-border")):$B(t,"".concat(kye,"--disable-top-border")),e.countRenderableRows()>0&&e.getRowHeadersCount()>0?KB(t,"".concat(kye,"--disable-inline-border")):$B(t,"".concat(kye,"--disable-inline-border")),e.hasHorizontalScroll()&&!e.isHorizontallyScrollableByWindow()?KB(t,"".concat(kye,"--disable-bottom-border")):$B(t,"".concat(kye,"--disable-bottom-border"))}updateSize(e){const{emptyDataStateElement:t}=Tye(Oye,this),n=e.hasHorizontalScroll()?kz(e.hot.rootDocument):0,r=e.countRenderableRows(),i=e.countRenderableColumns(),o=e.getColumnHeadersCount();var a;(t.style.top=i>0?"".concat(e.getColumnHeaderHeight(),"px"):"0px",t.style.insetInlineStart=r>0?"".concat(e.getRowHeaderWidth(),"px"):"0px",0===r)?(Tye(Iye,this)||(Aye(Iye,this,Tye(_ye,this).createElement("div")),Tye(Iye,this).classList.add("".concat(kye,"-placeholder")),e._wt.wtTable.holder.appendChild(Tye(Iye,this))),Tye(Iye,this).style.width="100%",Tye(Iye,this).style.height="".concat(150,"px")):(null===(a=Tye(Iye,this))||void 0===a||a.remove(),Aye(Iye,this,null));let s=e.getWorkspaceWidth(),l=e.getTableHeight();e.isHorizontallyScrollableByWindow()?i>0?s=e.getTotalTableWidth():r>0&&(s=e.getViewportWidth()):r>0?s=e.getViewportWidth():e.getTableWidth()-e.getRowHeaderWidth()<e.getViewportWidth()&&i>0&&(s=e.getTableWidth()),e.isVerticallyScrollableByWindow()||e.hasVerticalScroll()?l=i>0?e.hot.getTableHeight()-e.getColumnHeaderHeight():e.hot.getTableHeight():o>0&&i>0?l=e.getViewportHeight()-n:o>0&&0===i&&(l=e.getWorkspaceHeight()-n),t.style.width="".concat(s,"px"),t.style.height="".concat(l,"px")}destroy(){var e,t;null===(e=Tye(Oye,this))||void 0===e||null===(e=e.emptyDataStateElement)||void 0===e||e.remove(),null===(t=Tye(Iye,this))||void 0===t||t.remove(),Aye(Iye,this,null),Aye(Oye,this,null)}}function jye(e,t,n){Fye(e,t),t.set(e,n)}function Fye(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hye(e,t,n){return e.set(Bye(e,t),n),n}function Lye(e,t){return e.get(Bye(e,t))}function Bye(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const zye="emptyDataState",Wye=("ht-".concat(zye),Object.freeze({UNKNOWN:"unknown",FILTERS:"filters"})),Vye="plugin:".concat(zye);var Uye,qye,Gye,Yye,Kye,$ye=new WeakMap,Xye=new WeakMap,Qye=new WeakMap,Jye=new WeakMap,Zye=new WeakMap,ebe=new WeakSet;class tbe extends T5{constructor(){super(...arguments),function(e,t){Fye(e,t),t.add(e)}(this,ebe),jye(this,$ye,!1),jye(this,Xye,null),jye(this,Qye,null),jye(this,Jye,!1),jye(this,Zye,null)}static get PLUGIN_KEY(){return zye}static get PLUGIN_PRIORITY(){return 370}static get DEFAULT_SETTINGS(){return{message:void 0}}static get SETTINGS_VALIDATORS(){return{message:e=>"string"===typeof e||"function"===typeof e||tB(e)&&("undefined"===typeof(null===e||void 0===e?void 0:e.title)||"string"===typeof(null===e||void 0===e?void 0:e.title))&&("undefined"===typeof(null===e||void 0===e?void 0:e.description)||"string"===typeof(null===e||void 0===e?void 0:e.description))&&("undefined"===typeof(null===e||void 0===e?void 0:e.buttons)||Array.isArray(null===e||void 0===e?void 0:e.buttons)&&(null===e||void 0===e?void 0:e.buttons.every(e=>"object"===typeof e&&"string"===typeof e.text&&"string"===typeof e.type&&["primary","secondary"].includes(e.type)&&"function"===typeof e.callback)))||void 0===e}}isEnabled(){return!!this.hot.getSettings()[zye]}enablePlugin(){this.enabled||(Lye(Xye,this)||(Hye(Xye,this,new Pye({rootElement:this.hot.rootGridElement,rootDocument:this.hot.rootDocument})),Bye(ebe,this,obe).call(this),Bye(ebe,this,nbe).call(this),Bye(ebe,this,rbe).call(this)),this.addHook("afterInit",()=>Bye(ebe,this,fbe).call(this)),this.addHook("afterRender",()=>Bye(ebe,this,mbe).call(this)),this.addHook("afterRowSequenceCacheUpdate",()=>Bye(ebe,this,lbe).call(this)),this.addHook("afterColumnSequenceCacheUpdate",()=>Bye(ebe,this,lbe).call(this)),this.addHook("beforeFilter",e=>Bye(ebe,this,pbe).call(this,e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),Bye(ebe,this,ube).call(this),this.isVisible()&&Lye(Xye,this).show(),super.updatePlugin()}disablePlugin(){Bye(ebe,this,abe).call(this),Bye(ebe,this,ibe).call(this),Lye(Xye,this).destroy(),Hye(Xye,this,null),super.disablePlugin()}isVisible(){return Lye($ye,this)}destroy(){var e;Hye($ye,this,!1),null===(e=Lye(Xye,this))||void 0===e||e.destroy(),Hye(Xye,this,null),Hye(Qye,this,null),Hye(Jye,this,!1),Hye(Zye,this,null),super.destroy()}}function nbe(){this.eventManager.addEventListener(Lye(Xye,this).getElement(),"wheel",e=>Bye(ebe,this,hbe).call(this,e))}function rbe(){Hye(Qye,this,new MutationObserver(()=>{if(!this.hot)return;const e=Lye(Xye,this).getElement();this.hot.rootGridElement.nextElementSibling!==e&&this.hot.rootGridElement.after(e)})),Lye(Qye,this).observe(this.hot.rootWrapperElement,{childList:!0})}function ibe(){Lye(Qye,this).disconnect(),Hye(Qye,this,null)}function obe(){this.hot.getFocusScopeManager().registerScope(zye,Lye(Xye,this).getElement(),{shortcutsContextName:Vye,runOnlyIf:()=>this.isVisible(),onActivate:e=>{var t;const n=null===(t=Lye(Xye,this))||void 0===t?void 0:t.getFocusableElements();n.length>0&&("tab_from_above"===e?n.at(0).focus():"tab_from_below"===e&&n.at(-1).focus())}})}function abe(){this.hot.getFocusScopeManager().unregisterScope(zye)}function sbe(e){var t,n,r;let i;return i="function"===typeof this.getSetting("message")?this.getSetting("message")(e):this.getSetting("message"),"string"===typeof i&&(i={title:i}),null!==(t=i)&&void 0!==t&&t.title||null!==(n=i)&&void 0!==n&&n.description||null!==(r=i)&&void 0!==r&&r.buttons||(i={},e===Wye.FILTERS?(i.title=this.hot.getTranslatedPhrase(VX),i.description=this.hot.getTranslatedPhrase(UX),i.buttons=[{text:this.hot.getTranslatedPhrase(qX),type:"secondary",callback:()=>{const e=this.hot.getPlugin("filters");e&&(e.clearConditions(),e.filter())}}]):(i.title=this.hot.getTranslatedPhrase(zX),i.description=this.hot.getTranslatedPhrase(WX))),i}function lbe(){this.hot.view&&(0===this.hot.view.countRenderableColumns()||0===this.hot.view.countRenderableRows()?Bye(ebe,this,cbe).call(this):Bye(ebe,this,dbe).call(this))}function cbe(){Lye($ye,this)||(this.hot.runHooks("beforeEmptyDataStateShow"),Bye(ebe,this,ube).call(this),Lye(Xye,this).show(),Hye($ye,this,!0),Hye(Zye,this,this.hot.selection.exportSelection()),this.hot.getFocusScopeManager().activateScope(zye),this.hot.runHooks("afterEmptyDataStateShow"))}function ube(){Lye(Jye,this)?Lye(Xye,this).updateContent(Bye(ebe,this,sbe).call(this,Wye.FILTERS)):Lye(Xye,this).updateContent(Bye(ebe,this,sbe).call(this,Wye.UNKNOWN))}function dbe(){var e;Lye($ye,this)&&(this.hot.runHooks("beforeEmptyDataStateHide"),Lye(Xye,this).hide(),Hye($ye,this,!1),this.hot.getFocusScopeManager().deactivateScope(zye),(null===(e=Lye(Zye,this))||void 0===e?void 0:e.ranges.length)>0?(this.hot.selection.importSelection(Lye(Zye,this)),this.hot.view.render(),Hye(Zye,this,null)):this.hot.selectCell(0,0),this.hot.runHooks("afterEmptyDataStateHide"))}function hbe(e){const t=Number.isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;0!==t&&this.hot.view.hasHorizontalScroll()&&!this.hot.view.isHorizontallyScrollableByWindow()&&(this.hot.view.setTableScrollPosition({left:this.hot.view.getTableScrollPosition().left+t}),e.preventDefault())}function fbe(){Bye(ebe,this,lbe).call(this),this.hot.render()}function mbe(){var e;null!==(e=Lye(Xye,this))&&void 0!==e&&e.getElement()&&this.isVisible()&&(Lye(Xye,this).updateSize(this.hot.view),Lye(Xye,this).updateClassNames(this.hot.view))}function pbe(e){Hye(Jye,this,(null===e||void 0===e?void 0:e.length)>0),this.isVisible()&&Bye(ebe,this,ube).call(this)}function gbe(){GW(b0),GW(q2),GW(K2),GW(A3),GW(k3),GW(j2),GW(M3),GW(_3),GW(P3),GW(Y1),GW(j3),HV(H3),HV(K1),HV(G3),HV(L3),HV(K3),HV(F3),HV(V4),HV(U4),HV(q4),HV($1),HV(G4),qV(Y4),qV(Q4),qV(X4),qV(J4),qV(e5),MJ(r5),MJ(i5),MJ(a5),MJ(s5),MJ(l5),MJ(c5),MJ(u5),MJ(d5),MJ(X1),MJ(h5),DV(U5),DV(s6),DV(T6),DV($6),DV(c8),DV(J8),DV(h7),DV(w9),DV(Iee),DV(Ste),DV(Qte),DV(ane),DV(vne),DV(Kne),DV(zoe),DV(Jae),DV(Ose),DV(Yse),DV(sle),DV(Fle),DV(mce),DV(Gce),DV(Cue),DV(Ide),DV(dhe),DV(fhe),DV(xfe),DV(hme),DV(ppe),DV(Fpe),DV(qpe),DV(Tge),DV(Oge),DV(Wge),DV(Cve),DV(sye),DV(Cye),DV(tbe)}gbe(),function(e){const t="undefined"!==typeof window&&window.jQuery;t&&(t.fn.handsontable=function(t){const n=this.first();let r,i=n.data("handsontable");if("string"!==typeof t){const r=t||{};return i?i.updateSettings(r):(i=new e.Core(n[0],r),n.data("handsontable",i),i.init()),n}if(i){if("undefined"===typeof i[t])throw new Error("Handsontable do not provide action: ".concat(t));for(var o=arguments.length,a=new Array(o>1?o-1:0),s=1;s<o;s++)a[s-1]=arguments[s];r=i[t].call(i,...a),"destroy"===t&&n.removeData()}return r})}(J1),J1.__GhostTable=k5,J1._getListenersCounter=function(){return KW},J1._getRegisteredMapsCounter=function(){return SK},J1.EventManager=$W;const vbe=[e,a,f,p,o,l,t,h,i,r,c,d],ybe=[s,u];J1.helper={},J1.dom={},WH(vbe,e=>{WH(Object.getOwnPropertyNames(e),t=>{"_"!==t.charAt(0)&&(J1.helper[t]=e[t])})}),WH(ybe,e=>{WH(Object.getOwnPropertyNames(e),t=>{"_"!==t.charAt(0)&&(J1.dom[t]=e[t])})}),J1.cellTypes=null!==(Uye=J1.cellTypes)&&void 0!==Uye?Uye:{},WH(AJ(),e=>{J1.cellTypes[e]=kJ(e)}),J1.cellTypes.registerCellType=MJ,J1.cellTypes.getCellType=kJ,J1.editors=null!==(qye=J1.editors)&&void 0!==qye?qye:{},WH(zW(),e=>{J1.editors["".concat(yL(e),"Editor")]=qW(e)}),J1.editors.registerEditor=GW,J1.editors.getEditor=qW,J1.renderers=null!==(Gye=J1.renderers)&&void 0!==Gye?Gye:{},WH(PV(),e=>{const t=FV(e);"base"===e&&(J1.renderers.cellDecorator=t),J1.renderers["".concat(yL(e),"Renderer")]=t}),J1.renderers.registerRenderer=HV,J1.renderers.getRenderer=FV,J1.validators=null!==(Yye=J1.validators)&&void 0!==Yye?Yye:{},WH(WV(),e=>{J1.validators["".concat(yL(e),"Validator")]=UV(e)}),J1.validators.registerValidator=qV,J1.validators.getValidator=UV,J1.plugins=null!==(Kye=J1.plugins)&&void 0!==Kye?Kye:{},WH(kV(),e=>{J1.plugins[e]=MV(e)}),J1.plugins["".concat(yL(T5.PLUGIN_KEY),"Plugin")]=T5,J1.plugins.registerPlugin=DV,J1.plugins.getPlugin=MV;const bbe=J1;const wbe=e=>{let{summaryContext:t,data:n,onDataChange:r,materialRateConfig:i}=e;const[o,a]=(0,g.useState)({}),[s,l]=(0,g.useState)({}),[c,u]=(0,g.useState)("All"),[d,h]=(0,g.useState)(!1),[f,m]=(0,g.useState)({});(0,g.useEffect)(()=>{fetch("/SalmanWipro-directory/FinsishingMaterialCalculation.json").then(e=>e.json()).then(e=>{const t={};Object.entries(e).forEach(e=>{let[n,r]=e;r.forEach(e=>{const r="".concat(n,"-").concat(e.material);t[r]=e.quantity_formula})}),m(t)})},[]),(0,g.useEffect)(()=>{if(n){const e={},t={};Object.entries(n).forEach(n=>{let[r,i]=n;i.forEach((n,i)=>{const o="".concat(r,"-").concat(i,"-").concat(n.quantity_formula);void 0!==n.manual_base_qty&&(e[o]=n.manual_base_qty),void 0!==n.wastage_percent&&(t[o]=n.wastage_percent)})}),a(e),l(t)}},[n]);const p=(0,g.useCallback)(()=>{if(n&&r&&Object.keys(f).length>0){const e=E({},n);let t=!1;Object.entries(e).forEach(n=>{let[r,i]=n;i.forEach((n,i)=>{if(!n.quantity_formula||"0"===n.quantity_formula){const o="".concat(r,"-").concat(n.material),a=f[o];a&&(console.log("Fixing corrupted formula for ".concat(r," - ").concat(n.material,': "').concat(n.quantity_formula,'" \u2192 "').concat(a,'"')),e[r][i]=E(E({},n),{},{quantity_formula:a}),t=!0)}})}),t&&(console.log("Fixed corrupted formulas, updating data..."),r(e))}},[n,r,f]);(0,g.useEffect)(()=>{Object.keys(f).length>0&&p()},[f,p]);const v=(0,g.useCallback)(e=>{if(!i)return[];let t=null;if(i[e])t=e;else{const n=Object.keys(i);t=n.find(t=>t.toLowerCase()===e.toLowerCase()),t||(t=n.find(t=>t.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(t.toLowerCase())))}return t&&i[t]&&Array.isArray(i[t])?i[t].map(e=>({material:e.material,unit:e.unit,brands:e.brands||[],default_brand:e.default_brand})):[]},[i]),y=(0,g.useCallback)((e,t,i,o,c)=>{if(n&&n[e]){if(n[e].some((e,t)=>t!==o&&e.material===i))return void alert('"'.concat(i,'" is already added to ').concat(e," category. Please select a different material."))}if(r&&n){const u=E({},n);if(u[e]){const n="".concat(e,"-").concat(o,"-").concat(c),d="".concat(e,"-").concat(t),h="".concat(e,"-").concat(i);a(e=>{const t=E({},e);return delete t[d],delete t[h],delete t[n],t}),void 0!==s[d]&&void 0===s[n]&&l(e=>{const t=E({},e);return t[n]=e[d],delete t[d],t}),u[e]=u[e].map((t,n)=>{if(n===o){const n=v(e).find(e=>e.material===i);return E(E({},t),{},{material:i,unit:(null===n||void 0===n?void 0:n.unit)||t.unit,manual_base_qty:void 0})}return t}),r(u)}}},[r,n,s,v]),b=(0,g.useCallback)((e,t)=>{if(r&&n){const s=E({},n);if(s[e]&&s[e].length>t){var i,o;s[e]=s[e].filter((e,n)=>n!==t),0===s[e].length&&delete s[e];const c="".concat(e,"-").concat(t,"-").concat(null===(i=n[e][t])||void 0===i?void 0:i.quantity_formula),u="".concat(e,"-").concat(null===(o=n[e][t])||void 0===o?void 0:o.material);a(e=>{const t=E({},e);return delete t[c],delete t[u],t}),l(e=>{const t=E({},e);return delete t[c],delete t[u],t}),r(s)}}},[r,n]),w=(0,g.useCallback)(e=>{if(r&&n){const t=E({},n);t[e]||(t[e]=[]);const i={material:"",quantity_formula:"0",unit:"unit",wastage_percent:0};t[e]=[...t[e],i],r(t)}},[r,n]),x=(0,g.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n&&n[e]?n[e].filter((e,n)=>n!==t).map(e=>e.material).filter(e=>""!==e):[]},[n]);if(!n)return(0,Bt.jsx)("div",{style:{padding:24,textAlign:"center",color:"#888"},children:"Loading finishing material data..."});const S=(C=n,Object.entries(C).map(e=>{let[t,n]=e;return{category:t,items:n}}));var C;const N=Object.keys(n),T=(e,t)=>v(e).some(e=>e.material.toLowerCase()===t.toLowerCase()),A=e=>v(e);return(0,Bt.jsx)("div",{className:"step5-table-responsive",style:{margin:"2rem 0",background:"#fff",padding:0,maxHeight:600,overflowY:"auto"},children:(0,Bt.jsxs)("table",{className:"step5-material-table",style:{width:"100%",fontSize:"0.93rem",background:"#fff",borderCollapse:"collapse",borderSpacing:0,border:"1px solid #d0d7e1"},children:[(0,Bt.jsx)("thead",{style:{background:"#eaf4fb"},children:(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("th",{style:{padding:"8px 6px",fontWeight:600,color:"#1976d2",border:"1px solid #d0d7e1",fontSize:"0.98em",position:"sticky",top:0,background:"#eaf4fb",zIndex:2,minWidth:120},children:(0,Bt.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:4,position:"relative"},children:["Category",(0,Bt.jsx)("span",{style:{cursor:"pointer",marginLeft:4,display:"flex",alignItems:"center"},onClick:e=>{e.stopPropagation(),h(e=>!e)},title:"Filter by Category",children:(0,Bt.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 20 20",fill:"#1976d2",style:{display:"block"},children:(0,Bt.jsx)("path",{d:"M3 5a1 1 0 0 1 1-1h12a1 1 0 0 1 .8 1.6l-4.6 6.4V16a1 1 0 0 1-1.447.894l-2-1A1 1 0 0 1 8 15v-3.01L3.2 6.6A1 1 0 0 1 3 5z"})})}),d&&(0,Bt.jsxs)("div",{style:{position:"absolute",top:28,left:0,background:"#fff",border:"1px solid #b0c4d7",borderRadius:6,boxShadow:"0 2px 8px #d0d7e1",zIndex:10,minWidth:120,padding:"4px 0"},onClick:e=>e.stopPropagation(),children:[(0,Bt.jsx)("div",{style:{padding:"2px 12px",cursor:"pointer",color:"All"===c?"#1976d2":"#333",fontWeight:"All"===c?600:400},onClick:()=>{u("All"),h(!1)},children:"All"}),N.map(e=>(0,Bt.jsx)("div",{style:{padding:"2px 12px",cursor:"pointer",color:c===e?"#1976d2":"#333",fontWeight:c===e?600:400},onClick:()=>{u(e),h(!1)},children:e},e))]})]})}),(0,Bt.jsx)("th",{style:{padding:"8px 6px",fontWeight:600,color:"#1976d2",border:"1px solid #d0d7e1",fontSize:"0.98em",position:"sticky",top:0,background:"#eaf4fb",zIndex:2},children:"Material"}),(0,Bt.jsx)("th",{style:{padding:"8px 6px",fontWeight:600,color:"#1976d2",border:"1px solid #d0d7e1",fontSize:"0.98em",position:"sticky",top:0,background:"#eaf4fb",zIndex:2},children:"Formula"}),(0,Bt.jsx)("th",{style:{padding:"8px 6px",fontWeight:600,color:"#1976d2",border:"1px solid #d0d7e1",fontSize:"0.98em",position:"sticky",top:0,background:"#eaf4fb",zIndex:2},children:"Base Qty"}),(0,Bt.jsx)("th",{style:{padding:"8px 6px",fontWeight:600,color:"#1976d2",border:"1px solid #d0d7e1",fontSize:"0.98em",position:"sticky",top:0,background:"#eaf4fb",zIndex:2},children:"Wastage (%)"}),(0,Bt.jsx)("th",{style:{padding:"8px 6px",fontWeight:600,color:"#1976d2",border:"1px solid #d0d7e1",fontSize:"0.98em",position:"sticky",top:0,background:"#eaf4fb",zIndex:2},children:"Total Qty"}),(0,Bt.jsx)("th",{style:{padding:"8px 6px",fontWeight:600,color:"#1976d2",border:"1px solid #d0d7e1",fontSize:"0.98em",position:"sticky",top:0,background:"#eaf4fb",zIndex:2},children:"Unit"}),(0,Bt.jsx)("th",{style:{padding:"8px 6px",fontWeight:600,color:"#1976d2",border:"1px solid #d0d7e1",fontSize:"0.98em",position:"sticky",top:0,background:"#eaf4fb",zIndex:2,width:"50px"},children:"Action"})]})}),(0,Bt.jsx)("tbody",{children:S.filter(e=>{let{category:t}=e;return"All"===c||t===c}).map(e=>{let{category:i,items:c}=e;return(0,Bt.jsxs)(g.Fragment,{children:[(0,Bt.jsxs)("tr",{style:{background:"#f0f0f0",fontWeight:"bold"},children:[(0,Bt.jsx)("td",{colSpan:7,style:{border:"1px solid #d0d7e1",fontSize:"0.97em",padding:"7px 6px"},children:i}),(0,Bt.jsx)("td",{style:{border:"1px solid #d0d7e1",padding:"7px 6px",textAlign:"center"},children:(0,Bt.jsx)("button",{onClick:()=>w(i),style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#28a745",fontSize:"16px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",transition:"background-color 0.2s"},onMouseEnter:e=>e.target.style.backgroundColor="#f8f9fa",onMouseLeave:e=>e.target.style.backgroundColor="transparent",title:"Add new item to ".concat(i),children:(0,Bt.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,Bt.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})})})})]}),c.map((e,c)=>{const u="".concat(i,"-").concat(c,"-").concat(e.quantity_formula),d="".concat(i,"-").concat(e.material),h=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const r=e.replace(/\b([a-zA-Z_][a-zA-Z0-9_]*)\b/g,e=>Object.prototype.hasOwnProperty.call(t,e)?t[e]:Object.prototype.hasOwnProperty.call(n,e)?n[e]:0);return Uj(r)}catch(qb){return 0}}(e.quantity_formula,t,e),f=void 0!==e.manual_base_qty?e.manual_base_qty:void 0!==o[u]?""===o[u]?"":parseFloat(o[u])||0:h||0,m=void 0!==e.wastage_percent?parseFloat(e.wastage_percent):void 0!==s[u]?parseFloat(s[u]):void 0!==s[d]?parseFloat(s[d]):0,p=f*(1+(m||0)/100);return(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("td",{style:{border:"1px solid #d0d7e1",padding:"7px 6px"},children:i}),(0,Bt.jsx)("td",{style:{border:"1px solid #d0d7e1",padding:"7px 6px",position:"relative"},children:(0,Bt.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,Bt.jsxs)("select",{value:e.material,onChange:t=>y(i,e.material,t.target.value,c,e.quantity_formula),style:{padding:"4px 8px",border:"1px solid #ccc",borderRadius:"4px",fontSize:"0.9em",minWidth:"150px",maxWidth:"200px",color:""===e.material?"#999":"#333"},children:[""===e.material&&(0,Bt.jsx)("option",{value:"",disabled:!0,style:{color:"#999"},children:"Select Material"}),""!==e.material&&(0,Bt.jsx)("option",{value:e.material,children:e.material}),v(i).filter(t=>{if(t.material===e.material)return!1;return!x(i,c).includes(t.material)}).map(e=>(0,Bt.jsxs)("option",{value:e.material,children:[e.material," ",e.unit&&"(".concat(e.unit,")")]},e.material)),(()=>{const t=v(i),n=x(i,c),r=t.filter(t=>t.material!==e.material&&!n.includes(t.material));return 0===t.length&&""===e.material?(0,Bt.jsx)("option",{disabled:!0,children:"No materials available"}):0===r.length&&""===e.material?(0,Bt.jsx)("option",{disabled:!0,children:"All materials already used in this category"}):null})()]}),T(i,e.material)?(0,Bt.jsx)("span",{title:"Material available in MaterialRate.json",style:{color:"#4caf50",fontSize:"14px",fontWeight:"bold"},children:"\u2713"}):(0,Bt.jsx)("span",{title:"Material not found in MaterialRate.json. Available materials: ".concat(A(i).map(e=>e.material).join(", ")),style:{color:"#ff9800",fontSize:"12px",fontWeight:"bold"},children:"\u26a0"})]})}),(0,Bt.jsx)("td",{style:{border:"1px solid #d0d7e1",padding:"7px 6px"},children:e.quantity_formula}),(0,Bt.jsx)("td",{style:{textAlign:"right",border:"1px solid #d0d7e1",padding:"7px 6px"},children:(0,Bt.jsx)("input",{type:"number",value:f||"",min:"0",step:"0.01",style:{width:80,textAlign:"right",border:"1px solid #ccc",borderRadius:4,padding:"2px 6px",fontSize:"0.95em"},onChange:e=>{const t=e.target.value;if(a(e=>E(E({},e),{},{[u]:t})),r){const e=E({},n);e[i]=e[i].map((e,n)=>n===c?E(E({},e),{},{manual_base_qty:""===t?void 0:parseFloat(t)||0}):e),r(e)}},placeholder:"0"})}),(0,Bt.jsx)("td",{style:{textAlign:"right",border:"1px solid #d0d7e1",padding:"7px 6px"},children:(0,Bt.jsx)("input",{type:"number",value:m,min:"0",step:"0.01",style:{width:60,textAlign:"right",border:"1px solid #ccc",borderRadius:4,padding:"2px 6px",fontSize:"0.95em"},onChange:e=>{const t=e.target.value;if(l(e=>E(E({},e),{},{[u]:t})),r){const e=E({},n);e[i]=e[i].map((e,n)=>n===c?E(E({},e),{},{wastage_percent:t}):e),r(e)}}})}),(0,Bt.jsx)("td",{style:{textAlign:"right",border:"1px solid #d0d7e1",padding:"7px 6px"},children:p?p.toFixed(0).toLocaleString("en-IN",{maximumFractionDigits:2}):"-"}),(0,Bt.jsx)("td",{style:{border:"1px solid #d0d7e1",padding:"7px 6px"},children:e.unit}),(0,Bt.jsx)("td",{style:{border:"1px solid #d0d7e1",padding:"7px 6px",textAlign:"center"},children:(0,Bt.jsxs)("div",{style:{display:"flex",gap:"4px",justifyContent:"center",alignItems:"center"},children:[void 0!==e.manual_base_qty&&(0,Bt.jsx)("button",{onClick:()=>{if(a(e=>{const t=E({},e);return delete t[u],t}),r){const e=E({},n);e[i]=e[i].map((e,t)=>t===c?E(E({},e),{},{manual_base_qty:void 0}):e),r(e)}},style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#6f42c1",fontSize:"14px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",transition:"background-color 0.2s"},onMouseEnter:e=>e.target.style.backgroundColor="#f8f9fa",onMouseLeave:e=>e.target.style.backgroundColor="transparent",title:"Reset to original formula value",children:(0,Bt.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:(0,Bt.jsx)("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"})})}),(0,Bt.jsx)("button",{onClick:()=>b(i,c),style:{background:"none",border:"none",cursor:"pointer",padding:"4px",color:"#dc3545",fontSize:"16px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",transition:"background-color 0.2s"},onMouseEnter:e=>e.target.style.backgroundColor="#f8f9fa",onMouseLeave:e=>e.target.style.backgroundColor="transparent",title:"Delete this item",children:(0,Bt.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,Bt.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})})})]})})]},u)})]},i)})})]})})};var xbe={version:"0.18.5"},Sbe=1200,Cbe=1252,Ebe=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Nbe={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Tbe=function(e){-1!=Ebe.indexOf(e)&&(Cbe=Nbe[0]=e)};var Abe=function(e){Sbe=e,Tbe(e)};function Rbe(){Abe(1200),Tbe(1252)}function kbe(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var Mbe,Dbe=function(e){return String.fromCharCode(e)},_be=function(e){return String.fromCharCode(e)};var Obe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ibe(e){for(var t="",n=0,r=0,i=0,o=0,a=0,s=0,l=0,c=0;c<e.length;)o=(n=e.charCodeAt(c++))>>2,a=(3&n)<<4|(r=e.charCodeAt(c++))>>4,s=(15&r)<<2|(i=e.charCodeAt(c++))>>6,l=63&i,isNaN(r)?s=l=64:isNaN(i)&&(l=64),t+=Obe.charAt(o)+Obe.charAt(a)+Obe.charAt(s)+Obe.charAt(l);return t}function Pbe(e){var t="",n=0,r=0,i=0,o=0,a=0,s=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)n=Obe.indexOf(e.charAt(l++))<<2|(o=Obe.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(n),r=(15&o)<<4|(a=Obe.indexOf(e.charAt(l++)))>>2,64!==a&&(t+=String.fromCharCode(r)),i=(3&a)<<6|(s=Obe.indexOf(e.charAt(l++))),64!==s&&(t+=String.fromCharCode(i));return t}var jbe=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),Fbe=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(qb){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Hbe(e){return jbe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function Lbe(e){return jbe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var Bbe=function(e){return jbe?Fbe(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function zbe(e){if("undefined"===typeof ArrayBuffer)return Bbe(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}function Wbe(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}var Vbe=jbe?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:Fbe(e)}))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),i=0;for(t=0,n=0;t<e.length;n+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if("string"==typeof e[t])throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};var Ube=/\u0000/g,qbe=/[\u0001-\u0006]/g;function Gbe(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function Ybe(e,t){var n=""+e;return n.length>=t?n:oxe("0",t-n.length)+n}function Kbe(e,t){var n=""+e;return n.length>=t?n:oxe(" ",t-n.length)+n}function $be(e,t){var n=""+e;return n.length>=t?n:n+oxe(" ",t-n.length)}var Xbe=Math.pow(2,32);function Qbe(e,t){return e>Xbe||e<-Xbe?function(e,t){var n=""+Math.round(e);return n.length>=t?n:oxe("0",t-n.length)+n}(e,t):function(e,t){var n=""+e;return n.length>=t?n:oxe("0",t-n.length)+n}(Math.round(e),t)}function Jbe(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var Zbe=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ewe=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var twe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},nwe={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},rwe={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function iwe(e,t,n){for(var r=e<0?-1:1,i=e*r,o=0,a=1,s=0,l=1,c=0,u=0,d=Math.floor(i);c<t&&(s=(d=Math.floor(i))*a+o,u=d*c+l,!(i-d<5e-8));)i=1/(i-d),o=a,a=s,l=c,c=u;if(u>t&&(c>t?(u=l,s=o):(u=c,s=a)),!n)return[0,r*s,u];var h=Math.floor(r*s/u);return[h,r*s-h*u,u]}function owe(e,t,n){if(e>2958465||e<0)return null;var r=0|e,i=Math.floor(86400*(e-r)),o=0,a=[],s={D:r,T:i,u:86400*(e-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6&&(s.u=0),t&&t.date1904&&(r+=1462),s.u>.9999&&(s.u=0,86400==++i&&(s.T=i=0,++r,++s.D)),60===r)a=n?[1317,10,29]:[1900,2,29],o=3;else if(0===r)a=n?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],o=l.getDay(),r<60&&(o=(o+6)%7),n&&(o=function(e,t){t[0]-=581;var n=e.getDay();e<60&&(n=(n+6)%7);return n}(l,a))}return s.y=a[0],s.m=a[1],s.d=a[2],s.S=i%60,i=Math.floor(i/60),s.M=i%60,i=Math.floor(i/60),s.H=i,s.q=o,s}var awe=new Date(1899,11,31,0,0,0),swe=awe.getTime(),lwe=new Date(1900,2,1,0,0,0);function cwe(e,t){var n=e.getTime();return t?n-=1262304e5:e>=lwe&&(n+=864e5),(n-(swe+6e4*(e.getTimezoneOffset()-awe.getTimezoneOffset())))/864e5}function uwe(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function dwe(e){var t,n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=n>=-4&&n<=-1?e.toPrecision(10+n):Math.abs(n)<=9?function(e){var t=e<0?12:11,n=uwe(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10)).length<=t?n:e.toExponential(5)}(e):10===n?e.toFixed(10).substr(0,12):function(e){var t=uwe(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),uwe(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function hwe(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):dwe(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return Owe(14,cwe(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function fwe(e,t,n,r){var i,o="",a=0,s=0,l=n.y,c=0;switch(e){case 98:l=n.y+543;case 121:switch(t.length){case 1:case 2:i=l%100,c=2;break;default:i=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:i=n.m,c=t.length;break;case 3:return ewe[n.m-1][1];case 5:return ewe[n.m-1][0];default:return ewe[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:i=n.d,c=t.length;break;case 3:return Zbe[n.q][0];default:return Zbe[n.q][1]}break;case 104:switch(t.length){case 1:case 2:i=1+(n.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:i=n.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:i=n.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(s=r>=2?3===r?1e3:100:1===r?10:1,(a=Math.round(s*(n.S+n.u)))>=60*s&&(a=0),"s"===t?0===a?"0":""+a/s:(o=Ybe(a,2+r),"ss"===t?o.substr(0,2):"."+o.substr(2,t.length-1))):Ybe(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":i=24*n.D+n.H;break;case"[m]":case"[mm]":i=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":i=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:i=l,c=1}return c>0?Ybe(i,c):""}function mwe(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(n.length>0?",":"")+e.substr(t,3);return n}var pwe=/%/g;function gwe(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+gwe(e,-t);var i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%i;if(o<0&&(o+=i),-1===(n=(t/Math.pow(10,o)).toPrecision(r+1+(i+o)%i)).indexOf("e")){var a=Math.floor(Math.log(t)*Math.LOG10E);for(-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(a-n.length+o):n+="E+"+(a-o);"0."===n.substr(0,2);)n=(n=n.charAt(0)+n.substr(2,i)+"."+n.substr(2+i)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,r){return t+n+r.substr(0,(i+o)%i)+"."+r.substr(o)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var vwe=/# (\?+)( ?)\/( ?)(\d+)/;var ywe=/^#*0*\.([0#]+)/,bwe=/\).*[0#]/,wwe=/\(###\) ###\\?-####/;function xwe(e){for(var t,n="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function Swe(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function Cwe(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function Ewe(e,t,n){if(40===e.charCodeAt(0)&&!t.match(bwe)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Ewe("n",r,n):"("+Ewe("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return Awe(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(pwe,""),i=t.length-r.length;return Awe(e,r,n*Math.pow(10,2*i))+oxe("%",i)}(e,t,n);if(-1!==t.indexOf("E"))return gwe(t,n);if(36===t.charCodeAt(0))return"$"+Ewe(e,t.substr(" "==t.charAt(1)?2:1),n);var i,o,a,s,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+Qbe(l,t.length);if(t.match(/^[#?]+$/))return"0"===(i=Qbe(n,0))&&(i=""),i.length>t.length?i:xwe(t.substr(0,t.length-i.length))+i;if(o=t.match(vwe))return function(e,t,n){var r=parseInt(e[4],10),i=Math.round(t*r),o=Math.floor(i/r),a=i-o*r,s=r;return n+(0===o?"":""+o)+" "+(0===a?oxe(" ",e[1].length+1+e[4].length):Kbe(a,e[1].length)+e[2]+"/"+e[3]+Ybe(s,e[4].length))}(o,l,c);if(t.match(/^#+0+$/))return c+Qbe(l,t.length-t.indexOf("0"));if(o=t.match(ywe))return i=Swe(n,o[1].length).replace(/^([^\.]+)$/,"$1."+xwe(o[1])).replace(/\.$/,"."+xwe(o[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+oxe("0",xwe(o[1]).length-t.length)}),-1!==t.indexOf("0.")?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return c+Swe(l,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return c+mwe(Qbe(l,0));if(o=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Ewe(e,t,-n):mwe(""+(Math.floor(n)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(n,o[1].length)))+"."+Ybe(Cwe(n,o[1].length),o[1].length);if(o=t.match(/^#,#*,#0/))return Ewe(e,t.replace(/^#,#*,/,""),n);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Gbe(Ewe(e,t.replace(/[\\-]/g,""),n)),a=0,Gbe(Gbe(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return a<i.length?i.charAt(a++):"0"===e?"0":""}));if(t.match(wwe))return"("+(i=Ewe(e,"##########",n)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(o[4].length,7),s=iwe(l,Math.pow(10,a)-1,!1),i=""+c," "==(u=Awe("n",o[1],s[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),i+=u+o[2]+"/"+o[3],(u=$be(s[2],a)).length<o[4].length&&(u=xwe(o[4].substr(o[4].length-u.length))+u),i+=u;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(o[1].length,o[4].length),7),c+((s=iwe(l,Math.pow(10,a)-1,!0))[0]||(s[1]?"":"0"))+" "+(s[1]?Kbe(s[1],a)+o[2]+"/"+o[3]+$be(s[2],a):oxe(" ",2*a+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return i=Qbe(n,0),t.length<=i.length?i:xwe(t.substr(0,t.length-i.length))+i;if(o=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var d=t.indexOf(".")-a,h=t.length-i.length-d;return xwe(t.substr(0,d)+i+t.substr(t.length-h))}if(o=t.match(/^00,000\.([#0]*0)$/))return a=Cwe(n,o[1].length),n<0?"-"+Ewe(e,t,-n):mwe(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Ybe(0,3-e.length):"")+e})+"."+Ybe(a,o[1].length);switch(t){case"###,##0.00":return Ewe(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var f=mwe(Qbe(l,0));return"0"!==f?c+f:"";case"###,###.00":return Ewe(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return Ewe(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Nwe(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Nwe(e,-t);var i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%i;if(o<0&&(o+=i),!(n=(t/Math.pow(10,o)).toPrecision(r+1+(i+o)%i)).match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(a-n.length+o):n+="E+"+(a-o),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,r){return t+n+r.substr(0,(i+o)%i)+"."+r.substr(o)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function Twe(e,t,n){if(40===e.charCodeAt(0)&&!t.match(bwe)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Twe("n",r,n):"("+Twe("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return Awe(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(pwe,""),i=t.length-r.length;return Awe(e,r,n*Math.pow(10,2*i))+oxe("%",i)}(e,t,n);if(-1!==t.indexOf("E"))return Nwe(t,n);if(36===t.charCodeAt(0))return"$"+Twe(e,t.substr(" "==t.charAt(1)?2:1),n);var i,o,a,s,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+Ybe(l,t.length);if(t.match(/^[#?]+$/))return i=""+n,0===n&&(i=""),i.length>t.length?i:xwe(t.substr(0,t.length-i.length))+i;if(o=t.match(vwe))return function(e,t,n){return n+(0===t?"":""+t)+oxe(" ",e[1].length+2+e[4].length)}(o,l,c);if(t.match(/^#+0+$/))return c+Ybe(l,t.length-t.indexOf("0"));if(o=t.match(ywe))return i=(i=(""+n).replace(/^([^\.]+)$/,"$1."+xwe(o[1])).replace(/\.$/,"."+xwe(o[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+oxe("0",xwe(o[1]).length-t.length)}),-1!==t.indexOf("0.")?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return c+mwe(""+l);if(o=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Twe(e,t,-n):mwe(""+n)+"."+oxe("0",o[1].length);if(o=t.match(/^#,#*,#0/))return Twe(e,t.replace(/^#,#*,/,""),n);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Gbe(Twe(e,t.replace(/[\\-]/g,""),n)),a=0,Gbe(Gbe(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return a<i.length?i.charAt(a++):"0"===e?"0":""}));if(t.match(wwe))return"("+(i=Twe(e,"##########",n)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(o[4].length,7),s=iwe(l,Math.pow(10,a)-1,!1),i=""+c," "==(u=Awe("n",o[1],s[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),i+=u+o[2]+"/"+o[3],(u=$be(s[2],a)).length<o[4].length&&(u=xwe(o[4].substr(o[4].length-u.length))+u),i+=u;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(o[1].length,o[4].length),7),c+((s=iwe(l,Math.pow(10,a)-1,!0))[0]||(s[1]?"":"0"))+" "+(s[1]?Kbe(s[1],a)+o[2]+"/"+o[3]+$be(s[2],a):oxe(" ",2*a+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return i=""+n,t.length<=i.length?i:xwe(t.substr(0,t.length-i.length))+i;if(o=t.match(/^([#0]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var d=t.indexOf(".")-a,h=t.length-i.length-d;return xwe(t.substr(0,d)+i+t.substr(t.length-h))}if(o=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+Twe(e,t,-n):mwe(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Ybe(0,3-e.length):"")+e})+"."+Ybe(0,o[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=mwe(""+l);return"0"!==f?c+f:"";default:if(t.match(/\.[0#?]*$/))return Twe(e,t.slice(0,t.lastIndexOf(".")),n)+xwe(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Awe(e,t,n){return(0|n)===n?Twe(e,t,n):Ewe(e,t,n)}var Rwe=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function kwe(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":Jbe(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=n;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match(Rwe))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||"\\"==n&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var Mwe=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Dwe(e,t){if(null==t)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0}return!1}function _we(e,t){var n=function(e){for(var t=[],n=!1,r=0,i=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(i,r-i),i=r+1}if(t[t.length]=e.substr(i),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}(e),r=n.length,i=n[r-1].indexOf("@");if(r<4&&i>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!==typeof t)return[4,4===n.length||i>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=i>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=i>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=i>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var o=t>0?n[0]:t<0?n[1]:n[2];if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return[r,o];if(null!=n[0].match(/\[[=<>]/)||null!=n[1].match(/\[[=<>]/)){var a=n[0].match(Mwe),s=n[1].match(Mwe);return Dwe(t,a)?[r,n[0]]:Dwe(t,s)?[r,n[1]]:[r,n[null!=a&&null!=s?2:1]]}return[r,o]}function Owe(e,t,n){null==n&&(n={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&n.dateNF?n.dateNF:e;break;case"number":null==(r=14==e&&n.dateNF?n.dateNF:(null!=n.table?n.table:twe)[e])&&(r=n.table&&n.table[nwe[e]]||twe[nwe[e]]),null==r&&(r=rwe[e]||"General")}if(Jbe(r,0))return hwe(t,n);t instanceof Date&&(t=cwe(t,n.date1904));var i=_we(r,t);if(Jbe(i[1]))return hwe(t,n);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,n,r){for(var i,o,a,s=[],l="",c=0,u="",d="t",h="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!Jbe(e,c))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(a=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(a);s[s.length]={t:"t",v:l},++c;break;case"\\":var f=e.charAt(++c),m="("===f||")"===f?f:"t";s[s.length]={t:m,v:f},++c;break;case"_":s[s.length]={t:"t",v:" "},c+=2;break;case"@":s[s.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==i&&null==(i=owe(t,n,"2"===e.charAt(c+1))))return"";s[s.length]={t:"X",v:e.substr(c,2)},d=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==i&&null==(i=owe(t,n)))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;"m"===u&&"h"===d.toLowerCase()&&(u="M"),"h"===u&&(u=h),s[s.length]={t:u,v:l},d=u;break;case"A":case"a":case"\u4e0a":var p={t:u,v:u};if(null==i&&(i=owe(t,n)),"A/P"===e.substr(c,3).toUpperCase()?(null!=i&&(p.v=i.H>=12?"P":"A"),p.t="T",h="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=i&&(p.v=i.H>=12?"PM":"AM"),p.t="T",c+=5,h="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=i&&(p.v=i.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),p.t="T",c+=5,h="h"):(p.t="t",++c),null==i&&"T"===p.t)return"";s[s.length]=p,d=u;break;case"[":for(l=u;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(Rwe)){if(null==i&&null==(i=owe(t,n)))return"";s[s.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",kwe(e)||(s[s.length]={t:"t",v:l}));break;case".":if(null!=i){for(l=u;++c<e.length&&"0"===(u=e.charAt(c));)l+=u;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;s[s.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;s[s.length]={t:u,v:l},d=u;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":s[s.length]={t:1===r?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:u,v:u},++c;break;case"$":s[s.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"t",v:u},++c}var g,v=0,y=0;for(c=s.length-1,d="t";c>=0;--c)switch(s[c].t){case"h":case"H":s[c].t=h,d="h",v<1&&(v=1);break;case"s":(g=s[c].v.match(/\.0+$/))&&(y=Math.max(y,g[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":d=s[c].t;break;case"m":"s"===d&&(s[c].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&s[c].v.match(/[Hh]/)&&(v=1),v<2&&s[c].v.match(/[Mm]/)&&(v=2),v<3&&s[c].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M),i.M>=60&&(i.M=0,++i.H);break;case 2:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M)}var b,w="";for(c=0;c<s.length;++c)switch(s[c].t){case"t":case"T":case" ":case"D":break;case"X":s[c].v="",s[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[c].v=fwe(s[c].t.charCodeAt(0),s[c].v,i,y),s[c].t="t";break;case"n":case"?":for(b=c+1;null!=s[b]&&("?"===(u=s[b].t)||"D"===u||(" "===u||"t"===u)&&null!=s[b+1]&&("?"===s[b+1].t||"t"===s[b+1].t&&"/"===s[b+1].v)||"("===s[c].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===s[b].v||" "===s[b].v&&null!=s[b+1]&&"?"==s[b+1].t));)s[c].v+=s[b].v,s[b]={v:"",t:";"},++b;w+=s[c].v,c=b-1;break;case"G":s[c].t="t",s[c].v=hwe(t,n)}var x,S,C="";if(w.length>0){40==w.charCodeAt(0)?(x=t<0&&45===w.charCodeAt(0)?-t:t,S=Awe("n",w,x)):(S=Awe("n",w,x=t<0&&r>1?-t:t),x<0&&s[0]&&"t"==s[0].t&&(S=S.substr(1),s[0].v="-"+s[0].v)),b=S.length-1;var E=s.length;for(c=0;c<s.length;++c)if(null!=s[c]&&"t"!=s[c].t&&s[c].v.indexOf(".")>-1){E=c;break}var N=s.length;if(E===s.length&&-1===S.indexOf("E")){for(c=s.length-1;c>=0;--c)null!=s[c]&&-1!=="n?".indexOf(s[c].t)&&(b>=s[c].v.length-1?(b-=s[c].v.length,s[c].v=S.substr(b+1,s[c].v.length)):b<0?s[c].v="":(s[c].v=S.substr(0,b+1),b=-1),s[c].t="t",N=c);b>=0&&N<s.length&&(s[N].v=S.substr(0,b+1)+s[N].v)}else if(E!==s.length&&-1===S.indexOf("E")){for(b=S.indexOf(".")-1,c=E;c>=0;--c)if(null!=s[c]&&-1!=="n?".indexOf(s[c].t)){for(o=s[c].v.indexOf(".")>-1&&c===E?s[c].v.indexOf(".")-1:s[c].v.length-1,C=s[c].v.substr(o+1);o>=0;--o)b>=0&&("0"===s[c].v.charAt(o)||"#"===s[c].v.charAt(o))&&(C=S.charAt(b--)+C);s[c].v=C,s[c].t="t",N=c}for(b>=0&&N<s.length&&(s[N].v=S.substr(0,b+1)+s[N].v),b=S.indexOf(".")+1,c=E;c<s.length;++c)if(null!=s[c]&&(-1!=="n?(".indexOf(s[c].t)||c===E)){for(o=s[c].v.indexOf(".")>-1&&c===E?s[c].v.indexOf(".")+1:0,C=s[c].v.substr(0,o);o<s[c].v.length;++o)b<S.length&&(C+=S.charAt(b++));s[c].v=C,s[c].t="t",N=c}}}for(c=0;c<s.length;++c)null!=s[c]&&"n?".indexOf(s[c].t)>-1&&(x=r>1&&t<0&&c>0&&"-"===s[c-1].v?-t:t,s[c].v=Awe(s[c].t,s[c].v,x),s[c].t="t");var T="";for(c=0;c!==s.length;++c)null!=s[c]&&(T+=s[c].v);return T}(i[1],t,n,i[0])}function Iwe(e,t){if("number"!=typeof t){t=+t||-1;for(var n=0;n<392;++n)if(void 0!=twe[n]){if(twe[n]==e){t=n;break}}else t<0&&(t=n);t<0&&(t=391)}return twe[t]=e,t}function Pwe(e){for(var t=0;392!=t;++t)void 0!==e[t]&&Iwe(e[t],t)}function jwe(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',twe=e}var Fwe=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var Hwe=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var n=function(e){var t=0,n=0,r=0,i="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(r=0;256!=r;++r)i[r]=e[r];for(r=0;256!=r;++r)for(n=e[r],t=256+r;t<4096;t+=256)n=i[t]=n>>>8^e[255&n];var o=[];for(r=1;16!=r;++r)o[r-1]="undefined"!==typeof Int32Array?i.subarray(256*r,256*r+256):i.slice(256*r,256*r+256);return o}(t),r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],l=n[5],c=n[6],u=n[7],d=n[8],h=n[9],f=n[10],m=n[11],p=n[12],g=n[13],v=n[14];return e.table=t,e.bstr=function(e,n){for(var r=-1^n,i=0,o=e.length;i<o;)r=r>>>8^t[255&(r^e.charCodeAt(i++))];return~r},e.buf=function(e,n){for(var y=-1^n,b=e.length-15,w=0;w<b;)y=v[e[w++]^255&y]^g[e[w++]^y>>8&255]^p[e[w++]^y>>16&255]^m[e[w++]^y>>>24]^f[e[w++]]^h[e[w++]]^d[e[w++]]^u[e[w++]]^c[e[w++]]^l[e[w++]]^s[e[w++]]^a[e[w++]]^o[e[w++]]^i[e[w++]]^r[e[w++]]^t[e[w++]];for(b+=15;w<b;)y=y>>>8^t[255&(y^e[w++])];return~y},e.str=function(e,n){for(var r=-1^n,i=0,o=e.length,a=0,s=0;i<o;)(a=e.charCodeAt(i++))<128?r=r>>>8^t[255&(r^a)]:a<2048?r=(r=r>>>8^t[255&(r^(192|a>>6&31))])>>>8^t[255&(r^(128|63&a))]:a>=55296&&a<57344?(a=64+(1023&a),s=1023&e.charCodeAt(i++),r=(r=(r=(r=r>>>8^t[255&(r^(240|a>>8&7))])>>>8^t[255&(r^(128|a>>2&63))])>>>8^t[255&(r^(128|s>>6&15|(3&a)<<4))])>>>8^t[255&(r^(128|63&s))]):r=(r=(r=r>>>8^t[255&(r^(224|a>>12&15))])>>>8^t[255&(r^(128|a>>6&63))])>>>8^t[255&(r^(128|63&a))];return~r},e}(),Lwe=function(){var e,t={};function n(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function r(e){if("/"==e.charAt(e.length-1))return r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function i(e,t){"string"===typeof t&&(t=new Date(t));var n=t.getHours();n=(n=n<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,n);var r=t.getFullYear()-1980;r=(r=r<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,r)}function o(e){ISe(e,0);for(var t={},n=0;e.l<=e.length-4;){var r=e.read_shift(2),i=e.read_shift(2),o=e.l+i,a={};if(21589===r)1&(n=e.read_shift(1))&&(a.mtime=e.read_shift(4)),i>5&&(2&n&&(a.atime=e.read_shift(4)),4&n&&(a.ctime=e.read_shift(4))),a.mtime&&(a.mt=new Date(1e3*a.mtime));e.l=o,t[r]=a}return t}function a(){return e||(e={})}function s(e,t){if(80==e[0]&&75==e[1])return re(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=S(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var n=t&&t.root||"",r=(jbe&&Buffer.isBuffer(e)?e.toString("binary"):S(e)).split("\r\n"),i=0,o="";for(i=0;i<r.length;++i)if(o=r[i],/^Content-Location:/i.test(o)&&(o=o.slice(o.indexOf("file")),n||(n=o.slice(0,o.lastIndexOf("/")+1)),o.slice(0,n.length)!=n))for(;n.length>0&&(n=(n=n.slice(0,n.length-1)).slice(0,n.lastIndexOf("/")+1),o.slice(0,n.length)!=n););var a=(r[1]||"").match(/boundary="(.*?)"/);if(!a)throw new Error("MAD cannot find boundary");var s="--"+(a[1]||""),l=[],c=[],u={FileIndex:l,FullPaths:c};h(u);var d,f=0;for(i=0;i<r.length;++i){var m=r[i];m!==s&&m!==s+"--"||(f++&&ce(u,r.slice(d,i),n),d=i)}return u}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var n,r,i,o,a,s,f=512,m=[],p=e.slice(0,512);ISe(p,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(y,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(p);switch(n=g[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==g[1])return re(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+n)}512!==f&&ISe(p=e.slice(0,f),28);var b=e.slice(0,f);!function(e,t){var n=9;switch(e.l+=2,n=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+n);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+n);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+n)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(p,n);var w=p.read_shift(4,"i");if(3===n&&0!==w)throw new Error("# Directory Sectors: Expected 0 saw "+w);p.l+=4,o=p.read_shift(4,"i"),p.l+=4,p.chk("00100000","Mini Stream Cutoff Size: "),a=p.read_shift(4,"i"),r=p.read_shift(4,"i"),s=p.read_shift(4,"i"),i=p.read_shift(4,"i");for(var x=-1,C=0;C<109&&!((x=p.read_shift(4,"i"))<0);++C)m[C]=x;var E=function(e,t){for(var n=Math.ceil(e.length/t)-1,r=[],i=1;i<n;++i)r[i-1]=e.slice(i*t,(i+1)*t);return r[n-1]=e.slice(n*t),r}(e,f);c(s,i,E,f,m);var N=function(e,t,n,r){var i=e.length,o=[],a=[],s=[],l=[],c=r-1,u=0,d=0,h=0,f=0;for(u=0;u<i;++u)if(s=[],(h=u+t)>=i&&(h-=i),!a[h]){l=[];var m=[];for(d=h;d>=0;){m[d]=!0,a[d]=!0,s[s.length]=d,l.push(e[d]);var p=n[Math.floor(4*d/r)];if(r<4+(f=4*d&c))throw new Error("FAT boundary crossed: "+d+" 4 "+r);if(!e[p])break;if(m[d=TSe(e[p],f)])break}o[h]={nodes:s,data:tSe([l])}}return o}(E,o,m,f);N[o].name="!Directory",r>0&&a!==v&&(N[a].name="!MiniFAT"),N[m[0]].name="!FAT",N.fat_addrs=m,N.ssz=f;var T=[],A=[],R=[];!function(e,t,n,r,i,o,a,s){for(var c,h=0,f=r.length?2:0,m=t[e].data,p=0,g=0;p<m.length;p+=128){var y=m.slice(p,p+128);ISe(y,64),g=y.read_shift(2),c=rSe(y,0,g-f),r.push(c);var b={name:c,type:y.read_shift(1),color:y.read_shift(1),L:y.read_shift(4,"i"),R:y.read_shift(4,"i"),C:y.read_shift(4,"i"),clsid:y.read_shift(16),state:y.read_shift(4,"i"),start:0,size:0};0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.ct=d(y,y.l-8)),0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.mt=d(y,y.l-8)),b.start=y.read_shift(4,"i"),b.size=y.read_shift(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=v,b.name=""),5===b.type?(h=b.start,i>0&&h!==v&&(t[h].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===t[b.start]&&(t[b.start]=u(n,b.start,t.fat_addrs,t.ssz)),t[b.start].name=b.name,b.content=t[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:h!==v&&b.start!==v&&t[h]&&(b.content=l(b,t[h].data,(t[s]||{}).data))),b.content&&ISe(b.content,0),o[c]=b,a.push(b)}}(o,N,E,T,r,{},A,a),function(e,t,n){for(var r=0,i=0,o=0,a=0,s=0,l=n.length,c=[],u=[];r<l;++r)c[r]=u[r]=r,t[r]=n[r];for(;s<u.length;++s)i=e[r=u[s]].L,o=e[r].R,a=e[r].C,c[r]===r&&(-1!==i&&c[i]!==i&&(c[r]=c[i]),-1!==o&&c[o]!==o&&(c[r]=c[o])),-1!==a&&(c[a]=r),-1!==i&&r!=c[r]&&(c[i]=c[r],u.lastIndexOf(i)<s&&u.push(i)),-1!==o&&r!=c[r]&&(c[o]=c[r],u.lastIndexOf(o)<s&&u.push(o));for(r=1;r<l;++r)c[r]===r&&(-1!==o&&c[o]!==o?c[r]=c[o]:-1!==i&&c[i]!==i&&(c[r]=c[i]));for(r=1;r<l;++r)if(0!==e[r].type){if((s=r)!=c[s])do{s=c[s],t[r]=t[s]+"/"+t[r]}while(0!==s&&-1!==c[s]&&s!=c[s]);c[r]=-1}for(t[0]+="/",r=1;r<l;++r)2!==e[r].type&&(t[r]+="/")}(A,R,T),T.shift();var k={FileIndex:A,FullPaths:R};return t&&t.raw&&(k.raw={header:b,sectors:E}),k}function l(e,t,n){for(var r=e.start,i=e.size,o=[],a=r;n&&i>0&&a>=0;)o.push(t.slice(a*g,a*g+g)),i-=g,a=TSe(n,4*a);return 0===o.length?jSe(0):Vbe(o).slice(0,e.size)}function c(e,t,n,r,i){var o=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var a=n[e],s=(r>>>2)-1;if(!a)return;for(var l=0;l<s&&(o=TSe(a,4*l))!==v;++l)i.push(o);c(TSe(a,r-4),t-1,n,r,i)}}function u(e,t,n,r,i){var o=[],a=[];i||(i=[]);var s=r-1,l=0,c=0;for(l=t;l>=0;){i[l]=!0,o[o.length]=l,a.push(e[l]);var u=n[Math.floor(4*l/r)];if(r<4+(c=4*l&s))throw new Error("FAT boundary crossed: "+l+" 4 "+r);if(!e[u])break;l=TSe(e[u],c)}return{nodes:o,data:tSe([a])}}function d(e,t){return new Date(1e3*(NSe(e,t+4)/1e7*Math.pow(2,32)+NSe(e,t)/1e7-11644473600))}function h(e,t){var n=t||{},r=n.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),n.CLSID&&(e.FileIndex[0].clsid=n.CLSID),function(e){var t="\x01Sh33tJ5";if(Lwe.find(e,"/"+t))return;var n=jSe(4);n[0]=55,n[1]=n[3]=50,n[2]=54,e.FileIndex.push({name:t,type:2,content:n,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}(e)}function f(e,t){h(e);for(var i=!1,o=!1,a=e.FullPaths.length-1;a>=0;--a){var s=e.FileIndex[a];switch(s.type){case 0:o?i=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:o=!0,isNaN(s.R*s.L*s.C)&&(i=!0),s.R>-1&&s.L>-1&&s.R==s.L&&(i=!0);break;default:i=!0}}if(i||t){var l=new Date(1987,1,19),c=0,u=Object.create?Object.create(null):{},d=[];for(a=0;a<e.FullPaths.length;++a)u[e.FullPaths[a]]=!0,0!==e.FileIndex[a].type&&d.push([e.FullPaths[a],e.FileIndex[a]]);for(a=0;a<d.length;++a){var f=n(d[a][0]);(o=u[f])||(d.push([f,{name:r(f).replace("/",""),type:1,clsid:w,ct:l,mt:l,content:null}]),u[f]=!0)}for(d.sort(function(e,t){return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0,o=0,a=Math.min(n.length,r.length);i<a;++i){if(o=n[i].length-r[i].length)return o;if(n[i]!=r[i])return n[i]<r[i]?-1:1}return n.length-r.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],a=0;a<d.length;++a)e.FullPaths[a]=d[a][0],e.FileIndex[a]=d[a][1];for(a=0;a<d.length;++a){var m=e.FileIndex[a],p=e.FullPaths[a];if(m.name=r(p).replace("/",""),m.L=m.R=m.C=-(m.color=1),m.size=m.content?m.content.length:0,m.start=0,m.clsid=m.clsid||w,0===a)m.C=d.length>1?1:-1,m.size=0,m.type=5;else if("/"==p.slice(-1)){for(c=a+1;c<d.length&&n(e.FullPaths[c])!=p;++c);for(m.C=c>=d.length?-1:c,c=a+1;c<d.length&&n(e.FullPaths[c])!=n(p);++c);m.R=c>=d.length?-1:c,m.type=1}else n(e.FullPaths[a+1]||"")==n(p)&&(m.R=a+1),m.type=2}}}function m(e,t){var n=t||{};if("mad"==n.fileType)return function(e,t){for(var n=t||{},r=n.boundary||"SheetJS",i=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(r="------="+r).slice(2)+'"',"","",""],o=e.FullPaths[0],a=o,s=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(a=e.FullPaths[l].slice(o.length),(s=e.FileIndex[l]).size&&s.content&&"\x01Sh33tJ5"!=a){a=a.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=s.content,u=jbe&&Buffer.isBuffer(c)?c.toString("binary"):S(c),d=0,h=Math.min(1024,u.length),f=0,m=0;m<=h;++m)(f=u.charCodeAt(m))>=32&&f<128&&++d;var p=d>=4*h/5;i.push(r),i.push("Content-Location: "+(n.root||"file:///C:/SheetJS/")+a),i.push("Content-Transfer-Encoding: "+(p?"quoted-printable":"base64")),i.push("Content-Type: "+ae(s,a)),i.push(""),i.push(p?le(u):se(u))}return i.push(r+"--\r\n"),i.join("\r\n")}(e,n);if(f(e),"zip"===n.fileType)return function(e,t){var n=t||{},r=[],o=[],a=jSe(1),s=n.compression?8:0,l=0;0;var c=0,u=0,d=0,h=0,f=e.FullPaths[0],m=f,p=e.FileIndex[0],g=[],v=0;for(c=1;c<e.FullPaths.length;++c)if(m=e.FullPaths[c].slice(f.length),(p=e.FileIndex[c]).size&&p.content&&"\x01Sh33tJ5"!=m){var y=d,b=jSe(m.length);for(u=0;u<m.length;++u)b.write_shift(1,127&m.charCodeAt(u));b=b.slice(0,b.l),g[h]=Hwe.buf(p.content,0);var w=p.content;8==s&&(w=C(w)),(a=jSe(30)).write_shift(4,67324752),a.write_shift(2,20),a.write_shift(2,l),a.write_shift(2,s),p.mt?i(a,p.mt):a.write_shift(4,0),a.write_shift(-4,8&l?0:g[h]),a.write_shift(4,8&l?0:w.length),a.write_shift(4,8&l?0:p.content.length),a.write_shift(2,b.length),a.write_shift(2,0),d+=a.length,r.push(a),d+=b.length,r.push(b),d+=w.length,r.push(w),8&l&&((a=jSe(12)).write_shift(-4,g[h]),a.write_shift(4,w.length),a.write_shift(4,p.content.length),d+=a.l,r.push(a)),(a=jSe(46)).write_shift(4,33639248),a.write_shift(2,0),a.write_shift(2,20),a.write_shift(2,l),a.write_shift(2,s),a.write_shift(4,0),a.write_shift(-4,g[h]),a.write_shift(4,w.length),a.write_shift(4,p.content.length),a.write_shift(2,b.length),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(4,0),a.write_shift(4,y),v+=a.l,o.push(a),v+=b.length,o.push(b),++h}return a=jSe(22),a.write_shift(4,101010256),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,h),a.write_shift(2,h),a.write_shift(4,v),a.write_shift(4,d),a.write_shift(2,0),Vbe([Vbe(r),Vbe(o),a])}(e,n);var r=function(e){for(var t=0,n=0,r=0;r<e.FileIndex.length;++r){var i=e.FileIndex[r];if(i.content){var o=i.content.length;o>0&&(o<4096?t+=o+63>>6:n+=o+511>>9)}}for(var a=e.FullPaths.length+3>>2,s=t+127>>7,l=(t+7>>3)+n+a+s,c=l+127>>7,u=c<=109?0:Math.ceil((c-109)/127);l+c+u+127>>7>c;)u=++c<=109?0:Math.ceil((c-109)/127);var d=[1,u,c,s,a,n,t,0];return e.FileIndex[0].size=t<<6,d[7]=(e.FileIndex[0].start=d[0]+d[1]+d[2]+d[3]+d[4]+d[5])+(d[6]+7>>3),d}(e),o=jSe(r[7]<<9),a=0,s=0;for(a=0;a<8;++a)o.write_shift(1,b[a]);for(a=0;a<8;++a)o.write_shift(2,0);for(o.write_shift(2,62),o.write_shift(2,3),o.write_shift(2,65534),o.write_shift(2,9),o.write_shift(2,6),a=0;a<3;++a)o.write_shift(2,0);for(o.write_shift(4,0),o.write_shift(4,r[2]),o.write_shift(4,r[0]+r[1]+r[2]+r[3]-1),o.write_shift(4,0),o.write_shift(4,4096),o.write_shift(4,r[3]?r[0]+r[1]+r[2]-1:v),o.write_shift(4,r[3]),o.write_shift(-4,r[1]?r[0]-1:v),o.write_shift(4,r[1]),a=0;a<109;++a)o.write_shift(-4,a<r[2]?r[1]+a:-1);if(r[1])for(s=0;s<r[1];++s){for(;a<236+127*s;++a)o.write_shift(-4,a<r[2]?r[1]+a:-1);o.write_shift(-4,s===r[1]-1?v:s+1)}var l=function(e){for(s+=e;a<s-1;++a)o.write_shift(-4,a+1);e&&(++a,o.write_shift(-4,v))};for(s=a=0,s+=r[1];a<s;++a)o.write_shift(-4,x.DIFSECT);for(s+=r[2];a<s;++a)o.write_shift(-4,x.FATSECT);l(r[3]),l(r[4]);for(var c=0,u=0,d=e.FileIndex[0];c<e.FileIndex.length;++c)(d=e.FileIndex[c]).content&&((u=d.content.length)<4096||(d.start=s,l(u+511>>9)));for(l(r[6]+7>>3);511&o.l;)o.write_shift(-4,x.ENDOFCHAIN);for(s=a=0,c=0;c<e.FileIndex.length;++c)(d=e.FileIndex[c]).content&&(!(u=d.content.length)||u>=4096||(d.start=s,l(u+63>>6)));for(;511&o.l;)o.write_shift(-4,x.ENDOFCHAIN);for(a=0;a<r[4]<<2;++a){var h=e.FullPaths[a];if(h&&0!==h.length){d=e.FileIndex[a],0===a&&(d.start=d.size?d.start-1:v);var m=0===a&&n.root||d.name;if(u=2*(m.length+1),o.write_shift(64,m,"utf16le"),o.write_shift(2,u),o.write_shift(1,d.type),o.write_shift(1,d.color),o.write_shift(-4,d.L),o.write_shift(-4,d.R),o.write_shift(-4,d.C),d.clsid)o.write_shift(16,d.clsid,"hex");else for(c=0;c<4;++c)o.write_shift(4,0);o.write_shift(4,d.state||0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,d.start),o.write_shift(4,d.size),o.write_shift(4,0)}else{for(c=0;c<17;++c)o.write_shift(4,0);for(c=0;c<3;++c)o.write_shift(4,-1);for(c=0;c<12;++c)o.write_shift(4,0)}}for(a=1;a<e.FileIndex.length;++a)if((d=e.FileIndex[a]).size>=4096)if(o.l=d.start+1<<9,jbe&&Buffer.isBuffer(d.content))d.content.copy(o,o.l,0,d.size),o.l+=d.size+511&-512;else{for(c=0;c<d.size;++c)o.write_shift(1,d.content[c]);for(;511&c;++c)o.write_shift(1,0)}for(a=1;a<e.FileIndex.length;++a)if((d=e.FileIndex[a]).size>0&&d.size<4096)if(jbe&&Buffer.isBuffer(d.content))d.content.copy(o,o.l,0,d.size),o.l+=d.size+63&-64;else{for(c=0;c<d.size;++c)o.write_shift(1,d.content[c]);for(;63&c;++c)o.write_shift(1,0)}if(jbe)o.l=o.length;else for(;o.l<o.length;)o.write_shift(1,0);return o}t.version="1.2.1";var p,g=64,v=-2,y="d0cf11e0a1b11ae1",b=[208,207,17,224,161,177,26,225],w="00000000000000000000000000000000",x={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:w,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function S(e){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function C(e){return p?p.deflateRawSync(e):K(e)}var E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],N=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],T=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function A(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var R="undefined"!==typeof Uint8Array,k=R?new Uint8Array(256):[],M=0;M<256;++M)k[M]=A(M);function D(e,t){var n=k[255&e];return t<=8?n>>>8-t:(n=n<<8|k[e>>8&255],t<=16?n>>>16-t:(n=n<<8|k[e>>16&255])>>>24-t)}function _(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=6?0:e[r+1]<<8))>>>n&3}function O(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=5?0:e[r+1]<<8))>>>n&7}function I(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=3?0:e[r+1]<<8))>>>n&31}function P(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=1?0:e[r+1]<<8))>>>n&127}function j(e,t,n){var r=7&t,i=t>>>3,o=(1<<n)-1,a=e[i]>>>r;return n<8-r?a&o:(a|=e[i+1]<<8-r,n<16-r?a&o:(a|=e[i+2]<<16-r,n<24-r?a&o:(a|=e[i+3]<<24-r)&o))}function F(e,t,n){var r=7&t,i=t>>>3;return r<=5?e[i]|=(7&n)<<r:(e[i]|=n<<r&255,e[i+1]=(7&n)>>8-r),t+3}function H(e,t,n){return n=(1&n)<<(7&t),e[t>>>3]|=n,t+1}function L(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=n,t+8}function B(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=255&n,e[r+2]=n>>>8,t+16}function z(e,t){var n=e.length,r=2*n>t?2*n:t+5,i=0;if(n>=t)return e;if(jbe){var o=Lbe(r);if(e.copy)e.copy(o);else for(;i<e.length;++i)o[i]=e[i];return o}if(R){var a=new Uint8Array(r);if(a.set)a.set(e);else for(;i<n;++i)a[i]=e[i];return a}return e.length=r,e}function W(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}function V(e,t,n){var r=1,i=0,o=0,a=0,s=0,l=e.length,c=R?new Uint16Array(32):W(32);for(o=0;o<32;++o)c[o]=0;for(o=l;o<n;++o)e[o]=0;l=e.length;var u=R?new Uint16Array(l):W(l);for(o=0;o<l;++o)c[i=e[o]]++,r<i&&(r=i),u[o]=0;for(c[0]=0,o=1;o<=r;++o)c[o+16]=s=s+c[o-1]<<1;for(o=0;o<l;++o)0!=(s=e[o])&&(u[o]=c[s+16]++);var d=0;for(o=0;o<l;++o)if(0!=(d=e[o]))for(s=D(u[o],r)>>r-d,a=(1<<r+4-d)-1;a>=0;--a)t[s|a<<d]=15&d|o<<4;return r}var U=R?new Uint16Array(512):W(512),q=R?new Uint16Array(32):W(32);if(!R){for(var G=0;G<512;++G)U[G]=0;for(G=0;G<32;++G)q[G]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);V(e,q,32);var n=[];for(t=0;t<=143;t++)n.push(8);for(;t<=255;t++)n.push(9);for(;t<=279;t++)n.push(7);for(;t<=287;t++)n.push(8);V(n,U,288)}();var Y=function(){for(var e=R?new Uint8Array(32768):[],t=0,n=0;t<T.length-1;++t)for(;n<T[t+1];++n)e[n]=t;for(;n<32768;++n)e[n]=29;var r=R?new Uint8Array(259):[];for(t=0,n=0;t<N.length-1;++t)for(;n<N[t+1];++n)r[n]=t;return function(t,n){return t.length<8?function(e,t){for(var n=0;n<e.length;){var r=Math.min(65535,e.length-n),i=n+r==e.length;for(t.write_shift(1,+i),t.write_shift(2,r),t.write_shift(2,65535&~r);r-- >0;)t[t.l++]=e[n++]}return t.l}(t,n):function(t,n){for(var i=0,o=0,a=R?new Uint16Array(32768):[];o<t.length;){var s=Math.min(65535,t.length-o);if(s<10){for(7&(i=F(n,i,+!(o+s!=t.length)))&&(i+=8-(7&i)),n.l=i/8|0,n.write_shift(2,s),n.write_shift(2,65535&~s);s-- >0;)n[n.l++]=t[o++];i=8*n.l}else{i=F(n,i,+!(o+s!=t.length)+2);for(var l=0;s-- >0;){var c=t[o],u=-1,d=0;if((u=a[l=32767&(l<<5^c)])&&((u|=-32768&o)>o&&(u-=32768),u<o))for(;t[u+d]==t[o+d]&&d<250;)++d;if(d>2){(c=r[d])<=22?i=L(n,i,k[c+1]>>1)-1:(L(n,i,3),L(n,i+=5,k[c-23]>>5),i+=3);var h=c<8?0:c-4>>2;h>0&&(B(n,i,d-N[c]),i+=h),c=e[o-u],i=L(n,i,k[c]>>3),i-=3;var f=c<4?0:c-2>>1;f>0&&(B(n,i,o-u-T[c]),i+=f);for(var m=0;m<d;++m)a[l]=32767&o,l=32767&(l<<5^t[o]),++o;s-=d-1}else c<=143?c+=48:i=H(n,i,1),i=L(n,i,k[c]),a[l]=32767&o,++o}i=L(n,i,0)-1}}return n.l=(i+7)/8|0,n.l}(t,n)}}();function K(e){var t=jSe(50+Math.floor(1.1*e.length)),n=Y(e,t);return t.slice(0,n)}var $=R?new Uint16Array(32768):W(32768),X=R?new Uint16Array(32768):W(32768),Q=R?new Uint16Array(128):W(128),J=1,Z=1;function ee(e,t){var n=I(e,t)+257,r=I(e,t+=5)+1,i=function(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=4?0:e[r+1]<<8))>>>n&15}(e,t+=5)+4;t+=4;for(var o=0,a=R?new Uint8Array(19):W(19),s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=R?new Uint8Array(8):W(8),u=R?new Uint8Array(8):W(8),d=a.length,h=0;h<i;++h)a[E[h]]=o=O(e,t),l<o&&(l=o),c[o]++,t+=3;var f=0;for(c[0]=0,h=1;h<=l;++h)u[h]=f=f+c[h-1]<<1;for(h=0;h<d;++h)0!=(f=a[h])&&(s[h]=u[f]++);var m=0;for(h=0;h<d;++h)if(0!=(m=a[h])){f=k[s[h]]>>8-m;for(var p=(1<<7-m)-1;p>=0;--p)Q[f|p<<m]=7&m|h<<3}var g=[];for(l=1;g.length<n+r;)switch(t+=7&(f=Q[P(e,t)]),f>>>=3){case 16:for(o=3+_(e,t),t+=2,f=g[g.length-1];o-- >0;)g.push(f);break;case 17:for(o=3+O(e,t),t+=3;o-- >0;)g.push(0);break;case 18:for(o=11+P(e,t),t+=7;o-- >0;)g.push(0);break;default:g.push(f),l<f&&(l=f)}var v=g.slice(0,n),y=g.slice(n);for(h=n;h<286;++h)v[h]=0;for(h=r;h<30;++h)y[h]=0;return J=V(v,$,286),Z=V(y,X,30),t}function te(e,t){var n=function(e,t){if(3==e[0]&&!(3&e[1]))return[Hbe(t),2];for(var n=0,r=0,i=Lbe(t||1<<18),o=0,a=i.length>>>0,s=0,l=0;0==(1&r);)if(r=O(e,n),n+=3,r>>>1!=0)for(r>>1==1?(s=9,l=5):(n=ee(e,n),s=J,l=Z);;){!t&&a<o+32767&&(a=(i=z(i,o+32767)).length);var c=j(e,n,s),u=r>>>1==1?U[c]:$[c];if(n+=15&u,0===((u>>>=4)>>>8&255))i[o++]=u;else{if(256==u)break;var d=(u-=257)<8?0:u-4>>2;d>5&&(d=0);var h=o+N[u];d>0&&(h+=j(e,n,d),n+=d),c=j(e,n,l),n+=15&(u=r>>>1==1?q[c]:X[c]);var f=(u>>>=4)<4?0:u-2>>1,m=T[u];for(f>0&&(m+=j(e,n,f),n+=f),!t&&a<h&&(a=(i=z(i,h+100)).length);o<h;)i[o]=i[o-m],++o}}else{7&n&&(n+=8-(7&n));var p=e[n>>>3]|e[(n>>>3)+1]<<8;if(n+=32,p>0)for(!t&&a<o+p&&(a=(i=z(i,o+p)).length);p-- >0;)i[o++]=e[n>>>3],n+=8}return t?[i,n+7>>>3]:[i.slice(0,o),n+7>>>3]}(e.slice(e.l||0),t);return e.l+=n[1],n[0]}function ne(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function re(e,t){var n=e;ISe(n,0);var r={FileIndex:[],FullPaths:[]};h(r,{root:t.root});for(var i=n.length-4;(80!=n[i]||75!=n[i+1]||5!=n[i+2]||6!=n[i+3])&&i>=0;)--i;n.l=i+4,n.l+=4;var a=n.read_shift(2);n.l+=6;var s=n.read_shift(4);for(n.l=s,i=0;i<a;++i){n.l+=20;var l=n.read_shift(4),c=n.read_shift(4),u=n.read_shift(2),d=n.read_shift(2),f=n.read_shift(2);n.l+=8;var m=n.read_shift(4),p=o(n.slice(n.l+u,n.l+u+d));n.l+=u+d+f;var g=n.l;n.l=m+4,ie(n,l,c,r,p),n.l=g}return r}function ie(e,t,n,r,i){e.l+=2;var a=e.read_shift(2),s=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),n=65535&e.read_shift(2),r=new Date,i=31&n,o=15&(n>>>=5);n>>>=4,r.setMilliseconds(0),r.setFullYear(n+1980),r.setMonth(o-1),r.setDate(i);var a=31&t,s=63&(t>>>=5);return t>>>=6,r.setHours(t),r.setMinutes(s),r.setSeconds(a<<1),r}(e);if(8257&a)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(2),h=e.read_shift(2),f="",m=0;m<d;++m)f+=String.fromCharCode(e[e.l++]);if(h){var g=o(e.slice(e.l,e.l+h));(g[21589]||{}).mt&&(l=g[21589].mt),((i||{})[21589]||{}).mt&&(l=i[21589].mt)}e.l+=h;var v=e.slice(e.l,e.l+c);switch(s){case 8:v=function(e,t){if(!p)return te(e,t);var n=new(0,p.InflateRaw),r=n._processChunk(e.slice(e.l),n._finishFlushFlag);return e.l+=n.bytesRead,r}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+s)}var y=!1;8&a&&(134695760==e.read_shift(4)&&(e.read_shift(4),y=!0),c=e.read_shift(4),u=e.read_shift(4)),c!=t&&ne(y,"Bad compressed size: "+t+" != "+c),u!=n&&ne(y,"Bad uncompressed size: "+n+" != "+u),ue(r,f,v,{unsafe:!0,mt:l})}var oe={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ae(e,t){if(e.ctype)return e.ctype;var n=e.name||"",r=n.match(/\.([^\.]+)$/);return r&&oe[r[1]]||t&&(r=(n=t).match(/[\.\\]([^\.\\])+$/))&&oe[r[1]]?oe[r[1]]:"application/octet-stream"}function se(e){for(var t=Ibe(e),n=[],r=0;r<t.length;r+=76)n.push(t.slice(r,r+76));return n.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)});"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var n=[],r=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),i=0;i<r.length;++i){var o=r[i];if(0!=o.length)for(var a=0;a<o.length;){var s=76,l=o.slice(a,a+s);"="==l.charAt(s-1)?s--:"="==l.charAt(s-2)?s-=2:"="==l.charAt(s-3)&&(s-=3),l=o.slice(a,a+s),(a+=s)<o.length&&(l+="="),n.push(l)}else n.push("")}return n.join("\r\n")}function ce(e,t,n){for(var r,i="",o="",a="",s=0;s<10;++s){var l=t[s];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":i=c[2].trim();break;case"content-type":a=c[2].trim();break;case"content-transfer-encoding":o=c[2].trim()}}switch(++s,o.toLowerCase()){case"base64":r=Bbe(Pbe(t.slice(s).join("")));break;case"quoted-printable":r=function(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n];n<=e.length&&"="==r.charAt(r.length-1);)r=r.slice(0,r.length-1)+e[++n];t.push(r)}for(var i=0;i<t.length;++i)t[i]=t[i].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return Bbe(t.join("\r\n"))}(t.slice(s));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+o)}var u=ue(e,i.slice(n.length),r,{unsafe:!0});a&&(u.ctype=a)}function ue(e,t,n,i){var o=i&&i.unsafe;o||h(e);var a=!o&&Lwe.find(e,t);if(!a){var s=e.FullPaths[0];t.slice(0,s.length)==s?s=t:("/"!=s.slice(-1)&&(s+="/"),s=(s+t).replace("//","/")),a={name:r(t),type:2},e.FileIndex.push(a),e.FullPaths.push(s),o||Lwe.utils.cfb_gc(e)}return a.content=n,a.size=n?n.length:0,i&&(i.CLSID&&(a.clsid=i.CLSID),i.mt&&(a.mt=i.mt),i.ct&&(a.ct=i.ct)),a}return t.find=function(e,t){var n=e.FullPaths.map(function(e){return e.toUpperCase()}),r=n.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),i=!1;47===t.charCodeAt(0)?(i=!0,t=n[0].slice(0,-1)+t):i=-1!==t.indexOf("/");var o=t.toUpperCase(),a=!0===i?n.indexOf(o):r.indexOf(o);if(-1!==a)return e.FileIndex[a];var s=!o.match(qbe);for(o=o.replace(Ube,""),s&&(o=o.replace(qbe,"!")),a=0;a<n.length;++a){if((s?n[a].replace(qbe,"!"):n[a]).replace(Ube,"")==o)return e.FileIndex[a];if((s?r[a].replace(qbe,"!"):r[a]).replace(Ube,"")==o)return e.FileIndex[a]}return null},t.read=function(t,n){var r=n&&n.type;switch(r||jbe&&Buffer.isBuffer(t)&&(r="buffer"),r||"base64"){case"file":return function(t,n){return a(),s(e.readFileSync(t),n)}(t,n);case"base64":return s(Bbe(Pbe(t)),n);case"binary":return s(Bbe(t),n)}return s(t,n)},t.parse=s,t.write=function(t,n){var r=m(t,n);switch(n&&n.type||"buffer"){case"file":return a(),e.writeFileSync(n.filename,r),r;case"binary":return"string"==typeof r?r:S(r);case"base64":return Ibe("string"==typeof r?r:S(r));case"buffer":if(jbe)return Buffer.isBuffer(r)?r:Fbe(r);case"array":return"string"==typeof r?Bbe(r):r}return r},t.writeFile=function(t,n,r){a();var i=m(t,r);e.writeFileSync(n,i)},t.utils={cfb_new:function(e){var t={};return h(t,e),t},cfb_add:ue,cfb_del:function(e,t){h(e);var n=Lwe.find(e,t);if(n)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==n)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,t,n){h(e);var i=Lwe.find(e,t);if(i)for(var o=0;o<e.FileIndex.length;++o)if(e.FileIndex[o]==i)return e.FileIndex[o].name=r(n),e.FullPaths[o]=n,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:RSe,CheckField:OSe,prep_blob:ISe,bconcat:Vbe,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");p=e}catch(qb){console.error("cannot use native zlib: "+(qb.message||qb))}},_deflateRaw:K,_inflateRaw:te,consts:x},t}();let Bwe;function zwe(e){return"string"===typeof e?zbe(e):Array.isArray(e)?function(e){if("undefined"===typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function Wwe(e,t,n){if("undefined"!==typeof Bwe&&Bwe.writeFileSync)return n?Bwe.writeFileSync(e,t,n):Bwe.writeFileSync(e,t);if("undefined"!==typeof Deno){if(n&&"string"==typeof t)switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=zbe(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r="utf8"==n?Txe(t):t;if("undefined"!==typeof IE_SaveFile)return IE_SaveFile(r,e);if("undefined"!==typeof Blob){var i=new Blob([zwe(r)],{type:"application/octet-stream"});if("undefined"!==typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if("undefined"!==typeof saveAs)return saveAs(i,e);if("undefined"!==typeof URL&&"undefined"!==typeof document&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(i);if("object"===typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:e,saveAs:!0});var a=document.createElement("a");if(null!=a.download)return a.download=e,a.href=o,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var s=File(e);return s.open("w"),s.encoding="binary",Array.isArray(t)&&(t=Wbe(t)),s.write(t),s.close(),t}catch(qb){if(!qb.message||!qb.message.match(/onstruct/))throw qb}throw new Error("cannot save file "+e)}function Vwe(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function Uwe(e,t){for(var n=[],r=Vwe(e),i=0;i!==r.length;++i)null==n[e[r[i]][t]]&&(n[e[r[i]][t]]=r[i]);return n}function qwe(e){for(var t=[],n=Vwe(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function Gwe(e){for(var t=[],n=Vwe(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}var Ywe=new Date(1899,11,30,0,0,0);function Kwe(e,t){var n=e.getTime();return t&&(n-=1263168e5),(n-(Ywe.getTime()+6e4*(e.getTimezoneOffset()-Ywe.getTimezoneOffset())))/864e5}var $we=new Date,Xwe=Ywe.getTime()+6e4*($we.getTimezoneOffset()-Ywe.getTimezoneOffset()),Qwe=$we.getTimezoneOffset();function Jwe(e){var t=new Date;return t.setTime(24*e*60*60*1e3+Xwe),t.getTimezoneOffset()!==Qwe&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-Qwe)),t}var Zwe=new Date("2017-02-19T19:06:09.000Z"),exe=isNaN(Zwe.getFullYear())?new Date("2/19/17"):Zwe,txe=2017==exe.getFullYear();function nxe(e,t){var n=new Date(e);if(txe)return t>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(e instanceof Date)return e;if(1917==exe.getFullYear()&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-60*o.getTimezoneOffset()*1e3)),o}function rxe(e,t){if(jbe&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return Txe(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return Txe(kbe(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return Txe(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return Txe(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(e){return n[e]||e})}catch(qb){}for(var r=[],i=0;i!=e.length;++i)r.push(String.fromCharCode(e[i]));return r.join("")}function ixe(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=ixe(e[n]));return t}function oxe(e,t){for(var n="";n.length<t;)n+=e;return n}function axe(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return isNaN(t=Number(r))?(r=r.replace(/[(](.*)[)]/,function(e,t){return n=-n,t}),isNaN(t=Number(r))?t:t/n):t/n}var sxe=["january","february","march","april","may","june","july","august","september","october","november","december"];function lxe(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),i=t.getMonth(),o=t.getDate();if(isNaN(o))return n;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==sxe.indexOf(a))return n}else if(a.match(/[a-z]/))return n;return r<0||r>8099?n:(i>0||o>1)&&101!=r?t:e.match(/[^-0-9:,\/\\]/)?n:t}function cxe(e,t,n){if(e.FullPaths){var r;if("string"==typeof n)return r=jbe?Fbe(n):function(e){for(var t=[],n=0,r=e.length+250,i=Hbe(e.length+255),o=0;o<e.length;++o){var a=e.charCodeAt(o);if(a<128)i[n++]=a;else if(a<2048)i[n++]=192|a>>6&31,i[n++]=128|63&a;else if(a>=55296&&a<57344){a=64+(1023&a);var s=1023&e.charCodeAt(++o);i[n++]=240|a>>8&7,i[n++]=128|a>>2&63,i[n++]=128|s>>6&15|(3&a)<<4,i[n++]=128|63&s}else i[n++]=224|a>>12&15,i[n++]=128|a>>6&63,i[n++]=128|63&a;n>r&&(t.push(i.slice(0,n)),n=0,i=Hbe(65535),r=65530)}return t.push(i.slice(0,n)),Vbe(t)}(n),Lwe.utils.cfb_add(e,t,r);Lwe.utils.cfb_add(e,t,n)}else e.file(t,n)}function uxe(){return Lwe.utils.cfb_new()}var dxe='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n';var hxe={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},fxe=qwe(hxe),mxe=/[&<>'"]/g,pxe=/[\u0000-\u0008\u000b-\u001f]/g;function gxe(e){return(e+"").replace(mxe,function(e){return fxe[e]}).replace(pxe,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function vxe(e){return gxe(e).replace(/ /g,"_x0020_")}var yxe=/[\u0000-\u001f]/g;function bxe(e){return(e+"").replace(mxe,function(e){return fxe[e]}).replace(/\n/g,"<br/>").replace(yxe,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function wxe(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function xxe(e){for(var t="",n=0,r=0,i=0,o=0,a=0,s=0;n<e.length;)(r=e.charCodeAt(n++))<128?t+=String.fromCharCode(r):(i=e.charCodeAt(n++),r>191&&r<224?(a=(31&r)<<6,a|=63&i,t+=String.fromCharCode(a)):(o=e.charCodeAt(n++),r<240?t+=String.fromCharCode((15&r)<<12|(63&i)<<6|63&o):(s=((7&r)<<18|(63&i)<<12|(63&o)<<6|63&(a=e.charCodeAt(n++)))-65536,t+=String.fromCharCode(55296+(s>>>10&1023)),t+=String.fromCharCode(56320+(1023&s)))));return t}function Sxe(e){var t,n,r,i=Hbe(2*e.length),o=1,a=0,s=0;for(n=0;n<e.length;n+=o)o=1,(r=e.charCodeAt(n))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(n+1)),o=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(n+1))+(63&e.charCodeAt(n+2)),o=3):(o=4,t=262144*(7&r)+4096*(63&e.charCodeAt(n+1))+64*(63&e.charCodeAt(n+2))+(63&e.charCodeAt(n+3)),s=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==s&&(i[a++]=255&s,i[a++]=s>>>8,s=0),i[a++]=t%256,i[a++]=t>>>8;return i.slice(0,a).toString("ucs2")}function Cxe(e){return Fbe(e,"binary").toString("utf8")}var Exe="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",Nxe=jbe&&(Cxe(Exe)==xxe(Exe)&&Cxe||Sxe(Exe)==xxe(Exe)&&Sxe)||xxe,Txe=jbe?function(e){return Fbe(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,i=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,i=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(63&i)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)))}return t.join("")},Axe=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<e.length;++r)n=n.replace(e[r][0],e[r][1]);return n}}();var Rxe=/(^\s|\s$|\n)/;function kxe(e,t){return"<"+e+(t.match(Rxe)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Mxe(e){return Vwe(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Dxe(e,t,n){return"<"+e+(null!=n?Mxe(n):"")+(null!=t?(t.match(Rxe)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function _xe(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(qb){if(t)throw qb}return""}var Oxe="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",Ixe="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",Pxe="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",jxe="http://schemas.openxmlformats.org/package/2006/content-types",Fxe="http://schemas.openxmlformats.org/package/2006/relationships",Hxe="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",Lxe="http://purl.org/dc/elements/1.1/",Bxe="http://purl.org/dc/terms/",zxe="http://purl.org/dc/dcmitype/",Wxe="http://schemas.openxmlformats.org/officeDocument/2006/relationships",Vxe="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",Uxe="http://www.w3.org/2001/XMLSchema-instance",qxe="http://www.w3.org/2001/XMLSchema",Gxe=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Yxe="urn:schemas-microsoft-com:office:office",Kxe="urn:schemas-microsoft-com:office:excel",$xe="urn:schemas-microsoft-com:office:spreadsheet",Xxe="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",Qxe="http://macVmlSchemaUri",Jxe="urn:schemas-microsoft-com:vml",Zxe="http://www.w3.org/TR/REC-html40";var eSe=function(e){for(var t=[],n=0;n<e[0].length;++n)if(e[0][n])for(var r=0,i=e[0][n].length;r<i;r+=10240)t.push.apply(t,e[0][n].slice(r,r+10240));return t},tSe=jbe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:Fbe(e)})):eSe(e)}:eSe,nSe=function(e,t,n){for(var r=[],i=t;i<n;i+=2)r.push(String.fromCharCode(CSe(e,i)));return r.join("").replace(Ube,"")},rSe=jbe?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(Ube,""):nSe(e,t,n)}:nSe,iSe=function(e,t,n){for(var r=[],i=t;i<t+n;++i)r.push(("0"+e[i].toString(16)).slice(-2));return r.join("")},oSe=jbe?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):iSe(e,t,n)}:iSe,aSe=function(e,t,n){for(var r=[],i=t;i<n;i++)r.push(String.fromCharCode(SSe(e,i)));return r.join("")},sSe=jbe?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):aSe(e,t,n)}:aSe,lSe=function(e,t){var n=NSe(e,t);return n>0?sSe(e,t+4,t+4+n-1):""},cSe=lSe,uSe=function(e,t){var n=NSe(e,t);return n>0?sSe(e,t+4,t+4+n-1):""},dSe=uSe,hSe=function(e,t){var n=2*NSe(e,t);return n>0?sSe(e,t+4,t+4+n-1):""},fSe=hSe,mSe=function(e,t){var n=NSe(e,t);return n>0?rSe(e,t+4,t+4+n):""},pSe=mSe,gSe=function(e,t){var n=NSe(e,t);return n>0?sSe(e,t+4,t+4+n):""},vSe=gSe,ySe=function(e,t){return function(e,t){for(var n=1-2*(e[t+7]>>>7),r=((127&e[t+7])<<4)+(e[t+6]>>>4&15),i=15&e[t+6],o=5;o>=0;--o)i=256*i+e[t+o];return 2047==r?0==i?n*(1/0):NaN:(0==r?r=-1022:(r-=1023,i+=Math.pow(2,52)),n*Math.pow(2,r-52)*i)}(e,t)},bSe=ySe,wSe=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function xSe(){rSe=function(e,t,n){return Mbe.utils.decode(1200,e.slice(t,n)).replace(Ube,"")},sSe=function(e,t,n){return Mbe.utils.decode(65001,e.slice(t,n))},cSe=function(e,t){var n=NSe(e,t);return n>0?Mbe.utils.decode(Cbe,e.slice(t+4,t+4+n-1)):""},dSe=function(e,t){var n=NSe(e,t);return n>0?Mbe.utils.decode(Sbe,e.slice(t+4,t+4+n-1)):""},fSe=function(e,t){var n=2*NSe(e,t);return n>0?Mbe.utils.decode(1200,e.slice(t+4,t+4+n-1)):""},pSe=function(e,t){var n=NSe(e,t);return n>0?Mbe.utils.decode(1200,e.slice(t+4,t+4+n)):""},vSe=function(e,t){var n=NSe(e,t);return n>0?Mbe.utils.decode(65001,e.slice(t+4,t+4+n)):""}}jbe&&(cSe=function(e,t){if(!Buffer.isBuffer(e))return lSe(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},dSe=function(e,t){if(!Buffer.isBuffer(e))return uSe(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},fSe=function(e,t){if(!Buffer.isBuffer(e))return hSe(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},pSe=function(e,t){if(!Buffer.isBuffer(e))return mSe(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},vSe=function(e,t){if(!Buffer.isBuffer(e))return gSe(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},bSe=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):ySe(e,t)},wSe=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof Mbe&&xSe();var SSe=function(e,t){return e[t]},CSe=function(e,t){return 256*e[t+1]+e[t]},ESe=function(e,t){var n=256*e[t+1]+e[t];return n<32768?n:-1*(65535-n+1)},NSe=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},TSe=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},ASe=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function RSe(e,t){var n,r,i,o,a,s,l="",c=[];switch(t){case"dbcs":if(s=this.l,jbe&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(a=0;a<e;++a)l+=String.fromCharCode(CSe(this,s)),s+=2;e*=2;break;case"utf8":l=sSe(this,this.l,this.l+e);break;case"utf16le":e*=2,l=rSe(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof Mbe)return RSe.call(this,e,"dbcs");l=Mbe.utils.decode(Sbe,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=cSe(this,this.l),e=4+NSe(this,this.l);break;case"lpstr-cp":l=dSe(this,this.l),e=4+NSe(this,this.l);break;case"lpwstr":l=fSe(this,this.l),e=4+2*NSe(this,this.l);break;case"lpp4":e=4+NSe(this,this.l),l=pSe(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+NSe(this,this.l),l=vSe(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(i=SSe(this,this.l+e++));)c.push(Dbe(i));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(i=CSe(this,this.l+e));)c.push(Dbe(i)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",s=this.l,a=0;a<e;++a){if(this.lens&&-1!==this.lens.indexOf(s))return i=SSe(this,s),this.l=s+1,o=RSe.call(this,e-a,i?"dbcs-cont":"sbcs-cont"),c.join("")+o;c.push(Dbe(CSe(this,s))),s+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof Mbe){l=Mbe.utils.decode(Sbe,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",s=this.l,a=0;a!=e;++a){if(this.lens&&-1!==this.lens.indexOf(s))return i=SSe(this,s),this.l=s+1,o=RSe.call(this,e-a,i?"dbcs-cont":"sbcs-cont"),c.join("")+o;c.push(Dbe(SSe(this,s))),s+=1}l=c.join("");break;default:switch(e){case 1:return n=SSe(this,this.l),this.l++,n;case 2:return n=("i"===t?ESe:CSe)(this,this.l),this.l+=2,n;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(n=(e>0?TSe:ASe)(this,this.l),this.l+=4,n):(r=NSe(this,this.l),this.l+=4,r);case 8:case-8:if("f"===t)return r=8==e?bSe(this,this.l):bSe([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:l=oSe(this,this.l,e)}}return this.l+=e,l}var kSe=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},MSe=function(e,t,n){e[n]=255&t,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},DSe=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255};function _Se(e,t,n){var r=0,i=0;if("dbcs"===n){for(i=0;i!=t.length;++i)DSe(this,t.charCodeAt(i),this.l+2*i);r=2*t.length}else if("sbcs"===n){if("undefined"!==typeof Mbe&&874==Cbe)for(i=0;i!=t.length;++i){var o=Mbe.utils.encode(Cbe,t.charAt(i));this[this.l+i]=o[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=255&t.charCodeAt(i);r=t.length}else{if("hex"===n){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}if("utf16le"===n){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var s=t.charCodeAt(i);this[this.l++]=255&s,this[this.l++]=s>>8}for(;this.l<a;)this[this.l++]=0;return this}switch(e){case 1:r=1,this[this.l]=255&t;break;case 2:r=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:r=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:r=4,kSe(this,t,this.l);break;case 8:if(r=8,"f"===n){!function(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,i=0,o=0,a=r?-t:t;isFinite(a)?0==a?i=o=0:(i=Math.floor(Math.log(a)/Math.LN2),o=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?i=-1022:(o-=Math.pow(2,52),i+=1023)):(i=2047,o=isNaN(t)?26985:0);for(var s=0;s<=5;++s,o/=256)e[n+s]=255&o;e[n+6]=(15&i)<<4|15&o,e[n+7]=i>>4|r}(this,t,this.l);break}case 16:break;case-4:r=4,MSe(this,t,this.l)}}return this.l+=r,this}function OSe(e,t){var n=oSe(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function ISe(e,t){e.l=t,e.read_shift=RSe,e.chk=OSe,e.write_shift=_Se}function PSe(e,t){e.l+=t}function jSe(e){var t=Hbe(e);return ISe(t,0),t}function FSe(){var e=[],t=jbe?256:2048,n=function(e){var t=jSe(e);return ISe(t,0),t},r=n(t),i=function(){r&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&e.push(r),r=null)},o=function(e){return r&&e<r.length-r.l?r:(i(),r=n(Math.max(e+1,t)))};return{next:o,push:function(e){i(),null==(r=e).l&&(r.l=r.length),o(t)},end:function(){return i(),Vbe(e)},_bufs:e}}function HSe(e,t,n,r){var i,o=+t;if(!isNaN(o)){r||(r=ZTe[o].p||(n||[]).length||0),i=1+(o>=128?1:0)+1,r>=128&&++i,r>=16384&&++i,r>=2097152&&++i;var a=e.next(i);o<=127?a.write_shift(1,o):(a.write_shift(1,128+(127&o)),a.write_shift(1,o>>7));for(var s=0;4!=s;++s){if(!(r>=128)){a.write_shift(1,r);break}a.write_shift(1,128+(127&r)),r>>=7}r>0&&wSe(n)&&e.push(n)}}function LSe(e,t,n){var r=ixe(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function BSe(e,t,n){var r=ixe(e);return r.s=LSe(r.s,t.s,n),r.e=LSe(r.e,t.s,n),r}function zSe(e,t){if(e.cRel&&e.c<0)for(e=ixe(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ixe(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=KSe(e);return e.cRel||null==e.cRel||(n=n.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(n=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(n)),n}function WSe(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?zSe(e.s,t.biff)+":"+zSe(e.e,t.biff):(e.s.rRel?"":"$")+USe(e.s.r)+":"+(e.e.rRel?"":"$")+USe(e.e.r):(e.s.cRel?"":"$")+GSe(e.s.c)+":"+(e.e.cRel?"":"$")+GSe(e.e.c)}function VSe(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function USe(e){return""+(e+1)}function qSe(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function GSe(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function YSe(e){for(var t=0,n=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(n=26*n+(i-64))}return{c:n-1,r:t-1}}function KSe(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function $Se(e){var t=e.indexOf(":");return-1==t?{s:YSe(e),e:YSe(e)}:{s:YSe(e.slice(0,t)),e:YSe(e.slice(t+1))}}function XSe(e,t){return"undefined"===typeof t||"number"===typeof t?XSe(e.s,e.e):("string"!==typeof e&&(e=KSe(e)),"string"!==typeof t&&(t=KSe(t)),e==t?e:e+":"+t)}function QSe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,i=0,o=e.length;for(n=0;r<o&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.s.c=--n,n=0;r<o&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;if(t.s.r=--n,r===o||10!=i)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=o&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.e.c=--n,n=0;r!=o&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;return t.e.r=--n,t}function JSe(e,t){var n="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=Owe(e.z,n?Kwe(t):t)}catch(qb){}try{return e.w=Owe((e.XF||{}).numFmtId||(n?14:0),n?Kwe(t):t)}catch(qb){return""+t}}function ZSe(e,t,n){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),"e"==e.t?ICe[e.v]||e.v:JSe(e,void 0==t?e.v:t))}function eCe(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function tCe(e,t,n){var r=n||{},i=e?Array.isArray(e):r.dense;var o=e||(i?[]:{}),a=0,s=0;if(o&&null!=r.origin){if("number"==typeof r.origin)a=r.origin;else{var l="string"==typeof r.origin?YSe(r.origin):r.origin;a=l.r,s=l.c}o["!ref"]||(o["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var u=QSe(o["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),-1==a&&(c.e.r=a=u.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if("undefined"!==typeof t[d][h]){var f={v:t[d][h]},m=a+d,p=s+h;if(c.s.r>m&&(c.s.r=m),c.s.c>p&&(c.s.c=p),c.e.r<m&&(c.e.r=m),c.e.c<p&&(c.e.c=p),!t[d][h]||"object"!==typeof t[d][h]||Array.isArray(t[d][h])||t[d][h]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[d][h][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(r.nullError)f.t="e",f.v=0;else{if(!r.sheetStubs)continue;f.t="z"}else"number"===typeof f.v?f.t="n":"boolean"===typeof f.v?f.t="b":f.v instanceof Date?(f.z=r.dateNF||twe[14],r.cellDates?(f.t="d",f.w=Owe(f.z,Kwe(f.v))):(f.t="n",f.v=Kwe(f.v),f.w=Owe(f.z,f.v))):f.t="s";else f=t[d][h];if(i)o[m]||(o[m]=[]),o[m][p]&&o[m][p].z&&(f.z=o[m][p].z),o[m][p]=f;else{var g=KSe({c:p,r:m});o[g]&&o[g].z&&(f.z=o[g].z),o[g]=f}}}return c.s.c<1e7&&(o["!ref"]=XSe(c)),o}function nCe(e,t){return tCe(null,e,t)}function rCe(e,t){return t||(t=jSe(4)),t.write_shift(4,e),t}function iCe(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function oCe(e,t){var n=!1;return null==t&&(n=!0,t=jSe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function aCe(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function sCe(e,t){var n=e.l,r=e.read_shift(1),i=iCe(e),o=[],a={t:i,h:i};if(0!==(1&r)){for(var s=e.read_shift(4),l=0;l!=s;++l)o.push(aCe(e));a.r=o}else a.r=[{ich:0,ifnt:0}];return e.l=n+t,a}var lCe=sCe;function cCe(e,t){var n=!1;return null==t&&(n=!0,t=jSe(23+4*e.t.length)),t.write_shift(1,1),oCe(e.t,t),t.write_shift(4,1),function(e,t){t||(t=jSe(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},t),n?t.slice(0,t.l):t}function uCe(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function dCe(e,t){return null==t&&(t=jSe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function hCe(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function fCe(e,t){return null==t&&(t=jSe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var mCe=iCe,pCe=oCe;function gCe(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function vCe(e,t){var n=!1;return null==t&&(n=!0,t=jSe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var yCe=iCe,bCe=gCe,wCe=vCe;function xCe(e){var t=e.slice(e.l,e.l+4),n=1&t[0],r=2&t[0];e.l+=4;var i=0===r?bSe([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):TSe(t,0)>>2;return n?i/100:i}function SCe(e,t){null==t&&(t=jSe(4));var n=0,r=0,i=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?r=1:i==(0|i)&&i>=-(1<<29)&&i<1<<29&&(r=1,n=1),!r)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((n?i:e)<<2)+(n+2))}function CCe(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var ECe=CCe,NCe=function(e,t){return t||(t=jSe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function TCe(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ACe(e,t){return(t||jSe(8)).write_shift(8,e,"f")}function RCe(e,t){if(t||(t=jSe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),e.rgb&&null==e.theme){var r=e.rgb||"FFFFFF";"number"==typeof r&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}var kCe=80,MCe={1:{n:"CodePage",t:2},2:{n:"Category",t:kCe},3:{n:"PresentationFormat",t:kCe},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:kCe},15:{n:"Company",t:kCe},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:kCe},27:{n:"ContentStatus",t:kCe},28:{n:"Language",t:kCe},29:{n:"Version",t:kCe},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},DCe={1:{n:"CodePage",t:2},2:{n:"Title",t:kCe},3:{n:"Subject",t:kCe},4:{n:"Author",t:kCe},5:{n:"Keywords",t:kCe},6:{n:"Comments",t:kCe},7:{n:"Template",t:kCe},8:{n:"LastAuthor",t:kCe},9:{n:"RevNumber",t:kCe},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:kCe},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}};function _Ce(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var OCe=ixe(_Ce([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),ICe={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},PCe={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},jCe={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function FCe(e,t){var n,r=function(e){for(var t=[],n=Vwe(e),r=0;r!==n.length;++r)null==t[e[n[r]]]&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}(PCe),i=[];i[i.length]=dxe,i[i.length]=Dxe("Types",null,{xmlns:jxe,"xmlns:xsd":qxe,"xmlns:xsi":Uxe}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(e){return Dxe("Default",null,{Extension:e[0],ContentType:e[1]})}));var o=function(r){e[r]&&e[r].length>0&&(n=e[r][0],i[i.length]=Dxe("Override",null,{PartName:("/"==n[0]?"":"/")+n,ContentType:jCe[r][t.bookType]||jCe[r].xlsx}))},a=function(n){(e[n]||[]).forEach(function(e){i[i.length]=Dxe("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:jCe[n][t.bookType]||jCe[n].xlsx})})},s=function(t){(e[t]||[]).forEach(function(e){i[i.length]=Dxe("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:r[t][0]})})};return o("workbooks"),a("sheets"),a("charts"),s("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(s),s("vba"),s("comments"),s("threadedcomments"),s("drawings"),a("metadata"),s("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var HCe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function LCe(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function BCe(e){var t=[dxe,Dxe("Relationships",null,{xmlns:Fxe})];return Vwe(e["!id"]).forEach(function(n){t[t.length]=Dxe("Relationship",null,e["!id"][n])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function zCe(e,t,n,r,i,o){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=r,i.Target=n,o?i.TargetMode=o:[HCe.HLINK,HCe.XPATH,HCe.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function WCe(e,t,n){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function VCe(e,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}function UCe(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+xbe.version+"</meta:generator></office:meta></office:document-meta>"}var qCe=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function GCe(e,t,n,r,i){null==i[e]&&null!=t&&""!==t&&(i[e]=t,t=gxe(t),r[r.length]=n?Dxe(e,t,n):kxe(e,t))}function YCe(e,t){var n=t||{},r=[dxe,Dxe("cp:coreProperties",null,{"xmlns:cp":Oxe,"xmlns:dc":Lxe,"xmlns:dcterms":Bxe,"xmlns:dcmitype":zxe,"xmlns:xsi":Uxe})],i={};if(!e&&!n.Props)return r.join("");e&&(null!=e.CreatedDate&&GCe("dcterms:created","string"===typeof e.CreatedDate?e.CreatedDate:_xe(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),null!=e.ModifiedDate&&GCe("dcterms:modified","string"===typeof e.ModifiedDate?e.ModifiedDate:_xe(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var o=0;o!=qCe.length;++o){var a=qCe[o],s=n.Props&&null!=n.Props[a[1]]?n.Props[a[1]]:e?e[a[1]]:null;!0===s?s="1":!1===s?s="0":"number"==typeof s&&(s=String(s)),null!=s&&GCe(a[0],s,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var KCe=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],$Ce=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function XCe(e){var t=[],n=Dxe;return e||(e={}),e.Application="SheetJS",t[t.length]=dxe,t[t.length]=Dxe("Properties",null,{xmlns:Pxe,"xmlns:vt":Vxe}),KCe.forEach(function(r){if(void 0!==e[r[1]]){var i;switch(r[2]){case"string":i=gxe(String(e[r[1]]));break;case"bool":i=e[r[1]]?"true":"false"}void 0!==i&&(t[t.length]=n(r[0],i))}}),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(e){return"<vt:lpstr>"+gxe(e)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function QCe(e){var t=[dxe,Dxe("Properties",null,{xmlns:Ixe,"xmlns:vt":Vxe})];if(!e)return t.join("");var n=1;return Vwe(e).forEach(function(r){++n,t[t.length]=Dxe("property",function(e,t){switch(typeof e){case"string":var n=Dxe("vt:lpwstr",gxe(e));return t&&(n=n.replace(/&quot;/g,"_x0022_")),n;case"number":return Dxe((0|e)==e?"vt:i4":"vt:r8",gxe(String(e)));case"boolean":return Dxe("vt:bool",e?"true":"false")}if(e instanceof Date)return Dxe("vt:filetime",_xe(e));throw new Error("Unable to serialize "+e)}(e[r],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:gxe(r)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var JCe={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function ZCe(e,t){var n=jSe(4),r=jSe(4);switch(n.write_shift(4,80==e?31:e),e){case 3:r.write_shift(-4,t);break;case 5:(r=jSe(8)).write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,n=t%Math.pow(2,32),r=(t-n)/Math.pow(2,32);r*=1e7;var i=(n*=1e7)/Math.pow(2,32)|0;i>0&&(n%=Math.pow(2,32),r+=i);var o=jSe(8);return o.write_shift(4,n),o.write_shift(4,r),o}(t);break;case 31:case 80:for((r=jSe(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Vbe([n,r])}var eEe=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function tEe(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function nEe(e,t,n){var r=jSe(8),i=[],o=[],a=8,s=0,l=jSe(8),c=jSe(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),o.push(l),i.push(c),a+=8+l.length,!t){(c=jSe(8)).write_shift(4,0),i.unshift(c);var u=[jSe(4)];for(u[0].write_shift(4,e.length),s=0;s<e.length;++s){var d=e[s][0];for((l=jSe(8+2*(d.length+1)+(d.length%2?0:2))).write_shift(4,s+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Vbe(u),o.unshift(l),a+=8+l.length}for(s=0;s<e.length;++s)if((!t||t[e[s][0]])&&!(eEe.indexOf(e[s][0])>-1||$Ce.indexOf(e[s][0])>-1)&&null!=e[s][1]){var h=e[s][1],f=0;if(t){var m=n[f=+t[e[s][0]]];if("version"==m.p&&"string"==typeof h){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}l=ZCe(m.t,h)}else{var g=tEe(h);-1==g&&(g=31,h=String(h)),l=ZCe(g,h)}o.push(l),(c=jSe(8)).write_shift(4,t?f:2+s),i.push(c),a+=8+l.length}var v=8*(o.length+1);for(s=0;s<o.length;++s)i[s].write_shift(4,v),v+=o[s].length;return r.write_shift(4,a),r.write_shift(4,o.length),Vbe([r].concat(i).concat(o))}function rEe(e,t,n,r,i,o){var a=jSe(i?68:48),s=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Lwe.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,i?68:48);var l=nEe(e,n,r);if(s.push(l),i){var c=nEe(i,null,null);a.write_shift(16,o,"hex"),a.write_shift(4,68+l.length),s.push(c)}return Vbe(s)}function iEe(e,t){return 1===e.read_shift(t)}function oEe(e,t){return t||(t=jSe(2)),t.write_shift(2,+!!e),t}function aEe(e){return e.read_shift(2,"u")}function sEe(e,t){return t||(t=jSe(2)),t.write_shift(2,e),t}function lEe(e,t,n){return n||(n=jSe(2)),n.write_shift(1,"e"==t?+e:+!!e),n.write_shift(1,"e"==t?1:0),n}function cEe(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),i="sbcs-cont",o=Sbe;(n&&n.biff>=8&&(Sbe=1200),n&&8!=n.biff)?12==n.biff&&(i="wstr"):e.read_shift(1)&&(i="dbcs-cont");n.biff>=2&&n.biff<=5&&(i="cpstr");var a=r?e.read_shift(r,i):"";return Sbe=o,a}function uEe(e){var t=e.t||"",n=jSe(3);n.write_shift(2,t.length),n.write_shift(1,1);var r=jSe(2*t.length);return r.write_shift(2*t.length,t,"utf16le"),Vbe([n,r])}function dEe(e,t,n){if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function hEe(e,t,n){var r=e.read_shift(n&&2==n.biff?1:2);return 0===r?(e.l++,""):dEe(e,r,n)}function fEe(e,t,n){if(n.biff>5)return hEe(e,0,n);var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function mEe(e,t,n){return n||(n=jSe(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function pEe(e,t){t||(t=jSe(6+2*e.length)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function gEe(e){var t=jSe(512),n=0,r=e.Target;"file://"==r.slice(0,7)&&(r=r.slice(7));var i=r.indexOf("#"),o=i>-1?31:23;switch(r.charAt(0)){case"#":o=28;break;case".":o&=-3}t.write_shift(4,2),t.write_shift(4,o);var a=[8,6815827,6619237,4849780,83];for(n=0;n<a.length;++n)t.write_shift(4,a[n]);if(28==o)pEe(r=r.slice(1),t);else if(2&o){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<a.length;++n)t.write_shift(1,parseInt(a[n],16));var s=i>-1?r.slice(0,i):r;for(t.write_shift(4,2*(s.length+1)),n=0;n<s.length;++n)t.write_shift(2,s.charCodeAt(n));t.write_shift(2,0),8&o&&pEe(i>-1?r.slice(i+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<a.length;++n)t.write_shift(1,parseInt(a[n],16));for(var l=0;"../"==r.slice(3*l,3*l+3)||"..\\"==r.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,r.length-3*l+1),n=0;n<r.length-3*l;++n)t.write_shift(1,255&r.charCodeAt(n+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function vEe(e,t,n,r){return r||(r=jSe(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function yEe(e,t,n){var r=n.biff>8?4:2;return[e.read_shift(r),e.read_shift(r,"i"),e.read_shift(r,"i")]}function bEe(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:n}}}function wEe(e,t){return t||(t=jSe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function xEe(e,t,n){var r=1536,i=16;switch(n.bookType){case"biff8":case"xla":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;default:throw new Error("unsupported BIFF version")}var o=jSe(i);return o.write_shift(2,r),o.write_shift(2,t),i>4&&o.write_shift(2,29282),i>6&&o.write_shift(2,1997),i>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function SEe(e,t){var n=!t||t.biff>=8?2:1,r=jSe(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function CEe(e,t,n,r){var i=n&&5==n.biff;r||(r=jSe(i?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(i?1:2,t.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var o=r.length>r.l?r.slice(0,r.l):r;return null==o.l&&(o.l=o.length),o}function EEe(e,t,n,r){var i=n&&5==n.biff;r||(r=jSe(i?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var o=0;return e.numFmtId>0&&i&&(o|=1024),r.write_shift(4,o),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function NEe(e,t,n){if(n.biff<8)return function(e,t,n){3==e[e.l+1]&&e[e.l]++;var r=cEe(e,0,n);return 3==r.charCodeAt(0)?r.slice(1):r}(e,0,n);for(var r=[],i=e.l+t,o=e.read_shift(n.biff>8?4:2);0!==o--;)r.push(yEe(e,n.biff,n));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return r}function TEe(e){var t=jSe(24),n=YSe(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(r[i],16));return Vbe([t,gEe(e[1])])}function AEe(e){var t=e[1].Tooltip,n=jSe(10+2*(t.length+1));n.write_shift(2,2048);var r=YSe(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var i=0;i<t.length;++i)n.write_shift(2,t.charCodeAt(i));return n.write_shift(2,0),n}function REe(e,t,n){if(!n.cellStyles)return PSe(e,t);var r=n&&n.biff>=12?4:2,i=e.read_shift(r),o=e.read_shift(r),a=e.read_shift(r),s=e.read_shift(r),l=e.read_shift(2);2==r&&(e.l+=2);var c={s:i,e:o,w:a,ixfe:s,flags:l};return(n.biff>=5||!n.biff)&&(c.level=l>>8&7),c}var kEe=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=qwe({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(t,n){var r=n||{};r.dateNF||(r.dateNF="yyyymmdd");var i=nCe(function(t,n){var r=[],i=Hbe(1);switch(n.type){case"base64":i=Bbe(Pbe(t));break;case"binary":i=Bbe(t);break;case"buffer":case"array":i=t}ISe(i,0);var o=i.read_shift(1),a=!!(136&o),s=!1,l=!1;switch(o){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:s=!0,a=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+o.toString(16))}var c=0,u=521;2==o&&(c=i.read_shift(2)),i.l+=3,2!=o&&(c=i.read_shift(4)),c>1048576&&(c=1e6),2!=o&&(u=i.read_shift(2));var d=i.read_shift(2),h=n.codepage||1252;2!=o&&(i.l+=16,i.read_shift(1),0!==i[i.l]&&(h=e[i[i.l]]),i.l+=1,i.l+=2),l&&(i.l+=36);for(var f=[],m={},p=Math.min(i.length,2==o?521:u-10-(s?264:0)),g=l?32:11;i.l<p&&13!=i[i.l];)switch((m={}).name=Mbe.utils.decode(h,i.slice(i.l,i.l+g)).replace(/[\u0000\r\n].*$/g,""),i.l+=g,m.type=String.fromCharCode(i.read_shift(1)),2==o||l||(m.offset=i.read_shift(4)),m.len=i.read_shift(1),2==o&&(m.offset=i.read_shift(2)),m.dec=i.read_shift(1),m.name.length&&f.push(m),2!=o&&(i.l+=l?13:14),m.type){case"B":s&&8==m.len||!n.WTF||console.log("Skipping "+m.name+":"+m.type);break;case"G":case"P":n.WTF&&console.log("Skipping "+m.name+":"+m.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+m.type)}if(13!==i[i.l]&&(i.l=u-1),13!==i.read_shift(1))throw new Error("DBF Terminator not found "+i.l+" "+i[i.l]);i.l=u;var v=0,y=0;for(r[0]=[],y=0;y!=f.length;++y)r[0][y]=f[y].name;for(;c-- >0;)if(42!==i[i.l])for(++i.l,r[++v]=[],y=0,y=0;y!=f.length;++y){var b=i.slice(i.l,i.l+f[y].len);i.l+=f[y].len,ISe(b,0);var w=Mbe.utils.decode(h,b);switch(f[y].type){case"C":w.trim().length&&(r[v][y]=w.replace(/\s+$/,""));break;case"D":8===w.length?r[v][y]=new Date(+w.slice(0,4),+w.slice(4,6)-1,+w.slice(6,8)):r[v][y]=w;break;case"F":r[v][y]=parseFloat(w.trim());break;case"+":case"I":r[v][y]=l?2147483648^b.read_shift(-4,"i"):b.read_shift(4,"i");break;case"L":switch(w.trim().toUpperCase()){case"Y":case"T":r[v][y]=!0;break;case"N":case"F":r[v][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+w+"|")}break;case"M":if(!a)throw new Error("DBF Unexpected MEMO for type "+o.toString(16));r[v][y]="##MEMO##"+(l?parseInt(w.trim(),10):b.read_shift(4));break;case"N":(w=w.replace(/\u0000/g,"").trim())&&"."!=w&&(r[v][y]=+w||0);break;case"@":r[v][y]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":r[v][y]=new Date(864e5*(b.read_shift(4)-2440588)+b.read_shift(4));break;case"Y":r[v][y]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":r[v][y]=-b.read_shift(-8,"f");break;case"B":if(s&&8==f[y].len){r[v][y]=b.read_shift(8,"f");break}case"G":case"P":b.l+=f[y].len;break;case"0":if("_NullFlags"===f[y].name)break;default:throw new Error("DBF Unsupported data type "+f[y].type)}}else i.l+=d;if(2!=o&&i.l<i.length&&26!=i[i.l++])throw new Error("DBF EOF Marker missing "+(i.l-1)+" of "+i.length+" "+i[i.l-1].toString(16));return n&&n.sheetRows&&(r=r.slice(0,n.sheetRows)),n.DBF=f,r}(t,r),r);return i["!cols"]=r.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete r.DBF,i}var r={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return eCe(n(e,t),t)}catch(qb){if(t&&t.WTF)throw qb}return{SheetNames:[],Sheets:{}}},to_sheet:n,from_sheet:function(e,n){var i=n||{};if(+i.codepage>=0&&Abe(+i.codepage),"string"==i.type)throw new Error("Cannot write DBF to JS string");var o=FSe(),a=XAe(e,{header:1,raw:!0,cellDates:!0}),s=a[0],l=a.slice(1),c=e["!cols"]||[],u=0,d=0,h=0,f=1;for(u=0;u<s.length;++u)if(((c[u]||{}).DBF||{}).name)s[u]=c[u].DBF.name,++h;else if(null!=s[u]){if(++h,"number"===typeof s[u]&&(s[u]=s[u].toString(10)),"string"!==typeof s[u])throw new Error("DBF Invalid column name "+s[u]+" |"+typeof s[u]+"|");if(s.indexOf(s[u])!==u)for(d=0;d<1024;++d)if(-1==s.indexOf(s[u]+"_"+d)){s[u]+="_"+d;break}}var m=QSe(e["!ref"]),p=[],g=[],v=[];for(u=0;u<=m.e.c-m.s.c;++u){var y="",b="",w=0,x=[];for(d=0;d<l.length;++d)null!=l[d][u]&&x.push(l[d][u]);if(0!=x.length&&null!=s[u]){for(d=0;d<x.length;++d){switch(typeof x[d]){case"number":b="B";break;case"string":default:b="C";break;case"boolean":b="L";break;case"object":b=x[d]instanceof Date?"D":"C"}w=Math.max(w,String(x[d]).length),y=y&&y!=b?"C":b}w>250&&(w=250),"C"==(b=((c[u]||{}).DBF||{}).type)&&c[u].DBF.len>w&&(w=c[u].DBF.len),"B"==y&&"N"==b&&(y="N",v[u]=c[u].DBF.dec,w=c[u].DBF.len),g[u]="C"==y||"N"==b?w:r[y]||0,f+=g[u],p[u]=y}else p[u]="?"}var S=o.next(32);for(S.write_shift(4,318902576),S.write_shift(4,l.length),S.write_shift(2,296+32*h),S.write_shift(2,f),u=0;u<4;++u)S.write_shift(4,0);for(S.write_shift(4,(+t[Cbe]||3)<<8),u=0,d=0;u<s.length;++u)if(null!=s[u]){var C=o.next(32),E=(s[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C.write_shift(1,E,"sbcs"),C.write_shift(1,"?"==p[u]?"C":p[u],"sbcs"),C.write_shift(4,d),C.write_shift(1,g[u]||r[p[u]]||0),C.write_shift(1,v[u]||0),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(1,0),C.write_shift(4,0),C.write_shift(4,0),d+=g[u]||r[p[u]]||0}var N=o.next(264);for(N.write_shift(4,13),u=0;u<65;++u)N.write_shift(4,0);for(u=0;u<l.length;++u){var T=o.next(f);for(T.write_shift(1,0),d=0;d<s.length;++d)if(null!=s[d])switch(p[d]){case"L":T.write_shift(1,null==l[u][d]?63:l[u][d]?84:70);break;case"B":T.write_shift(8,l[u][d]||0,"f");break;case"N":var A="0";for("number"==typeof l[u][d]&&(A=l[u][d].toFixed(v[d]||0)),h=0;h<g[d]-A.length;++h)T.write_shift(1,32);T.write_shift(1,A,"sbcs");break;case"D":l[u][d]?(T.write_shift(4,("0000"+l[u][d].getFullYear()).slice(-4),"sbcs"),T.write_shift(2,("00"+(l[u][d].getMonth()+1)).slice(-2),"sbcs"),T.write_shift(2,("00"+l[u][d].getDate()).slice(-2),"sbcs")):T.write_shift(8,"00000000","sbcs");break;case"C":var R=String(null!=l[u][d]?l[u][d]:"").slice(0,g[d]);for(T.write_shift(1,R,"sbcs"),h=0;h<g[d]-R.length;++h)T.write_shift(1,32)}}return o.next(1).write_shift(1,26),o.end()}}}(),MEe=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+Vwe(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(t,n){var r=e[n];return"number"==typeof r?_be(r):r},r=function(e,t,n){var r=t.charCodeAt(0)-32<<4|n.charCodeAt(0)-48;return 59==r?e:_be(r)};function i(e,i){var o,a=e.split(/[\n\r]+/),s=-1,l=-1,c=0,u=0,d=[],h=[],f=null,m={},p=[],g=[],v=[],y=0;for(+i.codepage>=0&&Abe(+i.codepage);c!==a.length;++c){y=0;var b,w=a[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),x=w.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),S=x[0];if(w.length>0)switch(S){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==x[1].charAt(0)&&h.push(w.slice(3).replace(/;;/g,";"));break;case"C":var C=!1,E=!1,N=!1,T=!1,A=-1,R=-1;for(u=1;u<x.length;++u)switch(x[u].charAt(0)){case"A":case"G":break;case"X":l=parseInt(x[u].slice(1))-1,E=!0;break;case"Y":for(s=parseInt(x[u].slice(1))-1,E||(l=0),o=d.length;o<=s;++o)d[o]=[];break;case"K":'"'===(b=x[u].slice(1)).charAt(0)?b=b.slice(1,b.length-1):"TRUE"===b?b=!0:"FALSE"===b?b=!1:isNaN(axe(b))?isNaN(lxe(b).getDate())||(b=nxe(b)):(b=axe(b),null!==f&&kwe(f)&&(b=Jwe(b))),"undefined"!==typeof Mbe&&"string"==typeof b&&"string"!=(i||{}).type&&(i||{}).codepage&&(b=Mbe.utils.decode(i.codepage,b)),C=!0;break;case"E":T=!0;var k=xNe(x[u].slice(1),{r:s,c:l});d[s][l]=[d[s][l],k];break;case"S":N=!0,d[s][l]=[d[s][l],"S5S"];break;case"R":A=parseInt(x[u].slice(1))-1;break;case"C":R=parseInt(x[u].slice(1))-1;break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+w)}if(C&&(d[s][l]&&2==d[s][l].length?d[s][l][0]=b:d[s][l]=b,f=null),N){if(T)throw new Error("SYLK shared formula cannot have own formula");var M=A>-1&&d[A][R];if(!M||!M[1])throw new Error("SYLK shared formula cannot find base");d[s][l][1]=ENe(M[1],{r:s-A,c:l-R})}break;case"F":var D=0;for(u=1;u<x.length;++u)switch(x[u].charAt(0)){case"X":l=parseInt(x[u].slice(1))-1,++D;break;case"Y":for(s=parseInt(x[u].slice(1))-1,o=d.length;o<=s;++o)d[o]=[];break;case"M":y=parseInt(x[u].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=h[parseInt(x[u].slice(1))];break;case"W":for(v=x[u].slice(1).split(" "),o=parseInt(v[0],10);o<=parseInt(v[1],10);++o)y=parseInt(v[2],10),g[o-1]=0===y?{hidden:!0}:{wch:y},YEe(g[o-1]);break;case"C":g[l=parseInt(x[u].slice(1))-1]||(g[l]={});break;case"R":p[s=parseInt(x[u].slice(1))-1]||(p[s]={}),y>0?(p[s].hpt=y,p[s].hpx=XEe(y)):0===y&&(p[s].hidden=!0);break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+w)}D<1&&(f=null);break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+w)}}return p.length>0&&(m["!rows"]=p),g.length>0&&(m["!cols"]=g),i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),[d,m]}function o(e,t){var n=function(e,t){switch(t.type){case"base64":return i(Pbe(e),t);case"binary":return i(e,t);case"buffer":return i(jbe&&Buffer.isBuffer(e)?e.toString("binary"):Wbe(e),t);case"array":return i(rxe(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),r=n[0],o=n[1],a=nCe(r,t);return Vwe(o).forEach(function(e){a[e]=o[e]}),a}function a(e,t,n,r){var i="C;Y"+(n+1)+";X"+(r+1)+";K";switch(e.t){case"n":i+=e.v||0,e.f&&!e.F&&(i+=";E"+CNe(e.f,{r:n,c:r}));break;case"b":i+=e.v?"TRUE":"FALSE";break;case"e":i+=e.w||e.v;break;case"d":i+='"'+(e.w||e.v)+'"';break;case"s":i+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return i}return e["|"]=254,{to_workbook:function(e,t){return eCe(o(e,t),t)},to_sheet:o,from_sheet:function(e,t){var n,r,i=["ID;PWXL;N;E"],o=[],s=QSe(e["!ref"]),l=Array.isArray(e),c="\r\n";i.push("P;PGeneral"),i.push("F;P0;DG0G8;M255"),e["!cols"]&&(r=i,e["!cols"].forEach(function(e,t){var n="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?n+="0":("number"!=typeof e.width||e.wpx||(e.wpx=UEe(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=qEe(e.wpx)),"number"==typeof e.wch&&(n+=Math.round(e.wch)))," "!=n.charAt(n.length-1)&&r.push(n)})),e["!rows"]&&function(e,t){t.forEach(function(t,n){var r="F;";t.hidden?r+="M0;":t.hpt?r+="M"+20*t.hpt+";":t.hpx&&(r+="M"+20*$Ee(t.hpx)+";"),r.length>2&&e.push(r+"R"+(n+1))})}(i,e["!rows"]),i.push("B;Y"+(s.e.r-s.s.r+1)+";X"+(s.e.c-s.s.c+1)+";D"+[s.s.c,s.s.r,s.e.c,s.e.r].join(" "));for(var u=s.s.r;u<=s.e.r;++u)for(var d=s.s.c;d<=s.e.c;++d){var h=KSe({r:u,c:d});(n=l?(e[u]||[])[d]:e[h])&&(null!=n.v||n.f&&!n.F)&&o.push(a(n,0,u,d))}return i.join(c)+c+o.join(c)+c+"E"+c}}}(),DEe=function(){function e(e,t){for(var n=e.split("\n"),r=-1,i=-1,o=0,a=[];o!==n.length;++o)if("BOT"!==n[o].trim()){if(!(r<0)){for(var s=n[o].trim().split(","),l=s[0],c=s[1],u=n[++o]||"";1&(u.match(/["]/g)||[]).length&&o<n.length-1;)u+="\n"+n[++o];switch(u=u.trim(),+l){case-1:if("BOT"===u){a[++r]=[],i=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?a[r][i]=!0:"FALSE"===u?a[r][i]=!1:isNaN(axe(c))?isNaN(lxe(c).getDate())?a[r][i]=c:a[r][i]=nxe(c):a[r][i]=axe(c),++i;break;case 1:(u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'))&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),a[r][i++]=""!==u?u:null}if("EOD"===u)break}}else a[++r]=[],i=0;return t&&t.sheetRows&&(a=a.slice(0,t.sheetRows)),a}function t(t,n){return nCe(function(t,n){switch(n.type){case"base64":return e(Pbe(t),n);case"binary":return e(t,n);case"buffer":return e(jbe&&Buffer.isBuffer(t)?t.toString("binary"):Wbe(t),n);case"array":return e(rxe(t),n)}throw new Error("Unrecognized type "+n.type)}(t,n),n)}var n=function(){var e=function(e,t,n,r,i){e.push(t),e.push(n+","+r),e.push('"'+i.replace(/"/g,'""')+'"')},t=function(e,t,n,r){e.push(t+","+n),e.push(1==t?'"'+r.replace(/"/g,'""')+'"':r)};return function(n){var r,i=[],o=QSe(n["!ref"]),a=Array.isArray(n);e(i,"TABLE",0,1,"sheetjs"),e(i,"VECTORS",0,o.e.r-o.s.r+1,""),e(i,"TUPLES",0,o.e.c-o.s.c+1,""),e(i,"DATA",0,0,"");for(var s=o.s.r;s<=o.e.r;++s){t(i,-1,0,"BOT");for(var l=o.s.c;l<=o.e.c;++l){var c=KSe({r:s,c:l});if(r=a?(n[s]||[])[l]:n[c])switch(r.t){case"n":var u=r.w;u||null==r.v||(u=r.v),null==u?r.f&&!r.F?t(i,1,0,"="+r.f):t(i,1,0,""):t(i,0,u,"V");break;case"b":t(i,0,r.v?1:0,r.v?"TRUE":"FALSE");break;case"s":t(i,1,0,isNaN(r.v)?r.v:'="'+r.v+'"');break;case"d":r.w||(r.w=Owe(r.z||twe[14],Kwe(nxe(r.v)))),t(i,0,r.w,"V");break;default:t(i,1,0,"")}else t(i,1,0,"")}}t(i,-1,0,"EOD");return i.join("\r\n")}}();return{to_workbook:function(e,n){return eCe(t(e,n),n)},to_sheet:t,from_sheet:n}}(),_Ee=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(t,n){return nCe(function(t,n){for(var r=t.split("\n"),i=-1,o=-1,a=0,s=[];a!==r.length;++a){var l=r[a].trim().split(":");if("cell"===l[0]){var c=YSe(l[1]);if(s.length<=c.r)for(i=s.length;i<=c.r;++i)s[i]||(s[i]=[]);switch(i=c.r,o=c.c,l[2]){case"t":s[i][o]=e(l[3]);break;case"v":s[i][o]=+l[3];break;case"vtf":var u=l[l.length-1];case"vtc":"nl"===l[3]?s[i][o]=!!+l[4]:s[i][o]=+l[4],"vtf"==l[2]&&(s[i][o]=[s[i][o],u])}}}return n&&n.sheetRows&&(s=s.slice(0,n.sheetRows)),s}(t,n),n)}var r=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),a="--SocialCalcSpreadsheetControlSave--";function s(e){if(!e||!e["!ref"])return"";for(var n,r=[],i=[],o="",a=$Se(e["!ref"]),s=Array.isArray(e),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c)if(o=KSe({r:l,c:c}),(n=s?(e[l]||[])[c]:e[o])&&null!=n.v&&"z"!==n.t){switch(i=["cell",o,"t"],n.t){case"s":case"str":i.push(t(n.v));break;case"n":n.f?(i[2]="vtf",i[3]="n",i[4]=n.v,i[5]=t(n.f)):(i[2]="v",i[3]=n.v);break;case"b":i[2]="vt"+(n.f?"f":"c"),i[3]="nl",i[4]=n.v?"1":"0",i[5]=t(n.f||(n.v?"TRUE":"FALSE"));break;case"d":var u=Kwe(nxe(n.v));i[2]="vtc",i[3]="nd",i[4]=""+u,i[5]=n.w||Owe(n.z||twe[14],u);break;case"e":continue}r.push(i.join(":"))}return r.push("sheet:c:"+(a.e.c-a.s.c+1)+":r:"+(a.e.r-a.s.r+1)+":tvf:1"),r.push("valueformat:1:text-wiki"),r.join("\n")}return{to_workbook:function(e,t){return eCe(n(e,t),t)},to_sheet:n,from_sheet:function(e){return[r,i,o,i,s(e),a].join("\n")}}}(),OEe=function(){function e(e,t,n,r,i){i.raw?t[n][r]=e:""===e||("TRUE"===e?t[n][r]=!0:"FALSE"===e?t[n][r]=!1:isNaN(axe(e))?isNaN(lxe(e).getDate())?t[n][r]=e:t[n][r]=nxe(e):t[n][r]=axe(e))}var t={44:",",9:"\t",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function r(e){for(var r={},i=!1,o=0,a=0;o<e.length;++o)34==(a=e.charCodeAt(o))?i=!i:!i&&a in t&&(r[a]=(r[a]||0)+1);for(o in a=[],r)Object.prototype.hasOwnProperty.call(r,o)&&a.push([r[o],o]);if(!a.length)for(o in r=n)Object.prototype.hasOwnProperty.call(r,o)&&a.push([r[o],o]);return a.sort(function(e,t){return e[0]-t[0]||n[e[1]]-n[t[1]]}),t[a.pop()[1]]||44}function i(e,t){var n=t||{},i="";var o=n.dense?[]:{},a={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(i=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(i=e.charAt(4),e=e.slice(6)):i=r(e.slice(0,1024)):i=n&&n.FS?n.FS:r(e.slice(0,1024));var s=0,l=0,c=0,u=0,d=0,h=i.charCodeAt(0),f=!1,m=0,p=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var g=null!=n.dateNF?function(e){var t="number"==typeof e?twe[e]:e;return t=t.replace(Fwe,"(\\d+)"),new RegExp("^"+t+"$")}(n.dateNF):null;function v(){var t=e.slice(u,d),r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)r.t="z";else if(n.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(r.t="n",r.f=t.slice(1)):(r.t="s",r.v=t);else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(c=axe(t)))if(!isNaN(lxe(t).getDate())||g&&t.match(g)){r.z=n.dateNF||twe[14];var i=0;g&&t.match(g)&&(t=function(e,t,n){var r=-1,i=-1,o=-1,a=-1,s=-1,l=-1;(t.match(Fwe)||[]).forEach(function(e,t){var c=parseInt(n[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":r=c;break;case"d":o=c;break;case"h":a=c;break;case"s":l=c;break;case"m":a>=0?s=c:i=c}}),l>=0&&-1==s&&i>=0&&(s=i,i=-1);var c=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==a&&-1==s&&-1==l?c:-1==r&&-1==i&&-1==o?u:c+"T"+u}(0,n.dateNF,t.match(g)||[]),i=1),n.cellDates?(r.t="d",r.v=nxe(t,i)):(r.t="n",r.v=Kwe(nxe(t,i))),!1!==n.cellText&&(r.w=Owe(r.z,r.v instanceof Date?Kwe(r.v):r.v)),n.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",!1!==n.cellText&&(r.w=t),r.v=c;if("z"==r.t||(n.dense?(o[s]||(o[s]=[]),o[s][l]=r):o[KSe({c:l,r:s})]=r),u=d+1,p=e.charCodeAt(u),a.e.c<l&&(a.e.c=l),a.e.r<s&&(a.e.r=s),m==h)++l;else if(l=0,++s,n.sheetRows&&n.sheetRows<=s)return!0}e:for(;d<e.length;++d)switch(m=e.charCodeAt(d)){case 34:34===p&&(f=!f);break;case h:case 10:case 13:if(!f&&v())break e}return d-u>0&&v(),o["!ref"]=XSe(a),o}function o(t,n){return n&&n.PRN?n.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?i(t,n):nCe(function(t,n){var r=n||{},i=[];if(!t||0===t.length)return i;for(var o=t.split(/[\r\n]/),a=o.length-1;a>=0&&0===o[a].length;)--a;for(var s=10,l=0,c=0;c<=a;++c)-1==(l=o[c].indexOf(" "))?l=o[c].length:l++,s=Math.max(s,l);for(c=0;c<=a;++c){i[c]=[];var u=0;for(e(o[c].slice(0,s).trim(),i,c,u,r),u=1;u<=(o[c].length-s)/10+1;++u)e(o[c].slice(s+10*(u-1),s+10*u).trim(),i,c,u,r)}return r.sheetRows&&(i=i.slice(0,r.sheetRows)),i}(t,n),n):i(t,n)}function a(e,t){var n="",r="string"==t.type?[0,0,0,0]:WAe(e,t);switch(t.type){case"base64":n=Pbe(e);break;case"binary":case"string":n=e;break;case"buffer":n=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof Mbe?Mbe.utils.decode(t.codepage,e):jbe&&Buffer.isBuffer(e)?e.toString("binary"):Wbe(e);break;case"array":n=rxe(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]?n=Nxe(n.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?n=Nxe(n):"binary"==t.type&&"undefined"!==typeof Mbe&&t.codepage&&(n=Mbe.utils.decode(t.codepage,Mbe.utils.encode(28591,n))),"socialcalc:version:"==n.slice(0,19)?_Ee.to_sheet("string"==t.type?n:Nxe(n),t):o(n,t)}return{to_workbook:function(e,t){return eCe(a(e,t),t)},to_sheet:a,from_sheet:function(e){for(var t,n=[],r=QSe(e["!ref"]),i=Array.isArray(e),o=r.s.r;o<=r.e.r;++o){for(var a=[],s=r.s.c;s<=r.e.c;++s){var l=KSe({r:o,c:s});if((t=i?(e[o]||[])[s]:e[l])&&null!=t.v){for(var c=(t.w||(ZSe(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";a.push(c+(0===s?" ":""))}else a.push("          ")}n.push(a.join(""))}return n.join("\n")}}}();var IEe=function(){function e(e,t,n){if(e){ISe(e,e.l||0);for(var r=n.Enum||v;e.l<e.length;){var i=e.read_shift(2),o=r[i]||r[65535],a=e.read_shift(2),s=e.l+a,l=o.f&&o.f(e,a,n);if(e.l=s,t(l,o,i))return}}}function t(t,n){if(!t)return t;var r=n||{};var i=r.dense?[]:{},o="Sheet1",a="",s=0,l={},c=[],u=[],d={s:{r:0,c:0},e:{r:0,c:0}},h=r.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])r.Enum=v,e(t,function(e,t,n){switch(n){case 0:r.vers=e,e>=4096&&(r.qpro=!0);break;case 6:d=e;break;case 204:e&&(a=e);break;case 222:a=e;break;case 15:case 51:r.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==n&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=r.dateNF||twe[14],r.cellDates&&(e[1].t="d",e[1].v=Jwe(e[1].v))),r.qpro&&e[3]>s&&(i["!ref"]=XSe(d),l[o]=i,c.push(o),i=r.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},s=e[3],o=a||"Sheet"+(s+1),a="");var u=r.dense?(i[e[0].r]||[])[e[0].c]:i[KSe(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f);break}r.dense?(i[e[0].r]||(i[e[0].r]=[]),i[e[0].r][e[0].c]=e[1]):i[KSe(e[0])]=e[1]}},r);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);r.Enum=y,14==t[2]&&(r.qpro=!0,t.l=0),e(t,function(e,t,n){switch(n){case 204:o=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>s&&(i["!ref"]=XSe(d),l[o]=i,c.push(o),i=r.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},s=e[3],o="Sheet"+(s+1)),h>0&&e[0].r>=h)break;r.dense?(i[e[0].r]||(i[e[0].r]=[]),i[e[0].r][e[0].c]=e[1]):i[KSe(e[0])]=e[1],d.e.c<e[0].c&&(d.e.c=e[0].c),d.e.r<e[0].r&&(d.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==s&&(o=e[1])}},r)}if(i["!ref"]=XSe(d),l[a||o]=i,c.push(a||o),!u.length)return{SheetNames:c,Sheets:l};for(var f={},m=[],p=0;p<u.length;++p)l[c[p]]?(m.push(u[p]||c[p]),f[u[p]]=l[u[p]]||l[c[p]]):(m.push(u[p]),f[u[p]]={"!ref":"A1"});return{SheetNames:m,Sheets:f}}function n(e,t,n){var r=[{c:0,r:0},{t:"n",v:0},0,0];return n.qpro&&20768!=n.vers?(r[0].c=e.read_shift(1),r[3]=e.read_shift(1),r[0].r=e.read_shift(2),e.l+=2):(r[2]=e.read_shift(1),r[0].c=e.read_shift(2),r[0].r=e.read_shift(2)),r}function r(e,t,r){var i=e.l+t,o=n(e,0,r);if(o[1].t="s",20768==r.vers){e.l++;var a=e.read_shift(1);return o[1].v=e.read_shift(a,"utf8"),o}return r.qpro&&e.l++,o[1].v=e.read_shift(i-e.l,"cstr"),o}function i(e,t,n){var r=jSe(7+n.length);r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(1,39);for(var i=0;i<r.length;++i){var o=n.charCodeAt(i);r.write_shift(1,o>=128?95:o)}return r.write_shift(1,0),r}function o(e,t,n){var r=jSe(7);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,n,"i"),r}function a(e,t,n){var r=jSe(13);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(8,n,"f"),r}function s(e,t,n){var r=32768&t;return t=(r?e:0)+((t&=-32769)>=8192?t-16384:t),(r?"":"$")+(n?GSe(t):USe(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function d(e,t,n,r){var i=jSe(6+r.length);i.write_shift(2,e),i.write_shift(1,n),i.write_shift(1,t),i.write_shift(1,39);for(var o=0;o<r.length;++o){var a=r.charCodeAt(o);i.write_shift(1,a>=128?95:a)}return i.write_shift(1,0),i}function h(e,t){var n=u(e),r=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(2);if(65535==o)return 0===r&&3221225472===i?(n[1].t="e",n[1].v=15):0===r&&3489660928===i?(n[1].t="e",n[1].v=42):n[1].v=0,n;var a=32768&o;return o=(32767&o)-16446,n[1].v=(1-2*a)*(i*Math.pow(2,o+32)+r*Math.pow(2,o)),n}function f(e,t,n,r){var i=jSe(14);if(i.write_shift(2,e),i.write_shift(1,n),i.write_shift(1,t),0==r)return i.write_shift(4,0),i.write_shift(4,0),i.write_shift(2,65535),i;var o,a=0,s=0,l=0;return r<0&&(a=1,r=-r),s=0|Math.log2(r),0==(2147483648&(l=(r/=Math.pow(2,s-31))>>>0))&&(++s,l=(r/=2)>>>0),r-=l,l|=2147483648,l>>>=0,o=(r*=Math.pow(2,32))>>>0,i.write_shift(4,o),i.write_shift(4,l),s+=16383+(a?32768:0),i.write_shift(2,s),i}function m(e,t){var n=u(e),r=e.read_shift(8,"f");return n[1].v=r,n}function p(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function g(e,t){var n=jSe(5+e.length);n.write_shift(2,14e3),n.write_shift(2,t);for(var r=0;r<e.length;++r){var i=e.charCodeAt(r);n[n.l++]=i>127?95:i}return n[n.l++]=0,n}var v={0:{n:"BOF",f:aEe},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,n){var r={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&n.qpro?(r.s.c=e.read_shift(1),e.l++,r.s.r=e.read_shift(2),r.e.c=e.read_shift(1),e.l++,r.e.r=e.read_shift(2),r):(r.s.c=e.read_shift(2),r.s.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),r.e.c=e.read_shift(2),r.e.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),65535==r.s.c&&(r.s.c=r.e.c=r.s.r=r.e.r=0),r)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,r){var i=n(e,0,r);return i[1].v=e.read_shift(2,"i"),i}},14:{n:"NUMBER",f:function(e,t,r){var i=n(e,0,r);return i[1].v=e.read_shift(8,"f"),i}},15:{n:"LABEL",f:r},16:{n:"FORMULA",f:function(e,t,r){var i=e.l+t,o=n(e,0,r);if(o[1].v=e.read_shift(8,"f"),r.qpro)e.l=i;else{var a=e.read_shift(2);!function(e,t){ISe(e,0);var n=[],r=0,i="",o="",a="",u="";for(;e.l<e.length;){var d=e[e.l++];switch(d){case 0:n.push(e.read_shift(8,"f"));break;case 1:o=s(t[0].c,e.read_shift(2),!0),i=s(t[0].r,e.read_shift(2),!1),n.push(o+i);break;case 2:var h=s(t[0].c,e.read_shift(2),!0),f=s(t[0].r,e.read_shift(2),!1);o=s(t[0].c,e.read_shift(2),!0),i=s(t[0].r,e.read_shift(2),!1),n.push(h+f+":"+o+i);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:n.push("("+n.pop()+")");break;case 5:n.push(e.read_shift(2));break;case 6:for(var m="";d=e[e.l++];)m+=String.fromCharCode(d);n.push('"'+m.replace(/"/g,'""')+'"');break;case 8:n.push("-"+n.pop());break;case 23:n.push("+"+n.pop());break;case 22:n.push("NOT("+n.pop()+")");break;case 20:case 21:u=n.pop(),a=n.pop(),n.push(["AND","OR"][d-20]+"("+a+","+u+")");break;default:if(d<32&&c[d])u=n.pop(),a=n.pop(),n.push(a+c[d]+u);else{if(!l[d])return d<=7?console.error("WK1 invalid opcode "+d.toString(16)):d<=24?console.error("WK1 unsupported op "+d.toString(16)):d<=30?console.error("WK1 invalid opcode "+d.toString(16)):d<=115?console.error("WK1 unsupported function opcode "+d.toString(16)):console.error("WK1 unrecognized opcode "+d.toString(16));if(69==(r=l[d][1])&&(r=e[e.l++]),r>n.length)return void console.error("WK1 bad formula parse 0x"+d.toString(16)+":|"+n.join("|")+"|");var p=n.slice(-r);n.length-=r,n.push(l[d][0]+"("+p.join(",")+")")}}}1==n.length?t[1].f=""+n[0]:console.error("WK1 bad formula parse |"+n.join("|")+"|")}(e.slice(e.l,e.l+a),o),e.l+=a}return o}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:r},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:p},222:{n:"SHEETNAMELP",f:function(e,t){var n=e[e.l++];n>t-1&&(n=t-1);for(var r="";r.length<n;)r+=String.fromCharCode(e[e.l++]);return r}},65535:{n:""}},y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var n=u(e);return n[1].t="s",n[1].v=e.read_shift(t-4,"cstr"),n}},23:{n:"NUMBER17",f:h},24:{n:"NUMBER18",f:function(e,t){var n=u(e);n[1].v=e.read_shift(2);var r=n[1].v>>1;if(1&n[1].v)switch(7&r){case 0:r=5e3*(r>>3);break;case 1:r=500*(r>>3);break;case 2:r=(r>>3)/20;break;case 3:r=(r>>3)/200;break;case 4:r=(r>>3)/2e3;break;case 5:r=(r>>3)/2e4;break;case 6:r=(r>>3)/16;break;case 7:r=(r>>3)/64}return n[1].v=r,n}},25:{n:"FORMULA19",f:function(e,t){var n=h(e);return e.l+=t-14,n}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var n={},r=e.l+t;e.l<r;){var i=e.read_shift(2);if(14e3==i){for(n[i]=[0,""],n[i][0]=e.read_shift(2);e[e.l];)n[i][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return n}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var n=u(e),r=e.read_shift(4);return n[1].v=r>>6,n}},38:{n:"??"},39:{n:"NUMBER27",f:m},40:{n:"FORMULA28",f:function(e,t){var n=m(e);return e.l+=t-10,n}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:p},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,n){if(n.qpro&&!(t<21)){var r=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[r,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var n=t||{};if(+n.codepage>=0&&Abe(+n.codepage),"string"==n.type)throw new Error("Cannot write WK1 to JS string");var r=FSe(),s=QSe(e["!ref"]),l=Array.isArray(e),c=[];eAe(r,0,function(e){var t=jSe(2);return t.write_shift(2,e),t}(1030)),eAe(r,6,function(e){var t=jSe(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(s));for(var u=Math.min(s.e.r,8191),d=s.s.r;d<=u;++d)for(var h=USe(d),f=s.s.c;f<=s.e.c;++f){d===s.s.r&&(c[f]=GSe(f));var m=c[f]+h,p=l?(e[d]||[])[f]:e[m];if(p&&"z"!=p.t)if("n"==p.t)(0|p.v)==p.v&&p.v>=-32768&&p.v<=32767?eAe(r,13,o(d,f,p.v)):eAe(r,14,a(d,f,p.v));else eAe(r,15,i(d,f,ZSe(p).slice(0,239)))}return eAe(r,1),r.end()},book_to_wk3:function(e,t){var n=t||{};if(+n.codepage>=0&&Abe(+n.codepage),"string"==n.type)throw new Error("Cannot write WK3 to JS string");var r=FSe();eAe(r,0,function(e){var t=jSe(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var n=0,r=0,i=0,o=0;o<e.SheetNames.length;++o){var a=e.SheetNames[o],s=e.Sheets[a];if(s&&s["!ref"]){++i;var l=$Se(s["!ref"]);n<l.e.r&&(n=l.e.r),r<l.e.c&&(r=l.e.c)}}n>8191&&(n=8191);return t.write_shift(2,n),t.write_shift(1,i),t.write_shift(1,r),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var i=0,o=0;i<e.SheetNames.length;++i)(e.Sheets[e.SheetNames[i]]||{})["!ref"]&&eAe(r,27,g(e.SheetNames[i],o++));var a=0;for(i=0;i<e.SheetNames.length;++i){var s=e.Sheets[e.SheetNames[i]];if(s&&s["!ref"]){for(var l=QSe(s["!ref"]),c=Array.isArray(s),u=[],h=Math.min(l.e.r,8191),m=l.s.r;m<=h;++m)for(var p=USe(m),v=l.s.c;v<=l.e.c;++v){m===l.s.r&&(u[v]=GSe(v));var y=u[v]+p,b=c?(s[m]||[])[v]:s[y];if(b&&"z"!=b.t)if("n"==b.t)eAe(r,23,f(m,v,a,b.v));else eAe(r,22,d(m,v,a,ZSe(b).slice(0,239)))}++a}}return eAe(r,1),r.end()},to_workbook:function(e,n){switch(n.type){case"base64":return t(Bbe(Pbe(e)),n);case"binary":return t(Bbe(e),n);case"buffer":case"array":return t(e,n)}throw"Unsupported type "+n.type}}}();var PEe=/^\s|\s$|[\t\n\r]/;function jEe(e,t){if(!t.bookSST)return"";var n=[dxe];n[n.length]=Dxe("sst",null,{xmlns:Gxe[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(null!=e[r]){var i=e[r],o="<si>";i.r?o+=i.r:(o+="<t",i.t||(i.t=""),i.t.match(PEe)&&(o+=' xml:space="preserve"'),o+=">"+gxe(i.t)+"</t>"),o+="</si>",n[n.length]=o}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}var FEe=function(e,t){var n=!1;return null==t&&(n=!0,t=jSe(15+4*e.t.length)),t.write_shift(1,0),oCe(e.t,t),n?t.slice(0,t.l):t};function HEe(e){var t=FSe();HSe(t,159,function(e,t){return t||(t=jSe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var n=0;n<e.length;++n)HSe(t,19,FEe(e[n]));return HSe(t,160),t.end()}function LEe(e){if("undefined"!==typeof Mbe)return Mbe.utils.encode(Cbe,e);for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function BEe(e){var t,n,r=0,i=LEe(e),o=i.length+1;for((t=Hbe(o))[0]=i.length,n=1;n!=o;++n)t[n]=i[n-1];for(n=o-1;n>=0;--n)r=((0===(16384&r)?0:1)|r<<1&32767)^t[n];return 52811^r}var zEe=function(){function e(e,n){switch(n.type){case"base64":return t(Pbe(e),n);case"binary":return t(e,n);case"buffer":return t(jbe&&Buffer.isBuffer(e)?e.toString("binary"):Wbe(e),n);case"array":return t(rxe(e),n)}throw new Error("Unrecognized type "+n.type)}function t(e,t){var n=(t||{}).dense?[]:{},r=e.match(/\\trowd.*?\\row\b/g);if(!r.length)throw new Error("RTF missing table");var i={s:{c:0,r:0},e:{c:0,r:r.length-1}};return r.forEach(function(e,t){Array.isArray(n)&&(n[t]=[]);for(var r,o=/\\\w+\b/g,a=0,s=-1;r=o.exec(e);){if("\\cell"===r[0]){var l=e.slice(a,o.lastIndex-r[0].length);if(" "==l[0]&&(l=l.slice(1)),++s,l.length){var c={v:l,t:"s"};Array.isArray(n)?n[t][s]=c:n[KSe({r:t,c:s})]=c}}a=o.lastIndex}s>i.e.c&&(i.e.c=s)}),n["!ref"]=XSe(i),n}return{to_workbook:function(t,n){return eCe(e(t,n),n)},to_sheet:e,from_sheet:function(e){for(var t,n=["{\\rtf1\\ansi"],r=QSe(e["!ref"]),i=Array.isArray(e),o=r.s.r;o<=r.e.r;++o){n.push("\\trowd\\trautofit1");for(var a=r.s.c;a<=r.e.c;++a)n.push("\\cellx"+(a+1));for(n.push("\\pard\\intbl"),a=r.s.c;a<=r.e.c;++a){var s=KSe({r:o,c:a});(t=i?(e[o]||[])[a]:e[s])&&(null!=t.v||t.f&&!t.F)&&(n.push(" "+(t.w||(ZSe(t),t.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}}}();function WEe(e){for(var t=0,n=1;3!=t;++t)n=256*n+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}var VEe=6;function UEe(e){return Math.floor((e+Math.round(128/VEe)/256)*VEe)}function qEe(e){return Math.floor((e-5)/VEe*100+.5)/100}function GEe(e){return Math.round((e*VEe+5)/VEe*256)/256}function YEe(e){e.width?(e.wpx=UEe(e.width),e.wch=qEe(e.wpx),e.MDW=VEe):e.wpx?(e.wch=qEe(e.wpx),e.width=GEe(e.wch),e.MDW=VEe):"number"==typeof e.wch&&(e.width=GEe(e.wch),e.wpx=UEe(e.width),e.MDW=VEe),e.customWidth&&delete e.customWidth}var KEe=96;function $Ee(e){return 96*e/KEe}function XEe(e){return e*KEe/96}function QEe(e,t){var n,r=[dxe,Dxe("styleSheet",null,{xmlns:Gxe[0],"xmlns:vt":Vxe})];return e.SSF&&null!=(n=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)null!=e[r]&&(t[t.length]=Dxe("numFmt",null,{numFmtId:r,formatCode:gxe(e[r])}))}),1===t.length?"":(t[t.length]="</numFmts>",t[0]=Dxe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=function(e){var t=[];return t[t.length]=Dxe("cellXfs",null),e.forEach(function(e){t[t.length]=Dxe("xf",null,e)}),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=Dxe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function JEe(e,t,n){n||(n=jSe(6+4*t.length)),n.write_shift(2,e),oCe(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return null==n.l&&(n.l=n.length),r}function ZEe(e,t){t||(t=jSe(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=jSe(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,n),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var n=0;"superscript"==e.vertAlign?n=1:"subscript"==e.vertAlign&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),RCe(e.color,t);var r=0;return"major"==e.scheme&&(r=1),"minor"==e.scheme&&(r=2),t.write_shift(1,r),oCe(e.name,t),t.length>t.l?t.slice(0,t.l):t}var eNe,tNe=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],nNe=PSe;function rNe(e,t){t||(t=jSe(84)),eNe||(eNe=qwe(tNe));var n=eNe[e.patternType];null==n&&(n=40),t.write_shift(4,n);var r=0;if(40!=n)for(RCe({auto:1},t),RCe({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function iNe(e,t,n){n||(n=jSe(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);return n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function oNe(e,t){return t||(t=jSe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var aNe=PSe;function sNe(e){var t;HSe(e,613,rCe(1)),HSe(e,46,(t||(t=jSe(51)),t.write_shift(1,0),oNe(0,t),oNe(0,t),oNe(0,t),oNe(0,t),oNe(0,t),t.length>t.l?t.slice(0,t.l):t)),HSe(e,614)}function lNe(e){HSe(e,619,rCe(1)),HSe(e,48,function(e,t){return t||(t=jSe(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),vCe(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}({xfId:0,builtinId:0,name:"Normal"})),HSe(e,620)}function cNe(e){HSe(e,508,function(e,t,n){var r=jSe(2052);return r.write_shift(4,e),vCe(t,r),vCe(n,r),r.length>r.l?r.slice(0,r.l):r}(0,"TableStyleMedium9","PivotStyleMedium4")),HSe(e,509)}function uNe(e,t){var n=FSe();return HSe(n,278),function(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var r=e[0];r<=e[1];++r)null!=t[r]&&++n}),0!=n&&(HSe(e,615,rCe(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)null!=t[r]&&HSe(e,44,JEe(r,t[r]))}),HSe(e,616))}}(n,e.SSF),function(e){HSe(e,611,rCe(1)),HSe(e,43,ZEe({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),HSe(e,612)}(n),function(e){HSe(e,603,rCe(2)),HSe(e,45,rNe({patternType:"none"})),HSe(e,45,rNe({patternType:"gray125"})),HSe(e,604)}(n),sNe(n),function(e){HSe(e,626,rCe(1)),HSe(e,47,iNe({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),HSe(e,627)}(n),function(e,t){HSe(e,617,rCe(t.length)),t.forEach(function(t){HSe(e,47,iNe(t,0))}),HSe(e,618)}(n,t.cellXfs),lNe(n),function(e){HSe(e,505,rCe(0)),HSe(e,506)}(n),cNe(n),HSe(n,279),n.end()}function dNe(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var n=[dxe];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function hNe(){var e=FSe();return HSe(e,332),HSe(e,334,rCe(1)),HSe(e,335,function(e){var t=jSe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),oCe(e.name,t),t.slice(0,t.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),HSe(e,336),HSe(e,339,function(e,t){var n=jSe(8+2*t.length);return n.write_shift(4,e),oCe(t,n),n.slice(0,n.l)}(1,"XLDAPR")),HSe(e,52),HSe(e,35,rCe(514)),HSe(e,4096,rCe(0)),HSe(e,4097,sEe(1)),HSe(e,36),HSe(e,53),HSe(e,340),HSe(e,337,function(e,t){var n=jSe(8);return n.write_shift(4,e),n.write_shift(4,t?1:0),n}(1,!0)),HSe(e,51,function(e){var t=jSe(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}([[1,0]])),HSe(e,338),HSe(e,333),e.end()}function fNe(){var e=[dxe];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var mNe=1024;function pNe(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[Dxe("xml",null,{"xmlns:v":Jxe,"xmlns:o":Yxe,"xmlns:x":Kxe,"xmlns:mv":Qxe}).replace(/\/>/,">"),Dxe("o:shapelayout",Dxe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Dxe("v:shapetype",[Dxe("v:stroke",null,{joinstyle:"miter"}),Dxe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];mNe<1e3*e;)mNe+=1e3;return t.forEach(function(e){var t=YSe(e[0]),n={color2:"#BEFF82",type:"gradient"};"gradient"==n.type&&(n.angle="-180");var r="gradient"==n.type?Dxe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,o=Dxe("v:fill",r,n);++mNe,i=i.concat(["<v:shape"+Mxe({id:"_x0000_s"+mNe,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",o,Dxe("v:shadow",null,{on:"t",obscured:"t"}),Dxe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",kxe("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),kxe("x:AutoFill","False"),kxe("x:Row",String(t.r)),kxe("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function gNe(e){var t=[dxe,Dxe("comments",null,{xmlns:Gxe[0]})],n=[];return t.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var r=gxe(e.a);-1==n.indexOf(r)&&(n.push(r),t.push("<author>"+r+"</author>")),e.T&&e.ID&&-1==n.indexOf("tc="+e.ID)&&(n.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))})}),0==n.length&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(e){var r=0,i=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?r=n.indexOf("tc="+e[1][0].ID):e[1].forEach(function(e){e.a&&(r=n.indexOf(gxe(e.a))),i.push(e.t||"")}),t.push('<comment ref="'+e[0]+'" authorId="'+r+'"><text>'),i.length<=1)t.push(kxe("t",gxe(i[0]||"")));else{for(var o="Comment:\n    "+i[0]+"\n",a=1;a<i.length;++a)o+="Reply:\n    "+i[a]+"\n";t.push(kxe("t",gxe(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function vNe(e,t,n){var r=[dxe,Dxe("ThreadedComments",null,{xmlns:Hxe}).replace(/[\/]>/,">")];return e.forEach(function(e){var i="";(e[1]||[]).forEach(function(o,a){if(o.T){o.a&&-1==t.indexOf(o.a)&&t.push(o.a);var s={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};0==a?i=s.id:s.parentId=i,o.ID=s.id,o.a&&(s.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),r.push(Dxe("threadedComment",kxe("text",o.t||""),s))}else delete o.ID})}),r.push("</ThreadedComments>"),r.join("")}var yNe=iCe;function bNe(e){var t=FSe(),n=[];return HSe(t,628),HSe(t,630),e.forEach(function(e){e[1].forEach(function(e){n.indexOf(e.a)>-1||(n.push(e.a.slice(0,54)),HSe(t,632,function(e){return oCe(e.slice(0,54))}(e.a)))})}),HSe(t,631),HSe(t,633),e.forEach(function(e){e[1].forEach(function(r){r.iauthor=n.indexOf(r.a);var i={s:YSe(e[0]),e:YSe(e[0])};HSe(t,635,function(e,t){return null==t&&(t=jSe(36)),t.write_shift(4,e[1].iauthor),NCe(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([i,r])),r.t&&r.t.length>0&&HSe(t,637,cCe(r)),HSe(t,636),delete r.iauthor})}),HSe(t,634),HSe(t,629),t.end()}var wNe=["xlsb","xlsm","xlam","biff8","xla"];var xNe=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(e,n,r,i){var o=!1,a=!1;0==r.length?a=!0:"["==r.charAt(0)&&(a=!0,r=r.slice(1,-1)),0==i.length?o=!0:"["==i.charAt(0)&&(o=!0,i=i.slice(1,-1));var s=r.length>0?0|parseInt(r,10):0,l=i.length>0?0|parseInt(i,10):0;return o?l+=t.c:--l,a?s+=t.r:--s,n+(o?"":"$")+GSe(l)+(a?"":"$")+USe(s)}return function(r,i){return t=i,r.replace(e,n)}}(),SNe=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,CNe=function(){return function(e,t){return e.replace(SNe,function(e,n,r,i,o,a){var s=qSe(i)-(r?0:t.c),l=VSe(a)-(o?0:t.r);return n+"R"+(0==l?"":o?l+1:"["+l+"]")+"C"+(0==s?"":r?s+1:"["+s+"]")})}}();function ENe(e,t){return e.replace(SNe,function(e,n,r,i,o,a){return n+("$"==r?r+i:GSe(qSe(i)+t.c))+("$"==o?o+a:USe(VSe(a)+t.r))})}function NNe(e){e.l+=1}function TNe(e,t){var n=e.read_shift(1==t?1:2);return[16383&n,n>>14&1,n>>15&1]}function ANe(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return RNe(e);12==n.biff&&(r=4)}var i=e.read_shift(r),o=e.read_shift(r),a=TNe(e,2),s=TNe(e,2);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:o,c:s[0],cRel:s[1],rRel:s[2]}}}function RNe(e){var t=TNe(e,2),n=TNe(e,2),r=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:i,cRel:n[1],rRel:n[2]}}}function kNe(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return function(e){var t=TNe(e,2),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}(e);var r=e.read_shift(n&&12==n.biff?4:2),i=TNe(e,2);return{r:r,c:i[0],cRel:i[1],rRel:i[2]}}function MNe(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:255&n,fQuoted:!!(16384&n),cRel:n>>15,rRel:n>>15}}function DNe(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function _Ne(e){return[e.read_shift(1),e.read_shift(1)]}function ONe(e,t){var n=[e.read_shift(1)];if(12==t)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2}switch(n[0]){case 4:n[1]=iEe(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:n[1]=ICe[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:n[1]=TCe(e);break;case 2:n[1]=fEe(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function INe(e,t,n){for(var r=e.read_shift(12==n.biff?4:2),i=[],o=0;o!=r;++o)i.push((12==n.biff?ECe:bEe)(e,8));return i}function PNe(e,t,n){var r=0,i=0;12==n.biff?(r=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,0==--i&&(i=256));for(var o=0,a=[];o!=r&&(a[o]=[]);++o)for(var s=0;s!=i;++s)a[o][s]=ONe(e,n.biff);return a}function jNe(e,t,n){return e.l+=2,[MNe(e)]}function FNe(e){return e.l+=6,[]}function HNe(e){return e.l+=2,[aEe(e),1&e.read_shift(2)]}var LNe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var BNe={1:{n:"PtgExp",f:function(e,t,n){return e.l++,n&&12==n.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(n&&2==n.biff?1:2)]}},2:{n:"PtgTbl",f:PSe},3:{n:"PtgAdd",f:NNe},4:{n:"PtgSub",f:NNe},5:{n:"PtgMul",f:NNe},6:{n:"PtgDiv",f:NNe},7:{n:"PtgPower",f:NNe},8:{n:"PtgConcat",f:NNe},9:{n:"PtgLt",f:NNe},10:{n:"PtgLe",f:NNe},11:{n:"PtgEq",f:NNe},12:{n:"PtgGe",f:NNe},13:{n:"PtgGt",f:NNe},14:{n:"PtgNe",f:NNe},15:{n:"PtgIsect",f:NNe},16:{n:"PtgUnion",f:NNe},17:{n:"PtgRange",f:NNe},18:{n:"PtgUplus",f:NNe},19:{n:"PtgUminus",f:NNe},20:{n:"PtgPercent",f:NNe},21:{n:"PtgParen",f:NNe},22:{n:"PtgMissArg",f:NNe},23:{n:"PtgStr",f:function(e,t,n){return e.l++,cEe(e,0,n)}},26:{n:"PtgSheet",f:function(e,t,n){return e.l+=5,e.l+=2,e.l+=2==n.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,n){return e.l+=2==n.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,ICe[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,TCe(e)}},32:{n:"PtgArray",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=2==n.biff?6:12==n.biff?14:7,[r]}},33:{n:"PtgFunc",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var i=e.read_shift(n&&n.biff<=3?1:2);return[oTe[i],iTe[i],r]}},34:{n:"PtgFuncVar",f:function(e,t,n){var r=e[e.l++],i=e.read_shift(1),o=n&&n.biff<=3?[88==r?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[i,(0===o[0]?iTe:rTe)[o[1]]]}},35:{n:"PtgName",f:function(e,t,n){var r=e.read_shift(1)>>>5&3,i=!n||n.biff>=8?4:2,o=e.read_shift(i);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[r,0,o]}},36:{n:"PtgRef",f:function(e,t,n){var r=(96&e[e.l])>>5;return e.l+=1,[r,kNe(e,0,n)]}},37:{n:"PtgArea",f:function(e,t,n){return[(96&e[e.l++])>>5,ANe(e,n.biff>=2&&n.biff,n)]}},38:{n:"PtgMemArea",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=n&&2==n.biff?3:4,[r,e.read_shift(n&&2==n.biff?1:2)]}},39:{n:"PtgMemErr",f:PSe},40:{n:"PtgMemNoMem",f:PSe},41:{n:"PtgMemFunc",f:function(e,t,n){return[e.read_shift(1)>>>5&3,e.read_shift(n&&2==n.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,12==n.biff&&(e.l+=2),[r]}},43:{n:"PtgAreaErr",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var i=function(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return function(e){var t=e.read_shift(2),n=e.read_shift(1),r=(32768&t)>>15,i=(16384&t)>>14;return t&=16383,1==r&&t>=8192&&(t-=16384),1==i&&n>=128&&(n-=256),{r:t,c:n,cRel:i,rRel:r}}(e);var i=e.read_shift(r>=12?4:2),o=e.read_shift(2),a=(16384&o)>>14,s=(32768&o)>>15;if(o&=16383,1==s)for(;i>524287;)i-=1048576;if(1==a)for(;o>8191;)o-=16384;return{r:i,c:o,cRel:a,rRel:s}}(e,0,n);return[r,i]}},45:{n:"PtgAreaN",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=function(e,t,n){if(n.biff<8)return RNe(e);var r=e.read_shift(12==n.biff?4:2),i=e.read_shift(12==n.biff?4:2),o=TNe(e,2),a=TNe(e,2);return{s:{r:r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}(e,0,n);return[r,i]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,n){return 5==n.biff?function(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var i=e.read_shift(2);return n&&5==n.biff&&(e.l+=12),[r,i,kNe(e,0,n)]}},59:{n:"PtgArea3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=e.read_shift(2,"i");if(n)switch(n.biff){case 5:e.l+=12;break;case 12:0}return[r,i,ANe(e,0,n)]}},60:{n:"PtgRefErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=e.read_shift(2),o=4;if(n)switch(n.biff){case 5:o=15;break;case 12:o=6}return e.l+=o,[r,i]}},61:{n:"PtgAreaErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=e.read_shift(2),o=8;if(n)switch(n.biff){case 5:e.l+=12,o=6;break;case 12:o=12}return e.l+=o,[r,i]}},255:{}},zNe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},WNe={1:{n:"PtgElfLel",f:HNe},2:{n:"PtgElfRw",f:jNe},3:{n:"PtgElfCol",f:jNe},6:{n:"PtgElfRwV",f:jNe},7:{n:"PtgElfColV",f:jNe},10:{n:"PtgElfRadical",f:jNe},11:{n:"PtgElfRadicalS",f:FNe},13:{n:"PtgElfColS",f:FNe},15:{n:"PtgElfColSV",f:FNe},16:{n:"PtgElfRadicalLel",f:HNe},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),i=e.read_shift(2),o=e.read_shift(2);return{ixti:t,coltype:3&n,rt:LNe[n>>2&31],idx:r,c:i,C:o}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},VNe={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=n&&2==n.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,n){e.l+=2;for(var r=e.read_shift(n&&2==n.biff?1:2),i=[],o=0;o<=r;++o)i.push(e.read_shift(n&&2==n.biff?1:2));return i}},8:{n:"PtgAttrGoto",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,n){e.l+=n&&2==n.biff?3:4}},32:{n:"PtgAttrBaxcel",f:DNe},33:{n:"PtgAttrBaxcel",f:DNe},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),_Ne(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),_Ne(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function UNe(e,t,n,r){if(r.biff<8)return PSe(e,t);for(var i=e.l+t,o=[],a=0;a!==n.length;++a)switch(n[a][0]){case"PtgArray":n[a][1]=PNe(e,0,r),o.push(n[a][1]);break;case"PtgMemArea":n[a][2]=INe(e,n[a][1],r),o.push(n[a][2]);break;case"PtgExp":r&&12==r.biff&&(n[a][1][1]=e.read_shift(4),o.push(n[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[a][0]}return 0!==(t=i-e.l)&&o.push(PSe(e,t)),o}function qNe(e,t,n){for(var r,i,o=e.l+t,a=[];o!=e.l;)t=o-e.l,i=e[e.l],r=BNe[i]||BNe[zNe[i]],24!==i&&25!==i||(r=(24===i?WNe:VNe)[e[e.l+1]]),r&&r.f?a.push([r.n,r.f(e,t,n)]):PSe(e,t);return a}function GNe(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],i=[],o=0;o<r.length;++o){var a=r[o];if(a)if(2===a[0])i.push('"'+a[1].replace(/"/g,'""')+'"');else i.push(a[1]);else i.push("")}t.push(i.join(","))}return t.join(";")}var YNe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function KNe(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var i="";if(n.biff>8)switch(e[r[0]][0]){case 357:return i=-1==r[1]?"#REF":e.SheetNames[r[1]],r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 358:return null!=n.SID?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return i=-1==r[1]?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[r[0]][0][3]?(i=-1==r[1]?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function $Ne(e,t,n){var r=KNe(e,t,n);return"#REF"==r?r:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(r,n)}function XNe(e,t,n,r,i){var o,a,s,l,c=i&&i.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},d=[],h=0,f=0,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",v=0,y=e[0].length;v<y;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(o=d.pop(),a=d.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=oxe(" ",e[0][p][1][1]);break;case 1:g=oxe("\r",e[0][p][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}a+=g,p=-1}d.push(a+YNe[b[0]]+o);break;case"PtgIsect":o=d.pop(),a=d.pop(),d.push(a+" "+o);break;case"PtgUnion":o=d.pop(),a=d.pop(),d.push(a+","+o);break;case"PtgRange":o=d.pop(),a=d.pop(),d.push(a+":"+o);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":s=LSe(b[1][1],u,i),d.push(zSe(s,c));break;case"PtgRefN":s=n?LSe(b[1][1],n,i):b[1][1],d.push(zSe(s,c));break;case"PtgRef3d":h=b[1][1],s=LSe(b[1][2],u,i);m=$Ne(r,h,i);d.push(m+"!"+zSe(s,c));break;case"PtgFunc":case"PtgFuncVar":var w=b[1][0],x=b[1][1];w||(w=0);var S=0==(w&=127)?[]:d.slice(-w);d.length-=w,"User"===x&&(x=S.shift()),d.push(x+"("+S.join(",")+")");break;case"PtgBool":d.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":d.push(b[1]);break;case"PtgNum":d.push(String(b[1]));break;case"PtgStr":d.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=BSe(b[1][1],n?{s:n}:u,i),d.push(WSe(l,i));break;case"PtgArea":l=BSe(b[1][1],u,i),d.push(WSe(l,i));break;case"PtgArea3d":h=b[1][1],l=b[1][2],m=$Ne(r,h,i),d.push(m+"!"+WSe(l,i));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgName":f=b[1][2];var C=(r.names||[])[f-1]||(r[0]||[])[f],E=C?C.Name:"SH33TJSNAME"+String(f);E&&"_xlfn."==E.slice(0,6)&&!i.xlfn&&(E=E.slice(6)),d.push(E);break;case"PtgNameX":var N,T=b[1][1];if(f=b[1][2],!(i.biff<=5)){var A="";if(14849==((r[T]||[])[0]||[])[0]||(1025==((r[T]||[])[0]||[])[0]?r[T][f]&&r[T][f].itab>0&&(A=r.SheetNames[r[T][f].itab-1]+"!"):A=r.SheetNames[f-1]+"!"),r[T]&&r[T][f])A+=r[T][f].Name;else if(r[0]&&r[0][f])A+=r[0][f].Name;else{var R=(KNe(r,T,i)||"").split(";;");R[f-1]?A=R[f-1]:A+="SH33TJSERRX"}d.push(A);break}T<0&&(T=-T),r[T]&&(N=r[T][f]),N||(N={Name:"SH33TJSERRY"}),d.push(N.Name);break;case"PtgParen":var k="(",M=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:k=oxe(" ",e[0][p][1][1])+k;break;case 3:k=oxe("\r",e[0][p][1][1])+k;break;case 4:M=oxe(" ",e[0][p][1][1])+M;break;case 5:M=oxe("\r",e[0][p][1][1])+M;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}d.push(k+d.pop()+M);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":d.push("#REF!");break;case"PtgExp":s={c:b[1][1],r:b[1][0]};var D={c:n.c,r:n.r};if(r.sharedf[KSe(s)]){var _=r.sharedf[KSe(s)];d.push(XNe(_,u,D,r,i))}else{var O=!1;for(o=0;o!=r.arrayf.length;++o)if(a=r.arrayf[o],!(s.c<a[0].s.c||s.c>a[0].e.c)&&!(s.r<a[0].s.r||s.r>a[0].e.r)){d.push(XNe(a[1],u,D,r,i)),O=!0;break}O||d.push(b[1])}break;case"PtgArray":d.push("{"+GNe(b[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgMissArg":d.push("");break;case"PtgList":d.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(b))}if(3!=i.biff&&p>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var I=!0;switch((b=e[0][p])[1][0]){case 4:I=!1;case 0:g=oxe(" ",b[1][1]);break;case 5:I=!1;case 1:g=oxe("\r",b[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}d.push((I?g:"")+d.pop()+(I?"":g)),p=-1}}if(d.length>1&&i.WTF)throw new Error("bad formula stack");return d[0]}function QNe(e,t,n,r,i){var o=vEe(t,n,i),a=function(e){if(null==e){var t=jSe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return ACe("number"==typeof e?e:0)}(e.v),s=jSe(6);s.write_shift(2,33),s.write_shift(4,0);for(var l=jSe(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return Vbe([o,a,s,l])}function JNe(e,t,n){var r=e.read_shift(4),i=qNe(e,r,n),o=e.read_shift(4);return[i,o>0?UNe(e,o,i,n):null]}var ZNe=JNe,eTe=JNe,tTe=JNe,nTe=JNe,rTe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},iTe={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},oTe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function aTe(e){return("of:="+e.replace(SNe,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function sTe(e){return e.replace(/\./,"!")}var lTe="undefined"!==typeof Map;function cTe(e,t,n){var r=0,i=e.length;if(n){if(lTe?n.has(t):Object.prototype.hasOwnProperty.call(n,t))for(var o=lTe?n.get(t):n[t];r<o.length;++r)if(e[o[r]].t===t)return e.Count++,o[r]}else for(;r<i;++r)if(e[r].t===t)return e.Count++,r;return e[i]={t:t},e.Count++,e.Unique++,n&&(lTe?(n.has(t)||n.set(t,[]),n.get(t).push(i)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(i))),i}function uTe(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(VEe=t.MDW),null!=t.width?n.customWidth=1:null!=t.wpx?r=qEe(t.wpx):null!=t.wch&&(r=t.wch),r>-1?(n.width=GEe(r),n.customWidth=1):null!=t.width&&(n.width=t.width),t.hidden&&(n.hidden=!0),null!=t.level&&(n.outlineLevel=n.level=t.level),n}function dTe(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(n=[1,1,1,1,.5,.5]),null==e.left&&(e.left=n[0]),null==e.right&&(e.right=n[1]),null==e.top&&(e.top=n[2]),null==e.bottom&&(e.bottom=n[3]),null==e.header&&(e.header=n[4]),null==e.footer&&(e.footer=n[5])}}function hTe(e,t,n){var r=n.revssf[null!=t.z?t.z:"General"],i=60,o=e.length;if(null==r&&n.ssf)for(;i<392;++i)if(null==n.ssf[i]){Iwe(t.z,i),n.ssf[i]=t.z,n.revssf[t.z]=r=i;break}for(i=0;i!=o;++i)if(e[i].numFmtId===r)return i;return e[o]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function fTe(e,t,n){if(e&&e["!ref"]){var r=QSe(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}var mTe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],pTe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function gTe(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),void 0===e.v&&"string"!==typeof e.f||"z"===e.t&&!e.f)return"";var i="",o=e.t,a=e.v;if("z"!==e.t)switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=ICe[e.v];break;case"d":r&&r.cellDates?i=nxe(e.v,-1).toISOString():((e=ixe(e)).t="n",i=""+(e.v=Kwe(nxe(e.v)))),"undefined"===typeof e.z&&(e.z=twe[14]);break;default:i=e.v}var s=kxe("v",gxe(i)),l={r:t},c=hTe(r.cellXfs,e,r);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){s=kxe("v",""+cTe(r.Strings,e.v,r.revStrings)),l.t="s";break}l.t="str"}if(e.t!=o&&(e.t=o,e.v=a),"string"==typeof e.f&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;s=Dxe("f",gxe(e.f),u)+(null!=e.v?s:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(l.cm=1),Dxe("c",s,l)}function vTe(e,t,n,r){var i,o=[dxe,Dxe("worksheet",null,{xmlns:Gxe[0],"xmlns:r":Wxe})],a=n.SheetNames[e],s="",l=n.Sheets[a];null==l&&(l={});var c=l["!ref"]||"A1",u=QSe(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=XSe(u)}r||(r={}),l["!comments"]=[];var d=[];!function(e,t,n,r,i){var o=!1,a={},s=null;if("xlsx"!==r.bookType&&t.vbaraw){var l=t.SheetNames[n];try{t.Workbook&&(l=t.Workbook.Sheets[n].CodeName||l)}catch(qb){}o=!0,a.codeName=Txe(gxe(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),s=(s||"")+Dxe("outlinePr",null,c)}(o||s)&&(i[i.length]=Dxe("sheetPr",s,a))}(l,n,e,t,o),o[o.length]=Dxe("dimension",null,{ref:c}),o[o.length]=function(e,t,n,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Dxe("sheetViews",Dxe("sheetView",null,i),{})}(0,0,0,n),t.sheetFormat&&(o[o.length]=Dxe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(o[o.length]=function(e,t){for(var n,r=["<cols>"],i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=Dxe("col",null,uTe(i,n)));return r[r.length]="</cols>",r.join("")}(0,l["!cols"])),o[i=o.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(s=function(e,t){var n,r,i=[],o=[],a=QSe(e["!ref"]),s="",l="",c=[],u=0,d=0,h=e["!rows"],f=Array.isArray(e),m={r:l},p=-1;for(d=a.s.c;d<=a.e.c;++d)c[d]=GSe(d);for(u=a.s.r;u<=a.e.r;++u){for(o=[],l=USe(u),d=a.s.c;d<=a.e.c;++d){n=c[d]+l;var g=f?(e[u]||[])[d]:e[n];void 0!==g&&null!=(s=gTe(g,n,e,t))&&o.push(s)}(o.length>0||h&&h[u])&&(m={r:l},h&&h[u]&&((r=h[u]).hidden&&(m.hidden=1),p=-1,r.hpx?p=$Ee(r.hpx):r.hpt&&(p=r.hpt),p>-1&&(m.ht=p,m.customHeight=1),r.level&&(m.outlineLevel=r.level)),i[i.length]=Dxe("row",o.join(""),m))}if(h)for(;u<h.length;++u)h&&h[u]&&(m={r:u+1},(r=h[u]).hidden&&(m.hidden=1),p=-1,r.hpx?p=$Ee(r.hpx):r.hpt&&(p=r.hpt),p>-1&&(m.ht=p,m.customHeight=1),r.level&&(m.outlineLevel=r.level),i[i.length]=Dxe("row","",m));return i.join("")}(l,t,0,0),s.length>0&&(o[o.length]=s)),o.length>i+1&&(o[o.length]="</sheetData>",o[i]=o[i].replace("/>",">")),l["!protect"]&&(o[o.length]=function(e){var t={sheet:1};return mTe.forEach(function(n){null!=e[n]&&e[n]&&(t[n]="1")}),pTe.forEach(function(n){null==e[n]||e[n]||(t[n]="0")}),e.password&&(t.password=BEe(e.password).toString(16).toUpperCase()),Dxe("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(o[o.length]=function(e,t,n,r){var i="string"==typeof e.ref?e.ref:XSe(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,a=$Se(i);a.s.r==a.e.r&&(a.e.r=$Se(t["!ref"]).e.r,i=XSe(a));for(var s=0;s<o.length;++s){var l=o[s];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==r){l.Ref="'"+n.SheetNames[r]+"'!"+i;break}}return s==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),Dxe("autoFilter",null,{ref:i})}(l["!autofilter"],l,n,e)),null!=l["!merges"]&&l["!merges"].length>0&&(o[o.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+XSe(e[n])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var h,f,m=-1,p=-1;return l["!links"].length>0&&(o[o.length]="<hyperlinks>",l["!links"].forEach(function(e){e[1].Target&&(h={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(p=zCe(r,-1,gxe(e[1].Target).replace(/#.*$/,""),HCe.HLINK),h["r:id"]="rId"+p),(m=e[1].Target.indexOf("#"))>-1&&(h.location=gxe(e[1].Target.slice(m+1))),e[1].Tooltip&&(h.tooltip=gxe(e[1].Tooltip)),o[o.length]=Dxe("hyperlink",null,h))}),o[o.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(o[o.length]=(dTe(f=l["!margins"]),Dxe("pageMargins",null,f))),t&&!t.ignoreEC&&void 0!=t.ignoreEC||(o[o.length]=kxe("ignoredErrors",Dxe("ignoredError",null,{numberStoredAsText:1,sqref:c}))),d.length>0&&(p=zCe(r,-1,"../drawings/drawing"+(e+1)+".xml",HCe.DRAW),o[o.length]=Dxe("drawing",null,{"r:id":"rId"+p}),l["!drawing"]=d),l["!comments"].length>0&&(p=zCe(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",HCe.VML),o[o.length]=Dxe("legacyDrawing",null,{"r:id":"rId"+p}),l["!legacy"]=p),o.length>1&&(o[o.length]="</worksheet>",o[1]=o[1].replace("/>",">")),o.join("")}function yTe(e,t,n,r){var i=function(e,t,n){var r=jSe(145),i=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var o=320;i.hpx?o=20*$Ee(i.hpx):i.hpt&&(o=20*i.hpt),r.write_shift(2,o),r.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),r.write_shift(1,a),r.write_shift(1,0);var s=0,l=r.l;r.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var d=-1,h=-1,f=u<<10;f<u+1<<10;++f)c.c=f,(Array.isArray(n)?(n[c.r]||[])[c.c]:n[KSe(c)])&&(d<0&&(d=f),h=f);d<0||(++s,r.write_shift(4,d),r.write_shift(4,h))}var m=r.l;return r.l=l,r.write_shift(4,s),r.l=m,r.length>r.l?r.slice(0,r.l):r}(r,n,t);(i.length>17||(t["!rows"]||[])[r])&&HSe(e,0,i)}var bTe=ECe,wTe=NCe;function xTe(e){return[hCe(e),TCe(e),"n"]}var STe=ECe,CTe=NCe;var ETe=["left","right","top","bottom","header","footer"];function NTe(e,t,n,r,i,o,a){if(void 0===t.v)return!1;var s="";switch(t.t){case"b":s=t.v?"1":"0";break;case"d":(t=ixe(t)).z=t.z||twe[14],t.v=Kwe(nxe(t.v)),t.t="n";break;case"n":case"e":s=""+t.v;break;default:s=t.v}var l={r:n,c:r};switch(l.s=hTe(i.cellXfs,t,i),t.l&&o["!links"].push([KSe(l),t.l]),t.c&&o["!comments"].push([KSe(l),t.c]),t.t){case"s":case"str":return i.bookSST?(s=cTe(i.Strings,t.v,i.revStrings),l.t="s",l.v=s,a?HSe(e,18,function(e,t,n){return null==n&&(n=jSe(8)),fCe(t,n),n.write_shift(4,t.v),n}(0,l)):HSe(e,7,function(e,t,n){return null==n&&(n=jSe(12)),dCe(t,n),n.write_shift(4,t.v),n}(0,l))):(l.t="str",a?HSe(e,17,function(e,t,n){return null==n&&(n=jSe(8+4*e.v.length)),fCe(t,n),oCe(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l)):HSe(e,6,function(e,t,n){return null==n&&(n=jSe(12+4*e.v.length)),dCe(t,n),oCe(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?a?HSe(e,13,function(e,t,n){return null==n&&(n=jSe(8)),fCe(t,n),SCe(e.v,n),n}(t,l)):HSe(e,2,function(e,t,n){return null==n&&(n=jSe(12)),dCe(t,n),SCe(e.v,n),n}(t,l)):a?HSe(e,16,function(e,t,n){return null==n&&(n=jSe(12)),fCe(t,n),ACe(e.v,n),n}(t,l)):HSe(e,5,function(e,t,n){return null==n&&(n=jSe(16)),dCe(t,n),ACe(e.v,n),n}(t,l)),!0;case"b":return l.t="b",a?HSe(e,15,function(e,t,n){return null==n&&(n=jSe(5)),fCe(t,n),n.write_shift(1,e.v?1:0),n}(t,l)):HSe(e,4,function(e,t,n){return null==n&&(n=jSe(9)),dCe(t,n),n.write_shift(1,e.v?1:0),n}(t,l)),!0;case"e":return l.t="e",a?HSe(e,14,function(e,t,n){return null==n&&(n=jSe(8)),fCe(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}(t,l)):HSe(e,3,function(e,t,n){return null==n&&(n=jSe(9)),dCe(t,n),n.write_shift(1,e.v),n}(t,l)),!0}return a?HSe(e,12,function(e,t,n){return null==n&&(n=jSe(4)),fCe(t,n)}(0,l)):HSe(e,1,function(e,t,n){return null==n&&(n=jSe(8)),dCe(t,n)}(0,l)),!0}function TTe(e,t){var n,r;t&&t["!merges"]&&(HSe(e,177,(n=t["!merges"].length,null==r&&(r=jSe(4)),r.write_shift(4,n),r)),t["!merges"].forEach(function(t){HSe(e,176,CTe(t))}),HSe(e,178))}function ATe(e,t){t&&t["!cols"]&&(HSe(e,390),t["!cols"].forEach(function(t,n){t&&HSe(e,60,function(e,t,n){null==n&&(n=jSe(18));var r=uTe(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,256*(r.width||10)),n.write_shift(4,0);var i=0;return t.hidden&&(i|=1),"number"==typeof r.width&&(i|=2),t.level&&(i|=t.level<<8),n.write_shift(2,i),n}(n,t))}),HSe(e,391))}function RTe(e,t){t&&t["!ref"]&&(HSe(e,648),HSe(e,649,function(e){var t=jSe(24);return t.write_shift(4,4),t.write_shift(4,1),NCe(e,t),t}(QSe(t["!ref"]))),HSe(e,650))}function kTe(e,t,n){t["!links"].forEach(function(t){if(t[1].Target){var r=zCe(n,-1,t[1].Target.replace(/#.*$/,""),HCe.HLINK);HSe(e,494,function(e,t){var n=jSe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));NCe({s:YSe(e[0]),e:YSe(e[0])},n),wCe("rId"+t,n);var r=e[1].Target.indexOf("#");return oCe((-1==r?"":e[1].Target.slice(r+1))||"",n),oCe(e[1].Tooltip||"",n),oCe("",n),n.slice(0,n.l)}(t,r))}}),delete t["!links"]}function MTe(e,t,n){HSe(e,133),HSe(e,137,function(e,t,n){null==n&&(n=jSe(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}(0,n)),HSe(e,138),HSe(e,134)}function DTe(e,t){var n,r;t["!protect"]&&HSe(e,535,(n=t["!protect"],null==r&&(r=jSe(66)),r.write_shift(2,n.password?BEe(n.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?r.write_shift(4,null==n[e[0]]||n[e[0]]?0:1):r.write_shift(4,null!=n[e[0]]&&n[e[0]]?0:1)}),r))}function _Te(e,t,n,r){var i=FSe(),o=n.SheetNames[e],a=n.Sheets[o]||{},s=o;try{n&&n.Workbook&&(s=n.Workbook.Sheets[e].CodeName||s)}catch(qb){}var l,c,u=QSe(a["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],HSe(i,129),(n.vbaraw||a["!outline"])&&HSe(i,147,function(e,t,n){null==n&&(n=jSe(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var i=1;i<3;++i)n.write_shift(1,0);return RCe({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),pCe(e,n),n.slice(0,n.l)}(s,a["!outline"])),HSe(i,148,wTe(u)),MTe(i,0,n.Workbook),ATe(i,a),function(e,t,n,r){var i,o=QSe(t["!ref"]||"A1"),a="",s=[];HSe(e,145);var l=Array.isArray(t),c=o.e.r;t["!rows"]&&(c=Math.max(o.e.r,t["!rows"].length-1));for(var u=o.s.r;u<=c;++u){a=USe(u),yTe(e,t,o,u);var d=!1;if(u<=o.e.r)for(var h=o.s.c;h<=o.e.c;++h){u===o.s.r&&(s[h]=GSe(h)),i=s[h]+a;var f=l?(t[u]||[])[h]:t[i];d=!!f&&NTe(e,f,u,h,r,t,d)}}HSe(e,146)}(i,a,0,t),DTe(i,a),function(e,t,n,r){if(t["!autofilter"]){var i=t["!autofilter"],o="string"===typeof i.ref?i.ref:XSe(i.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var a=n.Workbook.Names,s=$Se(o);s.s.r==s.e.r&&(s.e.r=$Se(t["!ref"]).e.r,o=XSe(s));for(var l=0;l<a.length;++l){var c=a[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==r){c.Ref="'"+n.SheetNames[r]+"'!"+o;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+o}),HSe(e,161,NCe(QSe(o))),HSe(e,162)}}(i,a,n,e),TTe(i,a),kTe(i,a,r),a["!margins"]&&HSe(i,476,(l=a["!margins"],null==c&&(c=jSe(48)),dTe(l),ETe.forEach(function(e){ACe(l[e],c)}),c)),t&&!t.ignoreEC&&void 0!=t.ignoreEC||RTe(i,a),function(e,t,n,r){if(t["!comments"].length>0){var i=zCe(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",HCe.VML);HSe(e,551,wCe("rId"+i)),t["!legacy"]=i}}(i,a,e,r),HSe(i,130),i.end()}var OTe=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];var ITe="][*?/\\".split("");function PTe(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var n=!0;return ITe.forEach(function(r){if(-1!=e.indexOf(r)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");n=!1}}),n}function jTe(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t,n,r,i=e.Workbook&&e.Workbook.Sheets||[];t=e.SheetNames,n=i,r=!!e.vbaraw,t.forEach(function(e,i){PTe(e);for(var o=0;o<i;++o)if(e==t[o])throw new Error("Duplicate Sheet Name: "+e);if(r){var a=n&&n[i]&&n[i].CodeName||e;if(95==a.charCodeAt(0)&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}});for(var o=0;o<e.SheetNames.length;++o)fTe(e.Sheets[e.SheetNames[o]],e.SheetNames[o],o)}function FTe(e){var t=[dxe];t[t.length]=Dxe("workbook",null,{xmlns:Gxe[0],"xmlns:r":Wxe});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(OTe.forEach(function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(r[t[0]]=e.Workbook.WBProps[t[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=Dxe("workbookPr",null,r);var i=e.Workbook&&e.Workbook.Sheets||[],o=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",o=0;o!=e.SheetNames.length&&i[o]&&i[o].Hidden;++o);o==e.SheetNames.length&&(o=0),t[t.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",o=0;o!=e.SheetNames.length;++o){var a={name:gxe(e.SheetNames[o].slice(0,31))};if(a.sheetId=""+(o+1),a["r:id"]="rId"+(o+1),i[o])switch(i[o].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden"}t[t.length]=Dxe("sheet",null,a)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(e){var n={name:e.Name};e.Comment&&(n.comment=e.Comment),null!=e.Sheet&&(n.localSheetId=""+e.Sheet),e.Hidden&&(n.hidden="1"),e.Ref&&(t[t.length]=Dxe("definedName",gxe(e.Ref),n))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function HTe(e,t){return t||(t=jSe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),wCe(e.strRelID,t),oCe(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function LTe(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var n,r,i=t.Workbook.Sheets,o=0,a=-1,s=-1;o<i.length;++o)!i[o]||!i[o].Hidden&&-1==a?a=o:1==i[o].Hidden&&-1==s&&(s=o);if(!(s>a))HSe(e,135),HSe(e,158,(n=a,r||(r=jSe(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,n),r.write_shift(4,n),r.write_shift(1,120),r.length>r.l?r.slice(0,r.l):r)),HSe(e,136)}}function BTe(e,t){var n=FSe();return HSe(n,131),HSe(n,128,function(e,t){t||(t=jSe(127));for(var n=0;4!=n;++n)t.write_shift(4,0);return oCe("SheetJS",t),oCe(xbe.version,t),oCe(xbe.version,t),oCe("7262",t),t.length>t.l?t.slice(0,t.l):t}()),HSe(n,153,function(e,t){t||(t=jSe(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),pCe(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),LTe(n,e),function(e,t){HSe(e,143);for(var n=0;n!=t.SheetNames.length;++n)HSe(e,156,HTe({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]}));HSe(e,144)}(n,e),HSe(n,132),n.end()}function zTe(e,t,n,r,i){return(".bin"===t.slice(-4)?_Te:vTe)(e,n,r,i)}function WTe(e,t,n){return(".bin"===t.slice(-4)?bNe:gNe)(e,n)}function VTe(e,t){var n=[];return e.Props&&n.push(function(e,t){var n=[];return Vwe(JCe).map(function(e){for(var t=0;t<qCe.length;++t)if(qCe[t][1]==e)return qCe[t];for(t=0;t<KCe.length;++t)if(KCe[t][1]==e)return KCe[t];throw e}).forEach(function(r){if(null!=e[r[1]]){var i=t&&t.Props&&null!=t.Props[r[1]]?t.Props[r[1]]:e[r[1]];"date"===r[2]&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof i?i=String(i):!0===i||!1===i?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),n.push(kxe(JCe[r[1]]||r[1],i))}}),Dxe("DocumentProperties",n.join(""),{xmlns:Yxe})}(e.Props,t)),e.Custprops&&n.push(function(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return e&&Vwe(e).forEach(function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var r=0;r<qCe.length;++r)if(t==qCe[r][1])return;for(r=0;r<KCe.length;++r)if(t==KCe[r][1])return;for(r=0;r<n.length;++r)if(t==n[r])return;var o=e[t],a="string";"number"==typeof o?(a="float",o=String(o)):!0===o||!1===o?(a="boolean",o=o?"1":"0"):o=String(o),i.push(Dxe(vxe(t),o,{"dt:dt":a}))}}),t&&Vwe(t).forEach(function(n){if(Object.prototype.hasOwnProperty.call(t,n)&&(!e||!Object.prototype.hasOwnProperty.call(e,n))){var r=t[n],o="string";"number"==typeof r?(o="float",r=String(r)):!0===r||!1===r?(o="boolean",r=r?"1":"0"):r instanceof Date?(o="dateTime.tz",r=r.toISOString()):r=String(r),i.push(Dxe(vxe(n),r,{"dt:dt":o}))}}),"<"+r+' xmlns="'+Yxe+'">'+i.join("")+"</"+r+">"}(e.Props,e.Custprops)),n.join("")}function UTe(e){return Dxe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+CNe(e.Ref,{r:0,c:0})})}function qTe(e,t,n,r,i,o,a){if(!e||void 0==e.v&&void 0==e.f)return"";var s={};if(e.f&&(s["ss:Formula"]="="+gxe(CNe(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var l=YSe(e.F.slice(t.length+1));s["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(e.l&&e.l.Target&&(s["ss:HRef"]=gxe(e.l.Target),e.l.Tooltip&&(s["x:HRefScreenTip"]=gxe(e.l.Tooltip))),n["!merges"])for(var c=n["!merges"],u=0;u!=c.length;++u)c[u].s.c==a.c&&c[u].s.r==a.r&&(c[u].e.c>c[u].s.c&&(s["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(s["ss:MergeDown"]=c[u].e.r-c[u].s.r));var d="",h="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":d="Number",h=String(e.v);break;case"b":d="Boolean",h=e.v?"1":"0";break;case"e":d="Error",h=ICe[e.v];break;case"d":d="DateTime",h=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||twe[14]);break;case"s":d="String",h=((e.v||"")+"").replace(mxe,function(e){return fxe[e]}).replace(yxe,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var f=hTe(r.cellXfs,e,r);s["ss:StyleID"]="s"+(21+f),s["ss:Index"]=a.c+1;var m=null!=e.v?h:"",p="z"==e.t?"":'<Data ss:Type="'+d+'">'+m+"</Data>";return(e.c||[]).length>0&&(p+=e.c.map(function(e){var t=Dxe("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return Dxe("Comment",t,{"ss:Author":e.a})}).join("")),Dxe("Cell",p,s)}function GTe(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=XEe(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function YTe(e,t,n){var r=[],i=n.SheetNames[e],o=n.Sheets[i],a=o?function(e,t,n,r){if(!e)return"";if(!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,o=[],a=0;a<i.length;++a){var s=i[a];s.Sheet==n&&(s.Name.match(/^_xlfn\./)||o.push(UTe(s)))}return o.join("")}(o,0,e,n):"";return a.length>0&&r.push("<Names>"+a+"</Names>"),a=o?function(e,t){if(!e["!ref"])return"";var n=QSe(e["!ref"]),r=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(e,t){YEe(e);var n=!!e.width,r=uTe(t,e),i={"ss:Index":t+1};n&&(i["ss:Width"]=UEe(r.width)),e.hidden&&(i["ss:Hidden"]="1"),o.push(Dxe("Column",null,i))});for(var a=Array.isArray(e),s=n.s.r;s<=n.e.r;++s){for(var l=[GTe(s,(e["!rows"]||[])[s])],c=n.s.c;c<=n.e.c;++c){var u=!1;for(i=0;i!=r.length;++i)if(!(r[i].s.c>c)&&!(r[i].s.r>s)&&!(r[i].e.c<c)&&!(r[i].e.r<s)){r[i].s.c==c&&r[i].s.r==s||(u=!0);break}if(!u){var d={r:s,c:c},h=KSe(d),f=a?(e[s]||[])[c]:e[h];l.push(qTe(f,h,e,t,0,0,d))}}l.push("</Row>"),l.length>2&&o.push(l.join(""))}return o.join("")}(o,t):"",a.length>0&&r.push("<Table>"+a+"</Table>"),r.push(function(e,t,n,r){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Dxe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Dxe("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Dxe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)i.push(Dxe("Visible",1==r.Workbook.Sheets[n].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<n&&(!r.Workbook.Sheets[o]||r.Workbook.Sheets[o].Hidden);++o);o==n&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(kxe("ProtectContents","True")),e["!protect"].objects&&i.push(kxe("ProtectObjects","True")),e["!protect"].scenarios&&i.push(kxe("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||i.push(kxe("EnableSelection","UnlockedCells")):i.push(kxe("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(t){e["!protect"][t[0]]&&i.push("<"+t[1]+"/>")})),0==i.length?"":Dxe("WorksheetOptions",i.join(""),{xmlns:Kxe})}(o,0,e,n)),r.join("")}function KTe(e,t){t||(t={}),e.SSF||(e.SSF=ixe(twe)),e.SSF&&(jwe(),Pwe(e.SSF),t.revssf=Gwe(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],hTe(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(VTe(e,t)),n.push(""),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(Dxe("Worksheet",YTe(r,t,e),{"ss:Name":gxe(e.SheetNames[r])}));return n[2]=function(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(e,t){var r=[];r.push(Dxe("NumberFormat",null,{"ss:Format":gxe(twe[e.numFmtId])}));var i={"ss:ID":"s"+(21+t)};n.push(Dxe("Style",r.join(""),i))}),Dxe("Styles",n.join(""))}(0,t),n[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var i=t[r];null==i.Sheet&&(i.Name.match(/^_xlfn\./)||n.push(UTe(i)))}return Dxe("Names",n.join(""))}(e),dxe+Dxe("Workbook",n.join(""),{xmlns:$xe,"xmlns:o":Yxe,"xmlns:x":Kxe,"xmlns:ss":$xe,"xmlns:dt":Xxe,"xmlns:html":Zxe})}var $Te="e0859ff2f94f6810ab9108002b27b3d9",XTe="02d5cdd59c2e1b10939708002b2cf9ae",QTe="05d5cdd59c2e1b10939708002b2cf9ae";function JTe(e,t){var n=t||{},r=Lwe.utils.cfb_new({root:"R"}),i="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":i="/Workbook",n.biff=8;break;case"biff5":i="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return Lwe.utils.cfb_add(r,i,cAe(e,n)),8==n.biff&&(e.Props||e.Custprops)&&function(e,t){var n,r=[],i=[],o=[],a=0,s=Uwe(MCe,"n"),l=Uwe(DCe,"n");if(e.Props)for(n=Vwe(e.Props),a=0;a<n.length;++a)(Object.prototype.hasOwnProperty.call(s,n[a])?r:Object.prototype.hasOwnProperty.call(l,n[a])?i:o).push([n[a],e.Props[n[a]]]);if(e.Custprops)for(n=Vwe(e.Custprops),a=0;a<n.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},n[a])||(Object.prototype.hasOwnProperty.call(s,n[a])?r:Object.prototype.hasOwnProperty.call(l,n[a])?i:o).push([n[a],e.Custprops[n[a]]]);var c=[];for(a=0;a<o.length;++a)eEe.indexOf(o[a][0])>-1||$Ce.indexOf(o[a][0])>-1||null!=o[a][1]&&c.push(o[a]);i.length&&Lwe.utils.cfb_add(t,"/\x05SummaryInformation",rEe(i,$Te,l,DCe)),(r.length||c.length)&&Lwe.utils.cfb_add(t,"/\x05DocumentSummaryInformation",rEe(r,XTe,s,MCe,c.length?c:null,QTe))}(e,r),8==n.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach(function(n,r){if(0!=r){var i=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==i.slice(-1)&&Lwe.utils.cfb_add(e,i,t.FileIndex[r].content)}})}(r,Lwe.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),r}var ZTe={0:{f:function(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=r,7&o&&(n.level=7&o),16&o&&(n.hidden=!0),32&o&&(n.hpt=i/20),n}},1:{f:function(e){return[uCe(e)]}},2:{f:function(e){return[uCe(e),xCe(e),"n"]}},3:{f:function(e){return[uCe(e),e.read_shift(1),"e"]}},4:{f:function(e){return[uCe(e),e.read_shift(1),"b"]}},5:{f:function(e){return[uCe(e),TCe(e),"n"]}},6:{f:function(e){return[uCe(e),iCe(e),"str"]}},7:{f:function(e){return[uCe(e),e.read_shift(4),"s"]}},8:{f:function(e,t,n){var r=e.l+t,i=uCe(e);i.r=n["!row"];var o=[i,iCe(e),"str"];if(n.cellFormula){e.l+=2;var a=eTe(e,r-e.l,n);o[3]=XNe(a,0,i,n.supbooks,n)}else e.l=r;return o}},9:{f:function(e,t,n){var r=e.l+t,i=uCe(e);i.r=n["!row"];var o=[i,TCe(e),"n"];if(n.cellFormula){e.l+=2;var a=eTe(e,r-e.l,n);o[3]=XNe(a,0,i,n.supbooks,n)}else e.l=r;return o}},10:{f:function(e,t,n){var r=e.l+t,i=uCe(e);i.r=n["!row"];var o=[i,e.read_shift(1),"b"];if(n.cellFormula){e.l+=2;var a=eTe(e,r-e.l,n);o[3]=XNe(a,0,i,n.supbooks,n)}else e.l=r;return o}},11:{f:function(e,t,n){var r=e.l+t,i=uCe(e);i.r=n["!row"];var o=[i,e.read_shift(1),"e"];if(n.cellFormula){e.l+=2;var a=eTe(e,r-e.l,n);o[3]=XNe(a,0,i,n.supbooks,n)}else e.l=r;return o}},12:{f:function(e){return[hCe(e)]}},13:{f:function(e){return[hCe(e),xCe(e),"n"]}},14:{f:function(e){return[hCe(e),e.read_shift(1),"e"]}},15:{f:function(e){return[hCe(e),e.read_shift(1),"b"]}},16:{f:xTe},17:{f:function(e){return[hCe(e),iCe(e),"str"]}},18:{f:function(e){return[hCe(e),e.read_shift(4),"s"]}},19:{f:sCe},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),o=yCe(e),a=tTe(e,0,n),s=gCe(e);e.l=r;var l={Name:o,Ptg:a};return i<268435455&&(l.Sheet=i),s&&(l.Comment=s),l}},40:{},42:{},43:{f:function(e,t,n){var r={};r.sz=e.read_shift(2)/20;var i=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1),700===e.read_shift(2)&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var o=e.read_shift(1);0!=o&&(r.underline=o);var a=e.read_shift(1);a>0&&(r.family=a);var s=e.read_shift(1);switch(s>0&&(r.charset=s),e.l++,r.color=function(e){var t={},n=e.read_shift(1)>>>1,r=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=r;var l=OCe[r];l&&(t.rgb=WEe(l));break;case 2:t.rgb=WEe([o,a,s]);break;case 3:t.theme=r}return 0!=i&&(t.tint=i>0?i/32767:i/32768),t}(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=iCe(e),r}},44:{f:function(e,t){return[e.read_shift(2),iCe(e)]}},45:{f:nNe},46:{f:aNe},47:{f:function(e,t){var n=e.l+t,r=e.read_shift(2),i=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:i}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:REe},62:{f:function(e){return[uCe(e),sCe(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=KSe(n);var r=e.read_shift(1);return 2&r&&(t.l="1"),8&r&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:PSe,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var n={},r=e[e.l];return++e.l,n.above=!(64&r),n.left=!(128&r),e.l+=18,n.name=mCe(e,t-19),n}},148:{f:bTe,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var i=t>8?iCe(e):"";return i.length>0&&(n.CodeName=i),n.autoCompressPictures=!!(65536&r),n.backupFile=!!(64&r),n.checkCompatibility=!!(4096&r),n.date1904=!!(1&r),n.filterPrivacy=!!(8&r),n.hidePivotFieldList=!!(1024&r),n.promptedSolutions=!!(16&r),n.publishItems=!!(2048&r),n.refreshAllConnections=!!(262144&r),n.saveExternalLinkValues=!!(128&r),n.showBorderUnselectedTables=!!(4&r),n.showInkAnnotation=!!(32&r),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(32768&r),n.updateLinks=["userSet","never","always"][r>>8&3],n}},154:{},155:{},156:{f:function(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=bCe(e,t-8),n.name=iCe(e),n}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:ECe},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:STe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:iCe(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:bCe},357:{},358:{},359:{},360:{T:1},361:{},362:{f:NEe},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,n){var r=e.l+t,i=CCe(e),o=e.read_shift(1),a=[i];if(a[2]=o,n.cellFormula){var s=ZNe(e,r-e.l,n);a[1]=s}else e.l=r;return a}},427:{f:function(e,t,n){var r=e.l+t,i=[ECe(e,16)];if(n.cellFormula){var o=nTe(e,r-e.l,n);i[1]=o,e.l=r}else e.l=r;return i}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return ETe.forEach(function(n){t[n]=TCe(e)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var n=e.l+t,r=ECe(e,16),i=gCe(e),o=iCe(e),a=iCe(e),s=iCe(e);e.l=n;var l={rfx:r,relId:i,loc:o,display:s};return a&&(l.Tooltip=a),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:bCe},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:yNe},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var n=ECe(e,16);return t.rfx=n.s,t.ref=KSe(n.s),e.l+=16,t}},636:{T:-1},637:{f:lCe},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:iCe(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function eAe(e,t,n,r){var i=t;if(!isNaN(i)){var o=r||(n||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,o),o>0&&wSe(n)&&e.push(n)}}function tAe(e,t,n){return e||(e=jSe(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function nAe(e,t,n,r){if(null!=t.v)switch(t.t){case"d":case"n":var i="d"==t.t?Kwe(nxe(t.v)):t.v;return void(i==(0|i)&&i>=0&&i<65536?eAe(e,2,function(e,t,n){var r=jSe(9);return tAe(r,e,t),r.write_shift(2,n),r}(n,r,i)):eAe(e,3,function(e,t,n){var r=jSe(15);return tAe(r,e,t),r.write_shift(8,n,"f"),r}(n,r,i)));case"b":case"e":return void eAe(e,5,function(e,t,n,r){var i=jSe(9);return tAe(i,e,t),lEe(n,r||"b",i),i}(n,r,t.v,t.t));case"s":case"str":return void eAe(e,4,function(e,t,n){var r=jSe(8+2*n.length);return tAe(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}(n,r,(t.v||"").slice(0,255)))}eAe(e,1,tAe(null,n,r))}function rAe(e,t){var n=t||{};for(var r=FSe(),i=0,o=0;o<e.SheetNames.length;++o)e.SheetNames[o]==n.sheet&&(i=o);if(0==i&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return eAe(r,4==n.biff?1033:3==n.biff?521:9,xEe(0,16,n)),function(e,t,n,r){var i,o=Array.isArray(t),a=QSe(t["!ref"]||"A1"),s="",l=[];if(a.e.c>255||a.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=XSe(a)}for(var c=a.s.r;c<=a.e.r;++c){s=USe(c);for(var u=a.s.c;u<=a.e.c;++u){c===a.s.r&&(l[u]=GSe(u)),i=l[u]+s;var d=o?(t[c]||[])[u]:t[i];d&&nAe(e,d,c,u)}}}(r,e.Sheets[e.SheetNames[i]],0,n),eAe(r,10),r.end()}function iAe(e,t,n){eAe(e,49,function(e,t){var n=e.name||"Arial",r=t&&5==t.biff,i=jSe(r?15+n.length:16+2*n.length);return i.write_shift(2,20*(e.sz||12)),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,n.length),r||i.write_shift(1,1),i.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),i}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},n))}function oAe(e,t){if(t){var n=0;t.forEach(function(t,r){++n<=256&&t&&eAe(e,125,function(e,t){var n=jSe(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,256*e.width),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}(uTe(r,t),r))})}}function aAe(e,t,n,r,i){var o=16+hTe(i.cellXfs,t,i);if(null!=t.v||t.bf)if(t.bf)eAe(e,6,QNe(t,n,r,0,o));else switch(t.t){case"d":case"n":eAe(e,515,function(e,t,n,r){var i=jSe(14);return vEe(e,t,r,i),ACe(n,i),i}(n,r,"d"==t.t?Kwe(nxe(t.v)):t.v,o));break;case"b":case"e":eAe(e,517,function(e,t,n,r,i,o){var a=jSe(8);return vEe(e,t,r,a),lEe(n,o,a),a}(n,r,t.v,o,0,t.t));break;case"s":case"str":if(i.bookSST)eAe(e,253,function(e,t,n,r){var i=jSe(10);return vEe(e,t,r,i),i.write_shift(4,n),i}(n,r,cTe(i.Strings,t.v,i.revStrings),o));else eAe(e,516,function(e,t,n,r,i){var o=!i||8==i.biff,a=jSe(+o+8+(1+o)*n.length);return vEe(e,t,r,a),a.write_shift(2,n.length),o&&a.write_shift(1,1),a.write_shift((1+o)*n.length,n,o?"utf16le":"sbcs"),a}(n,r,(t.v||"").slice(0,255),o,i));break;default:eAe(e,513,vEe(n,r,o))}else eAe(e,513,vEe(n,r,o))}function sAe(e,t,n){var r,i=FSe(),o=n.SheetNames[e],a=n.Sheets[o]||{},s=(n||{}).Workbook||{},l=(s.Sheets||[])[e]||{},c=Array.isArray(a),u=8==t.biff,d="",h=[],f=QSe(a["!ref"]||"A1"),m=u?65536:16384;if(f.e.c>255||f.e.r>=m){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,m-1)}eAe(i,2057,xEe(0,16,t)),eAe(i,13,sEe(1)),eAe(i,12,sEe(100)),eAe(i,15,oEe(!0)),eAe(i,17,oEe(!1)),eAe(i,16,ACe(.001)),eAe(i,95,oEe(!0)),eAe(i,42,oEe(!1)),eAe(i,43,oEe(!1)),eAe(i,130,sEe(1)),eAe(i,128,function(e){var t=jSe(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}([0,0])),eAe(i,131,oEe(!1)),eAe(i,132,oEe(!1)),u&&oAe(i,a["!cols"]),eAe(i,512,function(e,t){var n=8!=t.biff&&t.biff?2:4,r=jSe(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}(f,t)),u&&(a["!links"]=[]);for(var p=f.s.r;p<=f.e.r;++p){d=USe(p);for(var g=f.s.c;g<=f.e.c;++g){p===f.s.r&&(h[g]=GSe(g)),r=h[g]+d;var v=c?(a[p]||[])[g]:a[r];v&&(aAe(i,v,p,g,t),u&&v.l&&a["!links"].push([r,v.l]))}}var y=l.CodeName||l.name||o;return u&&eAe(i,574,function(e){var t=jSe(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((s.Views||[])[0])),u&&(a["!merges"]||[]).length&&eAe(i,229,function(e){var t=jSe(2+8*e.length);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)wEe(e[n],t);return t}(a["!merges"])),u&&function(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];eAe(e,440,TEe(r)),r[1].Tooltip&&eAe(e,2048,AEe(r))}delete t["!links"]}(i,a),eAe(i,442,mEe(y)),u&&function(e,t){var n=jSe(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),eAe(e,2151,n),(n=jSe(39)).write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),wEe(QSe(t["!ref"]||"A1"),n),n.write_shift(4,4),eAe(e,2152,n)}(i,a),eAe(i,10),i.end()}function lAe(e,t,n){var r=FSe(),i=(e||{}).Workbook||{},o=i.Sheets||[],a=i.WBProps||{},s=8==n.biff,l=5==n.biff;(eAe(r,2057,xEe(0,5,n)),"xla"==n.bookType&&eAe(r,135),eAe(r,225,s?sEe(1200):null),eAe(r,193,function(e,t){t||(t=jSe(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}(2)),l&&eAe(r,191),l&&eAe(r,192),eAe(r,226),eAe(r,92,function(e,t){var n=!t||8==t.biff,r=jSe(n?112:54);for(r.write_shift(8==t.biff?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}(0,n)),eAe(r,66,sEe(s?1200:1252)),s&&eAe(r,353,sEe(0)),s&&eAe(r,448),eAe(r,317,function(e){for(var t=jSe(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}(e.SheetNames.length)),s&&e.vbaraw&&eAe(r,211),s&&e.vbaraw)&&eAe(r,442,mEe(a.CodeName||"ThisWorkbook"));eAe(r,156,sEe(17)),eAe(r,25,oEe(!1)),eAe(r,18,oEe(!1)),eAe(r,19,sEe(0)),s&&eAe(r,431,oEe(!1)),s&&eAe(r,444,sEe(0)),eAe(r,61,function(){var e=jSe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),eAe(r,64,oEe(!1)),eAe(r,141,sEe(0)),eAe(r,34,oEe("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&wxe(e.Workbook.WBProps.date1904)?"true":"false"}(e))),eAe(r,14,oEe(!0)),s&&eAe(r,439,oEe(!1)),eAe(r,218,sEe(0)),iAe(r,0,n),function(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)null!=t[i]&&eAe(e,1054,CEe(i,t[i],n))})}(r,e.SSF,n),function(e,t){for(var n=0;n<16;++n)eAe(e,224,EEe({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){eAe(e,224,EEe(n,0,t))})}(r,n),s&&eAe(r,352,oEe(!1));var c,u=r.end(),d=FSe();s&&eAe(d,140,(c||(c=jSe(4)),c.write_shift(2,1),c.write_shift(2,1),c)),s&&n.Strings&&function(e,t,n,r){var i=r||(n||[]).length||0;if(i<=8224)return eAe(e,t,n,i);var o=t;if(!isNaN(o)){for(var a=n.parts||[],s=0,l=0,c=0;c+(a[s]||8224)<=8224;)c+=a[s]||8224,s++;var u=e.next(4);for(u.write_shift(2,o),u.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c;l<i;){for((u=e.next(4)).write_shift(2,60),c=0;c+(a[s]||8224)<=8224;)c+=a[s]||8224,s++;u.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c}}}(d,252,function(e){var t=jSe(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],r=0;r<e.length;++r)n[r]=uEe(e[r]);var i=Vbe([t].concat(n));return i.parts=[t.length].concat(n.map(function(e){return e.length})),i}(n.Strings)),eAe(d,10);var h=d.end(),f=FSe(),m=0,p=0;for(p=0;p<e.SheetNames.length;++p)m+=(s?12:11)+(s?2:1)*e.SheetNames[p].length;var g=u.length+m+h.length;for(p=0;p<e.SheetNames.length;++p){eAe(f,133,SEe({pos:g,hs:(o[p]||{}).Hidden||0,dt:0,name:e.SheetNames[p]},n)),g+=t[p].length}var v=f.end();if(m!=v.length)throw new Error("BS8 "+m+" != "+v.length);var y=[];return u.length&&y.push(u),v.length&&y.push(v),h.length&&y.push(h),Vbe(y)}function cAe(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(r&&r["!ref"])$Se(r["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}var i=t||{};switch(i.biff||2){case 8:case 5:return function(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=ixe(twe)),e&&e.SSF&&(jwe(),Pwe(e.SSF),n.revssf=Gwe(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,LAe(n),n.cellXfs=[],hTe(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)r[r.length]=sAe(i,n,e);return r.unshift(lAe(e,r,n)),Vbe(r)}(e,t);case 4:case 3:case 2:return rAe(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function uAe(e,t,n,r){for(var i=e["!merges"]||[],o=[],a=t.s.c;a<=t.e.c;++a){for(var s=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>n||i[c].s.c>a)&&!(i[c].e.r<n||i[c].e.c<a)){if(i[c].s.r<n||i[c].s.c<a){s=-1;break}s=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(s<0)){var u=KSe({r:n,c:a}),d=r.dense?(e[n]||[])[a]:e[u],h=d&&null!=d.v&&(d.h||bxe(d.w||(ZSe(d),d.w)||""))||"",f={};s>1&&(f.rowspan=s),l>1&&(f.colspan=l),r.editable?h='<span contenteditable="true">'+h+"</span>":d&&(f["data-t"]=d&&d.t||"z",null!=d.v&&(f["data-v"]=d.v),null!=d.z&&(f["data-z"]=d.z),d.l&&"#"!=(d.l.Target||"#").charAt(0)&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),f.id=(r.id||"sjs")+"-"+u,o.push(Dxe("td",h,f))}}return"<tr>"+o.join("")+"</tr>"}var dAe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',hAe="</body></html>";function fAe(e,t,n){return[].join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function mAe(e,t){var n=t||{},r=null!=n.header?n.header:dAe,i=null!=n.footer?n.footer:hAe,o=[r],a=$Se(e["!ref"]);n.dense=Array.isArray(e),o.push(fAe(0,0,n));for(var s=a.s.r;s<=a.e.r;++s)o.push(uAe(e,a,s,n));return o.push("</table>"+i),o.join("")}function pAe(e,t,n){var r=n||{};var i=0,o=0;if(null!=r.origin)if("number"==typeof r.origin)i=r.origin;else{var a="string"==typeof r.origin?YSe(r.origin):r.origin;i=a.r,o=a.c}var s=t.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,s.length),c={s:{r:0,c:0},e:{r:i,c:o}};if(e["!ref"]){var u=$Se(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),-1==i&&(c.e.r=i=u.e.r+1)}var d=[],h=0,f=e["!rows"]||(e["!rows"]=[]),m=0,p=0,g=0,v=0,y=0,b=0;for(e["!cols"]||(e["!cols"]=[]);m<s.length&&p<l;++m){var w=s[m];if(vAe(w)){if(r.display)continue;f[p]={hidden:!0}}var x=w.children;for(g=v=0;g<x.length;++g){var S=x[g];if(!r.display||!vAe(S)){var C=S.hasAttribute("data-v")?S.getAttribute("data-v"):S.hasAttribute("v")?S.getAttribute("v"):Axe(S.innerHTML),E=S.getAttribute("data-z")||S.getAttribute("z");for(h=0;h<d.length;++h){var N=d[h];N.s.c==v+o&&N.s.r<p+i&&p+i<=N.e.r&&(v=N.e.c+1-o,h=-1)}b=+S.getAttribute("colspan")||1,((y=+S.getAttribute("rowspan")||1)>1||b>1)&&d.push({s:{r:p+i,c:v+o},e:{r:p+i+(y||1)-1,c:v+o+(b||1)-1}});var T={t:"s",v:C},A=S.getAttribute("data-t")||S.getAttribute("t")||"";null!=C&&(0==C.length?T.t=A||"z":r.raw||0==C.trim().length||"s"==A||("TRUE"===C?T={t:"b",v:!0}:"FALSE"===C?T={t:"b",v:!1}:isNaN(axe(C))?isNaN(lxe(C).getDate())||(T={t:"d",v:nxe(C)},r.cellDates||(T={t:"n",v:Kwe(T.v)}),T.z=r.dateNF||twe[14]):T={t:"n",v:axe(C)})),void 0===T.z&&null!=E&&(T.z=E);var R="",k=S.getElementsByTagName("A");if(k&&k.length)for(var M=0;M<k.length&&(!k[M].hasAttribute("href")||"#"==(R=k[M].getAttribute("href")).charAt(0));++M);R&&"#"!=R.charAt(0)&&(T.l={Target:R}),r.dense?(e[p+i]||(e[p+i]=[]),e[p+i][v+o]=T):e[KSe({c:v+o,r:p+i})]=T,c.e.c<v+o&&(c.e.c=v+o),v+=b}}++p}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,p-1+i),e["!ref"]=XSe(c),p>=l&&(e["!fullref"]=XSe((c.e.r=s.length-m+p-1+i,c))),e}function gAe(e,t){return pAe((t||{}).dense?[]:{},e,t)}function vAe(e){var t="",n=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}var yAe=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Mxe({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return dxe+t}}(),bAe=function(){var e=function(e){return gxe(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t="          <table:table-cell />\n",n=function(n,r,i){var o=[];o.push('      <table:table table:name="'+gxe(r.SheetNames[i])+'" table:style-name="ta1">\n');var a=0,s=0,l=$Se(n["!ref"]||"A1"),c=n["!merges"]||[],u=0,d=Array.isArray(n);if(n["!cols"])for(s=0;s<=l.e.c;++s)o.push("        <table:table-column"+(n["!cols"][s]?' table:style-name="co'+n["!cols"][s].ods+'"':"")+"></table:table-column>\n");var h="",f=n["!rows"]||[];for(a=0;a<l.s.r;++a)h=f[a]?' table:style-name="ro'+f[a].ods+'"':"",o.push("        <table:table-row"+h+"></table:table-row>\n");for(;a<=l.e.r;++a){for(h=f[a]?' table:style-name="ro'+f[a].ods+'"':"",o.push("        <table:table-row"+h+">\n"),s=0;s<l.s.c;++s)o.push(t);for(;s<=l.e.c;++s){var m=!1,p={},g="";for(u=0;u!=c.length;++u)if(!(c[u].s.c>s)&&!(c[u].s.r>a)&&!(c[u].e.c<s)&&!(c[u].e.r<a)){c[u].s.c==s&&c[u].s.r==a||(m=!0),p["table:number-columns-spanned"]=c[u].e.c-c[u].s.c+1,p["table:number-rows-spanned"]=c[u].e.r-c[u].s.r+1;break}if(m)o.push("          <table:covered-table-cell/>\n");else{var v=KSe({r:a,c:s}),y=d?(n[a]||[])[s]:n[v];if(y&&y.f&&(p["table:formula"]=gxe(aTe(y.f)),y.F&&y.F.slice(0,v.length)==v)){var b=$Se(y.F);p["table:number-matrix-columns-spanned"]=b.e.c-b.s.c+1,p["table:number-matrix-rows-spanned"]=b.e.r-b.s.r+1}if(y){switch(y.t){case"b":g=y.v?"TRUE":"FALSE",p["office:value-type"]="boolean",p["office:boolean-value"]=y.v?"true":"false";break;case"n":g=y.w||String(y.v||0),p["office:value-type"]="float",p["office:value"]=y.v||0;break;case"s":case"str":g=null==y.v?"":y.v,p["office:value-type"]="string";break;case"d":g=y.w||nxe(y.v).toISOString(),p["office:value-type"]="date",p["office:date-value"]=nxe(y.v).toISOString(),p["table:style-name"]="ce1";break;default:o.push(t);continue}var w=e(g);if(y.l&&y.l.Target){var x=y.l.Target;"#"==(x="#"==x.charAt(0)?"#"+sTe(x.slice(1)):x).charAt(0)||x.match(/^\w+:/)||(x="../"+x),w=Dxe("text:a",w,{"xlink:href":x.replace(/&/g,"&amp;")})}o.push("          "+Dxe("table:table-cell",Dxe("text:p",w,{}),p)+"\n")}else o.push(t)}}o.push("        </table:table-row>\n")}return o.push("      </table:table>\n"),o.join("")};return function(e,t){var r=[dxe],i=Mxe({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),o=Mxe({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?(r.push("<office:document"+i+o+">\n"),r.push(UCe().replace(/office:document-meta/g,"office:meta"))):r.push("<office:document-content"+i+">\n"),function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var n=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!cols"])for(var r=0;r<t["!cols"].length;++r)if(t["!cols"][r]){var i=t["!cols"][r];if(null==i.width&&null==i.wpx&&null==i.wch)continue;YEe(i),i.ods=n;var o=t["!cols"][r].wpx+"px";e.push('  <style:style style:name="co'+n+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+o+'"/>\n'),e.push("  </style:style>\n"),++n}});var r=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!rows"])for(var n=0;n<t["!rows"].length;++n)if(t["!rows"][n]){t["!rows"][n].ods=r;var i=t["!rows"][n].hpx+"px";e.push('  <style:style style:name="ro'+r+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+i+'"/>\n'),e.push("  </style:style>\n"),++r}}),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(r,e),r.push("  <office:body>\n"),r.push("    <office:spreadsheet>\n");for(var a=0;a!=e.SheetNames.length;++a)r.push(n(e.Sheets[e.SheetNames[a]],e,a));return r.push("    </office:spreadsheet>\n"),r.push("  </office:body>\n"),"fods"==t.bookType?r.push("</office:document>"):r.push("</office:document-content>"),r.join("")}}();function wAe(e,t){if("fods"==t.bookType)return bAe(e,t);var n=uxe(),r="",i=[],o=[];return cxe(n,r="mimetype","application/vnd.oasis.opendocument.spreadsheet"),cxe(n,r="content.xml",bAe(e,t)),i.push([r,"text/xml"]),o.push([r,"ContentFile"]),cxe(n,r="styles.xml",yAe(e,t)),i.push([r,"text/xml"]),o.push([r,"StylesFile"]),cxe(n,r="meta.xml",dxe+UCe()),i.push([r,"text/xml"]),o.push([r,"MetadataFile"]),cxe(n,r="manifest.rdf",function(e){var t=[dxe];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var n=0;n!=e.length;++n)t.push(WCe(e[n][0],e[n][1])),t.push(VCe("",e[n][0]));return t.push(WCe("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(o)),i.push([r,"application/rdf+xml"]),cxe(n,r="META-INF/manifest.xml",function(e){var t=[dxe];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(i)),n}function xAe(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function SAe(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):Bbe(Txe(e))}function CAe(e){var t=e.reduce(function(e,t){return e+t.length},0),n=new Uint8Array(t),r=0;return e.forEach(function(e){n.set(e,r),r+=e.length}),n}function EAe(e,t){var n=t?t[0]:0,r=127&e[n];e:if(e[n++]>=128){if(r|=(127&e[n])<<7,e[n++]<128)break e;if(r|=(127&e[n])<<14,e[n++]<128)break e;if(r|=(127&e[n])<<21,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,28),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,35),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,42),++n,e[n++]<128)break e}return t&&(t[0]=n),r}function NAe(e){var t=new Uint8Array(7);t[0]=127&e;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383)break e;if(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)break e;if(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)break e;if(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)break e;if(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103)break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function TAe(e){var t=0,n=127&e[t];e:if(e[t++]>=128){if(n|=(127&e[t])<<7,e[t++]<128)break e;if(n|=(127&e[t])<<14,e[t++]<128)break e;if(n|=(127&e[t])<<21,e[t++]<128)break e;n|=(127&e[t])<<28}return n}function AAe(e){for(var t=[],n=[0];n[0]<e.length;){var r,i=n[0],o=EAe(e,n),a=7&o,s=0;if(0==(o=Math.floor(o/8)))break;switch(a){case 0:for(var l=n[0];e[n[0]++]>=128;);r=e.slice(l,n[0]);break;case 5:s=4,r=e.slice(n[0],n[0]+s),n[0]+=s;break;case 1:s=8,r=e.slice(n[0],n[0]+s),n[0]+=s;break;case 2:s=EAe(e,n),r=e.slice(n[0],n[0]+s),n[0]+=s;break;default:throw new Error("PB Type ".concat(a," for Field ").concat(o," at offset ").concat(i))}var c={data:r,type:a};null==t[o]?t[o]=[c]:t[o].push(c)}return t}function RAe(e){var t=[];return e.forEach(function(e,n){e.forEach(function(e){e.data&&(t.push(NAe(8*n+e.type)),2==e.type&&t.push(NAe(e.data.length)),t.push(e.data))})}),CAe(t)}function kAe(e){for(var t,n=[],r=[0];r[0]<e.length;){var i=EAe(e,r),o=AAe(e.slice(r[0],r[0]+i));r[0]+=i;var a={id:TAe(o[1][0].data),messages:[]};o[2].forEach(function(t){var n=AAe(t.data),i=TAe(n[3][0].data);a.messages.push({meta:n,data:e.slice(r[0],r[0]+i)}),r[0]+=i}),(null==(t=o[3])?void 0:t[0])&&(a.merge=TAe(o[3][0].data)>>>0>0),n.push(a)}return n}function MAe(e){var t=[];return e.forEach(function(e){var n=[];n[1]=[{data:NAe(e.id),type:0}],n[2]=[],null!=e.merge&&(n[3]=[{data:NAe(+!!e.merge),type:0}]);var r=[];e.messages.forEach(function(e){r.push(e.data),e.meta[3]=[{type:0,data:NAe(e.data.length)}],n[2].push({data:RAe(e.meta),type:2})});var i=RAe(n);t.push(NAe(i.length)),t.push(i),r.forEach(function(e){return t.push(e)})}),CAe(t)}function DAe(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=EAe(t,n),i=[];n[0]<t.length;){var o=3&t[n[0]];if(0!=o){var a=0,s=0;if(1==o?(s=4+(t[n[0]]>>2&7),a=(224&t[n[0]++])<<3,a|=t[n[0]++]):(s=1+(t[n[0]++]>>2),2==o?(a=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(a=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),i=[CAe(i)],0==a)throw new Error("Invalid offset 0");if(a>i[0].length)throw new Error("Invalid offset beyond length");if(s>=a)for(i.push(i[0].slice(-a)),s-=a;s>=i[i.length-1].length;)i.push(i[i.length-1]),s-=i[i.length-1].length;i.push(i[0].slice(-a,-a+s))}else{var l=t[n[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[n[0]],c>1&&(l|=t[n[0]+1]<<8),c>2&&(l|=t[n[0]+2]<<16),c>3&&(l|=t[n[0]+3]<<24),l>>>=0,l++,n[0]+=c}i.push(t.slice(n[0],n[0]+l)),n[0]+=l}}var u=CAe(i);if(u.length!=r)throw new Error("Unexpected length: ".concat(u.length," != ").concat(r));return u}function _Ae(e){for(var t=[],n=0;n<e.length;){var r=e[n++],i=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(DAe(r,e.slice(n,n+i))),n+=i}if(n!==e.length)throw new Error("data is not a valid framed stream!");return CAe(t)}function OAe(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),i=new Uint8Array(4);t.push(i);var o=NAe(r),a=o.length;t.push(o),r<=60?(a++,t.push(new Uint8Array([r-1<<2]))):r<=256?(a+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(a+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(a+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(a+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),a+=r,i[0]=0,i[1]=255&a,i[2]=a>>8&255,i[3]=a>>16&255,n+=r}return CAe(t)}function IAe(e,t){var n=new Uint8Array(32),r=xAe(n),i=12,o=0;switch(n[0]=5,e.t){case"n":n[1]=2,function(e,t,n){var r=Math.floor(0==n?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,i=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(127&r)<<1;for(var o=0;i>=1;++o,i/=256)e[t+o]=255&i;e[t+15]|=n>=0?0:128}(n,i,e.v),o|=1,i+=16;break;case"b":n[1]=6,r.setFloat64(i,e.v?1:0,!0),o|=2,i+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(i,t.indexOf(e.v),!0),o|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,o,!0),n.slice(0,i)}function PAe(e,t){var n=new Uint8Array(32),r=xAe(n),i=12,o=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(i,e.v,!0),o|=32,i+=8;break;case"b":n[2]=6,r.setFloat64(i,e.v?1:0,!0),o|=32,i+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(i,t.indexOf(e.v),!0),o|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,o,!0),n.slice(0,i)}function jAe(e){return EAe(AAe(e)[1][0].data)}function FAe(e,t,n){var r,i,o,a;if(!(null==(r=e[6])?void 0:r[0])||!(null==(i=e[7])?void 0:i[0]))throw"Mutation only works on post-BNC storages!";if((null==(a=null==(o=e[8])?void 0:o[0])?void 0:a.data)&&TAe(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var s=0,l=xAe(e[7][0].data),c=0,u=[],d=xAe(e[4][0].data),h=0,f=[],m=0;m<t.length;++m)if(null!=t[m]){var p,g;switch(l.setUint16(2*m,c,!0),d.setUint16(2*m,h,!0),typeof t[m]){case"string":p=IAe({t:"s",v:t[m]},n),g=PAe({t:"s",v:t[m]},n);break;case"number":p=IAe({t:"n",v:t[m]},n),g=PAe({t:"n",v:t[m]},n);break;case"boolean":p=IAe({t:"b",v:t[m]},n),g=PAe({t:"b",v:t[m]},n);break;default:throw new Error("Unsupported value "+t[m])}u.push(p),c+=p.length,f.push(g),h+=g.length,++s}else l.setUint16(2*m,65535,!0),d.setUint16(2*m,65535);for(e[2][0].data=NAe(s);m<e[7][0].data.length/2;++m)l.setUint16(2*m,65535,!0),d.setUint16(2*m,65535,!0);return e[6][0].data=CAe(u),e[3][0].data=CAe(f),s}function HAe(e){return function(t){for(var n=0;n!=e.length;++n){var r=e[n];void 0===t[r[0]]&&(t[r[0]]=r[1]),"n"===r[2]&&(t[r[0]]=Number(t[r[0]]))}}}function LAe(e){HAe([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function BAe(e,t){return"ods"==t.bookType?wAe(e,t):"numbers"==t.bookType?function(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=$Se(n["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(XSe(r)));var o=XAe(n,{range:r,header:1}),a=["~Sh33tJ5~"];o.forEach(function(e){return e.forEach(function(e){"string"==typeof e&&a.push(e)})});var s={},l=[],c=Lwe.read(t.numbers,{type:"base64"});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0],n=e[1];2==t.type&&t.name.match(/\.iwa/)&&kAe(_Ae(t.content)).forEach(function(e){l.push(e.id),s[e.id]={deps:[],location:n,type:TAe(e.messages[0].meta[1][0].data)}})}),l.sort(function(e,t){return e-t});var u=l.filter(function(e){return e>1}).map(function(e){return[e,NAe(e)]});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&kAe(_Ae(t.content)).forEach(function(e){e.messages.forEach(function(t){u.forEach(function(t){e.messages.some(function(e){return 11006!=TAe(e.meta[1][0].data)&&function(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}(e.data,t[1])})&&s[t[0]].deps.push(e.id)})})})});for(var d,h=Lwe.find(c,s[1].location),f=kAe(_Ae(h.content)),m=0;m<f.length;++m){var p=f[m];1==p.id&&(d=p)}var g=jAe(AAe(d.messages[0].data)[1][0].data);for(f=kAe(_Ae((h=Lwe.find(c,s[g].location)).content)),m=0;m<f.length;++m)(p=f[m]).id==g&&(d=p);for(g=jAe(AAe(d.messages[0].data)[2][0].data),f=kAe(_Ae((h=Lwe.find(c,s[g].location)).content)),m=0;m<f.length;++m)(p=f[m]).id==g&&(d=p);for(g=jAe(AAe(d.messages[0].data)[2][0].data),f=kAe(_Ae((h=Lwe.find(c,s[g].location)).content)),m=0;m<f.length;++m)(p=f[m]).id==g&&(d=p);var v=AAe(d.messages[0].data);v[6][0].data=NAe(r.e.r+1),v[7][0].data=NAe(r.e.c+1);for(var y=jAe(v[46][0].data),b=Lwe.find(c,s[y].location),w=kAe(_Ae(b.content)),x=0;x<w.length&&w[x].id!=y;++x);if(w[x].id!=y)throw"Bad ColumnRowUIDMapArchive";var S=AAe(w[x].messages[0].data);S[1]=[],S[2]=[],S[3]=[];for(var C=0;C<=r.e.c;++C){var E=[];E[1]=E[2]=[{type:0,data:NAe(C+420690)}],S[1].push({type:2,data:RAe(E)}),S[2].push({type:0,data:NAe(C)}),S[3].push({type:0,data:NAe(C)})}S[4]=[],S[5]=[],S[6]=[];for(var N=0;N<=r.e.r;++N)(E=[])[1]=E[2]=[{type:0,data:NAe(N+726270)}],S[4].push({type:2,data:RAe(E)}),S[5].push({type:0,data:NAe(N)}),S[6].push({type:0,data:NAe(N)});w[x].messages[0].data=RAe(S),b.content=OAe(MAe(w)),b.size=b.content.length,delete v[46];var T=AAe(v[4][0].data);T[7][0].data=NAe(r.e.r+1);var A=jAe(AAe(T[1][0].data)[2][0].data);if((w=kAe(_Ae((b=Lwe.find(c,s[A].location)).content)))[0].id!=A)throw"Bad HeaderStorageBucket";var R=AAe(w[0].messages[0].data);for(N=0;N<o.length;++N){var k=AAe(R[2][0].data);k[1][0].data=NAe(N),k[4][0].data=NAe(o[N].length),R[2][N]={type:R[2][0].type,data:RAe(k)}}w[0].messages[0].data=RAe(R),b.content=OAe(MAe(w)),b.size=b.content.length;var M=jAe(T[2][0].data);if((w=kAe(_Ae((b=Lwe.find(c,s[M].location)).content)))[0].id!=M)throw"Bad HeaderStorageBucket";for(R=AAe(w[0].messages[0].data),C=0;C<=r.e.c;++C)(k=AAe(R[2][0].data))[1][0].data=NAe(C),k[4][0].data=NAe(r.e.r+1),R[2][C]={type:R[2][0].type,data:RAe(k)};w[0].messages[0].data=RAe(R),b.content=OAe(MAe(w)),b.size=b.content.length;var D=jAe(T[4][0].data);!function(){for(var e,t=Lwe.find(c,s[D].location),n=kAe(_Ae(t.content)),r=0;r<n.length;++r){var i=n[r];i.id==D&&(e=i)}var o=AAe(e.messages[0].data);o[3]=[];var l=[];a.forEach(function(e,t){l[1]=[{type:0,data:NAe(t)}],l[2]=[{type:0,data:NAe(1)}],l[3]=[{type:2,data:SAe(e)}],o[3].push({type:2,data:RAe(l)})}),e.messages[0].data=RAe(o);var u=OAe(MAe(n));t.content=u,t.size=t.content.length}();var _=AAe(T[3][0].data),O=_[1][0];delete _[2];var I=AAe(O.data),P=jAe(I[2][0].data);!function(){for(var e,t=Lwe.find(c,s[P].location),n=kAe(_Ae(t.content)),i=0;i<n.length;++i){var l=n[i];l.id==P&&(e=l)}var u=AAe(e.messages[0].data);delete u[6],delete _[7];var d=new Uint8Array(u[5][0].data);u[5]=[];for(var h=0,f=0;f<=r.e.r;++f){var m=AAe(d);h+=FAe(m,o[f],a),m[1][0].data=NAe(f),u[5].push({data:RAe(m),type:2})}u[1]=[{type:0,data:NAe(r.e.c+1)}],u[2]=[{type:0,data:NAe(r.e.r+1)}],u[3]=[{type:0,data:NAe(h)}],u[4]=[{type:0,data:NAe(r.e.r+1)}],e.messages[0].data=RAe(u);var p=OAe(MAe(n));t.content=p,t.size=t.content.length}(),O.data=RAe(I),T[3][0].data=RAe(_),v[4][0].data=RAe(T),d.messages[0].data=RAe(v);var j=OAe(MAe(f));return h.content=j,h.size=h.content.length,c}(e,t):"xlsb"==t.bookType?function(e,t){mNe=1024,e&&!e.SSF&&(e.SSF=ixe(twe));e&&e.SSF&&(jwe(),Pwe(e.SSF),t.revssf=Gwe(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,lTe?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xlsb"==t.bookType?"bin":"xml",r=wNe.indexOf(t.bookType)>-1,i={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};LAe(t=t||{});var o=uxe(),a="",s=0;t.cellXfs=[],hTe(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(cxe(o,a="docProps/core.xml",YCe(e.Props,t)),i.coreprops.push(a),zCe(t.rels,2,a,HCe.CORE_PROPS),a="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,cxe(o,a,XCe(e.Props)),i.extprops.push(a),zCe(t.rels,3,a,HCe.EXT_PROPS),e.Custprops!==e.Props&&Vwe(e.Custprops||{}).length>0&&(cxe(o,a="docProps/custom.xml",QCe(e.Custprops)),i.custprops.push(a),zCe(t.rels,4,a,HCe.CUST_PROPS));for(s=1;s<=e.SheetNames.length;++s){var u={"!id":{}},d=e.Sheets[e.SheetNames[s-1]];(d||{})["!type"];if(cxe(o,a="xl/worksheets/sheet"+s+"."+n,zTe(s-1,a,t,e,u)),i.sheets.push(a),zCe(t.wbrels,-1,"worksheets/sheet"+s+"."+n,HCe.WS[0]),d){var h=d["!comments"],f=!1,m="";h&&h.length>0&&(cxe(o,m="xl/comments"+s+"."+n,WTe(h,m,t)),i.comments.push(m),zCe(u,-1,"../comments"+s+"."+n,HCe.CMNT),f=!0),d["!legacy"]&&f&&cxe(o,"xl/drawings/vmlDrawing"+s+".vml",pNe(s,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&cxe(o,LCe(a),BCe(u))}null!=t.Strings&&t.Strings.length>0&&(cxe(o,a="xl/sharedStrings."+n,function(e,t,n){return(".bin"===t.slice(-4)?HEe:jEe)(e,n)}(t.Strings,a,t)),i.strs.push(a),zCe(t.wbrels,-1,"sharedStrings."+n,HCe.SST));cxe(o,a="xl/workbook."+n,function(e,t,n){return(".bin"===t.slice(-4)?BTe:FTe)(e,n)}(e,a,t)),i.workbooks.push(a),zCe(t.rels,1,a,HCe.WB),cxe(o,a="xl/theme/theme1.xml",dNe(e.Themes,t)),i.themes.push(a),zCe(t.wbrels,-1,"theme/theme1.xml",HCe.THEME),cxe(o,a="xl/styles."+n,function(e,t,n){return(".bin"===t.slice(-4)?uNe:QEe)(e,n)}(e,a,t)),i.styles.push(a),zCe(t.wbrels,-1,"styles."+n,HCe.STY),e.vbaraw&&r&&(cxe(o,a="xl/vbaProject.bin",e.vbaraw),i.vba.push(a),zCe(t.wbrels,-1,"vbaProject.bin",HCe.VBA));return cxe(o,a="xl/metadata."+n,function(e){return(".bin"===e.slice(-4)?hNe:fNe)()}(a)),i.metadata.push(a),zCe(t.wbrels,-1,"metadata."+n,HCe.XLMETA),cxe(o,"[Content_Types].xml",FCe(i,t)),cxe(o,"_rels/.rels",BCe(t.rels)),cxe(o,"xl/_rels/workbook."+n+".rels",BCe(t.wbrels)),delete t.revssf,delete t.ssf,o}(e,t):zAe(e,t)}function zAe(e,t){mNe=1024,e&&!e.SSF&&(e.SSF=ixe(twe)),e&&e.SSF&&(jwe(),Pwe(e.SSF),t.revssf=Gwe(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,lTe?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=wNe.indexOf(t.bookType)>-1,i={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};LAe(t=t||{});var o=uxe(),a="",s=0;if(t.cellXfs=[],hTe(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),cxe(o,a="docProps/core.xml",YCe(e.Props,t)),i.coreprops.push(a),zCe(t.rels,2,a,HCe.CORE_PROPS),a="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,cxe(o,a,XCe(e.Props)),i.extprops.push(a),zCe(t.rels,3,a,HCe.EXT_PROPS),e.Custprops!==e.Props&&Vwe(e.Custprops||{}).length>0&&(cxe(o,a="docProps/custom.xml",QCe(e.Custprops)),i.custprops.push(a),zCe(t.rels,4,a,HCe.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,s=1;s<=e.SheetNames.length;++s){var d={"!id":{}},h=e.Sheets[e.SheetNames[s-1]];(h||{})["!type"];if(cxe(o,a="xl/worksheets/sheet"+s+"."+n,vTe(s-1,t,e,d)),i.sheets.push(a),zCe(t.wbrels,-1,"worksheets/sheet"+s+"."+n,HCe.WS[0]),h){var f=h["!comments"],m=!1,p="";if(f&&f.length>0){var g=!1;f.forEach(function(e){e[1].forEach(function(e){1==e.T&&(g=!0)})}),g&&(cxe(o,p="xl/threadedComments/threadedComment"+s+"."+n,vNe(f,u,t)),i.threadedcomments.push(p),zCe(d,-1,"../threadedComments/threadedComment"+s+"."+n,HCe.TCMNT)),cxe(o,p="xl/comments"+s+"."+n,gNe(f)),i.comments.push(p),zCe(d,-1,"../comments"+s+"."+n,HCe.CMNT),m=!0}h["!legacy"]&&m&&cxe(o,"xl/drawings/vmlDrawing"+s+".vml",pNe(s,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&cxe(o,LCe(a),BCe(d))}return null!=t.Strings&&t.Strings.length>0&&(cxe(o,a="xl/sharedStrings."+n,jEe(t.Strings,t)),i.strs.push(a),zCe(t.wbrels,-1,"sharedStrings."+n,HCe.SST)),cxe(o,a="xl/workbook."+n,FTe(e)),i.workbooks.push(a),zCe(t.rels,1,a,HCe.WB),cxe(o,a="xl/theme/theme1.xml",dNe(e.Themes,t)),i.themes.push(a),zCe(t.wbrels,-1,"theme/theme1.xml",HCe.THEME),cxe(o,a="xl/styles."+n,QEe(e,t)),i.styles.push(a),zCe(t.wbrels,-1,"styles."+n,HCe.STY),e.vbaraw&&r&&(cxe(o,a="xl/vbaProject.bin",e.vbaraw),i.vba.push(a),zCe(t.wbrels,-1,"vbaProject.bin",HCe.VBA)),cxe(o,a="xl/metadata."+n,fNe()),i.metadata.push(a),zCe(t.wbrels,-1,"metadata."+n,HCe.XLMETA),u.length>1&&(cxe(o,a="xl/persons/person.xml",function(e){var t=[dxe,Dxe("personList",null,{xmlns:Hxe,"xmlns:x":Gxe[0]}).replace(/[\/]>/,">")];return e.forEach(function(e,n){t.push(Dxe("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}(u)),i.people.push(a),zCe(t.wbrels,-1,"persons/person.xml",HCe.PEOPLE)),cxe(o,"[Content_Types].xml",FCe(i,t)),cxe(o,"_rels/.rels",BCe(t.rels)),cxe(o,"xl/_rels/workbook.xml.rels",BCe(t.wbrels)),delete t.revssf,delete t.ssf,o}function WAe(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=Pbe(e.slice(0,12));break;case"binary":n=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function VAe(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Wwe(t.file,Lwe.write(e,{type:jbe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Lwe.write(e,t)}function UAe(e,t){var n={},r=jbe?"nodebuffer":"undefined"!==typeof Uint8Array?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Lwe.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if("undefined"!==typeof Deno&&"string"==typeof i){if("binary"==t.type||"base64"==t.type)return i;i=new Uint8Array(zbe(i))}return t.password&&"undefined"!==typeof encrypt_agile?VAe(encrypt_agile(i,t.password),t):"file"===t.type?Wwe(t.file,i):"string"==t.type?Nxe(i):i}function qAe(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return Ibe(Txe(r));case"binary":return Txe(r);case"string":return e;case"file":return Wwe(t.file,r,"utf8");case"buffer":return jbe?Fbe(r,"utf8"):"undefined"!==typeof TextEncoder?(new TextEncoder).encode(r):qAe(r,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function GAe(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return"base64"==t.type?Ibe(n):"string"==t.type?Nxe(n):n;case"file":return Wwe(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function YAe(e,t){Rbe(),jTe(e);var n=ixe(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),"array"==n.type){n.type="binary";var r=YAe(e,n);return n.type="array",zbe(r)}var i=0;if(n.sheet&&(i="number"==typeof n.sheet?n.sheet:e.SheetNames.indexOf(n.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return qAe(KTe(e,n),n);case"slk":case"sylk":return qAe(MEe.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"htm":case"html":return qAe(mAe(e.Sheets[e.SheetNames[i]],n),n);case"txt":return function(e,t){switch(t.type){case"base64":return Ibe(e);case"binary":case"string":return e;case"file":return Wwe(t.file,e,"binary");case"buffer":return jbe?Fbe(e,"binary"):e.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}(eRe(e.Sheets[e.SheetNames[i]],n),n);case"csv":return qAe(ZAe(e.Sheets[e.SheetNames[i]],n),n,"\ufeff");case"dif":return qAe(DEe.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"dbf":return GAe(kEe.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"prn":return qAe(OEe.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"rtf":return qAe(zEe.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"eth":return qAe(_Ee.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"fods":return qAe(wAe(e,n),n);case"wk1":return GAe(IEe.sheet_to_wk1(e.Sheets[e.SheetNames[i]],n),n);case"wk3":return GAe(IEe.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),GAe(cAe(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),function(e,t){var n=t||{};return VAe(JTe(e,n),n)}(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,t){var n=ixe(t||{});return UAe(BAe(e,n),n)}(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function KAe(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}function $Ae(e,t,n,r,i,o,a,s){var l=USe(n),c=s.defval,u=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),d=!0,h=1===i?[]:{};if(1!==i)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:n,enumerable:!1})}catch(qb){h.__rowNum__=n}else h.__rowNum__=n;if(!a||e[n])for(var f=t.s.c;f<=t.e.c;++f){var m=a?e[n][f]:e[r[f]+l];if(void 0!==m&&void 0!==m.t){var p=m.v;switch(m.t){case"z":if(null==p)break;continue;case"e":p=0==p?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(null!=o[f]){if(null==p)if("e"==m.t&&null===p)h[o[f]]=null;else if(void 0!==c)h[o[f]]=c;else{if(!u||null!==p)continue;h[o[f]]=null}else h[o[f]]=u&&("n"!==m.t||"n"===m.t&&!1!==s.rawNumbers)?p:ZSe(m,p,s);null!=p&&(d=!1)}}else{if(void 0===c)continue;null!=o[f]&&(h[o[f]]=c)}}return{row:h,isempty:d}}function XAe(e,t){if(null==e||null==e["!ref"])return[];var n={t:"n",v:0},r=0,i=1,o=[],a=0,s="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=null!=c.range?c.range:e["!ref"];switch(1===c.header?r=1:"A"===c.header?r=2:Array.isArray(c.header)?r=3:null==c.header&&(r=0),typeof u){case"string":l=QSe(u);break;case"number":(l=QSe(e["!ref"])).s.r=u;break;default:l=u}r>0&&(i=0);var d=USe(l.s.r),h=[],f=[],m=0,p=0,g=Array.isArray(e),v=l.s.r,y=0,b={};g&&!e[v]&&(e[v]=[]);var w=c.skipHidden&&e["!cols"]||[],x=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(w[y]||{}).hidden)switch(h[y]=GSe(y),n=g?e[v][y]:e[h[y]+d],r){case 1:o[y]=y-l.s.c;break;case 2:o[y]=h[y];break;case 3:o[y]=c.header[y-l.s.c];break;default:if(null==n&&(n={w:"__EMPTY",t:"s"}),s=a=ZSe(n,null,c),p=b[a]||0){do{s=a+"_"+p++}while(b[s]);b[a]=p,b[s]=1}else b[a]=1;o[y]=s}for(v=l.s.r+i;v<=l.e.r;++v)if(!(x[v]||{}).hidden){var S=$Ae(e,l,v,h,r,o,g,c);(!1===S.isempty||(1===r?!1!==c.blankrows:c.blankrows))&&(f[m++]=S.row)}return f.length=m,f}var QAe=/"/g;function JAe(e,t,n,r,i,o,a,s){for(var l=!0,c=[],u="",d=USe(n),h=t.s.c;h<=t.e.c;++h)if(r[h]){var f=s.dense?(e[n]||[])[h]:e[r[h]+d];if(null==f)u="";else if(null!=f.v){l=!1,u=""+(s.rawNumbers&&"n"==f.t?f.v:ZSe(f,null,s));for(var m=0,p=0;m!==u.length;++m)if((p=u.charCodeAt(m))===i||p===o||34===p||s.forceQuotes){u='"'+u.replace(QAe,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==f.f||f.F?u="":(l=!1,(u="="+f.f).indexOf(",")>=0&&(u='"'+u.replace(QAe,'""')+'"'));c.push(u)}return!1===s.blankrows&&l?null:c.join(a)}function ZAe(e,t){var n=[],r=null==t?{}:t;if(null==e||null==e["!ref"])return"";var i=QSe(e["!ref"]),o=void 0!==r.FS?r.FS:",",a=o.charCodeAt(0),s=void 0!==r.RS?r.RS:"\n",l=s.charCodeAt(0),c=new RegExp(("|"==o?"\\|":o)+"+$"),u="",d=[];r.dense=Array.isArray(e);for(var h=r.skipHidden&&e["!cols"]||[],f=r.skipHidden&&e["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(h[m]||{}).hidden||(d[m]=GSe(m));for(var p=0,g=i.s.r;g<=i.e.r;++g)(f[g]||{}).hidden||null!=(u=JAe(e,i,g,d,a,l,o,r))&&(r.strip&&(u=u.replace(c,"")),(u||!1!==r.blankrows)&&n.push((p++?s:"")+u));return delete r.dense,n.join("")}function eRe(e,t){t||(t={}),t.FS="\t",t.RS="\n";var n=ZAe(e,t);if("undefined"==typeof Mbe||"string"==t.type)return n;var r=Mbe.utils.encode(1200,n,"str");return String.fromCharCode(255)+String.fromCharCode(254)+r}function tRe(e,t,n){var r,i=n||{},o=+!i.skipHeader,a=e||{},s=0,l=0;if(a&&null!=i.origin)if("number"==typeof i.origin)s=i.origin;else{var c="string"==typeof i.origin?YSe(i.origin):i.origin;s=c.r,l=c.c}var u={s:{c:0,r:0},e:{c:l,r:s+t.length-1+o}};if(a["!ref"]){var d=QSe(a["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),-1==s&&(s=d.e.r+1,u.e.r=s+t.length-1+o)}else-1==s&&(s=0,u.e.r=t.length-1+o);var h=i.header||[],f=0;t.forEach(function(e,t){Vwe(e).forEach(function(n){-1==(f=h.indexOf(n))&&(h[f=h.length]=n);var c=e[n],u="z",d="",m=KSe({c:l+f,r:s+t+o});r=nRe(a,m),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?u="n":"boolean"==typeof c?u="b":"string"==typeof c?u="s":c instanceof Date?(u="d",i.cellDates||(u="n",c=Kwe(c)),d=i.dateNF||twe[14]):null===c&&i.nullError&&(u="e",c=0),r?(r.t=u,r.v=c,delete r.w,delete r.R,d&&(r.z=d)):a[m]=r={t:u,v:c},d&&(r.z=d)):a[m]=c})}),u.e.c=Math.max(u.e.c,l+h.length-1);var m=USe(s);if(o)for(f=0;f<h.length;++f)a[GSe(f+l)+m]={t:"s",v:h[f]};return a["!ref"]=XSe(u),a}function nRe(e,t,n){if("string"==typeof t){if(Array.isArray(e)){var r=YSe(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return nRe(e,KSe("number"!=typeof t?t:{r:t,c:n||0}))}function rRe(){return{SheetNames:[],Sheets:{}}}function iRe(e,t,n,r){var i=1;if(!n)for(;i<=65535&&-1!=e.SheetNames.indexOf(n="Sheet"+i);++i,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var o=n.match(/(^.*?)(\d+)$/);i=o&&+o[2]||0;var a=o&&o[1]||n;for(++i;i<=65535&&-1!=e.SheetNames.indexOf(n=a+i);++i);}if(PTe(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function oRe(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}var aRe={encode_col:GSe,encode_row:USe,encode_cell:KSe,encode_range:XSe,decode_col:qSe,decode_row:VSe,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:YSe,decode_range:$Se,format_cell:ZSe,sheet_add_aoa:tCe,sheet_add_json:tRe,sheet_add_dom:pAe,aoa_to_sheet:nCe,json_to_sheet:function(e,t){return tRe(null,e,t)},table_to_sheet:gAe,table_to_book:function(e,t){return eCe(gAe(e,t),t)},sheet_to_csv:ZAe,sheet_to_txt:eRe,sheet_to_json:XAe,sheet_to_html:mAe,sheet_to_formulae:function(e){var t,n="",r="";if(null==e||null==e["!ref"])return[];var i,o=QSe(e["!ref"]),a="",s=[],l=[],c=Array.isArray(e);for(i=o.s.c;i<=o.e.c;++i)s[i]=GSe(i);for(var u=o.s.r;u<=o.e.r;++u)for(a=USe(u),i=o.s.c;i<=o.e.c;++i)if(n=s[i]+a,r="",void 0!==(t=c?(e[u]||[])[i]:e[n])){if(null!=t.F){if(n=t.F,!t.f)continue;r=t.f,-1==n.indexOf(":")&&(n=n+":"+n)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=n+"="+r}return l},sheet_to_row_object_array:XAe,sheet_get_cell:nRe,book_new:rRe,book_append_sheet:iRe,book_set_sheet_visibility:function(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:oRe,cell_set_internal_link:function(e,t,n){return oRe(e,"#"+t,n)},cell_add_comment:function(e,t,n){e.c||(e.c=[]),e.c.push({t:t,a:n||"SheetJS"})},sheet_set_array_formula:function(e,t,n,r){for(var i="string"!=typeof t?t:QSe(t),o="string"==typeof t?t:XSe(t),a=i.s.r;a<=i.e.r;++a)for(var s=i.s.c;s<=i.e.c;++s){var l=nRe(e,a,s);l.t="n",l.F=o,delete l.v,a==i.s.r&&s==i.s.c&&(l.f=n,r&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};xbe.version;const sRe=e=>{let{data:t,columns:n,description:r,fileName:i="ExportedData.xlsx"}=e;return(0,Bt.jsx)("button",{onClick:()=>{const e=[];e.push({[n[0]]:r}),e.push(Object.fromEntries(n.map(e=>[e,e]))),t.forEach(t=>{const r={};n.forEach(e=>{r[e]=void 0!==t[e]?t[e]:""}),e.push(r)});const o=aRe.json_to_sheet(e,{skipHeader:!0}),a=aRe.decode_range(o["!ref"]);for(let t=a.s.c;t<=a.e.c;++t){const e=aRe.encode_cell({r:1,c:t});o[e]&&(o[e].s={font:{bold:!0,color:{rgb:"1976D2"}},fill:{fgColor:{rgb:"EAF4FB"}},border:{top:{style:"thin",color:{rgb:"D0D7E1"}},bottom:{style:"thin",color:{rgb:"D0D7E1"}},left:{style:"thin",color:{rgb:"D0D7E1"}},right:{style:"thin",color:{rgb:"D0D7E1"}}},alignment:{horizontal:"center",vertical:"center"}})}for(let t=2;t<=a.e.r;++t)for(let e=a.s.c;e<=a.e.c;++e){const n=aRe.encode_cell({r:t,c:e});o[n]&&(o[n].s={border:{top:{style:"thin",color:{rgb:"D0D7E1"}},bottom:{style:"thin",color:{rgb:"D0D7E1"}},left:{style:"thin",color:{rgb:"D0D7E1"}},right:{style:"thin",color:{rgb:"D0D7E1"}}},alignment:{horizontal:"left",vertical:"center"}},"number"===typeof o[n].v&&(o[n].z="#,##0"))}for(let t=a.s.c;t<=a.e.c;++t){const e=aRe.encode_cell({r:0,c:t});o[e]&&(o[e].s={font:{italic:!0,color:{rgb:"888888"}},alignment:{horizontal:"left",vertical:"center"}})}o["!rows"]=[{hpt:18},{hpt:22}];const s=aRe.book_new();aRe.book_append_sheet(s,o,"Sheet1"),function(e,t,n){var r=n||{};r.type="file",r.file=t,KAe(r),YAe(e,r)}(s,i,{cellStyles:!0})},style:{margin:"8px 0",padding:"6px 16px",background:"#1976d2",color:"#fff",border:"none",borderRadius:4,cursor:"pointer",fontWeight:500},children:"Export to Excel"})},lRe=e=>{let{data:t,brandRateMap:n}=e;const[r,i]=(0,g.useState)(""),[o,a]=(0,g.useState)("All"),[s,l]=(0,g.useState)(!1),[c,u]=(0,g.useState)({});if(!t||0===t.length)return(0,Bt.jsx)("div",{style:{padding:24,textAlign:"center",color:"#888"},children:"No BOQ data available."});const d=t.reduce((e,t)=>{const n=t.category||"Uncategorized";return e[n]||(e[n]=[]),e[n].push(t),e},{}),h=(e,t)=>{const r="".concat(e,"__").concat(t);return n&&n[r]&&n[r].default_brand?n[r].default_brand:"Select"},f=(e,t,r)=>{const i="".concat(e,"__").concat(t);if(n&&n[i]&&Array.isArray(n[i].brands)){const e=n[i].brands.find(e=>e.brand_name===r);return e?e.rate_per_unit:""}return""},m=Object.keys(d),p=[];return Object.entries(d).filter(e=>{let[t]=e;return"All"===o||t===o}).forEach(e=>{let[t,n]=e;const i=""===r.trim()?n:n.filter(e=>{const t=r.trim().toLowerCase();return e.category&&e.category.toLowerCase().includes(t)||e.material&&e.material.toLowerCase().includes(t)});i.forEach(e=>{var n,r;const i="".concat(t,"__").concat(e.material);let o=null===(n=c[i])||void 0===n?void 0:n.brand,a=null===(r=c[i])||void 0===r?void 0:r.rate;o&&"Select"!==o||(o=h(e.materialNorm||e.material,e.unitNorm||e.unit),void 0!==a&&""!==a||!o||"Select"===o||(a=f(e.materialNorm||e.material,e.unitNorm||e.unit,o))),void 0===a&&(a="");const s=Math.round(e.totalQty),l=a&&s?Math.round(a*s):"";p.push({Category:t,Material:e.material,"Total Qty":s,Unit:e.unit,"Brand Name":o,"Rate/Unit":a,"Cost (\u20b9)":l})})}),(0,Bt.jsx)("div",{children:(0,Bt.jsxs)("div",{className:"step5-table-responsive",style:{margin:"2rem 0",background:"#fff",padding:0,maxHeight:600,overflowY:"auto"},children:[(0,Bt.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,margin:"0 0 12px 0"},children:[(0,Bt.jsx)("label",{htmlFor:"boqFilterText",style:{fontWeight:400,marginRight:4,whiteSpace:"nowrap"},children:"Filter:"}),(0,Bt.jsx)("input",{id:"boqFilterText",type:"text",value:r,onChange:e=>i(e.target.value),placeholder:"Type to filter...",style:{width:140,minWidth:0,padding:"6px 10px",borderRadius:4,border:"1px solid #bdbdbd",fontSize:"1em"}}),(0,Bt.jsx)(sRe,{data:p,columns:["Category","Material","Total Qty","Unit","Brand Name","Rate/Unit","Cost (\u20b9)"],description:"Civil Material Export - ".concat((new Date).toLocaleDateString("en-IN")),fileName:"CivilMaterialExport.xlsx",renderButton:e=>{let{onClick:t}=e;return(0,Bt.jsx)("button",{onClick:t,style:{display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:"50%",width:36,height:36,cursor:"pointer",padding:0,marginLeft:2},title:"Export Civil Material to Excel",children:(0,Bt.jsxs)("svg",{width:"28",height:"28",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,Bt.jsx)("rect",{width:"48",height:"48",rx:"10",fill:"#21A366"}),(0,Bt.jsx)("rect",{x:"7",y:"7",width:"34",height:"34",rx:"6",fill:"#107C41"}),(0,Bt.jsx)("path",{d:"M16 16H32V32H16V16Z",fill:"#33C481"}),(0,Bt.jsx)("path",{d:"M20.5 19L24 29L27.5 19H25.7L24 24.2L22.3 19H20.5Z",fill:"white"}),(0,Bt.jsx)("rect",{x:"16",y:"16",width:"16",height:"16",rx:"2",stroke:"#185C37",strokeWidth:"2"}),(0,Bt.jsx)("rect",{x:"7",y:"7",width:"34",height:"34",rx:"6",stroke:"#33C481",strokeWidth:"2"})]})})}})]}),(0,Bt.jsxs)("table",{className:"step5-material-table",style:{width:"100%",fontSize:"0.93rem",background:"#fff",borderCollapse:"collapse",borderSpacing:0,border:"1px solid #d0d7e1",boxShadow:"0 2px 8px rgba(33,150,243,0.07)",borderRadius:"8px"},children:[(0,Bt.jsx)("thead",{style:{background:"#eaf4fb"},children:(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("th",{style:{padding:"8px 6px",fontWeight:600,color:"#1976d2",border:"1px solid #d0d7e1",fontSize:"0.98em",position:"sticky",top:0,background:"#eaf4fb",zIndex:2,minWidth:120},children:(0,Bt.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:4,position:"relative"},children:["Category",(0,Bt.jsx)("span",{style:{cursor:"pointer",marginLeft:4,display:"flex",alignItems:"center"},onClick:e=>{e.stopPropagation(),l(e=>!e)},title:"Filter by Category",children:(0,Bt.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 20 20",fill:"#1976d2",style:{display:"block"},children:(0,Bt.jsx)("path",{d:"M3 5a1 1 0 0 1 1-1h12a1 1 0 0 1 .8 1.6l-4.6 6.4V16a1 1 0 0 1-1.447.894l-2-1A1 1 0 0 1 8 15v-3.01L3.2 6.6A1 1 0 0 1 3 5z"})})}),s&&(0,Bt.jsxs)("div",{style:{position:"absolute",top:28,left:0,background:"#fff",border:"1px solid #b0c4d7",borderRadius:6,boxShadow:"0 2px 8px #d0d7e1",zIndex:10,minWidth:120,padding:"4px 0"},onClick:e=>e.stopPropagation(),children:[(0,Bt.jsx)("div",{style:{padding:"2px 12px",cursor:"pointer",color:"All"===o?"#1976d2":"#333",fontWeight:"All"===o?600:400},onClick:()=>{a("All"),l(!1)},children:"All"}),m.map(e=>(0,Bt.jsx)("div",{style:{padding:"2px 12px",cursor:"pointer",color:o===e?"#1976d2":"#333",fontWeight:o===e?600:400},onClick:()=>{a(e),l(!1)},children:e},e))]})]})}),(0,Bt.jsx)("th",{style:{padding:"8px 6px",fontWeight:600,color:"#1976d2",border:"1px solid #d0d7e1",fontSize:"0.98em",position:"sticky",top:0,background:"#eaf4fb",zIndex:2},children:"Material"}),(0,Bt.jsx)("th",{style:{padding:"8px 6px",fontWeight:600,color:"#1976d2",border:"1px solid #d0d7e1",fontSize:"0.98em",position:"sticky",top:0,background:"#eaf4fb",zIndex:2},children:"Total Qty"}),(0,Bt.jsx)("th",{style:{padding:"8px 6px",fontWeight:600,color:"#1976d2",border:"1px solid #d0d7e1",fontSize:"0.98em",position:"sticky",top:0,background:"#eaf4fb",zIndex:2},children:"Unit"}),(0,Bt.jsx)("th",{style:{padding:"8px 6px",fontWeight:600,color:"#1976d2",border:"1px solid #d0d7e1",fontSize:"0.98em",position:"sticky",top:0,background:"#eaf4fb",zIndex:2},children:"Brand Name"}),(0,Bt.jsx)("th",{style:{padding:"8px 6px",fontWeight:600,color:"#1976d2",border:"1px solid #d0d7e1",fontSize:"0.98em",position:"sticky",top:0,background:"#eaf4fb",zIndex:2},children:"Rate/Unit"}),(0,Bt.jsx)("th",{style:{padding:"8px 6px",fontWeight:600,color:"#1976d2",border:"1px solid #d0d7e1",fontSize:"0.98em",position:"sticky",top:0,background:"#eaf4fb",zIndex:2},children:"Cost (\u20b9)"})]})}),(0,Bt.jsxs)("tbody",{children:[Object.entries(d).filter(e=>{let[t]=e;return"All"===o||t===o}).map(e=>{let[t,i]=e;const o=""===r.trim()?i:i.filter(e=>{const t=r.trim().toLowerCase();return e.category&&e.category.toLowerCase().includes(t)||e.material&&e.material.toLowerCase().includes(t)});if(0===o.length)return null;let a=0;const s=o.map((e,r)=>{var i,o;const s="".concat(t,"__").concat(e.material);let l=null===(i=c[s])||void 0===i?void 0:i.brand,d=null===(o=c[s])||void 0===o?void 0:o.rate;l&&"Select"!==l||(l=h(e.materialNorm||e.material,e.unitNorm||e.unit),void 0!==d&&""!==d||!l||"Select"===l||(d=f(e.materialNorm||e.material,e.unitNorm||e.unit,l))),void 0===d&&(d="");const m=Math.round(e.totalQty),p=d&&m?Math.round(d*m):"";p&&(a+=Number(p));const g=((e,t)=>{const r="".concat(e,"__").concat(t);return n&&n[r]&&Array.isArray(n[r].brands)?["Select",...n[r].brands.map(e=>e.brand_name)]:["Select"]})(e.materialNorm||e.material,e.unitNorm||e.unit);return(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("td",{style:{border:"1px solid #d0d7e1",padding:"7px 6px"},children:t}),(0,Bt.jsx)("td",{style:{border:"1px solid #d0d7e1",padding:"7px 6px"},children:e.material}),(0,Bt.jsx)("td",{style:{border:"1px solid #d0d7e1",padding:"7px 6px",textAlign:"right"},children:m}),(0,Bt.jsx)("td",{style:{border:"1px solid #d0d7e1",padding:"7px 6px"},children:e.unit}),(0,Bt.jsx)("td",{style:{border:"1px solid #d0d7e1",padding:"7px 6px"},children:(0,Bt.jsx)("select",{value:l,onChange:t=>((e,t,n,r)=>{const i=f(t,n,r);u(t=>{var n;return E(E({},t),{},{[e]:E(E({},t[e]),{},{brand:r,rate:""!==i?i:(null===(n=t[e])||void 0===n?void 0:n.rate)||""})})})})(s,e.materialNorm||e.material,e.unitNorm||e.unit,t.target.value),style:{width:"100%"},children:g.map(e=>(0,Bt.jsx)("option",{value:e,children:e},e))})}),(0,Bt.jsx)("td",{style:{border:"1px solid #d0d7e1",padding:"7px 6px"},children:(0,Bt.jsx)("input",{type:"number",value:d,min:0,onChange:e=>((e,t)=>{const n=Number(t);u(t=>E(E({},t),{},{[e]:E(E({},t[e]),{},{rate:isNaN(n)?"":n})}))})(s,e.target.value),style:{width:80,textAlign:"right",border:"1px solid #ccc",borderRadius:4,padding:"2px 6px",fontSize:"0.95em"}})}),(0,Bt.jsx)("td",{style:{border:"1px solid #d0d7e1",padding:"7px 6px",textAlign:"right",fontWeight:500},children:p?p.toLocaleString("en-IN"):""})]},s)});return[(0,Bt.jsx)("tr",{style:{background:"#f0f0f0",fontWeight:"bold"},children:(0,Bt.jsx)("td",{colSpan:7,style:{border:"1px solid #d0d7e1",fontSize:"0.97em",padding:"7px 6px"},children:t})},t),...s,(0,Bt.jsxs)("tr",{style:{background:"#e3f2fd",fontWeight:600},children:[(0,Bt.jsx)("td",{colSpan:6,style:{textAlign:"right",border:"1px solid #d0d7e1",padding:"7px 6px"},children:"Sub Total"}),(0,Bt.jsxs)("td",{style:{border:"1px solid #d0d7e1",padding:"7px 6px",textAlign:"right",color:"#1976d2",fontWeight:700},children:["\u20b9",a?a.toLocaleString("en-IN"):""]})]},t+"-subtotal")]}),(0,Bt.jsxs)("tr",{style:{background:"#1976d2",color:"#fff",fontWeight:700},children:[(0,Bt.jsx)("td",{colSpan:6,style:{textAlign:"right",border:"1px solid #1976d2",padding:"9px 6px",fontSize:"1.05em"},children:"Grand Total"}),(0,Bt.jsx)("td",{style:{border:"1px solid #1976d2",padding:"9px 6px",textAlign:"right",fontSize:"1.05em"},children:(()=>{let e=0;return Object.entries(d).filter(e=>{let[t]=e;return"All"===o||t===o}).forEach(t=>{let[n,r]=t;r.forEach(t=>{var r,i;const o="".concat(n,"__").concat(t.material);let a=null===(r=c[o])||void 0===r?void 0:r.brand,s=null===(i=c[o])||void 0===i?void 0:i.rate;a&&"Select"!==a||(a=h(t.materialNorm||t.material,t.unitNorm||t.unit),void 0!==s&&""!==s||!a||"Select"===a||(s=f(t.materialNorm||t.material,t.unitNorm||t.unit,a))),void 0===s&&(s="");const l=Math.round(t.totalQty),u=s&&l?Math.round(s*l):"";u&&(e+=Number(u))})}),"\u20b9".concat(e.toLocaleString("en-IN"))})()})]})]})]})]})})},cRe=["active","eventKey","mountOnEnter","transition","unmountOnExit","role","onEnter","onEntering","onEntered","onExit","onExiting","onExited"],uRe=["activeKey","getControlledId","getControllerId"],dRe=["as"];function hRe(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}function fRe(e){let{active:t,eventKey:n,mountOnEnter:r,transition:i,unmountOnExit:o,role:a="tabpanel",onEnter:s,onEntering:l,onEntered:c,onExit:u,onExiting:d,onExited:h}=e,f=hRe(e,cRe);const m=(0,g.useContext)(Yl);if(!m)return[Object.assign({},f,{role:a}),{eventKey:n,isActive:t,mountOnEnter:r,transition:i,unmountOnExit:o,onEnter:s,onEntering:l,onEntered:c,onExit:u,onExiting:d,onExited:h}];const{activeKey:p,getControlledId:v,getControllerId:y}=m,b=hRe(m,uRe),w=sl(n);return[Object.assign({},f,{role:a,id:v(n),"aria-labelledby":y(n)}),{eventKey:n,isActive:null==t&&null!=w?sl(p)===w:t,transition:i||b.transition,mountOnEnter:null!=r?r:b.mountOnEnter,unmountOnExit:null!=o?o:b.unmountOnExit,onEnter:s,onEntering:l,onEntered:c,onExit:u,onExiting:d,onExited:h}]}const mRe=g.forwardRef((e,t)=>{let{as:n="div"}=e,r=hRe(e,dRe);const[i,{isActive:o,onEnter:a,onEntering:s,onEntered:l,onExit:c,onExiting:u,onExited:d,mountOnEnter:h,unmountOnExit:f,transition:m=Eo}]=fRe(r);return(0,Bt.jsx)(Yl.Provider,{value:null,children:(0,Bt.jsx)(ll.Provider,{value:null,children:(0,Bt.jsx)(m,{in:o,onEnter:a,onEntering:s,onEntered:l,onExit:c,onExiting:u,onExited:d,mountOnEnter:h,unmountOnExit:f,children:(0,Bt.jsx)(n,Object.assign({},i,{ref:t,hidden:!o,"aria-hidden":!o}))})})})});mRe.displayName="TabPanel";const pRe=e=>{const{id:t,generateChildId:n,onSelect:r,activeKey:i,defaultActiveKey:o,transition:a,mountOnEnter:s,unmountOnExit:l,children:c}=e,[u,d]=nn(i,o,r),h=(0,g.useId)(),f=null!=t?t:h,m=(0,g.useMemo)(()=>n||((e,t)=>f?"".concat(f,"-").concat(t,"-").concat(e):null),[f,n]),p=(0,g.useMemo)(()=>({onSelect:d,activeKey:u,transition:a,mountOnEnter:s||!1,unmountOnExit:l||!1,getControlledId:e=>m(e,"pane"),getControllerId:e=>m(e,"tab")}),[d,u,a,s,l,m]);return(0,Bt.jsx)(Yl.Provider,{value:p,children:(0,Bt.jsx)(ll.Provider,{value:d||null,children:c})})};pRe.Panel=mRe;const gRe=pRe,vRe=["className","bsPrefix","as"],yRe=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i="div"}=e,o=b(e,vRe);return r=Gt(r,"tab-content"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r)},o))});yRe.displayName="TabContent";const bRe=yRe;function wRe(e){return"boolean"===typeof e?e?sr:Eo:e}const xRe=["bsPrefix","transition"],SRe=["className","as"],CRe=g.forwardRef((e,t)=>{let{bsPrefix:n,transition:r}=e,i=b(e,xRe);const[o,{isActive:a,onEnter:s,onEntering:l,onEntered:c,onExit:u,onExiting:d,onExited:h,mountOnEnter:f,unmountOnExit:m,transition:p=sr}]=fRe(E(E({},i),{},{transition:wRe(r)})),{className:g,as:v="div"}=o,y=b(o,SRe),w=Gt(n,"tab-pane");return(0,Bt.jsx)(Yl.Provider,{value:null,children:(0,Bt.jsx)(ll.Provider,{value:null,children:(0,Bt.jsx)(p,{in:a,onEnter:s,onEntering:l,onEntered:c,onExit:u,onExiting:d,onExited:h,mountOnEnter:f,unmountOnExit:m,children:(0,Bt.jsx)(v,E(E({},y),{},{ref:t,className:Lt(g,w,a&&"active")}))})})})});CRe.displayName="TabPane";const ERe=CRe,NRe=["id","onSelect","transition","mountOnEnter","unmountOnExit","variant","children","activeKey"];function TRe(e){let t;return function(e,t){let n=0;g.Children.forEach(e,e=>{g.isValidElement(e)&&t(e,n++)})}(e,e=>{null==t&&(t=e.props.eventKey)}),t}function ARe(e){const{title:t,eventKey:n,disabled:r,tabClassName:i,tabAttrs:o,id:a}=e.props;return null==t?null:(0,Bt.jsx)(au,{as:"li",role:"presentation",children:(0,Bt.jsx)(ec,E(E({as:"button",type:"button",eventKey:n,disabled:r,id:a,className:i},o),{},{children:t}))})}const RRe=e=>{const t=rn(e,{activeKey:"onSelect"}),{id:n,onSelect:r,transition:i,mountOnEnter:o=!1,unmountOnExit:a=!1,variant:s="tabs",children:l,activeKey:c=TRe(l)}=t,u=b(t,NRe);return(0,Bt.jsxs)(gRe,{id:n,activeKey:c,onSelect:r,transition:wRe(i),mountOnEnter:o,unmountOnExit:a,children:[(0,Bt.jsx)(cu,E(E({id:n},u),{},{role:"tablist",as:"ul",variant:s,children:di(l,ARe)})),(0,Bt.jsx)(bRe,{children:di(l,e=>{const t=E({},e.props);return delete t.title,delete t.disabled,delete t.tabClassName,delete t.tabAttrs,(0,Bt.jsx)(ERe,E({},t))})})]})};RRe.displayName="Tabs";const kRe=RRe,MRe=["transition"],DRe=e=>{let{transition:t}=e,n=b(e,MRe);return(0,Bt.jsx)(gRe,E(E({},n),{},{transition:wRe(t)}))};DRe.displayName="TabContainer";const _Re=DRe,ORe=Object.assign(()=>{throw new Error("ReactBootstrap: The `Tab` component is not meant to be rendered! It's an abstract component that is only valid as a direct Child of the `Tabs` Component. For custom tabs components use TabPane and TabsContainer directly")},{Container:_Re,Content:bRe,Pane:ERe});gbe();const IRe=e=>{let{selectedFloor:t,estimationMasterId:n,floorsList:r,onSaveComplete:i}=e;const[o,a]=(0,g.useState)([]),[s,l]=(0,g.useState)([]),[c,u]=(0,g.useState)(""),[d,h]=(0,g.useState)(!0),[f,m]=(0,g.useState)(!1),[p,v]=(0,g.useState)({show:!1,type:"",message:""}),[y,b]=(0,g.useState)("quantity"),[w,x]=(0,g.useState)([]),[S,C]=(0,g.useState)([]),[E,N]=(0,g.useState)(0),[T,A]=(0,g.useState)([]),[R,k]=(0,g.useState)([]),[M,D]=(0,g.useState)(!1),[_,O]=(0,g.useState)([]),[I,P]=(0,g.useState)(""),[j,F]=(0,g.useState)([]),[H,L]=(0,g.useState)(0),B=(0,g.useRef)(null),z=(0,g.useRef)(null),W=(0,g.useRef)(!1),V=(0,g.useRef)({}),U=(0,g.useRef)({}),q=(0,g.useRef)(!1),G=(0,g.useRef)(""),Y=(0,g.useRef)("quantity"),K=(0,g.useRef)({}),$=(0,g.useRef)({}),X="https://buildproapi.onrender.com",Q=(0,g.useCallback)(async()=>{try{h(!0);const e=await fetch("".concat(X,"/api/ProjectEstimation"));if(!e.ok)throw new Error("Failed to fetch estimations");const t=await e.json(),n=Array.isArray(t)?t:[t];a(n),h(!1)}catch(mW){v({show:!0,type:"danger",message:"Error loading estimations: ".concat(mW.message)}),h(!1)}},[X]),J=(0,g.useCallback)(async()=>{try{const e=await fetch("".concat(X,"/api/RccConfiguration"));if(!e.ok)throw new Error("Failed to fetch grade options");const t=await e.json(),n=Array.isArray(t)?t:[t];k(n);const r=[];n.forEach(e=>{e.grade&&!r.includes(e.grade)&&r.push(e.grade)}),A(r)}catch(mW){}},[X]),Z=(0,g.useCallback)(async()=>{try{const e=await fetch("".concat(X,"/api/MaterialItems"));if(!e.ok)throw new Error("Failed to fetch material items");const t=await e.json(),n=Array.isArray(t)?t:[t];F(n)}catch(mW){}},[X]),ee=(0,g.useCallback)(e=>"Foundation"===e?"Foundation":e.includes("Basement")?"Basement":"Floors",[]),te=(0,g.useCallback)(e=>{const t=["_id","version","description","last_updated","Applicable Floors","createdDate","modifiedDate","createdBy","modifiedBy","__v","estimationMasterId","floorName","recordCount"],n=[];return Object.entries(e).forEach(e=>{let[r,i]=e;t.includes(r)||"object"!==typeof i||null===i||Array.isArray(i)||n.push({component:r,category:i.Category||"",labour:i.Labour||"no",material:i.Material||"no",mixture:i.Mixture||"",unit:i.Unit||"cu m",labourRate:parseFloat(i.PricePerUnit)||0})}),n},[]),ne=(0,g.useCallback)(async e=>{try{h(!0);let t={};try{const e="".concat(X,"/api/AreaCalculation"),n=await fetch(e);if(n.ok){const e=await n.json();(Array.isArray(e)?e:[e]).forEach(e=>{const n=e["Applicable Floors"];if(n){const r=["_id","version","description","last_updated","Applicable Floors","createdDate","modifiedDate","createdBy","modifiedBy","__v","estimationMasterId","floorName","recordCount"];K.current[n]||(K.current[n]=[]),Object.entries(e).forEach(e=>{let[i,o]=e;if(!r.includes(i)&&"object"===typeof o&&null!==o&&!Array.isArray(o)){const e=parseFloat(o.PricePerUnit)||0;t[n]||(t[n]={}),t[n][i]=e,K.current[n].push({component:i,category:o.Category||"",labour:o.Labour||"no",material:o.Material||"no",mixture:o.Mixture||"",unit:o.Unit||"cu m",labourRate:e})}})}})}}catch(mW){}try{const n="".concat(X,"/api/EstimationMaterialFloorWise/by-estimation-master/").concat(e),r=await fetch(n);if(r.ok){const e=await r.json();let n=null;if(e&&e.records&&Array.isArray(e.records)&&e.records.length>0){const t=e.records[0];t.floors&&Array.isArray(t.floors)&&(n=t.floors)}else e&&e.floors&&Array.isArray(e.floors)&&(n=e.floors);if(n&&n.length>0)return n.forEach(e=>{const n=e.floorName;if(n&&e.components){const r=ee(n),i=t[r]||{},o=Object.keys(e.components).map(t=>{var n;const o=e.components[t],a=null===(n=K.current[r])||void 0===n?void 0:n.find(e=>e.component===t),s=(null===a||void 0===a?void 0:a.category)||null,l=parseFloat(o.PricePerUnit)||i[t]||0;return{component:t,unit:o.Unit||"cu m",mixture:o.Mixture||"",labourRate:l,category:s}});let a=null;Object.keys(e.components).some(t=>e.components[t].rows&&e.components[t].rows.length>0)&&(a=[],Object.keys(e.components).forEach((t,n)=>{var o;const s=e.components[t],l=parseFloat(s.PricePerUnit)||i[t]||0,c=null===(o=K.current[r])||void 0===o?void 0:o.find(e=>e.component===t),u=(null===c||void 0===c?void 0:c.category)||null;a.push({srNo:n+1,component:t,quantity:s.TotalQuantity||0,unit:s.Unit||"cu m",mixture:s.Mixture||"",labourRate:l,category:u,isGroupHeader:!0,groupIndex:n}),s.rows&&s.rows.length>0?s.rows.forEach(e=>{a.push({component:e.childComponent||"",no:e.no||0,length:e.length||0,widthBreadth:e.widthBreadth||0,heightDepth:e.heightDepth||0,quantity:e.quantity||0,isDeduction:e.isDeduction||!1,isGroupHeader:!1,groupIndex:n,unit:s.Unit||"cu m",mixture:s.Mixture||""})}):a.push({component:"",no:0,isGroupHeader:!1,groupIndex:n,unit:s.Unit||"cu m",mixture:s.Mixture||""})})),V.current[n]={components:o,gridData:a}}}),h(!1),void(q.current=!0)}}catch(mW){}const n="".concat(X,"/api/AreaCalculation"),i=await fetch(n);if(!i.ok)throw new Error("Failed to fetch area calculations");const o=await i.json();(Array.isArray(o)?o:[o]).forEach(e=>{const t=e["Applicable Floors"];if(t){const n=te(e);r.forEach(e=>{ee(e)===t&&(V.current[e]={components:n,gridData:null})})}}),h(!1)}catch(mW){v({show:!0,type:"danger",message:"Error loading floor data: ".concat(mW.message)}),h(!1)}},[X,r,ee,te]),re=(0,g.useCallback)(async e=>{try{const t="".concat(X,"/api/PriceEstimationForMaterialAndLabour/by-estimation-master/").concat(e),n=await fetch(t);if(!n.ok)return void console.log("No saved material data found");const r=await n.json();console.log("Loaded material data:",r);let i=null;if(r&&r.records&&Array.isArray(r.records)&&r.records.length>0){const e=r.records[0];e.floors&&Array.isArray(e.floors)&&(i=e.floors)}else r&&r.floors&&Array.isArray(r.floors)&&(i=r.floors);i&&i.length>0&&(i.forEach(e=>{const t=e.floorName;if(t&&e.components){const n=[];Object.keys(e.components).forEach(t=>{const r=e.components[t];n.push({component:t,volume:r.volume||0,unit:r.unit||"Cum",materialQty:"",wastage:"",totalQty:"",uom:"",materialRate:"",labourRate:r.labourRate||0,materialAmount:r.materialAmount||0,labourAmount:r.labourAmount||0,totalAmount:r.totalAmount||0,remarks:"",isGroupHeader:!0}),r.materials&&r.materials.length>0&&r.materials.forEach(e=>{n.push({component:e.material||"",volume:"",unit:"",materialQty:e.materialQty||0,wastage:e.wastage||0,totalQty:e.totalQty||0,uom:e.uom||"",materialRate:e.materialRate||0,labourRate:"",materialAmount:e.materialAmount||0,labourAmount:"",totalAmount:e.totalAmount||0,remarks:"",isGroupHeader:!1})})}),U.current[t]=n}}),L(e=>e+1),console.log("Material data cached for floors:",Object.keys(U.current)))}catch(mW){console.log("Error loading material data:",mW)}},[X]),ie=(0,g.useCallback)(e=>{var t;const n=null===(t=B.current)||void 0===t?void 0:t.hotInstance;if(!n)return;const r=n.getSourceData();let i=0,o=-1;r.forEach((t,n)=>{if(t.groupIndex===e)if(t.isGroupHeader)o=n;else if(!t.isGroupHeader){const e=parseFloat(t.quantity)||0;i+=t.isDeduction?-e:e}}),o>=0&&n.setDataAtRowProp(o,"quantity",i.toFixed(2))},[]),oe=(0,g.useCallback)(e=>{const t=[];e.forEach((e,n)=>{t.push({srNo:n+1,component:e.component,no:"",length:"",widthBreadth:"",heightDepth:"",quantity:0,unit:e.unit||"cu m",mixture:e.mixture||"",labourRate:e.labourRate||0,category:e.category||null,isGroupHeader:!0,isDeduction:!1,groupIndex:n}),t.push({srNo:"",component:"",no:0,length:"",widthBreadth:"",heightDepth:"",quantity:"",unit:e.unit||"cu m",mixture:e.mixture||"",isGroupHeader:!1,isDeduction:!1,groupIndex:n,parentSrNo:n+1})});const n=JSON.parse(JSON.stringify(t));N(Date.now()),x(n),setTimeout(()=>{e.forEach((e,t)=>{ie(t)})},100)},[ie]),ae=(0,g.useCallback)(()=>{if(!c)return[];const e=ee(c),t=K.current[e]||[],n=new Set;w.forEach(e=>{e.isGroupHeader&&e.component&&n.add(e.component)});const r=new Set,i=[];return t.forEach(e=>{n.has(e.component)||r.has(e.component)||(r.add(e.component),i.push(e))}),i},[c,w,ee]),se=(0,g.useCallback)(()=>{const e=ae();O(e),P(""),D(!0)},[ae]),le=(0,g.useCallback)(()=>{if(!I)return void v({show:!0,type:"warning",message:"Please select a component to add"});const e=ee(c),t=K.current[e]||[],n=t.find(e=>e.component===I);if(!n)return;const r=t.map(e=>e.component),i=r.indexOf(I);let o=0;const a=[...w],s=a.filter(e=>e.isGroupHeader);for(let c=0;c<s.length;c++){const e=s[c].component;if(r.indexOf(e)>i){o=a.indexOf(s[c]);break}}0===o&&s.length>0&&(o=a.length);const l=s.length,u=l+1,d={srNo:u,component:n.component,no:"",length:"",widthBreadth:"",heightDepth:"",quantity:0,unit:n.unit||"cu m",mixture:n.mixture||"",labourRate:n.labourRate||0,category:n.category||null,isGroupHeader:!0,isDeduction:!1,groupIndex:l},h={srNo:"",component:"",no:0,length:"",widthBreadth:"",heightDepth:"",quantity:"",unit:n.unit||"cu m",mixture:n.mixture||"",isGroupHeader:!1,isDeduction:!1,groupIndex:l,parentSrNo:u};a.splice(o,0,d,h);let f=0;a.forEach((e,t)=>{if(e.isGroupHeader)f++,e.srNo=f,e.groupIndex=f-1;else for(let n=t-1;n>=0;n--)if(a[n].isGroupHeader){e.groupIndex=a[n].groupIndex,e.parentSrNo=a[n].srNo;break}}),N(Date.now()),x(a),c&&V.current[c]&&(V.current[c].gridData=a),D(!1),P(""),v({show:!0,type:"success",message:'Component "'.concat(I,'" added successfully')})},[I,w,c,ee]),ce=(0,g.useCallback)(e=>{var t;if(!e||""===e)return;const n=null===(t=z.current)||void 0===t?void 0:t.hotInstance;if(!n)return;const r=n.getSourceData();r&&r.length>0&&(U.current[e]=JSON.parse(JSON.stringify(r)),$.current[e]=!0)},[]),ue=(0,g.useCallback)(e=>{var t;if(!e||""===e)return;const n=null===(t=B.current)||void 0===t?void 0:t.hotInstance;if(!n)return;const r=n.getSourceData();var i;r&&r.length>0&&(V.current[e]={components:(null===(i=V.current[e])||void 0===i?void 0:i.components)||[],gridData:JSON.parse(JSON.stringify(r))})},[]),de=(0,g.useCallback)(async e=>{try{if(V.current[e]){const t=V.current[e];if(t.gridData&&t.gridData.length>0){const e=JSON.parse(JSON.stringify(t.gridData));N(Date.now()),x(e)}else t.components?oe(t.components):Array.isArray(t)&&oe(t);return void m(!1)}v({show:!0,type:"warning",message:"Data not found in cache for ".concat(e,". Please refresh the page.")}),m(!1)}catch(mW){m(!1),v({show:!0,type:"danger",message:"Error loading components: ".concat(mW.message)})}},[oe]);(0,g.useEffect)(()=>{Q(),J(),Z()},[Q,J,Z]),(0,g.useEffect)(()=>{n&&r&&r.length>0&&!q.current&&(q.current=!0,ne(n).then(()=>{re(n),W.current||(u("Foundation"),W.current=!0)}))},[n,r,ne,re]),(0,g.useEffect)(()=>{r&&r.length>0&&l(r)},[r]),(0,g.useEffect)(()=>{G.current&&""!==G.current&&G.current!==c&&(ue(G.current),ce(G.current)),c&&""!==c&&Object.keys(V.current).length>0?(m(!0),de(c),G.current=c):""===c&&(x([]),C([]),m(!1),G.current="")},[c,de,ue,ce]);const he=(0,g.useCallback)(()=>{c&&""!==c&&(ue(c),ce(c));const e=[];return Object.keys(V.current).forEach(t=>{const r=V.current[t],i=r.gridData||[],o=r.components||[],a={};i.length>0?i.forEach(e=>{if(e.isGroupHeader&&e.component)a[e.component]={Unit:e.unit||"cu m",Mixture:e.mixture||"",Category:"",Labour:"yes",Material:"yes",TotalQuantity:e.quantity||0,rows:[]};else if(!e.isGroupHeader&&void 0!==e.groupIndex){const t=i.find(t=>t.isGroupHeader&&t.groupIndex===e.groupIndex);t&&t.component&&(a[t.component].rows||(a[t.component].rows=[]),a[t.component].rows.push({childComponent:e.component||"",no:e.no||0,length:e.length||0,widthBreadth:e.widthBreadth||0,heightDepth:e.heightDepth||0,quantity:e.quantity||0,isDeduction:e.isDeduction||!1}))}}):o.forEach(e=>{a[e.component]={Unit:e.unit||"cu m",Mixture:e.mixture||"",Category:"",Labour:"yes",Material:"yes",rows:[]}}),e.push({floorName:t,estimationMasterId:n,components:a})}),e},[c,n,ue,ce]),fe=(0,g.useCallback)(()=>{console.log("getAllMaterialDataForSave called"),console.log("materialDataCache keys:",Object.keys(U.current)),console.log("floorDataCache keys:",Object.keys(V.current)),console.log("rccConfigData:",R),c&&""!==c&&ce(c);const e=[];return new Set([...Object.keys(U.current),...Object.keys(V.current)]).forEach(t=>{if(console.log("Processing floor: ".concat(t)),U.current[t]&&U.current[t].length>0){console.log("Using cached material data for ".concat(t));const r=U.current[t],i={};return r.forEach(e=>{if(e.isGroupHeader)i[e.component]={volume:e.volume||0,unit:e.unit||"Cum",labourRate:e.labourRate||0,labourAmount:e.labourAmount||0,materialAmount:e.materialAmount||0,totalAmount:e.totalAmount||0,materials:[]};else{const t=Object.keys(i).pop();t&&i[t]&&i[t].materials.push({material:e.component||"",materialQty:e.materialQty||0,wastage:e.wastage||0,totalQty:e.totalQty||0,uom:e.uom||"",materialRate:e.materialRate||0,materialAmount:e.materialAmount||0,totalAmount:e.totalAmount||0})}}),void e.push({floorName:t,estimationMasterId:n,components:i})}const r=V.current[t];if(!r)return void console.log("No cache found for ".concat(t));const i=r.gridData||[];if(console.log("".concat(t," gridData length:"),i.length),0===i.length)return;const o=[];if(i.forEach(e=>{if(e.isGroupHeader){console.log("Processing group header: ".concat(e.component,", quantity: ").concat(e.quantity,", mixture: ").concat(e.mixture));const t=parseFloat(e.quantity)||0;if(t<=0)return;if(e.mixture){const n=e.mixture,r=R.find(e=>e.grade&&e.grade.toLowerCase()===n.toLowerCase());if(r){const n=parseFloat(e.labourRate)||0,i=(t*n).toFixed(2),a=[{name:"Cement",data:r.cement},{name:"Steel",data:r.steel},{name:"Sand",data:r.sand},{name:"Aggregate 20mm",data:r.aggregate_20mm},{name:"Aggregate 40mm",data:r.aggregate_40mm},{name:"Water",data:r.water},{name:"Bricks",data:r.bricks}];let s=0;const l=[];a.forEach(e=>{if(e.data&&e.data.quantity){const n=parseFloat(e.data.quantity)||0,r=(t*n).toFixed(2),i=parseFloat(e.data.wastage)||0,o=(parseFloat(r)*(1+i/100)).toFixed(2),a=e.data.material||e.name,c=parseFloat(e.data.defaultRate)||0,u=parseFloat(o*c);s+=u,l.push({material:a,materialQty:parseFloat(r),wastage:i,totalQty:parseFloat(o),uom:e.data.unit||"KG",materialRate:c,materialAmount:u.toFixed(2),totalAmount:u.toFixed(2)})}});const c=s+parseFloat(i);o.push({component:e.component,volume:parseFloat(t.toFixed(2)),unit:"Cum",labourRate:n,labourAmount:parseFloat(i),materialAmount:parseFloat(s.toFixed(2)),totalAmount:parseFloat(c.toFixed(2)),materials:l,isGroupHeader:!0})}}else{const n=parseFloat(e.labourRate)||0,r=parseFloat((t*n).toFixed(2)),i=r;o.push({component:e.component,volume:parseFloat(t.toFixed(2)),unit:e.unit||"Cum",labourRate:n,labourAmount:r,materialAmount:0,totalAmount:i,materials:[],isGroupHeader:!0})}}}),0===o.length)return;const a={};o.forEach(e=>{e.isGroupHeader&&(a[e.component]={volume:e.volume||0,unit:e.unit||"Cum",labourRate:e.labourRate||0,labourAmount:e.labourAmount||0,materialAmount:e.materialAmount||0,totalAmount:e.totalAmount||0,materials:e.materials||[]})}),e.push({floorName:t,estimationMasterId:n,components:a})}),console.log("Total floors with material data:",e.length),console.log("Material data to save:",JSON.stringify(e,null,2)),e},[c,n,ce,R]),me=(0,g.useCallback)(()=>{V.current={},U.current={},q.current=!1,n&&r&&r.length>0&&ne(n).then(()=>{re(n),c&&(m(!0),de(c))})},[n,r,ne,re,c,de]);(0,g.useEffect)(()=>(window.BOQEstimation_getAllCachedData=he,window.BOQEstimation_getAllMaterialData=fe,window.BOQEstimation_refreshData=me,()=>{delete window.BOQEstimation_getAllCachedData,delete window.BOQEstimation_getAllMaterialData,delete window.BOQEstimation_refreshData}),[he,fe,me]);const pe=(0,g.useCallback)(e=>{var t;const n=[...w];let r=n.length;for(let a=0;a<n.length;a++)if(n[a].groupIndex!==e||n[a].isGroupHeader){if(n[a].groupIndex>e)break}else r=a+1;const i=null===(t=n.find(t=>t.isGroupHeader&&t.groupIndex===e))||void 0===t?void 0:t.srNo,o=n.find(t=>t.isGroupHeader&&t.groupIndex===e);n.splice(r,0,{srNo:"",component:"",no:9,length:"",widthBreadth:"",heightDepth:"",quantity:"",unit:"cu m",mixture:(null===o||void 0===o?void 0:o.mixture)||"",isGroupHeader:!1,isDeduction:!1,groupIndex:e,parentSrNo:i}),x(n),setTimeout(()=>{var e;const t=null===(e=B.current)||void 0===e?void 0:e.hotInstance;t&&t.loadData(n)},0)},[w]),ge=(0,g.useCallback)(e=>{var t;const n=null===(t=B.current)||void 0===t?void 0:t.hotInstance;if(!n)return;const r=n.getSourceDataAtRow(e);if(!r||r.isGroupHeader)return;const i=r.groupIndex;n.setDataAtRowProp(e,"isDeduction",!r.isDeduction),setTimeout(()=>{const e=n.getSourceData();x(e),ie(i)},50)},[ie]),ve=(0,g.useCallback)(e=>{var t;const n=null===(t=B.current)||void 0===t?void 0:t.hotInstance;if(!n)return;const r=n.getSourceData(),i=r.find(t=>t.isGroupHeader&&t.groupIndex===e);if(!i)return;if(!window.confirm('Are you sure you want to delete "'.concat(i.component,'" and all its associated rows?')))return;const o=r.filter(t=>t.groupIndex!==e);let a=0;o.forEach((e,t)=>{if(e.isGroupHeader)a++,e.srNo=a,e.groupIndex=a-1;else for(let n=t-1;n>=0;n--)if(o[n].isGroupHeader){e.groupIndex=o[n].groupIndex,e.parentSrNo=o[n].srNo;break}}),N(Date.now()),x(o),c&&V.current[c]&&(V.current[c].gridData=o),v({show:!0,type:"success",message:'Component "'.concat(i.component,'" deleted successfully')})},[c]);(0,g.useEffect)(()=>(window.BOQ_rccConfigData=R,()=>{delete window.BOQ_rccConfigData}),[R]);const ye=(0,g.useCallback)(e=>{const t=[];return e&&0!==e.length&&R&&0!==R.length?(e.forEach((e,n)=>{if(e.isGroupHeader){const n=parseFloat(e.quantity)||0;if(n<=0)return;if(e.mixture){const r=e.mixture,i=R.find(e=>e.grade&&e.grade.toLowerCase()===r.toLowerCase());if(i){const r=parseFloat(e.labourRate)||0,o=(n*r).toFixed(2),a=[{name:"Cement",data:i.cement},{name:"Steel",data:i.steel},{name:"Sand",data:i.sand},{name:"Aggregate 20mm",data:i.aggregate_20mm},{name:"Aggregate 40mm",data:i.aggregate_40mm},{name:"Water",data:i.water},{name:"Bricks",data:i.bricks}];let s=0;const l=[];a.forEach(e=>{if(e.data&&e.data.quantity){const t=parseFloat(e.data.quantity)||0,r=(n*t).toFixed(2),i=parseFloat(e.data.wastage)||0,o=(parseFloat(r)*(1+i/100)).toFixed(2),a=e.data.material||e.name,c=parseFloat(e.data.defaultRate)||0,u=parseFloat(o*c);s+=u,l.push({component:a,volume:"",unit:"",materialQty:parseFloat(r),wastage:i,totalQty:parseFloat(o),uom:e.data.unit||"KG",materialRate:c,labourRate:"",materialAmount:u.toFixed(2),labourAmount:"",totalAmount:u.toFixed(2),remarks:"",isGroupHeader:!1})}});const c=s+parseFloat(o);t.push({component:e.component,volume:parseFloat(n.toFixed(2)),unit:"Cum",materialQty:"",wastage:"",totalQty:"",uom:"",materialRate:"",labourRate:r,materialAmount:parseFloat(s.toFixed(2)),labourAmount:parseFloat(o),totalAmount:parseFloat(c.toFixed(2)),remarks:"",isGroupHeader:!0}),t.push(...l)}}else{const r=parseFloat(e.labourRate)||0,i=parseFloat((n*r).toFixed(2)),o=i;t.push({component:e.component,volume:parseFloat(n.toFixed(2)),unit:e.unit||"Cum",materialQty:"",wastage:"",totalQty:"",uom:"",materialRate:"",labourRate:r,materialAmount:0,labourAmount:i,totalAmount:o,remarks:"",isGroupHeader:!0})}}}),t):[]},[R]),be=(0,g.useCallback)(()=>ye(w),[w,ye]),we=(0,g.useCallback)(()=>{Object.keys(V.current).forEach(e=>{const t=V.current[e].gridData||[];if(t.length>0&&!U.current[e]){const n=ye(t);U.current[e]=n}})},[ye]),xe=(0,g.useCallback)(()=>{if(!c)return;const e=V.current[c];if(!e||!e.gridData||0===e.gridData.length)return;const t=e.gridData,n=U.current[c];if(!n||0===n.length){const e=ye(t);return U.current[c]=e,void("material"===y&&C(e))}console.log("Updating material cache from quantity changes for:",c),console.log("Existing material data length:",n.length),console.log("Material group headers:",n.filter(e=>e.isGroupHeader).map(e=>e.component));const r=JSON.parse(JSON.stringify(n));t.forEach(e=>{if(e.isGroupHeader){console.log("Processing quantity row:",e.component,"qty:",e.quantity);const t=r.findIndex(t=>t.isGroupHeader&&t.component===e.component);if(console.log("Found material group at index:",t,"for:",e.component),t>=0){const n=parseFloat(e.quantity)||0;console.log("Updating volume for",e.component,"from",r[t].volume,"to",n),r[t].volume=parseFloat(n.toFixed(2));const i=r[t].labourRate||0,o=parseFloat((n*i).toFixed(2));r[t].labourAmount=o;let a=0,s=t+1,l=null;for(e.mixture&&R.length>0&&(l=R.find(t=>t.grade&&t.grade.toLowerCase()===e.mixture.toLowerCase()));s<r.length&&!r[s].isGroupHeader;){const e=r[s];if(l){const t=[{name:"Cement",data:l.cement},{name:"Steel",data:l.steel},{name:"Sand",data:l.sand},{name:"Aggregate 20mm",data:l.aggregate_20mm},{name:"Aggregate 40mm",data:l.aggregate_40mm},{name:"Water",data:l.water},{name:"Bricks",data:l.bricks}].find(t=>t.data&&(t.data.material===e.component||t.name===e.component));if(t&&t.data){const i=parseFloat(t.data.quantity)||0,o=parseFloat((n*i).toFixed(2)),l=e.wastage||0,c=e.materialRate||0,u=parseFloat((o*(1+l/100)).toFixed(2)),d=parseFloat((u*c).toFixed(2));r[s].materialQty=o,r[s].totalQty=u,r[s].materialAmount=d,r[s].totalAmount=d,a+=d}}s++}r[t].materialAmount=parseFloat(a.toFixed(2)),r[t].totalAmount=parseFloat((a+o).toFixed(2))}else{const t=ye([e]);t.length>0&&r.push(...t)}}}),U.current[c]=r,console.log("Material cache updated, activeTab:",y),"material"===y&&(console.log("Updating material display with new data"),C(r))},[c,R,y,ye]);(0,g.useEffect)(()=>{"quantity"===y&&w&&w.length>0&&c&&xe()},[w,xe,c,y]),(0,g.useEffect)(()=>{Object.keys(V.current).length>0&&R.length>0&&we()},[we,R]),(0,g.useEffect)(()=>{if("material"===y){if(!c)return void C([]);if(U.current[c])C(U.current[c]);else{const e=be();U.current[c]=e,C(e)}}},[y,c,be,H]),(0,g.useEffect)(()=>{"material"===Y.current&&"material"!==y&&c&&(console.log("Switching away from material tab, saving data for:",c),ce(c)),Y.current=y},[y,c,ce]);(0,g.useCallback)(e=>{if(!e||!j||0===j.length)return[];return j.filter(t=>t.categoryName&&t.categoryName.toLowerCase()===e.toLowerCase()).map(e=>e.material).filter(e=>e)},[j]);const Se=(0,g.useCallback)((e,t,n)=>{const r=t[n];if(!r||!r.isGroupHeader)return;let i=0;for(let a=n+1;a<t.length;a++){const e=t[a];if(!e||e.isGroupHeader)break;i+=parseFloat(e.materialAmount)||0}const o=(i+(parseFloat(r.labourAmount)||0)).toFixed(2);e.setDataAtRowProp(n,"materialAmount",i.toFixed(2)),e.setDataAtRowProp(n,"totalAmount",o),c&&(U.current[c]=e.getSourceData())},[c]),Ce=(0,g.useCallback)(e=>{var t;const n=null===(t=z.current)||void 0===t?void 0:t.hotInstance;if(!n)return;const r=n.getSourceDataAtRow(e);if(!r||r.isGroupHeader)return;const i=parseFloat(r.materialQty)||0,o=i+i*(parseFloat(r.wastage)||0)/100,a=parseFloat(r.materialRate)||0,s=parseFloat(r.labourRate)||0,l=(o*a).toFixed(2),c=(o*s).toFixed(2),u=(parseFloat(l)+parseFloat(c)).toFixed(2);n.setDataAtRowProp(e,"totalQty",o.toFixed(2)),n.setDataAtRowProp(e,"materialAmount",l),n.setDataAtRowProp(e,"labourAmount",c),n.setDataAtRowProp(e,"totalAmount",u)},[]),Ee=(0,g.useMemo)(()=>[{data:"component",title:"Component",width:180,type:"dropdown",source:[],readOnly:function(e,t){const n=this.instance.getSourceDataAtRow(e);return n&&n.isGroupHeader}},{data:"volume",title:"Volume",width:80,type:"numeric",numericFormat:{pattern:"0.00"},readOnly:!0},{data:"unit",title:"Unit",width:60,type:"text",readOnly:!0},{data:"materialQty",title:"Qty",width:70,type:"numeric",numericFormat:{pattern:"0.00"},readOnly:function(e,t){const n=this.instance.getSourceDataAtRow(e);return n&&n.isGroupHeader}},{data:"wastage",title:"Wastage (%)",width:80,type:"numeric",numericFormat:{pattern:"0.00"},readOnly:function(e,t){const n=this.instance.getSourceDataAtRow(e);return n&&n.isGroupHeader}},{data:"totalQty",title:"Total Qty",width:70,type:"numeric",numericFormat:{pattern:"0.00"},readOnly:!0},{data:"uom",title:"UOM",width:60,type:"text",readOnly:!0},{data:"materialRate",title:"Rate",width:70,type:"numeric",numericFormat:{pattern:"0.00"},readOnly:!1},{data:"labourRate",title:"Labour Rate",width:90,type:"numeric",numericFormat:{pattern:"0.00"},readOnly:!1},{data:"materialAmount",title:"Material Amount",width:100,type:"numeric",numericFormat:{pattern:"0.00"},readOnly:!0},{data:"labourAmount",title:"Labour Amount",width:100,type:"numeric",numericFormat:{pattern:"0.00"},readOnly:!0},{data:"totalAmount",title:"Total Amount",width:120,type:"numeric",numericFormat:{pattern:"0.00"},readOnly:!0},{data:"remarks",title:"Remarks",width:150,type:"text",readOnly:!1}],[]),Ne=(0,g.useMemo)(()=>[{data:"component",title:"Component",width:250,type:"text",readOnly:!1},{data:"no",title:"No.",width:60,type:"numeric",numericFormat:{pattern:"0"}},{data:"length",title:"Length (m)",width:100,type:"numeric",numericFormat:{pattern:"0.000"}},{data:"widthBreadth",title:"Width/Breadth (m)",width:120,type:"numeric",numericFormat:{pattern:"0.000"}},{data:"heightDepth",title:"Height/Depth (m)",width:120,type:"numeric",numericFormat:{pattern:"0.000"}},{data:"quantity",title:"Quantity",width:100,type:"numeric",numericFormat:{pattern:"0.00"},className:"htRight",readOnly:function(e,t){const n=this.instance.getSourceDataAtRow(e);return n&&n.isGroupHeader}},{data:"unit",title:"Unit",width:80,type:"text",className:"htCenter htMiddle",renderer:function(e,t,n,r,i,o,a){const s=e.getSourceDataAtRow(n);return s&&s.isGroupHeader?bbe.renderers.TextRenderer.apply(this,arguments):(t.innerHTML="",t.style.textAlign="center",t.style.verticalAlign="middle"),t}},{data:"mixture",title:"Mixture",width:120,type:"dropdown",source:T,className:"htCenter htMiddle",renderer:function(e,t,n,r,i,o,a){if(bbe.renderers.DropdownRenderer.apply(this,arguments),o&&""!==o.trim()&&window.BOQ_rccConfigData){const e=window.BOQ_rccConfigData.find(e=>{if(!e.grade)return!1;const t=e.grade.toLowerCase().trim(),n=o.toLowerCase().trim();if(t===n)return!0;if(t.includes(n)||n.includes(t))return!0;const r=n.match(/\((.*?)(\)|$)/);return!(!r||!t.includes(r[1]))});if(e){const n=t.innerHTML;t.innerHTML=n+'<span class="mixture-info-icon" style="color: #3b82f6; cursor: pointer; font-size: 16px; font-weight: bold; margin-left: 5px;">&#9432;</span>',t.style.position="relative";const r=document.createElement("div");r.className="boq-mixture-tooltip",r.style.cssText="\n              position: absolute;\n              background: #2d3748;\n              color: white;\n              padding: 12px 16px;\n              border-radius: 6px;\n              font-size: 12px;\n              z-index: 99999;\n              min-width: 280px;\n              box-shadow: 0 4px 12px rgba(0,0,0,0.4);\n              display: none;\n              top: 100%;\n              left: 0;\n              margin-top: 5px;\n              white-space: nowrap;\n            ",r.innerHTML='\n              <div style="font-weight: bold; margin-bottom: 8px; border-bottom: 1px solid #4a5568; padding-bottom: 6px; color: #60a5fa;">\n                Material Composition - '.concat(e.grade,'\n              </div>\n              <div style="line-height: 1.8;">\n                <div>\ud83d\udd39 <strong>Cement:</strong> ').concat(e.cement||"N/A"," bags</div>\n                <div>\ud83d\udd39 <strong>Sand:</strong> ").concat(e.sand||"N/A"," cft</div>\n                <div>\ud83d\udd39 <strong>Aggregate 20mm:</strong> ").concat(e.aggregate_20mm||"N/A"," cft</div>\n                <div>\ud83d\udd39 <strong>Aggregate 40mm:</strong> ").concat(e.aggregate_40mm||"N/A"," cft</div>\n                <div>\ud83d\udd39 <strong>Steel:</strong> ").concat(e.steel||"N/A"," kg</div>\n                <div>\ud83d\udd39 <strong>Water:</strong> ").concat(e.water||"N/A",' liters</div>\n              </div>\n              <div style="margin-top: 8px; padding-top: 6px; border-top: 1px solid #4a5568; font-size: 10px; color: #94a3b8; text-align: center;">\n                Click icon to close\n              </div>\n            '),t.appendChild(r);const i=t.querySelector(".mixture-info-icon");if(i){let e=!1;i.onclick=function(t){t.stopPropagation(),t.preventDefault(),e=!e,r.style.display=e?"block":"none"}}setTimeout(()=>{document.addEventListener("click",function(e){t.contains(e.target)||(r.style.display="none")},{once:!1})},100)}}return t}},{data:"action",title:"Action",width:90,type:"text",readOnly:!0,className:"htCenter",renderer:(e,t,n,r,i,o,a)=>{t.innerHTML="",t.style.padding="2px",t.style.verticalAlign="middle",t.style.textAlign="center";const s=e.getSourceDataAtRow(n);if(s&&s.isGroupHeader){const e=s.mixture;let n=null;e&&window.BOQ_rccConfigData&&(n=window.BOQ_rccConfigData.find(t=>{if(!t.grade)return!1;const n=t.grade.toLowerCase().trim(),r=e.toLowerCase().trim();if(n===r)return!0;if(n.includes(r)||r.includes(n))return!0;const i=r.match(/\((.*?)(\)|$)/);return!(!i||!n.includes(i[1]))}));const r=document.createElement("div");r.style.display="inline-flex",r.style.gap="3px",r.style.alignItems="center",r.style.justifyContent="center";const i=document.createElement("button");i.innerHTML="+",i.style.border="none",i.style.background="#28a745",i.style.color="white",i.style.padding="4px 8px",i.style.borderRadius="3px",i.style.cursor="pointer",i.style.fontSize="16px",i.style.fontWeight="bold",i.style.height="26px",i.style.width="26px",i.style.display="inline-flex",i.style.alignItems="center",i.style.justifyContent="center",i.style.lineHeight="1",i.title="Add Row",i.onclick=()=>{pe(s.groupIndex)},r.appendChild(i);const o=document.createElement("button");if(o.innerHTML="\ud83d\uddd1",o.style.border="none",o.style.background="#dc3545",o.style.color="white",o.style.padding="4px 8px",o.style.borderRadius="3px",o.style.cursor="pointer",o.style.fontSize="14px",o.style.height="26px",o.style.width="26px",o.style.display="inline-flex",o.style.alignItems="center",o.style.justifyContent="center",o.style.lineHeight="1",o.title="Delete Group",o.onclick=()=>{ve(s.groupIndex)},r.appendChild(o),n){var l,c,u,d,h,f,m,p;const e=document.createElement("button");e.innerHTML="&#9432;",e.style.border="none",e.style.background="#3b82f6",e.style.color="white",e.style.padding="2px 4px",e.style.borderRadius="3px",e.style.cursor="pointer",e.style.fontSize="12px",e.style.fontWeight="bold",e.style.height="20px",e.style.width="20px",e.style.display="inline-flex",e.style.alignItems="center",e.style.justifyContent="center",e.title="Material Composition",t.style.position="relative",t.style.overflow="visible";const i=document.createElement("div");i.className="boq-mixture-tooltip",i.style.cssText="\n              position: fixed;\n              background: #2d3748;\n              color: white;\n              padding: 12px 16px;\n              border-radius: 6px;\n              font-size: 12px;\n              z-index: 999999;\n              min-width: 280px;\n              box-shadow: 0 4px 12px rgba(0,0,0,0.4);\n              display: none;\n              white-space: nowrap;\n            ",i.innerHTML='\n              <div style="font-weight: bold; margin-bottom: 8px; border-bottom: 1px solid #4a5568; padding-bottom: 6px; color: #60a5fa;">\n                Material Composition - '.concat(n.grade,'\n              </div>\n              <div style="line-height: 1.8;">\n                ').concat(null!==(l=n.cement)&&void 0!==l&&l.quantity?"<div>\ud83d\udd39 <strong>Cement:</strong> ".concat(n.cement.quantity," ").concat(n.cement.unit||"","</div>"):"","\n                ").concat(null!==(c=n.sand)&&void 0!==c&&c.quantity?"<div>\ud83d\udd39 <strong>Sand:</strong> ".concat(n.sand.quantity," ").concat(n.sand.unit||"","</div>"):"","\n                ").concat(null!==(u=n.aggregate_20mm)&&void 0!==u&&u.quantity?"<div>\ud83d\udd39 <strong>Aggregate 20mm:</strong> ".concat(n.aggregate_20mm.quantity," ").concat(n.aggregate_20mm.unit||"","</div>"):"","\n                ").concat(null!==(d=n.aggregate_40mm)&&void 0!==d&&d.quantity?"<div>\ud83d\udd39 <strong>Aggregate 40mm:</strong> ".concat(n.aggregate_40mm.unit||"","</div>"):"","\n                ").concat(null!==(h=n.steel)&&void 0!==h&&h.quantity?"<div>\ud83d\udd39 <strong>Steel:</strong> ".concat(n.steel.quantity," ").concat(n.steel.unit||"","</div>"):"","\n                ").concat(null!==(f=n.water)&&void 0!==f&&f.quantity?"<div>\ud83d\udd39 <strong>Water:</strong> ".concat(n.water.quantity," ").concat(n.water.unit||"","</div>"):"","\n                ").concat(null!==(m=n.bricks)&&void 0!==m&&m.quantity?"<div>\ud83d\udd39 <strong>Bricks:</strong> ".concat(n.bricks.quantity," ").concat(n.bricks.unit||"","</div>"):"","\n                ").concat(null!==(p=n.aggregate)&&void 0!==p&&p.quantity?"<div>\ud83d\udd39 <strong>Aggregate:</strong> ".concat(n.aggregate.quantity," ").concat(n.aggregate.unit||"","</div>"):"",'\n              </div>\n              <div style="margin-top: 8px; padding-top: 6px; border-top: 1px solid #4a5568; font-size: 10px; color: #94a3b8; text-align: center;">\n                Click outside to close\n              </div>\n            '),e.onclick=t=>{t.stopPropagation(),t.preventDefault();if("block"===i.style.display)i.style.display="none";else{const t=e.getBoundingClientRect();i.style.top=t.bottom+5+"px",i.style.left=t.left-100+"px",i.style.display="block"}},r.appendChild(e),t.appendChild(i),document.addEventListener("click",function(e){t.contains(e.target)||(i.style.display="none")})}t.appendChild(r)}else if(s&&!s.isGroupHeader){const e=document.createElement("div");e.style.display="inline-flex",e.style.gap="3px",e.style.alignItems="center",e.style.justifyContent="center";const r=document.createElement("button");r.innerHTML=s.isDeduction?"\u2212":"+",r.style.border="none",r.style.background=s.isDeduction?"#dc3545":"#28a745",r.style.color="white",r.style.padding="0",r.style.borderRadius="3px",r.style.cursor="pointer",r.style.fontSize="16px",r.style.fontWeight="bold",r.style.width="26px",r.style.height="26px",r.style.display="inline-flex",r.style.alignItems="center",r.style.justifyContent="center",r.style.lineHeight="1",r.title=s.isDeduction?"Deduction":"Addition",r.onclick=()=>{ge(n)},e.appendChild(r),t.appendChild(e)}return t}}],[T,pe,ge,ve]);return(0,Bt.jsxs)(Jt,{fluid:!0,style:{padding:"0",margin:"0",maxWidth:"100%"},children:[p.show&&(0,Bt.jsx)(fr,{variant:p.type,onClose:()=>v({show:!1,type:"",message:""}),dismissible:!0,children:p.message}),d?(0,Bt.jsx)("div",{className:"text-center py-5",children:(0,Bt.jsx)(tn,{animation:"border",role:"status",children:(0,Bt.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}):(0,Bt.jsx)(Xr,{children:(0,Bt.jsx)(Xr.Body,{style:{padding:"0.5rem"},children:(0,Bt.jsx)(mu,{children:(0,Bt.jsxs)(Ri,{md:12,children:[(0,Bt.jsxs)(mu,{className:"mb-3",children:[(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsx)(Ki.Group,{children:(0,Bt.jsx)(Ki.Select,{value:c,onChange:e=>u(e.target.value),children:s.map((e,t)=>(0,Bt.jsx)("option",{value:e,children:e},t))})})}),(0,Bt.jsx)(Ri,{md:3,className:"d-flex align-items-end",children:(0,Bt.jsx)(gr,{variant:"primary",size:"sm",onClick:se,disabled:!c||0===w.length,style:{marginBottom:"0px"},children:"+ Add Component"})})]}),(0,Bt.jsxs)(kRe,{id:"boq-tabs",activeKey:y,onSelect:e=>b(e),className:"mb-3",children:[(0,Bt.jsx)(ORe,{eventKey:"quantity",title:"Quantity Sheet",children:(0,Bt.jsx)(Xr,{style:{border:"none"},children:(0,Bt.jsxs)(Xr.Body,{style:{padding:"0.5rem"},children:[(0,Bt.jsxs)("div",{style:{display:"flex",gap:"20px",marginBottom:"15px",padding:"10px 15px",backgroundColor:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6",fontSize:"0.9rem"},children:[(0,Bt.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,Bt.jsx)("span",{style:{fontWeight:"bold",color:"#28a745",fontSize:"16px",border:"1px solid #28a745",background:"#f0fff4",padding:"2px 8px",borderRadius:"4px",minWidth:"28px",textAlign:"center"},children:"+"}),(0,Bt.jsx)("span",{style:{color:"#495057"},children:"Addition (adds to total)"})]}),(0,Bt.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,Bt.jsx)("span",{style:{fontWeight:"bold",color:"#dc3545",fontSize:"16px",border:"1px solid #dc3545",background:"#fff5f5",padding:"2px 8px",borderRadius:"4px",minWidth:"28px",textAlign:"center"},children:"-"}),(0,Bt.jsx)("span",{style:{color:"#495057"},children:"Deduction (subtracts from total - e.g., doors, windows)"})]})]}),(0,Bt.jsxs)("div",{style:{position:"relative"},children:[f&&(0,Bt.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.8)",zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px"},children:(0,Bt.jsxs)("div",{className:"text-center",children:[(0,Bt.jsx)(tn,{animation:"border",size:"sm",role:"status",children:(0,Bt.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,Bt.jsx)("div",{className:"mt-2",style:{fontSize:"14px",color:"#666"},children:"Loading floor data..."})]})}),(0,Bt.jsx)("div",{style:{border:"2px solid #ddd",borderRadius:"4px"},children:(0,Bt.jsx)(O2,{ref:B,data:w,columns:Ne,colHeaders:!0,rowHeaders:e=>{const t=w[e];if(!t)return e+1;if(t.isGroupHeader)return t.srNo||e+1;{const n=t.groupIndex,r=w.find(e=>e.groupIndex===n&&e.isGroupHeader),i=r?r.srNo:n;let o=0;for(let t=0;t<e;t++)w[t]&&w[t].groupIndex===n&&!w[t].isGroupHeader&&o++;return"".concat(i,".").concat(o+1)}},width:"100%",height:"600px",licenseKey:"non-commercial-and-evaluation",stretchH:"all",contextMenu:!0,manualColumnResize:!0,beforeOnCellContextMenu:(e,t)=>{const n=w[t.row];if(null!==n&&void 0!==n&&n.isGroupHeader)return e.stopImmediatePropagation(),!1},afterCreateRow:(e,t,n)=>{if("ContextMenu.rowBelow"===n||"ContextMenu.rowAbove"===n){const r=[...w];let i="ContextMenu.rowBelow"===n?e-1:e+1;if(i>=0&&i<r.length){const n=r[i];if(n&&!n.isGroupHeader){for(let i=0;i<t;i++)r[e+i]={groupIndex:n.groupIndex,isGroupHeader:!1,isDeduction:!1,component:"",no:"",length:"",widthBreadth:"",heightDepth:"",quantity:"",unit:"",rate:"",amount:""};x(r)}}}},afterChange:(e,t)=>{if("loadData"!==t&&e){const t=new Set;e.forEach(e=>{let[n,r,i,o]=e;const a=w[n];a&&!a.isGroupHeader&&t.add(a.groupIndex),["no","length","widthBreadth","heightDepth"].includes(r)&&(e=>{var t;const n=null===(t=B.current)||void 0===t?void 0:t.hotInstance;if(!n)return;const r=n.getSourceDataAtRow(e);if(r&&!r.isGroupHeader){const t=(parseFloat(r.no)||0)*(parseFloat(r.length)||0)*(parseFloat(r.widthBreadth)||0)*(parseFloat(r.heightDepth)||0);n.setDataAtRowProp(e,"quantity",t.toFixed(2))}})(n),"quantity"===r&&a&&!a.isGroupHeader&&t.add(a.groupIndex)}),setTimeout(()=>{t.forEach(e=>{ie(e)}),c&&(ue(c),xe())},50)}},cells:(e,t,n)=>{const r={},i=w[e];return i&&(!i.isGroupHeader&&i.isDeduction&&(r.className="htMiddle deduction-row","action"!==n&&"unit"!==n&&(r.renderer=function(e,t,n,r,i,o,a){if("numeric"===a.type?bbe.renderers.NumericRenderer.apply(this,arguments):bbe.renderers.TextRenderer.apply(this,arguments),t.style.backgroundColor="#fff5f5",t.style.color="#c53030","quantity"===i&&o){const e=parseFloat(o);!isNaN(e)&&e>0&&(t.innerHTML="-"+t.innerHTML)}return t})),i.isGroupHeader?(r.readOnly=!0,r.className="htMiddle","mixture"===n&&(r.readOnly=!1),"srNo"!==n&&"component"!==n||(r.className+=" group-header",r.renderer=function(e,t,n,r,i,o,a){return t.style.backgroundColor="#4a5568",t.style.color="#ffffff",t.style.fontWeight="600",t.style.padding="10px 8px",t.style.fontSize="13px",t.innerHTML=o||"",t})):"component"!==n&&"quantity"!==n||(r.readOnly=!1),i.isGroupHeader||"mixture"!==n||(r.readOnly=!0,r.renderer=function(e,t,n,r,i,o,a){return t.style.backgroundColor="#f9f9f9",t.style.color="#999",t.style.textAlign="center",t.innerHTML="",t}),!i.isGroupHeader||"unit"!==n&&"mixture"!==n&&"quantity"!==n||(r.renderer=function(e,t,n,r,i,o,a){return t.style.backgroundColor="#f7fafc",t.style.fontWeight="600",t.style.padding="10px 8px",t.style.fontSize="13px",t.style.color="#4a5568",t.style.textAlign="center","quantity"===i?(t.style.textAlign="right",t.innerHTML=o||"0.00"):t.innerHTML=o||"",t}),i.isGroupHeader||"unit"!==n||(r.readOnly=!0)),r}},"table-".concat(E))})]})]})})}),(0,Bt.jsx)(ORe,{eventKey:"material",title:"Floor wise Pricing",children:(0,Bt.jsx)(Xr,{style:{border:"none"},children:(0,Bt.jsx)(Xr.Body,{children:(0,Bt.jsx)("div",{style:{padding:"1rem 0"},children:(0,Bt.jsx)(O2,{ref:z,data:S,columns:Ee,colHeaders:!0,rowHeaders:e=>{const t=S[e];if(!t)return e+1;if(t.isGroupHeader){let t=1;for(let n=0;n<e;n++)S[n]&&S[n].isGroupHeader&&t++;return t}{let t=-1;for(let i=e-1;i>=0;i--)if(S[i]&&S[i].isGroupHeader){t=i;break}let n=1;for(let e=0;e<t;e++)S[e]&&S[e].isGroupHeader&&n++;let r=0;for(let i=t+1;i<=e;i++)S[i]&&!S[i].isGroupHeader&&r++;return"".concat(n,".").concat(r)}},width:"100%",height:"600px",licenseKey:"non-commercial-and-evaluation",stretchH:"all",contextMenu:!0,manualColumnResize:!0,fixedColumnsLeft:1,afterChange:(e,t)=>{var n;if(!e||"loadData"===t)return;c&&"edit"===t&&($.current[c]=!0);const r=null===(n=z.current)||void 0===n?void 0:n.hotInstance;if(!r)return;const i=new Set;e.forEach(e=>{let[t,n,o,a]=e;const s=r.getSourceDataAtRow(t);if(s){if(s.isGroupHeader&&"labourRate"===n){const e=((parseFloat(s.volume)||0)*(parseFloat(a)||0)).toFixed(2);r.setDataAtRowProp(t,"labourAmount",e),i.add(t)}if(!s.isGroupHeader){if("component"===n&&a&&j){const e=j.find(e=>e.material===a);e&&(r.setDataAtRowProp(t,"materialRate",parseFloat(e.defaultRate)||0),r.setDataAtRowProp(t,"wastage",parseFloat(e.wastage)||0),r.setDataAtRowProp(t,"uom",e.unit||"KG"))}if(["materialQty","wastage","materialRate","labourRate","component"].includes(n)){Ce(t);const e=r.getSourceData();for(let n=t-1;n>=0;n--)if(e[n]&&e[n].isGroupHeader){i.add(n);break}}}}}),i.size>0&&setTimeout(()=>{const e=r.getSourceData();i.forEach(t=>{Se(r,e,t)})},50)},cells:(Te=j,Ae=w,function(e,t,n){const r={},i=this.instance.getSourceDataAtRow(e);if(i){if("component"===n&&!i.isGroupHeader){let t=null;for(let n=e-1;n>=0;n--){const e=this.instance.getSourceDataAtRow(n);if(e&&e.isGroupHeader){const n=Ae.find(t=>t.isGroupHeader&&t.component===e.component);n&&n.category&&(t=n.category);break}}if(t&&Te&&Te.length>0){const e=Te.filter(e=>e.categoryName&&e.categoryName.toLowerCase()===t.toLowerCase()).map(e=>e.material).filter(e=>e);r.source=e,r.readOnly=!1}else r.source=[],r.readOnly=!1}if(i.isGroupHeader)"component"===n?(r.className="group-header",r.source=[],r.readOnly=!0,r.renderer=function(e,t,n,r,i,o,a){return t.style.backgroundColor="#4a5568",t.style.color="#ffffff",t.style.fontWeight="600",t.style.padding="10px 8px",t.style.fontSize="13px",t.innerHTML=o||"",t}):r.renderer="volume"===n||"unit"===n||"labourRate"===n?function(e,t,n,r,i,o,a){return t.style.backgroundColor="#f7fafc",t.style.fontWeight="600",t.style.padding="10px 8px",t.style.fontSize="13px",t.style.color="#4a5568",t.style.textAlign="volume"===i?"right":"center",t.innerHTML=o||"",t}:"materialAmount"===n||"labourAmount"===n||"totalAmount"===n?function(e,t,n,r,i,o,a){return t.style.backgroundColor="#f7fafc",t.style.fontWeight="600",t.style.padding="10px 8px",t.style.fontSize="13px",t.style.color="#4a5568",t.style.textAlign="right",t.innerHTML=o?parseFloat(o).toFixed(2):"",t}:function(e,t,n,r,i,o,a){return t.style.backgroundColor="#f7fafc",t.innerHTML="",t};else{if("component"!==n&&"wastage"!==n&&"materialRate"!==n||(r.readOnly=!1),"materialQty"===n){const e=i.component||"",t=["Cement","Steel","Sand","Aggregate","Water","Bricks","D/Bar"].some(t=>e.toLowerCase().includes(t.toLowerCase()));r.readOnly=t}"totalQty"===n&&(r.readOnly=!0)}}return r})})})})})})]})]})})})}),(0,Bt.jsxs)(ga,{show:M,onHide:()=>D(!1),centered:!0,children:[(0,Bt.jsx)(ga.Header,{closeButton:!0,children:(0,Bt.jsx)(ga.Title,{children:"Add Component"})}),(0,Bt.jsx)(ga.Body,{children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Select Component to Add"}),(0,Bt.jsxs)(Ki.Select,{value:I,onChange:e=>P(e.target.value),children:[(0,Bt.jsx)("option",{value:"",children:"-- Select Component --"}),_.map((e,t)=>(0,Bt.jsxs)("option",{value:e.component,children:[e.component," (",e.unit,")"]},t))]}),0===_.length&&(0,Bt.jsx)(Ki.Text,{className:"text-muted",children:"All components from AreaCalculation are already added to this floor."})]})}),(0,Bt.jsxs)(ga.Footer,{children:[(0,Bt.jsx)(gr,{variant:"secondary",onClick:()=>D(!1),children:"Cancel"}),(0,Bt.jsx)(gr,{variant:"primary",onClick:le,disabled:!I,children:"Add Component"})]})]})]});var Te,Ae};gbe();const PRe=["BedRoom","Living Room","Kitchen","Bathroom","Store"],jRe=["Mumbai","Delhi","Bangalore","Hyderabad","Ahmedabad","Chennai","Kolkata","Pune","Jaipur","Surat","Lucknow","Kanpur","Nagpur","Indore","Thane","Bhopal","Visakhapatnam","Pimpri-Chinchwad","Patna","Vadodara"],FRe=()=>{const[e,t]=(0,g.useState)([]),[n,r]=(0,g.useState)(""),[i,o]=(0,g.useState)(!1),[a,s]=(0,g.useState)("Floor"),[l,c]=(0,g.useState)(""),[u,d]=(0,g.useState)(""),[h,f]=(0,g.useState)({show:!1,type:"",message:""}),[m,p]=(0,g.useState)(1),[v,y]=(0,g.useState)("Civil Material");g.useEffect(()=>{4===m&&y("Civil Material")},[m]);const[b,w]=(0,g.useState)(""),[x,S]=(0,g.useState)(""),[C]=(0,g.useState)((new Date).toLocaleDateString("en-IN")),[N]=(0,g.useState)("Admin User"),[T,A]=(0,g.useState)(""),[R,k]=(0,g.useState)(""),[M,D]=(0,g.useState)(0),[_,O]=(0,g.useState)(80),[I,P]=(0,g.useState)(""),[j,F]=(0,g.useState)(1),[H,L]=(0,g.useState)(!1),[B,z]=(0,g.useState)(1),[W,V]=(0,g.useState)(!1),[U,q]=(0,g.useState)(0),[G,Y]=(0,g.useState)({}),[K,$]=(0,g.useState)([{type:"",units:1,area:"",rooms:""},{type:"",units:1,area:"",rooms:""},{type:"",units:1,area:"",rooms:""}]),[X,Q]=(0,g.useState)({}),[J,Z]=(0,g.useState)(!1),[ee,te]=(0,g.useState)(null),[ne,re]=(0,g.useState)(null),[ie,oe]=(0,g.useState)([]),[ae,se]=(0,g.useState)([]),[le,ce]=(0,g.useState)({}),[ue,de]=(0,g.useState)(!0),[he,fe]=(0,g.useState)([]),[me,pe]=(0,g.useState)(""),[ge,ve]=(0,g.useState)(new Set),ye=(0,g.useRef)(null),[be,we]=(0,g.useState)(null),[,xe]=(0,g.useState)([]),Se=(e,n,r,i)=>{t(t=>Array.isArray(t)?t.map(t=>t.floor!==e?t:"beam"===n?E(E({},t),{},{beam:E(E({},t.beam),{},{[r]:i})}):"column"===n?E(E({},t),{},{column:E(E({},t.column),{},{[r]:i})}):"floor"===n&&"floorHeight"===r?E(E({},t),{},{floorHeight:i}):t):t)};let Ce=0,Ee=0,Ne=0,Te=0,Re=0,ke=0;"undefined"!==typeof G&&"undefined"!==typeof X&&Object.entries(G).forEach(e=>{let[t,n]=e;n.forEach((e,n)=>{const r="".concat(t,"-").concat(n),i=X[r]||{};Object.entries(i.Count||{}).forEach(e=>{let[t,n]=e;/bed\s*room/i.test(t)&&(Ce+=Number(n)||0),/bath/i.test(t)&&(Ee+=Number(n)||0),/kitchen/i.test(t)&&(Ne+=Number(n)||0),ke+=Number(n)||0}),Object.values(i.Door||{}).forEach(e=>{Te+=Number(e.count)||0}),Object.values(i.Window||{}).forEach(e=>{Re+=Number(e.count)||0})})}),(0,g.useEffect)(()=>{if(!be)return;const t=[];for(let n=0;n<=Number(j)+1;n++){let r="";r=0===n?"Foundation":1===n?"Ground Floor":2===n?"1st Floor":3===n?"2nd Floor":4===n?"3rd Floor":"".concat(n-1,"th Floor");let i=e&&Array.isArray(e)?e.find(e=>e.floor===r):null;!i&&n>=2&&e&&Array.isArray(e)&&(i=e.find(e=>"Other Floors"===e.floor));const o=null!==be&&void 0!==be&&be.calculation_components?Object.entries(be.calculation_components).filter(e=>{let[t,n]=e;const i=n["Applicable Floors"];return!i||("Foundation"===r?i.map(e=>e.toLowerCase()).includes("foundation"):i.map(e=>e.toLowerCase()).includes(r.toLowerCase())||i.map(e=>e.toLowerCase()).includes("all floors"))}).map(e=>{let[t,n]=e;const o=E(E(E({width:Number(T)||0,depth:Number(R)||0,floors:Number(j)||1,carpetPercent:Number(_)||0,buildupPercent:Number(M)||0,constructionPerimeter:Number(l)||0,lift:H?1:0,sba:Number(M)||0,carpetArea:Number(u)||0,super_buildup_area:Number(M)||0,ground_floor_sba:Number(M)||0,buildup_area:Number(M)||0},i&&i.beam?{beamGridSpacing:i.beam.gridSpacing,beamWidth:i.beam.width,beamDepth:i.beam.depth}:{}),i&&i.column?{columnGridSpacing:i.column.gridSpacing,columnWidth:i.column.width,columnDepth:i.column.depth,columnHeight:i.column.height}:{}),i&&void 0!==i.floorHeight?{floorHeight:i.floorHeight}:{});let a="-";if(n.formula)try{a="function"===typeof Uj?Uj(n.formula,o):"-"}catch(qb){a="-"}return/beam|column/i.test(t)&&!i&&(a="-"),E(E({floor:r,component:t,category:n.Category||"",volume_cuft:a},n),{},{floorBeamColumnConfig:i?E({},i):null})}):[];t.push(...o)}xe(t)},[be,T,R,j,_,M,u,l,H,e]);const[De,_e]=(0,g.useState)(!1),[Oe,Ie]=(0,g.useState)(null),[Pe,je]=(0,g.useState)({}),[Fe,He]=(0,g.useState)({}),[Le,Be]=(0,g.useState)(0),[ze,We]=(0,g.useState)("basic"),[Ve,Ue]=(0,g.useState)(""),qe=Ae(),Ge=Me(),{mode:Ye,id:Ke}=qe.state||{},$e="view"===Ye,Xe="new"===Ye,[Qe,Je]=(0,g.useState)(null),[Ze,et]=(0,g.useState)([]),[tt,nt]=(0,g.useState)({}),[rt,it]=(0,g.useState)({}),[ot]=(0,g.useState)({}),[at]=(0,g.useState)("cuft"),[st,lt]=(0,g.useState)("Foundation"),[ct,ut]=(0,g.useState)(0),[dt,ht]=(0,g.useState)(0),[ft,mt]=(0,g.useState)(0),[pt,gt]=(0,g.useState)(0),[vt,yt]=(0,g.useState)(0),[bt,wt]=(0,g.useState)(0),[xt,St]=(0,g.useState)(0),[Ct,Et]=(0,g.useState)(0),[Nt,Tt]=(0,g.useState)({}),At=g.useMemo(()=>["Foundation",...U>0?[...Array(Number(U))].map((e,t)=>"Basement ".concat(t+1)):[],...[...Array(Number(j)+1).keys()].map(e=>0===e?"Ground Floor":1===e?"1st Floor":2===e?"2nd Floor":3===e?"3rd Floor":"".concat(e,"th Floor"))],[U,j]),Rt=(0,g.useMemo)(()=>{if(!Ze||!Array.isArray(Ze))return[];if(!Ve)return Ze;const e=Ve.toLowerCase();return Ze.filter(t=>Object.values(t).some(t=>t&&t.toString().toLowerCase().includes(e)))},[Ze,Ve]),kt=g.useMemo(()=>[{type:"",units:1,area:"",rooms:""},{type:"",units:1,area:"",rooms:""},{type:"",units:1,area:"",rooms:""}],[]),Mt=g.useCallback(e=>0!==e||W?G[e]||kt:K,[G,K,kt,W]),Dt=async()=>{let t=!1,n=[];for(let e=0;e<=Number(j);e++){if(0===e&&!W)continue;const r=Mt(e).find(e=>!e.type||!e.area);if(r){t=!0;const r=0===e?"Ground Floor":1===e?"1st Floor":2===e?"2nd Floor":3===e?"3rd Floor":"".concat(e,"th Floor");n.push(r)}}if(t)return void f({show:!0,type:"danger",message:"Please fill in all BHK Type and Carpet Area fields in Step 2. Missing data in: ".concat(n.join(", "))});const r=(new Date).toLocaleDateString("en-IN"),i={estimationRef:b||"EST-".concat(Date.now()),description:x||"Construction Estimation",createdDate:C,modifiedDate:r,createdBy:N,modifiedBy:N,projectDetails:{city:I,buildupArea:M,carpetArea:_,carpetAreaSqFt:Number(u)||0,constructionPerimeter:Number(l)||0,floors:Number(j),basementCount:Number(U)||0,groundFloorHasRooms:W||!1,liftIncluded:H,numberOfLifts:H?Number(B):0},floorConfiguration:Array.from({length:Number(j)+1},(e,t)=>{const n=Mt(t);let r="";return r=0===t?"Ground Floor":1===t?"1st Floor":2===t?"2nd Floor":3===t?"3rd Floor":"".concat(t,"th Floor"),{floor:r,floorIndex:t,isGroundFloor:0===t,hasRooms:0!==t||W,bhkUnits:0!==t||W?n.map((e,n)=>{const r="".concat(t,"-").concat(n),i=X[r]||{},o=[];if(i.Count){const e=i.Count||{},t=i["Length (ft)"]||{},n=i["Width (ft)"]||{};Object.keys(e).forEach(r=>{const a=Number(e[r]||0),s=Number(t[r]||0),l=Number(n[r]||0),c=a*s*l,u=i.Door&&i.Door[r]?i.Door[r]:void 0,d=i.Window&&i.Window[r]?i.Window[r]:void 0;a>0&&o.push(E(E({name:r,count:a,dimensions:{length:s,width:l,height:9},areaSqft:c},u&&{door:u}),d&&{window:d}))})}return{unitId:"".concat(t,"-").concat(n),bhkType:e.type||"",unitCount:Number(e.units)||0,carpetAreaSqft:Number(e.area)||0,totalRooms:e.rooms||"",rooms:o,totalRoomsArea:o.reduce((e,t)=>e+t.areaSqft,0)}}).filter(e=>e.unitCount>0):[]}}).filter(e=>e.isFoundation||e.isGroundFloor||e.bhkUnits.length>0),structuralConfiguration:{beamColumnConfig:(e&&Array.isArray(e)?e:[]).map(e=>{var t,n,r,i,o,a,s;return{floor:e.floor,beamConfiguration:{gridSpacing:(null===(t=e.beam)||void 0===t?void 0:t.gridSpacing)||0,width:(null===(n=e.beam)||void 0===n?void 0:n.width)||0,depth:(null===(r=e.beam)||void 0===r?void 0:r.depth)||0},columnConfiguration:{gridSpacing:(null===(i=e.column)||void 0===i?void 0:i.gridSpacing)||0,width:(null===(o=e.column)||void 0===o?void 0:o.width)||0,depth:(null===(a=e.column)||void 0===a?void 0:a.depth)||0,height:(null===(s=e.column)||void 0===s?void 0:s.height)||0}}})},metadata:{version:"1.0",documentType:"construction_estimation",savedFrom:"step1_comprehensive",totalUnits:Object.values(G).flat().reduce((e,t)=>e+(Number(t.units)||0),0),totalFloors:Number(j)+1,basementCount:Number(U)||0,groundFloorHasRooms:W||!1,hasLift:H,estimationStage:"initial_planning"}},o=JSON.stringify(i,null,2);localStorage.setItem("mongoDocument_step1",o);try{const e="https://buildproapi.onrender.com";let t,n;if(!Ke)throw new Error("No project ID found. Please create a new project first.");t="".concat(e,"/api/ProjectEstimation/").concat(Ke),n="PUT";const r=await fetch(t,{method:n,headers:{"Content-Type":"application/json"},body:o});if(!r.ok){const e=await r.json().catch(()=>null),t=(null===e||void 0===e?void 0:e.message)||"Server returned ".concat(r.status,": ").concat(r.statusText);throw new Error(t)}const i=await r.json();console.log("Project saved successfully:",i),f({show:!0,type:"success",message:"Project estimation saved successfully!"}),setTimeout(()=>{f({show:!1,type:"",message:""})},3e3)}catch(mW){console.error("Error saving to database:",mW),f({show:!0,type:"danger",message:"Failed to save project: ".concat(mW.message,". Data has been saved locally as backup.")}),setTimeout(()=>{f({show:!1,type:"",message:""})},5e3)}},_t=async e=>{try{if(!window.BOQEstimation_getAllMaterialData)return void console.log("Material data function not available");const t=window.BOQEstimation_getAllMaterialData();if(!t||0===t.length)return void console.log("No material data to save");console.log("Saving material data:",t);const n="https://buildproapi.onrender.com",r=await fetch("".concat(n,"/api/PriceEstimationForMaterialAndLabour/by-estimation-master/").concat(e));let i=null;if(r.ok){const e=await r.json();console.log("Existing material data check:",e),e&&e.records&&e.records.length>0&&(i=e.records[0]._id,console.log("Found existing material record ID:",i))}const o={estimationMasterId:e,floors:t.map(e=>({floorName:e.floorName,components:e.components}))};let a;if(console.log("Material payload:",o),i?(console.log("Updating existing material record with ID:",i),a=await fetch("".concat(n,"/api/PriceEstimationForMaterialAndLabour/").concat(i),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})):(console.log("Creating new material record"),a=await fetch("".concat(n,"/api/PriceEstimationForMaterialAndLabour"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})),!a.ok){const e=await a.json().catch(()=>({message:"Failed to save material data"}));throw new Error(e.message||"Server error: ".concat(a.status))}const s=await a.json();console.log("Material data save successful:",s)}catch(mW){console.error("Error saving material data:",mW)}};async function Ot(){try{let e=ie;e&&0!==e.length||(await Lt(),e=ie);const t=[],n={},r=new Set;for(const a of e)if(!r.has(a.type)){t.push({type:a.type,units:1,area:a.total_carpet_area_sqft.toString(),rooms:a.rooms.map(e=>e.name).join(", ")});const e="default-".concat(a.type),i={Count:{},"Length (ft)":{},"Width (ft)":{}},o=new Map;a.rooms.forEach(e=>{let t;const n=e.name.split(" ");t=n.length>1&&/^\d+$/.test(n[n.length-1])?n.slice(0,-1).join(" "):e.name,o.has(t)||o.set(t,[]),o.get(t).push(e)});const s=[];o.forEach((e,t)=>{1===e.length?s.push(t):e.forEach((e,n)=>{s.push("".concat(t," ").concat(n+1))})}),o.forEach((e,t)=>{if(1===e.length){const n=t,r=e[0];i.Count[n]=n.toLowerCase().includes("bathroom")&&a.bathroom_count||1,i["Length (ft)"][n]=r.dimensions_ft.length,i["Width (ft)"][n]=r.dimensions_ft.width}else e.forEach((e,n)=>{const r="".concat(t," ").concat(n+1);i.Count[r]=r.toLowerCase().includes("bathroom")&&a.bathroom_count||1,i["Length (ft)"][r]=e.dimensions_ft.length,i["Width (ft)"][r]=e.dimensions_ft.width})}),n[e]=i,r.add(a.type)}const i=E({},G),o=E({},X);for(let a=1;a<=Number(j);a++)i[a]=t.map(e=>E({},e)),t.forEach((e,t)=>{const r="".concat(a,"-").concat(t),i="default-".concat(e.type);o[r]=n[i]});Y(i),Q(o),alert("Default BHK configurations set for all floors with modal grid child data.\n".concat(t.map(e=>"".concat(e.type,": ").concat(e.area," sq ft")).join("\n")))}catch(mW){console.error("Error setting default BHK configuration:",mW),alert("Failed to set default configurations. Please try again.")}}const[It]=(0,g.useState)(""),[Pt]=(0,g.useState)("");(0,g.useEffect)(()=>{(async()=>{if("edit"!==Ye&&"view"!==Ye||!Ke){if("new"===Ye&&Ke)try{const e="".concat("https://buildproapi.onrender.com","/api/ProjectEstimation/").concat(Ke),t=await fetch(e);if(!t.ok)throw new Error("Failed to load project data");const n=await t.json();w(n.estimationRef||"")}catch(mW){console.error("Error loading estimation ref:",mW)}}else try{var e;const o="".concat("https://buildproapi.onrender.com","/api/ProjectEstimation/").concat(Ke),a=await fetch(o);if(!a.ok)throw new Error("Failed to load project data");const s=await a.json();var t,n,r,i;if(w(s.estimationRef||""),S(s.description||""),s.projectDetails)P(s.projectDetails.city||""),A((null===(t=s.projectDetails.sbaWidth)||void 0===t?void 0:t.toString())||""),k((null===(n=s.projectDetails.sbaLength)||void 0===n?void 0:n.toString())||""),D(s.projectDetails.buildupArea||90),d((null===(r=s.projectDetails.carpetAreaSqFt)||void 0===r?void 0:r.toString())||""),c((null===(i=s.projectDetails.constructionPerimeter)||void 0===i?void 0:i.toString())||""),F(s.projectDetails.floors||1),q(s.projectDetails.basementCount||0),V(s.projectDetails.groundFloorHasRooms||!1),L(s.projectDetails.liftIncluded||!1),z(s.projectDetails.numLifts||1);if(s.floorConfiguration&&Array.isArray(s.floorConfiguration)){const e={},t={},n=new Set;s.floorConfiguration.forEach((r,i)=>{r.bhkUnits&&Array.isArray(r.bhkUnits)&&(e[i]=r.bhkUnits.map((e,t)=>{var n,r;return{type:e.bhkType||"",units:e.unitCount||0,area:(null===(n=e.carpetAreaSqft)||void 0===n?void 0:n.toString())||"",rooms:(null===(r=e.rooms)||void 0===r?void 0:r.map(e=>e.name).join(", "))||""}}),r.bhkUnits.forEach((e,r)=>{if(e.rooms&&Array.isArray(e.rooms)&&e.rooms.length>0){const o="".concat(i,"-").concat(r);n.add(o);const a={Count:{},"Length (ft)":{},"Width (ft)":{},Door:{},Window:{}};e.rooms.forEach(e=>{var t,n;a.Count[e.name]=e.count||0,a["Length (ft)"][e.name]=(null===(t=e.dimensions)||void 0===t?void 0:t.length)||0,a["Width (ft)"][e.name]=(null===(n=e.dimensions)||void 0===n?void 0:n.width)||0;const r=e.door||e.Door,i=e.window||e.Window;a.Door[e.name]={count:(null===r||void 0===r?void 0:r.count)||0,width:(null===r||void 0===r?void 0:r.width)||0,height:(null===r||void 0===r?void 0:r.height)||0},a.Window[e.name]={count:(null===i||void 0===i?void 0:i.count)||0,width:(null===i||void 0===i?void 0:i.width)||0,height:(null===i||void 0===i?void 0:i.height)||0}}),t[o]=a}}))}),Y(e),Q(t),ve(n);const r=[];s.floorConfiguration.forEach(e=>{e.bhkUnits&&Array.isArray(e.bhkUnits)&&e.bhkUnits.forEach(e=>{e.bhkType&&""!==e.bhkType.trim()&&r.push(e.bhkType)})});const i=[...new Set(r)];se(e=>{const t=[...e,...i];return[...new Set(t)]})}null!==(e=s.costEstimation)&&void 0!==e&&e.costLevel&&We(s.costEstimation.costLevel)}catch(mW){console.error("Error loading project data:",mW),alert("Error loading project data: "+mW.message)}})()},[Ye,Ke]),(0,g.useEffect)(()=>{const e="https://buildproapi.onrender.com";console.log("Fetching beam-column config from:","".concat(e,"/api/RoomConfiguration/beam-column-configurations")),fetch("".concat(e,"/api/RoomConfiguration/beam-column-configurations")).then(e=>e.json()).then(e=>{console.log("Beam-column config received:",e);const n=e.configurations||e;if(Array.isArray(n)&&n.length>0){t(n);const e=n.find(e=>"Foundation"===e.floor);var r,i,o,a,s,l,c;if(console.log("Foundation config:",e),e)ut(e.floorHeight||0),ht((null===(r=e.beam)||void 0===r?void 0:r.gridSpacing)||0),mt((null===(i=e.column)||void 0===i?void 0:i.gridSpacing)||0),gt((null===(o=e.beam)||void 0===o?void 0:o.width)||0),yt((null===(a=e.beam)||void 0===a?void 0:a.depth)||0),wt((null===(s=e.column)||void 0===s?void 0:s.width)||0),St((null===(l=e.column)||void 0===l?void 0:l.depth)||0),Et((null===(c=e.column)||void 0===c?void 0:c.height)||0)}}).catch(e=>{console.error("Error loading beam-column configurations:",e),t([])})},[]),(0,g.useEffect)(()=>{fetch("/SalmanWipro-directory/LabourWork.Json").then(e=>e.json()).then(e=>Tt(e))},[]);const[jt,Ft]=(0,g.useState)(null);(0,g.useEffect)(()=>{fetch("/SalmanWipro-directory/FinsishingMaterialCalculation.json").then(e=>e.json()).then(e=>Ft(e))},[]);const Ht=g.useMemo(()=>Nt&&"object"===typeof Nt?Object.entries(Nt).map(e=>{let[t,n]=e,r=n&&n.label?n.label:t;return"Earthwork"===t&&(r="Excavation"),"Backfilling"===t&&(r="Backfilling"),"RCC"===t&&(r="RCC Work"),"Ceiling Plaster"===t&&(r="Ceiling Plaster"),"Wall"===t&&(r="Wall Foundation"),{key:t,label:r}}):[],[Nt]);async function Lt(){try{de(!0);const e="".concat("https://buildproapi.onrender.com","/api/RoomConfiguration"),t=await fetch(e);if(!t.ok)throw new Error("Failed to load BHK configuration");const n=await t.json();oe(n);const r=[...new Set(n.map(e=>e.type))];se(r);const i={};n.forEach(e=>{i[e.type]||(i[e.type]=[]),i[e.type].push(e.total_carpet_area_sqft)}),Object.keys(i).forEach(e=>{i[e].sort((e,t)=>e-t)}),ce(i)}catch(mW){console.error("Error loading BHK configurations:",mW)}finally{de(!1)}}function zt(e){return le[e]||[]}function Wt(e,t,n,r){if(0!==e||W){if(Y(i=>{const o=[...Mt(e)];return o[t][n]="units"===n||"area"===n?Number(r):r,E(E({},i),{},{[e]:o})}),"type"===n||"area"===n){let o=null,a=!1;if("type"===n){const e=zt(r);e.length>0&&(o=ie.find(t=>t.type===r&&String(t.total_carpet_area_sqft)===String(e[0])),a=!!o)}else{var i;const n=null===(i=Mt(e)[t])||void 0===i?void 0:i.type;n&&(o=ie.find(e=>e.type===n&&String(e.total_carpet_area_sqft)===String(r)),a=!!o)}a&&o&&Array.isArray(o.rooms)&&Q(n=>{const r=E({},n),i="".concat(e,"-").concat(t);let a={Count:{},"Length (ft)":{},"Width (ft)":{},Door:{},Window:{}};return o.rooms.forEach(e=>{var t,n;a.Count[e.name]=1,a["Length (ft)"][e.name]=(null===(t=e.dimensions_ft)||void 0===t?void 0:t.length)||"",a["Width (ft)"][e.name]=(null===(n=e.dimensions_ft)||void 0===n?void 0:n.width)||"",a.Door[e.name]=e.Door?{count:e.Door.count||0,width:e.Door.width||0,height:e.Door.height||0}:{count:0,width:0,height:0},a.Window[e.name]=e.Window?{count:e.Window.count||0,width:e.Window.width||0,height:e.Window.height||0}:{count:0,width:0,height:0}}),r[i]=a,r})}}else{const e=[...K];e[t][n]="units"===n||"area"===n?Number(r):r,$(e),"Count"===n&&Q(e=>{const n="0-".concat(t),i=E({},e[n]||{Count:{},"Length (ft)":{},"Width (ft)":{},Door:{},Window:{}});return"object"===typeof r?i.Count=E({},r):Object.keys(i.Count).forEach(e=>{i.Count[e]=r}),E(E({},e),{},{[n]:i})})}}(0,g.useEffect)(()=>{if(!e||!Array.isArray(e)||0===e.length)return;const t=e.find(e=>e.floor===st);var n,r,i,o,a,s,l;t&&(ut(t.floorHeight||0),ht((null===(n=t.beam)||void 0===n?void 0:n.gridSpacing)||0),mt((null===(r=t.column)||void 0===r?void 0:r.gridSpacing)||0),gt((null===(i=t.beam)||void 0===i?void 0:i.width)||0),yt((null===(o=t.beam)||void 0===o?void 0:o.depth)||0),wt((null===(a=t.column)||void 0===a?void 0:a.width)||0),St((null===(s=t.column)||void 0===s?void 0:s.depth)||0),Et((null===(l=t.column)||void 0===l?void 0:l.height)||0))},[st,e]),g.useEffect(()=>{Lt()},[]),(0,g.useEffect)(()=>{(async()=>{try{const N="".concat("/SalmanWipro-directory","/AreaCalculationLogic.json"),T=await fetch(N,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!T.ok)throw new Error("Failed to fetch JSON file: ".concat(T.status," ").concat(T.statusText," from ").concat(T.url));const A=T.headers.get("content-type");if(!A||!A.includes("application/json"))throw await T.text(),new Error("Server returned ".concat(A||"unknown content type"," instead of JSON. This usually means the file was not found and a 404 HTML page was returned."));const R=await T.json();we(R);const k=R.calculation_components;var e,t,n,r,i,o,a,s,l,c,u,d,h,f,m,p,g,v,y,b,w,x,S,C,E;if(k)je({external_walls:100*(null===(e=k.external_walls)||void 0===e?void 0:e.percentage),beams_columns:100*(null===(t=k.beams_columns)||void 0===t?void 0:t.percentage),staircase_area:100*(null===(n=k.staircase_area)||void 0===n?void 0:n.percentage),lift_shaft_area:100*(null===(r=k.lift_shaft_area)||void 0===r?void 0:r.percentage),balcony_area:100*(null===(i=k.balcony_area)||void 0===i?void 0:i.percentage),utility_area:100*(null===(o=k.utility_area)||void 0===o?void 0:o.percentage),toilet_bath_area:100*(null===(a=k.toilet_bath_area)||void 0===a?void 0:a.percentage),common_corridor:100*(null===(s=k.common_corridor)||void 0===s?void 0:s.percentage),parking_area_ground:100*(null===(l=k.parking_area_ground)||void 0===l?void 0:l.percentage),foundation_area:100*(null===(c=k.foundation_area)||void 0===c?void 0:c.percentage),parapet_walls:100*(null===(u=k.parapet_walls)||void 0===u?void 0:u.percentage)}),He({internal_walls:null===(d=k.internal_walls)||void 0===d?void 0:d.thickness,external_walls:null===(h=k.external_walls)||void 0===h?void 0:h.thickness,slab_area:null===(f=k.slab_area)||void 0===f?void 0:f.thickness,ceiling_plaster:null===(m=k.ceiling_plaster)||void 0===m?void 0:m.thickness,beams_columns:null===(p=k.beams_columns)||void 0===p?void 0:p.thickness,staircase_area:null===(g=k.staircase_area)||void 0===g?void 0:g.thickness,lift_shaft_area:null===(v=k.lift_shaft_area)||void 0===v?void 0:v.thickness,balcony_area:null===(y=k.balcony_area)||void 0===y?void 0:y.thickness,utility_area:null===(b=k.utility_area)||void 0===b?void 0:b.thickness,toilet_bath_area:null===(w=k.toilet_bath_area)||void 0===w?void 0:w.thickness,common_corridor:null===(x=k.common_corridor)||void 0===x?void 0:x.thickness,parking_area_ground:null===(S=k.parking_area_ground)||void 0===S?void 0:S.thickness,foundation_area:null===(C=k.foundation_area)||void 0===C?void 0:C.thickness,parapet_walls:null===(E=k.parapet_walls)||void 0===E?void 0:E.thickness});_e(!0),Ie(null)}catch(mW){console.error("Failed to load area calculation logic:",mW),_e(!1),Ie(mW.message)}})()},[]),g.useEffect(()=>{!K||!Array.isArray(K)||j<=1||(Y(e=>{const t=E({},e);for(let n=1;n<j;n++){const r=e[n]||[],i=!r.length||r.length===K.length&&r.every((e,t)=>e.type===K[t].type&&e.area===K[t].area&&e.rooms===K[t].rooms);i&&(t[n]=K.map(e=>E({},e)))}return t}),Q(e=>{let t=E({},e);for(let n=1;n<j;n++)for(let e=0;e<K.length;e++){const r="".concat(n,"-").concat(e);t[r]||(t[r]={Count:{},"Length (ft)":{},"Width (ft)":{},Door:{},Window:{}})}return t}))},[K,j]);Number(T)&&Number(R)&&(Number(T),Number(R));function Vt(){Z(!1),te(null),re(null)}function Ut(){if(null==ne||null==ee)return[];const e="".concat(ne,"-").concat(ee),t=X[e]||{},n=["Count","Length (ft)","Width (ft)","Total Carpet Area","Door Count","Door Width (ft)","Door Height (ft)","Door Area (sqft)","Window Count","Window Width (ft)","Window Height (ft)","Window Area (sqft)"].map(e=>{const n={"Row Label":e};return he.forEach(r=>{if("Total Carpet Area"===e){const e=Number(t.Count&&t.Count[r]||0),i=Number(t["Length (ft)"]&&t["Length (ft)"][r]||0),o=Number(t["Width (ft)"]&&t["Width (ft)"][r]||0);n[r]=e*i*o}else if("Door Count"===e){const e=t.Door&&t.Door[r]||{};n[r]=e.count||0}else if("Door Width (ft)"===e){const e=t.Door&&t.Door[r]||{};n[r]=e.width||0}else if("Door Height (ft)"===e){const e=t.Door&&t.Door[r]||{};n[r]=e.height||0}else if("Door Area (sqft)"===e){const e=t.Door&&t.Door[r]||{},i=e.count||0,o=e.width||0,a=e.height||0;n[r]=i*o*a}else if("Window Count"===e){const e=t.Window&&t.Window[r]||{};n[r]=e.count||0}else if("Window Width (ft)"===e){const e=t.Window&&t.Window[r]||{};n[r]=e.width||0}else if("Window Height (ft)"===e){const e=t.Window&&t.Window[r]||{};n[r]=e.height||0}else if("Window Area (sqft)"===e){const e=t.Window&&t.Window[r]||{},i=e.count||0,o=e.width||0,a=e.height||0;n[r]=i*o*a}else n[r]=t[e]&&t[e][r]||0}),n});return n}function qt(e,t){var n;if(!e||"loadData"===t)return;const r="".concat(ne,"-").concat(ee),i=null===(n=ye.current)||void 0===n?void 0:n.hotInstance;if(!i)return;const o=i.getSourceData();Q(t=>{const n=E({},t);return n[r]||(n[r]={Count:{},"Length (ft)":{},"Width (ft)":{},Door:{},Window:{}}),n[r]=E(E({},n[r]),{},{Door:E({},n[r].Door||{}),Window:E({},n[r].Window||{})}),e.forEach(e=>{let[t,i,a,s]=e;if("Row Label"===i)return;const l=o[t]["Row Label"],c=i,u=Number(s)||0;"Count"===l||"Length (ft)"===l||"Width (ft)"===l?(n[r][l]||(n[r][l]={}),n[r][l][c]=u):"Door Count"===l?(n[r].Door[c]||(n[r].Door[c]={count:0,width:0,height:0}),n[r].Door[c]=E(E({},n[r].Door[c]),{},{count:u})):"Door Width (ft)"===l?(n[r].Door[c]||(n[r].Door[c]={count:0,width:0,height:0}),n[r].Door[c]=E(E({},n[r].Door[c]),{},{width:u})):"Door Height (ft)"===l?(n[r].Door[c]||(n[r].Door[c]={count:0,width:0,height:0}),n[r].Door[c]=E(E({},n[r].Door[c]),{},{height:u})):"Window Count"===l?(n[r].Window[c]||(n[r].Window[c]={count:0,width:0,height:0}),n[r].Window[c]=E(E({},n[r].Window[c]),{},{count:u})):"Window Width (ft)"===l?(n[r].Window[c]||(n[r].Window[c]={count:0,width:0,height:0}),n[r].Window[c]=E(E({},n[r].Window[c]),{},{width:u})):"Window Height (ft)"===l&&(n[r].Window[c]||(n[r].Window[c]={count:0,width:0,height:0}),n[r].Window[c]=E(E({},n[r].Window[c]),{},{height:u}))}),n}),setTimeout(()=>{var e;const t=null===(e=ye.current)||void 0===e?void 0:e.hotInstance;if(!t)return;const n=t.getSourceData();n.forEach((e,r)=>{const i=e["Row Label"];he.forEach(o=>{if("Total Carpet Area"===i){const i=n.find(e=>"Count"===e["Row Label"]),a=n.find(e=>"Length (ft)"===e["Row Label"]),s=n.find(e=>"Width (ft)"===e["Row Label"]),l=Number((null===i||void 0===i?void 0:i[o])||0)*Number((null===a||void 0===a?void 0:a[o])||0)*Number((null===s||void 0===s?void 0:s[o])||0);e[o]!==l&&t.setDataAtRowProp(r,o,l,"calculation")}else if("Door Area (sqft)"===i){const i=n.find(e=>"Door Count"===e["Row Label"]),a=n.find(e=>"Door Width (ft)"===e["Row Label"]),s=n.find(e=>"Door Height (ft)"===e["Row Label"]),l=Number((null===i||void 0===i?void 0:i[o])||0)*Number((null===a||void 0===a?void 0:a[o])||0)*Number((null===s||void 0===s?void 0:s[o])||0);e[o]!==l&&t.setDataAtRowProp(r,o,l,"calculation")}else if("Window Area (sqft)"===i){const i=n.find(e=>"Window Count"===e["Row Label"]),a=n.find(e=>"Window Width (ft)"===e["Row Label"]),s=n.find(e=>"Window Height (ft)"===e["Row Label"]),l=Number((null===i||void 0===i?void 0:i[o])||0)*Number((null===a||void 0===a?void 0:a[o])||0)*Number((null===s||void 0===s?void 0:s[o])||0);e[o]!==l&&t.setDataAtRowProp(r,o,l,"calculation")}})})},0)}function Gt(){const e=[{data:"Row Label",title:"",readOnly:!0,className:"htLeft htMiddle",width:150}];return he.forEach(t=>{e.push({data:t,title:"Circulation Space"===t?"Circulation Space":t,type:"numeric",numericFormat:{pattern:"0,0.00"},className:"htCenter htMiddle",width:100})}),e}function Yt(e,t,n,r,i,o,a){const s=e.getDataAtRowProp(n,"Row Label");return"numeric"===a.type?bbe.renderers.NumericRenderer.apply(this,arguments):bbe.renderers.TextRenderer.apply(this,arguments),0===r?(t.style.fontWeight="600",t.style.background="#f5f5f5",t.style.textAlign="right",t.style.fontSize="0.8rem",t.style.paddingRight="10px","Total Carpet Area"===s?(t.style.background="#e3f2fd",t.style.color="#1976d2",t.style.fontWeight="700"):s.includes("Door")?(t.style.background="#fffbe7",t.style.color="#b8860b","Door Count"===s&&(t.style.fontWeight="700")):s.includes("Window")&&(t.style.background="#e7f7ff",t.style.color="#1976d2","Window Count"===s&&(t.style.fontWeight="700"))):(t.style.fontSize="0.85rem","Total Carpet Area"===s?(t.style.background="#e8f5e9",t.style.color="#388e3c",t.style.fontWeight="700",a.readOnly=!0):"Door Area (sqft)"===s?(t.style.background="#fff9e6",t.style.color="#b8860b",t.style.fontWeight="600",a.readOnly=!0):"Window Area (sqft)"===s&&(t.style.background="#e3f2fd",t.style.color="#1976d2",t.style.fontWeight="600",a.readOnly=!0)),t}const Kt=(0,g.useMemo)(()=>{if(null===be||void 0===be||!be.calculation_components)return[];const t=(Number(j)||1)+1;return Array.from({length:t+1},(e,t)=>(e=>{if(0===e)return"Foundation";if(1===e)return"Ground Floor";if(e>=2){const t=e-1;let n="th";return t%10===1&&t%100!==11?n="st":t%10===2&&t%100!==12?n="nd":t%10===3&&t%100!==13&&(n="rd"),"".concat(t).concat(n," Floor")}return"Unknown"})(t)).map((n,r)=>{const i=e=>String(e).toLowerCase().replace(/\s|\./g,"");let o=e&&Array.isArray(e)?e.find(e=>e.floor===n):null;!o&&r>=2&&e&&Array.isArray(e)&&(o=e.find(e=>"Other Floors"===e.floor));const a=o&&"undefined"!==typeof o.floorHeight?Number(o.floorHeight):10,s=Object.entries(be.calculation_components).filter(e=>{let[o,a]=e;const s=a["Applicable Floors"];if(!s)return!0;const l=i(n),c=s.map(e=>i(e));return"foundation"===l?c.includes("foundation"):"groundfloor"===l?c.includes("groundfloor"):!(!c.includes("topfloor")||r!==t)||(!!(c.includes("middlefloors")&&r>1&&r<t)||(!!c.includes("allfloors")||!!c.includes(l)))}).map(e=>{let[i,s]=e;const c=E(E(E({width:Number(T)||0,depth:Number(R)||0,floors:t,carpetPercent:Number(_)||0,buildupPercent:Number(M)||0,constructionPerimeter:Number(l)||0,lift:H?1:0,sba:Number(M)||0,carpetArea:Number(u)||0,super_buildup_area:Number(M)||0,ground_floor_sba:Number(M)||0,buildup_area:Number(M)||0},o&&o.beam?{beamGridSpacing:o.beam.gridSpacing,beamWidth:o.beam.width,beamDepth:o.beam.depth}:{}),o&&o.column?{columnGridSpacing:o.column.gridSpacing,columnWidth:o.column.width,columnDepth:o.column.depth,columnHeight:o.column.height}:{}),{},{floorHeight:a});let d="-",h=s.percentage?100*s.percentage:"-";void 0!==Pe[i]&&(h=Pe[i]);let f=s.thickness||"-";void 0!==Fe[i]&&(f=Fe[i]);let m=s.description||s.formula||"";if("internal_walls"===i){const e=s,t="undefined"!==typeof c.floorHeight?c.floorHeight:e.height||10,a=e.shared_wall_reduction||.2,l="function"===typeof Mt?Mt(r-1||0):[];let u=0,p=0,g=[],v=0,y=0;return l.forEach((e,n)=>{let i=1;if(Array.isArray(Mt(r-1||0))){const e=Mt(r-1||0)[n];i=Number(null===e||void 0===e?void 0:e.units)||1}const o="".concat(n+1,".").concat(e.type," (Units: ").concat(i,")");let s=[];const l="".concat(r-1||0,"-").concat(n),c=X&&X[l];if(!c)return;let d=0,h=0,f=0,m=0,b=0;c["Length (ft)"]&&c["Width (ft)"]&&Object.keys(c["Length (ft)"]).forEach(e=>{var n;if(e.toLowerCase().includes("balcony"))return;const r=Number(c["Length (ft)"][e])||0,o=Number(c["Width (ft)"][e])||0,a=Number((null===(n=c.Count)||void 0===n?void 0:n[e])||0);if(r>0&&o>0){const n=2*(r+o)*t*a*i;d+=n,s.push("".concat(e,": ").concat(r,"x").concat(o,"x").concat(t," = ").concat(n.toFixed(0)," sqft"))}}),s.push("Total Rooms Area: ".concat(d," sqft")),c.Door&&Object.keys(c.Door).forEach(e=>{const t=c.Door[e]||{count:0,width:0,height:0},n=Number(t.count)||0,r=Number(t.width)||0,i=Number(t.height)||0;m+=n*r*i,h+=n}),c.Window&&Object.keys(c.Window).forEach(e=>{const t=c.Window[e]||{count:0,width:0,height:0},n=Number(t.count)||0,r=Number(t.width)||0,i=Number(t.height)||0;b+=n*r*i,f+=n});const w=d*a,x=m*i,S=b*i;u+=h*(i||1),p+=f*(i||1),v=Math.max(0,d-(w+x+S)),y+=v;let C=x+S+w;s.push("Total Deduction: ".concat(C.toFixed(0)," sqft"));const E=[];E.push("Shared Wall Reduction: ".concat(100*a,"% \xd7 Room Area = ").concat(w," sqft")),E.push("Door Deduction: For ".concat(h*i," Doors = ").concat(x.toFixed(0)," sqft")),E.push("Window Deduction: For ".concat(f*i," Windows = ").concat(S.toFixed(0)," sqft")),E.push("Final Total Wall Area: ".concat(v.toFixed(0)," sqft")),g.push([o,...s,"--- Calculation Breakdown ---",...E].join("\n"))}),d=y.toFixed(0),m="Formula: Wall area minus ".concat(100*a,"% shared wall area, doors (").concat(u,"), windows (").concat(p,")"),E(E(E({key:i},s),{},{area:d,percentage:h,thickness:f,logic:m,logicDetails:g.join(" | "),isEditable:void 0!==s.percentage,isThicknessEditable:void 0!==f&&null!==f&&0!==Number(f),component:i,volume_cuft:(()=>{const e=Number(d),t=Number(f);return isNaN(e)||0===e||"-"===d?0:isNaN(t)||0===t||"-"===f?e:e*t})(),FloorName:n},o&&o.beam?{beamGridSpacing:o.beam.gridSpacing,beamWidth:o.beam.width,beamDepth:o.beam.depth}:{}),o&&o.column?{columnGridSpacing:o.column.gridSpacing,columnWidth:o.column.width,columnDepth:o.column.depth,columnHeight:o.column.height}:{})}if("external_walls"===i){const e=s,t="undefined"!==typeof c.floorHeight?c.floorHeight:e.height||10;return d=c.constructionPerimeter*t*c.floors,m="Construction Perimeter: ".concat(c.constructionPerimeter,"\xd7Floor Height: ").concat(t,"\xd7").concat(c.floors," = ").concat(d.toFixed(0)," sqft"),E(E({key:i},s),{},{area:d,percentage:h,thickness:f,logic:m,isEditable:void 0!==s.percentage,isThicknessEditable:void 0!==f&&null!==f&&0!==Number(f),component:i,volume_cuft:(()=>{const e=Number(d),t=Number(f);return isNaN(e)||0===e||"-"===d?0:isNaN(t)||0===t||"-"===f?e:e*t})(),FloorName:n})}if("Beams"===i){const e=c.width,t=c.depth,r=.85*e*t,o=e/t,a=Math.sqrt(r/o),l=o*a,u=c.beamGridSpacing||15,p=c.beamWidth||1,g=c.beamDepth||1.5,v=Math.floor(l/u)+1,y=Math.floor(a/u)+1,b=p*g,w=y*(v-1)+v*(y-1);return d=w*b*u,m="Grid: ".concat(w," beams, ").concat(u,"ft spacing, cross-section ").concat(b," sqft"),E(E({key:i},s),{},{area:d,percentage:h,thickness:f,logic:m,isEditable:void 0!==s.percentage,isThicknessEditable:void 0!==f&&null!==f&&0!==Number(f),component:i,volume_cuft:(()=>{const e=Number(d),t=Number(f);return isNaN(e)||0===e||"-"===d?0:isNaN(t)||0===t||"-"===f?e:e*t})(),FloorName:n})}if("Columns"===i){const e=c.width,t=c.depth,r=.85*e*t,o=e/t,a=Math.sqrt(r/o),l=o*a,u=c.beamGridSpacing||15,p=c.beamWidth||1,g=c.beamDepth||1.5,v=Math.floor(l/u)+1,y=Math.floor(a/u)+1,b=v*y,w=p*g;return d=b*w,m="Grid: ".concat(b," columns, ").concat(v,"x").concat(y," grid, cross-section ").concat(w," sqft"),E(E({key:i},s),{},{area:d,percentage:h,thickness:f,logic:m,isEditable:void 0!==s.percentage,isThicknessEditable:void 0!==f&&null!==f&&0!==Number(f),component:i,volume_cuft:(()=>{const e=Number(d),t=Number(f);return isNaN(e)||0===e||"-"===d?0:isNaN(t)||0===t||"-"===f?e:e*t})(),FloorName:n})}if("ExcavationVolume"===i){let e=s.percentage;void 0!==Pe[i]&&(e=Pe[i]/100);let t=s.thickness;return void 0!==Fe[i]&&(t=Fe[i]),d=c.super_buildup_area*(e||0),m="Excavation: ".concat(h,"% \xd7 Built-up Area (").concat(c.super_buildup_area,") = ").concat(d.toFixed(0)," sqft, Thickness: ").concat(t,"ft"),E(E({key:i},s),{},{area:d,percentage:h,thickness:t,logic:m,isEditable:void 0!==s.percentage,isThicknessEditable:void 0!==t&&null!==t&&0!==Number(t),component:i,volume_cuft:(()=>{const e=Number(d),n=Number(t);return isNaN(e)||0===e||"-"===d?0:isNaN(n)||0===n||"-"===t?e:e*n})(),FloorName:n})}if("BasementSlab"===i){let e=s.percentage;void 0!==Pe[i]&&(e=Pe[i]/100);let t=s.thickness;return void 0!==Fe[i]&&(t=Fe[i]),d=c.super_buildup_area*(e||0),m="Basement Slab: ".concat(h,"% \xd7 Built-up Area (").concat(c.super_buildup_area,") = ").concat(d.toFixed(0)," sqft, Thickness: ").concat(t,"ft"),E(E({key:i},s),{},{area:d,percentage:h,thickness:t,logic:m,isEditable:void 0!==s.percentage,isThicknessEditable:void 0!==f&&null!==f&&0!==Number(f),component:i,volume_cuft:(()=>{const e=Number(d),t=Number(f);return isNaN(e)||0===e||"-"===d?0:isNaN(t)||0===t||"-"===f?e:e*t})(),FloorName:n})}if("BasementWallVolume"===i){const e="undefined"!==typeof c.floorHeight?c.floorHeight:s.wallHeight||10,t=s.thickness||.75;return d=c.constructionPerimeter*e,m="Basement Wall: Construction Perimeter ".concat(c.constructionPerimeter,"\xd7").concat(e,"\xd7").concat(t," = ").concat((d*t).toFixed(0)," cuft"),E(E({key:i},s),{},{area:d,percentage:h,thickness:f,logic:m,isEditable:void 0!==s.percentage,isThicknessEditable:void 0!==f&&null!==f&&0!==Number(f),component:i,volume_cuft:(()=>{const e=Number(d),t=Number(f);return isNaN(e)||0===e||"-"===d?0:isNaN(t)||0===t||"-"===f?e:e*t})(),FloorName:n})}if("BasementBeam"===i){const e=c.width,t=c.depth,r=c.beamGridSpacing||15,o=c.beamWidth||1,a=c.beamDepth||1.5,l=Math.floor(e/r)+1,u=Math.floor(t/r)+1,p=o*a,g=u*(l-1)+l*(u-1);return d=g*p*r,m="Basement Beams: ".concat(g," beams, ").concat(r,"ft spacing, cross-section ").concat(p," sqft"),E(E({key:i},s),{},{area:d,percentage:h,thickness:f,logic:m,isEditable:void 0!==s.percentage,isThicknessEditable:void 0!==f&&null!==f&&0!==Number(f),component:i,volume_cuft:(()=>{const e=Number(d),t=Number(f);return isNaN(e)||0===e||"-"===d?0:isNaN(t)||0===t||"-"===f?e:e*t})(),FloorName:n})}if("Basementcolumns"===i){const e=c.width,t=c.depth,r=c.beamGridSpacing||15,o=c.beamWidth||1,a=c.beamDepth||1.5,l=Math.floor(e/r)+1,u=Math.floor(t/r)+1,p=l*u,g=o*a;return d=p*g,m="Basement Columns: ".concat(p," columns, ").concat(l,"x").concat(u," grid, cross-section ").concat(g," sqft"),E(E({key:i},s),{},{area:d,percentage:h,thickness:f,logic:m,isEditable:void 0!==s.percentage,isThicknessEditable:void 0!==f&&null!==f&&0!==Number(f),component:i,volume_cuft:(()=>{const e=Number(d),t=Number(f);return isNaN(e)||0===e||"-"===d?0:isNaN(t)||0===t||"-"===f?e:e*t})(),FloorName:n})}if(s.formula)try{let e=s.percentage;void 0!==Pe[i]&&(e=Pe[i]/100),d="percentage_of_carpet_area"===s.formula?c.carpetArea*(e||0):"percentage_of_buildup"===s.formula?Number(T)*Number(R)*(Number(M)/100)||0*(e||0):"percentage_of_super_buildup"===s.formula?c.super_buildup_area*(e||0):"same_as_super_buildup"===s.formula?c.super_buildup_area:"same_as_Built-up Area"===s.formula?Number(T)*Number(R)*(Number(M)/100)||0:"conditional_percentage_of_super_buildup"===s.formula?c.lift?c.super_buildup_area*(e||0):0:"conditional_percentage_of_buildup"===s.formula?c.lift?c.buildup_area*(e||0):0:"percentage_of_ground_floor_sba"===s.formula?c.ground_floor_sba*(e||0):Uj(s.formula,c)}catch(qb){d="-"}return E(E({key:i},s),{},{area:d,percentage:h,thickness:f,logic:m,isEditable:void 0!==s.percentage,isThicknessEditable:void 0!==f&&null!==f&&0!==Number(f),component:i,volume_cuft:(()=>{const e=Number(d),t=Number(f);return isNaN(e)||0===e||"-"===d?0:isNaN(t)||0===t||"-"===f?e:e*t})(),FloorName:n})});return s})},[be,T,R,j,_,M,u,l,H,Pe,Fe,X,Mt,e]),$t=g.useCallback(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"cuft";const n=Kt.flat(),r=Number(T)*Number(R)*(M/100);return n.length?"electrical work"===e.toLowerCase()||"plumbing"===e.toLowerCase()?r:"flooring"===e.toLowerCase()?n.filter((e,t)=>{var n,r;return t>=2&&("slab_area"===(null===(n=e.component)||void 0===n?void 0:n.toLowerCase())||"slabvolume"===(null===(r=e.Category)||void 0===r?void 0:r.toLowerCase()))}).reduce((e,n)=>"sqft"===t?e+(Number(n.area)||Number(n.Area)||0):e+(Number(n.volume_cuft)||0),0):"painting"===e.toLowerCase()?n.filter((e,t)=>{var n,r,i,o;return t>=2&&((null===(n=e.component)||void 0===n?void 0:n.toLowerCase().includes("wall"))||(null===(r=e.Category)||void 0===r?void 0:r.toLowerCase().includes("wall"))||(null===(i=e.component)||void 0===i?void 0:i.toLowerCase().includes("ceiling plaster"))||(null===(o=e.Category)||void 0===o?void 0:o.toLowerCase().includes("ceiling plaster")))}).reduce((e,n)=>"sqft"===t?e+(Number(n.area)||Number(n.Area)||0):e+(Number(n.volume_cuft)||0),0):n.filter(t=>"string"===typeof t.Category&&"string"===typeof e&&t.Category.toLowerCase()===e.toLowerCase()).reduce((e,n)=>"sqft"===t?e+(Number(n.area)||Number(n.Area)||0):e+(Number(n.volume_cuft)||0),0):0},[Kt,T,R,M]),Xt=Number(Le||0),Qt=Kt[Xt]||[];if(Kt&&Kt.length>0&&0===Xt){const e=Qt.findIndex(e=>"Backfilling"===e.component),t=Qt.find(e=>"ExcavationVolume"===e.component),n=Qt.find(e=>"BasementSlab"===e.component),r=Qt.find(e=>"BasementWallVolume"===e.component),i=Qt.find(e=>"BasementBeam"===e.component),o=Qt.find(e=>"Basementcolumns"===e.component);if(-1!==e&&t&&n&&r&&i&&o){let a=(isNaN(Number(t.volume_cuft))?0:Number(t.volume_cuft))-((isNaN(Number(n.volume_cuft))?0:Number(n.volume_cuft))+(isNaN(Number(r.volume_cuft))?0:Number(r.volume_cuft))+(isNaN(Number(i.volume_cuft))?0:Number(i.volume_cuft))+(isNaN(Number(o.volume_cuft))?0:Number(o.volume_cuft)));(!isFinite(a)||isNaN(a)||a<0)&&(a=0),Qt[e].volume_cuft=a}}(0,g.useEffect)(()=>{fetch("/SalmanWipro-directory/MaterialCalculation.json").then(e=>e.json()).then(e=>Je(e)).catch(e=>{console.error("Failed to load MaterialCalculation.json:",e),Je(null)})},[]);const[Jt,Zt]=(0,g.useState)(null);function en(e){if(!e)return e;const t={feet:"foot",men:"man",children:"child",geese:"goose",mice:"mouse",teeth:"tooth"},n=e.trim().toLowerCase();return t[n]?t[n]:n.endsWith("ies")?n.slice(0,-3)+"y":n.endsWith("ves")?n.slice(0,-3)+"f":!n.endsWith("es")||n.endsWith("ses")||n.endsWith("xes")?n.endsWith("s")&&n.length>3?n.slice(0,-1):n:n.slice(0,-2)}const tn=(0,g.useMemo)(()=>{if(!Jt)return{};const e={};return Object.values(Jt).forEach(t=>{Array.isArray(t)&&t.forEach(t=>{if(t.material&&t.unit&&Array.isArray(t.brands)){const n="".concat(t.material).trim().toLowerCase(),r=en("".concat(t.unit).trim().toLowerCase());e[n+"__"+r]={brands:t.brands,default_brand:t.default_brand||null}}})}),e},[Jt]);(0,g.useEffect)(()=>{fetch("/SalmanWipro-directory/MaterialRate.json").then(e=>e.json()).then(e=>Zt(e)).catch(e=>{console.error("Failed to load MaterialRate.json:",e),Zt(null)})},[]);const nn=(0,g.useCallback)(e=>{if(!Jt||!Jt.rate_structure)return"";if(Jt.rate_structure[e])return Jt.rate_structure[e].rate;const t=Object.keys(Jt.rate_structure).find(t=>t.toLowerCase()===e.toLowerCase());return t?Jt.rate_structure[t].rate:""},[Jt]);(0,g.useEffect)(()=>{if(!Qe)return;const e=Kt.flat(),t={};e.forEach(e=>{const n=e.FloorName||e.floor||"",r=e.Category||e.category||"",i="".concat(n,"||").concat(r);t[i]||(t[i]={floor:n,category:r,volume:0}),t[i].volume+=Number(e.volume_cuft)||0});const n=[];Object.values(t).forEach(e=>{let{floor:t,category:r,volume:i}=e;const o="Foundation"===(a=t)?"Foundation":"Ground Floor"===a?"GroundFloor":"Other Floor";var a;const s=Qe.floors.find(e=>e.name===o);if(!s||!s.components)return;let l=null;if(Object.prototype.hasOwnProperty.call(s.components,r))l=s.components[r];else{const e=Object.keys(s.components).find(e=>0===e.localeCompare(r,void 0,{sensitivity:"accent"}));e&&(l=s.components[e])}l&&l.materials&&Object.entries(l.materials).forEach(e=>{let[o,a]=e,s=0;const l="".concat(r,"_").concat(o,"_").concat(t||"");if(void 0!==rt[l])s=rt[l]*i;else if("string"===typeof a.qty){const e=a.qty.replace(/^{+|}+$/g,"");s="function"===typeof Uj?Uj(e.replace(/volume_cuft/g,i),{volume_cuft:i}):0}else s=a.qty*i;const c=void 0!==tt[l]?tt[l]:5,u=Number(nn(o)),d=s*(1+c/100),h=u?d*u:"";n.push({floor:t,category:r,material:o,volume:i,unit:a.unit,qty:a.qty,wastage:c,totalQty:d,rate:u,totalValue:h})})}),et(n)},[Qe,Kt,tt,rt,ot,nn]);const rn=(0,g.useMemo)(()=>{const e={};(Ze||[]).forEach(t=>{if(!t.material||!t.unit)return;const n="".concat(t.material).trim().toLowerCase(),r=en("".concat(t.unit).trim().toLowerCase()),i="".concat(n,"__").concat(r);e[i]||(e[i]={material:t.material,materialNorm:n,unit:t.unit,unitNorm:r,totalQty:0,category:"Civil Works"}),e[i].totalQty+=Number(t.totalQty)||0});const t=Object.values(e);const n={built_up_area_sqft:Number(M)||0,perimeter_ft:Number(l)||0,tile_area_sqft:"function"===typeof $t?$t("Flooring","sqft"):0,painting_area_sqft:"function"===typeof $t?$t("Painting","sqft"):0,room_count:"undefined"!==typeof ke?ke:0,toilet_count:"undefined"!==typeof Ee?Ee:0,kitchen_count:"undefined"!==typeof Ne?Ne:0,wet_points_count:("undefined"!==typeof Ee?Ee:0)+("undefined"!==typeof Ne?Ne:0),plastering_area_sqft:"function"===typeof $t?$t("Painting","sqft"):0,open_area_sqft:0,landscape_area_sqft:0,window_frame_area_sqft:0,door_count:"undefined"!==typeof Te?Te:0,Door_count:"undefined"!==typeof Te?Te:0,window_count:"undefined"!==typeof Re?Re:0,Window_count:"undefined"!==typeof Re?Re:0,floor_count:Number(j)},r=[];return jt&&Object.entries(jt).forEach(e=>{let[t,i]=e;i.forEach(e=>{const i=void 0!==e.manual_base_qty?e.manual_base_qty:e.quantity_formula?function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const r=e.replace(/\b([a-zA-Z_][a-zA-Z0-9_]*)\b/g,e=>Object.prototype.hasOwnProperty.call(t,e)?t[e]:Object.prototype.hasOwnProperty.call(n,e)?n[e]:0);return Uj(r)}catch(qb){return 0}}(e.quantity_formula,n,e):0,o=i*(1+(e.wastage_percent||0)/100),a="".concat(e.material).trim().toLowerCase(),s=en("".concat(e.unit).trim().toLowerCase());r.push({material:e.material,materialNorm:a,totalQty:o,unit:e.unit,unitNorm:s,category:t})})}),[...t,...r]},[Ze,jt,M,l,j,$t,Ee,Te,Ne,ke,Re]);return(0,Bt.jsxs)("div",{className:"wizard-container calculator-container",style:{width:"100%",maxWidth:"100%",padding:"0"},children:[h.show&&(0,Bt.jsxs)("div",{className:"alert alert-".concat(h.type," alert-dismissible fade show"),role:"alert",style:{position:"sticky",top:"10px",zIndex:1050,marginBottom:"1rem",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[(0,Bt.jsx)("strong",{children:"success"===h.type?"\u2713 Success!":"\u2717 Error!"})," ",h.message,(0,Bt.jsx)("button",{type:"button",className:"btn-close",onClick:()=>f({show:!1,type:"",message:""}),"aria-label":"Close"})]}),!De&&(0,Bt.jsx)("div",{style:{textAlign:"center",padding:"2rem",background:Oe?"#fff5f5":"#f8f9fa",borderRadius:"8px",margin:"1rem 0",border:"1px solid ".concat(Oe?"#fed7d7":"#dee2e6")},children:Oe?(0,Bt.jsxs)(Bt.Fragment,{children:[(0,Bt.jsx)("div",{style:{fontSize:"1.2rem",color:"#e53e3e",marginBottom:"0.5rem"},children:"\u274c Configuration Load Failed"}),(0,Bt.jsxs)("div",{style:{fontSize:"0.9rem",color:"#c53030",marginBottom:"1rem"},children:["Error: ",Oe]}),(0,Bt.jsx)("div",{style:{fontSize:"0.8rem",color:"#718096",marginBottom:"1rem"}})]}):(0,Bt.jsxs)(Bt.Fragment,{children:[(0,Bt.jsx)("div",{style:{fontSize:"1.2rem",color:"#666",marginBottom:"0.5rem"},children:"\u2699\ufe0f Loading Configuration..."}),(0,Bt.jsx)("div",{style:{fontSize:"0.9rem",color:"#888"},children:"Please wait while we load the calculation parameters from AreaCalculationLogic.json"})]})}),(0,Bt.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1.5rem"},children:[(0,Bt.jsxs)(gr,{variant:"outline-secondary",size:"sm",onClick:()=>Ge("/project-estimation"),style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.85rem",padding:"0.375rem 0.75rem",borderRadius:"6px"},children:[(0,Bt.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16",children:(0,Bt.jsx)("path",{fillRule:"evenodd",d:"M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z"})}),"Back"]}),(0,Bt.jsx)("h2",{className:"text-center text-primary mb-0",style:{fontWeight:500,letterSpacing:"1px",flex:1,textAlign:"center",fontSize:"1.25rem"},children:"Project Estimation Calculator"}),(0,Bt.jsx)("div",{style:{width:"120px"}})," "]}),It&&(0,Bt.jsxs)("div",{style:{margin:"2rem auto",maxWidth:600},children:[(0,Bt.jsx)("h5",{children:"OCR Raw Text"}),(0,Bt.jsx)("textarea",{value:It||Pt||"",readOnly:!0,rows:10,style:{width:"100%",fontFamily:"monospace",fontSize:"1rem",background:"#f4f4f4",borderRadius:8,border:"1px solid #ccc",padding:8}})]}),(0,Bt.jsx)("div",{className:"wizard-indicator",children:[1,2,3,4].map(e=>(0,Bt.jsxs)("span",{style:{position:"relative",display:"inline-block"},children:[(0,Bt.jsx)("span",{className:"wizard-circle".concat(m===e?" active":""),onClick:t=>{t.preventDefault(),(e=>{p(e)})(e)},children:e}),(0,Bt.jsx)("span",{style:{position:"absolute",left:"50%",top:"120%",transform:"translateX(-50%)",fontSize:"0.68em",color:"#b0b0b0",whiteSpace:"nowrap",pointerEvents:"none",minWidth:0,textAlign:"center",lineHeight:1.1,zIndex:2},children:1===e?"Project Details":2===e?"BHK Layout":3===e?"Component Calc":4===e?"Pricing Summary":""})]},e))}),(0,Bt.jsxs)("div",{className:"wizard-step-content",style:{padding:3===m?"0":"0 1rem",transition:"none",willChange:"auto"},children:[1===m&&(0,Bt.jsxs)(Bt.Fragment,{children:[(0,Bt.jsxs)("div",{style:{width:"100%",margin:"0 auto 1rem auto",padding:"0.5rem 0 0.2rem 0",textAlign:"center",borderBottom:"1px solid #e0e0e0"},children:[Ye&&(0,Bt.jsxs)("div",{style:{fontSize:"0.85rem",color:"view"===Ye?"#6c757d":"edit"===Ye?"#28a745":"#007bff",fontWeight:"500",marginBottom:"0.5rem",textTransform:"uppercase",letterSpacing:"1px"},children:["view"===Ye?"\ud83d\udc41\ufe0f VIEW MODE":"edit"===Ye?"\u270f\ufe0f EDIT MODE":"\u2795 NEW ENTRY",b&&" - ".concat(b)]}),(0,Bt.jsx)("h5",{style:{fontWeight:600,color:"#1976d2",margin:0,fontSize:"1.18rem",letterSpacing:"0.5px"},children:"Area Details"})]}),(0,Bt.jsxs)(mu,{className:"mb-4",children:[(0,Bt.jsx)(Ri,{md:3,sm:12,className:"mb-3",children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{style:{fontSize:"0.9rem",fontWeight:"500",color:"#495057",marginBottom:"0.5rem",display:"block"},children:"Estimation Ref#"}),(0,Bt.jsx)(Ki.Control,{type:"text",value:b,onChange:e=>w(e.target.value),placeholder:"Enter reference number",readOnly:$e||Xe,style:{borderRadius:"6px",border:"1px solid #ced4da",padding:"0.75rem",fontSize:"0.9rem",height:"42px",backgroundColor:$e||Xe?"#f8f9fa":"#fff",color:$e||Xe?"#6c757d":"#495057"}})]})}),(0,Bt.jsx)(Ri,{md:4,sm:12,className:"mb-3",children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{style:{fontSize:"0.9rem",fontWeight:"500",color:"#495057",marginBottom:"0.5rem",display:"block"},children:"Description"}),(0,Bt.jsx)(Ki.Control,{as:"textarea",rows:2,value:x,onChange:e=>S(e.target.value),placeholder:"Enter project description",readOnly:$e,style:{resize:"vertical",borderRadius:"6px",border:"1px solid #ced4da",padding:"0.75rem",fontSize:"0.9rem",minHeight:"42px",backgroundColor:$e?"#f8f9fa":"#fff",color:$e?"#6c757d":"#495057"}})]})}),(0,Bt.jsx)(Ri,{md:2,sm:6,className:"mb-3",children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{style:{fontSize:"0.9rem",fontWeight:"500",color:"#495057",marginBottom:"0.5rem",display:"block"},children:"Create Date"}),(0,Bt.jsx)(Ki.Control,{type:"text",value:C,readOnly:!0,style:{backgroundColor:"#f8f9fa",color:"#6c757d",borderRadius:"6px",border:"1px solid #e9ecef",padding:"0.75rem",fontSize:"0.9rem",height:"42px"}})]})}),(0,Bt.jsx)(Ri,{md:3,sm:6,className:"mb-3",children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{style:{fontSize:"0.9rem",fontWeight:"500",color:"#495057",marginBottom:"0.5rem",display:"block"},children:"User Name"}),(0,Bt.jsx)(Ki.Control,{type:"text",value:N,readOnly:!0,style:{backgroundColor:"#f8f9fa",color:"#6c757d",borderRadius:"6px",border:"1px solid #e9ecef",padding:"0.75rem",fontSize:"0.9rem",height:"42px"}})]})})]}),(0,Bt.jsxs)(Ki,{children:[(0,Bt.jsxs)(mu,{className:"mb-4",children:[(0,Bt.jsx)(Ri,{md:3,sm:12,className:"mb-3",children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{style:{fontSize:"0.9rem",fontWeight:"500",color:"#495057",marginBottom:"0.5rem",display:"block"},children:"Select City"}),(0,Bt.jsxs)(Ki.Select,{value:I,onChange:e=>P(e.target.value),disabled:$e,style:{borderRadius:"6px",border:"1px solid #ced4da",padding:"0.75rem",fontSize:"0.9rem",height:"42px",backgroundColor:$e?"#f8f9fa":"#fff",color:$e?"#6c757d":"#495057"},children:[(0,Bt.jsx)("option",{value:"",children:"Select City"}),jRe.map(e=>(0,Bt.jsx)("option",{value:e,children:e},e))]})]})}),(0,Bt.jsx)(Ri,{md:3,sm:6,className:"mb-3",children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{style:{fontSize:"0.9rem",fontWeight:"500",color:"#495057",marginBottom:"0.5rem",display:"block"},children:"Construction Area (Sq Ft)"}),(0,Bt.jsx)(Ki.Control,{type:"number",value:M,onChange:e=>D(Number(e.target.value)),min:1,disabled:$e,style:{borderRadius:"6px",border:"1px solid #ced4da",padding:"0.75rem",fontSize:"0.9rem",width:"100%",height:"42px",backgroundColor:$e?"#f8f9fa":"#fff",color:$e?"#6c757d":"#495057"}})]})}),(0,Bt.jsx)(Ri,{md:3,sm:6,className:"mb-3",children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{style:{fontSize:"0.9rem",fontWeight:"500",color:"#495057",marginBottom:"0.5rem",display:"block"},children:"Carpet Area (Sq Ft)"}),(0,Bt.jsx)(Ki.Control,{type:"number",value:u,onChange:e=>d(Number(e.target.value)),min:1,disabled:$e,style:{borderRadius:"6px",border:"1px solid #ced4da",padding:"0.75rem",fontSize:"0.9rem",width:"100%",height:"42px",backgroundColor:$e?"#f8f9fa":"#fff",color:$e?"#6c757d":"#495057"}})]})}),(0,Bt.jsx)(Ri,{md:3,sm:6,className:"mb-3",children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{style:{fontSize:"0.9rem",fontWeight:"500",color:"#495057",marginBottom:"0.5rem",display:"block"},children:"Construction Perimeter (Ft)"}),(0,Bt.jsx)(Ki.Control,{type:"number",value:l,min:1,onChange:e=>c(e.target.value),style:{borderRadius:"6px",border:"1px solid #ced4da",padding:"0.75rem",fontSize:"0.9rem",width:"100%",height:"42px"}})]})})]}),(0,Bt.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:32,marginBottom:32},children:(0,Bt.jsxs)("div",{style:{width:600,background:"#fff",borderRadius:10,boxShadow:"0 2px 8px #0001",padding:24},children:[(0,Bt.jsx)("h4",{style:{textAlign:"center",color:"#1976d2",fontWeight:600,marginBottom:24},children:"Floor Definition"}),(0,Bt.jsxs)(mu,{className:"align-items-center mb-3",children:[(0,Bt.jsx)(Ri,{xs:12,md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Number of Floors"}),(0,Bt.jsx)(Ki.Control,{type:"number",value:j,onChange:e=>F(e.target.value),min:1,disabled:$e})]})}),(0,Bt.jsx)(Ri,{xs:12,md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Basement Count"}),(0,Bt.jsx)(Ki.Control,{type:"number",value:U,onChange:e=>q(Math.max(0,Number(e.target.value))),min:0,disabled:$e})]})})]}),(0,Bt.jsxs)(mu,{className:"align-items-center mb-3",children:[(0,Bt.jsx)(Ri,{xs:12,md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Ground Floor"}),(0,Bt.jsx)("div",{style:{display:"flex",alignItems:"center",marginTop:"0.5rem"},children:(0,Bt.jsx)(Ki.Check,{type:"checkbox",label:"Has Rooms",checked:W,onChange:e=>V(e.target.checked),disabled:$e})})]})}),(0,Bt.jsx)(Ri,{xs:12,md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Lift Requirement"}),(0,Bt.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginTop:"0.5rem"},children:[(0,Bt.jsx)(Ki.Check,{type:"switch",label:"Lift Required",checked:H,onChange:e=>L(e.target.checked),disabled:$e}),H&&(0,Bt.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[(0,Bt.jsx)(Ki.Label,{style:{fontSize:"0.85rem",color:"#888",marginBottom:2},children:"No. of Lifts"}),(0,Bt.jsx)(Ki.Control,{type:"number",min:1,value:B,onChange:e=>z(Math.max(1,Number(e.target.value))),style:{width:60,fontSize:"0.95rem",padding:"4px 8px",height:32,borderRadius:4,border:"1px solid #bdbdbd"},size:"sm",disabled:$e})]})]})]})})]})]})}),(0,Bt.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:32,marginBottom:32},children:(0,Bt.jsxs)("div",{style:{width:600,background:"#fff",borderRadius:10,boxShadow:"0 2px 8px #0001",padding:24},children:[(0,Bt.jsx)("h4",{style:{textAlign:"center",color:"#1976d2",fontWeight:600,marginBottom:24},children:"Beam & Column Definition"}),(0,Bt.jsxs)(mu,{className:"align-items-center mb-3",children:[(0,Bt.jsxs)(Ri,{xs:6,children:[(0,Bt.jsx)(Ki.Label,{children:"Floor"}),(0,Bt.jsxs)(Ki.Select,{value:st,onChange:e=>lt(e.target.value),children:[(0,Bt.jsx)("option",{value:"Foundation",children:"Foundation"}),U>0&&[...Array(Number(U))].map((e,t)=>(0,Bt.jsxs)("option",{value:"Basement ".concat(t+1),children:["Basement ",t+1]},"basement-".concat(t))),(0,Bt.jsx)("option",{value:"Ground Floor",children:"Ground Floor"}),(0,Bt.jsx)("option",{value:"Other Floors",children:"Other Floors"})]})]}),(0,Bt.jsxs)(Ri,{xs:6,children:[(0,Bt.jsx)(Ki.Label,{children:"Floor Height (ft)"}),(0,Bt.jsx)(Ki.Control,{type:"number",min:1,value:ct,onChange:e=>{const t=Number(e.target.value);ut(t),Se(st,"floor","floorHeight",t)}})]})]}),(0,Bt.jsxs)("table",{className:"table table-bordered",style:{marginTop:12},children:[(0,Bt.jsx)("thead",{children:(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("th",{children:"Parameter"}),(0,Bt.jsx)("th",{children:"Beam"}),(0,Bt.jsx)("th",{children:"Column"})]})}),(0,Bt.jsxs)("tbody",{children:[(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("td",{children:"Grid Spacing (ft)"}),(0,Bt.jsx)("td",{children:(0,Bt.jsx)(Ki.Control,{type:"number",min:1,value:dt,onChange:e=>{const t=Number(e.target.value);ht(t),Se(st,"beam","gridSpacing",t)}})}),(0,Bt.jsx)("td",{children:(0,Bt.jsx)(Ki.Control,{type:"number",min:1,value:ft,onChange:e=>{const t=Number(e.target.value);mt(t),Se(st,"column","gridSpacing",t)}})})]}),(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("td",{children:"Width (ft)"}),(0,Bt.jsx)("td",{children:(0,Bt.jsx)(Ki.Control,{type:"number",min:.1,value:pt,onChange:e=>{const t=Number(e.target.value);gt(t),Se(st,"beam","width",t)}})}),(0,Bt.jsx)("td",{children:(0,Bt.jsx)(Ki.Control,{type:"number",min:.1,value:bt,onChange:e=>{const t=Number(e.target.value);wt(t),Se(st,"column","width",t)}})})]}),(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("td",{children:"Depth (ft)"}),(0,Bt.jsx)("td",{children:(0,Bt.jsx)(Ki.Control,{type:"number",min:.1,value:vt,onChange:e=>{const t=Number(e.target.value);yt(t),Se(st,"beam","depth",t)}})}),(0,Bt.jsx)("td",{children:(0,Bt.jsx)(Ki.Control,{type:"number",min:.1,value:xt,onChange:e=>{const t=Number(e.target.value);St(t),Se(st,"column","depth",t)}})})]}),(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("td",{children:"Height (ft)"}),(0,Bt.jsx)("td",{children:"\u2014"}),(0,Bt.jsx)("td",{children:(0,Bt.jsx)(Ki.Control,{type:"number",min:1,value:Ct,onChange:e=>{const t=Number(e.target.value);Et(t),Se(st,"column","height",t)}})})]}),(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("td",{children:"Cross-section (sq ft)"}),(0,Bt.jsx)("td",{children:pt*vt}),(0,Bt.jsx)("td",{children:bt*xt})]})]})]})]})})]})]}),2===m&&(0,Bt.jsxs)(Bt.Fragment,{children:[(0,Bt.jsx)("div",{style:{width:"100%",margin:"0 auto 1rem auto",padding:"0.5rem 0 0.2rem 0",textAlign:"center",borderBottom:"1px solid #e0e0e0"},children:(0,Bt.jsx)("h5",{style:{fontWeight:600,color:"#1976d2",margin:0,fontSize:"1.18rem",letterSpacing:"0.5px"},children:"Floor Layout"})}),(0,Bt.jsx)("div",{className:"d-flex justify-content-center",style:{marginBottom:"2rem"},children:(0,Bt.jsxs)("div",{className:"row w-100",style:{maxWidth:600},children:[(0,Bt.jsx)("div",{className:"col-12 col-md-6 mb-3 mb-md-0",children:(0,Bt.jsxs)("div",{style:{background:"#e8f5e9",borderRadius:6,padding:"0.55rem",textAlign:"center",boxShadow:"0 1px 4px rgba(76,175,80,0.07)",minWidth:0,fontWeight:400},children:[(0,Bt.jsxs)("div",{style:{fontWeight:400,color:"#388e3c",fontSize:"0.85rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.25em",fontFamily:"inherit"},children:["Construction Area",(0,Bt.jsx)("span",{title:"Usable area including walls, balcony, etc.",style:{cursor:"pointer",fontSize:"1em",marginLeft:"2px",color:"#388e3c",verticalAlign:"middle"},children:"\u2139\ufe0f"})]}),(0,Bt.jsx)("div",{style:{fontSize:"0.95rem",fontWeight:400,marginTop:2,fontFamily:"inherit"},children:Number(M)?Number(M).toLocaleString("en-IN",{maximumFractionDigits:2}):"-"})]})}),(0,Bt.jsx)("div",{className:"col-12 col-md-6",children:(0,Bt.jsxs)("div",{style:{background:"#fce4ec",borderRadius:6,padding:"0.55rem",textAlign:"center",boxShadow:"0 1px 4px rgba(233,30,99,0.07)",minWidth:0,fontWeight:400},children:[(0,Bt.jsxs)("div",{style:{fontWeight:400,color:"#d81b60",fontSize:"0.85rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.25em",fontFamily:"inherit"},children:["Carpet Area",(0,Bt.jsx)("span",{title:"Actual area within walls (where carpet can be laid)",style:{cursor:"pointer",fontSize:"1em",marginLeft:"2px",color:"#d81b60",verticalAlign:"middle"},children:"\u2139\ufe0f"})]}),(0,Bt.jsx)("div",{style:{fontSize:"0.95rem",fontWeight:400,marginTop:2,fontFamily:"inherit"},children:Number(u)?Number(u).toLocaleString("en-IN",{maximumFractionDigits:2}):"-"})]})})]})}),(0,Bt.jsx)("div",{className:"d-flex justify-content-center",children:(0,Bt.jsx)("div",{style:{width:"100%",maxWidth:600,padding:"0 16px"},children:(0,Bt.jsx)(Ki,{children:(0,Bt.jsx)("div",{style:{marginBottom:"2rem"},children:[...Array(Number(j)+1).keys()].map(e=>(0,Bt.jsx)("div",{className:"section-responsive",style:{background:"#fff",borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.04)",border:"1px solid #e0e0e0",padding:"18px 8px",marginBottom:"1.5rem",maxWidth:"100%",overflowX:"auto"},children:0!==e||W?(0,Bt.jsxs)("div",{style:{marginTop:0,width:"100%",overflowX:"auto"},children:[(0,Bt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,Bt.jsxs)("div",{style:{fontWeight:600,fontSize:"1.05rem",color:"#388e3c"},children:[0===e?"Ground Floor":"".concat(1===e?"1st":2===e?"2nd":3===e?"3rd":e+"th"," Floor"),(0,Bt.jsx)("span",{style:{fontWeight:500,fontSize:"0.98rem",margin:"0 8px"},children:"-"}),"BHK Configuration"]}),(1===e||0===e&&W)&&(0,Bt.jsx)("button",{type:"button",onClick:Ot,style:{padding:"4px 8px",fontSize:"0.75rem",border:"1px solid #1976d2",backgroundColor:"#fff",color:"#1976d2",borderRadius:"4px",cursor:"pointer",fontWeight:500},onMouseOver:e=>e.target.style.backgroundColor="#f3f9ff",onMouseOut:e=>e.target.style.backgroundColor="#fff",disabled:ue,children:"Set Default"})]}),(e>1||0===e&&W&&!1)&&(0,Bt.jsxs)(Ki.Select,{size:"sm",style:{maxWidth:140,marginBottom:8},onChange:t=>function(e,t){const n=Mt(e),r=n.map(e=>E({type:e.type,units:e.units,area:e.area,rooms:e.rooms},Object.keys(e).reduce((t,n)=>(["type","units","area","rooms"].includes(n)||("object"===typeof e[n]&&null!==e[n]?t[n]=Array.isArray(e[n])?[...e[n]]:E({},e[n]):t[n]=e[n]),t),{})));Y(e=>E(E({},e),{},{[t]:r})),Q(r=>{const i=E({},r);for(let o=0;o<n.length;o++){const n="".concat(e,"-").concat(o),a="".concat(t,"-").concat(o);r[n]?i[a]=JSON.parse(JSON.stringify(r[n])):i[a]={Count:{},"Length (ft)":{},"Width (ft)":{},Door:{},Window:{}}}return i})}(Number(t.target.value),e),defaultValue:"",children:[(0,Bt.jsx)("option",{value:"",children:"Copy from..."}),[...Array(Number(j)+1).keys()].filter(t=>(W||0!==t)&&t!==e).map(e=>(0,Bt.jsx)("option",{value:e,children:0===e?"Ground Floor":1===e?"1st Floor":2===e?"2nd Floor":3===e?"3rd Floor":"".concat(e,"th Floor")},e))]}),(0,Bt.jsxs)("table",{style:{minWidth:480,width:"100%",borderCollapse:"collapse",fontSize:"0.97rem"},children:[(0,Bt.jsx)("thead",{children:(0,Bt.jsxs)("tr",{style:{background:"#f5f5f5"},children:[(0,Bt.jsx)("th",{style:{padding:"8px",border:"1px solid #e0e0e0"},children:"BHK Type"}),(0,Bt.jsx)("th",{style:{padding:"8px",border:"1px solid #e0e0e0"},children:"# of Units"}),(0,Bt.jsx)("th",{style:{padding:"8px",border:"1px solid #e0e0e0"},children:"Carpet Area (Sq ft)"}),(0,Bt.jsx)("th",{style:{padding:"8px",border:"1px solid #e0e0e0"},children:"Total Area"}),(0,Bt.jsx)("th",{style:{padding:"8px",border:"1px solid #e0e0e0"},children:"Typical Rooms"}),(0,Bt.jsx)("th",{style:{padding:"8px",border:"1px solid #e0e0e0"}})]})}),(0,Bt.jsx)("tbody",{children:(G[e]||K).map((t,n)=>(0,Bt.jsxs)("tr",{children:[(0,Bt.jsxs)("td",{style:{padding:"8px",border:"1px solid #e0e0e0",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,Bt.jsxs)(Ki.Select,{value:t.type,onChange:t=>function(e,t,n){Wt(e,t,"type",n);const r=zt(n);if(r.length>0){const i=r[0];Wt(e,t,"area",i);const o=ie.find(e=>e.type===n&&String(e.total_carpet_area_sqft)===String(i));if(o){const n=o.rooms.map(e=>e.name).join(", ");Wt(e,t,"rooms",n),Q(n=>{const r=E({},n),i="".concat(e,"-").concat(t);let a={Count:{},"Length (ft)":{},"Width (ft)":{},Door:{},Window:{}};return Array.isArray(o.rooms)&&o.rooms.forEach(e=>{var t,n;a.Count[e.name]=1,a["Length (ft)"][e.name]=(null===(t=e.dimensions_ft)||void 0===t?void 0:t.length)||"",a["Width (ft)"][e.name]=(null===(n=e.dimensions_ft)||void 0===n?void 0:n.width)||"",a.Door[e.name]=e.Door?{count:e.Door.count||0,width:e.Door.width||0,height:e.Door.height||0}:{count:0,width:0,height:0},a.Window[e.name]=e.Window?{count:e.Window.count||0,width:e.Window.width||0,height:e.Window.height||0}:{count:0,width:0,height:0}}),r[i]=a,r})}}setTimeout(()=>{Y(e=>E({},e))},0)}(e,n,t.target.value),size:"sm",style:{minWidth:90},disabled:ue,children:[(0,Bt.jsx)("option",{value:"",children:ue?"Loading...":"Select"}),ae.map(e=>(0,Bt.jsx)("option",{value:e,children:e},e))]}),(0,Bt.jsx)(Uu,{style:{color:!ue&&t.type&&t.area?"#1976d2":"#ccc",marginLeft:"6px",cursor:!ue&&t.type&&t.area?"pointer":"not-allowed"},title:ue?"Loading BHK data...":t.type?t.area?"BHK Details":"Please select Carpet Area first":"Please select BHK Type first",onClick:()=>{!ue&&t.type&&t.area&&async function(e,t){var n,r;const i="".concat(e,"-").concat(t),o=Mt(e),a=null===(n=o[t])||void 0===n?void 0:n.type,s=null===(r=o[t])||void 0===r?void 0:r.area;if(o[t]&&a&&s&&""!==a&&""!==s){re(e),te(t);try{if(ge.has(i)){pe("Saved Estimation Data (".concat(a," - ").concat(s," sq ft)"));const e=X[i],t=Object.keys(e.Count||{});return fe(t),void Z(!0)}let n;if(pe("Standard Room Configuration (".concat(a," - ").concat(s," sq ft)")),ie.length>0)n=ie;else{const e="".concat("https://buildproapi.onrender.com","/api/RoomConfiguration"),t=await fetch(e);if(!t.ok)throw new Error("Failed to load BHK configuration");n=await t.json(),oe(n)}const r=n.find(e=>e.type===a&&e.total_carpet_area_sqft===parseInt(s));if(r){pe("Standard Room Configuration (".concat(a," - ").concat(s," sq ft)"));let n=[];try{r.rooms&&Array.isArray(r.rooms)&&(n=r.rooms)}catch(qb){console.error("Error loading originalRooms:",qb),r.rooms&&Array.isArray(r.rooms)&&(n=r.rooms)}console.log("Modal originalRooms:",n);const i=new Map;n.forEach(e=>{let t;const n=e.name.split(" ");t=n.length>1&&/^\d+$/.test(n[n.length-1])?n.slice(0,-1).join(" "):e.name,i.has(t)||i.set(t,[]),i.get(t).push(e)});const o=[],l=new Map;i.forEach((e,t)=>{1===e.length?(o.push(t),l.set(e[0].name,e[0]),console.log("[Mapping] Single:",e[0].name,JSON.stringify(e[0]))):e.forEach((e,n)=>{const r="".concat(t," ").concat(n+1);o.push(r),l.set(e.name,e),console.log("[Mapping] Multi:",e.name,JSON.stringify(e))})}),console.log("Modal dynamicColumns:",o),fe(o);const c="".concat(e,"-").concat(t);Q(e=>{let t;if(e[c])t=e[c];else{const e={Count:{},"Length (ft)":{},"Width (ft)":{},Door:{},"Door Area (sqft)":{},Window:{},"Window Area (sqft)":{}};l.forEach((t,n)=>{console.log("Mapping room:",n,JSON.stringify(t)),t.Window||t.window?console.log("Window object for",n,t.Window||t.window):console.log("No Window object for",n);const i=t.Door||t.door,o=t.Window||t.window;e.Door[n]=i?{count:i.count||0,width:i.width||0,height:i.height||0}:{count:0,width:0,height:0},e.Window[n]=o?{count:o.count||0,width:o.width||0,height:o.height||0}:{count:0,width:0,height:0},n.toLowerCase().includes("bathroom")?e.Count[n]=r.bathroom_count||1:e.Count[n]=1,e["Length (ft)"][n]=t.dimensions_ft.length,e["Width (ft)"][n]=t.dimensions_ft.width,e["Door Area (sqft)"][n]=t.door_area_sqft||0,e["Window Area (sqft)"][n]=t.window_area_sqft||0})}return console.log("Modal roomDetails loaded from JSON:",t),e[c]?e:E(E({},e),{},{[c]:t})}),setTimeout(()=>{Z(!0)},0)}else{fe([...PRe,"Circulation Space"]);const n="".concat(e,"-").concat(t);Q(e=>{if(e[n])return e;const t={Count:{},"Length (ft)":{},"Width (ft)":{},Door:{},"Door Area (sqft)":{},Window:{},"Window Area (sqft)":{}};return[...PRe,"Circulation Space"].forEach(e=>{t.Count[e]=1,t["Length (ft)"][e]=0,t["Width (ft)"][e]=0,t.Door[e]={count:0,width:0,height:0},t["Door Area (sqft)"][e]=0,t.Window[e]={count:0,width:0,height:0},t["Window Area (sqft)"][e]=0}),E(E({},e),{},{[n]:t})}),console.warn("No BHK configuration found for ".concat(a," with ").concat(s," sq ft")),Z(!0)}}catch(mW){console.error("Error loading BHK configuration:",mW),fe([...PRe,"Circulation Space"]),Z(!0)}}else alert("Please fill in BHK Type and Carpet Area for this row first.")}(e,n)}})]}),(0,Bt.jsx)("td",{style:{padding:"8px",border:"1px solid #e0e0e0"},children:(0,Bt.jsx)(Ki.Control,{type:"number",value:t.units,min:1,size:"sm",onChange:t=>Wt(e,n,"units",t.target.value)})}),(0,Bt.jsx)("td",{style:{padding:"8px",border:"1px solid #e0e0e0"},children:(0,Bt.jsxs)(Ki.Select,{value:t.area,onChange:r=>{const i=parseInt(r.target.value);Wt(e,n,"area",i);const o=ie.find(e=>e.type===t.type&&String(e.total_carpet_area_sqft)===String(i));if(o){const t=o.rooms.map(e=>e.name).join(", ");Wt(e,n,"rooms",t),Q(t=>{const r=E({},t),i="".concat(e,"-").concat(n);let a={Count:{},"Length (ft)":{},"Width (ft)":{},Door:{},Window:{}};return Array.isArray(o.rooms)&&o.rooms.forEach(e=>{var t,n;a.Count[e.name]=1,a["Length (ft)"][e.name]=(null===(t=e.dimensions_ft)||void 0===t?void 0:t.length)||"",a["Width (ft)"][e.name]=(null===(n=e.dimensions_ft)||void 0===n?void 0:n.width)||"",a.Door[e.name]=e.Door?{count:e.Door.count||0,width:e.Door.width||0,height:e.Door.height||0}:{count:0,width:0,height:0},a.Window[e.name]=e.Window?{count:e.Window.count||0,width:e.Window.width||0,height:e.Window.height||0}:{count:0,width:0,height:0}}),r[i]=a,r})}},size:"sm",style:{minWidth:100},disabled:!t.type||0===zt(t.type).length||ue,children:[(0,Bt.jsx)("option",{value:"",children:ue?"Loading...":"Select"}),zt(t.type).map(e=>(0,Bt.jsx)("option",{value:e,children:e},e))]})}),(0,Bt.jsx)("td",{style:{padding:"8px",border:"1px solid #e0e0e0"},children:(t.units*(parseInt(t.area)||0)).toLocaleString("en-IN",{maximumFractionDigits:2})}),(0,Bt.jsx)("td",{style:{padding:"8px",border:"1px solid #e0e0e0"},children:(0,Bt.jsx)(Ki.Control,{type:"text",value:t.rooms,size:"sm",onChange:t=>Wt(e,n,"rooms",t.target.value)})}),(0,Bt.jsx)("td",{style:{padding:"8px",border:"1px solid #e0e0e0",textAlign:"center"},children:(0,Bt.jsx)(gr,{variant:"outline-danger",size:"sm",onClick:()=>function(e,t){0!==e||W?Y(n=>{const r=[...Mt(e)].filter((e,n)=>n!==t);return E(E({},n),{},{[e]:r})}):$(Mt(e).filter((e,n)=>n!==t))}(e,n),disabled:1===Mt(e).length,children:"Remove"})})]},n))})]}),(0,Bt.jsxs)("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[(0,Bt.jsx)(gr,{variant:"outline-primary",size:"sm",onClick:()=>function(e){0!==e||W?Y(t=>{const n=[...Mt(e),{type:"",units:1,area:"",rooms:""}];return Q(t=>{const r=E({},t),i="".concat(e,"-").concat(n.length-1);return r[i]||(r[i]={Count:{},"Length (ft)":{},"Width (ft)":{},Door:{},Window:{}}),r}),E(E({},t),{},{[e]:n})}):$(e=>{const t=[...e,{type:"",units:1,area:"",rooms:""}];return Q(e=>{const n=E({},e),r="0-".concat(t.length-1),i=t[t.length-1];let o={Count:{},"Length (ft)":{},"Width (ft)":{}};if(i.type&&i.area&&Array.isArray(ie)){const e=ie.find(e=>e.type===i.type&&String(e.total_carpet_area_sqft)===String(i.area));e&&Array.isArray(e.rooms)&&e.rooms.forEach(e=>{var t,n;o.Count[e.name]=1,o["Length (ft)"][e.name]=(null===(t=e.dimensions_ft)||void 0===t?void 0:t.length)||"",o["Width (ft)"][e.name]=(null===(n=e.dimensions_ft)||void 0===n?void 0:n.width)||""})}return n[r]=o,n}),t})}(e),children:"Add Row"}),(0,Bt.jsxs)("div",{style:{fontWeight:600,color:(()=>{const t=Mt(e).reduce((e,t)=>e+t.units*(parseInt(t.area)||0),0);return t===(Number(u)||0)?"#388e3c":"#d81b60"})()},children:["Total Area: ",Mt(e).reduce((e,t)=>e+t.units*(parseInt(t.area)||0),0).toLocaleString("en-IN",{maximumFractionDigits:2})," sq ft",(()=>{const t=Mt(e).reduce((e,t)=>e+t.units*(parseInt(t.area)||0),0),n=Number(u)||0;return n>0&&t!==n?(0,Bt.jsxs)("span",{style:{marginLeft:8,color:"#d81b60",fontWeight:500},children:["(Carpet Area: ",n.toLocaleString("en-IN",{maximumFractionDigits:2}),")"]}):null})()]})]})]}):(0,Bt.jsxs)(Bt.Fragment,{children:[(0,Bt.jsx)("div",{style:{fontWeight:600,fontSize:"1.05rem",marginBottom:12,color:"#388e3c"},children:"Ground Floor"}),(0,Bt.jsx)("div",{style:{width:"100%",overflowX:"auto"},children:(0,Bt.jsxs)("table",{style:{minWidth:320,width:"100%",borderCollapse:"collapse",fontSize:"0.97rem"},children:[(0,Bt.jsx)("thead",{children:(0,Bt.jsxs)("tr",{style:{background:"#f5f5f5"},children:[(0,Bt.jsx)("th",{style:{padding:"8px",border:"1px solid #e0e0e0"},children:"Type"}),(0,Bt.jsx)("th",{style:{padding:"8px",border:"1px solid #e0e0e0"},children:"Area (sq ft)"})]})}),(0,Bt.jsx)("tbody",{children:(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("td",{style:{padding:"8px",border:"1px solid #e0e0e0"},children:"Built-up"}),(0,Bt.jsx)("td",{style:{padding:"8px",border:"1px solid #e0e0e0"},children:Number(M)?Number(M).toLocaleString("en-IN",{maximumFractionDigits:2}):"-"})]})})]})})]})},e))})})})})]}),Ke&&(0,Bt.jsxs)("div",{style:{display:3===m?"block":"none"},children:[(0,Bt.jsx)("div",{style:{width:"100%",margin:"0 auto 1rem auto",padding:"0.5rem 0 0.2rem 0",textAlign:"center",borderBottom:"1px solid #e0e0e0"},children:(0,Bt.jsx)("h5",{style:{fontWeight:600,color:"#1976d2",margin:0,fontSize:"1.18rem",letterSpacing:"0.5px"},children:"Floor Component"})}),(0,Bt.jsx)(IRe,{estimationMasterId:Ke,floorsList:At})]}),4===m&&(0,Bt.jsxs)("div",{children:[(0,Bt.jsx)("div",{style:{width:"100%",margin:"0 auto 1rem auto",padding:"0.5rem 0 0.2rem 0",textAlign:"center",borderBottom:"1px solid #e0e0e0"},children:(0,Bt.jsx)("h5",{style:{fontWeight:600,color:"#1976d2",margin:0,fontSize:"1.18rem",letterSpacing:"0.5px"},children:"Pricing Details"})}),(0,Bt.jsx)(SF,{defaultActiveKey:"0",style:{marginBottom:8},children:(0,Bt.jsxs)(SF.Item,{eventKey:"0",children:[(0,Bt.jsx)(SF.Header,{style:{background:"linear-gradient(90deg, #e3f2fd 80%, #fafdff 100%)",minHeight:0,padding:"2px 8px",borderRadius:"12px 12px 0 0",alignItems:"center",fontSize:"0.98em",fontWeight:500,color:"#174a7c",letterSpacing:.1,border:"none"},children:(0,Bt.jsx)("span",{style:{fontSize:"0.98em",fontWeight:500,color:"#174a7c",letterSpacing:.1,marginLeft:2,marginRight:6,lineHeight:.5,padding:0,display:"inline-block",verticalAlign:"middle"},children:"Apartment Summary"})}),(0,Bt.jsx)(SF.Body,{style:{padding:0},children:(0,Bt.jsxs)("div",{className:"apartment-summary-card-responsive",style:{maxWidth:1100,margin:"0 auto 8px auto",background:"linear-gradient(90deg, #fafdff 80%, #e3f2fd 100%)",border:"1px solid #e0e7ef",borderRadius:14,boxShadow:"0 2px 12px #e3eafc",padding:"4px 0 2px 0",fontSize:"0.72em",display:"flex",flexWrap:"wrap",alignItems:"stretch",justifyContent:"center",gap:0,minHeight:36},children:[(()=>{const e=Number(M)||0,t=Number(l)||0,n="function"===typeof $t?$t("Flooring","sqft"):0,r="function"===typeof $t?$t("Painting","sqft"):0,i=[{label:"Built-up Area",value:e?Math.round(e).toLocaleString("en-IN")+" sqft":"-"},{label:"Perimeter",value:t?Math.round(t).toLocaleString("en-IN")+" ft":"-"},{label:"Tiles Area",value:n?Math.round(n).toLocaleString("en-IN")+" sqft":"-"},{label:"Painting Area",value:r?Math.round(r).toLocaleString("en-IN")+" sqft":"-"},{label:"Bedrooms",value:Ce},{label:"Bathrooms",value:Ee},{label:"Kitchens",value:Ne},{label:"Doors",value:Te},{label:"Windows",value:Re}];return i.map((e,t)=>(0,Bt.jsxs)("div",{style:{flex:"1 1 80px",minWidth:60,padding:"1px 0 0 0",display:"flex",flexDirection:"column",alignItems:"center",borderRight:t!==i.length-1?"1px solid #e3eafc":"none",margin:0,justifyContent:"center",position:"relative",boxSizing:"border-box"},children:[(0,Bt.jsx)("span",{style:{color:"#1976d2",fontWeight:600,fontSize:"0.82em",marginBottom:0,letterSpacing:.05,textShadow:"0 1px 0 #fafdff",textAlign:"center",lineHeight:1.02,textTransform:t<3?"none":"uppercase",wordBreak:"break-word"},children:e.label}),(0,Bt.jsx)("span",{style:{fontWeight:700,fontSize:"1.04em",color:t<3?"#222":"#1565c0",letterSpacing:.13,marginBottom:t<3?0:1,textAlign:"center",lineHeight:1.1,wordBreak:"break-word"},children:e.value})]},e.label))})(),(0,Bt.jsx)("style",{children:"\n              @media (max-width: 900px) {\n                .apartment-summary-card-responsive {\n                  font-size: 0.85em !important;\n                  padding: 2px 0 2px 0 !important;\n                }\n                .apartment-summary-card-responsive > div {\n                  min-width: 120px !important;\n                  flex: 1 1 45% !important;\n                  margin-bottom: 2px !important;\n                }\n              }\n              @media (max-width: 600px) {\n                .apartment-summary-card-responsive {\n                  font-size: 0.98em !important;\n                  flex-direction: column !important;\n                  padding: 2px 0 2px 0 !important;\n                }\n                .apartment-summary-card-responsive > div {\n                  min-width: 90px !important;\n                  flex: 1 1 100% !important;\n                  border-right: none !important;\n                  border-bottom: 1px solid #e3eafc !important;\n                  margin-bottom: 2px !important;\n                }\n                .apartment-summary-card-responsive > div:last-child {\n                  border-bottom: none !important;\n                }\n              }\n            "})]})})]})}),(0,Bt.jsx)("div",{style:{display:"flex",borderBottom:"2px solid #e3e3e3",marginBottom:18,overflowX:"auto",WebkitOverflowScrolling:"touch",scrollbarWidth:"thin",scrollbarColor:"#b3e5fc #fafdff",msOverflowStyle:"auto"},children:["Civil Material","Finishing Material","Man Power","Cost Summary"].map(e=>(0,Bt.jsx)("div",{onClick:()=>y(e),style:{flex:"0 0 auto",padding:"10px 28px",cursor:"pointer",fontWeight:600,color:v===e?"#1976d2":"#888",borderBottom:v===e?"3px solid #1976d2":"3px solid transparent",background:v===e?"#f5faff":"transparent",borderTopLeftRadius:8,borderTopRightRadius:8,marginRight:8,transition:"all 0.18s",fontSize:"1.08em",letterSpacing:"0.5px",minWidth:120,textAlign:"center",whiteSpace:"nowrap",boxSizing:"border-box"},children:e},e))}),(0,Bt.jsxs)("div",{style:{minHeight:200},children:["Civil Material"===v&&(0,Bt.jsxs)("div",{children:[(0,Bt.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:"12px 24px",marginBottom:12},children:[(0,Bt.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,Bt.jsx)("label",{htmlFor:"groupByDropdown",style:{fontWeight:400,marginRight:4,whiteSpace:"nowrap"},children:"Group by:"}),(0,Bt.jsxs)("select",{id:"groupByDropdown",value:a,onChange:e=>{s(e.target.value)},style:{padding:"4px 8px",borderRadius:4,border:"1px solid #ccc",fontSize:14,minWidth:90},children:[(0,Bt.jsx)("option",{value:"Floor",children:"Floor"}),(0,Bt.jsx)("option",{value:"Category",children:"Category"}),(0,Bt.jsx)("option",{value:"Material",children:"Material"})]})]}),(0,Bt.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1,minWidth:200},children:[(0,Bt.jsx)("label",{htmlFor:"step5TextFilter",style:{fontWeight:400,marginRight:4,whiteSpace:"nowrap"},children:"Filter:"}),(0,Bt.jsx)("input",{id:"step5TextFilter",type:"text",value:Ve,onChange:e=>Ue(e.target.value),placeholder:"Type to filter...",style:{minWidth:120,width:"40%",padding:"7px 12px",borderRadius:4,border:"1px solid #bdbdbd",fontSize:"1em"}})]})]}),(()=>{const e=Array.from(new Set(Rt.map(e=>e.material))),t=Rt.reduce((e,t)=>{if(n&&t.material!==n)return e;const r=(e=>"Floor"===a?e.floor:"Category"===a?e.category:"Material"===a?e.material:e.floor)(t)||"Other";return e[r]||(e[r]=[]),e[r].push(t),e},{}),s=e=>"Floor"===a?e:"Category"===a?"Category: ".concat(e):"Material"===a?"Material: ".concat(e):e;return(0,Bt.jsx)("div",{className:"step5-table-responsive",style:{maxHeight:420,overflowY:"auto",overflowX:"visible",position:"relative"},children:(0,Bt.jsxs)("table",{className:"table table-bordered step5-material-table",style:{fontSize:"0.89em",width:"100%"},children:[(0,Bt.jsx)("thead",{style:{background:"#eaf4fb",position:"sticky",top:0,zIndex:2},children:(0,Bt.jsxs)("tr",{style:{position:"sticky",top:0,background:"#eaf4fb",zIndex:2},children:["Floor"!==a&&(0,Bt.jsx)("th",{style:{verticalAlign:"middle",padding:"10px 8px",fontWeight:600,color:"#1976d2",whiteSpace:"nowrap"},children:"Floor"}),(0,Bt.jsx)("th",{style:{verticalAlign:"middle",padding:"10px 8px",fontWeight:600,color:"#1976d2",whiteSpace:"nowrap"},children:"Category"}),(0,Bt.jsxs)("th",{style:{verticalAlign:"middle",padding:"10px 8px",fontWeight:600,color:"#1976d2",position:"relative",whiteSpace:"nowrap"},children:[(0,Bt.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:4},children:["Material",(0,Bt.jsxs)("span",{style:{display:"flex",alignItems:"center",marginLeft:4},children:[(0,Bt.jsx)("span",{style:{cursor:"pointer",color:n?"#d81b60":"#1976d2",transition:"color 0.2s",display:"flex",alignItems:"center"},title:n?"Filtered: ".concat(n):"Filter",onClick:e=>{e.stopPropagation(),o(e=>!e)},children:(0,Bt.jsx)(Vu,{})}),n&&(0,Bt.jsx)("span",{style:{cursor:"pointer",color:"#888",marginLeft:2,fontSize:"1.1em",display:"flex",alignItems:"center"},title:"Clear filter",onClick:e=>{e.stopPropagation(),r("")},children:(0,Bt.jsx)(Ku,{})})]})]}),i&&(0,Bt.jsx)("div",{style:{position:"absolute",top:"100%",right:0,background:"#fff",border:"1px solid #ccc",borderRadius:4,zIndex:10,minWidth:120,padding:4,boxShadow:"0 2px 8px rgba(0,0,0,0.12)"},onClick:e=>e.stopPropagation(),children:(0,Bt.jsxs)("select",{value:n,onChange:e=>{r(e.target.value),o(!1)},style:{width:"100%",fontSize:"0.95em"},children:[(0,Bt.jsx)("option",{value:"",children:"All"}),e.map(e=>(0,Bt.jsx)("option",{value:e,children:e},e))]})})]}),(0,Bt.jsxs)("th",{style:{verticalAlign:"middle",padding:"10px 8px",fontWeight:600,color:"#1976d2",whiteSpace:"nowrap"},children:["Volume",(0,Bt.jsx)("br",{}),"(","cuft"===at?"cuft":"cumt",")"]}),(0,Bt.jsxs)("th",{style:{verticalAlign:"middle",padding:"10px 8px",fontWeight:600,color:"#1976d2",whiteSpace:"nowrap"},children:["Qty/","cuft"===at?"Cuft":"Cumt"]}),(0,Bt.jsxs)("th",{style:{verticalAlign:"middle",padding:"10px 8px",fontWeight:600,color:"#1976d2",whiteSpace:"nowrap"},children:["Wastage",(0,Bt.jsx)("br",{}),"(%)"]}),(0,Bt.jsx)("th",{style:{verticalAlign:"middle",padding:"10px 8px",fontWeight:600,color:"#1976d2",whiteSpace:"nowrap"},children:"Total Qty"}),(0,Bt.jsx)("th",{style:{verticalAlign:"middle",padding:"10px 8px",fontWeight:600,color:"#1976d2",whiteSpace:"nowrap"},children:"Unit"})]})}),(0,Bt.jsx)("tbody",{children:Object.entries(t).map(e=>{let[t,n]=e;return(0,Bt.jsxs)(g.Fragment,{children:[(0,Bt.jsx)("tr",{style:{background:"#f0f0f0",fontWeight:"bold"},children:(0,Bt.jsx)("td",{colSpan:"Floor"!==a?10:9,children:s(t)})}),n.map((e,t)=>{const n="".concat(e.category,"_").concat(e.material,"_").concat(e.floor||""),r=35.3147,i="cuft"===at?e.volume:e.volume/r,o="cuft"===at?void 0!==rt[n]?rt[n]:e.qty:(void 0!==rt[n]?rt[n]:e.qty)*r;return(0,Bt.jsxs)("tr",{children:["Floor"!==a&&(0,Bt.jsx)("td",{style:{whiteSpace:"nowrap"},children:e.floor}),(0,Bt.jsx)("td",{style:{whiteSpace:"nowrap"},children:e.category}),(0,Bt.jsx)("td",{style:{whiteSpace:"nowrap"},children:e.material}),(0,Bt.jsx)("td",{style:{textAlign:"right",whiteSpace:"nowrap"},children:"cuft"===at?i.toFixed(0):i.toFixed(2)}),(0,Bt.jsx)("td",{children:(0,Bt.jsx)("input",{type:"number",step:"0.01",value:void 0!==o?"cuft"===at?o.toFixed(2):o.toFixed(4):"",onChange:e=>((e,t)=>{it(n=>E(E({},n),{},{[e]:Number(t)}))})(n,e.target.value),style:{width:80,minWidth:60,textAlign:"right"}})}),(0,Bt.jsx)("td",{children:(0,Bt.jsx)("input",{type:"number",value:void 0!==tt[n]?tt[n]:e.wastage,onChange:e=>((e,t)=>{nt(n=>E(E({},n),{},{[e]:Number(t)}))})(n,e.target.value),style:{width:60,minWidth:50}})}),(0,Bt.jsx)("td",{style:{textAlign:"right",whiteSpace:"nowrap"},children:e.totalQty.toFixed(0)}),(0,Bt.jsx)("td",{style:{whiteSpace:"nowrap"},children:e.unit})]},n)})]},t)})})]})})})()]}),"Man Power"===v&&(0,Bt.jsx)("div",{className:"step5-table-responsive",style:{margin:"2rem 0",background:"#fff",padding:0},children:(0,Bt.jsxs)("table",{className:"step5-material-table",style:{width:"100%",fontSize:"0.89em",background:"#fff",borderCollapse:"collapse",borderSpacing:0,boxShadow:"0 2px 8px rgba(33,150,243,0.07)",border:"1px solid #e0e0e0",borderRadius:"8px"},children:[(0,Bt.jsx)("thead",{children:(0,Bt.jsxs)("tr",{style:{background:"#e3f2fd"},children:[(0,Bt.jsx)("th",{style:{verticalAlign:"middle",padding:"8px 6px",fontWeight:400,color:"#1976d2",whiteSpace:"nowrap",fontSize:"0.98em",letterSpacing:.1,border:"1px solid #e0e7ef",background:"#e3f2fd"},children:"Activity"}),(0,Bt.jsxs)("th",{style:{verticalAlign:"middle",padding:"8px 6px",fontWeight:400,color:"#1976d2",whiteSpace:"nowrap",textAlign:"right",fontSize:"0.98em",letterSpacing:.1,border:"1px solid #e0e7ef",background:"#e3f2fd"},children:["Productivity",(0,Bt.jsx)("br",{}),"(cuft or Sq ft/day)"]}),(0,Bt.jsxs)("th",{style:{verticalAlign:"middle",padding:"8px 6px",fontWeight:400,color:"#1976d2",whiteSpace:"nowrap",textAlign:"right",fontSize:"0.98em",letterSpacing:.1,border:"1px solid #e0e7ef",background:"#e3f2fd"},children:["Labour Rate",(0,Bt.jsx)("br",{}),"(\u20b9/day)"]}),(0,Bt.jsxs)("th",{style:{verticalAlign:"middle",padding:"8px 6px",fontWeight:400,color:"#1976d2",whiteSpace:"nowrap",textAlign:"right",fontSize:"0.98em",letterSpacing:.1,border:"1px solid #e0e7ef",background:"#e3f2fd"},children:["Volume /",(0,Bt.jsx)("br",{}),"Area"]}),(0,Bt.jsx)("th",{style:{verticalAlign:"middle",padding:"8px 6px",fontWeight:400,color:"#1976d2",whiteSpace:"nowrap",textAlign:"right",fontSize:"0.98em",letterSpacing:.1,border:"1px solid #e0e7ef",background:"#e3f2fd"},children:"Unit"}),(0,Bt.jsx)("th",{style:{verticalAlign:"middle",padding:"8px 6px",fontWeight:400,color:"#1976d2",whiteSpace:"nowrap",textAlign:"right",fontSize:"0.98em",letterSpacing:.1,border:"1px solid #e0e7ef",background:"#e3f2fd"},children:"No of People"}),(0,Bt.jsxs)("th",{style:{verticalAlign:"middle",padding:"8px 6px",fontWeight:400,color:"#1976d2",whiteSpace:"nowrap",textAlign:"right",fontSize:"0.98em",letterSpacing:.1,border:"1px solid #e0e7ef",background:"#e3f2fd"},children:["Duration",(0,Bt.jsx)("br",{}),"(days)"]}),(0,Bt.jsxs)("th",{style:{verticalAlign:"middle",padding:"8px 6px",fontWeight:400,color:"#1976d2",whiteSpace:"nowrap",textAlign:"right",fontSize:"0.98em",letterSpacing:.1,border:"1px solid #e0e7ef",background:"#e3f2fd"},children:["Cost",(0,Bt.jsx)("br",{}),"(\u20b9)"]})]})}),(0,Bt.jsx)("tbody",{children:Ht.map(e=>{let{key:t,label:n}=e;const r=Nt[t]||Nt[n]||{},i=r.Productivity_cuft_per_day||r.Productivity_sqft_per_day||"",o=r.Rate||"",a=r["Applicable unit"]?r["Applicable unit"].toLowerCase():"cuft",s=$t(t,a),l=void 0!==r.NoOfPeople&&null!==r.NoOfPeople&&""!==r.NoOfPeople?Number(r.NoOfPeople):1,c=i&&s?s/i:0,u=l>0?c/l:0,d=Math.round(c*o);return(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("td",{style:{padding:"8px 8px",fontWeight:400,textAlign:"left",border:"1px solid #e0e7ef",background:"#fff",display:"flex",alignItems:"center",gap:4},children:"Wall Foundation"===n?(0,Bt.jsxs)(Bt.Fragment,{children:[(0,Bt.jsx)("span",{title:"Wall Foundation = Brickwork, Internal Plastering, External Plastering.",children:n}),(0,Bt.jsx)(qu,{title:"Wall Foundation = Brickwork, Internal Plastering, External Plastering.",style:{color:"#1976d2",marginLeft:4,fontSize:"1em",verticalAlign:"middle",cursor:"pointer"},tabIndex:0,"aria-label":"Wall Foundation: Brickwork, Internal Plastering, External Plastering."})]}):n}),(0,Bt.jsx)("td",{style:{textAlign:"right",whiteSpace:"nowrap",padding:"8px 8px",border:"1px solid #e0e7ef",background:"#fff"},children:(0,Bt.jsx)("input",{type:"number",value:i||"",min:1,onChange:e=>{const n=e.target.value;"function"===typeof Tt&&Tt(e=>E(E({},e),{},{[t]:E(E({},e[t]),void 0!==r.Productivity_cuft_per_day?{Productivity_cuft_per_day:n}:{Productivity_sqft_per_day:n})}))},style:{width:60,minWidth:48,maxWidth:72,textAlign:"right",padding:"2px 4px",border:"1px solid #bdbdbd",borderRadius:4}})}),(0,Bt.jsx)("td",{style:{textAlign:"right",whiteSpace:"nowrap",padding:"8px 8px",border:"1px solid #e0e7ef",background:"#fff"},children:(0,Bt.jsx)("input",{type:"number",value:o||"",min:0,onChange:e=>{const n=e.target.value;"function"===typeof Tt&&Tt(e=>E(E({},e),{},{[t]:E(E({},e[t]),{},{Rate:n})}))},style:{width:60,minWidth:48,maxWidth:72,textAlign:"right",padding:"2px 4px",border:"1px solid #bdbdbd",borderRadius:4}})}),(0,Bt.jsx)("td",{style:{textAlign:"right",whiteSpace:"nowrap",padding:"8px 8px",border:"1px solid #e0e7ef",background:"#fff"},children:s?Math.round(s).toLocaleString("en-IN"):"-"}),(0,Bt.jsx)("td",{style:{textAlign:"right",whiteSpace:"nowrap",padding:"8px 8px",border:"1px solid #e0e7ef",background:"#fff"},children:r["Applicable unit"]?r["Applicable unit"]:"-"}),(0,Bt.jsx)("td",{style:{textAlign:"right",whiteSpace:"nowrap",padding:"8px 8px",border:"1px solid #e0e7ef",background:"#fff"},children:(0,Bt.jsx)("input",{type:"number",min:1,value:l,onChange:e=>{const n=e.target.value;"function"===typeof Tt&&Tt(e=>E(E({},e),{},{[t]:E(E({},e[t]),{},{NoOfPeople:n})}))},style:{width:48,minWidth:36,maxWidth:60,textAlign:"right",padding:"2px 4px",border:"1px solid #bdbdbd",borderRadius:4}})}),(0,Bt.jsx)("td",{style:{textAlign:"right",whiteSpace:"nowrap",padding:"8px 8px",border:"1px solid #e0e7ef",background:"#fff"},children:u?Math.round(u).toLocaleString("en-IN"):"-"}),(0,Bt.jsx)("td",{style:{textAlign:"right",whiteSpace:"nowrap",padding:"8px 8px",border:"1px solid #e0e7ef",background:"#fff"},children:d?d.toLocaleString("en-IN"):"-"})]},n)})}),(0,Bt.jsx)("tfoot",{children:(0,Bt.jsxs)("tr",{style:{background:"#e3f2fd",fontWeight:800,borderTop:"3px solid #1976d2",color:"#0d47a1"},children:[(0,Bt.jsx)("td",{colSpan:6,style:{textAlign:"right",fontWeight:800,fontSize:"1.12em",borderTop:"3px solid #1976d2",background:"#e3f2fd",color:"#0d47a1",padding:"10px 8px",letterSpacing:.2},children:"Grand Total"}),(0,Bt.jsx)("td",{style:{textAlign:"right",fontWeight:800,fontSize:"1.12em",borderTop:"3px solid #1976d2",background:"#e3f2fd",color:"#0d47a1",padding:"10px 8px",letterSpacing:.2},children:(()=>{const e=Ht.reduce((e,t)=>{let{key:n,label:r}=t;const i=Nt[n]||Nt[r]||{},o=i.Productivity_cuft_per_day||i.Productivity_sqft_per_day||0,a=i["Applicable unit"]?i["Applicable unit"].toLowerCase():"cuft",s=$t(n,a),l=void 0!==i.NoOfPeople&&null!==i.NoOfPeople&&""!==i.NoOfPeople?Number(i.NoOfPeople):1;return e+(l>0?(o&&s?s/o:0)/l:0)},0);return e?Math.round(e).toLocaleString("en-IN"):"-"})()}),(0,Bt.jsx)("td",{style:{textAlign:"right",fontWeight:800,fontSize:"1.12em",borderTop:"3px solid #1976d2",background:"#e3f2fd",color:"#0d47a1",padding:"10px 8px",letterSpacing:.2},children:(()=>{const e=Ht.reduce((e,t)=>{let{key:n,label:r}=t;const i=Nt[n]||Nt[r]||{},o=i.Productivity_cuft_per_day||i.Productivity_sqft_per_day||0,a=i.Rate||0,s=i["Applicable unit"]?i["Applicable unit"].toLowerCase():"cuft",l=$t(n,s),c=o&&l?l/o:0;return e+Math.round(c*a)},0);return"\u20b9".concat(e.toLocaleString("en-IN"))})()})]})})]})}),"Finishing Material"===v&&(0,Bt.jsx)("div",{className:"step5-table-responsive",style:{margin:"2rem 0",background:"#fff",padding:0},children:(0,Bt.jsx)(wbe,{summaryContext:{built_up_area_sqft:Number(M)||0,perimeter_ft:Number(l)||0,tile_area_sqft:"function"===typeof $t?$t("Flooring","sqft"):0,painting_area_sqft:"function"===typeof $t?$t("Painting","sqft"):0,room_count:"undefined"!==typeof ke?ke:0,toilet_count:"undefined"!==typeof Ee?Ee:0,kitchen_count:"undefined"!==typeof Ne?Ne:0,wet_points_count:("undefined"!==typeof Ee?Ee:0)+("undefined"!==typeof Ne?Ne:0),plastering_area_sqft:"function"===typeof $t?$t("Painting","sqft"):0,open_area_sqft:0,landscape_area_sqft:0,window_frame_area_sqft:0,door_count:"undefined"!==typeof Te?Te:0,Door_count:"undefined"!==typeof Te?Te:0,window_count:"undefined"!==typeof Re?Re:0,Window_count:"undefined"!==typeof Re?Re:0,floor_count:Number(j)},data:jt,onDataChange:Ft,materialRateConfig:Jt})}),"Cost Summary"===v&&(0,Bt.jsx)("div",{children:(0,Bt.jsx)(lRe,{data:rn,brandRateMap:tn})})]})]})]}),(0,Bt.jsxs)("div",{className:"wizard-nav-btns mt-4",children:[(0,Bt.jsx)(gr,{disabled:1===m,onClick:()=>p(m-1),className:"me-2",children:"Back"}),(0,Bt.jsx)(gr,{disabled:4===m,onClick:()=>p(m+1),className:"me-2",children:"Next"}),!$e&&(0,Bt.jsxs)(Bt.Fragment,{children:[1===m&&(0,Bt.jsx)(Bt.Fragment,{children:(0,Bt.jsx)(gr,{variant:"primary",onClick:Dt,className:"me-2",style:{fontWeight:600},children:"Save Step 1"})}),2===m&&(0,Bt.jsx)(Bt.Fragment,{children:(0,Bt.jsx)(gr,{variant:"primary",onClick:Dt,className:"me-2",style:{fontWeight:600},children:"Save Step 2"})}),3===m&&(0,Bt.jsx)(Bt.Fragment,{children:(0,Bt.jsx)(gr,{variant:"primary",onClick:async()=>{try{var e;if(!window.BOQEstimation_getAllCachedData)return f({show:!0,type:"warning",message:"BOQ Estimation component not ready. Please try again."}),void setTimeout(()=>{f({show:!1,type:"",message:""})},3e3);const t=window.BOQEstimation_getAllCachedData();if(!t||0===t.length)return f({show:!0,type:"warning",message:"No data to save. Please select floors and enter quantities."}),void setTimeout(()=>{f({show:!1,type:"",message:""})},3e3);console.log("Saving BOQ data:",t);const n="https://buildproapi.onrender.com",r=null===(e=t[0])||void 0===e?void 0:e.estimationMasterId;if(!r)return f({show:!0,type:"danger",message:"Missing estimation master ID. Please ensure project is properly set up."}),void setTimeout(()=>{f({show:!1,type:"",message:""})},4e3);const i=await fetch("".concat(n,"/api/EstimationMaterialFloorWise/by-estimation-master/").concat(r));let o=null;if(i.ok){const e=await i.json();console.log("Existing data check:",e),e&&e.records&&e.records.length>0&&(o=e.records[0]._id,console.log("Found existing record ID:",o))}const a={estimationMasterId:r,floors:t.map(e=>({floorName:e.floorName,components:e.components}))};let s;if(console.log("Payload:",a),o?(console.log("Updating existing record with ID:",o),s=await fetch("".concat(n,"/api/EstimationMaterialFloorWise/").concat(o),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})):(console.log("Creating new record"),s=await fetch("".concat(n,"/api/EstimationMaterialFloorWise"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})),!s.ok){const e=await s.json().catch(()=>({message:"Failed to save data"}));throw new Error(e.message||"Server error: ".concat(s.status))}const l=await s.json();console.log("Save successful:",l),await _t(r);f({show:!0,type:"success",message:"BOQ data ".concat(o?"updated":"saved"," successfully for all ").concat(t.length," floors!")}),setTimeout(()=>{f({show:!1,type:"",message:""})},3e3),window.BOQEstimation_refreshData&&window.BOQEstimation_refreshData()}catch(mW){console.error("Error saving Step 3:",mW),f({show:!0,type:"danger",message:"Error saving BOQ data: ".concat(mW.message)}),setTimeout(()=>{f({show:!1,type:"",message:""})},5e3)}},className:"me-2",style:{fontWeight:600},children:"Save Step 3"})}),4===m&&(0,Bt.jsxs)(Bt.Fragment,{children:[(0,Bt.jsx)(gr,{variant:"primary",onClick:()=>{const e={costLevel:ze,step5Tab:v,materialFilter:n,groupBy:a};localStorage.setItem("step4Data",JSON.stringify(e)),alert("Step 4 data saved successfully!")},className:"me-2",style:{fontWeight:600},children:"Save Step 4"}),(0,Bt.jsx)(gr,{variant:"outline-primary",onClick:()=>{const e=localStorage.getItem("step4Data");if(e)try{const t=JSON.parse(e);We(t.costLevel||"basic"),y(t.step5Tab||"Civil Material"),r(t.materialFilter||""),s(t.groupBy||"Floor"),t.areaCalculationLogic&&we(t.areaCalculationLogic),alert("Step 4 data loaded successfully!")}catch(mW){alert("Error loading Step 4 data: "+mW.message)}else alert("No saved Step 4 data found!")},className:"me-2",style:{fontWeight:600},children:"Load Step 4"})]})]})]}),(0,Bt.jsxs)(ga,{show:J,onHide:Vt,centered:!0,size:"xl",children:[(0,Bt.jsx)(ga.Header,{closeButton:!0,style:{background:"#e3f2fd",borderBottom:"1px solid #1976d2"},children:(0,Bt.jsx)(ga.Title,{style:{fontWeight:700,color:"#1976d2",fontSize:"1.18rem",letterSpacing:"0.5px"},children:((e,t)=>{if(null==ne||null==ee)return"";const n=Mt(ne),r=(null===(e=n[ee])||void 0===e?void 0:e.type)||"",i=(null===(t=n[ee])||void 0===t?void 0:t.area)||"";return r&&i?"".concat(r," - Carpet Area (").concat(i," sq ft)"):"BHK Details"})()})}),(0,Bt.jsxs)(ga.Body,{style:{background:"#fafafa",padding:"1.5rem 2rem"},children:[me&&(0,Bt.jsxs)("div",{style:{background:me.includes("Saved")?"#e8f5e9":"#fff3e0",border:me.includes("Saved")?"1px solid #4caf50":"1px solid #ff9800",borderRadius:"6px",padding:"10px 15px",marginBottom:"15px",display:"flex",alignItems:"center",gap:"10px"},children:[(0,Bt.jsx)("span",{style:{fontSize:"1.2rem"},children:me.includes("Saved")?"\u2139\ufe0f":"\ud83d\udccb"}),(0,Bt.jsxs)("span",{style:{color:me.includes("Saved")?"#2e7d32":"#e65100",fontWeight:500,fontSize:"0.9rem"},children:[(0,Bt.jsx)("strong",{children:"Data Source:"})," ",me]})]}),((e,t)=>{if(null==ne||null==ee)return null;const n=Mt(ne),r=(null===(e=n[ee])||void 0===e?void 0:e.type)||"",i=(null===(t=n[ee])||void 0===t?void 0:t.area)||"";return r&&i?(0,Bt.jsxs)("div",{style:{overflowX:"auto"},children:[(0,Bt.jsx)(O2,{ref:ye,data:Ut(),columns:Gt(),colHeaders:!0,rowHeaders:!1,height:"auto",width:"100%",licenseKey:"non-commercial-and-evaluation",stretchH:"all",className:"htCenter htMiddle",cells:(e,t)=>{const n={},r=Ut();if(r[e]){const t=r[e]["Row Label"];"Total Carpet Area"!==t&&"Door Area (sqft)"!==t&&"Window Area (sqft)"!==t||(n.readOnly=!0),n.renderer=Yt}return n},afterChange:qt,style:{fontSize:"0.85rem",background:"#fff",borderRadius:"8px",boxShadow:"0 2px 8px rgba(33,150,243,0.07)",border:"1px solid #e0e0e0",overflow:"hidden"}}),(0,Bt.jsxs)("div",{style:{marginTop:"15px",padding:"10px",background:"#e3f2fd",borderRadius:"6px",border:"1px solid #1976d2"},children:[(0,Bt.jsx)("div",{style:{fontWeight:700,color:"#1976d2",fontSize:"0.9rem",marginBottom:"5px"},children:"Grand Total Carpet Area"}),(0,Bt.jsxs)("div",{style:{fontSize:"1.1rem",fontWeight:700,color:"#388e3c"},children:[(()=>{const e="".concat(ne,"-").concat(ee),t=X[e]||{};let n=0;return he.forEach(e=>{const r=Number(t.Count&&t.Count[e]||0),i=Number(t["Length (ft)"]&&t["Length (ft)"][e]||0),o=Number(t["Width (ft)"]&&t["Width (ft)"][e]||0);n+=r*i*o}),n.toLocaleString("en-IN",{maximumFractionDigits:2})})()," sq ft"]})]})]}):(0,Bt.jsxs)("div",{style:{color:"#d32f2f",fontWeight:600,fontSize:"1.1rem",textAlign:"center",padding:"2rem 0"},children:["This row is empty. Please fill in BHK Type and Area in Step 1 for this floor.",(0,Bt.jsx)("br",{}),"No calculation can be performed for empty rows."]})})(),(0,Bt.jsx)("div",{style:{textAlign:"center",marginTop:"2rem"},children:(0,Bt.jsx)(gr,{variant:"primary",size:"lg",style:{minWidth:120,fontWeight:600,letterSpacing:"0.5px"},onClick:function(){Vt()},children:"OK"})})]})]})]})};const HRe=function(e){let{onLogin:t,isAuthenticated:n}=e;const[r,i]=(0,g.useState)(""),[o,a]=(0,g.useState)(""),[s,l]=(0,g.useState)(""),c=Me();return g.useEffect(()=>{n&&c("/")},[n,c]),(0,Bt.jsx)(Jt,{fluid:!0,className:"d-flex align-items-start justify-content-center min-vh-100",style:{overflow:"hidden",paddingTop:"4vh"},children:(0,Bt.jsx)(mu,{className:"w-100 justify-content-center",children:(0,Bt.jsx)(Ri,{xs:12,sm:10,md:8,lg:6,xl:5,xxl:4,children:(0,Bt.jsxs)("div",{className:"card shadow-sm",children:[(0,Bt.jsx)("div",{className:"card-header bg-primary text-white text-center py-3",children:(0,Bt.jsx)("h4",{className:"mb-0",children:"Sign In"})}),(0,Bt.jsx)("div",{className:"card-body p-4",children:(0,Bt.jsxs)("form",{className:"row g-3",onSubmit:e=>{if(e.preventDefault(),t){const e=t(r,o);l(e?"":"Invalid username or password")}},autoComplete:"off",children:[(0,Bt.jsx)("div",{className:"col-12 col-md-6",children:(0,Bt.jsx)("input",{type:"text",className:"form-control form-control-sm",id:"login-username",placeholder:"Username",autoComplete:"username",required:!0,value:r,onChange:e=>i(e.target.value),disabled:n})}),(0,Bt.jsx)("div",{className:"col-12 col-md-6",children:(0,Bt.jsx)("input",{type:"password",className:"form-control form-control-sm",id:"login-password",placeholder:"Password",autoComplete:"current-password",required:!0,value:o,onChange:e=>a(e.target.value),disabled:n})}),(0,Bt.jsx)("div",{className:"col-12 text-end",children:(0,Bt.jsx)("button",{type:"button",className:"btn btn-link p-0 text-primary small",style:{textDecoration:"underline"},tabIndex:0,children:"Forgot Password?"})}),s&&(0,Bt.jsx)("div",{className:"col-12",children:(0,Bt.jsx)("div",{className:"alert alert-danger py-2 mb-0",children:s})}),(0,Bt.jsx)("div",{className:"col-12 d-grid",children:(0,Bt.jsx)("button",{type:"submit",className:"btn btn-primary px-4",disabled:n,children:"Login"})})]})})]})})})})},LRe="https://buildproapi.onrender.com",BRe=()=>{const e={India:{currency:"INR",cities:["Mumbai","Delhi","Bangalore","Kolkata","Chennai","Hyderabad","Pune","Ahmedabad","Jaipur","Lucknow"]},Bangladesh:{currency:"BDT",cities:["Dhaka","Chittagong","Khulna","Rajshahi","Sylhet","Barisal","Rangpur","Mymensingh"]}},[t,n]=(0,g.useState)({companyName:"",companyCode:"",address:"",country:"",city:"",zipCode:"",currency:"",contactPersonName:"",phone:"",email:"",website:"",taxId:"",gstNumber:"",panNumber:"",bankName:"",accountNumber:"",ifscCode:"",themeColor:"#0d6efd",logo:null}),[r,i]=(0,g.useState)(!1),[o,a]=(0,g.useState)(""),[s,l]=(0,g.useState)("success"),[c,u]=(0,g.useState)([]),[d,h]=(0,g.useState)(!1),[f,m]=(0,g.useState)(null),[p,v]=(0,g.useState)(!1);g.useEffect(()=>{y()},[]);const y=async()=>{try{const e=await fetch("".concat(LRe,"/api/CompanySetup"));if(e.ok){const t=await e.json();u(t)}else console.error("Failed to load companies:",e.statusText),l("warning"),a("Failed to load companies from server"),i(!0)}catch(mW){console.error("Error loading companies list:",mW),l("danger"),a("Error connecting to server"),i(!0)}},b=()=>{v(!1),i(!1),setTimeout(()=>{w()},300)},w=()=>{n({companyName:"",companyCode:"",address:"",country:"",city:"",zipCode:"",currency:"",contactPersonName:"",phone:"",email:"",website:"",taxId:"",gstNumber:"",panNumber:"",bankName:"",accountNumber:"",ifscCode:"",themeColor:"#0d6efd",logo:null}),h(!1),m(null)},x=e=>{const{name:t,value:r}=e.target;n(e=>E(E({},e),{},{[t]:r}))};return(0,Bt.jsxs)("div",{className:"container-fluid py-4",children:[(0,Bt.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,Bt.jsxs)("h3",{className:"mb-0",children:[(0,Bt.jsx)("i",{className:"fas fa-building me-2"}),"Company Management"]}),(0,Bt.jsxs)("div",{className:"d-flex gap-2",children:[(0,Bt.jsxs)(gr,{variant:"outline-primary",onClick:()=>{const e=new Blob([JSON.stringify(c,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="all-companies-".concat((new Date).getTime(),".json"),document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)},children:[(0,Bt.jsx)("i",{className:"fas fa-download me-2"}),"Export"]}),(0,Bt.jsxs)(gr,{variant:"success",onClick:()=>{w(),i(!1),v(!0)},children:[(0,Bt.jsx)("i",{className:"fas fa-plus me-2"}),"Add Company"]})]})]}),c.length>0&&(0,Bt.jsx)(Xr,{className:"shadow-sm mb-4",children:(0,Bt.jsx)(Xr.Body,{className:"p-0",children:(0,Bt.jsx)("div",{className:"table-responsive",children:(0,Bt.jsxs)("table",{className:"table table-hover mb-0",children:[(0,Bt.jsx)("thead",{style:{backgroundColor:"#f8f9fa"},children:(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("th",{className:"border-0 px-4 py-3",children:"Company Name"}),(0,Bt.jsx)("th",{className:"border-0 px-4 py-3",children:"Code"}),(0,Bt.jsx)("th",{className:"border-0 px-4 py-3",children:"Country"}),(0,Bt.jsx)("th",{className:"border-0 px-4 py-3",children:"Email"}),(0,Bt.jsx)("th",{className:"border-0 px-4 py-3",children:"Currency"}),(0,Bt.jsx)("th",{className:"border-0 px-4 py-3",children:"Last Updated"}),(0,Bt.jsx)("th",{className:"border-0 px-4 py-3 text-center",children:"Actions"})]})}),(0,Bt.jsx)("tbody",{children:c.map((e,t)=>{var r,o,s,c,u,d;return(0,Bt.jsxs)("tr",{children:[(0,Bt.jsxs)("td",{className:"px-4 py-3",children:[(0,Bt.jsx)("strong",{children:e.companyName}),((null===(r=e.address)||void 0===r?void 0:r.city)||e.city)&&(0,Bt.jsxs)(Bt.Fragment,{children:[(0,Bt.jsx)("br",{}),(0,Bt.jsx)("small",{className:"text-muted",children:(null===(o=e.address)||void 0===o?void 0:o.city)||e.city})]})]}),(0,Bt.jsx)("td",{className:"px-4 py-3",children:(0,Bt.jsx)("span",{className:"badge bg-secondary",children:e.companyCode})}),(0,Bt.jsx)("td",{className:"px-4 py-3",children:(null===(s=e.address)||void 0===s?void 0:s.country)||e.country}),(0,Bt.jsx)("td",{className:"px-4 py-3",children:(0,Bt.jsx)("a",{href:"mailto:".concat((null===(c=e.contact)||void 0===c?void 0:c.email)||e.email),className:"text-decoration-none",children:(null===(u=e.contact)||void 0===u?void 0:u.email)||e.email})}),(0,Bt.jsx)("td",{className:"px-4 py-3",children:(0,Bt.jsx)("span",{className:"badge bg-info text-dark",children:e.currency})}),(0,Bt.jsx)("td",{className:"px-4 py-3",children:(0,Bt.jsx)("small",{className:"text-muted",children:new Date(null===(d=e.metadata)||void 0===d?void 0:d.lastUpdated).toLocaleDateString()})}),(0,Bt.jsx)("td",{className:"px-4 py-3 text-center",children:(0,Bt.jsxs)("div",{className:"d-flex gap-2 justify-content-center",children:[(0,Bt.jsx)(gr,{variant:"outline-primary",size:"sm",onClick:()=>(e=>{var t,r,o,a,s,l,c,u,d,f,p,g,y,b,w,x,S,C,E;i(!1),n({companyName:e.companyName||"",companyCode:e.companyCode||"",address:(null===(t=e.address)||void 0===t?void 0:t.street)||e.address||"",country:(null===(r=e.address)||void 0===r?void 0:r.country)||e.country||"",city:(null===(o=e.address)||void 0===o?void 0:o.city)||e.city||"",zipCode:(null===(a=e.address)||void 0===a?void 0:a.zipCode)||e.zipCode||"",currency:e.currency||"",contactPersonName:(null===(s=e.contact)||void 0===s?void 0:s.personName)||e.contactPersonName||"",phone:(null===(l=e.contact)||void 0===l?void 0:l.phone)||e.phone||"",email:(null===(c=e.contact)||void 0===c?void 0:c.email)||e.email||"",website:(null===(u=e.contact)||void 0===u?void 0:u.website)||e.website||"",taxId:(null===(d=e.invoicing)||void 0===d?void 0:d.taxId)||e.taxId||"",gstNumber:(null===(f=e.invoicing)||void 0===f?void 0:f.gstNumber)||e.gstNumber||"",panNumber:(null===(p=e.invoicing)||void 0===p?void 0:p.panNumber)||e.panNumber||"",bankName:(null===(g=e.invoicing)||void 0===g||null===(y=g.banking)||void 0===y?void 0:y.bankName)||e.bankName||"",accountNumber:(null===(b=e.invoicing)||void 0===b||null===(w=b.banking)||void 0===w?void 0:w.accountNumber)||e.accountNumber||"",ifscCode:(null===(x=e.invoicing)||void 0===x||null===(S=x.banking)||void 0===S?void 0:S.ifscCode)||e.ifscCode||"",themeColor:(null===(C=e.branding)||void 0===C?void 0:C.themeColor)||e.themeColor||"#0d6efd",logo:(null===(E=e.branding)||void 0===E?void 0:E.logo)||e.logo||null}),h(!0),m(e._id||e.companyCode),v(!0)})(e),title:"Edit Company",children:(0,Bt.jsx)("i",{className:"fas fa-edit"})}),(0,Bt.jsx)(gr,{variant:"outline-danger",size:"sm",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this company? This action cannot be undone."))try{const t=await fetch("".concat(LRe,"/api/CompanySetup/").concat(e),{method:"DELETE"});if(t.ok)await y(),l("success"),a("Company deleted successfully!"),i(!0),setTimeout(()=>i(!1),3e3);else{const e=await t.json();l("danger"),a(e.message||"Failed to delete company"),i(!0)}}catch(mW){console.error("Error deleting company:",mW),l("danger"),a("Error deleting company: "+mW.message),i(!0)}})(e._id||e.companyCode),title:"Delete Company",children:(0,Bt.jsx)("i",{className:"fas fa-trash"})})]})})]},e._id||e.companyCode||t)})})]})})})}),(0,Bt.jsxs)(ga,{show:p,onHide:b,size:"xl",backdrop:"static",keyboard:!1,children:[(0,Bt.jsx)(ga.Header,{closeButton:!0,className:"text-white ".concat(d?"bg-warning":"bg-primary"),children:(0,Bt.jsxs)(ga.Title,{children:[(0,Bt.jsx)("i",{className:"fas ".concat(d?"fa-edit":"fa-plus"," me-2")}),d?"Edit Company: ".concat(t.companyName):"Add New Company"]})}),(0,Bt.jsxs)(ga.Body,{style:{maxHeight:"75vh",overflowY:"auto"},children:[r&&(0,Bt.jsx)(fr,{variant:s,dismissible:!0,onClose:()=>i(!1),className:"mb-3",children:o}),(0,Bt.jsxs)(Ki,{onSubmit:async e=>{e.preventDefault();try{if(!t.companyName||!t.companyCode||!t.email||!t.country)return l("danger"),a("Please fill in all required fields (Company Name, Company Code, Country, Email)"),void i(!0);const e={companyName:t.companyName,companyCode:t.companyCode,address:{street:t.address,city:t.city,zipCode:t.zipCode,country:t.country},currency:t.currency,contact:{personName:t.contactPersonName,phone:t.phone,email:t.email,website:t.website},invoicing:{taxId:t.taxId,gstNumber:t.gstNumber,panNumber:t.panNumber,banking:{bankName:t.bankName,accountNumber:t.accountNumber,ifscCode:t.ifscCode}},branding:{themeColor:t.themeColor,logo:t.logo?{fileName:t.logo.fileName,fileType:t.logo.fileType,fileSize:t.logo.fileSize,base64Data:t.logo.base64Data}:null}};let n;if(n=d?await fetch("".concat(LRe,"/api/CompanySetup/").concat(f),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}):await fetch("".concat(LRe,"/api/CompanySetup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n.ok){const e=await n.json();console.log("MongoDB Document Structure:"),console.log(JSON.stringify(e,null,2)),l("success"),a('Company "'.concat(t.companyName,d?'" updated successfully!':'" added successfully!')),i(!0),await y(),setTimeout(()=>{b(),i(!1)},2e3)}else{const e=await n.json().catch(()=>({message:n.statusText}));l("danger"),a(e.message||"Failed to ".concat(d?"update":"save"," company")),i(!0)}}catch(mW){console.error("Error saving company:",mW),l("danger"),a("Error saving company: "+mW.message),i(!0)}},id:"company-form",children:[(0,Bt.jsx)(mu,{className:"mb-3",children:(0,Bt.jsx)(Ri,{children:(0,Bt.jsxs)("h5",{className:"text-primary mb-3 border-bottom pb-2",children:[(0,Bt.jsx)("i",{className:"fas fa-building me-2"}),"Basic Information"]})})}),(0,Bt.jsxs)(mu,{className:"mb-4",children:[(0,Bt.jsx)(Ri,{md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsxs)(Ki.Label,{children:["Company Name ",(0,Bt.jsx)("span",{className:"text-danger",children:"*"})]}),(0,Bt.jsx)(Ki.Control,{type:"text",name:"companyName",value:t.companyName,onChange:x,placeholder:"Enter company name",required:!0})]})}),(0,Bt.jsx)(Ri,{md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsxs)(Ki.Label,{children:["Company Code ",(0,Bt.jsx)("span",{className:"text-danger",children:"*"})]}),(0,Bt.jsx)(Ki.Control,{type:"text",name:"companyCode",value:t.companyCode,onChange:x,placeholder:"Enter company code",required:!0})]})})]}),(0,Bt.jsx)(mu,{className:"mb-3",children:(0,Bt.jsx)(Ri,{children:(0,Bt.jsxs)("h5",{className:"text-primary mb-3 border-bottom pb-2",children:[(0,Bt.jsx)("i",{className:"fas fa-map-marker-alt me-2"}),"Address Information"]})})}),(0,Bt.jsx)(mu,{className:"mb-3",children:(0,Bt.jsx)(Ri,{md:12,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Address"}),(0,Bt.jsx)(Ki.Control,{as:"textarea",rows:2,name:"address",value:t.address,onChange:x,placeholder:"Enter complete address"})]})})}),(0,Bt.jsxs)(mu,{className:"mb-4",children:[(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsxs)(Ki.Label,{children:["Country ",(0,Bt.jsx)("span",{className:"text-danger",children:"*"})]}),(0,Bt.jsxs)(Ki.Select,{name:"country",value:t.country,onChange:t=>{const r=t.target.value,i=r?e[r].currency:"";n(e=>E(E({},e),{},{country:r,currency:i,city:""}))},required:!0,children:[(0,Bt.jsx)("option",{value:"",children:"Select Country"}),(0,Bt.jsx)("option",{value:"India",children:"India"}),(0,Bt.jsx)("option",{value:"Bangladesh",children:"Bangladesh"})]})]})}),(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"City"}),(0,Bt.jsxs)(Ki.Select,{name:"city",value:t.city,onChange:x,disabled:!t.country,children:[(0,Bt.jsx)("option",{value:"",children:"Select City"}),t.country&&e[t.country].cities.map(e=>(0,Bt.jsx)("option",{value:e,children:e},e))]}),!t.country&&(0,Bt.jsx)(Ki.Text,{className:"text-muted",children:(0,Bt.jsx)("small",{children:"Select country first"})})]})}),(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"ZIP Code"}),(0,Bt.jsx)(Ki.Control,{type:"text",name:"zipCode",value:t.zipCode,onChange:x,placeholder:"Enter ZIP code"})]})}),(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Currency"}),(0,Bt.jsx)(Ki.Control,{type:"text",name:"currency",value:t.currency,readOnly:!0,placeholder:"Auto-filled",className:"bg-light"}),(0,Bt.jsx)(Ki.Text,{className:"text-muted",children:(0,Bt.jsx)("small",{children:"Based on country"})})]})})]}),(0,Bt.jsx)(mu,{className:"mb-3",children:(0,Bt.jsx)(Ri,{children:(0,Bt.jsxs)("h5",{className:"text-primary mb-3 border-bottom pb-2",children:[(0,Bt.jsx)("i",{className:"fas fa-phone me-2"}),"Contact Information"]})})}),(0,Bt.jsxs)(mu,{className:"mb-4",children:[(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Contact Person Name"}),(0,Bt.jsx)(Ki.Control,{type:"text",name:"contactPersonName",value:t.contactPersonName,onChange:x,placeholder:"Enter contact person name"})]})}),(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Phone"}),(0,Bt.jsx)(Ki.Control,{type:"tel",name:"phone",value:t.phone,onChange:x,placeholder:"Enter phone number"})]})}),(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsxs)(Ki.Label,{children:["Email ",(0,Bt.jsx)("span",{className:"text-danger",children:"*"})]}),(0,Bt.jsx)(Ki.Control,{type:"email",name:"email",value:t.email,onChange:x,placeholder:"Enter email address",required:!0})]})}),(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Website"}),(0,Bt.jsx)(Ki.Control,{type:"url",name:"website",value:t.website,onChange:x,placeholder:"Enter website URL"})]})})]}),(0,Bt.jsx)(mu,{className:"mb-3",children:(0,Bt.jsx)(Ri,{children:(0,Bt.jsxs)("h5",{className:"text-primary mb-3 border-bottom pb-2",children:[(0,Bt.jsx)("i",{className:"fas fa-file-invoice me-2"}),"Invoicing Information ",(0,Bt.jsx)("small",{className:"text-muted",children:"(Optional)"})]})})}),(0,Bt.jsxs)(mu,{className:"mb-3",children:[(0,Bt.jsx)(Ri,{md:4,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Tax ID / TIN"}),(0,Bt.jsx)(Ki.Control,{type:"text",name:"taxId",value:t.taxId,onChange:x,placeholder:"Enter tax identification number"})]})}),(0,Bt.jsx)(Ri,{md:4,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"GST Number"}),(0,Bt.jsx)(Ki.Control,{type:"text",name:"gstNumber",value:t.gstNumber,onChange:x,placeholder:"Enter GST number"})]})}),(0,Bt.jsx)(Ri,{md:4,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"PAN Number"}),(0,Bt.jsx)(Ki.Control,{type:"text",name:"panNumber",value:t.panNumber,onChange:x,placeholder:"Enter PAN number"})]})})]}),(0,Bt.jsxs)(mu,{className:"mb-4",children:[(0,Bt.jsx)(Ri,{md:4,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Bank Name"}),(0,Bt.jsx)(Ki.Control,{type:"text",name:"bankName",value:t.bankName,onChange:x,placeholder:"Enter bank name"})]})}),(0,Bt.jsx)(Ri,{md:4,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Account Number"}),(0,Bt.jsx)(Ki.Control,{type:"text",name:"accountNumber",value:t.accountNumber,onChange:x,placeholder:"Enter account number"})]})}),(0,Bt.jsx)(Ri,{md:4,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"IFSC / Swift Code"}),(0,Bt.jsx)(Ki.Control,{type:"text",name:"ifscCode",value:t.ifscCode,onChange:x,placeholder:"Enter IFSC/Swift code"})]})})]}),(0,Bt.jsx)(mu,{className:"mb-3",children:(0,Bt.jsx)(Ri,{children:(0,Bt.jsxs)("h5",{className:"text-primary mb-3 border-bottom pb-2",children:[(0,Bt.jsx)("i",{className:"fas fa-palette me-2"}),"Branding"]})})}),(0,Bt.jsxs)(mu,{className:"mb-4",children:[(0,Bt.jsx)(Ri,{md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Upload Logo"}),(0,Bt.jsx)(Ki.Control,{type:"file",name:"logo",onChange:e=>{const t=e.target.files[0];if(t){if(t.size>2097152)return l("warning"),a("File size should not exceed 2MB"),void i(!0);const e=new FileReader;e.onloadend=()=>{n(n=>E(E({},n),{},{logo:{fileName:t.name,fileType:t.type,fileSize:t.size,base64Data:e.result}}))},e.onerror=()=>{l("danger"),a("Error reading file"),i(!0)},e.readAsDataURL(t)}},accept:"image/*"}),(0,Bt.jsx)(Ki.Text,{className:"text-muted",children:"Supported formats: JPG, PNG, GIF (Max size: 2MB)"}),t.logo&&(0,Bt.jsxs)("div",{className:"mt-3",children:[(0,Bt.jsx)("img",{src:t.logo.base64Data,alt:"Company Logo Preview",style:{maxWidth:"200px",maxHeight:"200px",border:"1px solid #dee2e6",borderRadius:"4px"}}),(0,Bt.jsx)("div",{className:"mt-2",children:(0,Bt.jsxs)("small",{className:"text-muted",children:[t.logo.fileName," (",(t.logo.fileSize/1024).toFixed(2)," KB)"]})})]})]})}),(0,Bt.jsx)(Ri,{md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Theme Color"}),(0,Bt.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,Bt.jsx)(Ki.Control,{type:"color",name:"themeColor",value:t.themeColor,onChange:x,style:{width:"60px",height:"38px"}}),(0,Bt.jsx)(Ki.Control,{type:"text",name:"themeColor",value:t.themeColor,onChange:x,placeholder:"#0d6efd"})]}),(0,Bt.jsx)(Ki.Text,{className:"text-muted",children:"This color will be used for headers and branding elements"})]})})]})]})]}),(0,Bt.jsx)(ga.Footer,{children:(0,Bt.jsxs)("div",{className:"d-flex gap-2 w-100 justify-content-between",children:[(0,Bt.jsxs)(gr,{variant:"outline-danger",onClick:()=>{window.confirm("Are you sure you want to reset all fields?")&&w()},children:[(0,Bt.jsx)("i",{className:"fas fa-undo me-2"}),"Reset"]}),(0,Bt.jsxs)("div",{className:"d-flex gap-2",children:[(0,Bt.jsxs)(gr,{variant:"secondary",onClick:b,children:[(0,Bt.jsx)("i",{className:"fas fa-times me-2"}),"Cancel"]}),(0,Bt.jsxs)(gr,{variant:d?"warning":"primary",type:"submit",form:"company-form",children:[(0,Bt.jsx)("i",{className:"fas ".concat(d?"fa-edit":"fa-save"," me-2")}),d?"Update Company":"Add Company"]})]})]})})]})]})},zRe=["bsPrefix","bg","pill","text","className","as"],WRe=g.forwardRef((e,t)=>{let{bsPrefix:n,bg:r="primary",pill:i=!1,text:o,className:a,as:s="span"}=e,l=b(e,zRe);const c=Gt(n,"badge");return(0,Bt.jsx)(s,E(E({ref:t},l),{},{className:Lt(a,c,i&&"rounded-pill",o&&"text-".concat(o),r&&"bg-".concat(r))}))});WRe.displayName="Badge";const VRe=WRe,URe=()=>{const[e,t]=(0,g.useState)([]),[n,r]=(0,g.useState)(!1),[i,o]=(0,g.useState)(null),[a,s]=(0,g.useState)(!1),[l,c]=(0,g.useState)(""),[u,d]=(0,g.useState)("success"),[h,f]=(0,g.useState)({id:null,username:"",email:"",fullName:"",role:"user",department:"",phone:"",status:"active",password:"",confirmPassword:""}),m=[{value:"admin",label:"Administrator",color:"danger"},{value:"manager",label:"Manager",color:"warning"},{value:"user",label:"User",color:"primary"},{value:"readonly",label:"Read Only",color:"secondary"}];(0,g.useEffect)(()=>{(()=>{try{const e=localStorage.getItem("userManagement");if(e)t(JSON.parse(e));else{const e=[{id:1,username:"salmansdr",email:"salman@buildpro.com",fullName:"Salman SDR",role:"admin",department:"Engineering",phone:"+91-9874592300",status:"active",createdDate:(new Date).toISOString(),lastLogin:(new Date).toISOString()}];t(e),localStorage.setItem("userManagement",JSON.stringify(e))}}catch(mW){v("Error loading users: "+mW.message,"danger")}})()},[]);const p=e=>{try{localStorage.setItem("userManagement",JSON.stringify(e)),t(e)}catch(mW){v("Error saving users: "+mW.message,"danger")}},v=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";c(e),d(t),s(!0),setTimeout(()=>s(!1),4e3)},y=e=>{const{name:t,value:n}=e.target;f(e=>E(E({},e),{},{[t]:n}))},b=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(o(e),f(E(E({},e),{},{password:"",confirmPassword:""}))):(o(null),f({id:null,username:"",email:"",fullName:"",role:"user",department:"",phone:"",status:"active",password:"",confirmPassword:""})),r(!0)},w=()=>{r(!1),o(null),f({id:null,username:"",email:"",fullName:"",role:"user",department:"",phone:"",status:"active",password:"",confirmPassword:""})},x=e=>{const t=m.find(t=>t.value===e);return t?t.color:"secondary"};return(0,Bt.jsxs)("div",{className:"container-fluid py-4",children:[(0,Bt.jsx)("div",{className:"row",children:(0,Bt.jsx)("div",{className:"col-12",children:(0,Bt.jsxs)(Xr,{className:"shadow",children:[(0,Bt.jsxs)(Xr.Header,{className:"bg-primary text-white d-flex justify-content-between align-items-center",children:[(0,Bt.jsxs)("h4",{className:"mb-0",children:[(0,Bt.jsx)("i",{className:"fas fa-users me-2"}),"User Management"]}),(0,Bt.jsxs)("div",{className:"d-flex gap-2",children:[(0,Bt.jsxs)(gr,{variant:"light",size:"sm",onClick:()=>{try{const t=JSON.stringify(e,null,2),n=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(n),i=document.createElement("a");i.href=r,i.download="users_export_".concat((new Date).toISOString().split("T")[0],".json"),i.click(),v("Users exported successfully!","success")}catch(mW){v("Error exporting users: "+mW.message,"danger")}},children:[(0,Bt.jsx)("i",{className:"fas fa-download me-2"}),"Export"]}),(0,Bt.jsxs)(gr,{variant:"success",size:"sm",onClick:()=>b(),children:[(0,Bt.jsx)("i",{className:"fas fa-plus me-2"}),"Add User"]})]})]}),(0,Bt.jsxs)(Xr.Body,{children:[a&&(0,Bt.jsx)(fr,{variant:u,dismissible:!0,onClose:()=>s(!1),children:l}),(0,Bt.jsxs)(mu,{className:"mb-4",children:[(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsx)(Xr,{className:"bg-primary text-white",children:(0,Bt.jsxs)(Xr.Body,{className:"text-center",children:[(0,Bt.jsx)("h4",{children:e.length}),(0,Bt.jsx)("small",{children:"Total Users"})]})})}),(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsx)(Xr,{className:"bg-success text-white",children:(0,Bt.jsxs)(Xr.Body,{className:"text-center",children:[(0,Bt.jsx)("h4",{children:e.filter(e=>"active"===e.status).length}),(0,Bt.jsx)("small",{children:"Active Users"})]})})}),(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsx)(Xr,{className:"bg-warning text-white",children:(0,Bt.jsxs)(Xr.Body,{className:"text-center",children:[(0,Bt.jsx)("h4",{children:e.filter(e=>"admin"===e.role).length}),(0,Bt.jsx)("small",{children:"Administrators"})]})})}),(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsx)(Xr,{className:"bg-info text-white",children:(0,Bt.jsxs)(Xr.Body,{className:"text-center",children:[(0,Bt.jsx)("h4",{children:e.filter(e=>"inactive"===e.status).length}),(0,Bt.jsx)("small",{children:"Inactive Users"})]})})})]}),(0,Bt.jsx)("div",{className:"table-responsive",children:(0,Bt.jsxs)(Zr,{striped:!0,hover:!0,children:[(0,Bt.jsx)("thead",{className:"table-dark",children:(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("th",{children:"Username"}),(0,Bt.jsx)("th",{children:"Full Name"}),(0,Bt.jsx)("th",{children:"Email"}),(0,Bt.jsx)("th",{children:"Role"}),(0,Bt.jsx)("th",{children:"Department"}),(0,Bt.jsx)("th",{children:"Status"}),(0,Bt.jsx)("th",{children:"Last Login"}),(0,Bt.jsx)("th",{children:"Actions"})]})}),(0,Bt.jsx)("tbody",{children:e.map(t=>{var n;return(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("td",{children:(0,Bt.jsx)("strong",{children:t.username})}),(0,Bt.jsx)("td",{children:t.fullName}),(0,Bt.jsx)("td",{children:(0,Bt.jsx)("a",{href:"mailto:".concat(t.email),children:t.email})}),(0,Bt.jsx)("td",{children:(0,Bt.jsx)(VRe,{bg:x(t.role),children:(null===(n=m.find(e=>e.value===t.role))||void 0===n?void 0:n.label)||t.role})}),(0,Bt.jsx)("td",{children:t.department}),(0,Bt.jsx)("td",{children:(0,Bt.jsx)(VRe,{bg:"active"===t.status?"success":"danger",children:t.status})}),(0,Bt.jsx)("td",{children:t.lastLogin?new Date(t.lastLogin).toLocaleDateString():"Never"}),(0,Bt.jsx)("td",{children:(0,Bt.jsxs)("div",{className:"btn-group",role:"group",children:[(0,Bt.jsx)(gr,{variant:"outline-primary",size:"sm",onClick:()=>b(t),title:"Edit User",children:(0,Bt.jsx)("i",{className:"fas fa-edit"})}),(0,Bt.jsx)(gr,{variant:"active"===t.status?"outline-warning":"outline-success",size:"sm",onClick:()=>(t=>{try{const n=e.map(e=>e.id===t?E(E({},e),{},{status:"active"===e.status?"inactive":"active",modifiedDate:(new Date).toISOString(),modifiedBy:localStorage.getItem("currentUser")||"System"}):e);p(n),v("User status updated successfully!","success")}catch(mW){v("Error updating user status: "+mW.message,"danger")}})(t.id),title:"active"===t.status?"Deactivate":"Activate",children:(0,Bt.jsx)("i",{className:"fas fa-".concat("active"===t.status?"pause":"play")})}),(0,Bt.jsx)(gr,{variant:"outline-danger",size:"sm",onClick:()=>(t=>{if(window.confirm("Are you sure you want to delete this user?"))try{const n=e.filter(e=>e.id!==t);p(n),v("User deleted successfully!","success")}catch(mW){v("Error deleting user: "+mW.message,"danger")}})(t.id),title:"Delete User",children:(0,Bt.jsx)("i",{className:"fas fa-trash"})})]})})]},t.id)})})]})}),0===e.length&&(0,Bt.jsxs)("div",{className:"text-center py-4",children:[(0,Bt.jsx)("i",{className:"fas fa-users fa-3x text-muted mb-3"}),(0,Bt.jsx)("h5",{className:"text-muted",children:"No users found"}),(0,Bt.jsx)("p",{className:"text-muted",children:'Click "Add User" to create your first user'})]})]})]})})}),(0,Bt.jsxs)(ga,{show:n,onHide:w,size:"lg",children:[(0,Bt.jsx)(ga.Header,{closeButton:!0,children:(0,Bt.jsxs)(ga.Title,{children:[(0,Bt.jsx)("i",{className:"fas fa-user me-2"}),i?"Edit User":"Add New User"]})}),(0,Bt.jsxs)(Ki,{onSubmit:t=>{if(t.preventDefault(),h.username&&h.email&&h.fullName?h.email.includes("@")?e.find(e=>e.username===h.username&&e.id!==h.id)?(v("Username already exists","danger"),0):e.find(e=>e.email===h.email&&e.id!==h.id)?(v("Email already exists","danger"),0):i||h.password?h.password&&h.password!==h.confirmPassword?(v("Passwords do not match","danger"),0):!(h.password&&h.password.length<6)||(v("Password must be at least 6 characters long","danger"),0):(v("Password is required for new users","danger"),0):(v("Please enter a valid email address","danger"),0):(v("Please fill in all required fields","danger"),0))try{let t;if(i)t=e.map(e=>e.id===i.id?E(E(E({},e),h),{},{modifiedDate:(new Date).toISOString(),modifiedBy:localStorage.getItem("currentUser")||"System"}):e),v("User updated successfully!","success");else{const n=E(E({},h),{},{id:Date.now(),createdDate:(new Date).toISOString(),createdBy:localStorage.getItem("currentUser")||"System",lastLogin:null});t=[...e,n],v("User created successfully!","success")}p(t),w()}catch(mW){v("Error saving user: "+mW.message,"danger")}},children:[(0,Bt.jsxs)(ga.Body,{children:[(0,Bt.jsxs)(mu,{className:"mb-3",children:[(0,Bt.jsx)(Ri,{md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsxs)(Ki.Label,{children:["Username ",(0,Bt.jsx)("span",{className:"text-danger",children:"*"})]}),(0,Bt.jsx)(Ki.Control,{type:"text",name:"username",value:h.username,onChange:y,placeholder:"Enter username",required:!0})]})}),(0,Bt.jsx)(Ri,{md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsxs)(Ki.Label,{children:["Full Name ",(0,Bt.jsx)("span",{className:"text-danger",children:"*"})]}),(0,Bt.jsx)(Ki.Control,{type:"text",name:"fullName",value:h.fullName,onChange:y,placeholder:"Enter full name",required:!0})]})})]}),(0,Bt.jsxs)(mu,{className:"mb-3",children:[(0,Bt.jsx)(Ri,{md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsxs)(Ki.Label,{children:["Email ",(0,Bt.jsx)("span",{className:"text-danger",children:"*"})]}),(0,Bt.jsx)(Ki.Control,{type:"email",name:"email",value:h.email,onChange:y,placeholder:"Enter email",required:!0})]})}),(0,Bt.jsx)(Ri,{md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Phone"}),(0,Bt.jsx)(Ki.Control,{type:"tel",name:"phone",value:h.phone,onChange:y,placeholder:"Enter phone number"})]})})]}),(0,Bt.jsxs)(mu,{className:"mb-3",children:[(0,Bt.jsx)(Ri,{md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Role"}),(0,Bt.jsx)(Ki.Select,{name:"role",value:h.role,onChange:y,children:m.map(e=>(0,Bt.jsx)("option",{value:e.value,children:e.label},e.value))})]})}),(0,Bt.jsx)(Ri,{md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Department"}),(0,Bt.jsxs)(Ki.Select,{name:"department",value:h.department,onChange:y,children:[(0,Bt.jsx)("option",{value:"",children:"Select Department"}),["Engineering","Construction","Project Management","Finance","Human Resources","Quality Assurance","Safety","Procurement"].map(e=>(0,Bt.jsx)("option",{value:e,children:e},e))]})]})})]}),(0,Bt.jsx)(mu,{className:"mb-3",children:(0,Bt.jsx)(Ri,{md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Status"}),(0,Bt.jsxs)(Ki.Select,{name:"status",value:h.status,onChange:y,children:[(0,Bt.jsx)("option",{value:"active",children:"Active"}),(0,Bt.jsx)("option",{value:"inactive",children:"Inactive"})]})]})})}),(0,Bt.jsx)("hr",{}),(0,Bt.jsxs)("h6",{children:["Password ",i?"(Leave blank to keep current password)":""]}),(0,Bt.jsxs)(mu,{className:"mb-3",children:[(0,Bt.jsx)(Ri,{md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsxs)(Ki.Label,{children:["Password ",!i&&(0,Bt.jsx)("span",{className:"text-danger",children:"*"})]}),(0,Bt.jsx)(Ki.Control,{type:"password",name:"password",value:h.password,onChange:y,placeholder:"Enter password",required:!i})]})}),(0,Bt.jsx)(Ri,{md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsxs)(Ki.Label,{children:["Confirm Password ",!i&&(0,Bt.jsx)("span",{className:"text-danger",children:"*"})]}),(0,Bt.jsx)(Ki.Control,{type:"password",name:"confirmPassword",value:h.confirmPassword,onChange:y,placeholder:"Confirm password",required:!i})]})})]})]}),(0,Bt.jsxs)(ga.Footer,{children:[(0,Bt.jsx)(gr,{variant:"secondary",onClick:w,children:"Cancel"}),(0,Bt.jsxs)(gr,{variant:"primary",type:"submit",children:[(0,Bt.jsx)("i",{className:"fas fa-save me-2"}),i?"Update User":"Create User"]})]})]})]})]})},qRe=["className","bsPrefix","as"],GRe=g.forwardRef((e,t)=>{let{className:n,bsPrefix:r,as:i="span"}=e,o=b(e,qRe);return r=Gt(r,"input-group-text"),(0,Bt.jsx)(i,E({ref:t,className:Lt(n,r)},o))});GRe.displayName="InputGroupText";const YRe=GRe,KRe=["bsPrefix","size","hasValidation","className","as"],$Re=g.forwardRef((e,t)=>{let{bsPrefix:n,size:r,hasValidation:i,className:o,as:a="div"}=e,s=b(e,KRe);n=Gt(n,"input-group");const l=(0,g.useMemo)(()=>({}),[]);return(0,Bt.jsx)(Ol.Provider,{value:l,children:(0,Bt.jsx)(a,E(E({ref:t},s),{},{className:Lt(o,n,r&&"".concat(n,"-").concat(r),i&&"has-validation")}))})});$Re.displayName="InputGroup";const XRe=Object.assign($Re,{Text:YRe,Radio:e=>(0,Bt.jsx)(YRe,{children:(0,Bt.jsx)(si,E({type:"radio"},e))}),Checkbox:e=>(0,Bt.jsx)(YRe,{children:(0,Bt.jsx)(si,E({type:"checkbox"},e))})}),QRe=["active","disabled","className","style","activeLabel","children","linkStyle","linkClassName","as"],JRe=["children"],ZRe=g.forwardRef((e,t)=>{let{active:n=!1,disabled:r=!1,className:i,style:o,activeLabel:a="(current)",children:s,linkStyle:l,linkClassName:c,as:u=yn}=e,d=b(e,QRe);const h=n||r?"span":u;return(0,Bt.jsx)("li",{ref:t,style:o,className:Lt(i,"page-item",{active:n,disabled:r}),children:(0,Bt.jsxs)(h,E(E({className:Lt("page-link",c),style:l},d),{},{children:[s,n&&a&&(0,Bt.jsx)("span",{className:"visually-hidden",children:a})]}))})});ZRe.displayName="PageItem";const eke=ZRe;function tke(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const r=g.forwardRef((e,r)=>{let{children:i}=e,o=b(e,JRe);return(0,Bt.jsxs)(ZRe,E(E({},o),{},{ref:r,children:[(0,Bt.jsx)("span",{"aria-hidden":"true",children:i||t}),(0,Bt.jsx)("span",{className:"visually-hidden",children:n})]}))});return r.displayName=e,r}const nke=tke("First","\xab"),rke=tke("Prev","\u2039","Previous"),ike=tke("Ellipsis","\u2026","More"),oke=tke("Next","\u203a"),ake=tke("Last","\xbb"),ske=["bsPrefix","className","size"],lke=g.forwardRef((e,t)=>{let{bsPrefix:n,className:r,size:i}=e,o=b(e,ske);const a=Gt(n,"pagination");return(0,Bt.jsx)("ul",E(E({ref:t},o),{},{className:Lt(r,a,i&&"".concat(a,"-").concat(i))}))});lke.displayName="Pagination";const cke=Object.assign(lke,{First:nke,Prev:rke,Ellipsis:ike,Item:eke,Next:oke,Last:ake});function uke(e){if(!e)return{RCC:[],Ceiling:[],Wall:[]};if(e.RCC||e.Ceiling||e.Wall)return{RCC:e.RCC||[],Ceiling:e.Ceiling||[],Wall:e.Wall||[]};if(Array.isArray(e.floor_component_mt_values)){const t={RCC:[],Ceiling:[],Wall:[]},n=e=>({element:e.element,grade:e.grade||"",mt_value_per_cuft:e.mt_value_per_cuft||"",specification:e.specification||""});return e.floor_component_mt_values.forEach(e=>{const r=e.component;"RCC"===r?t.RCC.push(n(e)):"CeilingPlaster"===r||"Ceiling Plaster"===r||"Ceiling"===r?t.Ceiling.push(n(e)):"Internal Walls"!==r&&"External Walls"!==r&&"Wall"!==r||t.Wall.push(n(e))}),t}if(e.floor_component_mt_values&&"object"===typeof e.floor_component_mt_values){const t={RCC:[],Ceiling:[],Wall:[]};return Object.entries(e.floor_component_mt_values).forEach(e=>{let[n,r]=e;Object.entries(r).forEach(e=>{let[r,i]=e;const o=i.component;"RCC"===o?t.RCC.push({floor:n,element:i.element,specification:i.specification||"",mt_value_m20:i.mt_value_m20||"",mt_value_m25:i.mt_value_m25||"",mt_value_m30:i.mt_value_m30||"",formula:i.formula||""}):"CeilingPlaster"===o||"Ceiling Plaster"===o||"Ceiling"===o?t.Ceiling.push({floor:n,element:i.element,specification:i.specification||"",mt_value_m20:i.mt_value_m20||"",mt_value_m25:i.mt_value_m25||"",mt_value_m30:i.mt_value_m30||"",formula:i.formula||""}):"Internal Walls"!==o&&"External Walls"!==o&&"Wall"!==o||t.Wall.push({floor:n,element:i.element,specification:i.specification||"",mt_value_m20:i.mt_value_m20||"",mt_value_m25:i.mt_value_m25||"",mt_value_m30:i.mt_value_m30||"",formula:i.formula||""})})}),t}return{RCC:[],Ceiling:[],Wall:[]}}const dke=()=>{var e,t;const[n,r]=(0,g.useState)([]),[i,o]=(0,g.useState)([]),[a,s]=(0,g.useState)([]),[l,c]=(0,g.useState)(!1),[u,d]=(0,g.useState)(null),[h,f]=(0,g.useState)(!1),[m,p]=(0,g.useState)(""),[v,y]=(0,g.useState)("success"),[b,w]=(0,g.useState)(1),[x]=(0,g.useState)(10),[S,C]=(0,g.useState)(""),[N,T]=(0,g.useState)("All"),[A,R]=(0,g.useState)("All"),[k,M]=(0,g.useState)(!1),[D,_]=(0,g.useState)(!1),[O,I]=(0,g.useState)({id:null,material:"",category:"",categoryId:"",sub_category:"",unit:"",unit_size_kg:"",default_brand:"",defaultRate:0,brands:[{brand_name:"",rate_per_unit:""}],quantity_formula:"",wastage_percent:0,description:"",location:"",isActive:!0,materialCalculation:{RCC:[{element:"Slab",grade:"",mt_value_per_cuft:"",specification:""},{element:"Beam",grade:"",mt_value_per_cuft:"",specification:""},{element:"Column",grade:"",mt_value_per_cuft:"",specification:""}],Ceiling:[],Wall:[]},finishingCalculation:{enabled:!1,quantity_formula:"",coverage_per_box_sqft:"",applicable_areas:[],count_dependencies:[]}}),[P,j]=(0,g.useState)(""),[F,H]=(0,g.useState)(!1),L=["Mumbai","Delhi","Bangalore","Hyderabad","Ahmedabad","Chennai","Kolkata","Surat","Pune","Jaipur","Lucknow","Kanpur","Nagpur","Indore","Bhopal","Visakhapatnam","Pimpri-Chinchwad","Patna","Vadodara","Ghaziabad","Dhaka","Chittagong","Sylhet","Rajshahi","Khulna","Barisal","Rangpur","Comilla","Narayanganj","Gazipur"].sort(),B=(0,g.useMemo)(()=>{if(!O.category)return[];const e=a.find(e=>e.categoryName===O.category);return e&&e.subCategories?e.subCategories.filter(e=>e.isActive).map(e=>e.subCategoryName):[]},[a,O.category]),[z,W]=(0,g.useState)(""),V=(0,g.useCallback)(async function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&M(!0);try{const e=await K();if(!Array.isArray(e))throw console.warn("API did not return an array:",e),new Error("API returned invalid data format");const t=e.map(e=>{const t=e.itemData||e;return E(E({},t),{},{_id:e._id,id:t.id||e._id||Date.now()+Math.random(),brands:t.brands||[],material:t.material||"",category:t.category||"",categoryName:t.categoryName||t.category||"",categoryId:t.categoryId||"",subCategories:t.subCategories||[],unit:t.unit||"",location:t.location||"",isActive:void 0===t.isActive||t.isActive,default_brand:t.default_brand||"",unit_size_kg:t.unit_size_kg||"",quantity_formula:t.quantity_formula||"",wastage_percent:t.wastage_percent||0,description:t.description||"",materialCalculation:t.materialCalculation||null})});r(t),G(t)}catch(t){console.warn("Failed to load from API, falling back to localStorage:",t.message);try{const e=localStorage.getItem("itemMaster");if(e){const t=JSON.parse(e);r(t)}else r([])}catch(n){console.error("Error loading from localStorage:",n.message),$("Error loading items: "+n.message,"danger"),r([])}}finally{e&&M(!1)}},[]),U=(0,g.useCallback)(async()=>{await V(!1)},[V]),q=(0,g.useCallback)(()=>{if(!Array.isArray(n))return void o([]);let e=[...n];N&&"All"!==N&&(e=e.filter(e=>{const t=e.categoryName||e.category;return t&&t===N})),A&&"All"!==A&&(e=e.filter(e=>e.sub_category&&e.sub_category===A)),S&&(e=e.filter(e=>e.material&&e.material.toLowerCase().includes(S.toLowerCase()))),o(e),w(1)},[n,S,N,A]);(0,g.useEffect)(()=>{(async()=>{await(async()=>{try{const e="".concat("https://buildproapi.onrender.com","/api/MaterialCategory"),t=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error("HTTP error! status: ".concat(t.status));const n=await t.json();console.log("Categories loaded from API:",n);const r=Array.isArray(n)?n:n.data||[];s(r)}catch(mW){console.error("Error loading categories from API:",mW),$("Error loading categories: "+mW.message,"warning"),s([])}})(),await V(),await(async()=>{let e="Kolkata";try{const t=await fetch("/MaterialRate.json"),n=await t.json();e=n.location||"Kolkata"}catch(mW){console.warn("Could not load default location from MaterialRate.json:",mW)}W(e),I(t=>E(E({},t),{},{location:e})),localStorage.setItem("userLocation",e)})()})()},[]),(0,g.useEffect)(()=>{q()},[q]);const G=e=>{try{localStorage.setItem("itemMaster",JSON.stringify(e))}catch(mW){console.warn("Failed to save to localStorage:",mW.message)}},Y=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{const r="https://buildproapi.onrender.com",i=n||e._id||e.id,o=t&&i?"".concat(r,"/api/materialitems/").concat(i):"".concat(r,"/api/materialitems"),a=E({},e);t&&delete a.id;const s={method:t?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},l=await fetch(o,s);if(!l.ok){const e=await l.json().catch(()=>({message:"Unknown error"}));throw new Error(e.message||"HTTP error! status: ".concat(l.status))}return await l.json()}catch(mW){throw console.error("API Error:",mW),mW}},K=async()=>{try{const e="".concat("https://buildproapi.onrender.com","/api/materialitems"),t=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok){const e=await t.json().catch(()=>({message:"Unknown error"}));throw new Error(e.message||"HTTP error! status: ".concat(t.status))}const n=await t.json();return Array.isArray(n)?n:n&&Array.isArray(n.items)?n.items:n&&Array.isArray(n.data)?n.data:(console.warn("API returned unexpected format:",n),[])}catch(mW){throw console.error("API Get All Materials Error:",mW),mW}},$=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";p(e),y(t),f(!0),setTimeout(()=>f(!1),4e3)},X=e=>{const{name:t,value:n,type:r,checked:i}=e.target;if("default_brand"===t){const e=O.brands.find(e=>e.brand_name===n),t=e&&parseFloat(e.rate_per_unit)||0;return void I(e=>E(E({},e),{},{default_brand:n,defaultRate:t}))}if(I(e=>E(E({},e),{},{[t]:"checkbox"===r?i:n})),"material"===t&&J(n,O.category,O.location),("category"===t||"location"===t)&&O.material){const e=O.material,r="category"===t?n:O.category,i="location"===t?n:O.location;J(e,r,i)}},Q=(e,t)=>{I(n=>E(E({},n),{},{finishingCalculation:E(E({},n.finishingCalculation),{},{[e]:t})}))},J=(e,t,r)=>{if(!e.trim())return j(""),void H(!1);n.find(n=>n.material.toLowerCase().trim()===e.toLowerCase().trim()&&n.category===t&&n.location===r&&n.id!==O.id)?(j('Material "'.concat(e,'" already exists in "').concat(t,'" category for "').concat(r,'" location.')),H(!1)):(j(""),H(!0))},Z=(e,t,n)=>{const r=[...O.brands];r[e]=E(E({},r[e]),{},{[t]:n}),I(e=>E(E({},e),{},{brands:r}))},ee=()=>{I(e=>E(E({},e),{},{brands:[...e.brands,{brand_name:"",rate_per_unit:""}]}))},te=e=>{const t={cement:["UltraTech","ACC","Dalmia","Ambuja","Shree"],steel:["TATA Tiscon","JSW Neosteel","SAIL","Kamdhenu","Vizag"],sand:["River Sand","M-Sand","Robo Sand","P Sand"],tiles:["Kajaria","Somany","Johnson","Nitco","RAK"],paint:["Asian Paints","Dulux","Berger","Nerolac","Indigo"],pipes:["Astral","Supreme","Finolex","Prince","Ashirvad"]},n=e.toLowerCase();for(const r in t)if(n.includes(r))return t[r];return[]},ne=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(e)try{const t=e._id||e.id,n=await(async e=>{try{const t="".concat("https://buildproapi.onrender.com","/api/materialitems/").concat(e);console.log("Fetching item by ID:",e,"from endpoint:",t);const n=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}});if(!n.ok){const e=await n.json().catch(()=>({message:"Unknown error"}));throw new Error(e.message||"HTTP error! status: ".concat(n.status))}const r=await n.json();return console.log("API Response for item:",JSON.stringify(r,null,2)),r}catch(mW){throw console.error("API Get Material By ID Error:",mW),mW}})(t),i=n.itemData?E(E({},n.itemData),{},{_id:n._id,id:n.itemData.id||n._id||e.id,subCategories:n.subCategories||n.itemData.subCategories||[]}):E(E({},n),{},{_id:n._id||t});i.subCategories&&i.subCategories.length>0&&r(e=>e.map(e=>(e.categoryName||e.category)===(i.categoryName||i.category)?E(E({},e),{},{subCategories:i.subCategories}):e)),d(i);let o=uke(i.materialCalculation),a=i.finishingCalculation||{enabled:!1,quantity_formula:"",coverage_per_box_sqft:"",applicable_areas:[],count_dependencies:[]};const s=i.brands&&i.brands.length>0?[...i.brands]:[{brand_name:"",rate_per_unit:""}],l=i.default_brand||"",c=s.find(e=>e.brand_name===l),u=c&&parseFloat(c.rate_per_unit)||0;I({id:i.id||e.id,material:i.material||"",category:i.categoryName||i.category||"",categoryId:i.categoryId||"",sub_category:i.sub_category||"",unit:i.unit||"",location:i.location||"",isActive:void 0===i.isActive||i.isActive,default_brand:l,defaultRate:u,unit_size_kg:i.unit_size_kg||"",quantity_formula:i.quantity_formula||"",wastage_percent:i.wastage_percent||0,description:i.description||"",brands:s,materialCalculation:o,finishingCalculation:a}),j(""),H(!0)}catch(mW){console.error("Error loading item for editing:",mW),$("Error loading item details: "+mW.message,"danger"),d(e);let n=uke(e.materialCalculation),r=e.finishingCalculation||{enabled:!1,quantity_formula:"",coverage_per_box_sqft:"",applicable_areas:[],count_dependencies:[]};"Civil"===e.category?(n=E(E({},n),{},{enabled:!0}),r=E(E({},r),{},{enabled:!1})):e.category&&"Civil"!==e.category&&(r=E(E({},r),{},{enabled:!0}),n=E(E({},n),{},{enabled:!1}));const i=e.brands&&e.brands.length>0?[...e.brands]:[{brand_name:"",rate_per_unit:""}],o=e.default_brand||"",a=i.find(e=>e.brand_name===o),s=a&&parseFloat(a.rate_per_unit)||0;I({id:e.id,material:e.material||"",category:e.categoryName||e.category||"",categoryId:e.categoryId||"",sub_category:e.sub_category||"",unit:e.unit||"",location:e.location||"",isActive:void 0===e.isActive||e.isActive,default_brand:o,defaultRate:s,unit_size_kg:e.unit_size_kg||"",quantity_formula:e.quantity_formula||"",wastage_percent:e.wastage_percent||0,description:e.description||"",brands:i,materialCalculation:n,finishingCalculation:r}),j(""),H(!0)}else d(null),I({id:null,material:"",category:"",categoryId:"",unit:"",unit_size_kg:"",default_brand:"",defaultRate:0,brands:[{brand_name:"",rate_per_unit:""}],quantity_formula:"",wastage_percent:0,description:"",location:z||"",isActive:!0}),j(""),H(!1);c(!0)},re=()=>{c(!1),d(null),I({id:null,material:"",category:"",categoryId:"",sub_category:"",unit:"",unit_size_kg:"",default_brand:"",brands:[{brand_name:"",rate_per_unit:""}],quantity_formula:"",wastage_percent:0,description:"",location:z||"",isActive:!0,materialCalculation:{RCC:[],Ceiling:[],Wall:[]},finishingCalculation:{enabled:!1,quantity_formula:"",coverage_per_box_sqft:"",applicable_areas:[],count_dependencies:[]}}),j(""),H(!1)},ie=async e=>{if(window.confirm("Are you sure you want to delete this item?"))try{const t=n.find(t=>t.id===e),r=(null===t||void 0===t?void 0:t._id)||e;await(async e=>{try{const t="".concat("https://buildproapi.onrender.com","/api/materialitems/").concat(e),n=await fetch(t,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!n.ok){const e=await n.json().catch(()=>({message:"Unknown error"}));throw new Error(e.message||"HTTP error! status: ".concat(n.status))}return!0}catch(mW){throw console.error("API Delete Error:",mW),mW}})(r),await U(),$("Item deleted successfully from database!","success")}catch(mW){console.error("Delete error:",mW),$("Error deleting item: "+mW.message,"danger")}},oe=b*x,ae=oe-x,se=Array.isArray(i)?i:[],le=se.slice(ae,oe),ce=Math.ceil(se.length/x),ue=e=>w(e);return(0,Bt.jsxs)("div",{className:"container-fluid py-4",children:[(0,Bt.jsx)("div",{className:"row",children:(0,Bt.jsx)("div",{className:"col-12",children:(0,Bt.jsxs)(Xr,{className:"shadow",children:[(0,Bt.jsxs)(Xr.Header,{className:"bg-success text-white d-flex justify-content-between align-items-center flex-wrap",children:[(0,Bt.jsxs)("h4",{className:"mb-0",children:[(0,Bt.jsx)("i",{className:"fas fa-boxes me-2"}),"Item Master",z&&(0,Bt.jsxs)(VRe,{bg:"light",text:"dark",className:"ms-2",children:["Default: ",z]})]}),(0,Bt.jsxs)("div",{className:"d-flex gap-2 flex-wrap",children:[(0,Bt.jsxs)(gr,{variant:"light",size:"sm",onClick:()=>{try{const e=JSON.stringify(i,null,2),t=new Blob([e],{type:"application/json"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="item_master_export_".concat((new Date).toISOString().split("T")[0],".json"),r.click(),$("Items exported successfully!","success")}catch(mW){$("Error exporting items: "+mW.message,"danger")}},children:[(0,Bt.jsx)("i",{className:"fas fa-download me-2"}),"Export"]}),(0,Bt.jsxs)(gr,{variant:"warning",size:"sm",onClick:()=>ne(),children:[(0,Bt.jsx)("i",{className:"fas fa-plus me-2"}),"Add Item"]})]})]}),(0,Bt.jsxs)(Xr.Body,{children:[k&&(0,Bt.jsxs)("div",{className:"text-center py-4",children:[(0,Bt.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,Bt.jsx)("span",{className:"visually-hidden",children:"Loading items..."})}),(0,Bt.jsx)("div",{className:"mt-2",children:(0,Bt.jsx)("small",{className:"text-muted",children:"Loading items from database..."})})]}),!k&&(0,Bt.jsx)("div",{className:"table-responsive",children:(0,Bt.jsxs)(Zr,{striped:!0,hover:!0,children:[(0,Bt.jsx)("thead",{className:"table-dark",children:(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("th",{children:(0,Bt.jsxs)("div",{className:"d-flex flex-column",children:[(0,Bt.jsx)("span",{children:"Material"}),(0,Bt.jsx)("div",{className:"mt-1",children:(0,Bt.jsxs)(XRe,{size:"sm",children:[(0,Bt.jsx)(Ki.Control,{type:"text",placeholder:"Filter materials...",value:S,onChange:e=>C(e.target.value),style:{fontSize:"0.8rem"}}),S&&(0,Bt.jsx)(gr,{variant:"outline-light",size:"sm",onClick:()=>{C("")},title:"Clear filter",children:(0,Bt.jsx)("i",{className:"fas fa-times"})})]})})]})}),(0,Bt.jsx)("th",{children:(0,Bt.jsxs)("div",{className:"d-flex flex-column",children:[(0,Bt.jsx)("span",{children:"Category"}),(0,Bt.jsx)("div",{className:"mt-1",children:(0,Bt.jsxs)(XRe,{size:"sm",children:[(0,Bt.jsxs)(Ki.Select,{value:N,onChange:e=>T(e.target.value),style:{fontSize:"0.8rem"},children:[(0,Bt.jsx)("option",{value:"All",children:"All"}),a.map(e=>(0,Bt.jsx)("option",{value:e.categoryName,children:e.categoryName},e._id))]}),"All"!==N&&(0,Bt.jsx)(gr,{variant:"outline-light",size:"sm",onClick:()=>{T("All")},title:"Clear filter",children:(0,Bt.jsx)("i",{className:"fas fa-times"})})]})})]})}),(0,Bt.jsx)("th",{children:(0,Bt.jsxs)("div",{className:"d-flex flex-column",children:[(0,Bt.jsx)("span",{children:"Sub Category"}),(0,Bt.jsx)("div",{className:"mt-1",children:(0,Bt.jsxs)(XRe,{size:"sm",children:[(0,Bt.jsxs)(Ki.Select,{value:A,onChange:e=>R(e.target.value),style:{fontSize:"0.8rem"},children:[(0,Bt.jsx)("option",{value:"All",children:"All"}),Array.from(new Set(n.map(e=>e.sub_category).filter(Boolean))).sort().map(e=>(0,Bt.jsx)("option",{value:e,children:e},e))]}),"All"!==A&&(0,Bt.jsx)(gr,{variant:"outline-light",size:"sm",onClick:()=>R("All"),title:"Clear filter",children:(0,Bt.jsx)("i",{className:"fas fa-times"})})]})})]})}),(0,Bt.jsx)("th",{children:"Unit"}),(0,Bt.jsx)("th",{children:"Default Brand"}),(0,Bt.jsx)("th",{children:"Rate Range"}),(0,Bt.jsx)("th",{children:"Calculations"}),(0,Bt.jsx)("th",{children:"Location"}),(0,Bt.jsx)("th",{children:"Status"}),(0,Bt.jsx)("th",{children:"Actions"})]})}),(0,Bt.jsx)("tbody",{children:le.map(e=>{var t,n,r,i;const o=e.brands||[],a=o.map(e=>e.rate_per_unit||0),s=a.length>0?Math.min(...a):0,l=a.length>0?Math.max(...a):0;return(0,Bt.jsxs)("tr",{children:[(0,Bt.jsxs)("td",{children:[(0,Bt.jsx)("strong",{children:e.material}),e.description&&(0,Bt.jsx)("div",{children:(0,Bt.jsx)("small",{className:"text-muted",children:e.description})})]}),(0,Bt.jsx)("td",{children:(0,Bt.jsx)(VRe,{bg:"info",children:e.categoryName||e.category})}),(0,Bt.jsx)("td",{children:e.sub_category?(0,Bt.jsx)(VRe,{bg:"secondary",children:e.sub_category}):(0,Bt.jsx)("span",{className:"text-muted",children:"-"})}),(0,Bt.jsxs)("td",{children:[e.unit,e.unit_size_kg&&(0,Bt.jsx)("div",{children:(0,Bt.jsxs)("small",{className:"text-muted",children:["(",e.unit_size_kg," kg)"]})})]}),(0,Bt.jsx)("td",{children:e.default_brand}),(0,Bt.jsxs)("td",{children:["\u20b9",s,s!==l&&" - \u20b9".concat(l),(0,Bt.jsx)("div",{children:(0,Bt.jsxs)("small",{className:"text-muted",children:[o.length," brands"]})})]}),(0,Bt.jsx)("td",{children:(0,Bt.jsxs)("div",{className:"d-flex flex-wrap gap-1",children:[(null===(t=e.materialCalculation)||void 0===t?void 0:t.enabled)&&(0,Bt.jsx)("div",{children:(0,Bt.jsxs)(VRe,{bg:"primary",size:"sm",title:"Material Calculation: Floor-Component specific MT values",children:[(0,Bt.jsx)("i",{className:"fas fa-cubes me-1"}),"Material"]})}),(null===(n=e.finishingCalculation)||void 0===n?void 0:n.enabled)&&(0,Bt.jsxs)(VRe,{bg:"success",size:"sm",title:"Finishing: ".concat(e.finishingCalculation.quantity_formula||"Area/Count-based"),children:[(0,Bt.jsx)("i",{className:"fas fa-paint-brush me-1"}),"Finishing"]}),!(null!==(r=e.materialCalculation)&&void 0!==r&&r.enabled)&&!(null!==(i=e.finishingCalculation)&&void 0!==i&&i.enabled)&&(0,Bt.jsx)("small",{className:"text-muted",children:"None"})]})}),(0,Bt.jsx)("td",{children:(0,Bt.jsx)(VRe,{bg:"secondary",children:e.location})}),(0,Bt.jsx)("td",{children:(0,Bt.jsx)(VRe,{bg:e.isActive?"success":"danger",children:e.isActive?"Active":"Inactive"})}),(0,Bt.jsx)("td",{children:(0,Bt.jsxs)("div",{className:"d-flex gap-2",children:[(0,Bt.jsx)(gr,{variant:"outline-primary",size:"sm",onClick:()=>ne(e),title:"Edit Item",children:(0,Bt.jsx)("i",{className:"fas fa-edit"})}),(0,Bt.jsx)(gr,{variant:"outline-danger",size:"sm",onClick:()=>ie(e.id),title:"Delete Item",children:(0,Bt.jsx)("i",{className:"fas fa-trash"})})]})})]},e.id)})})]})}),0===se.length&&!k&&(0,Bt.jsxs)("div",{className:"text-center py-4",children:[(0,Bt.jsx)("i",{className:"fas fa-boxes fa-3x text-muted mb-3"}),(0,Bt.jsx)("h5",{className:"text-muted",children:"No items found"}),(0,Bt.jsx)("p",{className:"text-muted",children:0===n.length?"Click 'Add Item' to create your first item":"Try adjusting your filters to see more results"})]}),ce>1&&(0,Bt.jsx)("div",{className:"d-flex justify-content-center mt-4",children:(0,Bt.jsxs)(cke,{children:[(0,Bt.jsx)(cke.First,{onClick:()=>ue(1),disabled:1===b}),(0,Bt.jsx)(cke.Prev,{onClick:()=>ue(b-1),disabled:1===b}),[...Array(ce)].map((e,t)=>{const n=t+1;return 1===n||n===ce||n>=b-1&&n<=b+1?(0,Bt.jsx)(cke.Item,{active:n===b,onClick:()=>ue(n),children:n},n):n===b-2||n===b+2?(0,Bt.jsx)(cke.Ellipsis,{},n):null}),(0,Bt.jsx)(cke.Next,{onClick:()=>ue(b+1),disabled:b===ce}),(0,Bt.jsx)(cke.Last,{onClick:()=>ue(ce),disabled:b===ce})]})})]})]})})}),(0,Bt.jsxs)(ga,{show:l,onHide:re,size:"xl",children:[(0,Bt.jsx)(ga.Header,{closeButton:!0,children:(0,Bt.jsxs)(ga.Title,{children:[(0,Bt.jsx)("i",{className:"fas fa-box me-2"}),u?"Edit Item":"Add New Item"]})}),(0,Bt.jsxs)(Ki,{onSubmit:async e=>{if(e.preventDefault(),O.material&&O.category&&O.unit?B.length>0&&!O.sub_category?($("Please select a Sub-Category","danger"),0):O.location?P?($("Please resolve the duplicate material error before saving","danger"),0):0!==O.brands.filter(e=>e.brand_name.trim()&&e.rate_per_unit&&!isNaN(e.rate_per_unit)).length||($("Please add at least one valid brand with name and rate","danger"),0):($("Please select a location","danger"),0):($("Please fill in all required fields (Material, Category, Unit)","danger"),0)){_(!0),$("Saving item...","info");try{var t;const e=O.brands.filter(e=>e.brand_name.trim()&&e.rate_per_unit&&!isNaN(e.rate_per_unit)),n=O.default_brand||(e.length>0?e[0].brand_name:""),r=e.find(e=>e.brand_name===n),i=r&&parseFloat(r.rate_per_unit)||0,o={material:O.material,categoryId:O.categoryId,sub_category:O.sub_category||null,unit:O.unit,unit_size_kg:O.unit_size_kg?Number(O.unit_size_kg):null,default_brand:n,defaultRate:i,brands:e,quantity_formula:O.quantity_formula||"",wastage_percent:Number(O.wastage_percent)||0,description:O.description||null,location:O.location,isActive:void 0===O.isActive||O.isActive,materialCalculation:O.materialCalculation||null,finishingCalculation:null!==(t=O.finishingCalculation)&&void 0!==t&&t.enabled?{enabled:!0,quantity_formula:O.finishingCalculation.quantity_formula||"",coverage_per_box_sqft:O.finishingCalculation.coverage_per_box_sqft||"",applicable_areas:O.finishingCalculation.applicable_areas||[],count_dependencies:O.finishingCalculation.count_dependencies||[]}:null,version:"1.0"};if(console.log("Saving itemData with categoryId:",{material:o.material,categoryId:o.categoryId,sub_category:o.sub_category}),u){const e=E(E({},o),{},{modifiedDate:(new Date).toISOString(),modifiedBy:localStorage.getItem("currentUser")||"System"}),t=u._id;if(!t)throw new Error("No MongoDB _id found for the item being updated");await Y(e,!0,t),await U(),$("Item updated successfully in database!","success")}else{const e=E(E({},o),{},{createdDate:(new Date).toISOString(),createdBy:localStorage.getItem("currentUser")||"System"});await Y(e,!1),await U(),$("Item created successfully in database!","success")}re()}catch(mW){$("Error saving item: "+mW.message,"danger")}finally{_(!1)}}},children:[(0,Bt.jsxs)(ga.Body,{children:[h&&(0,Bt.jsx)(fr,{variant:v,dismissible:!0,onClose:()=>f(!1),className:"mb-3",children:m}),(0,Bt.jsx)(mu,{className:"mb-3",children:(0,Bt.jsx)(Ri,{children:(0,Bt.jsxs)("h6",{className:"text-success mb-3",children:[(0,Bt.jsx)("i",{className:"fas fa-info-circle me-2"}),"Basic Information"]})})}),(0,Bt.jsxs)(mu,{className:"mb-3",children:[(0,Bt.jsx)(Ri,{md:4,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsxs)(Ki.Label,{children:["Material Name ",(0,Bt.jsx)("span",{className:"text-danger",children:"*"})]}),(0,Bt.jsx)(Ki.Control,{type:"text",name:"material",value:O.material,onChange:X,placeholder:"Enter material name",required:!0,className:P?"is-invalid":F?"is-valid":""}),P&&(0,Bt.jsxs)("div",{className:"invalid-feedback d-block",children:[(0,Bt.jsx)("i",{className:"fas fa-exclamation-triangle me-1"}),P]}),F&&!P&&O.material&&(0,Bt.jsxs)("div",{className:"valid-feedback d-block",children:[(0,Bt.jsx)("i",{className:"fas fa-check me-1"}),"Material name is available"]})]})}),(0,Bt.jsx)(Ri,{md:4,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsxs)(Ki.Label,{children:["Category ",(0,Bt.jsx)("span",{className:"text-danger",children:"*"})]}),(0,Bt.jsxs)(Ki.Select,{name:"category",value:O.category,onChange:e=>{const t=e.target.value,n=a.find(e=>e.categoryName===t);console.log("Category changed:",{categoryName:t,categoryId:null===n||void 0===n?void 0:n._id,selectedCategory:n}),I(e=>E(E({},e),{},{category:t,categoryId:(null===n||void 0===n?void 0:n._id)||"",sub_category:"",finishingCalculation:e.finishingCalculation||{enabled:!1,quantity_formula:"",coverage_per_box_sqft:"",applicable_areas:[],count_dependencies:[]}})),O.material&&J(O.material,t,O.location)},required:!0,children:[(0,Bt.jsx)("option",{value:"",children:"Select Category"}),a.map(e=>(0,Bt.jsx)("option",{value:e.categoryName,children:e.categoryName},e._id))]}),(0,Bt.jsx)(Ki.Text,{className:"text-muted",children:(0,Bt.jsxs)("small",{children:[(0,Bt.jsx)("i",{className:"fas fa-info-circle me-1"}),"Civil"===O.category?"Material Calculation will be auto-enabled":O.category&&"Civil"!==O.category?"Finishing Calculation will be auto-enabled":"Calculation type depends on category selection"]})})]})}),B.length>0&&(0,Bt.jsx)(Ri,{md:4,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsxs)(Ki.Label,{children:["Sub-Category ",(0,Bt.jsx)("span",{className:"text-danger",children:"*"})]}),(0,Bt.jsxs)(Ki.Select,{name:"sub_category",value:O.sub_category,onChange:X,required:!0,children:[(0,Bt.jsx)("option",{value:"",children:"Select Sub-Category"}),B.map(e=>(0,Bt.jsx)("option",{value:e,children:e},e))]})]})})]}),(0,Bt.jsxs)(mu,{className:"mb-3",children:[(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsxs)(Ki.Label,{children:["Unit ",(0,Bt.jsx)("span",{className:"text-danger",children:"*"})]}),(0,Bt.jsxs)(Ki.Select,{name:"unit",value:O.unit,onChange:X,required:!0,children:[(0,Bt.jsx)("option",{value:"",children:"Select Unit"}),["bag","cft","kg","pcs","litre","box","ft","sqft","meter","sq meter","running meter","nos","set","roll","sheet","cum"].map(e=>(0,Bt.jsx)("option",{value:e,children:e},e))]})]})}),(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Unit Size (kg)"}),(0,Bt.jsx)(Ki.Control,{type:"number",name:"unit_size_kg",value:O.unit_size_kg,onChange:X,placeholder:"e.g., 50"}),(0,Bt.jsx)(Ki.Text,{className:"text-muted",children:(0,Bt.jsx)("small",{children:"Weight per unit"})})]})}),(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Wastage %"}),(0,Bt.jsx)(Ki.Control,{type:"number",name:"wastage_percent",value:O.wastage_percent,onChange:X,min:"0",max:"100",placeholder:"0"}),(0,Bt.jsx)(Ki.Text,{className:"text-muted",children:(0,Bt.jsx)("small",{children:"Default wastage"})})]})}),(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsxs)(Ki.Label,{children:["Location ",(0,Bt.jsx)("span",{className:"text-danger",children:"*"})]}),(0,Bt.jsxs)(Ki.Select,{name:"location",value:O.location,onChange:X,required:!0,children:[(0,Bt.jsx)("option",{value:"",children:"Select Location"}),L.map(e=>(0,Bt.jsx)("option",{value:e,children:e},e))]}),(0,Bt.jsx)(Ki.Text,{className:"text-muted",children:"Select the location for this material rate"})]})})]}),(0,Bt.jsx)(mu,{className:"mb-4",children:(0,Bt.jsx)(Ri,{md:12,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Description"}),(0,Bt.jsx)(Ki.Control,{as:"textarea",rows:2,name:"description",value:O.description,onChange:X,placeholder:"Enter detailed description of the material"})]})})}),O.category&&(0,Bt.jsx)(mu,{className:"mb-4",children:(0,Bt.jsx)(Ri,{})}),O.category&&"Civil"!==O.category&&(0,Bt.jsx)(mu,{className:"mb-4",children:(0,Bt.jsx)(Ri,{md:12,children:(0,Bt.jsxs)(Xr,{className:"border-success",children:[(0,Bt.jsxs)(Xr.Header,{className:"bg-success text-white",children:[(0,Bt.jsxs)("h6",{className:"mb-0",children:[(0,Bt.jsx)("i",{className:"fas fa-paint-brush me-2"}),"Finishing Calculation (Area/Count-based)",(0,Bt.jsx)(VRe,{bg:"light",text:"success",size:"sm",className:"ms-2",children:"Required"})]}),(0,Bt.jsx)("small",{className:"text-light mt-1 d-block",children:"Area/count-based calculations for finishing materials (tiles, paint, electrical, plumbing, etc.)"})]}),(0,Bt.jsx)(Xr.Body,{children:(0,Bt.jsxs)(mu,{className:"mb-3",children:[(0,Bt.jsx)(Ri,{md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Quantity Formula"}),(0,Bt.jsx)(Ki.Control,{type:"text",value:(null===(e=O.finishingCalculation)||void 0===e?void 0:e.quantity_formula)||"",onChange:e=>Q("quantity_formula",e.target.value),placeholder:"e.g., built_up_area_sqft / 10"}),(0,Bt.jsx)(Ki.Text,{className:"text-muted",children:"Formula using area/count variables"})]})}),(0,Bt.jsx)(Ri,{md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Coverage per Box/Unit (sqft)"}),(0,Bt.jsx)(Ki.Control,{type:"number",step:"0.1",value:(null===(t=O.finishingCalculation)||void 0===t?void 0:t.coverage_per_box_sqft)||"",onChange:e=>Q("coverage_per_box_sqft",e.target.value),placeholder:"e.g., 16 for tile box"}),(0,Bt.jsx)(Ki.Text,{className:"text-muted",children:"Coverage area per unit (optional)"})]})})]})})]})})}),(0,Bt.jsx)(mu,{className:"mb-3",children:(0,Bt.jsxs)(Ri,{children:[(0,Bt.jsxs)("h6",{className:"text-success mb-3",children:[(0,Bt.jsx)("i",{className:"fas fa-tags me-2"}),"Brands & Rates",(0,Bt.jsx)("small",{className:"text-muted ms-2",children:"(Add multiple brands for this material)"})]}),O.material&&te(O.material).length>0&&(0,Bt.jsxs)("div",{className:"mb-3",children:[(0,Bt.jsx)("small",{className:"text-muted me-2",children:"Quick add common brands:"}),(0,Bt.jsx)("div",{className:"d-inline-flex flex-wrap gap-1",children:te(O.material).filter(e=>!O.brands.some(t=>t.brand_name===e)).map((e,t)=>(0,Bt.jsxs)(gr,{variant:"outline-secondary",size:"sm",onClick:()=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";I(n=>E(E({},n),{},{brands:[...n.brands,{brand_name:e,rate_per_unit:t}]}))}(e),children:["+ ",e]},t))})]}),(0,Bt.jsxs)(mu,{className:"mb-2",children:[(0,Bt.jsx)(Ri,{md:5,children:(0,Bt.jsxs)("strong",{children:["Brand Name ",(0,Bt.jsx)("span",{className:"text-danger",children:"*"})]})}),(0,Bt.jsx)(Ri,{md:4,children:(0,Bt.jsxs)("strong",{children:["Rate per ",O.unit||"Unit"," ",(0,Bt.jsx)("span",{className:"text-danger",children:"*"})]})}),(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsx)("strong",{children:"Actions"})})]}),(0,Bt.jsx)("div",{className:"border rounded p-3 bg-light",children:O.brands&&O.brands.length>0?O.brands.map((e,t)=>(0,Bt.jsxs)(mu,{className:"align-items-center ".concat(t<O.brands.length-1?"border-bottom":""," pb-2 mb-2"),children:[(0,Bt.jsx)(Ri,{md:5,children:(0,Bt.jsx)(Ki.Control,{type:"text",value:e.brand_name||"",onChange:e=>Z(t,"brand_name",e.target.value),placeholder:"Enter brand name (e.g., UltraTech, ACC)",required:0===t,size:"sm"})}),(0,Bt.jsx)(Ri,{md:4,children:(0,Bt.jsxs)(XRe,{size:"sm",children:[(0,Bt.jsx)(XRe.Text,{children:"\u20b9"}),(0,Bt.jsx)(Ki.Control,{type:"number",value:e.rate_per_unit||"",onChange:e=>Z(t,"rate_per_unit",e.target.value),placeholder:"0.00",step:"0.01",min:"0",required:0===t})]})}),(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsxs)("div",{className:"d-flex gap-1",children:[t===O.brands.length-1&&(0,Bt.jsx)(gr,{variant:"success",onClick:ee,size:"sm",title:"Add another brand",children:(0,Bt.jsx)("i",{className:"fas fa-plus"})}),O.brands.length>1&&(0,Bt.jsx)(gr,{variant:"danger",onClick:()=>(e=>{if(O.brands.length>1){const t=O.brands.filter((t,n)=>n!==e);I(e=>E(E({},e),{},{brands:t}))}})(t),size:"sm",title:"Remove this brand",children:(0,Bt.jsx)("i",{className:"fas fa-trash"})})]})})]},t)):(0,Bt.jsx)(mu,{className:"align-items-center pb-2 mb-2",children:(0,Bt.jsxs)(Ri,{md:12,className:"text-center text-muted py-3",children:[(0,Bt.jsx)("p",{children:"No brands added yet. Click the button below to add a brand."}),(0,Bt.jsxs)(gr,{variant:"success",onClick:ee,size:"sm",children:[(0,Bt.jsx)("i",{className:"fas fa-plus me-2"}),"Add First Brand"]})]})})})]})}),O.brands.filter(e=>e.brand_name&&e.rate_per_unit).length>0&&(0,Bt.jsx)(mu,{className:"mb-3",children:(0,Bt.jsx)(Ri,{md:12,children:(0,Bt.jsx)(Xr,{className:"bg-light",children:(0,Bt.jsxs)(Xr.Body,{className:"py-2",children:[(0,Bt.jsxs)("h6",{className:"mb-2 text-success",children:[(0,Bt.jsx)("i",{className:"fas fa-list me-2"}),"Brand Summary (",O.brands.filter(e=>e.brand_name&&e.rate_per_unit).length," brands)"]}),(0,Bt.jsx)("div",{className:"d-flex flex-wrap gap-2",children:O.brands.filter(e=>e.brand_name&&e.rate_per_unit).map((e,t)=>(0,Bt.jsxs)(VRe,{bg:"primary",className:"p-2",children:[e.brand_name,": \u20b9",e.rate_per_unit]},t))})]})})})}),(0,Bt.jsx)(mu,{className:"mb-4",children:(0,Bt.jsx)(Ri,{md:6,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{children:"Default Brand"}),(0,Bt.jsxs)(Ki.Select,{name:"default_brand",value:O.default_brand,onChange:X,children:[(0,Bt.jsx)("option",{value:"",children:"Auto-select first brand"}),O.brands.filter(e=>e.brand_name.trim()).map((e,t)=>(0,Bt.jsxs)("option",{value:e.brand_name,children:[e.brand_name," (\u20b9",e.rate_per_unit||"0",")"]},t))]}),(0,Bt.jsx)(Ki.Text,{className:"text-muted",children:"Brand to be used by default in calculations"})]})})}),(0,Bt.jsx)(mu,{className:"mb-3",children:(0,Bt.jsx)(Ri,{md:12,children:(0,Bt.jsx)(Ki.Check,{type:"checkbox",name:"isActive",checked:O.isActive,onChange:X,label:"Active (Include in calculations)"})})})]}),(0,Bt.jsxs)(ga.Footer,{children:[(0,Bt.jsx)(gr,{variant:"secondary",onClick:re,children:"Cancel"}),(0,Bt.jsx)(gr,{variant:"success",type:"submit",disabled:P||!F&&!u||D,children:D?(0,Bt.jsxs)(Bt.Fragment,{children:[(0,Bt.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Saving..."]}):(0,Bt.jsxs)(Bt.Fragment,{children:[(0,Bt.jsx)("i",{className:"fas fa-save me-2"}),u?"Update Item":"Save Item"]})})]})]})]})]})};gbe();const hke=e=>{let{itemForm:t,setItemForm:n}=e;const[r,i]=(0,g.useState)({materialCalculation:[]}),o=t||r,a=n||i,s=!t,[l,c]=(0,g.useState)([]),[u,d]=(0,g.useState)([]),[h,f]=(0,g.useState)(!1),[m,p]=(0,g.useState)(""),[v,y]=(0,g.useState)(""),b=(0,g.useRef)(null);(0,g.useEffect)(()=>{const e="https://buildproapi.onrender.com";(async()=>{try{const t="".concat(e,"/api/MaterialItems/category/Civil"),n=await fetch(t),r=await n.json();c(r)}catch(mW){console.error("Error fetching material items:",mW)}})(),(async()=>{try{const t="".concat(e,"/api/MaterialItems/units"),n=await fetch(t),r=await n.json(),i=Array.isArray(r)?r.map(e=>e.unit):[];d(i)}catch(mW){console.error("Error fetching units:",mW)}})(),(async()=>{try{const t="".concat(e,"/api/RccConfiguration"),n=await fetch(t);if(!n.ok)throw new Error("Failed to fetch RCC configuration");const r=await n.json();if(Array.isArray(r)&&r.length>0){const e=r.map(e=>{var t,n,r,i,o,a,s,l,c,u;return{_id:e._id||null,grade:e.grade||"",unit:e.unit||"",steel_sku:(null===(t=e.steel)||void 0===t?void 0:t.material)||"",steel_kg_per_cuft:(null===(n=e.steel)||void 0===n?void 0:n.quantity)||"",cement_sku:(null===(r=e.cement)||void 0===r?void 0:r.material)||"",cement_cft_per_cuft:(null===(i=e.cement)||void 0===i?void 0:i.quantity)||"",sand_sku:(null===(o=e.sand)||void 0===o?void 0:o.material)||"",sand_kg_per_cft:(null===(a=e.sand)||void 0===a?void 0:a.quantity)||"",aggregate_sku:(null===(s=e.aggregate)||void 0===s?void 0:s.material)||"",aggregate_kg_per_cft:(null===(l=e.aggregate)||void 0===l?void 0:l.quantity)||"",bricks_sku:(null===(c=e.bricks)||void 0===c?void 0:c.material)||"",bricks_qty_per_cuft:(null===(u=e.bricks)||void 0===u?void 0:u.quantity)||""}});a(t=>E(E({},t),{},{materialCalculation:e}))}}catch(mW){console.error("Error fetching RCC configuration:",mW)}})()},[a]);const w=e=>l.filter(t=>t.sub_category&&t.sub_category.toLowerCase()===e.toLowerCase()),x=(e,t)=>{const n=l.find(n=>n.material===e&&n.sub_category&&n.sub_category.toLowerCase()===t.toLowerCase());return n?n._id:null},S=()=>{var e;if(!(null===(e=b.current)||void 0===e?void 0:e.hotInstance))return;const t={_id:null,grade:"",unit:"",steel_sku:"",steel_kg_per_cuft:0,cement_sku:"",cement_cft_per_cuft:0,sand_sku:"",sand_kg_per_cft:0,aggregate_sku:"",aggregate_kg_per_cft:0,bricks_sku:"",bricks_qty_per_cuft:0};a(e=>{const n=Array.isArray(e.materialCalculation)?e.materialCalculation:[];return E(E({},e),{},{materialCalculation:[...n,t]})})},C=(e,t)=>{var n;if(!e||"loadData"===t)return;const r=null===(n=b.current)||void 0===n?void 0:n.hotInstance;if(!r)return;const i=r.getSourceData();a(e=>E(E({},e),{},{materialCalculation:i}))},N=()=>{const e=w("Steel").map(e=>e.material),t=w("Cement").map(e=>e.material),n=w("Sand").map(e=>e.material),r=w("Aggregate").map(e=>e.material),i=w("Bricks").map(e=>e.material);return[{data:"grade",title:"Grade",type:"text",width:80,className:"htCenter htMiddle"},{data:"unit",title:"Unit",type:"dropdown",source:u,width:80,className:"htCenter htMiddle"},{data:"steel_sku",title:"Steel SKU",type:"dropdown",source:e,width:150,className:"htCenter htMiddle"},{data:"steel_kg_per_cuft",title:"KG/Cuft",type:"numeric",numericFormat:{pattern:"0.00"},width:70,className:"htCenter htMiddle"},{data:"cement_sku",title:"Cement SKU",type:"dropdown",source:t,width:150,className:"htCenter htMiddle"},{data:"cement_cft_per_cuft",title:"Cft/Cuft",type:"numeric",numericFormat:{pattern:"0.00"},width:70,className:"htCenter htMiddle"},{data:"sand_sku",title:"Sand SKU",type:"dropdown",source:n,width:150,className:"htCenter htMiddle"},{data:"sand_kg_per_cft",title:"KG/Cuft",type:"numeric",numericFormat:{pattern:"0.00"},width:70,className:"htCenter htMiddle"},{data:"aggregate_sku",title:"Aggregate SKU",type:"dropdown",source:r,width:150,className:"htCenter htMiddle"},{data:"aggregate_kg_per_cft",title:"KG/Cuft",type:"numeric",numericFormat:{pattern:"0.00"},width:70,className:"htCenter htMiddle"},{data:"bricks_sku",title:"Bricks SKU",type:"dropdown",source:i,width:150,className:"htCenter htMiddle"},{data:"bricks_qty_per_cuft",title:"Qty/Cuft",type:"numeric",numericFormat:{pattern:"0.00"},width:90,className:"htCenter htMiddle"},{data:"action",title:"Action",type:"text",readOnly:!0,width:100,className:"htCenter",renderer:(e,t,n,r,i,o,s)=>{t.innerHTML="",t.style.padding="4px",t.style.textAlign="center",t.style.verticalAlign="middle";const l=document.createElement("button");return l.innerHTML='<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <polyline points="3 6 5 6 21 6"></polyline>\n            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>\n          </svg>',l.style.border="none",l.style.background="#dc3545",l.style.color="white",l.style.padding="6px 10px",l.style.borderRadius="4px",l.style.cursor="pointer",l.style.fontSize="12px",l.style.height="28px",l.style.display="inline-flex",l.style.alignItems="center",l.style.justifyContent="center",l.title="Delete Row",l.onclick=()=>{(async e=>{var t;const n=null===(t=b.current)||void 0===t?void 0:t.hotInstance;if(!n)return;const r=n.getSourceDataAtRow(e);if(window.confirm("Are you sure you want to delete this row?")){if(r&&r._id)try{const e="".concat("https://buildproapi.onrender.com","/api/RccConfiguration/").concat(r._id);if(!(await fetch(e,{method:"DELETE"})).ok)throw new Error("Failed to delete RCC configuration")}catch(mW){return y("danger"),void p("Error deleting configuration: "+mW.message)}n.alter("remove_row",e,1),setTimeout(()=>{const e=n.getSourceData();a(t=>E(E({},t),{},{materialCalculation:e}))},100)}})(n)},t.appendChild(l),t}}]};(0,g.useEffect)(()=>{if(m){const e=setTimeout(()=>{p(""),y("")},3e3);return()=>clearTimeout(e)}},[m]);const T=async()=>{var e;const t="https://buildproapi.onrender.com",n=null===(e=b.current)||void 0===e?void 0:e.hotInstance;if(!n)return y("danger"),void p("Table not initialized.");const r=n.getSourceData(),i=new Set;for(let a=0;a<r.length;a++){var o;const e=null===(o=r[a].grade)||void 0===o?void 0:o.trim();if(!e)return y("danger"),void p("Grade value cannot be empty (row ".concat(a+1,")."));if(i.has(e))return y("danger"),void p("Duplicate grade value '".concat(e,"' found (row ").concat(a+1,")."));i.add(e)}const s=w("Steel").map(e=>e.material),l=w("Cement").map(e=>e.material),c=w("Sand").map(e=>e.material),u=w("Aggregate").map(e=>e.material),d=w("Bricks").map(e=>e.material);for(let a=0;a<r.length;a++){const e=r[a];if(e.steel_sku&&!s.includes(e.steel_sku))return y("danger"),void p("Invalid Steel SKU in row ".concat(a+1,": ").concat(e.steel_sku));if(e.cement_sku&&!l.includes(e.cement_sku))return y("danger"),void p("Invalid Cement SKU in row ".concat(a+1,": ").concat(e.cement_sku));if(e.sand_sku&&!c.includes(e.sand_sku))return y("danger"),void p("Invalid Sand SKU in row ".concat(a+1,": ").concat(e.sand_sku));if(e.aggregate_sku&&!u.includes(e.aggregate_sku))return y("danger"),void p("Invalid Aggregate SKU in row ".concat(a+1,": ").concat(e.aggregate_sku));if(e.bricks_sku&&!d.includes(e.bricks_sku))return y("danger"),void p("Invalid Bricks SKU in row ".concat(a+1,": ").concat(e.bricks_sku))}try{let e=[...r];for(let n=0;n<r.length;n++){const i=r[n],o=x(i.steel_sku,"Steel"),a=x(i.cement_sku,"Cement"),s=x(i.sand_sku,"Sand"),l=x(i.aggregate_sku,"Aggregate"),c=x(i.bricks_sku,"Bricks"),u={grade:i.grade,unit:i.unit||"",steel:{materialId:void 0===o?null:o,quantity:parseFloat(i.steel_kg_per_cuft)||0,unit:"KG",material:i.steel_sku||""},cement:{materialId:void 0===a?null:a,quantity:parseFloat(i.cement_cft_per_cuft)||0,unit:"bag",material:i.cement_sku||""},sand:{materialId:void 0===s?null:s,quantity:parseFloat(i.sand_kg_per_cft)||0,unit:"Cft",material:i.sand_sku||""},aggregate:{materialId:void 0===l?null:l,quantity:parseFloat(i.aggregate_kg_per_cft)||0,unit:"Cft",material:i.aggregate_sku||""},bricks:{materialId:void 0===c?null:c,quantity:parseFloat(i.bricks_qty_per_cuft)||0,unit:"Nos",material:i.bricks_sku||""}};let d="".concat(t,"/api/RccConfiguration"),h="POST";i._id&&(d="".concat(t,"/api/RccConfiguration/").concat(i._id),h="PUT");const f=await fetch(d,{method:h,headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!f.ok)throw new Error("Failed to save RCC configuration for grade ".concat(i.grade));if("POST"===h){const t=await f.json();t&&t._id&&(e[n]._id=t._id)}}a(t=>E(E({},t),{},{materialCalculation:e})),y("success"),p("Configuration saved to server!")}catch(mW){y("danger"),p("Error saving configuration: "+mW.message)}};return(0,Bt.jsxs)(Bt.Fragment,{children:[s&&(0,Bt.jsxs)(Jt,{fluid:!0,className:"py-4",children:[(0,Bt.jsx)("h2",{className:"mb-4",children:"RCC Configuration"}),A()]}),!s&&A()]});function A(){var e;return(0,Bt.jsx)(mu,{className:"mb-4",children:(0,Bt.jsx)(Ri,{md:12,children:(0,Bt.jsxs)(Xr,{className:"border-primary",children:[(0,Bt.jsx)(Xr.Header,{className:"bg-primary text-white",children:(0,Bt.jsxs)("h6",{className:"mb-0",children:[(0,Bt.jsx)("i",{className:"fas fa-cubes me-2"}),"Material Calculation (Volume-based)",(0,Bt.jsx)(VRe,{bg:"light",text:"primary",size:"sm",className:"ms-2",children:"Required"})]})}),(0,Bt.jsx)(Xr.Body,{children:(0,Bt.jsx)(mu,{children:(0,Bt.jsxs)(Ri,{children:[(0,Bt.jsx)("div",{className:"mb-3",children:(0,Bt.jsx)("div",{className:"d-flex justify-content-between align-items-center mb-2",children:(0,Bt.jsxs)("div",{children:[(0,Bt.jsxs)(gr,{variant:"outline-success",size:"sm",onClick:S,className:"me-2",children:[(0,Bt.jsx)("i",{className:"fas fa-plus me-1"}),"Add Row"]}),(0,Bt.jsxs)(gr,{variant:"primary",size:"sm",onClick:T,className:"me-2",children:[(0,Bt.jsx)("i",{className:"fas fa-save me-1"}),"Save Configuration"]}),(0,Bt.jsxs)(gr,{variant:"outline-secondary",size:"sm",onClick:()=>f(!h),children:[(0,Bt.jsx)("i",{className:"fas fa-".concat(h?"eye-slash":"eye"," me-1")}),h?"Hide":"Show"," Bricks"]})]})})}),m&&(0,Bt.jsx)("div",{className:"alert alert-".concat(v," position-fixed w-100"),style:{top:0,left:0,zIndex:9999,borderRadius:0,textAlign:"center"},children:m}),(0,Bt.jsx)("div",{style:{marginTop:"10px"},children:(0,Bt.jsx)(O2,{ref:b,data:o.materialCalculation||[],columns:N(),colHeaders:!0,nestedHeaders:[[{label:"Grade",rowspan:2},{label:"Unit",rowspan:2},{label:"Steel",colspan:2},{label:"Cement",colspan:2},{label:"Sand",colspan:2},{label:"Aggregate",colspan:2},{label:"Bricks",colspan:2},{label:"Action",rowspan:2}],[{label:"",colspan:1},{label:"",colspan:1},{label:"SKU",colspan:1},{label:"KG",colspan:1},{label:"SKU",colspan:1},{label:"Bag",colspan:1},{label:"SKU",colspan:1},{label:"Cft",colspan:1},{label:"SKU",colspan:1},{label:"Cft",colspan:1},{label:"SKU",colspan:1},{label:"Pcs",colspan:1}]],rowHeaders:!0,height:"auto",licenseKey:"non-commercial-and-evaluation",stretchH:"all",hiddenColumns:{columns:h?[]:[10,11],indicators:!1},afterChange:C,afterInit:()=>{setTimeout(()=>{const e=document.querySelectorAll(".ht_clone_top thead tr:first-child th");e[2]&&(e[2].style.backgroundColor="#d1e7dd"),e[3]&&(e[3].style.backgroundColor="#cff4fc"),e[4]&&(e[4].style.backgroundColor="#fff3cd"),e[5]&&(e[5].style.backgroundColor="#e2e3e5"),e[6]&&(e[6].style.backgroundColor="#f8d7da")},100)},contextMenu:!1,manualColumnResize:!0,manualRowResize:!0},h?"with-bricks":"without-bricks")}),(!Array.isArray(o.materialCalculation)||!(null!==(e=o.materialCalculation)&&void 0!==e&&e.length))&&(0,Bt.jsx)("div",{className:"text-center text-muted py-4",style:{border:"1px solid #dee2e6",borderTop:"none"},children:'No material configuration found. Click "Add Row" to add configuration.'})]})})})]})})})}},fke=()=>{var e;const[t,n]=(0,g.useState)([]),[r,i]=(0,g.useState)(!0),[o,a]=(0,g.useState)(!1),[s,l]=(0,g.useState)(null),[c,u]=(0,g.useState)({show:!1,type:"",message:""}),[d,h]=(0,g.useState)(!1),[f,m]=(0,g.useState)(""),[p,v]=(0,g.useState)("");(0,g.useEffect)(()=>{y()},[]);const y=async()=>{try{i(!0);const e="https://buildproapi.onrender.com",t=await fetch("".concat(e,"/api/RoomConfiguration"));if(!t.ok)throw new Error("Failed to load BHK configurations");const r=await t.json();n(r)}catch(mW){console.error("Error loading configurations:",mW),u({show:!0,type:"danger",message:"Error loading configurations: ".concat(mW.message)})}finally{i(!1)}},b=()=>{a(!1),l(null),h(!1),m("")},w=(e,t,n)=>{const r=E({},s);if(t.includes(".")){const[i,o]=t.split(".");r.rooms[e][i][o]=Number(n)||0}else r.rooms[e][t]=n;l(r)},x=e=>e?new Date(e).toLocaleDateString("en-IN"):"-";return(0,Bt.jsxs)(Jt,{fluid:!0,style:{padding:"2rem"},children:[(0,Bt.jsxs)("div",{style:{marginBottom:"2rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,Bt.jsx)("h2",{style:{color:"#1976d2",fontWeight:600,margin:0},children:"BHK Configuration Master"}),(0,Bt.jsxs)(gr,{variant:"primary",onClick:()=>{l({type:"",total_carpet_area_sqft:0,bathroom_count:0,rooms:[]}),h(!0),m(""),a(!0)},children:[(0,Bt.jsx)(Gu,{})," New BHK"]})]}),c.show&&(0,Bt.jsx)(fr,{variant:c.type,dismissible:!0,onClose:()=>u({show:!1,type:"",message:""}),style:{position:"sticky",top:"1rem",zIndex:1e3},children:c.message}),r?(0,Bt.jsx)("div",{style:{textAlign:"center",padding:"3rem"},children:(0,Bt.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,Bt.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}):(0,Bt.jsx)("div",{style:{background:"#fff",borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",overflow:"hidden"},children:(0,Bt.jsxs)(Zr,{hover:!0,responsive:!0,style:{marginBottom:0},children:[(0,Bt.jsx)("thead",{children:(0,Bt.jsxs)("tr",{style:{background:"#e3f2fd"},children:[(0,Bt.jsx)("th",{style:{padding:"1rem",verticalAlign:"middle"},children:(0,Bt.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[(0,Bt.jsx)("span",{style:{fontWeight:600,color:"#1976d2",fontSize:"0.95rem"},children:"BHK Type"}),(0,Bt.jsxs)(Ki.Select,{value:p,onChange:e=>v(e.target.value),size:"sm",children:[(0,Bt.jsx)("option",{value:"",children:"All"}),[...new Set(t.map(e=>e.type))].sort().map(e=>(0,Bt.jsx)("option",{value:e,children:e},e))]})]})}),(0,Bt.jsx)("th",{style:{padding:"1rem",fontWeight:600,color:"#1976d2",fontSize:"0.95rem",verticalAlign:"bottom"},children:"Carpet Area (sq ft)"}),(0,Bt.jsx)("th",{style:{padding:"1rem",fontWeight:600,color:"#1976d2",fontSize:"0.95rem",verticalAlign:"bottom"},children:"Created Date"}),(0,Bt.jsx)("th",{style:{padding:"1rem",fontWeight:600,color:"#1976d2",fontSize:"0.95rem",verticalAlign:"bottom"},children:"Modified Date"}),(0,Bt.jsx)("th",{style:{padding:"1rem",fontWeight:600,color:"#1976d2",fontSize:"0.95rem",textAlign:"center",verticalAlign:"bottom"},children:"Actions"})]})}),(0,Bt.jsx)("tbody",{children:0===t.filter(e=>!p||e.type===p).length?(0,Bt.jsx)("tr",{children:(0,Bt.jsx)("td",{colSpan:"5",style:{textAlign:"center",padding:"2rem",color:"#888"},children:p?'No BHK configurations found for "'.concat(p,'"'):"No BHK configurations found"})}):t.filter(e=>!p||e.type===p).map(e=>(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("td",{style:{padding:"1rem"},children:e.type}),(0,Bt.jsx)("td",{style:{padding:"1rem"},children:e.total_carpet_area_sqft}),(0,Bt.jsx)("td",{style:{padding:"1rem"},children:x(e.createdDate)}),(0,Bt.jsx)("td",{style:{padding:"1rem"},children:x(e.modifiedDate)}),(0,Bt.jsxs)("td",{style:{padding:"1rem",textAlign:"center"},children:[(0,Bt.jsxs)(gr,{variant:"outline-primary",size:"sm",className:"me-2",onClick:()=>(e=>{l(e),h(!1),m(""),a(!0)})(e),children:[(0,Bt.jsx)(zu,{})," Edit"]}),(0,Bt.jsxs)(gr,{variant:"outline-danger",size:"sm",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this BHK configuration?"))try{const t="https://buildproapi.onrender.com";if(!(await fetch("".concat(t,"/api/RoomConfiguration/").concat(e),{method:"DELETE"})).ok)throw new Error("Failed to delete configuration");u({show:!0,type:"success",message:"BHK configuration deleted successfully!"}),y(),setTimeout(()=>{u({show:!1,type:"",message:""})},3e3)}catch(mW){console.error("Error deleting configuration:",mW),u({show:!0,type:"danger",message:"Error deleting configuration: ".concat(mW.message)}),setTimeout(()=>{u({show:!1,type:"",message:""})},5e3)}})(e._id),children:[(0,Bt.jsx)(Xu,{})," Delete"]})]})]},e._id))})]})}),(0,Bt.jsxs)(ga,{show:o,onHide:b,size:"xl",centered:!0,children:[(0,Bt.jsx)(ga.Header,{closeButton:!0,style:{background:"#e3f2fd",borderBottom:"2px solid #1976d2"},children:(0,Bt.jsx)(ga.Title,{style:{color:"#1976d2",fontWeight:600,width:"100%"},children:(0,Bt.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[(0,Bt.jsx)("span",{children:d?"New BHK Configuration":"Edit BHK Configuration - ".concat(null===s||void 0===s?void 0:s.type)}),c.show&&(0,Bt.jsx)(fr,{variant:c.type,dismissible:!0,onClose:()=>u({show:!1,type:"",message:""}),style:{margin:0,padding:"0.5rem 1rem",fontSize:"0.9rem"},children:c.message})]})})}),(0,Bt.jsx)(ga.Body,{style:{maxHeight:"70vh",overflowY:"auto"},children:s&&(0,Bt.jsxs)("div",{children:[d&&(0,Bt.jsx)("div",{style:{background:"#fff3cd",padding:"1rem",borderRadius:6,marginBottom:"1.5rem",border:"1px solid #ffc107"},children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsxs)(Ki.Label,{style:{fontWeight:600,color:"#856404"},children:[(0,Bt.jsx)(Gu,{})," Copy from Existing BHK (Optional)"]}),(0,Bt.jsxs)(Ki.Select,{value:f,onChange:e=>{m(e.target.value),(e=>{if(!e)return void l({type:"",total_carpet_area_sqft:0,bathroom_count:0,rooms:[]});const n=t.find(t=>t._id===e);if(n){const e={type:"",total_carpet_area_sqft:n.total_carpet_area_sqft,bathroom_count:n.bathroom_count,rooms:JSON.parse(JSON.stringify(n.rooms))};l(e)}})(e.target.value)},style:{maxWidth:"400px"},children:[(0,Bt.jsx)("option",{value:"",children:"-- Start from scratch --"}),t.map(e=>(0,Bt.jsxs)("option",{value:e._id,children:[e.type," (",e.total_carpet_area_sqft," sq ft)"]},e._id))]}),(0,Bt.jsx)(Ki.Text,{className:"text-muted",children:"Select an existing BHK to copy all room configurations"})]})}),(0,Bt.jsxs)(mu,{className:"mb-4",children:[(0,Bt.jsx)(Ri,{md:4,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{style:{fontWeight:600},children:"BHK Type"}),(0,Bt.jsx)(Ki.Control,{type:"text",value:s.type,onChange:e=>l(E(E({},s),{},{type:e.target.value}))})]})}),(0,Bt.jsx)(Ri,{md:4,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{style:{fontWeight:600},children:"Total Carpet Area (sq ft)"}),(0,Bt.jsx)(Ki.Control,{type:"number",value:s.total_carpet_area_sqft,onChange:e=>l(E(E({},s),{},{total_carpet_area_sqft:Number(e.target.value)}))})]})}),(0,Bt.jsx)(Ri,{md:4,children:(0,Bt.jsxs)(Ki.Group,{children:[(0,Bt.jsx)(Ki.Label,{style:{fontWeight:600},children:"Calculated Area (sq ft)"}),(0,Bt.jsx)(Ki.Control,{type:"text",value:(null===(e=s.rooms)||void 0===e?void 0:e.reduce((e,t)=>{var n,r;return e+((null===(n=t.dimensions_ft)||void 0===n?void 0:n.length)||0)*((null===(r=t.dimensions_ft)||void 0===r?void 0:r.width)||0)},0).toFixed(2))||"0.00",disabled:!0,style:{backgroundColor:"#e8f5e9",color:"#2e7d32",fontWeight:600},title:"Sum of all room areas"})]})})]}),(0,Bt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,Bt.jsx)("h5",{style:{color:"#1976d2",fontWeight:600,margin:0},children:"Room Details"}),(0,Bt.jsxs)(gr,{variant:"success",size:"sm",onClick:()=>{const e=E({},s);e.rooms=[...e.rooms,{name:"New Room",dimensions_ft:{length:0,width:0,height:9},Door:{count:0,width:0,height:0},Window:{count:0,width:0,height:0},area_sqft:0}],l(e)},children:[(0,Bt.jsx)(Gu,{})," Add Room"]})]}),s.rooms&&s.rooms.map((e,t)=>{var n,r,i,o,a,c,u,d,h,f,m,p,g,v,y,b,x;return(0,Bt.jsxs)("div",{style:{background:"#f9f9f9",padding:"1rem",borderRadius:6,marginBottom:"1rem",border:"1px solid #e0e0e0",position:"relative"},children:[(0,Bt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,Bt.jsx)(Ki.Control,{type:"text",value:e.name,onChange:e=>w(t,"name",e.target.value),style:{fontWeight:600,color:"#388e3c",border:"1px solid #ddd",maxWidth:"300px"}}),(0,Bt.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,Bt.jsx)(gr,{variant:"outline-primary",size:"sm",onClick:()=>(e=>{if(0===e)return;const t=E({},s),n=[...t.rooms];[n[e-1],n[e]]=[n[e],n[e-1]],t.rooms=n,l(t)})(t),disabled:0===t,title:"Move Up",children:(0,Bt.jsx)(Hu,{})}),(0,Bt.jsx)(gr,{variant:"outline-primary",size:"sm",onClick:()=>(e=>{if(e===s.rooms.length-1)return;const t=E({},s),n=[...t.rooms];[n[e],n[e+1]]=[n[e+1],n[e]],t.rooms=n,l(t)})(t),disabled:t===s.rooms.length-1,title:"Move Down",children:(0,Bt.jsx)(Fu,{})}),(0,Bt.jsx)(gr,{variant:"outline-danger",size:"sm",onClick:()=>(e=>{if(!window.confirm("Are you sure you want to remove this room?"))return;const t=E({},s);t.rooms=t.rooms.filter((t,n)=>n!==e),l(t)})(t),title:"Remove Room",children:(0,Bt.jsx)(Xu,{})})]})]}),(0,Bt.jsxs)(mu,{children:[(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsxs)(Ki.Group,{className:"mb-3",children:[(0,Bt.jsx)(Ki.Label,{children:"Length (ft)"}),(0,Bt.jsx)(Ki.Control,{type:"number",step:"0.1",value:(null===(n=e.dimensions_ft)||void 0===n?void 0:n.length)||0,onChange:e=>w(t,"dimensions_ft.length",e.target.value)})]})}),(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsxs)(Ki.Group,{className:"mb-3",children:[(0,Bt.jsx)(Ki.Label,{children:"Width (ft)"}),(0,Bt.jsx)(Ki.Control,{type:"number",step:"0.1",value:(null===(r=e.dimensions_ft)||void 0===r?void 0:r.width)||0,onChange:e=>w(t,"dimensions_ft.width",e.target.value)})]})}),(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsxs)(Ki.Group,{className:"mb-3",children:[(0,Bt.jsx)(Ki.Label,{children:"Height (ft)"}),(0,Bt.jsx)(Ki.Control,{type:"number",step:"0.1",value:(null===(i=e.dimensions_ft)||void 0===i?void 0:i.height)||0,onChange:e=>w(t,"dimensions_ft.height",e.target.value)})]})}),(0,Bt.jsx)(Ri,{md:3,children:(0,Bt.jsxs)(Ki.Group,{className:"mb-3",children:[(0,Bt.jsx)(Ki.Label,{children:"Area (sq ft)"}),(0,Bt.jsx)(Ki.Control,{type:"number",value:(((null===(o=e.dimensions_ft)||void 0===o?void 0:o.length)||0)*((null===(a=e.dimensions_ft)||void 0===a?void 0:a.width)||0)).toFixed(2),disabled:!0,style:{backgroundColor:"#f0f0f0",color:"#555"}})]})})]}),(0,Bt.jsxs)(mu,{children:[(0,Bt.jsx)(Ri,{md:6,children:(0,Bt.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.75rem"},children:[(0,Bt.jsx)("strong",{style:{color:"#555",minWidth:"60px"},children:"Door:"}),(0,Bt.jsx)(Ki.Control,{type:"number",placeholder:"Count",value:(null===(c=e.Door)||void 0===c?void 0:c.count)||0,onChange:e=>w(t,"Door.count",e.target.value),style:{width:"70px"},size:"sm",title:"Count"}),(0,Bt.jsx)(Ki.Control,{type:"number",step:"0.1",placeholder:"Width",value:(null===(u=e.Door)||void 0===u?void 0:u.width)||0,onChange:e=>w(t,"Door.width",e.target.value),style:{width:"70px"},size:"sm",title:"Width (ft)"}),(0,Bt.jsx)("span",{style:{fontSize:"0.85rem",color:"#666"},children:"\xd7"}),(0,Bt.jsx)(Ki.Control,{type:"number",step:"0.1",placeholder:"Height",value:(null===(d=e.Door)||void 0===d?void 0:d.height)||0,onChange:e=>w(t,"Door.height",e.target.value),style:{width:"70px"},size:"sm",title:"Height (ft)"}),(0,Bt.jsx)("span",{style:{fontSize:"0.75rem",color:"#888"},children:"ft"}),(0,Bt.jsx)("span",{style:{fontSize:"0.85rem",color:"#666",marginLeft:"0.25rem"},children:"="}),(0,Bt.jsx)(Ki.Control,{type:"text",value:(((null===(h=e.Door)||void 0===h?void 0:h.count)||0)*((null===(f=e.Door)||void 0===f?void 0:f.width)||0)*((null===(m=e.Door)||void 0===m?void 0:m.height)||0)).toFixed(2),disabled:!0,style:{width:"80px",backgroundColor:"#e8f5e9",color:"#2e7d32",fontWeight:600,textAlign:"center"},size:"sm",title:"Total Door Area (sq ft)"}),(0,Bt.jsx)("span",{style:{fontSize:"0.75rem",color:"#888"},children:"sq ft"})]})}),(0,Bt.jsx)(Ri,{md:6,children:(0,Bt.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.75rem"},children:[(0,Bt.jsx)("strong",{style:{color:"#555",minWidth:"70px"},children:"Window:"}),(0,Bt.jsx)(Ki.Control,{type:"number",placeholder:"Count",value:(null===(p=e.Window)||void 0===p?void 0:p.count)||0,onChange:e=>w(t,"Window.count",e.target.value),style:{width:"70px"},size:"sm",title:"Count"}),(0,Bt.jsx)(Ki.Control,{type:"number",step:"0.1",placeholder:"Width",value:(null===(g=e.Window)||void 0===g?void 0:g.width)||0,onChange:e=>w(t,"Window.width",e.target.value),style:{width:"70px"},size:"sm",title:"Width (ft)"}),(0,Bt.jsx)("span",{style:{fontSize:"0.85rem",color:"#666"},children:"\xd7"}),(0,Bt.jsx)(Ki.Control,{type:"number",step:"0.1",placeholder:"Height",value:(null===(v=e.Window)||void 0===v?void 0:v.height)||0,onChange:e=>w(t,"Window.height",e.target.value),style:{width:"70px"},size:"sm",title:"Height (ft)"}),(0,Bt.jsx)("span",{style:{fontSize:"0.75rem",color:"#888"},children:"ft"}),(0,Bt.jsx)("span",{style:{fontSize:"0.85rem",color:"#666",marginLeft:"0.25rem"},children:"="}),(0,Bt.jsx)(Ki.Control,{type:"text",value:(((null===(y=e.Window)||void 0===y?void 0:y.count)||0)*((null===(b=e.Window)||void 0===b?void 0:b.width)||0)*((null===(x=e.Window)||void 0===x?void 0:x.height)||0)).toFixed(2),disabled:!0,style:{width:"80px",backgroundColor:"#e3f2fd",color:"#1976d2",fontWeight:600,textAlign:"center"},size:"sm",title:"Total Window Area (sq ft)"}),(0,Bt.jsx)("span",{style:{fontSize:"0.75rem",color:"#888"},children:"sq ft"})]})})]})]},t)})]})}),(0,Bt.jsxs)(ga.Footer,{children:[(0,Bt.jsx)(gr,{variant:"secondary",onClick:b,children:"Cancel"}),(0,Bt.jsx)(gr,{variant:"primary",onClick:async()=>{try{if(!s.type||""===s.type.trim())return u({show:!0,type:"danger",message:"Please enter BHK Type"}),void setTimeout(()=>u({show:!1,type:"",message:""}),3e3);const e="https://buildproapi.onrender.com",t=d?"POST":"PUT",n=d?"".concat(e,"/api/RoomConfiguration"):"".concat(e,"/api/RoomConfiguration/").concat(s._id),r=await fetch(n,{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!r.ok)throw new Error("Failed to update configuration");if(console.log("Save successful, setting alert message"),u({show:!0,type:"success",message:d?"New BHK configuration created successfully!":"Configuration updated successfully!"}),d){h(!1);const e=await r.json();l(e)}y(),setTimeout(()=>{u({show:!1,type:"",message:""})},3e3)}catch(mW){console.error("Error updating configuration:",mW),u({show:!0,type:"danger",message:"Error updating configuration: ".concat(mW.message)}),setTimeout(()=>{u({show:!1,type:"",message:""})},5e3)}},children:"Save Changes"})]})]})]})},mke=["version","description","last_updated","_id"],pke=["name","Applicable Floors","originalIndex"],gke=["name","Applicable Floors","originalIndex"],vke=["name","Applicable Floors","originalIndex"],yke=["name","Applicable Floors","originalIndex"],bke=()=>{const[e,t]=(0,g.useState)(null),[n,r]=(0,g.useState)([]),[i,o]=(0,g.useState)(!0),[a,s]=(0,g.useState)({show:!1,type:"",message:""}),[l,c]=(0,g.useState)(null),[u,d]=(0,g.useState)({}),[h,f]=(0,g.useState)(null),[m,p]=(0,g.useState)([]),[v,y]=(0,g.useState)("All"),[w,x]=(0,g.useState)({name:"",Formula:"",Area:"",Volume:"",Percentage:"",Thickness:"",Labour:"no",Material:"no",Category:"",Mixture:"","Applicable Floors":[]}),S=["Foundation","Basement","Floors"],C=["Earthwork","Concrete","Mixture"];(0,g.useEffect)(()=>{T(),N()},[]);const N=async()=>{try{const e="https://buildproapi.onrender.com",t=await fetch("".concat(e,"/api/RccConfiguration"));if(!t.ok)return void console.error("Failed to load RCC configurations, status:",t.status);const n=await t.json();console.log("RCC Configuration data:",n);const r=[];Array.isArray(n)?n.forEach(e=>{e.grade&&!r.includes(e.grade)&&r.push(e.grade)}):n.grade&&!r.includes(n.grade)&&r.push(n.grade),console.log("Extracted grades:",r),p(r)}catch(mW){console.error("Error loading grade options:",mW)}},T=async()=>{try{o(!0);const e="https://buildproapi.onrender.com",n=await fetch("".concat(e,"/api/AreaCalculation"));if(!n.ok)throw new Error("Failed to load area calculations");const i=await n.json();console.log("Area Calculation raw data:",i);const a=Array.isArray(i)?i:[i],s={},l=[];a.forEach(e=>{console.log("Config object:",e);const{version:t,description:n,last_updated:r,_id:i}=e,o=b(e,mke);if(e.calculation_components)Object.entries(e.calculation_components).forEach(e=>{let[t,n]=e;l.push(E(E({name:t},n),{},{"Applicable Floors":n["Applicable Floors"]||[]}))});else{const t=e["Applicable Floors"];t&&(s[t]=e),Object.entries(o).forEach(e=>{let[n,r]=e;"Applicable Floors"!==n&&"object"===typeof r&&l.push(E(E({name:n},r),{},{"Applicable Floors":t?[t]:r["Applicable Floors"]||[]}))})}}),console.log("Parsed components array:",l),r(l),t(s)}catch(mW){console.error("Error loading calculations:",mW),s({show:!0,type:"danger",message:"Error loading calculations: ".concat(mW.message)})}finally{o(!1)}},A=()=>{c(null),d({})},R=()=>{f(null),x({name:"",Area:"",Volume:"",Percentage:"",Thickness:"",Labour:"no",Material:"no",Category:"","Applicable Floors":[]})},k=async()=>{if(!w.name)return s({show:!0,type:"danger",message:"Component name is required!"}),void setTimeout(()=>s({show:!1,type:"",message:""}),3e3);try{var i,o,a,l;const c="https://buildproapi.onrender.com",u=w["Applicable Floors"]&&w["Applicable Floors"][0];if(!u)throw new Error("Component must have an Applicable Floor");const d=[...n,w],h=d.reduce((e,t)=>{const n=t["Applicable Floors"]&&t["Applicable Floors"][0];return e[n]||(e[n]=[]),e[n].push(t),e},{}),m={};null===(i=h[u])||void 0===i||i.forEach(e=>{const{name:t,"Applicable Floors":n,originalIndex:r}=e,i=b(e,vke);m[t]=i});const p=E(E({},(null===e||void 0===e||null===(o=e[u])||void 0===o?void 0:o._id)&&{_id:e[u]._id}),{},{"Applicable Floors":u,version:"1.0",description:"Construction estimation components for ".concat(u),last_updated:(new Date).toISOString().split("T")[0]},m),g=null!==e&&void 0!==e&&null!==(a=e[u])&&void 0!==a&&a._id?"".concat(c,"/api/AreaCalculation/").concat(e[u]._id):"".concat(c,"/api/AreaCalculation"),v=null!==e&&void 0!==e&&null!==(l=e[u])&&void 0!==l&&l._id?"PUT":"POST",y=await fetch(g,{method:v,headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!y.ok)throw new Error("Failed to add calculation");const S=await y.json();t(e=>E(E({},e),{},{[u]:S})),r(d),f(null),x({name:"",Area:"",Volume:"",Percentage:"",Thickness:"",Labour:"no",Material:"no",Category:"",Mixture:"","Applicable Floors":[]}),s({show:!0,type:"success",message:"New calculation component added successfully!"}),setTimeout(()=>s({show:!1,type:"",message:""}),3e3)}catch(mW){console.error("Error adding calculation:",mW),s({show:!0,type:"danger",message:"Error adding calculation: ".concat(mW.message)}),setTimeout(()=>s({show:!1,type:"",message:""}),5e3)}},M=(e,t)=>{d(E(E({},u),{},{[e]:t}))},D=(e,t)=>{x(E(E({},w),{},{[e]:t}))},_=e=>n.map((e,t)=>E(E({},e),{},{originalIndex:t})).filter(t=>t["Applicable Floors"]&&t["Applicable Floors"].includes(e)),O=async n=>{try{const i="https://buildproapi.onrender.com";r(n);const o=n.reduce((e,t)=>{const n=t["Applicable Floors"]&&t["Applicable Floors"][0];return e[n]||(e[n]=[]),e[n].push(t),e},{}),a=Object.entries(o).map(async t=>{var n,r,o;let[a,s]=t;const l={};s.forEach(e=>{const{name:t,"Applicable Floors":n,originalIndex:r}=e,i=b(e,yke);l[t]=i});const c=E(E({},(null===e||void 0===e||null===(n=e[a])||void 0===n?void 0:n._id)&&{_id:e[a]._id}),{},{"Applicable Floors":a,version:"1.0",description:"Construction estimation components for ".concat(a),last_updated:(new Date).toISOString().split("T")[0]},l),u=null!==e&&void 0!==e&&null!==(r=e[a])&&void 0!==r&&r._id?"".concat(i,"/api/AreaCalculation/").concat(e[a]._id):"".concat(i,"/api/AreaCalculation"),d=null!==e&&void 0!==e&&null!==(o=e[a])&&void 0!==o&&o._id?"PUT":"POST",h=await fetch(u,{method:d,headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!h.ok)throw new Error("Failed to update order for ".concat(a));return{section:a,data:await h.json()}}),s=await Promise.all(a),l=E({},e);s.forEach(e=>{let{section:t,data:n}=e;l[t]=n}),t(l)}catch(mW){console.error("Error updating order:",mW),s({show:!0,type:"danger",message:"Error updating order: ".concat(mW.message)}),setTimeout(()=>s({show:!1,type:"",message:""}),5e3)}};return(0,Bt.jsxs)(Jt,{fluid:!0,style:{padding:"2rem"},children:[(0,Bt.jsx)("div",{style:{marginBottom:"2rem"},children:(0,Bt.jsx)("h2",{style:{color:"#1976d2",fontWeight:600,margin:0},children:"Area Calculation Master"})}),(0,Bt.jsxs)("div",{style:{marginBottom:"1rem",display:"flex",gap:"1rem",alignItems:"center"},children:[(0,Bt.jsx)(Ki.Label,{style:{marginBottom:0,fontWeight:500},children:"Filter by Floor:"}),(0,Bt.jsxs)(Ki.Select,{style:{width:"200px"},value:v,onChange:e=>y(e.target.value),children:[(0,Bt.jsx)("option",{value:"All",children:"All Floors"}),S.map(e=>(0,Bt.jsx)("option",{value:e,children:e},e))]})]}),a.show&&(0,Bt.jsx)(fr,{variant:a.type,dismissible:!0,onClose:()=>s({show:!1,type:"",message:""}),style:{position:"sticky",top:"1rem",zIndex:1e3},children:a.message}),i?(0,Bt.jsx)("div",{style:{textAlign:"center",padding:"3rem"},children:(0,Bt.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,Bt.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}):(0,Bt.jsx)("div",{style:{background:"#fff",borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",overflow:"auto"},children:(0,Bt.jsxs)(Zr,{hover:!0,responsive:!0,bordered:!0,style:{marginBottom:0,fontSize:"0.9rem"},children:[(0,Bt.jsx)("thead",{style:{background:"#1976d2",position:"sticky",top:0,zIndex:1},children:(0,Bt.jsxs)("tr",{children:[(0,Bt.jsx)("th",{style:{padding:"0.75rem",fontWeight:600,color:"#fff",fontSize:"0.85rem",width:"140px",borderRight:"1px solid rgba(255,255,255,0.2)"},children:"Applicable Floor"}),(0,Bt.jsx)("th",{style:{padding:"0.75rem",fontWeight:600,color:"#fff",fontSize:"0.85rem",width:"200px",borderRight:"1px solid rgba(255,255,255,0.2)"},children:"Component Name"}),(0,Bt.jsx)("th",{style:{padding:"0.75rem",fontWeight:600,color:"#fff",fontSize:"0.85rem",width:"250px",borderRight:"1px solid rgba(255,255,255,0.2)"},children:"Formula"}),(0,Bt.jsx)("th",{style:{padding:"0.75rem",fontWeight:600,color:"#fff",fontSize:"0.85rem",width:"100px",textAlign:"center",borderRight:"1px solid rgba(255,255,255,0.2)"},children:"Labour"}),(0,Bt.jsx)("th",{style:{padding:"0.75rem",fontWeight:600,color:"#fff",fontSize:"0.85rem",width:"100px",textAlign:"center",borderRight:"1px solid rgba(255,255,255,0.2)"},children:"Material"}),(0,Bt.jsx)("th",{style:{padding:"0.75rem",fontWeight:600,color:"#fff",fontSize:"0.85rem",width:"120px",textAlign:"center",borderRight:"1px solid rgba(255,255,255,0.2)"},children:"Category"}),(0,Bt.jsx)("th",{style:{padding:"0.75rem",fontWeight:600,color:"#fff",fontSize:"0.85rem",width:"120px",textAlign:"center",borderRight:"1px solid rgba(255,255,255,0.2)"},children:"Mixture"}),(0,Bt.jsx)("th",{style:{padding:"0.75rem",fontWeight:600,color:"#fff",fontSize:"0.85rem",width:"200px",textAlign:"center"},children:"Actions"})]})}),(0,Bt.jsx)("tbody",{children:S.filter(e=>"All"===v||v===e).map(i=>{const o=_(i);return(0,Bt.jsxs)(g.Fragment,{children:[(0,Bt.jsx)("tr",{style:{background:"linear-gradient(to right, #e8f5e9, #f1f8f4)",borderTop:"2px solid #4caf50"},children:(0,Bt.jsx)("td",{colSpan:"8",style:{padding:"0.8rem 1rem",fontWeight:700,color:"#2e7d32",fontSize:"0.95rem",letterSpacing:"0.5px"},children:(0,Bt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,Bt.jsx)("span",{children:i}),(0,Bt.jsxs)(gr,{variant:"success",size:"sm",onClick:()=>(e=>{f(e),x({name:"",Area:"",Volume:"",Percentage:"",Thickness:"",Labour:"no",Material:"no",Category:"",Mixture:"","Applicable Floors":[e]})})(i),disabled:null!==h,children:[(0,Bt.jsx)(Gu,{})," Add to ",i]})]})})}),h===i&&(0,Bt.jsxs)("tr",{style:{background:"#fff3cd"},children:[(0,Bt.jsx)("td",{style:{padding:"0.4rem"},children:(0,Bt.jsx)("div",{style:{fontSize:"0.8rem",padding:"0.3rem",fontWeight:600},children:i})}),(0,Bt.jsx)("td",{style:{padding:"0.4rem"},children:(0,Bt.jsx)(Ki.Control,{size:"sm",value:w.name,onChange:e=>D("name",e.target.value),placeholder:"Component name"})}),(0,Bt.jsx)("td",{style:{padding:"0.4rem"},children:(0,Bt.jsx)(Ki.Control,{size:"sm",value:w.Formula||"",onChange:e=>D("Formula",e.target.value),placeholder:"Formula",style:{fontSize:"0.8rem"}})}),(0,Bt.jsx)("td",{style:{padding:"0.4rem"},children:(0,Bt.jsxs)(Ki.Select,{size:"sm",value:w.Labour,onChange:e=>D("Labour",e.target.value),children:[(0,Bt.jsx)("option",{value:"yes",children:"Yes"}),(0,Bt.jsx)("option",{value:"no",children:"No"})]})}),(0,Bt.jsx)("td",{style:{padding:"0.4rem"},children:(0,Bt.jsxs)(Ki.Select,{size:"sm",value:w.Material,onChange:e=>D("Material",e.target.value),style:{fontSize:"0.8rem"},children:[(0,Bt.jsx)("option",{value:"yes",children:"Yes"}),(0,Bt.jsx)("option",{value:"no",children:"No"})]})}),(0,Bt.jsx)("td",{style:{padding:"0.4rem"},children:(0,Bt.jsxs)(Ki.Select,{size:"sm",value:w.Category,onChange:e=>D("Category",e.target.value),style:{fontSize:"0.8rem"},children:[(0,Bt.jsx)("option",{value:"",children:"Select..."}),C.map(e=>(0,Bt.jsx)("option",{value:e,children:e},e))]})}),(0,Bt.jsx)("td",{style:{padding:"0.4rem"},children:"Earthwork"!==w.Category&&(0,Bt.jsxs)(Ki.Select,{size:"sm",value:w.Mixture||"",onChange:e=>D("Mixture",e.target.value),style:{fontSize:"0.8rem"},children:[(0,Bt.jsx)("option",{value:"",children:"Select..."}),m.map(e=>(0,Bt.jsx)("option",{value:e,children:e},e))]})}),(0,Bt.jsxs)("td",{style:{padding:"0.4rem",textAlign:"center"},children:[(0,Bt.jsx)(gr,{variant:"success",size:"sm",onClick:k,className:"me-1",children:(0,Bt.jsx)(Yu,{})}),(0,Bt.jsx)(gr,{variant:"secondary",size:"sm",onClick:R,children:(0,Bt.jsx)($u,{})})]})]}),o.map((a,h)=>{const f=a.originalIndex;return(0,Bt.jsxs)("tr",{style:{borderBottom:"1px solid #e0e0e0"},children:[(0,Bt.jsx)("td",{style:{padding:"0.75rem",fontSize:"0.85rem",color:"#555",verticalAlign:"middle"},children:i}),(0,Bt.jsx)("td",{style:{padding:"0.75rem",fontWeight:500,color:"#1976d2",fontSize:"0.9rem",verticalAlign:"middle"},children:l===f?(0,Bt.jsx)(Ki.Control,{size:"sm",value:u.name,onChange:e=>M("name",e.target.value)}):a.name}),(0,Bt.jsx)("td",{style:{padding:"0.75rem",fontSize:"0.85rem",verticalAlign:"middle"},children:l===f?(0,Bt.jsx)(Ki.Control,{size:"sm",value:u.Formula||"",onChange:e=>M("Formula",e.target.value),style:{fontSize:"0.85rem"}}):a.Formula||"-"}),(0,Bt.jsx)("td",{style:{padding:"0.75rem",fontSize:"0.85rem",textAlign:"center",verticalAlign:"middle"},children:l===f?(0,Bt.jsxs)(Ki.Select,{size:"sm",value:u.Labour,onChange:e=>M("Labour",e.target.value),children:[(0,Bt.jsx)("option",{value:"yes",children:"Yes"}),(0,Bt.jsx)("option",{value:"no",children:"No"})]}):a.Labour}),(0,Bt.jsx)("td",{style:{padding:"0.75rem",fontSize:"0.85rem",textAlign:"center",verticalAlign:"middle"},children:l===f?(0,Bt.jsxs)(Ki.Select,{size:"sm",value:u.Material,onChange:e=>M("Material",e.target.value),style:{fontSize:"0.85rem"},children:[(0,Bt.jsx)("option",{value:"yes",children:"Yes"}),(0,Bt.jsx)("option",{value:"no",children:"No"})]}):a.Material}),(0,Bt.jsx)("td",{style:{padding:"0.75rem",fontSize:"0.85rem",textAlign:"center",verticalAlign:"middle"},children:l===f?(0,Bt.jsxs)(Ki.Select,{size:"sm",value:u.Category,onChange:e=>M("Category",e.target.value),style:{fontSize:"0.85rem"},children:[(0,Bt.jsx)("option",{value:"",children:"Select..."}),C.map(e=>(0,Bt.jsx)("option",{value:e,children:e},e))]}):a.Category}),(0,Bt.jsx)("td",{style:{padding:"0.75rem",fontSize:"0.85rem",textAlign:"center",verticalAlign:"middle"},children:l===f?"Earthwork"!==u.Category?(0,Bt.jsxs)(Ki.Select,{size:"sm",value:u.Mixture||"",onChange:e=>M("Mixture",e.target.value),style:{fontSize:"0.85rem"},children:[(0,Bt.jsx)("option",{value:"",children:"Select..."}),m.map(e=>(0,Bt.jsx)("option",{value:e,children:e},e))]}):"-":"Earthwork"!==a.Category&&a.Mixture||"-"}),(0,Bt.jsx)("td",{style:{padding:"0.75rem",textAlign:"center",verticalAlign:"middle"},children:l===f?(0,Bt.jsxs)(Bt.Fragment,{children:[(0,Bt.jsx)(gr,{variant:"success",size:"sm",onClick:()=>(async i=>{try{var o,a,l,h;const f="https://buildproapi.onrender.com",m=[...n];m[i]=u;const p=u["Applicable Floors"]&&u["Applicable Floors"][0];if(!p)throw new Error("Component must have an Applicable Floor");const g=m.reduce((e,t)=>{const n=t["Applicable Floors"]&&t["Applicable Floors"][0];return e[n]||(e[n]=[]),e[n].push(t),e},{}),v={};null===(o=g[p])||void 0===o||o.forEach(e=>{const{name:t,"Applicable Floors":n,originalIndex:r}=e,i=b(e,pke);v[t]=i});const y=E(E({},(null===e||void 0===e||null===(a=e[p])||void 0===a?void 0:a._id)&&{_id:e[p]._id}),{},{"Applicable Floors":p,version:"1.0",description:"Construction estimation components for ".concat(p),last_updated:(new Date).toISOString().split("T")[0]},v),w=null!==e&&void 0!==e&&null!==(l=e[p])&&void 0!==l&&l._id?"".concat(f,"/api/AreaCalculation/").concat(e[p]._id):"".concat(f,"/api/AreaCalculation"),x=null!==e&&void 0!==e&&null!==(h=e[p])&&void 0!==h&&h._id?"PUT":"POST",S=await fetch(w,{method:x,headers:{"Content-Type":"application/json"},body:JSON.stringify(y)});if(!S.ok)throw new Error("Failed to update calculation");const C=await S.json();t(e=>E(E({},e),{},{[p]:C})),r(m),c(null),d({}),s({show:!0,type:"success",message:"Calculation component updated successfully!"}),setTimeout(()=>s({show:!1,type:"",message:""}),3e3)}catch(mW){console.error("Error updating calculation:",mW),s({show:!0,type:"danger",message:"Error updating calculation: ".concat(mW.message)}),setTimeout(()=>s({show:!1,type:"",message:""}),5e3)}})(f),className:"me-1",children:(0,Bt.jsx)(Yu,{})}),(0,Bt.jsx)(gr,{variant:"secondary",size:"sm",onClick:A,children:(0,Bt.jsx)($u,{})})]}):(0,Bt.jsxs)(Bt.Fragment,{children:[(0,Bt.jsx)(gr,{variant:"outline-secondary",size:"sm",onClick:()=>(async(e,t)=>{if(0===t)return;const r=_(e),i=r[t],o=r[t-1],a=[...n];[a[i.originalIndex],a[o.originalIndex]]=[a[o.originalIndex],a[i.originalIndex]],await O(a)})(i,h),disabled:0===h,className:"me-1",children:(0,Bt.jsx)(Hu,{})}),(0,Bt.jsx)(gr,{variant:"outline-secondary",size:"sm",onClick:()=>(async(e,t)=>{const r=_(e);if(t===r.length-1)return;const i=r[t],o=r[t+1],a=[...n];[a[i.originalIndex],a[o.originalIndex]]=[a[o.originalIndex],a[i.originalIndex]],await O(a)})(i,h),disabled:h===o.length-1,className:"me-1",children:(0,Bt.jsx)(Fu,{})}),(0,Bt.jsx)(gr,{variant:"outline-primary",size:"sm",onClick:()=>(e=>{c(e),d(E({},n[e]))})(f),className:"me-1",children:(0,Bt.jsx)(zu,{})}),(0,Bt.jsx)(gr,{variant:"outline-danger",size:"sm",onClick:()=>(async i=>{if(window.confirm('Are you sure you want to delete "'.concat(n[i].name,'"?')))try{var o,a,l,c;const u="https://buildproapi.onrender.com",d=n[i],h=d["Applicable Floors"]&&d["Applicable Floors"][0],f=n.filter((e,t)=>t!==i),m=f.reduce((e,t)=>{const n=t["Applicable Floors"]&&t["Applicable Floors"][0];return e[n]||(e[n]=[]),e[n].push(t),e},{}),p={};null===(o=m[h])||void 0===o||o.forEach(e=>{const{name:t,"Applicable Floors":n,originalIndex:r}=e,i=b(e,gke);p[t]=i});const g=E(E({},(null===e||void 0===e||null===(a=e[h])||void 0===a?void 0:a._id)&&{_id:e[h]._id}),{},{"Applicable Floors":h,version:"1.0",description:"Construction estimation components for ".concat(h),last_updated:(new Date).toISOString().split("T")[0]},p),v=null!==e&&void 0!==e&&null!==(l=e[h])&&void 0!==l&&l._id?"".concat(u,"/api/AreaCalculation/").concat(e[h]._id):"".concat(u,"/api/AreaCalculation"),y=null!==e&&void 0!==e&&null!==(c=e[h])&&void 0!==c&&c._id?"PUT":"POST",w=await fetch(v,{method:y,headers:{"Content-Type":"application/json"},body:JSON.stringify(g)});if(!w.ok)throw new Error("Failed to delete calculation");const x=await w.json();t(e=>E(E({},e),{},{[h]:x})),r(f),s({show:!0,type:"success",message:"Calculation component deleted successfully!"}),setTimeout(()=>s({show:!1,type:"",message:""}),3e3)}catch(mW){console.error("Error deleting calculation:",mW),s({show:!0,type:"danger",message:"Error deleting calculation: ".concat(mW.message)}),setTimeout(()=>s({show:!1,type:"",message:""}),5e3)}})(f),children:(0,Bt.jsx)(Xu,{})})]})})]},f)})]},i)})})]})})]})},wke=["name"];gbe();const xke=()=>{const[e,t]=(0,g.useState)({}),[n,r]=(0,g.useState)("All"),[i,o]=(0,g.useState)({show:!1,type:"",message:""}),[a,s]=(0,g.useState)([]),[l,c]=(0,g.useState)({}),[u,d]=(0,g.useState)([]),h={Foundation:(0,g.useRef)(null),Basement:(0,g.useRef)(null),Floors:(0,g.useRef)(null)},f=["Foundation","Basement","Floors"],m="https://buildproapi.onrender.com",p=(0,g.useCallback)(async()=>{try{const e=await fetch("".concat(m,"/api/RccConfiguration"));if(!e.ok)throw new Error("Failed to fetch grade options");const t=await e.json(),n=Array.isArray(t)?t:[t],r=[];n.forEach(e=>{e.grade&&!r.includes(e.grade)&&r.push(e.grade)}),s(r)}catch(mW){console.error("Error loading grade options:",mW)}},[m]),v=(0,g.useCallback)(async()=>{try{const e=await fetch("".concat(m,"/api/MaterialItems/units"));if(!e.ok)throw new Error("Failed to fetch unit options");const t=await e.json(),n=Array.isArray(t)?t.map(e=>e.unit):[];d(n)}catch(mW){console.error("Error loading unit options:",mW)}},[m]),y=(0,g.useCallback)(async()=>{try{const e=await fetch("".concat(m,"/api/AreaCalculation"));if(!e.ok)throw new Error("Failed to fetch calculations");const n=await e.json(),r=Array.isArray(n)?n:[n],i={};r.forEach(e=>{const t=e["Applicable Floors"];t&&(i[t]=e)}),t(i)}catch(mW){console.error("Error loading calculations:",mW),o({show:!0,type:"danger",message:"Error: ".concat(mW.message)})}},[m]);(0,g.useEffect)(()=>{y(),p(),v()},[y,p,v]);const w=e=>{var t;const n=null===(t=h[e].current)||void 0===t?void 0:t.hotInstance;if(!n)return void alert("Table instance not found for ".concat(e));if(0===n.countRows())return void alert("No data to export for ".concat(e));const r=n.getPlugin("exportFile");if(!r)return void alert("Export plugin not available");const i=(new Date).toISOString().split("T")[0],o="AreaCalculation_".concat(e,"_").concat(i);r.downloadFile("csv",{bom:!1,columnDelimiter:",",columnHeaders:!0,exportHiddenColumns:!1,exportHiddenRows:!1,fileExtension:"csv",filename:o,mimeType:"text/csv",rowDelimiter:"\r\n",rowHeaders:!0})},x=n=>{const r=(t=>{if(!e[t])return[];const n=E({},e[t]);return["_id","version","description","last_updated","Applicable Floors","createdDate","modifiedDate","createdBy","modifiedBy","__v"].forEach(e=>{delete n[e]}),Object.entries(n).map(e=>{let[t,n]=e;return"object"===typeof n&&null!==n?{name:t,Unit:n.Unit||"",Labour:n.Labour||"no",PricePerUnit:n.PricePerUnit||"",Material:n.Material||"no",Category:n.Category||"",Mixture:n.Mixture||""}:null}).filter(e=>null!==e)})(n),i=l[n];return(0,Bt.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,Bt.jsxs)("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",padding:"0.75rem 1rem",fontWeight:600,fontSize:"1.1rem",borderRadius:"4px 4px 0 0",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"},onClick:()=>(e=>{c(t=>E(E({},t),{},{[e]:!t[e]}))})(n),children:[(0,Bt.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[i?(0,Bt.jsx)(Bu,{}):(0,Bt.jsx)(Lu,{}),n," (",r.length," items)"]}),(0,Bt.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},onClick:e=>e.stopPropagation(),children:[(0,Bt.jsxs)(gr,{size:"sm",variant:"light",onClick:()=>(e=>{var t;const n=null===(t=h[e].current)||void 0===t?void 0:t.hotInstance;if(n){const e=n.countRows();n.alter("insert_row_below",e)}})(n),style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[(0,Bt.jsx)(Gu,{})," Add Row"]}),(0,Bt.jsxs)(gr,{size:"sm",variant:"info",onClick:()=>w(n),style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[(0,Bt.jsx)(Wu,{})," Export"]}),(0,Bt.jsxs)(gr,{size:"sm",variant:"success",onClick:()=>(async n=>{try{var r,i,a,s;const l=null===(r=h[n].current)||void 0===r?void 0:r.hotInstance;if(!l)return;const c=l.getSourceData(),u={};c.forEach(e=>{if(e.name&&""!==e.name.trim()){const{name:t}=e,n=b(e,wke);u[t]=n}});const d=E(E({},(null===e||void 0===e||null===(i=e[n])||void 0===i?void 0:i._id)&&{_id:e[n]._id}),{},{"Applicable Floors":n,version:"1.0",description:"Construction estimation components for ".concat(n),last_updated:(new Date).toISOString().split("T")[0]},u),f=null!==e&&void 0!==e&&null!==(a=e[n])&&void 0!==a&&a._id?"".concat(m,"/api/AreaCalculation/").concat(e[n]._id):"".concat(m,"/api/AreaCalculation"),p=null!==e&&void 0!==e&&null!==(s=e[n])&&void 0!==s&&s._id?"PUT":"POST",g=await fetch(f,{method:p,headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(!g.ok)throw new Error("Failed to save ".concat(n));const v=await g.json();t(e=>E(E({},e),{},{[n]:v})),o({show:!0,type:"success",message:"".concat(n," saved successfully!")}),setTimeout(()=>o({show:!1,type:"",message:""}),3e3)}catch(mW){console.error("Error saving section:",mW),o({show:!0,type:"danger",message:"Error saving ".concat(n,": ").concat(mW.message)})}})(n),style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[(0,Bt.jsx)(Yu,{})," Save"]})]})]}),!i&&(0,Bt.jsx)("div",{style:{border:"1px solid #ddd",borderTop:"none"},children:(0,Bt.jsx)(O2,{ref:h[n],data:r,columns:[{data:"name",title:"Component Name",width:200,type:"text"},{data:"Unit",title:"Unit",width:120,type:"dropdown",source:u},{data:"Labour",title:"Labour",width:100,type:"dropdown",source:["yes","no"]},{data:"PricePerUnit",title:"Price/Unit",width:120,type:"numeric",numericFormat:{pattern:"0,0.00"}},{data:"Material",title:"Material",width:100,type:"dropdown",source:["yes","no"]},{data:"Category",title:"Category",width:120,type:"dropdown",source:["Earthwork","Civil","Electrical","Plumbing","Tiles","Painting","Finishing","Doors & Windows","Miscellaneous"]},{data:"Mixture",title:"Mixture",width:120,type:"dropdown",source:a}],colHeaders:!0,rowHeaders:!0,width:"100%",height:"auto",licenseKey:"non-commercial-and-evaluation",stretchH:"all",contextMenu:["row_above","row_below","remove_row","undo","redo","copy","cut"],manualRowMove:!0,manualColumnMove:!1,manualColumnResize:!0,manualRowResize:!0,selectionMode:"multiple",outsideClickDeselects:!1,afterChange:(e,t)=>((e,t,n)=>{var r;if("loadData"===t||!e)return;if("labour_change"===t||"material_change"===t)return;const i=null===(r=h[n].current)||void 0===r?void 0:r.hotInstance;i&&e.forEach(e=>{let[t,n,r,o]=e;"Labour"===n&&("yes"!==o&&i.setDataAtRowProp(t,"PricePerUnit","","labour_change"),setTimeout(()=>i.render(),0)),"Material"===n&&("yes"!==o&&i.setDataAtRowProp(t,"Mixture","","material_change"),setTimeout(()=>i.render(),0))}),console.log("Data changed in section:",n,e)})(e,t,n),cells:function(e,t){const n={},r=this.instance.toVisualRow(e),i=this.instance.getSourceData()[r];if(!i)return n;const o=this.instance.colToProp(t);return"Mixture"===o&&("yes"!==i.Material?(n.readOnly=!0,n.className="htDimmed"):(n.readOnly=!1,n.className="")),"PricePerUnit"===o&&("yes"!==i.Labour?(n.readOnly=!0,n.className="htDimmed"):(n.readOnly=!1,n.className="")),n}})})]},n)};return(0,Bt.jsxs)(Jt,{fluid:!0,style:{padding:"2rem"},children:[(0,Bt.jsx)("div",{style:{marginBottom:"2rem"},children:(0,Bt.jsx)("h2",{style:{color:"#1976d2",fontWeight:600,margin:0},children:"Area Calculation Master"})}),i.show&&(0,Bt.jsx)(fr,{variant:i.type,onClose:()=>o({show:!1,type:"",message:""}),dismissible:!0,children:i.message}),(0,Bt.jsxs)("div",{style:{marginBottom:"1.5rem",display:"flex",gap:"1rem",alignItems:"center"},children:[(0,Bt.jsx)(Ki.Label,{style:{marginBottom:0,fontWeight:500},children:"Filter by Floor:"}),(0,Bt.jsxs)(Ki.Select,{style:{width:"200px"},value:n,onChange:e=>r(e.target.value),children:[(0,Bt.jsx)("option",{value:"All",children:"All Floors"}),f.map(e=>(0,Bt.jsx)("option",{value:e,children:e},e))]})]}),f.filter(e=>"All"===n||n===e).map(e=>x(e)),(0,Bt.jsxs)("div",{style:{marginTop:"1rem",padding:"1rem",backgroundColor:"#f8f9fa",borderRadius:"4px"},children:[(0,Bt.jsx)("h6",{style:{marginBottom:"0.5rem",fontWeight:600},children:"Excel-like Features:"}),(0,Bt.jsxs)("ul",{style:{marginBottom:0,paddingLeft:"1.5rem"},children:[(0,Bt.jsx)("li",{children:"Click any cell to edit"}),(0,Bt.jsx)("li",{children:"Use Tab/Enter to navigate between cells"}),(0,Bt.jsx)("li",{children:"Right-click for context menu (copy, paste, insert/remove rows)"}),(0,Bt.jsx)("li",{children:"Drag row numbers to reorder"}),(0,Bt.jsx)("li",{children:"Copy/paste from Excel works!"}),(0,Bt.jsx)("li",{children:"Use Ctrl+Z / Ctrl+Y for undo/redo"})]})]})]})},Ske=!0;function Cke(e){let{onLogout:t}=e;const[n,r]=(0,g.useState)(!1);return(0,Bt.jsxs)(rc,{title:(0,Bt.jsx)("span",{className:"ms-3",title:"Profile",children:(0,Bt.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",children:[(0,Bt.jsx)("circle",{cx:"16",cy:"16",r:"16",fill:"#eee"}),(0,Bt.jsx)("circle",{cx:"16",cy:"13",r:"6",fill:"#bbb"}),(0,Bt.jsx)("ellipse",{cx:"16",cy:"25",rx:"8",ry:"5",fill:"#bbb"})]})}),id:"avatar-menu",align:"end",show:n,onToggle:r,menuVariant:"light",children:[(0,Bt.jsx)(rc.Item,{disabled:!0,children:"\ud83d\udc64 User Profile"}),(0,Bt.jsx)(rc.Divider,{}),(0,Bt.jsx)(rc.Item,{onClick:()=>{r(!1),t()},children:"Logout"})]})}const Eke=function(){const[e,t]=(0,g.useState)(!1),n="salmansdr",r="Arman@123",i="isAuthenticated",o="authUser",a="authPass",s="authTime",l=864e5,[c,u]=(0,g.useState)(()=>{const e="true"===localStorage.getItem(i),t=parseInt(localStorage.getItem(s),10),c=Date.now(),u=localStorage.getItem(o),d=localStorage.getItem(a);return!!e&&(!t||c-t>l?(localStorage.setItem(i,"false"),!1):u===n&&d===r||(localStorage.setItem(i,"false"),!1))});return g.useEffect(()=>{const e="true"===localStorage.getItem(i),t=parseInt(localStorage.getItem(s),10),c=Date.now(),d=localStorage.getItem(o),h=localStorage.getItem(a);(!e||!t||c-t>l||d!==n||h!==r)&&(u(!1),localStorage.setItem(i,"false"),localStorage.removeItem(o),localStorage.removeItem(a),localStorage.removeItem(s))},[l]),(0,Bt.jsx)(Rt,{children:(0,Bt.jsxs)("div",{className:"bg-light min-vh-100",style:{padding:0},children:[(0,Bt.jsx)(Jc,{expand:"lg",className:"shadow-sm",style:{width:"100%",backgroundColor:"#003366",margin:0},expanded:e,onToggle:t,children:(0,Bt.jsxs)(Jt,{fluid:!0,style:{width:"100%"},children:[(0,Bt.jsxs)(Jc.Brand,{as:Dt,to:"/",className:"d-flex flex-column align-items-start",onClick:()=>t(!1),children:[(0,Bt.jsxs)("div",{className:"d-flex align-items-center",children:[(0,Bt.jsx)("span",{style:{fontSize:"1.7rem",marginRight:"0.7rem",color:"white"},children:"\ud83c\udfd7\ufe0f"}),(0,Bt.jsx)("span",{style:{color:"white"},children:"BuildPro"})]}),(0,Bt.jsx)("small",{className:"fw-light mt-1",style:{color:"white",fontSize:"0.75rem"},children:"Powered by Salman & Kawsar"})]}),(0,Bt.jsx)(Jc.Toggle,{"aria-controls":"mainNavbar",className:"navbar-toggler-icon-white"}),(0,Bt.jsx)(Jc.Collapse,{id:"mainNavbar",children:(0,Bt.jsxs)(cu,{className:"ms-auto mb-2 mb-lg-0 align-items-center",children:[(0,Bt.jsx)(cu.Link,{as:Dt,to:"/",end:!0,onClick:()=>t(!1),style:{color:"white"},children:"Home"}),!!c&&Ske&&(0,Bt.jsxs)(rc,{title:(0,Bt.jsx)("span",{style:{color:"white"},children:"Project Management"}),id:"project-management-nav-dropdown",menuVariant:"light",className:"dropdown-white-caret",children:[(0,Bt.jsx)(rc.Item,{as:Dt,to:"/project-management",onClick:()=>t(!1),children:"Project Management"}),(0,Bt.jsx)(rc.Item,{as:Dt,to:"/project-estimation",onClick:()=>t(!1),children:"Project Estimation"})]}),!!c&&Ske&&(0,Bt.jsx)(rc,{title:(0,Bt.jsx)("span",{style:{color:"white"},children:"Reports"}),id:"reports-nav-dropdown",menuVariant:"light",className:"dropdown-white-caret",children:(0,Bt.jsx)(rc.Item,{as:Dt,to:"/reports",onClick:()=>t(!1),children:"Cost Report"})}),!!c&&Ske&&(0,Bt.jsxs)(rc,{title:(0,Bt.jsx)("span",{style:{color:"white"},children:"Master Data"}),id:"master-data-nav-dropdown",menuVariant:"light",className:"dropdown-white-caret",children:[(0,Bt.jsxs)(rc.Item,{as:Dt,to:"/item-master",onClick:()=>t(!1),children:[(0,Bt.jsx)("i",{className:"fas fa-boxes me-2"}),"Item Master"]}),(0,Bt.jsxs)(rc.Item,{as:Dt,to:"/rcc-configuration",onClick:()=>t(!1),children:[(0,Bt.jsx)("i",{className:"fas fa-cubes me-2"}),"RCC Configuration"]}),(0,Bt.jsxs)(rc.Item,{as:Dt,to:"/bhk-configuration",onClick:()=>t(!1),children:[(0,Bt.jsx)("i",{className:"fas fa-home me-2"}),"BHK Configuration"]}),(0,Bt.jsxs)(rc.Item,{as:Dt,to:"/area-calculation-excel",onClick:()=>t(!1),children:[(0,Bt.jsx)("i",{className:"fas fa-table me-2"}),"Area Calculation (Excel)"]})]}),!!c&&Ske&&(0,Bt.jsxs)(rc,{title:(0,Bt.jsx)("span",{style:{color:"white"},children:"Admin"}),id:"admin-nav-dropdown",menuVariant:"light",className:"dropdown-white-caret",children:[(0,Bt.jsxs)(rc.Item,{as:Dt,to:"/company-setup",onClick:()=>t(!1),children:[(0,Bt.jsx)("i",{className:"fas fa-building me-2"}),"Company Setup"]}),(0,Bt.jsxs)(rc.Item,{as:Dt,to:"/user-management",onClick:()=>t(!1),children:[(0,Bt.jsx)("i",{className:"fas fa-users me-2"}),"User Management"]})]}),(0,Bt.jsx)(cu.Link,{as:Dt,to:"/about",onClick:()=>t(!1),style:{color:"white"},children:"About"}),(0,Bt.jsx)(cu.Link,{as:Dt,to:"/contact",onClick:()=>t(!1),style:{color:"white"},children:"Contact"}),!c&&(0,Bt.jsx)(cu.Link,{as:Dt,to:"/login",onClick:()=>t(!1),style:{color:"white"},children:"Login"}),c&&(0,Bt.jsx)(Cke,{onLogout:()=>{u(!1),localStorage.setItem(i,"false"),localStorage.removeItem(o),localStorage.removeItem(a),localStorage.removeItem(s)}})]})})]})}),(0,Bt.jsxs)("main",{className:"container py-4 px-3",children:[(0,Bt.jsxs)($e,{children:[(0,Bt.jsx)(Ye,{path:"/",element:(0,Bt.jsx)(yu,{})}),c&&(0,Bt.jsx)(Ye,{path:"/project-management",element:(0,Bt.jsx)(Qu,{})}),c&&(0,Bt.jsx)(Ye,{path:"/ProjectManagementEntryForm",element:(0,Bt.jsx)(ad,{})}),c&&(0,Bt.jsx)(Ye,{path:"/project-estimation",element:(0,Bt.jsx)(ei,{})}),c&&(0,Bt.jsx)(Ye,{path:"/boq-estimation",element:(0,Bt.jsx)(IRe,{})}),c&&(0,Bt.jsx)(Ye,{path:"/pricing-calculator",element:(0,Bt.jsx)(FRe,{})}),c&&(0,Bt.jsx)(Ye,{path:"/reports",element:(0,Bt.jsx)(Cu,{})}),c&&(0,Bt.jsx)(Ye,{path:"/cost-report",element:(0,Bt.jsx)(Eu,{})}),c&&(0,Bt.jsx)(Ye,{path:"/item-master",element:(0,Bt.jsx)(dke,{})}),c&&(0,Bt.jsx)(Ye,{path:"/rcc-configuration",element:(0,Bt.jsx)(hke,{})}),c&&(0,Bt.jsx)(Ye,{path:"/bhk-configuration",element:(0,Bt.jsx)(fke,{})}),c&&(0,Bt.jsx)(Ye,{path:"/area-calculation",element:(0,Bt.jsx)(bke,{})}),c&&(0,Bt.jsx)(Ye,{path:"/area-calculation-excel",element:(0,Bt.jsx)(xke,{})}),c&&(0,Bt.jsx)(Ye,{path:"/company-setup",element:(0,Bt.jsx)(BRe,{})}),c&&(0,Bt.jsx)(Ye,{path:"/user-management",element:(0,Bt.jsx)(URe,{})}),(0,Bt.jsx)(Ye,{path:"/about",element:(0,Bt.jsx)(bu,{})}),(0,Bt.jsx)(Ye,{path:"/contact",element:(0,Bt.jsx)(wu,{})}),(0,Bt.jsx)(Ye,{path:"/login",element:(0,Bt.jsx)(HRe,{onLogin:(e,t)=>e===n&&t===r?(u(!0),localStorage.setItem(i,"true"),localStorage.setItem(o,e),localStorage.setItem(a,t),localStorage.setItem(s,Date.now().toString()),!0):(u(!1),localStorage.setItem(i,"false"),!1),isAuthenticated:c})}),(0,Bt.jsx)(Ye,{path:"/TestApiPage",element:(0,Bt.jsx)(va,{})}),(0,Bt.jsx)(Ye,{path:"*",element:(0,Bt.jsx)(yu,{})})]}),(0,Bt.jsx)("a",{href:"https://wa.me/9874592300",target:"_blank",rel:"noopener noreferrer",className:"position-fixed end-0 rounded-circle shadow",style:{zIndex:999,top:"50%",transform:"translateY(-50%)",right:"20px"},"aria-label":"WhatsApp",children:(0,Bt.jsx)("img",{src:"/SalmanWipro-directory/social/whatsapp.png",alt:"WhatsApp",className:"img-fluid rounded-circle",style:{width:"48px",height:"48px"}})})]}),(0,Bt.jsx)("footer",{className:"bg-light pt-3 pb-2 shadow-sm",children:(0,Bt.jsx)("div",{className:"container",children:(0,Bt.jsx)("div",{className:"row align-items-center justify-content-center",children:(0,Bt.jsxs)("div",{className:"col-12 col-md-10 d-flex align-items-center justify-content-end",children:[(0,Bt.jsx)("span",{className:"fw-bold text-secondary me-2",children:"Follow us on"}),(0,Bt.jsxs)("nav",{className:"d-flex flex-row gap-2",children:[(0,Bt.jsx)("a",{href:"https://facebook.com/salmansdr",target:"_blank",rel:"noopener noreferrer","aria-label":"Facebook",className:"p-0 m-0",children:(0,Bt.jsx)("img",{src:"/SalmanWipro-directory/social/Facebook.PNG",alt:"Facebook",className:"img-fluid rounded me-1",style:{width:"32px",height:"32px"}})}),(0,Bt.jsx)("a",{href:"https://instagram.com/syedsalman1206",target:"_blank",rel:"noopener noreferrer","aria-label":"Instagram",className:"p-0 m-0",children:(0,Bt.jsx)("img",{src:"/SalmanWipro-directory/social/instagram.PNG",alt:"Instagram",className:"img-fluid rounded me-1",style:{width:"32px",height:"32px"}})}),(0,Bt.jsx)("a",{href:"https://x.com/@salman13965660",target:"_blank",rel:"noopener noreferrer","aria-label":"X",className:"p-0 m-0",children:(0,Bt.jsx)("img",{src:"/SalmanWipro-directory/social/x.PNG",alt:"X",className:"img-fluid rounded me-1",style:{width:"32px",height:"32px"}})}),(0,Bt.jsx)("a",{href:"https://linkedin.com/syed-salman-155239219",target:"_blank",rel:"noopener noreferrer","aria-label":"LinkedIn",className:"p-0 m-0",children:(0,Bt.jsx)("img",{src:"/SalmanWipro-directory/social/linkedin.PNG",alt:"LinkedIn",className:"img-fluid rounded me-1",style:{width:"32px",height:"32px"}})}),(0,Bt.jsx)("a",{href:"https://youtube.com/sample",target:"_blank",rel:"noopener noreferrer","aria-label":"YouTube",className:"p-0 m-0",children:(0,Bt.jsx)("img",{src:"/SalmanWipro-directory/social/youtube.PNG",alt:"YouTube",className:"img-fluid rounded me-1",style:{width:"32px",height:"32px"}})})]})]})})})})]})})},Nke=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,6453)).then(t=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:o,getTTFB:a}=t;n(e),r(e),i(e),o(e),a(e)})};v.createRoot(document.getElementById("root")).render((0,Bt.jsx)(g.StrictMode,{children:(0,Bt.jsx)(Eke,{})})),Nke()})()})();
//# sourceMappingURL=main.b1a19187.js.map